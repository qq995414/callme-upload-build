import{u as Le,r as n,j as e,L as _e}from"./index-DJ0IS-oA.js";import{a as p}from"./axios-upsvKRUO.js";import{A as Me}from"./AppBar-CL-OfsFA.js";import{C as Pe}from"./CopyrightFooter-BTH_ji-_.js";const Oe=()=>{const R=Le(),[x,W]=n.useState("");n.useState(null);const[m,G]=n.useState("");n.useState(!1);const[Fe,J]=n.useState([]),[A,X]=n.useState(null),[d,Z]=n.useState(""),[l,q]=n.useState(""),[H,Ee]=n.useState(""),[v,Q]=n.useState(!1),[w,Y]=n.useState(""),[B,ee]=n.useState(""),[N,te]=n.useState(""),[C,se]=n.useState([]),[T,I]=n.useState([]),[L,_]=n.useState([]),[M]=n.useState(["不約見","不聊色","不電愛","熟了有機會"]),[P,ae]=n.useState([!1,!1,!1,!1]),[F,oe]=n.useState(["高挑","小隻馬","清純","性感","可愛","氣質","活力","古典美","時尚","陽光","甜美","纖細","健康","俏皮","短髮","豐滿","OL","運動"]),[E,V]=n.useState(new Array(18).fill(!1)),[y,$]=n.useState(""),[U,ne]=n.useState(""),[re,h]=n.useState(""),[Ve,S]=n.useState(!1),[ce,f]=n.useState(""),[le,k]=n.useState(!1),[z,ie]=n.useState(!1),[de,r]=n.useState(""),[D,ue]=n.useState(null),[me,pe]=n.useState(0),[he,i]=n.useState(!1),O=[{country:"台灣 (Taiwan)",code:"+886"},{country:"中國 (China)",code:"+86"},{country:"新加坡 (Singapore)",code:"+65"},{country:"馬來西亞 (Malaysia)",code:"+60"},{country:"印尼 (Indonesia)",code:"+62"},{country:"泰國 (Thailand)",code:"+66"},{country:"菲律賓 (Philippines)",code:"+63"},{country:"越南 (Vietnam)",code:"+84"},{country:"汶萊 (Brunei)",code:"+673"},{country:"柬埔寨 (Cambodia)",code:"+855"},{country:"寮國 (Laos)",code:"+856"},{country:"緬甸 (Myanmar)",code:"+95"},{country:"美國 (United States)",code:"+1"},{country:"日本 (Japan)",code:"+81"},{country:"南韓 (South Korea)",code:"+82"},{country:"加拿大 (Canada)",code:"+1"},{country:"澳大利亞 (Australia)",code:"+61"},{country:"法國 (France)",code:"+33"},{country:"德國 (Germany)",code:"+49"},{country:"英國 (United Kingdom)",code:"+44"},{country:"義大利 (Italy)",code:"+39"},{country:"西班牙 (Spain)",code:"+34"},{country:"墨西哥 (Mexico)",code:"+52"},{country:"巴西 (Brazil)",code:"+55"},{country:"阿根廷 (Argentina)",code:"+54"},{country:"印度 (India)",code:"+91"},{country:"俄羅斯 (Russia)",code:"+7"},{country:"瑞士 (Switzerland)",code:"+41"},{country:"荷蘭 (Netherlands)",code:"+31"},{country:"南非 (South Africa)",code:"+27"},{country:"新西蘭 (New Zealand)",code:"+64"}];n.useEffect(()=>{window.AppConfig&&window.AppConfig.country_list&&J(window.AppConfig.country_list),fe()},[]);const fe=()=>{const t=document.getElementById("recordButton"),s=document.getElementById("stopButton"),a=document.getElementById("audio");if(!t||!s||!a)return;let o=null,c=[],u=null;const b=async()=>{try{t.disabled=!0,s.disabled=!1,t.style.background="red";const j=await navigator.mediaDevices.getUserMedia({audio:!0});u=j,o=new MediaRecorder(j,{mimeType:"audio/webm"}),o.start(),c=[],o.ondataavailable=g=>{g.data.size>0&&c.push(g.data)},o.onstop=()=>{const g=new Blob(c,{type:"audio/webm"}),Te=URL.createObjectURL(g);a.src=Te,a.controls=!0,ue(g),u&&u.getTracks().forEach(Ie=>Ie.stop()),t.style.background="",t.disabled=!1,s.disabled=!0}}catch(j){console.error("無法錄音:",j),t.disabled=!1,s.disabled=!0}},K=()=>{o&&o.state==="recording"?o.stop():(t.disabled=!1,s.disabled=!0,t.style.background="")};return t.addEventListener("click",b),s.addEventListener("click",K),()=>{t.removeEventListener("click",b),s.removeEventListener("click",K)}},ge=t=>{ae(s=>{const a=[...s];return a[t]=!a[t],a})},xe=t=>{V(s=>{const a=[...s];return a[t]=!a[t],a})},ye=()=>{y.trim()!==""&&(oe(t=>[...t,y]),V(t=>[...t,!0]),$(""))},be=t=>{const s=Math.min(t.length,6),a=[];for(let o=0;o<s;o++)a.push(URL.createObjectURL(t[o]));I(a)},je=t=>{const s=t.target.files;if(!s)return;const a=Array.from(s);se(a),be(a)},ve=t=>{I(a=>{const o=[...a];return o.splice(t,1),o});const s=L[t];s&&p.delete(`https://api.dageiwo.com/file/${s}`,{headers:{Authorization:"Bearer ???"}}).then(a=>{a.status===200?(_(o=>{const c=[...o];return c.splice(t,1),c}),alert("圖片已成功刪除！")):alert("刪除失敗，請重試！")}).catch(a=>{console.error("圖片刪除失敗：",a),alert("刪除失敗，請檢查網路連線！")})},we=t=>{G(t)},Ne=n.useCallback(()=>{if(!m)return 0;const t=Math.abs(Date.now()-new Date(m).getTime());return Math.ceil(t/(1e3*60*60*24*365.25))},[m]),Ce=t=>{console.log(t,"code");const s=O.find(a=>a.code==t);X(s||null),console.log("found",s),Z(t)},Se=t=>{q(t),h(""),S(!1),f(""),k(!1)},ke=async()=>{h(""),S(!1);try{const t=await p.post(`https://api.dageiwo.com/auth/send/sms_key?phone_number=${encodeURIComponent(d+l)}`,{});if(t.status===200&&t.data.success)h("發送成功, 收到驗證碼後請輸入驗證碼進行檢查。"),S(!0);else{const s=t.data.message?t.data.message:"請重新發送驗證碼。";h("發送驗證碼失敗, "+s)}}catch(t){console.error(t),h("發送驗證碼失敗, 請檢查網路後再試一次")}},Re=async()=>{f(""),k(!1);try{const t=await p.post(`https://api.dageiwo.com/auth/check/sms_key?phone_number=${encodeURIComponent(d+l)}&key=${N}`,{});if(t.status===200&&t.data.success)f("檢查驗證碼成功."),k(!0);else{const s=t.data.message?t.data.message:"請重新發送驗證碼, 再進行檢查。";f("檢查驗證碼失敗, "+s)}}catch(t){console.error(t),f("檢查驗證碼失敗, 請重新發送驗證碼, 再進行檢查。")}},Ae=async()=>{if(C.length===0)return r("請選擇至少一個頭像照片."),!1;r("上傳照片中...");let t=Math.min(C.length,6);const s=new FormData;for(let a=0;a<t;a++)s.append("files",C[a]);try{const a=await p.post("https://api.dageiwo.com/file/upload_multi?file_type=AVATAR",s);if(a.status!==200||!a.data.success){const c=a.data.message||"請檢查網路後再試一次.";return r("上傳照片失敗, "+c),!1}r("上傳照片完成.");const o=a.data.data.map(c=>c.id);if(_(o),D){r("開始上傳錄音...");const c=new FormData;c.append("file",D,"留言.mp3");const u=await p.post("https://api.dageiwo.com/file/upload?fileType=WEB_M",c);if(u.status!==200||!u.data.success){const b=u.data.message||"請檢查網路後再試一次.";return r("上傳錄音失敗, "+b),!1}r("上傳錄音完成."),pe(u.data.data.id)}return!0}catch(a){return console.error(a),r("上傳照片失敗, 請檢查網路後再試一次."),!1}},Be=async()=>{if(i(!0),r(""),Ne()<18){r("註冊失敗, 年齡必須大於18."),i(!1);return}r("檢查帳號資料中...");try{const o=await p.get(`https://api.dageiwo.com/auth/check/account?account=${encodeURIComponent(d+l)}`);if(o.status!==200){r("註冊失敗, 請檢查網路後再試一次."),i(!1);return}if(!o.data.success){r("帳號已經存在, 請用其他手機號碼註冊."),i(!1);return}}catch(o){console.error(o),r("註冊失敗, 請檢查網路後再試一次."),i(!1);return}if(r("上傳照片/留言檔案中..."),!await Ae()){i(!1);return}let s=M.map((o,c)=>P[c]?o:null).filter(Boolean).join(",");r("整理聲明資料完成.");let a=F.map((o,c)=>E[c]?o:null).filter(Boolean).join(",");r("整理描述資料完成."),r("送出註冊資料中...");try{const o=await p.post("https://api.dageiwo.com/auth/female_register",{country:A.country||"",account:d+l,password:w,nickname:x,birthday:m,real_name:"",id_number:"",receiving_type:!0,address:"",email:"",phone:d+l,referral_code:B,statement:s,appearance:a,about_me:U,file_ids:L.toString(),mp3_id:me,telegram_account:H},{headers:{"Content-Type":"application/json"}});if(o.status===200&&o.data.success)r("註冊成功, 跳轉登入畫面中..."),i(!1),R("/login");else{const c=o.data.message||"請檢查網路後再試一次.";r("註冊失敗, "+c),i(!1)}}catch(o){console.error(o),r("註冊失敗, 請檢查網路後再試一次."),i(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(Me,{children:e.jsx("button",{className:"btn",onClick:()=>R("/home"),style:{background:"none",border:"none",color:"#fff"},children:e.jsx("i",{className:"mdi mdi-chevron-left",style:{fontSize:"24px"}})})}),e.jsxs("div",{className:"register-main",children:[e.jsx("h2",{children:"女性用戶註冊"}),e.jsx("hr",{}),e.jsxs("div",{className:"section",children:[e.jsx("h3",{children:"加入條件"}),e.jsx("p",{style:{fontSize:"small",margin:"4px 0"},children:"1. 限女性，需滿18歲"}),e.jsx("p",{style:{fontSize:"small",margin:"4px 0"},children:"2. 本公司發薪水是以銀行帳戶匯款，需為本人之帳戶（包含海外用戶）"}),e.jsx("p",{style:{fontSize:"small",margin:"4px 0"},children:"3. 若發現任何身分造假、從事非法不利於平台之行為，將會立即停權"}),e.jsx("p",{style:{fontSize:"small",margin:"4px 0"},children:"4. 需自備手機或電腦與良好網路環境"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{className:"form-label",children:"暱稱"}),e.jsx("input",{className:"form-input",type:"text",value:x,onChange:t=>W(t.target.value)})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{className:"form-label",children:"生日"}),e.jsx("input",{className:"form-input",type:"date",value:m,onChange:t=>we(t.target.value)})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{className:"form-label",children:"國家/地區"}),e.jsxs("select",{className:"form-select",value:d,onChange:t=>Ce(t.target.value),disabled:!x||!m,children:[e.jsx("option",{value:"",children:!x||!m?"請先輸入暱稱與生日":"選擇國家/地區"}),O.map((t,s)=>e.jsx("option",{value:t.code,children:t.country},s))]})]}),e.jsxs("div",{className:"form-row",style:{display:"flex",alignItems:"center"},children:[e.jsx("label",{className:"form-label",style:{marginRight:"10px"},children:"手機號碼"}),e.jsxs("div",{className:"input-container",style:{display:"flex",alignItems:"center",flex:1},children:[e.jsx("span",{className:"input-prefix",style:{background:"#f0f0f0",padding:"4px 10px",border:"1px solid #ccc",borderRadius:"4px 0 0 4px",pointerEvents:"none"},children:d||"+0"}),e.jsx("input",{className:"form-input",type:"number",value:l,onChange:t=>Se(t.target.value),disabled:!d,placeholder:A?"":"請先選擇國家/地區",style:{flex:1,border:"1px solid #ccc",borderLeft:"none",marginLeft:"2px",borderRadius:"0 4px 4px 0"}})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{className:"form-label",children:"密碼"}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("input",{className:"form-input",style:{width:"150px"},type:v?"text":"password",value:w,onChange:t=>Y(t.target.value),disabled:!l,placeholder:l?"":"請先輸入手機號"}),e.jsx("button",{className:"btn",type:"button",onClick:()=>Q(!v),children:v?"隱藏":"顯示"})]})]}),e.jsxs("div",{className:"code-area",children:[e.jsx("span",{className:"status-text",children:re}),e.jsx("button",{className:"btn",onClick:ke,disabled:!l,children:"發送驗證碼"})]}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{className:"form-label",children:"驗證碼"}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("input",{className:"form-input",style:{width:"150px"},type:"number",value:N,onChange:t=>te(t.target.value),disabled:!l,placeholder:l?"":"輸入手機驗證碼"}),e.jsx("button",{className:"btn",onClick:Re,disabled:!N,children:"檢查驗證碼"})]})]}),e.jsx("div",{className:"status-text",children:ce}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{className:"form-label",children:"介紹碼"}),e.jsx("input",{className:"form-input",type:"text",value:B,onChange:t=>ee(t.target.value),disabled:!l,placeholder:l?"":"請先輸入手機號碼"})]}),e.jsx("div",{className:"form-row",children:"上傳頭像(最少1張，可同時選多個)"}),e.jsx("input",{type:"file",accept:"image/jpg,image/jpeg",multiple:!0,onChange:je}),T.length>0&&e.jsx("div",{className:"image-preview-container",children:T.map((t,s)=>e.jsxs("div",{className:"image-preview-wrapper",children:[e.jsx("img",{src:t,alt:"preview",className:"image-preview"}),e.jsx("button",{className:"delete-preview-btn",onClick:()=>ve(s),children:"X"})]},s))}),e.jsx("div",{className:"form-row",children:"我先聲明"}),e.jsx("div",{className:"tag-list",children:M.map((t,s)=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:P[s],onChange:()=>ge(s)}),e.jsxs("span",{children:["#",t]})]},s))}),e.jsx("div",{className:"form-row",children:"外型"}),e.jsx("div",{className:"tag-list",children:F.map((t,s)=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:E[s],onChange:()=>xe(s)}),e.jsxs("span",{children:["#",t]})]},s))}),e.jsxs("div",{className:"form-row",children:[e.jsx("label",{className:"form-label",children:"自訂標籤"}),e.jsx("input",{className:"form-input",type:"text",value:y,onChange:t=>$(t.target.value)}),e.jsx("button",{className:"btn",onClick:ye,disabled:!y,children:"+"})]}),e.jsx("div",{className:"form-row",children:"個人描述"}),e.jsx("textarea",{className:"form-textarea",value:U,onChange:t=>ne(t.target.value),rows:3,style:{width:"100%"}}),e.jsx("div",{className:"form-row",children:"錄音留言"}),e.jsxs("div",{style:{margin:"5px"},children:[" ",e.jsx("label",{children:"錄音留言"})," ",e.jsxs("div",{style:{border:"1px solid #ccc",padding:"8px",marginTop:"4px"},children:[" ",e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"8px"},children:[" ",e.jsx("button",{id:"recordButton",style:{background:"#0088cc",color:"#fff",border:"none",padding:"4px 8px",cursor:"pointer"},children:" 開始錄音 "})," ",e.jsx("button",{id:"stopButton",style:{background:"#0088cc",color:"#fff",border:"none",padding:"4px 8px",cursor:"pointer"},children:" 停止錄音 "})," "]})," ",e.jsx("audio",{id:"audio",controls:!0,style:{width:"100%"}})," "]})," "]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("label",{style:{cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:z,onChange:t=>ie(t.target.checked)}),e.jsxs("span",{style:{marginLeft:"5px"},children:["我已閱讀並同意 ",e.jsx(_e,{to:"/service",children:"《服務協議》"})]})]}),e.jsx("div",{className:"tip-text",children:"本頁面收集的資料僅用於註冊帳戶"})]}),e.jsx("button",{className:"submit-btn",disabled:!le||w===""||!z||he,onClick:Be,children:"同意並繼續"}),e.jsx("div",{className:"register-result",children:de})]}),e.jsx(Pe,{})]})};export{Oe as default};
