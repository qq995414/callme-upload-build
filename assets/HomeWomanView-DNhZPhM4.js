import{u as U,r as a,j as o}from"./index-C60VvIli.js";import{a as x}from"./axios-upsvKRUO.js";import{C as M}from"./CopyrightFooter-Rxjvix_B.js";import{S as V,b as v}from"./blur-sWQDB4M4.js";function ee(){const f=U(),[w,_]=a.useState(window.innerWidth),[h,C]=a.useState(""),[G,z]=a.useState(""),[H,I]=a.useState(""),[Y,T]=a.useState(""),[q,R]=a.useState(""),[J,W]=a.useState(""),[$,L]=a.useState([]),[A,p]=a.useState([]),[d,g]=a.useState("關注"),[y,b]=a.useState(1);a.useEffect(()=>{const e=window.sessionStorage.getItem("nickname")||"",s=window.sessionStorage.getItem("gender_type")||"",t=window.sessionStorage.getItem("token")||"",i=window.sessionStorage.getItem("chat_id")||"",l=window.sessionStorage.getItem("chat_token")||"",r=window.sessionStorage.getItem("u_id")||"";z(e),I(s),C(t),T(i),R(l),W(r),!window.WebSocketObject&&typeof window.WebSocketConnect=="function"&&window.WebSocketConnect(r),E(t)},[]),a.useEffect(()=>{const e=()=>_(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const N=a.useCallback(()=>{let e=2;return w>960&&(e=3),((w>800?800:w)-30)/e},[w]),B=e=>{if(!e)return"";const s=Date.now()-new Date(e).getTime(),t=new Date(s);return" "+Math.abs(t.getUTCFullYear()-1970)},E=async e=>{try{console.log(h);const s=await x.get("https://api.dageiwo.com/index/pinned_picture",{headers:{Authorization:`Bearer ${e}`}});s.status===200&&s.data.success&&L(t=>[...t,...s.data.data])}catch(s){console.error(s)}},k=async e=>{var s;try{e&&(b(1),p([])),g("列表");const t=await x.get(`https://api.dageiwo.com/index/list?page=${e?1:y}&limit=40&order=dsc&sort=femaleRegister.clickRate`,{headers:{Authorization:`Bearer ${h}`}});if(t.status===200&&t.data.success){const i=((s=t.data.data)==null?void 0:s.records)||[];i.length>0&&b(r=>r+1);const l=i.map(r=>{var c;let n="";for(let u=0;u<r.img_responses.length;u++){const m=r.img_responses[u];if(m.status==="APPROVED"){n=m.image_url;break}}return{...r,image_url:n||((c=r.img_responses[0])==null?void 0:c.image_url),approved:!!n}});p(e?l:r=>[...r,...l])}}catch(t){console.error(t)}},S=async(e,s)=>{var t;try{e&&(b(1),p([])),g("關注");const i=await x.get(`https://api.dageiwo.com/api/user/follows?page=${e?1:y}&limit=40&order=dsc&sort=femaleRegister.clickRate`,{headers:{Authorization:`Bearer ${h}`}});if(i.status===200&&i.data.success){const l=((t=i.data.data)==null?void 0:t.records)||[];l.length>0&&b(n=>n+1);const r=l.map(n=>{var u;let c="";for(let m=0;m<n.img_responses.length;m++){const j=n.img_responses[m];if(j.status==="APPROVED"){c=j.image_url;break}}return{...n,image_url:c||((u=n.img_responses[0])==null?void 0:u.image_url),approved:!!c}});p(e?r:n=>[...n,...r])}}catch(i){console.error(i)}},P=async()=>{try{p([]),g("在線");const e=await x.get("https://api.dageiwo.com/index/is_online",{headers:{Authorization:`Bearer ${h}`}});if(e.status===200&&e.data.success){const t=(e.data.data||[]).map(i=>{var r;let l="";for(let n=0;n<i.img_responses.length;n++){const c=i.img_responses[n];if(c.status==="APPROVED"){l=c.image_url;break}}return{...i,image_url:l||((r=i.img_responses[0])==null?void 0:r.image_url),approved:!!l}});p(t)}}catch(e){console.error(e)}},F=async()=>{try{const e=await x.post("https://api.dageiwo.com/auth/logout",{},{headers:{Authorization:`Bearer ${h}`}});e.status===200&&e.data.success&&(window.sessionStorage.setItem("nickname",""),window.sessionStorage.setItem("gender_type",""),window.sessionStorage.setItem("token",""),window.sessionStorage.setItem("chat_id",""),window.sessionStorage.setItem("chat_token",""),window.sessionStorage.setItem("u_id",""),window.WebSocketObject&&window.WebSocketObject.close(),f("/home"))}catch(e){console.error(e),f("/home")}},D={dots:!1,infinite:!0,speed:500,slidesToShow:6,slidesToScroll:1,arrows:!0,responsive:[{breakpoint:768,settings:{slidesToShow:4,slidesToScroll:1}},{breakpoint:480,settings:{slidesToShow:3,slidesToScroll:1}}]},O=()=>{d==="關注"?S(!0):d==="列表"?k(!0):d==="在線"&&P()};return o.jsxs("div",{className:"home-man-view",style:{backgroundColor:"#f2e9eb"},children:[o.jsx("div",{className:"app-bar",style:{backgroundColor:"#dd8ea4",padding:"1rem"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[o.jsx("div",{style:{flex:1}}),o.jsx("div",{style:{flex:1,display:"flex",justifyContent:"center"},children:o.jsx("div",{style:{backgroundColor:"white",width:"120px",height:"40px",borderRadius:"8px",overflow:"hidden"},children:o.jsx("img",{src:"../public/assets/Logo-wide.png",alt:"Logo",style:{width:"100%",height:"100%",objectFit:"cover"}})})}),o.jsx("div",{style:{flex:1,display:"flex",justifyContent:"flex-end"},children:o.jsxs("button",{style:{backgroundColor:"#dd8ea4",color:"white",fontSize:"18px",marginRight:"26px",border:"none",cursor:"pointer"},onClick:F,children:[o.jsx("i",{className:"mdi mdi-logout",style:{marginRight:"6px"}}),"登出"]})})]})}),o.jsxs("div",{className:"home-man-main",style:{maxWidth:"800px",margin:"0 auto",padding:"1rem"},children:[o.jsx("h2",{style:{margin:"10px"},children:"為你推薦"}),o.jsx("div",{style:{margin:"0 5%"},children:o.jsx(V,{...D,children:$.map((e,s)=>o.jsxs("div",{style:{padding:"8px"},children:[o.jsx(v.LazyLoadImage,{src:e.url||"/images/placeholder.png",alt:e.nickname||"No name",effect:"blur",placeholderSrc:"/images/placeholder.png",onClick:()=>f(`/woman-info/${e.id}`),style:{border:"2px solid #f2e9eb",outline:"#dd8ea4 solid 2px",width:"64px",height:"64px",objectFit:"cover",cursor:"pointer",borderRadius:"50%",margin:"0 auto",display:"block"}}),o.jsx("p",{style:{fontSize:"12px",textAlign:"center",marginTop:"4px"},children:e.nickname})]},s))})}),o.jsx("h2",{style:{margin:"10px"},children:"女神列表"}),o.jsxs("div",{style:{display:"flex",marginBottom:"5px"},children:[o.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:d==="關注"?"#dd8ea4":"grey",borderBottom:d==="關注"?"2px solid #dd8ea4":"none"},onClick:()=>g("關注"),children:"關注"}),o.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:d==="列表"?"#dd8ea4":"grey",borderBottom:d==="列表"?"2px solid #dd8ea4":"none"},onClick:()=>g("列表"),children:"列表"}),o.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:d==="在線"?"#dd8ea4":"grey",borderBottom:d==="在線"?"2px solid #dd8ea4":"none"},onClick:()=>g("在線"),children:"在線"})]}),o.jsx("div",{style:{textAlign:"center",marginBottom:"1rem"},children:o.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer"},onClick:O,children:"送出"})}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",margin:"-5px"},children:A.map((e,s)=>{const t=e.approved;return o.jsx("div",{style:{width:"50%",padding:"5px"},children:o.jsxs("div",{style:{position:"relative",borderRadius:"16px",overflow:"hidden"},children:[o.jsx(v.LazyLoadImage,{src:e.image_url||"/images/placeholder.png",alt:e.nickname||"No name",effect:"blur",placeholderSrc:"/images/placeholder.png",onClick:()=>f(`/woman-info/${e.id}`),width:"100%",height:N(),style:{objectFit:"cover",filter:t?"none":"blur(8px)",transform:t?"scale(1)":"scale(0.95)",cursor:"pointer"}}),!t&&o.jsx("div",{style:{color:"white",fontSize:"32px",fontWeight:"1000",WebkitTextStroke:"1px black",top:"50%",left:"50%",minWidth:"130px",justifyContent:"center",position:"absolute",display:"block",zIndex:999,transform:"translate(-50%, -50%)"},children:"審查中"}),t&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{position:"absolute",top:"8px",right:"8px"},children:[!e.cannot_take_call&&o.jsx("span",{style:{backgroundColor:"purple",color:"#fff",padding:"2px 6px",marginRight:"4px",fontSize:"12px",borderRadius:"4px"},children:"語音"}),!e.cannot_take_video_call&&o.jsx("span",{style:{backgroundColor:"cyan",color:"#fff",padding:"2px 6px",fontSize:"12px",borderRadius:"4px"},children:"視訊"})]}),o.jsxs("div",{style:{position:"absolute",bottom:"8px",left:"16px",color:"white",fontSize:"14px",fontWeight:"bolder",textShadow:"1px 1px 2px #000"},children:[e.nickname+B(e.birthday),e.review_notes&&o.jsx("div",{style:{fontSize:"10px",marginTop:"0"},children:e.review_notes})]})]})]})},s)})}),d==="列表"&&o.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",border:"none",padding:"8px 16px",cursor:"pointer",marginTop:"1rem"},onClick:()=>k(!1),children:"查看更多"}),d==="關注"&&o.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",border:"none",padding:"8px 16px",cursor:"pointer",marginTop:"1rem"},onClick:()=>S(!1),children:"查看更多"})]}),o.jsx(M,{})]})}export{ee as default};
