import { a as m } from "./axios-upsvKRUO.js";
import { S as M, b as v } from "./blur-DBoUEmXi.js";
import { C as U } from "./CopyrightFooter-BTH_ji-_.js";
import { u as O, r as a, j as o } from "./index-DJ0IS-oA.js";
function Z(){const x=O(),[f,_]=a.useState(window.innerWidth),[g,C]=a.useState(""),[V,z]=a.useState(""),[G,I]=a.useState(""),[H,T]=a.useState(""),[Y,R]=a.useState(""),[q,W]=a.useState(""),[$,L]=a.useState([]),[A,c]=a.useState([]),[p,b]=a.useState("關注"),[k,w]=a.useState(1);a.useEffect(()=>{const e=window.localStorage.getItem("nickname")||"",s=window.localStorage.getItem("gender_type")||"",t=window.localStorage.getItem("token")||"",i=window.localStorage.getItem("chat_id")||"",d=window.localStorage.getItem("chat_token")||"",r=window.localStorage.getItem("u_id")||"";z(e),I(s),C(t),T(i),R(d),W(r),!window.WebSocketObject&&typeof window.WebSocketConnect=="function"&&window.WebSocketConnect(r),B(t),y(!0)},[]),a.useEffect(()=>{const e=()=>_(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const N=a.useCallback(()=>{let e=2;return f>960&&(e=3),((f>800?800:f)-30)/e},[f]),E=e=>{if(!e)return"";const s=Date.now()-new Date(e).getTime(),t=new Date(s);return" "+Math.abs(t.getUTCFullYear()-1970)},B=async e=>{try{console.log(g);const s=await m.get("https://api.dageiwo.com/index/pinned_picture",{headers:{Authorization:`Bearer ${e}`}});s.status===200&&s.data.success&&L(t=>[...t,...s.data.data])}catch(s){console.error(s)}},S=async e=>{var s;try{e&&(w(1),c([])),b("列表");const t=await m.get(`https://api.dageiwo.com/index/list?page=${e?1:k}&limit=40&order=dsc&sort=femaleRegister.clickRate`,{headers:{Authorization:`Bearer ${g}`}});if(t.status===200&&t.data.success){const i=((s=t.data.data)==null?void 0:s.records)||[];i.length>0&&w(r=>r+1);const d=i.map(r=>{var l;let n="";for(let u=0;u<r.img_responses.length;u++){const h=r.img_responses[u];if(h.status==="APPROVED"){n=h.image_url;break}}return{...r,image_url:n||((l=r.img_responses[0])==null?void 0:l.image_url),approved:!!n}});c(e?d:r=>[...r,...d])}}catch(t){console.error(t)}},y=async(e,s)=>{var t;try{console.log(g),e&&(w(1),c([])),b("關注");const i=await m.get(`https://api.dageiwo.com/api/user/follows?page=${e?1:k}&limit=40&order=dsc&sort=femaleRegister.clickRate`,{headers:{Authorization:`Bearer ${g}`}});if(i.status===200&&i.data.success){const d=((t=i.data.data)==null?void 0:t.records)||[];d.length>0&&w(n=>n+1);const r=d.map(n=>{var u;let l="";for(let h=0;h<n.img_responses.length;h++){const j=n.img_responses[h];if(j.status==="APPROVED"){l=j.image_url;break}}return{...n,image_url:l||((u=n.img_responses[0])==null?void 0:u.image_url),approved:!!l}});c(e?r:n=>[...n,...r])}}catch(i){console.error(i)}},F=async()=>{try{c([]),b("在線");const e=await m.get("https://api.dageiwo.com/index/is_online",{headers:{Authorization:`Bearer ${g}`}});if(e.status===200&&e.data.success){const t=(e.data.data||[]).map(i=>{var r;let d="";for(let n=0;n<i.img_responses.length;n++){const l=i.img_responses[n];if(l.status==="APPROVED"){d=l.image_url;break}}return{...i,image_url:d||((r=i.img_responses[0])==null?void 0:r.image_url),approved:!!d}});c(t)}}catch(e){console.error(e)}},P=async()=>{try{const e=await m.post("https://api.dageiwo.com/auth/logout",{},{headers:{Authorization:`Bearer ${g}`}});e.status===200&&e.data.success&&(window.localStorage.setItem("nickname",""),window.localStorage.setItem("gender_type",""),window.localStorage.setItem("token",""),window.localStorage.setItem("chat_id",""),window.localStorage.setItem("chat_token",""),window.localStorage.setItem("u_id",""),window.WebSocketObject&&window.WebSocketObject.close(),x("/home"))}catch(e){console.error(e),x("/home")}},D={dots:!1,infinite:!0,speed:500,slidesToShow:6,slidesToScroll:1,arrows:!0,responsive:[{breakpoint:768,settings:{slidesToShow:4,slidesToScroll:1}},{breakpoint:480,settings:{slidesToShow:3,slidesToScroll:1}}]};return o.jsxs("div",{className:"home-man-view",style:{backgroundColor:"#f2e9eb"},children:[o.jsx("div",{className:"app-bar",style:{backgroundColor:"#dd8ea4",padding:"1rem"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[o.jsx("div",{style:{flex:1}}),o.jsx("div",{style:{flex:1,display:"flex",justifyContent:"center"},children:o.jsx("div",{style:{backgroundColor:"white",width:"120px",height:"40px",borderRadius:"8px",overflow:"hidden"},children:o.jsx("img",{src:"../src/assets/Logo-wide.png",alt:"Logo",style:{width:"100%",height:"100%",objectFit:"cover"}})})}),o.jsx("div",{style:{flex:1,display:"flex",justifyContent:"flex-end"},children:o.jsxs("button",{style:{backgroundColor:"#dd8ea4",color:"white",fontSize:"18px",marginRight:"26px",border:"none",cursor:"pointer"},onClick:P,children:[o.jsx("i",{className:"mdi mdi-logout",style:{marginRight:"6px"}}),"登出"]})})]})}),o.jsxs("div",{className:"home-man-main",style:{maxWidth:"800px",margin:"0 auto",padding:"1rem"},children:[o.jsx("h2",{style:{margin:"10px"},children:"為你推薦"}),o.jsx("div",{style:{margin:"0 5%"},children:o.jsx(M,{...D,children:$.map((e,s)=>o.jsxs("div",{style:{padding:"8px"},children:[o.jsx(v.LazyLoadImage,{src:e.url||"/images/placeholder.png",alt:e.nickname||"No name",effect:"blur",placeholderSrc:"/images/placeholder.png",onClick:()=>x(`/woman-info/${e.id}`),style:{border:"2px solid #f2e9eb",outline:"#dd8ea4 solid 2px",width:"64px",height:"64px",objectFit:"cover",cursor:"pointer",borderRadius:"50%",margin:"0 auto",display:"block"}}),o.jsx("p",{style:{fontSize:"12px",textAlign:"center",marginTop:"4px"},children:e.nickname})]},s))})}),o.jsx("h2",{style:{margin:"10px"},children:"女神列表"}),o.jsxs("div",{style:{display:"flex",marginBottom:"5px"},children:[o.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:p==="關注"?"#dd8ea4":"grey",borderBottom:p==="關注"?"2px solid #dd8ea4":"none"},onClick:()=>y(!0),children:"關注"}),o.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:p==="列表"?"#dd8ea4":"grey",borderBottom:p==="列表"?"2px solid #dd8ea4":"none"},onClick:()=>S(!0),children:"列表"}),o.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:p==="在線"?"#dd8ea4":"grey",borderBottom:p==="在線"?"2px solid #dd8ea4":"none"},onClick:F,children:"在線"})]}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",margin:"-5px"},children:A.map((e,s)=>{const t=e.approved;return o.jsx("div",{style:{width:"50%",padding:"5px"},children:o.jsxs("div",{style:{position:"relative",borderRadius:"16px",overflow:"hidden"},children:[o.jsx(v.LazyLoadImage,{src:e.image_url||"/images/placeholder.png",alt:e.nickname||"No name",effect:"blur",placeholderSrc:"/images/placeholder.png",onClick:()=>x(`/woman-info/${e.id}`),width:"100%",height:N(),style:{objectFit:"cover",filter:t?"none":"blur(8px)",transform:t?"scale(1)":"scale(0.95)",cursor:"pointer"}}),!t&&o.jsx("div",{style:{color:"white",fontSize:"32px",fontWeight:"1000",WebkitTextStroke:"1px black",top:"50%",left:"50%",minWidth:"130px",justifyContent:"center",position:"absolute",display:"block",zIndex:999,transform:"translate(-50%, -50%)"},children:"審查中"}),t&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{position:"absolute",top:"8px",right:"8px"},children:[!e.cannot_take_call&&o.jsx("span",{style:{backgroundColor:"purple",color:"#fff",padding:"2px 6px",marginRight:"4px",fontSize:"12px",borderRadius:"4px"},children:"語音"}),!e.cannot_take_video_call&&o.jsx("span",{style:{backgroundColor:"cyan",color:"#fff",padding:"2px 6px",fontSize:"12px",borderRadius:"4px"},children:"視訊"})]}),o.jsxs("div",{style:{position:"absolute",bottom:"8px",left:"16px",color:"white",fontSize:"14px",fontWeight:"bolder",textShadow:"1px 1px 2px #000"},children:[e.nickname+E(e.birthday),e.review_notes&&o.jsx("div",{style:{fontSize:"10px",marginTop:"0"},children:e.review_notes})]})]})]})},s)})}),p==="列表"&&o.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",border:"none",padding:"8px 16px",cursor:"pointer",marginTop:"1rem"},onClick:()=>S(!1),children:"查看更多"}),p==="關注"&&o.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",border:"none",padding:"8px 16px",cursor:"pointer",marginTop:"1rem"},onClick:()=>y(!1),children:"查看更多"})]}),o.jsx(U,{})]})}export { Z as default };

