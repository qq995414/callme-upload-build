const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/__bundle-a2eabc21-BOE1ITUu.js","assets/index-DJ0IS-oA.js","assets/index-BDVdLah8.css","assets/axios-upsvKRUO.js","assets/__bundle-46d64517-BMFsvfX6.js","assets/bundle-CZsW3iP9-CZbQtL1c.js"])))=>i.map(i=>d[i]);
import { a as qp } from "./axios-upsvKRUO.js";
import { r as F, c as RN, R as b, a as c5, g as d5, u as f5, e as l5, j as wt, _ as y_ } from "./index-DJ0IS-oA.js";
var Tc=l5(),zE=function(n,t){return zE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},zE(n,t)};function j(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}zE(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var W=function(){return W=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},W.apply(this,arguments)};function h5(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e}function M(n,t,e,r){return new(e||(e=Promise))(function(i,a){function s(h){try{d(r.next(h))}catch(p){a(p)}}function u(h){try{d(r.throw(h))}catch(p){a(p)}}function d(h){var p;h.done?i(h.value):(p=h.value,p instanceof e?p:new e(function(g){g(p)})).then(s,u)}d((r=r.apply(n,[])).next())})}function R(n,t){var e,r,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=u(0),s.throw=u(1),s.return=u(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(d){return function(h){return function(p){if(e)throw new TypeError("Generator is already executing.");for(;s&&(s=0,p[0]&&(a=0)),a;)try{if(e=1,r&&(i=2&p[0]?r.return:p[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,p[1])).done)return i;switch(r=0,i&&(p=[2&p[0],i.value]),p[0]){case 0:case 1:i=p;break;case 4:return a.label++,{value:p[1],done:!1};case 5:a.label++,r=p[1],p=[0];continue;case 7:p=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||p[0]!==6&&p[0]!==2)){a=0;continue}if(p[0]===3&&(!i||p[1]>i[0]&&p[1]<i[3])){a.label=p[1];break}if(p[0]===6&&a.label<i[1]){a.label=i[1],i=p;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(p);break}i[2]&&a.ops.pop(),a.trys.pop();continue}p=t.call(n,a)}catch(g){p=[6,g],r=0}finally{e=i=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([d,h])}}}function Le(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function cn(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r,i,a=e.call(n),s=[];try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(e=a.return)&&e.call(a)}finally{if(i)throw i.error}}return s}function Nn(n,t,e){if(arguments.length===2)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))}var rn,s2="4.16.4",wo=function(){function n(){}return Object.defineProperty(n,"OS_VERSION",{get:function(){return typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SDK_VERSION",{get:function(){return s2},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SDK_MAJOR_VERSION",{get:function(){return n.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(n,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),n}();(function(n){n[n.NON_AUTHORIZED=400108]="NON_AUTHORIZED",n[n.INVALID_TOKEN=400111]="INVALID_TOKEN",n[n.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",n[n.USER_AUTH_DEACTIVATED=400300]="USER_AUTH_DEACTIVATED",n[n.USER_AUTH_DELETED_OR_NOT_FOUND=400301]="USER_AUTH_DELETED_OR_NOT_FOUND",n[n.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",n[n.APPLICATION_NOT_FOUND=400304]="APPLICATION_NOT_FOUND",n[n.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",n[n.SESSION_REVOKED=400310]="SESSION_REVOKED",n[n.INVALID_SESSION_TYPE=400312]="INVALID_SESSION_TYPE",n[n.INVALID_AUTH_FOR_SERVICE=400313]="INVALID_AUTH_FOR_SERVICE",n[n.STAT_UPLOAD_NOT_ALLOWED=403200]="STAT_UPLOAD_NOT_ALLOWED",n[n.NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE=400940]="NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE",n[n.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",n[n.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",n[n.INVALID_REQUIRED_FORM_VALUE=400105]="INVALID_REQUIRED_FORM_VALUE",n[n.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",n[n.NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE=901500]="NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE",n[n.ERR_DUPLICATED_DATA=400202]="ERR_DUPLICATED_DATA",n[n.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",n[n.LOST_INSTANCE=700100]="LOST_INSTANCE",n[n.CONNECTION_RENEW=700102]="CONNECTION_RENEW",n[n.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",n[n.INVALID_COMMAND=700700]="INVALID_COMMAND",n[n.XMLHTTPREQUEST_NOT_SUPPORTED=700800]="XMLHTTPREQUEST_NOT_SUPPORTED",n[n.UNKNOWN_ERROR=77e4]="UNKNOWN_ERROR",n[n.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",n[n.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",n[n.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",n[n.INVALID_PARAMETER=800110]="INVALID_PARAMETER",n[n.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",n[n.NETWORK_ERROR=800120]="NETWORK_ERROR",n[n.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",n[n.MALFORMED_DATA=800130]="MALFORMED_DATA",n[n.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",n[n.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",n[n.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",n[n.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",n[n.ACK_TIMEOUT=800180]="ACK_TIMEOUT",n[n.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",n[n.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",n[n.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",n[n.REQUEST_FAILED=800220]="REQUEST_FAILED",n[n.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",n[n.REQUEST_CANCELED=800240]="REQUEST_CANCELED",n[n.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",n[n.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",n[n.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED=800270]="ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED",n[n.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",n[n.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",n[n.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",n[n.COLLECTION_DISPOSED=800600]="COLLECTION_DISPOSED",n[n.DATABASE_ERROR=800700]="DATABASE_ERROR",n[n.USER_DEACTIVATED=900021]="USER_DEACTIVATED",n[n.CHANNEL_IS_FROZEN=900050]="CHANNEL_IS_FROZEN",n[n.RECEIVER_USER_DEACTIVATED=900081]="RECEIVER_USER_DEACTIVATED"})(rn||(rn={}));var $i,Pl,si,H_,KE,Qf,Gi=function(n){return!(n instanceof ee&&!n.shouldThrowOutside)},ee=function(n){function t(e){var r=e.code,i=r===void 0?0:r,a=e.message,s=a===void 0?"":a,u=n.call(this,s)||this;return u.shouldThrowOutside=!1,u._detail="",u.name="SendbirdError",u.code=i,Object.setPrototypeOf(u,t.prototype),u}return j(t,n),Object.defineProperty(t.prototype,"detail",{get:function(){return this._detail},enumerable:!1,configurable:!0}),t.prototype.setDetail=function(e){this._detail=e},Object.defineProperty(t.prototype,"isInvalidTokenError",{get:function(){return this.code===rn.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiredError",{get:function(){return this.isSessionTokenExpiredError||this.isSessionKeyExpiredError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===rn.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===rn.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionInvalidatedError",{get:function(){return this.isSessionRevokedError||this.isUserAuthDeactivedError||this.isUserAuthDeletedOrNotFoundError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionRevokedError",{get:function(){return this.code===rn.SESSION_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeactivedError",{get:function(){return this.code===rn.USER_AUTH_DEACTIVATED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeletedOrNotFoundError",{get:function(){return this.code===rn.USER_AUTH_DELETED_OR_NOT_FOUND},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNetworkError",{get:function(){return this.code===rn.NETWORK_ERROR||this.code===rn.NETWORK_ROUTING_ERROR},enumerable:!1,configurable:!0}),Object.defineProperty(t,"debugModeRequired",{get:function(){return new t({code:rn.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lostInstance",{get:function(){return new t({code:rn.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidCommand",{get:function(){return new t({code:rn.INVALID_COMMAND,message:"Cannot send invalid command."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"unknown",{get:function(){return new t({code:rn.UNKNOWN_ERROR,message:"Unknown error occurred."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRenew",{get:function(){return new t({code:rn.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidConnectionStateTransition",{get:function(){return new t({code:rn.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"xmlHttpRequestNotSupported",{get:function(){return new t({code:rn.XMLHTTPREQUEST_NOT_SUPPORTED,message:"Cannot upload file. XMLHttpRequest is not defined in this environment."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRequired",{get:function(){return new t({code:rn.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionCanceled",{get:function(){return new t({code:rn.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidParameters",{get:function(){return new t({code:rn.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"notSupportedError",{get:function(){return new t({code:rn.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"channelTypeNotSupportedError",{get:function(){return new t({code:rn.NOT_SUPPORTED_ERROR,message:"Called method is not supported in the current channel's channel type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"networkError",{get:function(){return new t({code:rn.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"markAsReadAllRateLimitExceeded",{get:function(){return new t({code:rn.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"queryInProgress",{get:function(){return new t({code:rn.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"noAckTimeout",{get:function(){return new t({code:rn.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loginTimeout",{get:function(){return new t({code:rn.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionClosed",{get:function(){return new t({code:rn.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestFailed",{get:function(){return new t({code:rn.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"tooManyRequests",{get:function(){return new t({code:rn.REQUEST_DUPLICATED,message:"Too many requests."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"alreadyConnectedAsAnotherUser",{get:function(){return new t({code:rn.REQUEST_FAILED,message:"Already logged in as a different user. Call disconnect() first."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileUploadCanceled",{get:function(){return new t({code:rn.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestCanceled",{get:function(){return new t({code:rn.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRefreshFailed",{get:function(){return new t({code:rn.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRequestFailed",{get:function(){return new t({code:rn.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseError",{get:function(){return new t({code:rn.DATABASE_ERROR,message:"Database error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileSizeLimitExceededError",{get:function(){return new t({code:rn.FILE_SIZE_LIMIT_EXCEEDED,message:"File size exceeds the file size limit."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"statLogUploadLimitExceededError",{get:function(){return new t({code:rn.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED,message:"The upload request failed due to the retry count being exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"malformedDataError",{get:function(){return new t({code:rn.MALFORMED_DATA,message:"Malformed data."})},enumerable:!1,configurable:!0}),t.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},t}(Error),p5=[rn.CONNECTION_REQUIRED,rn.NETWORK_ERROR,rn.ACK_TIMEOUT,rn.WEBSOCKET_CONNECTION_CLOSED,rn.WEBSOCKET_CONNECTION_FAILED,rn.FILE_UPLOAD_CANCEL_FAILED,rn.REQUEST_CANCELED,rn.INTERNAL_SERVER_ERROR,rn.RATE_LIMIT_EXCEEDED,rn.UNKNOWN_SERVER_ERROR,rn.USER_DEACTIVATED,rn.CHANNEL_IS_FROZEN,rn.RECEIVER_USER_DEACTIVATED],_5=[rn.WEBSOCKET_CONNECTION_CLOSED,rn.WEBSOCKET_CONNECTION_FAILED,rn.CONNECTION_REQUIRED,rn.CHANNEL_IS_FROZEN],u2=function(n,t){if(n!==t){var e=W({},n),r=W({},t);return(!e.hasOwnProperty("messageId")||!r.hasOwnProperty("messageId")||e.messageId===r.messageId)&&(!e.hasOwnProperty("reqId")||!r.hasOwnProperty("reqId")||e.reqId===r.reqId)&&(e.hasOwnProperty("messageId")&&delete e.messageId,e.hasOwnProperty("reqId")&&delete e.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(e)===JSON.stringify(r))}return!0},J=function(n,t,e){return e===void 0&&(e=!1),!(!e||!Dh(t))||(typeof n!="string"?typeof n=="object"?nt(n,t):m5(n,t):typeof t===n)},nt=function(n,t,e){return e===void 0&&(e=!1),!(!e||!Dh(t))||Object.values(n).includes(t)},m5=function(n,t){return t instanceof n},tt=function(n,t,e){return e===void 0&&(e=!1),!(!e||!Dh(t))||Array.isArray(t)&&t.every(function(r){return J(n,r)})},MN=function(n,t){return t===void 0&&(t=!1),!(!t||!Dh(n))||typeof n=="number"&&n.toString().length===13},g5=function(n){return n>0&&p5.indexOf(n)>=0},B_=function(n){return n>0&&_5.indexOf(n)>=0},oi=function(n,t){if(t===void 0&&(t=!1),t&&Dh(n))return!0;var e=typeof n=="object"&&n!==null&&n.hasOwnProperty("name")&&typeof n.name=="string"&&n.hasOwnProperty("uri")&&typeof n.uri=="string"&&n.hasOwnProperty("type")&&typeof n.type=="string";if(!e){if(typeof Blob<"u")return n instanceof Blob;if(typeof File<"u")return n instanceof File}return e},v5=function(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(var e=Nn([],cn(n),!1).sort(),r=Nn([],cn(t),!1).sort(),i=0;i<e.length;++i)if(e[i]!==r[i])return!1;return!0},Dh=function(n){return n==null},o2=function(){function n(t){var e=t===void 0?{}:t,r=e.useMemberInfoInMessage,i=r===void 0||r,a=e.typingIndicatorInvalidateTime,s=a===void 0?1e4:a,u=e.typingIndicatorThrottle,d=u===void 0?1e3:u,h=e.websocketResponseTimeout,p=h===void 0?1e4:h,g=e.websocketPayloadDecompression,E=g===void 0||g,y=e.sessionTokenRefreshTimeout,C=y===void 0?60:y;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=i,this._typingIndicatorInvalidateTime=s,this._typingIndicatorThrottle=d,this._websocketResponseTimeout=p,this._sessionTokenRefreshTimeout=C,this.websocketPayloadDecompression=E}return Object.defineProperty(n.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(t){J("boolean",t)&&(this._useMemberInfoInMessage=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(t){J("number",t)&&(this._typingIndicatorInvalidateTime=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(t){J("number",t)&&t>=1e3&&t<=9e3&&(this._typingIndicatorThrottle=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(t){J("number",t)&&t>=5e3&&t<=3e4&&(this._websocketResponseTimeout=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(t){J("number",t)&&(t<60?t=60:t>1800&&(t=1800),this._sessionTokenRefreshTimeout=t)},enumerable:!1,configurable:!0}),n}(),l2={encrypt:function(n){return n},decrypt:function(n){return n}},ON=function(){function n(t){var e=t.store;this._preference=new Map,this._store=e}return n.prototype._savePreferenceKeys=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,this._store.set({key:this._keysAddress,value:Nn([],cn(this._preference.keys()),!1)})];case 1:return t.sent(),[2]}})})},n.prototype.init=function(t,e){var r;return e===void 0&&(e=1),M(this,void 0,void 0,function(){var i,a,s,u,d,h,p,g,E,y;return R(this,function(C){switch(C.label){case 0:return this._version=e,this._keysAddress=t,i="".concat(t,".metadata.version"),[4,this._store.get(i)];case 1:return a=C.sent(),[4,this._store.get(t)];case 2:return s=(r=C.sent())!==null&&r!==void 0?r:[],!a||a.version<this._version?[4,this._resetPreferenceData(s,i)]:[3,4];case 3:return C.sent(),[3,11];case 4:C.trys.push([4,9,10,11]),u=Le(s),d=u.next(),C.label=5;case 5:return d.done?[3,8]:(h=d.value,[4,this._store.get(h)]);case 6:(p=C.sent())&&this._preference.set(h,p),C.label=7;case 7:return d=u.next(),[3,5];case 8:return[3,11];case 9:return g=C.sent(),E={error:g},[3,11];case 10:try{d&&!d.done&&(y=u.return)&&y.call(u)}finally{if(E)throw E.error}return[7];case 11:return[2]}})})},n.prototype._resetPreferenceData=function(t,e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return this._preference=new Map,[4,this._store.removeMany(t)];case 1:return r.sent(),[4,this._store.set({key:e,value:{version:this._version}})];case 2:return r.sent(),[2]}})})},n.prototype.get=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){return[2,this._preference.get(t)]})})},n.prototype.set=function(t,e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=!this._preference.has(t),[4,this._store.set({key:t,value:e})];case 1:return i.sent(),this._preference.set(t,e),r?[4,this._savePreferenceKeys()]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},n.prototype.remove=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this._store.remove(t)];case 1:return e.sent(),this._preference.delete(t),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2]}})})},n.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,this._store.removeMany(Nn([],cn(this._preference.keys()),!1))];case 1:return t.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}})})},n}(),E5=function(){function n(t){var e=t.encryption,r=t.store,i=t.localCacheEnabled,a=t.localCacheConfig;this.store=r,this.preference=new ON({store:r}),this.encryption=e??l2,this.localCacheEnabled=i,this.localCacheConfig=a}return n.prototype.replaceStore=function(t){this.store=t,this.preference=new ON({store:t})},n}();(function(n){n.SUCCESS="success",n.PENDING="pending",n.ERROR="error"})($i||($i={})),function(n){n.DEFAULT="default",n.ALL="all",n.MENTION_ONLY="mention_only",n.OFF="off"}(Pl||(Pl={})),function(n){n.FCM="gcm",n.APNS="apns",n.UNKNOWN="unknown"}(si||(si={})),function(n){n.SESSION_TOKEN="session_token",n.ACCESS_TOKEN="access_token"}(H_||(H_={})),function(n){n.ALTERNATIVE="alternative",n.DEFAULT="default"}(KE||(KE={})),function(n){n.CUSTOM="custom",n.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at"}(Qf||(Qf={}));var G_,y5=function(){function n(t){var e=t.channel,r=t.cachedMessageCount;this._cachedMessageCount=0,this._channel=e,this._cachedMessageCount=r}return Object.defineProperty(n.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cachedMessageCount",{get:function(){return this._cachedMessageCount},enumerable:!1,configurable:!0}),n}(),d2=function(){function n(t){var e=t===void 0?{}:t,r=e.maxSize,i=r===void 0?256:r,a=e.clearOrder,s=a===void 0?Qf.MESSAGE_COLLECTION_ACCESSED_AT:a,u=e.customClearOrderComparator,d=e.enableAutoResend,h=d===void 0||d;this._clearOrderComparatorUseMessageCollectionAccessedAt=function(p,g){return p.channel.messageCollectionLastAccessedAt===g.channel.messageCollectionLastAccessedAt?p.channel.lastMessage&&!g.channel.lastMessage?1:!p.channel.lastMessage&&g.channel.lastMessage?-1:p.channel.lastMessage||g.channel.lastMessage?p.channel.lastMessage.createdAt-g.channel.lastMessage.createdAt:0:p.channel.messageCollectionLastAccessedAt>g.channel.messageCollectionLastAccessedAt?1:-1},this._maxSize=Math.max(i,64),u?(this._clearOrder=s,this._customClearOrderComparator=u):this._clearOrder=Qf.MESSAGE_COLLECTION_ACCESSED_AT,this._enableAutoResend=h}return Object.defineProperty(n.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clearOrder",{get:function(){return this._clearOrder},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clearOrderComparator",{get:function(){var t;return this._clearOrder===Qf.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:(t=this._customClearOrderComparator)!==null&&t!==void 0?t:this._clearOrderComparatorUseMessageCollectionAccessedAt},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"enableAutoResend",{get:function(){return this._enableAutoResend},enumerable:!1,configurable:!0}),n}();(function(n){n.FEED="feed",n.CHAT="chat",n.CHAT_API="chat_api"})(G_||(G_={}));var vt,Ka,Ts,Rr,Ni,pc,wi,ti,Ms,jt,kN,WE,$E,b5=function(){function n(){this.isRefreshing=!1}return Object.defineProperty(n.prototype,"hasSession",{get:function(){return!!this.sessionKey},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasChatServicePermission",{get:function(){var t;return!!(!((t=this.services)===null||t===void 0)&&t.includes(G_.CHAT))},enumerable:!1,configurable:!0}),n.prototype.clear=function(){this.authToken=void 0,this.sessionKey=void 0,this.services=[]},n}(),Bu=function(){var n=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(n+16*Math.random())%16|0;return n=Math.floor(n/16),(t==="x"?e:3&e|8).toString(16)})},DN=function(){function n(t){var e=t.container;this._container={},this._container=e,this.key=Bu()}return n.prototype._register=function(t,e,r){var i;return t in this._container||(this._container[t]=new Map),(i=this._container[t])===null||i===void 0||i.set(this.key,{occurence:e,handler:r}),this},n.prototype.on=function(t,e){return this._register(t,-1,e)},n.prototype.once=function(t,e){return this._register(t,1,e)},n.prototype.close=function(){var t=this;Object.keys(this._container).forEach(function(e){var r;(r=t._container[e])===null||r===void 0||r.delete(t.key)})},n}(),rd=function(){function n(){this._container={}}return n.prototype.on=function(t,e){return new DN({container:this._container}).on(t,e)},n.prototype.once=function(t,e){return new DN({container:this._container}).once(t,e)},n.prototype.dispatch=function(t,e){var r,i,a=this._container[t];if(a){var s=[];try{for(var u=Le(a.keys()),d=u.next();!d.done;d=u.next()){var h=d.value,p=a.get(h);p.handler(e),p.occurence>0&&(p.occurence--,p.occurence===0&&s.push(h))}}catch(g){r={error:g}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}s.forEach(function(g){return a.delete(g)})}},n}(),C5=function(){function n(){this._dispatcher=new rd}return n.prototype.on=function(t){return this._dispatcher.on("event",t)},n.prototype.once=function(t){return this._dispatcher.once("event",t)},n.prototype.dispatch=function(t){this._dispatcher.dispatch("event",t)},n}(),Cr=function(){},ze=function(n){var t={};return n&&Object.keys(n).forEach(function(e){n[e]===void 0||Number.isNaN(n[e])||n[e]===null||(t[e]=n[e])}),t},_n=function(n){if(n!=null){if(typeof n=="object"){if(Array.isArray(n)){for(var t=Nn([],cn(n),!1),e=0;e<t.length;e++)t[e]=_n(t[e]);return t}return Object.keys(n).forEach(function(r){n[r]===null&&delete n[r]}),n}return n}};(function(n){n.BASE="base",n.GROUP="group",n.OPEN="open",n.FEED="feed"})(vt||(vt={})),function(n){n.OPERATOR="operator",n.NONE="none"}(Ka||(Ka={})),function(n){n.MUTED="muted",n.UNMUTED="unmuted"}(Ts||(Ts={})),function(n){n.BASE="base",n.USER="user",n.FILE="file",n.ADMIN="admin"}(Rr||(Rr={})),function(n){n.ALL="",n.USER="MESG",n.FILE="FILE",n.ADMIN="ADMM"}(Ni||(Ni={})),function(n){n.USER="MESG",n.FILE="FILE",n.ADMIN="ADMM"}(pc||(pc={})),function(n){n.USERS="users",n.CHANNEL="channel"}(wi||(wi={})),function(n){n.ALL="all",n.NONE="none",n.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel"}(ti||(ti={})),function(n){n.DEFAULT="default",n.SUPPRESS="suppress"}(Ms||(Ms={})),function(n){n.PENDING="pending",n.SCHEDULED="scheduled",n.SUCCEEDED="succeeded",n.FAILED="failed",n.CANCELED="canceled"}(jt||(jt={})),function(n){n.INREVIEW="InReview",n.APPROVED="Approved"}(kN||(kN={})),function(n){n.HIGH="high",n.NORMAL="normal",n.LOW="low"}(WE||(WE={})),function(n){n.CREATED_AT="created_at",n.UPDATED_AT="updated_at"}($E||($E={}));var Ie,hi="v3",xt="/".concat(hi,"/users"),I5="/".concat(hi,"/sdk/users"),T5="/".concat(hi,"/storage/file"),qi="/".concat(hi,"/group_channels"),S5="/".concat(hi,"/sdk/group_channels"),id="/".concat(hi,"/open_channels"),N5="/".concat(hi,"/sdk/open_channels"),A5="/".concat(hi,"/search"),YE="/".concat(hi,"/report"),w5="/".concat(hi,"/emojis"),c2="/".concat(hi,"/emoji_categories"),ks="/".concat(hi,"/polls"),f2="/".concat(hi,"/scheduled_messages"),R5="/".concat(hi,"/sdk/ui_kit/configuration"),M5="/".concat(hi,"/sdk/statistics"),O5="/".concat(hi,"/sdk/statistics/notification_statistics"),h2="/".concat(hi,"/message_templates"),k5="/".concat(hi,"/sdk/push_delivery"),D5="/".concat(hi,"/forms"),L5="/".concat(hi,"/report_category"),Lt=function(n){switch(n){case vt.FEED:case vt.GROUP:return qi;case vt.OPEN:return id;default:return null}},p2=function(n){switch(n){case vt.GROUP:return"".concat(YE,"/group_channels");case vt.OPEN:return"".concat(YE,"/open_channels");default:return null}},_c=function(n,t,e){var r,i;switch(n){case wi.CHANNEL:return!0;case wi.USERS:if(t)try{for(var a=Le(t),s=a.next();!s.done;s=a.next())if(s.value===e)return!0}catch(u){r={error:u}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}return!1},$b=function(n,t,e){var r,i,a,s,u=_c((r=n.mentionType)!==null&&r!==void 0?r:null,(i=n.mentionedUserIds)!==null&&i!==void 0?i:[],e),d=_c((a=t.mentionType)!==null&&a!==void 0?a:null,(s=t.mentionedUserIds)!==null&&s!==void 0?s:[],e);return!u&&d?1:u&&!d?-1:0},_2=function(n,t,e){var r,i=t||new FormData;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a],u=e?"".concat(e,"[").concat(a,"]"):a;oi(s)?i.append(u,s,(r=s.name)!==null&&r!==void 0?r:"filename"):typeof s!="object"||s===null||Array.isArray(s)||s instanceof Blob?i.append(u,String(s)):i=_2(s,i,u)}return i};(function(n){n.GET="GET",n.POST="POST",n.PUT="PUT",n.DELETE="DELETE"})(Ie||(Ie={}));var gr,Te=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.params={},e.requireAuth=!0,e.headers={},e.requestId=Bu(),e}return j(t,n),t.prototype.encodeParams=function(e){var r=this;return e==null||e===""?encodeURIComponent(""):Array.isArray(e)?e.map(function(i){return r.encodeParams(i)}).join(","):encodeURIComponent(typeof e=="object"?JSON.stringify(e):String(e))},Object.defineProperty(t.prototype,"query",{get:function(){var e=this,r=ze(this.params);return"?".concat(Object.keys(r).map(function(i){return"".concat(encodeURIComponent(i),"=").concat(e.encodeParams(r[i]))}).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){var e=ze(this.params);return Object.keys(e).some(function(r){return oi(e[r])})?_2(e):JSON.stringify(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSessionKey",{get:function(){return this.headers["Session-Key"]!==void 0},enumerable:!1,configurable:!0}),t}(Cr),Me=function(n){function t(e,r){var i=n.call(this)||this;return i._iid=e,i._payload=r,i}return j(t,n),Object.defineProperty(t.prototype,"payload",{get:function(){return W({},this._payload)},enumerable:!1,configurable:!0}),t.prototype.as=function(e){return new e(this._iid,this.payload)},t}(Cr),x5=function(n){function t(e){var r=n.call(this)||this;return r.requestId=e,r}return j(t,n),t}(Cr),mc=function(n){function t(e){var r=e.expires_in,i=e.reason,a=i===void 0?rn.SESSION_KEY_EXPIRED:i,s=e.message,u=s===void 0?"":s,d=n.call(this)||this;switch(d.expiresIn=r??0,a){case rn.SESSION_KEY_EXPIRED:case rn.SESSION_TOKEN_EXPIRED:case rn.SESSION_REVOKED:case rn.USER_AUTH_DEACTIVATED:case rn.USER_AUTH_DELETED_OR_NOT_FOUND:d.error=new ee({code:a,message:u})}return d}return j(t,n),Object.defineProperty(t.prototype,"invalidateSessionToken",{get:function(){var e;return!!(!((e=this.error)===null||e===void 0)&&e.isSessionTokenExpiredError)},enumerable:!1,configurable:!0}),t}(Cr),dr=function(n){function t(e,r,i,a){a===void 0&&(a="");var s,u=this;return(u=n.call(this)||this)._iid=e,u.code=r,u.payload=i,u.requestId=(s=i.req_id)!==null&&s!==void 0?s:a,u}return j(t,n),t.createFromRawMessage=function(e,r){var i=r.substring(0,4),a={};try{a=JSON.parse(r.substring(4))}catch{i="NOOP"}finally{return new t(e,i,a)}},t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),`
`)},t.prototype.as=function(e){return new e(this._iid,this.code,this.payload)},t}(Cr),Ai=function(n){function t(e){var r,i=e.code,a=e.ackRequired,s=e.payload,u=s===void 0?{}:s,d=this;return(d=n.call(this)||this).code=i,d.payload=u,d.requestId=(r=d.payload.req_id)!==null&&r!==void 0?r:Bu(),d.ackRequired=a,d.payload.req_id=d.requestId,d}return j(t,n),t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),`
`)},t}(Cr),Yb=function(n){function t(e){var r=e.userId,i=e.authToken,a=e.services,s=e.expiringSession,u=s===void 0||s,d=n.call(this)||this;return d.path="".concat(xt,"/").concat(r,"/session_key"),d.method=Ie.POST,d.params=ze({token:i,services:a,expiring_session:!!u}),d.requireAuth=!1,d}return j(t,n),t}(Te),U5=function(n){function t(e){var r=e.authToken,i=e.expiringSession,a=i===void 0||i,s=e.requestId,u=s===void 0?void 0:s;return n.call(this,{code:"LOGI",payload:ze({token:r,expiring_session:a?1:0,req_id:u}),ackRequired:!0})||this}return j(t,n),t}(Ai),P5=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.key,s=r.expires_at,u=r.services;return i.key=a,i.expiresAt=s,i.services=u,i}return j(t,n),t}(Me),F5=function(n){function t(e,r,i){var a,s=this;return(s=n.call(this,e,"LOGI",i)||this).error=null,s.newKey=null,s.newKey=(a=i.new_key)!==null&&a!==void 0?a:null,s.error=i.error?new ee(i):null,s}return j(t,n),t}(dr),Qb=function(n){function t(e){var r=n.call(this)||this;return r.statLog=e,r}return j(t,n),t}(Cr),m2=function(n){function t(e){var r=e.request,i=e.deferred,a=e.error,s=a===void 0?ee.requestFailed:a,u=n.call(this)||this;return u.request=r,u.deferred=i,u.error=s,u}return j(t,n),t}(Cr);(function(n){n.FEATURE_LOCALCACHE="feature:local_cache",n.FEATURE_LOCALCACHE_EVENT="feature:local_cache_event",n.NOTIFICATION="noti:stats",n.WEBSOCKET_CONNECT="ws:connect",n.API_RESULT="api:result"})(gr||(gr={}));var QE,ql,Io,Or=function(){function n(t){var e=t.type,r=t.data,i=t.ts,a=i===void 0?Date.now():i;this.type=e,this.createdAt=a,this.data=r}return n.payloadify=function(t){return ze({stat_type:t.type,ts:t.createdAt,data:ze(t.data)})},n}(),ZE=function(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product=="ReactNative"},LN=function(){return!(typeof navigator>"u"||!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent))};(function(n){n.CHAT="chat",n.CALLS="calls",n.DESK="desk",n.LIVE="live",n.UIKIT_CHAT="uikit-chat",n.UIKIT_LIVE="uikit-live"})(QE||(QE={})),function(n){n.ANDROID="android",n.IOS="ios",n.JS="js",n.UNREAL="unreal",n.UNITY="unity",n.REACT_NATIVE="react-native",n.FLUTTER="flutter"}(ql||(ql={})),function(n){n.ANDROID="android",n.IOS="ios",n.WEB="web",n.MOBILE_WEB="mobile_web",n.WINDOWS="windows"}(Io||(Io={}));var H5="^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",V_=function(){function n(){}return n.sendbirdSdkUserAgentWithExtension=function(t){var e=ZE()?ql.REACT_NATIVE:ql.JS,r={main_sdk_info:"chat/".concat(e,"/").concat(wo.SDK_VERSION),device_os_platform:LN()?"mobile-web":"web",os_version:wo.OS_VERSION};if(t){var i=t.sendbirdExtensions,a=t.deviceOS,s=t.customData,u=s===void 0?{}:s;a.version&&(r.os_version=a.version),a.platform&&(r.device_os_platform=a.platform),i.length>0&&(r.extension_sdk_info=i.map(function(d){var h=d.product,p=d.platform,g=d.version;return"".concat(h,"/").concat(p,"/").concat(g)}).join(",")),Object.keys(r).forEach(function(d){return delete u[d]}),Object.keys(u).length>0&&(r=W(W({},r),u))}return Object.entries(r).map(function(d){var h=cn(d,2),p=h[0],g=h[1];return"".concat(p,"=").concat(g)}).join("&")},n.userAgentWithExtension=function(t){var e=ZE()?"reactnative":"JS",r=t.sb_syncmanager?"s".concat(t.sb_syncmanager):"",i=t.sb_uikit?"u".concat(t.sb_uikit):"",a=t["device-os-platform"]?"o".concat(t["device-os-platform"]):LN()?"omobile-web":"oweb";return"".concat(e,"/c").concat(wo.SDK_VERSION,"/").concat(r,"/").concat(i,"/").concat(a)},n}(),Qi=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=function(r){e(r)}})},j_=function(n){function t(e){var r=n.call(this)||this;return r.requestId=e.requestId,r}return j(t,n),t}(Cr),g2=function(n){function t(e){var r=n.call(this)||this;return r.method=Ie.DELETE,r.path="".concat(Lt(e.channelType),"/").concat(e.channelUrl,"/messages/").concat(e.messageId),e.messageToken&&(r.params=ze({mesg_token:e.messageToken})),r}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var v2=function(n){function t(e,r,i){var a,s=this;return(s=n.call(this,e,"DELM",i)||this).channelUrl=i.channel_url,s.channelType=i.channel_type,s.messageId=Number(i.msg_id),s.silent=i.silent,s.messageCreatedAt=i.message_created_at?Number(i.message_created_at):-1,s.senderId=(a=i.sender_id)!==null&&a!==void 0?a:void 0,s}return j(t,n),t}(dr),B5=function(){function n(t,e){var r=e.session,i=e.sdkState,a=e.dispatcher,s=e.logger,u=e.useFetchCompat,d=u!==void 0&&u,h=this;this._abortControl=new Map,this._shouldImportFetchCompat=!1,this._iid=t,this._session=r,this._sdkState=i,this._dispatcher=a,this._dispatcher.on(function(p){p instanceof x5&&h.cancel(p.requestId)}),this._logger=s,this._shouldImportFetchCompat=d}return n.prototype._createHeader=function(t,e){var r=this._sdkState,i=r.appId,a=r.appVersion,s=r.sendbirdRuntimeEnvironment,u=W(W({},t.headers),{SendBird:"JS,".concat(wo.OS_VERSION,",").concat(wo.SDK_VERSION,",").concat(i).concat(a?",".concat(a):""),"SB-User-Agent":V_.userAgentWithExtension(this._sdkState.extensions),"Request-Sent-Timestamp":Date.now().toString(),"SB-SDK-User-Agent":V_.sendbirdSdkUserAgentWithExtension(s)});return e||(u["Content-Type"]="application/json; charset=utf-8"),t.requireAuth&&!t.hasSessionKey&&this._session.hasSession&&(u["Session-Key"]=this._session.sessionKey),u["App-Id"]=i,this._session&&this._session.authToken&&(u["Access-Token"]=this._session.authToken),u},n.prototype._statLogApiResult=function(t,e,r){t.path.includes("/sdk/statistics")||this._dispatcher.dispatch(new Qb(new Or({type:gr.API_RESULT,data:{endpoint:t.path,method:t.method,success:!r,latency:Date.now()-e,error_code:r==null?void 0:r.code,error_description:r==null?void 0:r.message}})))},n.prototype._isBodyRequired=function(t){var e=t.method;return e!==Ie.GET&&(e!==Ie.DELETE||t instanceof g2)},n.prototype.send=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D;return R(this,function(P){switch(P.label){case 0:e=t.path,r=t.method,i=t.uploadProgressHandler,a=this._isBodyRequired(t),s=this._sdkState.api,u="".concat(s.host).concat(e).concat(a?"":t.query),d=a?t.payload:null,h=this._createHeader(t,d instanceof FormData?d:void 0),p=new AbortController,g=p.signal,this._abortControl.set(t.requestId,p),E=Date.now(),P.label=1;case 1:return P.trys.push([1,13,,14]),i?[4,y_(()=>import("./__bundle-a2eabc21-BOE1ITUu.js"),__vite__mapDeps([0,1,2,3]))]:[3,6];case 2:y=P.sent().xmlHttpRequest,P.label=3;case 3:return P.trys.push([3,5,,6]),[4,y(this._iid,{requestId:t.requestId,method:t.method,url:u,headers:h,data:d??void 0,uploadProgressHandler:i})];case 4:return C=P.sent(),this._logger.debug("receive api response",t.requestId),this._statLogApiResult(t,E),[2,C];case 5:if(!((T=P.sent())instanceof ee&&T.code===rn.XMLHTTPREQUEST_NOT_SUPPORTED))throw T;return this._logger.debug("XMLHttpRequest is not available in this environment. progressHandler is ignored."),[3,6];case 6:return this._shouldImportFetchCompat&&(this._shouldImportFetchCompat=!1,(typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{fetch:null}).fetch=null),typeof AbortController<"u"?[3,8]:[4,y_(()=>import("./index-DJ0IS-oA.js").then(U=>U.f),__vite__mapDeps([1,2]))];case 7:P.sent(),P.label=8;case 8:return typeof fetch=="function"?[3,10]:[4,y_(()=>import("./__bundle-46d64517-BMFsvfX6.js").then(U=>U._),__vite__mapDeps([4,1,2]))];case 9:P.sent(),P.label=10;case 10:return[4,fetch(u,{method:r,body:d,headers:h,signal:g})];case 11:return[4,(A=P.sent()).json()];case 12:if(O=P.sent(),A.ok||A.redirected)return this._logger.debug("receive api response",t.requestId),this._statLogApiResult(t,E),[2,new Me(this._iid,O)];if(O){if((N=new ee(O)).isSessionExpiredError){if(this._dispatcher.dispatch(new mc({reason:N.code,message:N.message})),!(t instanceof Yb))return k=new Qi,this._dispatcher.dispatch(new m2({request:t,deferred:k,error:N})),[2,k.promise];throw N}throw N.isSessionInvalidatedError&&this._dispatcher.dispatch(new mc({reason:N.code,message:N.message})),N}throw ee.requestFailed;case 13:throw D=P.sent(),this._statLogApiResult(t,E,D),D instanceof ee?(this._logger.debug("fail api request",D),D):(D==null?void 0:D.name)==="AbortError"?ee.requestCanceled:(this._logger.debug("fail api request",D),ee.networkError);case 14:return[2]}})})},n.prototype.cancel=function(t){this._abortControl.has(t)&&(this._abortControl.get(t).abort(),this._abortControl.delete(t)),this._dispatcher.dispatch(new j_({requestId:t}))},n.prototype.cancelAll=function(){var t,e;try{for(var r=Le(this._abortControl.values()),i=r.next();!i.done;i=r.next())i.value.abort()}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this._abortControl.clear(),this._dispatcher.dispatch(new j_({}))},n}(),Kn=function(){};function Sc(n){let t=n.length;for(;--t>=0;)n[t]=0}const Zb=256,E2=286,Zf=30,Xf=15,XE=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),b_=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),G5=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),xN=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Au=new Array(576);Sc(Au);const Jf=new Array(60);Sc(Jf);const vh=new Array(512);Sc(vh);const eh=new Array(256);Sc(eh);const Xb=new Array(29);Sc(Xb);const q_=new Array(Zf);function Wv(n,t,e,r,i){this.static_tree=n,this.extra_bits=t,this.extra_base=e,this.elems=r,this.max_length=i,this.has_stree=n&&n.length}let UN,PN,FN;function $v(n,t){this.dyn_tree=n,this.max_code=0,this.stat_desc=t}Sc(q_);const y2=n=>n<256?vh[n]:vh[256+(n>>>7)],Eh=(n,t)=>{n.pending_buf[n.pending++]=255&t,n.pending_buf[n.pending++]=t>>>8&255},Sa=(n,t,e)=>{n.bi_valid>16-e?(n.bi_buf|=t<<n.bi_valid&65535,Eh(n,n.bi_buf),n.bi_buf=t>>16-n.bi_valid,n.bi_valid+=e-16):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=e)},Zs=(n,t,e)=>{Sa(n,e[2*t],e[2*t+1])},b2=(n,t)=>{let e=0;do e|=1&n,n>>>=1,e<<=1;while(--t>0);return e>>>1},C2=(n,t,e)=>{const r=new Array(16);let i,a,s=0;for(i=1;i<=Xf;i++)s=s+e[i-1]<<1,r[i]=s;for(a=0;a<=t;a++){let u=n[2*a+1];u!==0&&(n[2*a]=b2(r[u]++,u))}},I2=n=>{let t;for(t=0;t<E2;t++)n.dyn_ltree[2*t]=0;for(t=0;t<Zf;t++)n.dyn_dtree[2*t]=0;for(t=0;t<19;t++)n.bl_tree[2*t]=0;n.dyn_ltree[512]=1,n.opt_len=n.static_len=0,n.sym_next=n.matches=0},T2=n=>{n.bi_valid>8?Eh(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},HN=(n,t,e,r)=>{const i=2*t,a=2*e;return n[i]<n[a]||n[i]===n[a]&&r[t]<=r[e]},Yv=(n,t,e)=>{const r=n.heap[e];let i=e<<1;for(;i<=n.heap_len&&(i<n.heap_len&&HN(t,n.heap[i+1],n.heap[i],n.depth)&&i++,!HN(t,r,n.heap[i],n.depth));)n.heap[e]=n.heap[i],e=i,i<<=1;n.heap[e]=r},BN=(n,t,e)=>{let r,i,a,s,u=0;if(n.sym_next!==0)do r=255&n.pending_buf[n.sym_buf+u++],r+=(255&n.pending_buf[n.sym_buf+u++])<<8,i=n.pending_buf[n.sym_buf+u++],r===0?Zs(n,i,t):(a=eh[i],Zs(n,a+Zb+1,t),s=XE[a],s!==0&&(i-=Xb[a],Sa(n,i,s)),r--,a=y2(r),Zs(n,a,e),s=b_[a],s!==0&&(r-=q_[a],Sa(n,r,s)));while(u<n.sym_next);Zs(n,256,t)},Qv=(n,t)=>{const e=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let s,u,d,h=-1;for(n.heap_len=0,n.heap_max=573,s=0;s<a;s++)e[2*s]!==0?(n.heap[++n.heap_len]=h=s,n.depth[s]=0):e[2*s+1]=0;for(;n.heap_len<2;)d=n.heap[++n.heap_len]=h<2?++h:0,e[2*d]=1,n.depth[d]=0,n.opt_len--,i&&(n.static_len-=r[2*d+1]);for(t.max_code=h,s=n.heap_len>>1;s>=1;s--)Yv(n,e,s);d=a;do s=n.heap[1],n.heap[1]=n.heap[n.heap_len--],Yv(n,e,1),u=n.heap[1],n.heap[--n.heap_max]=s,n.heap[--n.heap_max]=u,e[2*d]=e[2*s]+e[2*u],n.depth[d]=(n.depth[s]>=n.depth[u]?n.depth[s]:n.depth[u])+1,e[2*s+1]=e[2*u+1]=d,n.heap[1]=d++,Yv(n,e,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],((p,g)=>{const E=g.dyn_tree,y=g.max_code,C=g.stat_desc.static_tree,T=g.stat_desc.has_stree,A=g.stat_desc.extra_bits,O=g.stat_desc.extra_base,N=g.stat_desc.max_length;let k,D,P,U,L,B,q=0;for(U=0;U<=Xf;U++)p.bl_count[U]=0;for(E[2*p.heap[p.heap_max]+1]=0,k=p.heap_max+1;k<573;k++)D=p.heap[k],U=E[2*E[2*D+1]+1]+1,U>N&&(U=N,q++),E[2*D+1]=U,D>y||(p.bl_count[U]++,L=0,D>=O&&(L=A[D-O]),B=E[2*D],p.opt_len+=B*(U+L),T&&(p.static_len+=B*(C[2*D+1]+L)));if(q!==0){do{for(U=N-1;p.bl_count[U]===0;)U--;p.bl_count[U]--,p.bl_count[U+1]+=2,p.bl_count[N]--,q-=2}while(q>0);for(U=N;U!==0;U--)for(D=p.bl_count[U];D!==0;)P=p.heap[--k],P>y||(E[2*P+1]!==U&&(p.opt_len+=(U-E[2*P+1])*E[2*P],E[2*P+1]=U),D--)}})(n,t),C2(e,h,n.bl_count)},GN=(n,t,e)=>{let r,i,a=-1,s=t[1],u=0,d=7,h=4;for(s===0&&(d=138,h=3),t[2*(e+1)+1]=65535,r=0;r<=e;r++)i=s,s=t[2*(r+1)+1],++u<d&&i===s||(u<h?n.bl_tree[2*i]+=u:i!==0?(i!==a&&n.bl_tree[2*i]++,n.bl_tree[32]++):u<=10?n.bl_tree[34]++:n.bl_tree[36]++,u=0,a=i,s===0?(d=138,h=3):i===s?(d=6,h=3):(d=7,h=4))},VN=(n,t,e)=>{let r,i,a=-1,s=t[1],u=0,d=7,h=4;for(s===0&&(d=138,h=3),r=0;r<=e;r++)if(i=s,s=t[2*(r+1)+1],!(++u<d&&i===s)){if(u<h)do Zs(n,i,n.bl_tree);while(--u!=0);else i!==0?(i!==a&&(Zs(n,i,n.bl_tree),u--),Zs(n,16,n.bl_tree),Sa(n,u-3,2)):u<=10?(Zs(n,17,n.bl_tree),Sa(n,u-3,3)):(Zs(n,18,n.bl_tree),Sa(n,u-11,7));u=0,a=i,s===0?(d=138,h=3):i===s?(d=6,h=3):(d=7,h=4)}};let jN=!1;const S2=(n,t,e,r)=>{Sa(n,0+(r?1:0),3),T2(n),Eh(n,e),Eh(n,~e),e&&n.pending_buf.set(n.window.subarray(t,t+e),n.pending),n.pending+=e};var V5=(n,t,e,r)=>{let i,a,s=0;n.level>0?(n.strm.data_type===2&&(n.strm.data_type=(u=>{let d,h=4093624447;for(d=0;d<=31;d++,h>>>=1)if(1&h&&u.dyn_ltree[2*d]!==0)return 0;if(u.dyn_ltree[18]!==0||u.dyn_ltree[20]!==0||u.dyn_ltree[26]!==0)return 1;for(d=32;d<Zb;d++)if(u.dyn_ltree[2*d]!==0)return 1;return 0})(n)),Qv(n,n.l_desc),Qv(n,n.d_desc),s=(u=>{let d;for(GN(u,u.dyn_ltree,u.l_desc.max_code),GN(u,u.dyn_dtree,u.d_desc.max_code),Qv(u,u.bl_desc),d=18;d>=3&&u.bl_tree[2*xN[d]+1]===0;d--);return u.opt_len+=3*(d+1)+5+5+4,d})(n),i=n.opt_len+3+7>>>3,a=n.static_len+3+7>>>3,a<=i&&(i=a)):i=a=e+5,e+4<=i&&t!==-1?S2(n,t,e,r):n.strategy===4||a===i?(Sa(n,2+(r?1:0),3),BN(n,Au,Jf)):(Sa(n,4+(r?1:0),3),((u,d,h,p)=>{let g;for(Sa(u,d-257,5),Sa(u,h-1,5),Sa(u,p-4,4),g=0;g<p;g++)Sa(u,u.bl_tree[2*xN[g]+1],3);VN(u,u.dyn_ltree,d-1),VN(u,u.dyn_dtree,h-1)})(n,n.l_desc.max_code+1,n.d_desc.max_code+1,s+1),BN(n,n.dyn_ltree,n.dyn_dtree)),I2(n),r&&T2(n)},j5={_tr_init:n=>{jN||((()=>{let t,e,r,i,a;const s=new Array(16);for(r=0,i=0;i<28;i++)for(Xb[i]=r,t=0;t<1<<XE[i];t++)eh[r++]=i;for(eh[r-1]=i,a=0,i=0;i<16;i++)for(q_[i]=a,t=0;t<1<<b_[i];t++)vh[a++]=i;for(a>>=7;i<Zf;i++)for(q_[i]=a<<7,t=0;t<1<<b_[i]-7;t++)vh[256+a++]=i;for(e=0;e<=Xf;e++)s[e]=0;for(t=0;t<=143;)Au[2*t+1]=8,t++,s[8]++;for(;t<=255;)Au[2*t+1]=9,t++,s[9]++;for(;t<=279;)Au[2*t+1]=7,t++,s[7]++;for(;t<=287;)Au[2*t+1]=8,t++,s[8]++;for(C2(Au,287,s),t=0;t<Zf;t++)Jf[2*t+1]=5,Jf[2*t]=b2(t,5);UN=new Wv(Au,XE,257,E2,Xf),PN=new Wv(Jf,b_,0,Zf,Xf),FN=new Wv(new Array(0),G5,0,19,7)})(),jN=!0),n.l_desc=new $v(n.dyn_ltree,UN),n.d_desc=new $v(n.dyn_dtree,PN),n.bl_desc=new $v(n.bl_tree,FN),n.bi_buf=0,n.bi_valid=0,I2(n)},_tr_stored_block:S2,_tr_flush_block:V5,_tr_tally:(n,t,e)=>(n.pending_buf[n.sym_buf+n.sym_next++]=t,n.pending_buf[n.sym_buf+n.sym_next++]=t>>8,n.pending_buf[n.sym_buf+n.sym_next++]=e,t===0?n.dyn_ltree[2*e]++:(n.matches++,t--,n.dyn_ltree[2*(eh[e]+Zb+1)]++,n.dyn_dtree[2*y2(t)]++),n.sym_next===n.sym_end),_tr_align:n=>{Sa(n,2,3),Zs(n,256,Au),(t=>{t.bi_valid===16?(Eh(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(n)}},nh=(n,t,e,r)=>{let i=65535&n,a=n>>>16&65535,s=0;for(;e!==0;){s=e>2e3?2e3:e,e-=s;do i=i+t[r++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16};const q5=new Uint32Array((()=>{let n,t=[];for(var e=0;e<256;e++){n=e;for(var r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t})());var Ti=(n,t,e,r)=>{const i=q5,a=r+e;n^=-1;for(let s=r;s<a;s++)n=n>>>8^i[255&(n^t[s])];return~n},Ql={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ad={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:z5,_tr_stored_block:JE,_tr_flush_block:K5,_tr_tally:Ro,_tr_align:W5}=j5,{Z_NO_FLUSH:Mo,Z_PARTIAL_FLUSH:$5,Z_FULL_FLUSH:Y5,Z_FINISH:os,Z_BLOCK:qN,Z_OK:Ui,Z_STREAM_END:zN,Z_STREAM_ERROR:Ks,Z_DATA_ERROR:Q5,Z_BUF_ERROR:Zv,Z_DEFAULT_COMPRESSION:Z5,Z_FILTERED:X5,Z_HUFFMAN_ONLY:zp,Z_RLE:J5,Z_FIXED:eF,Z_DEFAULT_STRATEGY:nF,Z_UNKNOWN:tF,Z_DEFLATED:z_}=ad,Fl=258,ru=262,dc=42,wl=113,jf=666,Rl=(n,t)=>(n.msg=Ql[t],t),KN=n=>2*n-(n>4?9:0),bo=n=>{let t=n.length;for(;--t>=0;)n[t]=0},rF=n=>{let t,e,r,i=n.w_size;t=n.hash_size,r=t;do e=n.head[--r],n.head[r]=e>=i?e-i:0;while(--t);t=i,r=t;do e=n.prev[--r],n.prev[r]=e>=i?e-i:0;while(--t)};let Oo=(n,t,e)=>(t<<n.hash_shift^e)&n.hash_mask;const Pa=n=>{const t=n.state;let e=t.pending;e>n.avail_out&&(e=n.avail_out),e!==0&&(n.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),n.next_out),n.next_out+=e,t.pending_out+=e,n.total_out+=e,n.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},Va=(n,t)=>{K5(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t),n.block_start=n.strstart,Pa(n.strm)},_r=(n,t)=>{n.pending_buf[n.pending++]=t},Tf=(n,t)=>{n.pending_buf[n.pending++]=t>>>8&255,n.pending_buf[n.pending++]=255&t},ey=(n,t,e,r)=>{let i=n.avail_in;return i>r&&(i=r),i===0?0:(n.avail_in-=i,t.set(n.input.subarray(n.next_in,n.next_in+i),e),n.state.wrap===1?n.adler=nh(n.adler,t,i,e):n.state.wrap===2&&(n.adler=Ti(n.adler,t,i,e)),n.next_in+=i,n.total_in+=i,i)},N2=(n,t)=>{let e,r,i=n.max_chain_length,a=n.strstart,s=n.prev_length,u=n.nice_match;const d=n.strstart>n.w_size-ru?n.strstart-(n.w_size-ru):0,h=n.window,p=n.w_mask,g=n.prev,E=n.strstart+Fl;let y=h[a+s-1],C=h[a+s];n.prev_length>=n.good_match&&(i>>=2),u>n.lookahead&&(u=n.lookahead);do if(e=t,h[e+s]===C&&h[e+s-1]===y&&h[e]===h[a]&&h[++e]===h[a+1]){a+=2,e++;do;while(h[++a]===h[++e]&&h[++a]===h[++e]&&h[++a]===h[++e]&&h[++a]===h[++e]&&h[++a]===h[++e]&&h[++a]===h[++e]&&h[++a]===h[++e]&&h[++a]===h[++e]&&a<E);if(r=Fl-(E-a),a=E-Fl,r>s){if(n.match_start=t,s=r,r>=u)break;y=h[a+s-1],C=h[a+s]}}while((t=g[t&p])>d&&--i!=0);return s<=n.lookahead?s:n.lookahead},oc=n=>{const t=n.w_size;let e,r,i;do{if(r=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-ru)&&(n.window.set(n.window.subarray(t,t+t-r),0),n.match_start-=t,n.strstart-=t,n.block_start-=t,n.insert>n.strstart&&(n.insert=n.strstart),rF(n),r+=t),n.strm.avail_in===0)break;if(e=ey(n.strm,n.window,n.strstart+n.lookahead,r),n.lookahead+=e,n.lookahead+n.insert>=3)for(i=n.strstart-n.insert,n.ins_h=n.window[i],n.ins_h=Oo(n,n.ins_h,n.window[i+1]);n.insert&&(n.ins_h=Oo(n,n.ins_h,n.window[i+3-1]),n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,n.insert--,!(n.lookahead+n.insert<3)););}while(n.lookahead<ru&&n.strm.avail_in!==0)},A2=(n,t)=>{let e,r,i,a=n.pending_buf_size-5>n.w_size?n.w_size:n.pending_buf_size-5,s=0,u=n.strm.avail_in;do{if(e=65535,i=n.bi_valid+42>>3,n.strm.avail_out<i||(i=n.strm.avail_out-i,r=n.strstart-n.block_start,e>r+n.strm.avail_in&&(e=r+n.strm.avail_in),e>i&&(e=i),e<a&&(e===0&&t!==os||t===Mo||e!==r+n.strm.avail_in)))break;s=t===os&&e===r+n.strm.avail_in?1:0,JE(n,0,0,s),n.pending_buf[n.pending-4]=e,n.pending_buf[n.pending-3]=e>>8,n.pending_buf[n.pending-2]=~e,n.pending_buf[n.pending-1]=~e>>8,Pa(n.strm),r&&(r>e&&(r=e),n.strm.output.set(n.window.subarray(n.block_start,n.block_start+r),n.strm.next_out),n.strm.next_out+=r,n.strm.avail_out-=r,n.strm.total_out+=r,n.block_start+=r,e-=r),e&&(ey(n.strm,n.strm.output,n.strm.next_out,e),n.strm.next_out+=e,n.strm.avail_out-=e,n.strm.total_out+=e)}while(s===0);return u-=n.strm.avail_in,u&&(u>=n.w_size?(n.matches=2,n.window.set(n.strm.input.subarray(n.strm.next_in-n.w_size,n.strm.next_in),0),n.strstart=n.w_size,n.insert=n.strstart):(n.window_size-n.strstart<=u&&(n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,n.insert>n.strstart&&(n.insert=n.strstart)),n.window.set(n.strm.input.subarray(n.strm.next_in-u,n.strm.next_in),n.strstart),n.strstart+=u,n.insert+=u>n.w_size-n.insert?n.w_size-n.insert:u),n.block_start=n.strstart),n.high_water<n.strstart&&(n.high_water=n.strstart),s?4:t!==Mo&&t!==os&&n.strm.avail_in===0&&n.strstart===n.block_start?2:(i=n.window_size-n.strstart,n.strm.avail_in>i&&n.block_start>=n.w_size&&(n.block_start-=n.w_size,n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,i+=n.w_size,n.insert>n.strstart&&(n.insert=n.strstart)),i>n.strm.avail_in&&(i=n.strm.avail_in),i&&(ey(n.strm,n.window,n.strstart,i),n.strstart+=i,n.insert+=i>n.w_size-n.insert?n.w_size-n.insert:i),n.high_water<n.strstart&&(n.high_water=n.strstart),i=n.bi_valid+42>>3,i=n.pending_buf_size-i>65535?65535:n.pending_buf_size-i,a=i>n.w_size?n.w_size:i,r=n.strstart-n.block_start,(r>=a||(r||t===os)&&t!==Mo&&n.strm.avail_in===0&&r<=i)&&(e=r>i?i:r,s=t===os&&n.strm.avail_in===0&&e===r?1:0,JE(n,n.block_start,e,s),n.block_start+=e,Pa(n.strm)),s?3:1)},Xv=(n,t)=>{let e,r;for(;;){if(n.lookahead<ru){if(oc(n),n.lookahead<ru&&t===Mo)return 1;if(n.lookahead===0)break}if(e=0,n.lookahead>=3&&(n.ins_h=Oo(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),e!==0&&n.strstart-e<=n.w_size-ru&&(n.match_length=N2(n,e)),n.match_length>=3)if(r=Ro(n,n.strstart-n.match_start,n.match_length-3),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=3){n.match_length--;do n.strstart++,n.ins_h=Oo(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!=0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=Oo(n,n.ins_h,n.window[n.strstart+1]);else r=Ro(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(r&&(Va(n,!1),n.strm.avail_out===0))return 1}return n.insert=n.strstart<2?n.strstart:2,t===os?(Va(n,!0),n.strm.avail_out===0?3:4):n.sym_next&&(Va(n,!1),n.strm.avail_out===0)?1:2},Yd=(n,t)=>{let e,r,i;for(;;){if(n.lookahead<ru){if(oc(n),n.lookahead<ru&&t===Mo)return 1;if(n.lookahead===0)break}if(e=0,n.lookahead>=3&&(n.ins_h=Oo(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=2,e!==0&&n.prev_length<n.max_lazy_match&&n.strstart-e<=n.w_size-ru&&(n.match_length=N2(n,e),n.match_length<=5&&(n.strategy===X5||n.match_length===3&&n.strstart-n.match_start>4096)&&(n.match_length=2)),n.prev_length>=3&&n.match_length<=n.prev_length){i=n.strstart+n.lookahead-3,r=Ro(n,n.strstart-1-n.prev_match,n.prev_length-3),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=i&&(n.ins_h=Oo(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!=0);if(n.match_available=0,n.match_length=2,n.strstart++,r&&(Va(n,!1),n.strm.avail_out===0))return 1}else if(n.match_available){if(r=Ro(n,0,n.window[n.strstart-1]),r&&Va(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return 1}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(r=Ro(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<2?n.strstart:2,t===os?(Va(n,!0),n.strm.avail_out===0?3:4):n.sym_next&&(Va(n,!1),n.strm.avail_out===0)?1:2};function zs(n,t,e,r,i){this.good_length=n,this.max_lazy=t,this.nice_length=e,this.max_chain=r,this.func=i}const qf=[new zs(0,0,0,0,A2),new zs(4,4,8,4,Xv),new zs(4,5,16,8,Xv),new zs(4,6,32,32,Xv),new zs(4,4,16,16,Yd),new zs(8,16,32,32,Yd),new zs(8,16,128,128,Yd),new zs(8,32,128,256,Yd),new zs(32,128,258,1024,Yd),new zs(32,258,258,4096,Yd)];function iF(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=z_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),bo(this.dyn_ltree),bo(this.dyn_dtree),bo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),bo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),bo(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const zf=n=>{if(!n)return 1;const t=n.state;return!t||t.strm!==n||t.status!==dc&&t.status!==57&&t.status!==69&&t.status!==73&&t.status!==91&&t.status!==103&&t.status!==wl&&t.status!==jf?1:0},w2=n=>{if(zf(n))return Rl(n,Ks);n.total_in=n.total_out=0,n.data_type=tF;const t=n.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?57:t.wrap?dc:wl,n.adler=t.wrap===2?0:1,t.last_flush=-2,z5(t),Ui},R2=n=>{const t=w2(n);var e;return t===Ui&&((e=n.state).window_size=2*e.w_size,bo(e.head),e.max_lazy_match=qf[e.level].max_lazy,e.good_match=qf[e.level].good_length,e.nice_match=qf[e.level].nice_length,e.max_chain_length=qf[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),t},WN=(n,t,e,r,i,a)=>{if(!n)return Ks;let s=1;if(t===Z5&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>9||e!==z_||r<8||r>15||t<0||t>9||a<0||a>eF||r===8&&s!==1)return Rl(n,Ks);r===8&&(r=9);const u=new iF;return n.state=u,u.strm=n,u.status=dc,u.wrap=s,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=i+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new Uint8Array(2*u.w_size),u.head=new Uint16Array(u.hash_size),u.prev=new Uint16Array(u.w_size),u.lit_bufsize=1<<i+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new Uint8Array(u.pending_buf_size),u.sym_buf=u.lit_bufsize,u.sym_end=3*(u.lit_bufsize-1),u.level=t,u.strategy=a,u.method=e,R2(n)};var th={deflateInit:(n,t)=>WN(n,t,z_,15,8,nF),deflateInit2:WN,deflateReset:R2,deflateResetKeep:w2,deflateSetHeader:(n,t)=>zf(n)||n.state.wrap!==2?Ks:(n.state.gzhead=t,Ui),deflate:(n,t)=>{if(zf(n)||t>qN||t<0)return n?Rl(n,Ks):Ks;const e=n.state;if(!n.output||n.avail_in!==0&&!n.input||e.status===jf&&t!==os)return Rl(n,n.avail_out===0?Zv:Ks);const r=e.last_flush;if(e.last_flush=t,e.pending!==0){if(Pa(n),n.avail_out===0)return e.last_flush=-1,Ui}else if(n.avail_in===0&&KN(t)<=KN(r)&&t!==os)return Rl(n,Zv);if(e.status===jf&&n.avail_in!==0)return Rl(n,Zv);if(e.status===dc&&e.wrap===0&&(e.status=wl),e.status===dc){let i=z_+(e.w_bits-8<<4)<<8,a=-1;if(a=e.strategy>=zp||e.level<2?0:e.level<6?1:e.level===6?2:3,i|=a<<6,e.strstart!==0&&(i|=32),i+=31-i%31,Tf(e,i),e.strstart!==0&&(Tf(e,n.adler>>>16),Tf(e,65535&n.adler)),n.adler=1,e.status=wl,Pa(n),e.pending!==0)return e.last_flush=-1,Ui}if(e.status===57){if(n.adler=0,_r(e,31),_r(e,139),_r(e,8),e.gzhead)_r(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),_r(e,255&e.gzhead.time),_r(e,e.gzhead.time>>8&255),_r(e,e.gzhead.time>>16&255),_r(e,e.gzhead.time>>24&255),_r(e,e.level===9?2:e.strategy>=zp||e.level<2?4:0),_r(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(_r(e,255&e.gzhead.extra.length),_r(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(n.adler=Ti(n.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69;else if(_r(e,0),_r(e,0),_r(e,0),_r(e,0),_r(e,0),_r(e,e.level===9?2:e.strategy>=zp||e.level<2?4:0),_r(e,3),e.status=wl,Pa(n),e.pending!==0)return e.last_flush=-1,Ui}if(e.status===69){if(e.gzhead.extra){let i=e.pending,a=(65535&e.gzhead.extra.length)-e.gzindex;for(;e.pending+a>e.pending_buf_size;){let u=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+u),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>i&&(n.adler=Ti(n.adler,e.pending_buf,e.pending-i,i)),e.gzindex+=u,Pa(n),e.pending!==0)return e.last_flush=-1,Ui;i=0,a-=u}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending+=a,e.gzhead.hcrc&&e.pending>i&&(n.adler=Ti(n.adler,e.pending_buf,e.pending-i,i)),e.gzindex=0}e.status=73}if(e.status===73){if(e.gzhead.name){let i,a=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>a&&(n.adler=Ti(n.adler,e.pending_buf,e.pending-a,a)),Pa(n),e.pending!==0)return e.last_flush=-1,Ui;a=0}i=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,_r(e,i)}while(i!==0);e.gzhead.hcrc&&e.pending>a&&(n.adler=Ti(n.adler,e.pending_buf,e.pending-a,a)),e.gzindex=0}e.status=91}if(e.status===91){if(e.gzhead.comment){let i,a=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>a&&(n.adler=Ti(n.adler,e.pending_buf,e.pending-a,a)),Pa(n),e.pending!==0)return e.last_flush=-1,Ui;a=0}i=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,_r(e,i)}while(i!==0);e.gzhead.hcrc&&e.pending>a&&(n.adler=Ti(n.adler,e.pending_buf,e.pending-a,a))}e.status=103}if(e.status===103){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(Pa(n),e.pending!==0))return e.last_flush=-1,Ui;_r(e,255&n.adler),_r(e,n.adler>>8&255),n.adler=0}if(e.status=wl,Pa(n),e.pending!==0)return e.last_flush=-1,Ui}if(n.avail_in!==0||e.lookahead!==0||t!==Mo&&e.status!==jf){let i=e.level===0?A2(e,t):e.strategy===zp?((a,s)=>{let u;for(;;){if(a.lookahead===0&&(oc(a),a.lookahead===0)){if(s===Mo)return 1;break}if(a.match_length=0,u=Ro(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,u&&(Va(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,s===os?(Va(a,!0),a.strm.avail_out===0?3:4):a.sym_next&&(Va(a,!1),a.strm.avail_out===0)?1:2})(e,t):e.strategy===J5?((a,s)=>{let u,d,h,p;const g=a.window;for(;;){if(a.lookahead<=Fl){if(oc(a),a.lookahead<=Fl&&s===Mo)return 1;if(a.lookahead===0)break}if(a.match_length=0,a.lookahead>=3&&a.strstart>0&&(h=a.strstart-1,d=g[h],d===g[++h]&&d===g[++h]&&d===g[++h])){p=a.strstart+Fl;do;while(d===g[++h]&&d===g[++h]&&d===g[++h]&&d===g[++h]&&d===g[++h]&&d===g[++h]&&d===g[++h]&&d===g[++h]&&h<p);a.match_length=Fl-(p-h),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=3?(u=Ro(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(u=Ro(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),u&&(Va(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,s===os?(Va(a,!0),a.strm.avail_out===0?3:4):a.sym_next&&(Va(a,!1),a.strm.avail_out===0)?1:2})(e,t):qf[e.level].func(e,t);if(i!==3&&i!==4||(e.status=jf),i===1||i===3)return n.avail_out===0&&(e.last_flush=-1),Ui;if(i===2&&(t===$5?W5(e):t!==qN&&(JE(e,0,0,!1),t===Y5&&(bo(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),Pa(n),n.avail_out===0))return e.last_flush=-1,Ui}return t!==os?Ui:e.wrap<=0?zN:(e.wrap===2?(_r(e,255&n.adler),_r(e,n.adler>>8&255),_r(e,n.adler>>16&255),_r(e,n.adler>>24&255),_r(e,255&n.total_in),_r(e,n.total_in>>8&255),_r(e,n.total_in>>16&255),_r(e,n.total_in>>24&255)):(Tf(e,n.adler>>>16),Tf(e,65535&n.adler)),Pa(n),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?Ui:zN)},deflateEnd:n=>{if(zf(n))return Ks;const t=n.state.status;return n.state=null,t===wl?Rl(n,Q5):Ui},deflateSetDictionary:(n,t)=>{let e=t.length;if(zf(n))return Ks;const r=n.state,i=r.wrap;if(i===2||i===1&&r.status!==dc||r.lookahead)return Ks;if(i===1&&(n.adler=nh(n.adler,t,e,0)),r.wrap=0,e>=r.w_size){i===0&&(bo(r.head),r.strstart=0,r.block_start=0,r.insert=0);let d=new Uint8Array(r.w_size);d.set(t.subarray(e-r.w_size,e),0),t=d,e=r.w_size}const a=n.avail_in,s=n.next_in,u=n.input;for(n.avail_in=e,n.next_in=0,n.input=t,oc(r);r.lookahead>=3;){let d=r.strstart,h=r.lookahead-2;do r.ins_h=Oo(r,r.ins_h,r.window[d+3-1]),r.prev[d&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=d,d++;while(--h);r.strstart=d,r.lookahead=2,oc(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,n.next_in=s,n.input=u,n.avail_in=a,r.wrap=i,Ui},deflateInfo:"pako deflate (from Nodeca project)"};const aF=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var M2=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const r in e)aF(e,r)&&(n[r]=e[r])}}return n},O2=n=>{let t=0;for(let r=0,i=n.length;r<i;r++)t+=n[r].length;const e=new Uint8Array(t);for(let r=0,i=0,a=n.length;r<a;r++){let s=n[r];e.set(s,i),i+=s.length}return e};let k2=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{k2=!1}const yh=new Uint8Array(256);for(let n=0;n<256;n++)yh[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;yh[254]=yh[254]=1;var Jb=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let t,e,r,i,a,s=n.length,u=0;for(i=0;i<s;i++)e=n.charCodeAt(i),(64512&e)==55296&&i+1<s&&(r=n.charCodeAt(i+1),(64512&r)==56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),u+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(u),a=0,i=0;a<u;i++)e=n.charCodeAt(i),(64512&e)==55296&&i+1<s&&(r=n.charCodeAt(i+1),(64512&r)==56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),e<128?t[a++]=e:e<2048?(t[a++]=192|e>>>6,t[a++]=128|63&e):e<65536?(t[a++]=224|e>>>12,t[a++]=128|e>>>6&63,t[a++]=128|63&e):(t[a++]=240|e>>>18,t[a++]=128|e>>>12&63,t[a++]=128|e>>>6&63,t[a++]=128|63&e);return t},sF=(n,t)=>{const e=t||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,t));let r,i;const a=new Array(2*e);for(i=0,r=0;r<e;){let s=n[r++];if(s<128){a[i++]=s;continue}let u=yh[s];if(u>4)a[i++]=65533,r+=u-1;else{for(s&=u===2?31:u===3?15:7;u>1&&r<e;)s=s<<6|63&n[r++],u--;u>1?a[i++]=65533:s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|1023&s)}}return((s,u)=>{if(u<65534&&s.subarray&&k2)return String.fromCharCode.apply(null,s.length===u?s:s.subarray(0,u));let d="";for(let h=0;h<u;h++)d+=String.fromCharCode(s[h]);return d})(a,i)},uF=(n,t)=>{(t=t||n.length)>n.length&&(t=n.length);let e=t-1;for(;e>=0&&(192&n[e])==128;)e--;return e<0||e===0?t:e+yh[n[e]]>t?e:t},D2=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const L2=Object.prototype.toString,{Z_NO_FLUSH:oF,Z_SYNC_FLUSH:lF,Z_FULL_FLUSH:dF,Z_FINISH:cF,Z_OK:K_,Z_STREAM_END:fF,Z_DEFAULT_COMPRESSION:hF,Z_DEFAULT_STRATEGY:pF,Z_DEFLATED:_F}=ad;function rh(n){this.options=M2({level:hF,method:_F,chunkSize:16384,windowBits:15,memLevel:8,strategy:pF},n||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D2,this.strm.avail_out=0;let e=th.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==K_)throw new Error(Ql[e]);if(t.header&&th.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(r=typeof t.dictionary=="string"?Jb(t.dictionary):L2.call(t.dictionary)==="[object ArrayBuffer]"?new Uint8Array(t.dictionary):t.dictionary,e=th.deflateSetDictionary(this.strm,r),e!==K_)throw new Error(Ql[e]);this._dict_set=!0}}function Jv(n,t){const e=new rh(t);if(e.push(n,!0),e.err)throw e.msg||Ql[e.err];return e.result}rh.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(a=t===~~t?t:t===!0?cF:oF,typeof n=="string"?e.input=Jb(n):L2.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;)if(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),(a===lF||a===dF)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(i=th.deflate(e,a),i===fF)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),i=th.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===K_;if(e.avail_out!==0){if(a>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(e.avail_in===0)break}else this.onData(e.output)}return!0},rh.prototype.onData=function(n){this.chunks.push(n)},rh.prototype.onEnd=function(n){n===K_&&(this.result=O2(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var mF={Deflate:rh,deflate:Jv,deflateRaw:function(n,t){return(t=t||{}).raw=!0,Jv(n,t)},gzip:function(n,t){return(t=t||{}).gzip=!0,Jv(n,t)},constants:ad};const Kp=16209;var gF=function(n,t){let e,r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q;const z=n.state;e=n.next_in,B=n.input,r=e+(n.avail_in-5),i=n.next_out,q=n.output,a=i-(t-n.avail_out),s=i+(n.avail_out-257),u=z.dmax,d=z.wsize,h=z.whave,p=z.wnext,g=z.window,E=z.hold,y=z.bits,C=z.lencode,T=z.distcode,A=(1<<z.lenbits)-1,O=(1<<z.distbits)-1;e:do{y<15&&(E+=B[e++]<<y,y+=8,E+=B[e++]<<y,y+=8),N=C[E&A];n:for(;;){if(k=N>>>24,E>>>=k,y-=k,k=N>>>16&255,k===0)q[i++]=65535&N;else{if(!(16&k)){if(64&k){if(32&k){z.mode=16191;break e}n.msg="invalid literal/length code",z.mode=Kp;break e}N=C[(65535&N)+(E&(1<<k)-1)];continue n}for(D=65535&N,k&=15,k&&(y<k&&(E+=B[e++]<<y,y+=8),D+=E&(1<<k)-1,E>>>=k,y-=k),y<15&&(E+=B[e++]<<y,y+=8,E+=B[e++]<<y,y+=8),N=T[E&O];;){if(k=N>>>24,E>>>=k,y-=k,k=N>>>16&255,16&k){if(P=65535&N,k&=15,y<k&&(E+=B[e++]<<y,y+=8,y<k&&(E+=B[e++]<<y,y+=8)),P+=E&(1<<k)-1,P>u){n.msg="invalid distance too far back",z.mode=Kp;break e}if(E>>>=k,y-=k,k=i-a,P>k){if(k=P-k,k>h&&z.sane){n.msg="invalid distance too far back",z.mode=Kp;break e}if(U=0,L=g,p===0){if(U+=d-k,k<D){D-=k;do q[i++]=g[U++];while(--k);U=i-P,L=q}}else if(p<k){if(U+=d+p-k,k-=p,k<D){D-=k;do q[i++]=g[U++];while(--k);if(U=0,p<D){k=p,D-=k;do q[i++]=g[U++];while(--k);U=i-P,L=q}}}else if(U+=p-k,k<D){D-=k;do q[i++]=g[U++];while(--k);U=i-P,L=q}for(;D>2;)q[i++]=L[U++],q[i++]=L[U++],q[i++]=L[U++],D-=3;D&&(q[i++]=L[U++],D>1&&(q[i++]=L[U++]))}else{U=i-P;do q[i++]=q[U++],q[i++]=q[U++],q[i++]=q[U++],D-=3;while(D>2);D&&(q[i++]=q[U++],D>1&&(q[i++]=q[U++]))}break}if(64&k){n.msg="invalid distance code",z.mode=Kp;break e}N=T[(65535&N)+(E&(1<<k)-1)]}}break}}while(e<r&&i<s);D=y>>3,e-=D,y-=D<<3,E&=(1<<y)-1,n.next_in=e,n.next_out=i,n.avail_in=e<r?r-e+5:5-(e-r),n.avail_out=i<s?s-i+257:257-(i-s),z.hold=E,z.bits=y};const Wp=15,vF=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),EF=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yF=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),bF=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ih=(n,t,e,r,i,a,s,u)=>{const d=u.bits;let h,p,g,E,y,C,T=0,A=0,O=0,N=0,k=0,D=0,P=0,U=0,L=0,B=0,q=null;const z=new Uint16Array(16),Y=new Uint16Array(16);let Q,$,Z,ne=null;for(T=0;T<=Wp;T++)z[T]=0;for(A=0;A<r;A++)z[t[e+A]]++;for(k=d,N=Wp;N>=1&&z[N]===0;N--);if(k>N&&(k=N),N===0)return i[a++]=20971520,i[a++]=20971520,u.bits=1,0;for(O=1;O<N&&z[O]===0;O++);for(k<O&&(k=O),U=1,T=1;T<=Wp;T++)if(U<<=1,U-=z[T],U<0)return-1;if(U>0&&(n===0||N!==1))return-1;for(Y[1]=0,T=1;T<Wp;T++)Y[T+1]=Y[T]+z[T];for(A=0;A<r;A++)t[e+A]!==0&&(s[Y[t[e+A]]++]=A);if(n===0?(q=ne=s,C=20):n===1?(q=vF,ne=EF,C=257):(q=yF,ne=bF,C=0),B=0,A=0,T=O,y=a,D=k,P=0,g=-1,L=1<<k,E=L-1,n===1&&L>852||n===2&&L>592)return 1;for(;;){Q=T-P,s[A]+1<C?($=0,Z=s[A]):s[A]>=C?($=ne[s[A]-C],Z=q[s[A]-C]):($=96,Z=0),h=1<<T-P,p=1<<D,O=p;do p-=h,i[y+(B>>P)+p]=Q<<24|$<<16|Z;while(p!==0);for(h=1<<T-1;B&h;)h>>=1;if(h!==0?(B&=h-1,B+=h):B=0,A++,--z[T]==0){if(T===N)break;T=t[e+s[A]]}if(T>k&&(B&E)!==g){for(P===0&&(P=k),y+=O,D=T-P,U=1<<D;D+P<N&&(U-=z[D+P],!(U<=0));)D++,U<<=1;if(L+=1<<D,n===1&&L>852||n===2&&L>592)return 1;g=B&E,i[g]=k<<24|D<<16|y-a}}return B!==0&&(i[y+B]=T-P<<24|64<<16),u.bits=k,0};const{Z_FINISH:$N,Z_BLOCK:CF,Z_TREES:$p,Z_OK:Ml,Z_STREAM_END:IF,Z_NEED_DICT:TF,Z_STREAM_ERROR:us,Z_DATA_ERROR:YN,Z_MEM_ERROR:QN,Z_BUF_ERROR:SF,Z_DEFLATED:ZN}=ad,Nm=16180,Yp=16190,Iu=16191,eE=16192,nE=16194,Qp=16199,Zp=16200,tE=16206,Kr=16209,XN=n=>(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24);function NF(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Hl=n=>{if(!n)return 1;const t=n.state;return!t||t.strm!==n||t.mode<Nm||t.mode>16211?1:0},x2=n=>{if(Hl(n))return us;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=1&t.wrap),t.mode=Nm,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Ml},U2=n=>{if(Hl(n))return us;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,x2(n)},P2=(n,t)=>{let e;if(Hl(n))return us;const r=n.state;return t<0?(e=0,t=-t):(e=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?us:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=e,r.wbits=t,U2(n))},JN=(n,t)=>{if(!n)return us;const e=new NF;n.state=e,e.strm=n,e.window=null,e.mode=Nm;const r=P2(n,t);return r!==Ml&&(n.state=null),r};let rE,iE,e1=!0;const AF=n=>{if(e1){rE=new Int32Array(512),iE=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(ih(1,n.lens,0,288,rE,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;ih(2,n.lens,0,32,iE,0,n.work,{bits:5}),e1=!1}n.lencode=rE,n.lenbits=9,n.distcode=iE,n.distbits=5},n1=(n,t,e,r)=>{let i;const a=n.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(e-a.wsize,e),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(t.subarray(e-r,e-r+i),a.wnext),(r-=i)?(a.window.set(t.subarray(e-r,e),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0};var Mu={inflateReset:U2,inflateReset2:P2,inflateResetKeep:x2,inflateInit:n=>JN(n,15),inflateInit2:JN,inflate:(n,t)=>{let e,r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B=0;const q=new Uint8Array(4);let z,Y;const Q=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Hl(n)||!n.output||!n.input&&n.avail_in!==0)return us;e=n.state,e.mode===Iu&&(e.mode=eE),s=n.next_out,i=n.output,d=n.avail_out,a=n.next_in,r=n.input,u=n.avail_in,h=e.hold,p=e.bits,g=u,E=d,L=Ml;e:for(;;)switch(e.mode){case Nm:if(e.wrap===0){e.mode=eE;break}for(;p<16;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(2&e.wrap&&h===35615){e.wbits===0&&(e.wbits=15),e.check=0,q[0]=255&h,q[1]=h>>>8&255,e.check=Ti(e.check,q,2,0),h=0,p=0,e.mode=16181;break}if(e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&h)<<8)+(h>>8))%31){n.msg="incorrect header check",e.mode=Kr;break}if((15&h)!==ZN){n.msg="unknown compression method",e.mode=Kr;break}if(h>>>=4,p-=4,U=8+(15&h),e.wbits===0&&(e.wbits=U),U>15||U>e.wbits){n.msg="invalid window size",e.mode=Kr;break}e.dmax=1<<e.wbits,e.flags=0,n.adler=e.check=1,e.mode=512&h?16189:Iu,h=0,p=0;break;case 16181:for(;p<16;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(e.flags=h,(255&e.flags)!==ZN){n.msg="unknown compression method",e.mode=Kr;break}if(57344&e.flags){n.msg="unknown header flags set",e.mode=Kr;break}e.head&&(e.head.text=h>>8&1),512&e.flags&&4&e.wrap&&(q[0]=255&h,q[1]=h>>>8&255,e.check=Ti(e.check,q,2,0)),h=0,p=0,e.mode=16182;case 16182:for(;p<32;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}e.head&&(e.head.time=h),512&e.flags&&4&e.wrap&&(q[0]=255&h,q[1]=h>>>8&255,q[2]=h>>>16&255,q[3]=h>>>24&255,e.check=Ti(e.check,q,4,0)),h=0,p=0,e.mode=16183;case 16183:for(;p<16;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}e.head&&(e.head.xflags=255&h,e.head.os=h>>8),512&e.flags&&4&e.wrap&&(q[0]=255&h,q[1]=h>>>8&255,e.check=Ti(e.check,q,2,0)),h=0,p=0,e.mode=16184;case 16184:if(1024&e.flags){for(;p<16;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}e.length=h,e.head&&(e.head.extra_len=h),512&e.flags&&4&e.wrap&&(q[0]=255&h,q[1]=h>>>8&255,e.check=Ti(e.check,q,2,0)),h=0,p=0}else e.head&&(e.head.extra=null);e.mode=16185;case 16185:if(1024&e.flags&&(y=e.length,y>u&&(y=u),y&&(e.head&&(U=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(r.subarray(a,a+y),U)),512&e.flags&&4&e.wrap&&(e.check=Ti(e.check,r,y,a)),u-=y,a+=y,e.length-=y),e.length))break e;e.length=0,e.mode=16186;case 16186:if(2048&e.flags){if(u===0)break e;y=0;do U=r[a+y++],e.head&&U&&e.length<65536&&(e.head.name+=String.fromCharCode(U));while(U&&y<u);if(512&e.flags&&4&e.wrap&&(e.check=Ti(e.check,r,y,a)),u-=y,a+=y,U)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=16187;case 16187:if(4096&e.flags){if(u===0)break e;y=0;do U=r[a+y++],e.head&&U&&e.length<65536&&(e.head.comment+=String.fromCharCode(U));while(U&&y<u);if(512&e.flags&&4&e.wrap&&(e.check=Ti(e.check,r,y,a)),u-=y,a+=y,U)break e}else e.head&&(e.head.comment=null);e.mode=16188;case 16188:if(512&e.flags){for(;p<16;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(4&e.wrap&&h!==(65535&e.check)){n.msg="header crc mismatch",e.mode=Kr;break}h=0,p=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),n.adler=e.check=0,e.mode=Iu;break;case 16189:for(;p<32;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}n.adler=e.check=XN(h),h=0,p=0,e.mode=Yp;case Yp:if(e.havedict===0)return n.next_out=s,n.avail_out=d,n.next_in=a,n.avail_in=u,e.hold=h,e.bits=p,TF;n.adler=e.check=1,e.mode=Iu;case Iu:if(t===CF||t===$p)break e;case eE:if(e.last){h>>>=7&p,p-=7&p,e.mode=tE;break}for(;p<3;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}switch(e.last=1&h,h>>>=1,p-=1,3&h){case 0:e.mode=16193;break;case 1:if(AF(e),e.mode=Qp,t===$p){h>>>=2,p-=2;break e}break;case 2:e.mode=16196;break;case 3:n.msg="invalid block type",e.mode=Kr}h>>>=2,p-=2;break;case 16193:for(h>>>=7&p,p-=7&p;p<32;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if((65535&h)!=(h>>>16^65535)){n.msg="invalid stored block lengths",e.mode=Kr;break}if(e.length=65535&h,h=0,p=0,e.mode=nE,t===$p)break e;case nE:e.mode=16195;case 16195:if(y=e.length,y){if(y>u&&(y=u),y>d&&(y=d),y===0)break e;i.set(r.subarray(a,a+y),s),u-=y,a+=y,d-=y,s+=y,e.length-=y;break}e.mode=Iu;break;case 16196:for(;p<14;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(e.nlen=257+(31&h),h>>>=5,p-=5,e.ndist=1+(31&h),h>>>=5,p-=5,e.ncode=4+(15&h),h>>>=4,p-=4,e.nlen>286||e.ndist>30){n.msg="too many length or distance symbols",e.mode=Kr;break}e.have=0,e.mode=16197;case 16197:for(;e.have<e.ncode;){for(;p<3;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}e.lens[Q[e.have++]]=7&h,h>>>=3,p-=3}for(;e.have<19;)e.lens[Q[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,z={bits:e.lenbits},L=ih(0,e.lens,0,19,e.lencode,0,e.work,z),e.lenbits=z.bits,L){n.msg="invalid code lengths set",e.mode=Kr;break}e.have=0,e.mode=16198;case 16198:for(;e.have<e.nlen+e.ndist;){for(;B=e.lencode[h&(1<<e.lenbits)-1],A=B>>>24,O=B>>>16&255,N=65535&B,!(A<=p);){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(N<16)h>>>=A,p-=A,e.lens[e.have++]=N;else{if(N===16){for(Y=A+2;p<Y;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(h>>>=A,p-=A,e.have===0){n.msg="invalid bit length repeat",e.mode=Kr;break}U=e.lens[e.have-1],y=3+(3&h),h>>>=2,p-=2}else if(N===17){for(Y=A+3;p<Y;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}h>>>=A,p-=A,U=0,y=3+(7&h),h>>>=3,p-=3}else{for(Y=A+7;p<Y;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}h>>>=A,p-=A,U=0,y=11+(127&h),h>>>=7,p-=7}if(e.have+y>e.nlen+e.ndist){n.msg="invalid bit length repeat",e.mode=Kr;break}for(;y--;)e.lens[e.have++]=U}}if(e.mode===Kr)break;if(e.lens[256]===0){n.msg="invalid code -- missing end-of-block",e.mode=Kr;break}if(e.lenbits=9,z={bits:e.lenbits},L=ih(1,e.lens,0,e.nlen,e.lencode,0,e.work,z),e.lenbits=z.bits,L){n.msg="invalid literal/lengths set",e.mode=Kr;break}if(e.distbits=6,e.distcode=e.distdyn,z={bits:e.distbits},L=ih(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,z),e.distbits=z.bits,L){n.msg="invalid distances set",e.mode=Kr;break}if(e.mode=Qp,t===$p)break e;case Qp:e.mode=Zp;case Zp:if(u>=6&&d>=258){n.next_out=s,n.avail_out=d,n.next_in=a,n.avail_in=u,e.hold=h,e.bits=p,gF(n,E),s=n.next_out,i=n.output,d=n.avail_out,a=n.next_in,r=n.input,u=n.avail_in,h=e.hold,p=e.bits,e.mode===Iu&&(e.back=-1);break}for(e.back=0;B=e.lencode[h&(1<<e.lenbits)-1],A=B>>>24,O=B>>>16&255,N=65535&B,!(A<=p);){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(O&&!(240&O)){for(k=A,D=O,P=N;B=e.lencode[P+((h&(1<<k+D)-1)>>k)],A=B>>>24,O=B>>>16&255,N=65535&B,!(k+A<=p);){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}h>>>=k,p-=k,e.back+=k}if(h>>>=A,p-=A,e.back+=A,e.length=N,O===0){e.mode=16205;break}if(32&O){e.back=-1,e.mode=Iu;break}if(64&O){n.msg="invalid literal/length code",e.mode=Kr;break}e.extra=15&O,e.mode=16201;case 16201:if(e.extra){for(Y=e.extra;p<Y;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}e.length+=h&(1<<e.extra)-1,h>>>=e.extra,p-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=16202;case 16202:for(;B=e.distcode[h&(1<<e.distbits)-1],A=B>>>24,O=B>>>16&255,N=65535&B,!(A<=p);){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(!(240&O)){for(k=A,D=O,P=N;B=e.distcode[P+((h&(1<<k+D)-1)>>k)],A=B>>>24,O=B>>>16&255,N=65535&B,!(k+A<=p);){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}h>>>=k,p-=k,e.back+=k}if(h>>>=A,p-=A,e.back+=A,64&O){n.msg="invalid distance code",e.mode=Kr;break}e.offset=N,e.extra=15&O,e.mode=16203;case 16203:if(e.extra){for(Y=e.extra;p<Y;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}e.offset+=h&(1<<e.extra)-1,h>>>=e.extra,p-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){n.msg="invalid distance too far back",e.mode=Kr;break}e.mode=16204;case 16204:if(d===0)break e;if(y=E-d,e.offset>y){if(y=e.offset-y,y>e.whave&&e.sane){n.msg="invalid distance too far back",e.mode=Kr;break}y>e.wnext?(y-=e.wnext,C=e.wsize-y):C=e.wnext-y,y>e.length&&(y=e.length),T=e.window}else T=i,C=s-e.offset,y=e.length;y>d&&(y=d),d-=y,e.length-=y;do i[s++]=T[C++];while(--y);e.length===0&&(e.mode=Zp);break;case 16205:if(d===0)break e;i[s++]=e.length,d--,e.mode=Zp;break;case tE:if(e.wrap){for(;p<32;){if(u===0)break e;u--,h|=r[a++]<<p,p+=8}if(E-=d,n.total_out+=E,e.total+=E,4&e.wrap&&E&&(n.adler=e.check=e.flags?Ti(e.check,i,E,s-E):nh(e.check,i,E,s-E)),E=d,4&e.wrap&&(e.flags?h:XN(h))!==e.check){n.msg="incorrect data check",e.mode=Kr;break}h=0,p=0}e.mode=16207;case 16207:if(e.wrap&&e.flags){for(;p<32;){if(u===0)break e;u--,h+=r[a++]<<p,p+=8}if(4&e.wrap&&h!==(4294967295&e.total)){n.msg="incorrect length check",e.mode=Kr;break}h=0,p=0}e.mode=16208;case 16208:L=IF;break e;case Kr:L=YN;break e;case 16210:return QN;default:return us}return n.next_out=s,n.avail_out=d,n.next_in=a,n.avail_in=u,e.hold=h,e.bits=p,(e.wsize||E!==n.avail_out&&e.mode<Kr&&(e.mode<tE||t!==$N))&&n1(n,n.output,n.next_out,E-n.avail_out),g-=n.avail_in,E-=n.avail_out,n.total_in+=g,n.total_out+=E,e.total+=E,4&e.wrap&&E&&(n.adler=e.check=e.flags?Ti(e.check,i,E,n.next_out-E):nh(e.check,i,E,n.next_out-E)),n.data_type=e.bits+(e.last?64:0)+(e.mode===Iu?128:0)+(e.mode===Qp||e.mode===nE?256:0),(g===0&&E===0||t===$N)&&L===Ml&&(L=SF),L},inflateEnd:n=>{if(Hl(n))return us;let t=n.state;return t.window&&(t.window=null),n.state=null,Ml},inflateGetHeader:(n,t)=>{if(Hl(n))return us;const e=n.state;return 2&e.wrap?(e.head=t,t.done=!1,Ml):us},inflateSetDictionary:(n,t)=>{const e=t.length;let r,i,a;return Hl(n)?us:(r=n.state,r.wrap!==0&&r.mode!==Yp?us:r.mode===Yp&&(i=1,i=nh(i,t,e,0),i!==r.check)?YN:(a=n1(n,t,e,e),a?(r.mode=16210,QN):(r.havedict=1,Ml)))},inflateInfo:"pako inflate (from Nodeca project)"},wF=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const F2=Object.prototype.toString,{Z_NO_FLUSH:RF,Z_FINISH:MF,Z_OK:ah,Z_STREAM_END:aE,Z_NEED_DICT:sE,Z_STREAM_ERROR:OF,Z_DATA_ERROR:t1,Z_MEM_ERROR:kF}=ad;function sh(n){this.options=M2({chunkSize:65536,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||n&&n.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D2,this.strm.avail_out=0;let e=Mu.inflateInit2(this.strm,t.windowBits);if(e!==ah)throw new Error(Ql[e]);if(this.header=new wF,Mu.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Jb(t.dictionary):F2.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=Mu.inflateSetDictionary(this.strm,t.dictionary),e!==ah)))throw new Error(Ql[e])}function uE(n,t){const e=new sh(t);if(e.push(n),e.err)throw e.msg||Ql[e.err];return e.result}sh.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,s,u;if(this.ended)return!1;for(s=t===~~t?t:t===!0?MF:RF,F2.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),a=Mu.inflate(e,s),a===sE&&i&&(a=Mu.inflateSetDictionary(e,i),a===ah?a=Mu.inflate(e,s):a===t1&&(a=sE));e.avail_in>0&&a===aE&&e.state.wrap>0&&n[e.next_in]!==0;)Mu.inflateReset(e),a=Mu.inflate(e,s);switch(a){case OF:case t1:case sE:case kF:return this.onEnd(a),this.ended=!0,!1}if(u=e.avail_out,e.next_out&&(e.avail_out===0||a===aE))if(this.options.to==="string"){let d=uF(e.output,e.next_out),h=e.next_out-d,p=sF(e.output,d);e.next_out=h,e.avail_out=r-h,h&&e.output.set(e.output.subarray(d,d+h),0),this.onData(p)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(a!==ah||u!==0){if(a===aE)return a=Mu.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(e.avail_in===0)break}}return!0},sh.prototype.onData=function(n){this.chunks.push(n)},sh.prototype.onEnd=function(n){n===ah&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=O2(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var DF={Inflate:sh,inflate:uE,inflateRaw:function(n,t){return(t=t||{}).raw=!0,uE(n,t)},ungzip:uE,constants:ad};const{Deflate:LF,deflate:xF,deflateRaw:UF,gzip:PF}=mF,{Inflate:FF,inflate:HF,inflateRaw:BF,ungzip:GF}=DF;var Xs,VF={Deflate:LF,deflate:xF,deflateRaw:UF,gzip:PF,Inflate:FF,inflate:HF,inflateRaw:BF,ungzip:GF,constants:ad},oE=function(n){return M(void 0,void 0,void 0,function(){var t;return R(this,function(e){return t=VF.ungzip(n),[2,String.fromCharCode.apply(null,t)]})})};(function(n){n.CONNECTING="CONNECTING",n.OPEN="OPEN",n.CLOSED="CLOSED"})(Xs||(Xs={}));var Gt,jF=function(n){function t(e,r){var i=r.sdkState,a=r.dispatcher,s=r.logger,u=n.call(this)||this;return u.lastActive=0,u._iid=e,u._sdkState=i,u._dispatcher=a,u._logger=s,u}return j(t,n),Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.connectionState===Xs.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return Xs.CONNECTING;case 1:return Xs.OPEN}return Xs.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ws",{get:function(){var e;return(e=this._ws)!==null&&e!==void 0?e:null},enumerable:!1,configurable:!0}),t.prototype._handleMessage=function(e){var r=this;e.split(`
`).forEach(function(i){if(i){var a=dr.createFromRawMessage(r._iid,i);if(r._logger.debug("receive websocket event",a),a.code==="LOGI")r.dispatch("message",a);else if(a.code==="PONG")r.dispatch("pong");else if(a.code==="EXPR"){if(a.payload){var s=new mc(a.payload);s.expiresIn>=0&&r._dispatcher.dispatch(s)}}else a.code==="NOOP"||r.dispatch("message",a)}})},t.prototype.connect=function(e,r){return r===void 0&&(r=""),M(this,void 0,void 0,function(){var i=this;return R(this,function(a){return this._ws=new WebSocket(e,encodeURIComponent(r)),this._ws.onopen=function(){i._logger.debug("websocket open"),i.dispatch("open")},this._ws.onmessage=function(s){return M(i,void 0,void 0,function(){var u,d,h,p,g,E,y,C=this;return R(this,function(T){switch(T.label){case 0:return!((y=this._sdkState.websocket)===null||y===void 0)&&y.compression?s.data instanceof Blob?((u=new FileReader).readAsArrayBuffer(s.data),u.onloadend=function(){return M(C,void 0,void 0,function(){var A,O;return R(this,function(N){switch(N.label){case 0:return N.trys.push([0,2,,3]),[4,oE(u.result)];case 1:return A=N.sent(),this._handleMessage(A),[3,3];case 2:return O=N.sent(),this.error(O),[3,3];case 3:return[2]}})})},[3,12]):[3,1]:[3,13];case 1:if(!(s.data instanceof ArrayBuffer))return[3,6];T.label=2;case 2:return T.trys.push([2,4,,5]),[4,oE(new Uint8Array(s.data))];case 3:return g=T.sent(),this._handleMessage(g),[3,5];case 4:return d=T.sent(),this.error(d),[3,5];case 5:return[3,12];case 6:if(!(typeof Buffer<"u"&&s.data instanceof Buffer))return[3,11];T.label=7;case 7:return T.trys.push([7,9,,10]),h=s.data,p=h.buffer.slice(h.byteOffset,h.byteOffset+h.byteLength),[4,oE(p)];case 8:return g=T.sent(),this._handleMessage(g),[3,10];case 9:return E=T.sent(),this.error(E),[3,10];case 10:return[3,12];case 11:typeof s.data=="string"&&this._handleMessage(s.data),T.label=12;case 12:return[3,14];case 13:this._handleMessage(s.data),T.label=14;case 14:return[2]}})})},this._ws.onerror=function(){i._logger.debug("websocket error"),i.dispatch("error",ee.networkError)},this._ws.onclose=function(){i._logger.debug("websocket close"),i.dispatch("close")},this.lastActive=Date.now(),[2]})})},t.prototype.disconnect=function(){var e=this;return new Promise(function(r){e._logger.debug("websocket disconnect"),e._ws?(e._ws.onopen=Kn,e._ws.onmessage=Kn,e._ws.onerror=Kn,e.connectionState!==Xs.CLOSED?(e._ws.onclose=function(){e.dispatch("close"),r()},e._ws.close(),e._ws=void 0):r()):r()})},t.prototype.send=function(e){if(!this._ws)throw ee.connectionClosed;e.code!=="PING"?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage())},t.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e)},t}(rd),H2=function(n){function t(e){var r=e.all,i=e.feed,a=e.custom_types,s=e.ts,u=n.call(this)||this;return u.all=r,u.feed=i,u.customTypes=a,u.ts=s,u}return j(t,n),t}(Cr),qF=function(){function n(t,e){var r=e.session,i=e.sdkState,a=e.dispatcher,s=e.logger,u=e.useFetchCompat,d=u!==void 0&&u,h=this;this._ackStateMap=new Map,this._sdkState=i,this._dispatcher=a,this._logger=s,this.apiClient=new B5(t,{session:r,sdkState:i,dispatcher:a,logger:s,useFetchCompat:d}),this.websocketClient=new jF(t,{sdkState:i,dispatcher:a,logger:s}),this.websocketClient.on("message",function(p){if(p.payload.unread_cnt&&h._dispatcher.dispatch(new H2(p.payload.unread_cnt)),p.requestId){if(h._ackStateMap.has(p.requestId)){var g=h._ackStateMap.get(p.requestId);p.code!=="EROR"?g.resolve(p):g.reject(new ee({code:p.payload.code,message:p.payload.message}))}}else h._dispatcher.dispatch(p)}).on("close",function(){h._ackStateMap.forEach(function(p){p.reject(ee.connectionClosed)}),h._ackStateMap.clear()})}return n.prototype._sendApiRequest=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this.apiClient.send(t)];case 1:return[2,e.sent()]}})})},n.prototype._sendWebsocketRequest=function(t){return M(this,void 0,void 0,function(){var e,r,i,a=this;return R(this,function(s){if(!this._sdkState.websocket)throw ee.connectionRequired;if(e=new Qi,t.ackRequired){i=function(u,d){a._ackStateMap.has(t.requestId)&&(a._ackStateMap.delete(t.requestId),r&&(clearTimeout(r),r=null),u?(a._logger.debug("fail websocket request",t.requestId,u),e.reject(u)):(a._logger.debug("receive websocket ack",t.requestId,t),a._logger.debug("receive websocket ack",d),e.resolve(d)))};try{r=setTimeout(function(){return i(ee.noAckTimeout)},this._sdkState.websocket.responseTimeout),this._ackStateMap.set(t.requestId,{resolve:function(u){return i(void 0,u)},reject:function(u){return i(u)}}),this.websocketClient.send(t)}catch(u){i(u)}}else try{this.websocketClient.send(t),e.resolve()}catch(u){e.reject(u)}return[2,e.promise]})})},n.prototype.send=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return t instanceof Te?[4,this._sendApiRequest(t)]:[3,2];case 1:case 3:return[2,e.sent()];case 2:return t instanceof Ai?[4,this._sendWebsocketRequest(t)]:[3,4];case 4:throw ee.invalidParameters}})})},n.prototype.cancel=function(t){this.apiClient.cancel(t)},n.prototype.cancelAll=function(){this.apiClient.cancelAll()},n}();(function(n){n[n.NONE=0]="NONE",n[n.INITIALIZED=1]="INITIALIZED",n[n.CONNECTING=2]="CONNECTING",n[n.CONNECTED=3]="CONNECTED",n[n.RECONNECTING=4]="RECONNECTING",n[n.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",n[n.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",n[n.LOGOUT=7]="LOGOUT"})(Gt||(Gt={}));var Bl,Gl,Aa=function(n){function t(e){var r=e.stateType,i=n.call(this)||this;return i.stateType=r,i}return j(t,n),t}(Cr),B2=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return j(t,n),t}(Cr),ny=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return j(t,n),t}(Cr),G2=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return j(t,n),t}(Cr),r1=function(){function n(t){var e,r,i,a;this.isEnabled=(e=t.enabled)!==null&&e!==void 0&&e,this.feedChannels=(r=t.feed_channels)!==null&&r!==void 0?r:{},this.templateListToken=(i=t.template_list_token)!==null&&i!==void 0?i:null,this.settingsUpdatedAt=(a=t.settings_updated_at)!==null&&a!==void 0?a:0}return n.payloadify=function(t){return ze(_n({enabled:t.isEnabled,feed_channels:t.feedChannels,template_list_token:t.templateListToken,settings_updated_at:t.settingsUpdatedAt}))},n}(),eC=function(n){return"sendbird@".concat(n,"/changelog_include_chat_notifications")},i1=function(){function n(t){var e;this.lastUpdatedAt=(e=t.last_updated_at)!==null&&e!==void 0?e:0}return n.payloadify=function(t){return ze(_n({last_updated_at:t.lastUpdatedAt}))},n}(),a1=function(){function n(t){var e;this.token=(e=t.template_list_token)!==null&&e!==void 0?e:""}return n.payloadify=function(t){return ze(_n({template_list_token:t.token}))},n}(),Xp=function(){function n(t){t===void 0&&(t={min_stat_count:100,min_interval:10800,max_stat_count_per_request:1e3,lower_threshold:10,request_delay_range:180}),this.minStatCount=t.min_stat_count,this.minInterval=1e3*t.min_interval,this.maxStatCountPerRequest=t.max_stat_count_per_request,this.lowerThreshold=t.lower_threshold,this.requestDelayRange=1e3*t.request_delay_range}return n.payloadify=function(t){return ze(_n({min_stat_count:t.minStatCount,min_interval:t.minInterval/1e3,max_stat_count_per_request:t.maxStatCountPerRequest,lower_threshold:t.lowerThreshold,request_delay_range:t.requestDelayRange/1e3}))},n}(),lE=function(){function n(t){t===void 0&&(t={default:{min_stat_count:100,min_interval:10800,max_stat_count_per_request:1e3,lower_threshold:10,request_delay_range:180}}),this.default=new Xp(t.default),this.realTime=new Xp(t.realtime)}return n.payloadify=function(t){return ze(_n({default:Xp.payloadify(t.default),realtime:Xp.payloadify(t.realTime)}))},n}(),s1=1048576,zF=5;(function(n){n[n.NONE=0]="NONE",n[n.INCLUDE_REPLY=1]="INCLUDE_REPLY",n[n.EXCLUDE_REPLY=2]="EXCLUDE_REPLY",n[n.INCLUDE_REPLY_TO_CHANNEL=3]="INCLUDE_REPLY_TO_CHANNEL"})(Bl||(Bl={})),function(n){n[n.NONE=0]="NONE",n[n.INCLUDE_REPLY=1]="INCLUDE_REPLY",n[n.EXCLUDE_REPLY=2]="EXCLUDE_REPLY",n[n.INCLUDE_REPLY_TO_CHANNEL=3]="INCLUDE_REPLY_TO_CHANNEL"}(Gl||(Gl={}));var u1=function(){function n(t){var e,r,i,a,s,u,d,h;t===void 0&&(t={}),this.emojiHash=t.emoji_hash||"",this.uploadSizeLimit=t.file_upload_size_limit?t.file_upload_size_limit*s1:Number.MAX_SAFE_INTEGER,this.useReaction=!!t.use_reaction,this.applicationAttributes=(e=t.application_attributes)!==null&&e!==void 0?e:[],this.premiumFeatureList=(r=t.premium_feature_list)!==null&&r!==void 0?r:[],this.deviceTokenCache=this.applicationAttributes.includes("sdk_device_token_cache"),this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history"),this.multipleFilesMessageFileCountLimit=(i=t.multiple_file_send_max_size)!==null&&i!==void 0?i:5,this.allowSdkStatsUpload=(a=t.allow_sdk_log_ingestion)===null||a===void 0||a,this.unreadCountThreadingPolicy=(s=t.unread_cnt_threading_policy)!==null&&s!==void 0?s:Bl.NONE,this.lastMessageThreadingPolicy=(u=t.last_msg_threading_policy)!==null&&u!==void 0?u:Gl.NONE,this.uikitConfigInfo=new i1((d=t.uikit_config)!==null&&d!==void 0?d:{}),this.notificationInfo=t.notifications?new r1(t.notifications):null,this.messageTemplateInfo=t.message_template?new a1(t.message_template):null,this.statConfigInfo=t.log_publish_config?new lE(t.log_publish_config):new lE,this.disableSuperGroupMack=(h=t.disable_supergroup_mack)!==null&&h!==void 0&&h}return n.payloadify=function(t){return ze(_n({emoji_hash:t.emojiHash,file_upload_size_limit:t.uploadSizeLimit/s1,application_attributes:t.applicationAttributes,premium_feature_list:t.premiumFeatureList,use_reaction:t.useReaction,allow_sdk_log_ingestion:t.allowSdkStatsUpload,unread_cnt_threading_policy:t.unreadCountThreadingPolicy,last_msg_threading_policy:t.lastMessageThreadingPolicy,uikit_config:t.uikitConfigInfo?i1.payloadify(t.uikitConfigInfo):null,notifications:t.notificationInfo?r1.payloadify(t.notificationInfo):null,message_template:t.messageTemplateInfo?a1.payloadify(t.messageTemplateInfo):null,log_publish_config:t.statConfigInfo?lE.payloadify(t.statConfigInfo):null,disable_supergroup_mack:t.disableSuperGroupMack}))},n}(),Zr=function(){function n(t){this._iid="",this._iid=t}return n.payloadify=function(t){return{}},n}(),KF=function(n){function t(e){var r=e.userId,i=e.metadata,a=n.call(this)||this;return a.method=Ie.POST,a.path="".concat(xt,"/").concat(r,"/metadata"),a.params={metadata:i},a}return j(t,n),t}(Te),WF=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metaData=r,i}return j(t,n),t}(Me),$F=function(n){function t(e){var r=e.userId,i=e.metadata,a=e.upsert,s=n.call(this)||this;return s.method=Ie.PUT,s.path="".concat(xt,"/").concat(r,"/metadata"),s.params={metadata:i,upsert:a},s}return j(t,n),t}(Te),YF=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metadata=r,i}return j(t,n),t}(Me),QF=function(n){function t(e){var r=e.userId,i=e.metadataKey,a=n.call(this)||this;return a.method=Ie.DELETE,a.path="".concat(xt,"/").concat(r,"/metadata/").concat(i),a}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var ZF=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.DELETE,i.path="".concat(xt,"/").concat(r,"/metadata"),i}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var lc,Nc=function(n,t){var e=JSON.parse(JSON.stringify(n));return e._iid&&delete e._iid,t&&t(e),e},ko=function(n,t){var e=JSON.parse(JSON.stringify(n));return e},Se=function(n){return{do:function(t){n||t()},throw:function(t){if(!n)throw t}}};(function(n){n.ONLINE="online",n.OFFLINE="offline",n.NON_AVAILABLE="nonavailable"})(lc||(lc={}));var gc,_t=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y,C,T,A=this;return(A=n.call(this,e)||this).userId=(a=(i=r.guest_id)!==null&&i!==void 0?i:r.user_id)!==null&&a!==void 0?a:"",A.nickname=(u=(s=r.nickname)!==null&&s!==void 0?s:r.name)!==null&&u!==void 0?u:"",A.plainProfileUrl=(h=(d=r.profile_url)!==null&&d!==void 0?d:r.image)!==null&&h!==void 0?h:"",A.requireAuth=(p=r.require_auth_for_profile_image)!==null&&p!==void 0&&p,A.metaData=(g=r.metadata)!==null&&g!==void 0?g:{},A.connectionStatus=lc.NON_AVAILABLE,nt(lc,r.is_online)?A.connectionStatus=r.is_online:J("boolean",r.is_online)&&(A.connectionStatus=r.is_online?lc.ONLINE:lc.OFFLINE),A.isActive=(E=r.is_active)===null||E===void 0||E,A.lastSeenAt=(y=r.last_seen_at)!==null&&y!==void 0?y:null,A.preferredLanguages=r.preferred_languages?Nn([],cn(r.preferred_languages),!1):null,A.friendDiscoveryKey=(C=r.friend_discovery_key)!==null&&C!==void 0?C:null,A.friendName=(T=r.friend_name)!==null&&T!==void 0?T:null,A}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{user_id:e.userId,nickname:e.nickname,profile_url:e.plainProfileUrl,require_auth_for_profile_image:e.requireAuth,metadata:e.metaData,is_online:e.connectionStatus,is_active:e.isActive,last_seen_at:e.lastSeenAt,preferred_languages:e.preferredLanguages,friend_discovery_key:e.friendDiscoveryKey,friend_name:e.friendName})))},Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=X.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return Nc(this)},t.prototype._isValidMetaData=function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map(function(r){return e[r]}).every(function(r){return J("string",r)})},t.prototype._applyMetaData=function(e,r){var i=this;r===void 0&&(r=!1),Object.keys(e).forEach(function(a){r?delete i.metaData[a]:i.metaData[a]=e[a]})},t.prototype.createMetaData=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return Se(this._isValidMetaData(e)).throw(ee.invalidParameters),r=X.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new KF({userId:i.userId,metadata:e}),[4,a.send(s)];case 1:return u=h.sent(),d=u.as(WF).metaData,this._applyMetaData(d),[2,this.metaData]}})})},t.prototype.updateMetaData=function(e,r){return r===void 0&&(r=!1),M(this,void 0,void 0,function(){var i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return Se(this._isValidMetaData(e)).throw(ee.invalidParameters),i=X.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new $F({userId:a.userId,metadata:e,upsert:r}),[4,s.send(u)];case 1:return d=p.sent(),h=d.as(YF).metadata,this._applyMetaData(h),[2,this.metaData]}})})},t.prototype.deleteMetaData=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return Se(J("string",e)).throw(ee.invalidParameters),r=X.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new QF({userId:i.userId,metadataKey:e}),[4,a.send(s)];case 1:return d.sent(),this._applyMetaData(((u={})[e]=!0,u),!0),[2,this.metaData]}})})},t.prototype.deleteAllMetaData=function(){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new ZF({userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),this.metaData={},[2]}})})},t}(Zr),V2=function(n){function t(e){var r=e.userProfile,i=n.call(this)||this;return i.userProfile=r,i}return j(t,n),t}(Cr),ty=function(){function n(t,e){var r,i,a,s,u,d,h,p,g,E,y,C,T,A;this._iid=t,this.appInfo=new u1(e),this.user=new _t(t,e),this.connectedAt=(r=e.login_ts)!==null&&r!==void 0?r:0,this.firstConnectedAt=0,this.pingInterval=(i=e.ping_interval)!==null&&i!==void 0?i:15e3,this.pongTimeout=(a=e.pong_timeout)!==null&&a!==void 0?a:5e3,this.reconnectInterval=(u=(s=e.reconnect)===null||s===void 0?void 0:s.interval)!==null&&u!==void 0?u:3e3,this.reconnectMaxInterval=(h=(d=e.reconnect)===null||d===void 0?void 0:d.max_interval)!==null&&h!==void 0?h:6e4,this.reconnectRetryCount=(g=(p=e.reconnect)===null||p===void 0?void 0:p.retry_cnt)!==null&&g!==void 0?g:5,this.reconnectIntervalMultiple=(y=(E=e.reconnect)===null||E===void 0?void 0:E.mul)!==null&&y!==void 0?y:2,this.maxUnreadCountOnSuperGroup=(C=e.max_unread_cnt_on_super_group)!==null&&C!==void 0?C:100,this.profileImageEncryption=!!e.profile_image_encryption,this.concurrentCallLimit=(T=e.concurrent_call_limit)!==null&&T!==void 0?T:5,this.backOffDelay=(A=e.back_off_delay)!==null&&A!==void 0?A:100}return n.payloadify=function(t){return ze(_n(W(W(W({},_t.payloadify(t.user)),u1.payloadify(t.appInfo)),{login_ts:t.connectedAt,ping_interval:t.pingInterval,pong_timeout:t.pongTimeout,reconnect:{interval:t.reconnectInterval,max_interval:t.reconnectMaxInterval,retry_cnt:t.reconnectRetryCount,mul:t.reconnectIntervalMultiple},max_unread_cnt_on_super_group:t.maxUnreadCountOnSuperGroup,profile_image_encryption:t.profileImageEncryption,concurrent_call_limit:t.concurrentCallLimit,back_off_delay:t.backOffDelay})))},n.prototype.apply=function(){var t=this.reconnectInterval,e=this.reconnectMaxInterval,r=this.reconnectIntervalMultiple,i=X.of(this._iid);i.sdkState.websocket&&(i.sdkState.websocket.pingInterval=1e3*this.pingInterval,i.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,i.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,i.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(a){return a>0?1e3*Math.min(t*Math.pow(r,a-1),e):10}}),i.appInfo=this.appInfo,i.sessionManager.currentUser=this.user,i.connectedAt=this.connectedAt,this.firstConnectedAt||(i.firstConnectedAt=this.connectedAt),i.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,i.concurrentCallLimit=this.concurrentCallLimit,i.backOffDelay=this.backOffDelay,i.dispatcher.dispatch(new V2({userProfile:this}))},n}(),j2=function(n){function t(e){var r=e.request,i=r===void 0||r,a=e.features,s=a===void 0?{}:a,u=e.options,d=u===void 0?{}:u,h=e.statConfigInfo,p=n.call(this)||this;return p.request=i,p.features=W({localCache:!0,notification:!0},s),p.options=W({ingestion:!0},d),p.statConfigInfo=h,p}return j(t,n),t}(Cr),C_=function(n){function t(e,r,i){var a,s,u,d,h=this;return(h=n.call(this,e,r,i)||this).error=null,h.services=[],h.userProfile=new ty(e,i),h.deviceTokenLastDeletedAt=(a=i.device_token_last_deleted_at)!==null&&a!==void 0?a:0,h.key=(s=i.key)!==null&&s!==void 0?s:"",h.ekey=(u=i.ekey)!==null&&u!==void 0?u:"",h.error=i.error?new ee(i):null,h.services=(d=i.services)!==null&&d!==void 0?d:[],h}return j(t,n),t.asError=function(e){return new t("","LOGI",W({user_id:"",error:!0},e))},t.prototype.applyTo=function(e){return M(this,void 0,void 0,function(){var r,i,a;return R(this,function(s){switch(s.label){case 0:return this.error?[3,4]:(r=X.of(e))?(i=r.sessionManager,a=r.dispatcher,[4,i.login(this)]):[3,2];case 1:return s.sent(),this.userProfile.apply(),a.dispatch(new j2({request:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),features:{localCache:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish"),notification:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_noti_stats_log_publish")},options:{ingestion:this.userProfile.appInfo.allowSdkStatsUpload},statConfigInfo:this.userProfile.appInfo.statConfigInfo})),[3,3];case 2:throw ee.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}})})},t}(dr),sd=function(){function n(){this.type=Gt.NONE,this.name="none"}return n.prototype.run=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){return[2]})})},n.prototype.onConnect=function(t,e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2]})})},n.prototype.onReconnect=function(t,e){return e.resetReconnectCount,M(this,void 0,void 0,function(){return R(this,function(r){return[2]})})},n.prototype.onDisconnect=function(t,e){return e.error,e.autoReconnect,e.cause,M(this,void 0,void 0,function(){return R(this,function(r){return[2]})})},n.prototype.onDisconnectWebSocket=function(t,e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2]})})},n.prototype.onLogout=function(t,e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2]})})},n}(),an=function(n){return M(void 0,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,n()];case 1:return e.sent(),[3,3];case 2:if(!((t=e.sent())instanceof ee))throw t;return t.throwOutside(),[3,3];case 3:return[2]}})})},Pr=function(n){return M(void 0,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,n()];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})})},Do=function(n){function t(e){e===void 0&&(e={});var r,i=this;return(i=n.call(this)||this).type=Gt.LOGOUT,i.name="logout",i._wasPreviouslyConnected=(r=e.wasPreviouslyConnected)===null||r===void 0||r,i}return j(t,n),t.prototype.run=function(e){return M(this,void 0,void 0,function(){var r,i,a=this;return R(this,function(s){switch(s.label){case 0:return r=Date.now(),i=e.sdkState.userId,[4,e.logout()];case 1:return s.sent(),[4,e.changeState(new nC,r)];case 2:return s.sent(),this._wasPreviouslyConnected&&an(function(){return M(a,void 0,void 0,function(){return R(this,function(u){return e.connectionHandlers.forEach(function(d){d.onDisconnected&&d.onDisconnected(i)}),[2]})})}),[2]}})})},t}(sd),Am=function(n){function t(){var e=n.call(this)||this;return e.type=Gt.EXTERNAL_DISCONNECTED,e.name="externaldisconnected",e}return j(t,n),t.prototype.run=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,e.disconnect()];case 1:return r.sent(),[2]}})})},t.prototype.onConnect=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,e.disconnect()];case 1:return a.sent(),[4,e.changeState(new Rm({authToken:r}),i)];case 2:return a.sent(),[2]}})})},t.prototype.onReconnect=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new $_,r)];case 1:return i.sent(),[2]}})})},t.prototype.onLogout=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Do,r)];case 1:return i.sent(),[2]}})})},t}(sd),W_=function(n){function t(e){var r=e.autoReconnect,i=n.call(this)||this;return i.type=Gt.INTERNAL_DISCONNECTED,i.name="internaldisconnected",i._autoReconnect=!1,i._autoReconnect=r,i}return j(t,n),t.prototype.run=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.disconnect()];case 1:return i.sent(),this._autoReconnect?[4,e.changeState(new $_,r)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onConnect=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,e.disconnect()];case 1:return a.sent(),[4,e.changeState(new Rm({authToken:r}),i)];case 2:return a.sent(),[2]}})})},t.prototype.onReconnect=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new $_,r)];case 1:return i.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Am,r)];case 1:return i.sent(),[2]}})})},t.prototype.onLogout=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Do,r)];case 1:return i.sent(),[2]}})})},t}(sd),sa=function(n){return M(void 0,void 0,void 0,function(){return R(this,function(t){return[2,new Promise(function(e){return setTimeout(e,n)})]})})},q2=function(){function n(){}return n.prototype.calcTimeout=function(){return 0},n}(),wm=function(n,t,e){return e===void 0&&(e=new q2),M(void 0,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:r=0,i=null,a=function(p){return i=p??new Error("Halted")},s=function(){r=0},h.label=1;case 1:if(!(t===-1||r<t))return[3,9];h.label=2;case 2:return h.trys.push([2,4,,8]),[4,n(a,s)];case 3:if(u=h.sent(),i)throw i;return[2,u];case 4:if(d=h.sent(),i)return[3,6];if(++r===t)throw d;return[4,sa(e.calcTimeout(r))];case 5:return h.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:throw"It should not happen."}})})},$_=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=Gt.RECONNECTING,e.name="reconnecting",e._callbacks=[],e}return j(t,n),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._resetConnect=void 0,this._callbacks.forEach(function(r){return r(e)})},t.prototype.run=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h=this;return R(this,function(p){switch(p.label){case 0:r=Date.now(),i=new Qi,this._callbacks.push(function(g){return g?i.reject(g):i.resolve()}),an(function(){return M(h,void 0,void 0,function(){return R(this,function(g){return e.connectionHandlers.forEach(function(E){E.onReconnectStarted&&E.onReconnectStarted()}),[2]})})}),p.label=1;case 1:return p.trys.push([1,4,,9]),a=e.sdkState.websocket,s=a.reconnectMaxRetry,u=a.reconnectRetryStrategy,[4,wm(function(g,E){return M(h,void 0,void 0,function(){var y;return R(this,function(C){switch(C.label){case 0:this._haltConnect=g,this._resetConnect=E,C.label=1;case 1:return C.trys.push([1,3,,4]),[4,e.connect()];case 2:return C.sent(),[3,4];case 3:if(y=C.sent(),e.clearLoginTimer(),y instanceof ee){if(y.code===rn.CONNECTION_CANCELED)return g(y),[2];if(y.isSessionExpiredError||y.isSessionInvalidatedError)return g(y),[2]}throw y;case 4:return[2]}})})},s,u)];case 2:return p.sent(),[4,e.changeState(new z2,r)];case 3:return p.sent(),this._flushCallbacks(),an(function(){return M(h,void 0,void 0,function(){return R(this,function(g){return e.connectionHandlers.forEach(function(E){E.onReconnectSucceeded&&E.onReconnectSucceeded()}),[2]})})}),[3,9];case 4:return d=p.sent(),Gi(d)?[3,7]:d instanceof ee?d.code===rn.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new W_({autoReconnect:!1}),r)]:[3,6];case 5:p.sent(),p.label=6;case 6:return this._flushCallbacks(d),an(function(){return M(h,void 0,void 0,function(){return R(this,function(g){return e.connectionHandlers.forEach(function(E){E.onReconnectFailed&&E.onReconnectFailed()}),[2]})})}),[3,8];case 7:throw d;case 8:return[3,9];case 9:return[2,i.promise]}})})},t.prototype.onConnect=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){return i=new Qi,this._halt(ee.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push(function(){var s=Date.now();e.changeState(new Rm({authToken:r}),s).then(function(){i.resolve()}).catch(function(u){i.reject(u)})}),[2,i.promise]})})},t.prototype.onReconnect=function(e,r){var i=r.resetReconnectCount,a=i!==void 0&&i;return M(this,void 0,void 0,function(){var s;return R(this,function(u){return s=new Qi,this._resetConnect&&a&&this._resetConnect(),this._callbacks.push(function(d){return d?s.reject(d):s.resolve()}),[2,s.promise]})})},t.prototype.onDisconnect=function(e,r){r._error;var i=r.autoReconnect,a=i===void 0||i;return M(this,void 0,void 0,function(){var s;return R(this,function(u){switch(u.label){case 0:return s=Date.now(),this._halt(ee.connectionCanceled),[4,e.changeState(new W_({autoReconnect:a}),s)];case 1:return u.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),this._halt(ee.connectionCanceled),[4,e.changeState(new Am,r)];case 1:return i.sent(),[2]}})})},t.prototype.onLogout=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),this._halt(ee.connectionCanceled),[4,e.changeState(new Do,r)];case 1:return i.sent(),[2]}})})},t}(sd),z2=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=Gt.CONNECTED,e.name="connected",e}return j(t,n),t.prototype.onReconnect=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.disconnect()];case 1:return i.sent(),[4,e.changeState(new $_,r)];case 2:return i.sent(),[2]}})})},t.prototype.onDisconnect=function(e,r){var i=r.autoReconnect;return M(this,void 0,void 0,function(){var a;return R(this,function(s){switch(s.label){case 0:return a=Date.now(),[4,e.changeState(new W_({autoReconnect:i}),a)];case 1:return s.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Am,r)];case 1:return i.sent(),[2]}})})},t.prototype.onLogout=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Do,r)];case 1:return i.sent(),[2]}})})},t}(sd);(function(n){n.ExternalSetBackground="ExternalSetBackground",n.ExternalDisconnectWebSocket="ExternalDisconnectWebSocket"})(gc||(gc={}));var XF=function(){function n(t,e){var r=e.sdkState,i=e.cacheContext,a=e.connectionHandlers,s=e.sessionManager,u=e.websocketClient,d=e.dispatcher,h=e.logger,p=e.disableWebSocketCloseEventHandling,g=p!==void 0&&p;this._disableWebSocketCloseEventHandling=!1,this._webSocketClosedCause=null,this._logger=h,this._disableWebSocketCloseEventHandling=g,this._context=new n7(t,{sdkState:r,cacheContext:i,connectionHandlers:a,sessionManager:s,websocketClient:u,dispatcher:d,logger:h}),this._sdkState=r,this._sessionManager=s,this._websocketClient=u}return n.prototype._registerEventDispatcher=function(){var t=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh",function(){t.isConnecting||t.isConnected||(t._logger.debug("try reconnect by session key refresh"),Pr(function(){return M(t,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this.reconnect()];case 1:return e.sent(),[2]}})})}))}),this._websocketEventDispatcherContext=this._websocketClient.on("close",function(){t._sdkState.appState!=="foreground"||t._webSocketClosedCause||Pr(function(){return M(t,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this._sessionManager.isSessionKeyRefreshing?[3,2]:(this._logger.debug("try reconnect by websocket connection closed"),[4,this.reconnect()]);case 1:return e.sent(),[3,4];case 2:return[4,this.disconnectWebSocket()];case 3:e.sent(),e.label=4;case 4:return[2]}})})})}))},n.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=void 0),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=void 0)},Object.defineProperty(n.prototype,"isConnected",{get:function(){return this._context.currentState.type===Gt.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isConnecting",{get:function(){var t=this._context.currentState;return t.type===Gt.CONNECTING||t.type===Gt.RECONNECTING},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"websocketClient",{get:function(){return this._websocketClient},enumerable:!1,configurable:!0}),n.prototype.connect=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return e=this._context.currentState,this._webSocketClosedCause=null,[4,e.onConnect(this._context,t)];case 1:return r.sent(),this._registerEventDispatcher(),[2]}})})},n.prototype.reconnect=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=null,[4,t.onReconnect(this._context,{})];case 1:return e.sent(),[2]}})})},n.prototype.resetAndReconnect=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=null,[4,t.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return e.sent(),[2]}})})},n.prototype.background=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=gc.ExternalSetBackground,[4,t.onDisconnect(this._context,{autoReconnect:!1,cause:this._webSocketClosedCause})];case 1:return e.sent(),[2]}})})},n.prototype.disconnect=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:t,autoReconnect:!0,cause:this._webSocketClosedCause})];case 1:return e.sent(),[2]}})})},n.prototype.disconnectWebSocket=function(t){return t===void 0&&(t=!1),M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return e=this._context.currentState,t&&(this._webSocketClosedCause=gc.ExternalDisconnectWebSocket),[4,e.onDisconnectWebSocket(this._context,{cause:this._webSocketClosedCause})];case 1:return r.sent(),[2]}})})},n.prototype.logout=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return e=this._context.currentState,this._clearEventDispatcher(),[4,e.onLogout(this._context,t)];case 1:return r.sent(),[2]}})})},n}(),Rm=function(n){function t(e){var r=e.authToken,i=n.call(this)||this;return i.type=Gt.CONNECTING,i.name="connecting",i._authToken="",i._callbacks=[],i._authToken=r,i}return j(t,n),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._callbacks.forEach(function(r){return r(e)})},t.prototype.run=function(e){return M(this,void 0,void 0,function(){var r,i,a,s=this;return R(this,function(u){switch(u.label){case 0:r=Date.now(),i=new Qi,this._callbacks.push(function(d){return d?i.reject(d):i.resolve()}),u.label=1;case 1:return u.trys.push([1,4,,10]),[4,wm(function(d){return M(s,void 0,void 0,function(){var h;return R(this,function(p){switch(p.label){case 0:this._haltConnect=d,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return p.sent(),[3,4];case 3:if(h=p.sent(),e.clearLoginTimer(),h instanceof ee&&h.code===rn.CONNECTION_CANCELED)return d(h),[2];throw h;case 4:return[2]}})})},e.sdkState.websocket.connectMaxRetry)];case 2:return u.sent(),[4,e.changeState(new z2,r)];case 3:return u.sent(),an(function(){return M(s,void 0,void 0,function(){return R(this,function(d){return this._flushCallbacks(),e.connectionHandlers.forEach(function(h){h.onConnected&&h.onConnected(e.sdkState.userId)}),[2]})})}),[3,10];case 4:return a=u.sent(),Gi(a)?[3,8]:[4,e.disconnect()];case 5:return u.sent(),a instanceof ee?a.code===rn.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new nC,r)]:[3,7];case 6:u.sent(),u.label=7;case 7:return an(function(){return M(s,void 0,void 0,function(){return R(this,function(d){return this._flushCallbacks(a),[2]})})}),[3,9];case 8:throw a;case 9:return[3,10];case 10:return[2,i.promise]}})})},t.prototype.onConnect=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){return r=new Qi,this._callbacks.push(function(a){return a?r.reject(a):r.resolve()}),[2,r.promise]})})},t.prototype.onDisconnect=function(e,r){var i=r.error,a=i===void 0?null:i,s=r.autoReconnect,u=s!==void 0&&s,d=r.cause,h=d===void 0?null:d;return M(this,void 0,void 0,function(){var p;return R(this,function(g){switch(g.label){case 0:return p=Date.now(),this._halt(a??o1(h)),e.hasSession?[4,e.changeState(new W_({autoReconnect:u}),p)]:[3,2];case 1:return g.sent(),[3,4];case 2:return[4,e.changeState(new Do,p)];case 3:g.sent(),g.label=4;case 4:return[2]}})})},t.prototype.onDisconnectWebSocket=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return this._halt(o1((r==null?void 0:r.cause)||null)),i=Date.now(),e.hasSession?[4,e.changeState(new Am,i)]:[3,2];case 1:return a.sent(),[3,4];case 2:return[4,e.changeState(new Do,i)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},t.prototype.onLogout=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=Date.now(),this._halt(r??ee.connectionCanceled),[4,e.changeState(new Do,i)];case 1:return a.sent(),[2]}})})},t}(sd);function o1(n){var t=ee.connectionCanceled;if(n){var e=null;switch(n){case gc.ExternalSetBackground:e="Connection has been canceled due to the application having externally moved to background while in ConnectingState.";break;case gc.ExternalDisconnectWebSocket:e="Connection has been canceled because sb.disconnectWebSocket() was called while in ConnectingState."}e&&t.setDetail(e)}return t}var Eo,nC=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=Gt.INITIALIZED,e.name="initialized",e}return j(t,n),t.prototype.onConnect=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,e.changeState(new Rm({authToken:r}),i)];case 1:return a.sent(),[2]}})})},t.prototype.onLogout=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Do({wasPreviouslyConnected:!1}),r)];case 1:return i.sent(),[2]}})})},t}(sd),JF=function(n){function t(){return n.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return j(t,n),t}(Ai),e7=function(){function n(t){var e=t.pingDelegate,r=t.sdkState,i=t.logger;this.pingDelegate=e,this.sdkState=r,this._logger=i}return Object.defineProperty(n.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),n.prototype.ping=function(){var t,e=this;if(!this.sdkState.websocket)throw ee.connectionRequired;var r=new JF;try{var i=(t=this.sdkState.websocket.pongTimeout)!==null&&t!==void 0?t:5e3;this._pingTimeoutTimer=setTimeout(function(){e._logger.debug("pinger.ping() timeout"),e.pingDelegate.error()},i),this.pingDelegate.send(r),this._logger.debug("pinger.ping()")}catch(a){this._logger.debug("pinger.ping() error",a),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0),this.pingDelegate.error()}return r},n.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},n.prototype.refreshTimer=function(){var t,e=this;if(!this.sdkState.websocket)throw ee.connectionRequired;this._logger.debug("pinger.refreshTimer()");var r=(t=this.sdkState.websocket.pingInterval)!==null&&t!==void 0?t:15e3;this.stop(),this._pingTimer=setInterval(function(){e.ping()},r)},n.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping()},n.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=void 0),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},n}(),K2=["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash","multiple_file_send_max_size","notifications","message_template"],n7=function(n){function t(e,r){var i,a=r.sdkState,s=r.cacheContext,u=r.connectionHandlers,d=r.sessionManager,h=r.websocketClient,p=r.dispatcher,g=r.logger,E=r.entryState,y=E===void 0?new nC:E,C=this;return(C=n.call(this)||this)._stateUpdatedAt=0,C._connectingAt=0,C._connectedAt=0,C._logiReceivedAt=0,C._connectionRequestQueue=[],C._iid=e,C.sdkState=a,C.cacheContext=s,C.connectionHandlers=u,C._sessionManager=d,C._websocketClient=h,C._dispatcher=p,C._logger=g,C._currentState=y,!((i=C.sdkState.websocket)===null||i===void 0)&&i.pingerDisabled||(C._pinger=new e7({pingDelegate:{send:function(T){return C._websocketClient.send(T)},error:function(T){return C._websocketClient.error(T)}},sdkState:C.sdkState,logger:g})),C._websocketClient.on("open",function(){C._connectedAt=Date.now(),C._tryResolveConnectionRequest()}).on("message",function(T){T.code==="LOGI"&&(C.clearLoginTimer(),C._dispatcher.dispatch(T.as(C_)))}).on("ping-refresh",function(){var T;return(T=C._pinger)===null||T===void 0?void 0:T.refreshTimer()}).on("pong",function(){var T;return(T=C._pinger)===null||T===void 0?void 0:T.pong()}).on("error",function(){var T;return(T=C._pinger)===null||T===void 0?void 0:T.stop()}).on("close",function(){C._logiProcessingTimer=setTimeout(function(){C._logiProcessingTimer=void 0,C._unresolvedLogi||C._rejectConnectionRequest(ee.networkError)},500)}),C._dispatcher.on(function(T){T instanceof C_&&(C._unresolvedLogi=T,C._tryResolveConnectionRequest())}),C}return j(t,n),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSession",{get:function(){return this._sessionManager.session.hasSession},enumerable:!1,configurable:!0}),t.prototype.changeState=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return r>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=r,this._dispatcher.dispatch(new Aa({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return i.sent(),[2,!0];case 2:return[2,!1]}})})},t.prototype._tryResolveConnectionRequest=function(){var e;return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=this._unresolvedLogi,this._websocketClient.isOpen&&r?(this._unresolvedLogi=void 0,this._logiReceivedAt=Date.now(),r.error?[3,2]:[4,r.applyTo(this._iid)]):[3,3];case 1:return i.sent(),this._statLogConnection(),(e=this._pinger)===null||e===void 0||e.start(),this._connectionRequestQueue.forEach(function(a){return a.resolve()}),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.session.authToken=void 0,r.error.isSessionExpiredError||r.error.isSessionInvalidatedError?this._dispatcher.dispatch(new mc({reason:r.error.code,message:r.error.message})):this._logger.warn("login failed: ".concat(r.error)),this._rejectConnectionRequest(r.error),i.label=3;case 3:return[2]}})})},t.prototype._rejectConnectionRequest=function(e){var r;if((r=this._pinger)===null||r===void 0||r.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0){var i=this._connectionRequestQueue;this._connectionRequestQueue=[],i.forEach(function(a){return a.reject(e)}),this._statLogConnection(e)}},t.prototype._url=function(){var e,r=this.sdkState,i=r.appId,a=r.appVersion,s=r.userId,u=r.extensions,d=r.sendbirdRuntimeEnvironment,h=this.cacheContext.localCacheEnabled,p=this._sessionManager.session,g=(e=this.sdkState.websocket)===null||e===void 0?void 0:e.compression,E=!!(u??{}).sb_uikit,y=V_.userAgentWithExtension(u);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(wo.OS_VERSION),"&sv=").concat(encodeURIComponent(wo.SDK_VERSION),"&ai=").concat(i).concat(a?"&av=".concat(a):"").concat(p.hasSession?"":"&user_id=".concat(encodeURIComponent(s)),"&pmce=").concat(g?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(y,"&SB-SDK-User-Agent=").concat(encodeURIComponent(V_.sendbirdSdkUserAgentWithExtension(d)),"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(K2))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(h?1:0,"&include_poll_details=1").concat(E?"&uikit_config=1":"")},t.prototype._statLogConnection=function(e){var r;this._dispatcher.dispatch(new Qb(new Or({type:gr.WEBSOCKET_CONNECT,data:{host_url:(r=this.sdkState.websocket)===null||r===void 0?void 0:r.host,success:!e,latency:this._connectedAt>0?this._connectedAt-this._connectingAt:Date.now()-this._connectingAt,logi_latency:this._logiReceivedAt>0?this._logiReceivedAt-this._connectingAt:void 0,error_code:e==null?void 0:e.code,error_description:e==null?void 0:e.message}})))},t.prototype.connect=function(e){var r;return e===void 0&&(e=""),M(this,void 0,void 0,function(){var i,a,s,u=this;return R(this,function(d){return this._logiProcessingTimer&&(clearTimeout(this._logiProcessingTimer),this._logiProcessingTimer=void 0,this._rejectConnectionRequest(ee.connectionCanceled)),i=new Qi,this._connectionRequestQueue.push(i),this._connectionRequestQueue.length===1&&(this._connectingAt=Date.now(),this._connectedAt=0,this._logiReceivedAt=0,this._loginTimer=setTimeout(function(){u._loginTimer=void 0,u._rejectConnectionRequest(ee.loginTimeout)},(r=this.sdkState.websocket)===null||r===void 0?void 0:r.responseTimeout),a=this._sessionManager.session,e&&(a.authToken=e,a.sessionKey=void 0),s=this._url(),a.sessionKey||a.authToken?this._websocketClient.connect(s,JSON.stringify(a.hasSession?{auth:a.sessionKey}:{token:a.authToken})):this._websocketClient.connect(s,JSON.stringify({}))),[2,i.promise]})})},t.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(C_.asError(ee.connectionRenew))},t.prototype.disconnect=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this._websocketClient.disconnect()];case 1:return e.sent(),[2]}})})},t.prototype.logout=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this.sdkState.userId=void 0,this._unresolvedLogi=void 0,[4,this.disconnect()];case 1:return e.sent(),[4,this._sessionManager.clear()];case 2:return e.sent(),[2]}})})},t.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=void 0)},t}(rd),W2=function(n){function t(e){var r=e.appId,i=e.userId,a=e.includeUIKitConfig,s=a!==void 0&&a,u=e.localCacheEnabled,d=u===void 0||u,h=e.expiringSession,p=h===void 0||h,g=n.call(this)||this;return g.path="".concat(I5,"/").concat(i,"/authentication"),g.method=Ie.POST,g.params=ze({expiring_session:!!p,include_logi:!0,include_extra_data:String(K2),uikit_config:s,use_local_cache:d,app_id:r}),g.requireAuth=!1,g}return j(t,n),t}(Te),t7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.logi=new C_(e,"LOGI",r),i}return j(t,n),t}(Me);(function(n){n[n.ALL=0]="ALL",n[n.WEBSOCKET=1]="WEBSOCKET",n[n.API=2]="API"})(Eo||(Eo={}));var vr,l1,r7=[Yb,W2],i7=function(){function n(t,e){var r=e.session,i=e.sdkState,a=e.dispatcher,s=e.logger,u=e.useFetchCompat,d=u!==void 0&&u,h=this;this._currentConnectionStateType=Gt.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new qF(t,{session:r,sdkState:i,dispatcher:a,logger:s,useFetchCompat:d}),this._session=r,this._logger=s,this._dispatcher=a,this._dispatcher.on(function(p){var g,E,y;if(p instanceof Aa){var C=p.stateType;switch(h._currentConnectionStateType=C,C){case Gt.CONNECTED:h._resolveLazyCallQueue();break;case Gt.INITIALIZED:case Gt.INTERNAL_DISCONNECTED:case Gt.EXTERNAL_DISCONNECTED:case Gt.LOGOUT:h._session.isRefreshing||h._rejectLazyCallQueue(!((y=h._session)===null||y===void 0)&&y.hasSession?ee.connectionClosed:ee.connectionRequired)}}else if(p instanceof B2)h._session.hasChatServicePermission||h._resolveLazyCallQueue(Eo.API);else if(p instanceof ny||p instanceof G2)h._rejectLazyCallQueue(ee.connectionClosed);else if(p instanceof m2){var T=p.request,A=p.deferred,O=p.error;try{for(var N=Le(r7),k=N.next();!k.done;k=N.next())if(T instanceof k.value)return void A.reject(O)}catch(D){g={error:D}}finally{try{k&&!k.done&&(E=N.return)&&E.call(N)}finally{if(g)throw g.error}}h._lazyCallQueue.push({command:T,deferred:A})}})}return Object.defineProperty(n.prototype,"isReady",{get:function(){return this._currentConnectionStateType===Gt.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===Gt.CONNECTING||this._currentConnectionStateType===Gt.RECONNECTING||this._session.isRefreshing},enumerable:!1,configurable:!0}),n.prototype._classifyLazyCallQueueByScope=function(t){var e,r=[],i=[];switch(t){case Eo.ALL:e=null;break;case Eo.WEBSOCKET:e=Ai;break;case Eo.API:e=Te}var a=!1;return this._lazyCallQueue.forEach(function(s){!e||s.command instanceof e||(a=!0),a?i.push(s):r.push(s)}),[r,i]},n.prototype._resolveLazyCallQueue=function(t){var e=this;t===void 0&&(t=Eo.ALL);var r=cn(this._classifyLazyCallQueueByScope(t),2),i=r[0],a=r[1];this._lazyCallQueue=a,i.forEach(function(s){return M(e,void 0,void 0,function(){var u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:u=s.command,d=s.deferred,(h=s.timeout)&&clearTimeout(h),E.label=1;case 1:return E.trys.push([1,3,,4]),[4,this.send(u)];case 2:return p=E.sent(),d.resolve(p),[3,4];case 3:return g=E.sent(),d.reject(g),[3,4];case 4:return[2]}})})})},n.prototype._rejectLazyCallQueue=function(t,e){var r=this;e===void 0&&(e=Eo.ALL);var i=cn(this._classifyLazyCallQueueByScope(e),2),a=i[0],s=i[1];this._lazyCallQueue=s,a.forEach(function(u){return M(r,void 0,void 0,function(){var d,h;return R(this,function(p){return d=u.deferred,h=u.timeout,clearTimeout(h),d.reject(t),[2]})})})},n.prototype.send=function(t){return M(this,void 0,void 0,function(){var e,r,i=this;return R(this,function(a){switch(a.label){case 0:return t instanceof Ai?this.isReady?(this._logger.debug("send websocket request",t),[4,this.commandRouter.send(t)]):[3,2]:[3,4];case 1:case 5:case 7:return[2,a.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",t),e=new Qi,this._lazyCallQueue.push({command:t,deferred:e,timeout:setTimeout(function(){return i.timeout(t.requestId)},1e4)}),[2,e.promise];throw this._logger.debug("fail websocket request"),ee.connectionRequired;case 3:case 9:return[3,11];case 4:return t instanceof Te?this._session.hasSession?(this._logger.debug("send api request",t),[4,this.commandRouter.send(t)]):[3,6]:[3,10];case 6:return t.hasSessionKey?(this._logger.debug("send api request with tmp session key",t),[4,this.commandRouter.send(t)]):[3,8];case 8:if(this.isLazyCallActivated)return this._logger.debug("wait api request",t),e=new Qi,this._lazyCallQueue.push({command:t,deferred:e,timeout:setTimeout(function(){return i.timeout(t.requestId)},1e4)}),[2,e.promise];throw r=ee.connectionRequired,this._logger.debug("fail api request",r),r;case 10:throw ee.invalidCommand;case 11:return[2]}})})},n.prototype.forceSend=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this._logger.debug("send forced request",t),t instanceof Ai||t instanceof Te?[4,this.commandRouter.send(t)]:[3,2];case 1:return[2,e.sent()];case 2:throw ee.invalidCommand}})})},n.prototype.timeout=function(t){this._logger.debug("timeout request",t);var e=this._lazyCallQueue.findIndex(function(r){return r.command.requestId===t});e>-1&&(this._lazyCallQueue[e].deferred.reject(ee.connectionRequired),this._lazyCallQueue.splice(e,1))},n.prototype.cancel=function(t){this._logger.debug("cancel api request",t),this.commandRouter.cancel(t)},n.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll()},n}(),dE="sendbird@devicetokens",cE=function(){function n(t){var e=t.type,r=t.token,i=t.device_os,a=t.device_manufacturer,s=t.system_push_enabled;this.type=e,this.token=r,this.deviceOS=i,this.deviceManufacturer=a,this.systemPushEnabled=s}return n.payloadify=function(t){return ze(_n({type:t.type,token:t.token,device_os:t.deviceOS,device_manufacturer:t.deviceManufacturer,system_push_enabled:t.systemPushEnabled}))},n}(),fE=new WeakMap,a7=function(n){function t(e){var r=e._iid,i=e.session,a=e.cacheContext,s=e.sdkState,u=e.dispatcher,d=e.requestQueue,h=e.logger,p=e.pushNotificationAckManager,g=n.call(this)||this;return g._currentConnectionStateType=Gt.INITIALIZED,g._isRefreshingAuthToken=!1,g.currentUser=null,g.session=i,g._iid=r,g._cacheContext=a,g._sdkState=s,g._dispatcher=u,g._requestQueue=d,g._logger=h,g._pushNotificationAckManager=p,g._deviceTokens=[],g._dispatcher.on(function(E){var y,C,T;if(E instanceof Aa){var A=E.stateType;g._currentConnectionStateType=A}else if(E instanceof mc&&g.handler&&!g.isSessionKeyRefreshing){if(g._currentConnectionStateType===Gt.CONNECTING)return;!((y=E.error)===null||y===void 0)&&y.isSessionInvalidatedError?g.close():(!((C=E.error)===null||C===void 0)&&C.isSessionTokenExpiredError&&g.refreshAuthToken().catch(function(O){if(Gi(O)&&g._sdkState.appState==="foreground")throw O}),!((T=E.error)===null||T===void 0)&&T.isSessionKeyExpiredError&&(g._logger.debug("session expired"),g.handler.onSessionExpired&&g.handler.onSessionExpired(),g.refreshSessionKey().catch(function(O){if(Gi(O)&&g._sdkState.appState==="foreground")throw O})))}}),g}return j(t,n),Object.defineProperty(t.prototype,"ekey",{get:function(){return fE.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),t.prototype.indexOfDeviceToken=function(e,r){return this._deviceTokens.findIndex(function(i){return i.type===e&&i.token===r})},t.prototype.hasDeviceToken=function(e,r){return this.indexOfDeviceToken(e,r)>=0},t.prototype.createRefreshWebsocketCommand=function(e,r){return new U5({authToken:e,expiringSession:!0,requestId:r})},t.prototype._refreshSessionKeyByWebSocket=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return r=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(r)];case 1:if(i=d.sent(),a=i.as(F5),s=a.newKey,u=a.error)throw u;return this.session.sessionKey=s??this.session.sessionKey,[2]}})})},t.prototype._refreshSessionKeyByApi=function(e){return M(this,void 0,void 0,function(){var r,i=this;return R(this,function(a){switch(a.label){case 0:return r=new Yb({userId:this._sdkState.userId,authToken:e,services:this.session.services&&this.session.services.length>0?this.session.services:void 0,expiringSession:!0}),[4,wm(function(s){return M(i,void 0,void 0,function(){var u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:return E.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(r)];case 1:return u=E.sent(),d=u.as(P5),h=d.key,p=d.services,this.session.sessionKey=h,this.session.services=p,[3,3];case 2:if(g=E.sent(),!this._isSessionRelatedError(g))throw g;return s(g),[3,3];case 3:return[2]}})})},3)];case 1:return a.sent(),[2]}})})},t.prototype._refreshSessionKey=function(e,r){return r===void 0&&(r=!0),M(this,void 0,void 0,function(){var i,a;return R(this,function(s){switch(s.label){case 0:if(this._currentConnectionStateType!==Gt.CONNECTED)return[3,8];s.label=1;case 1:return s.trys.push([1,3,,8]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return s.sent(),this.complete(),[2];case 3:i=s.sent(),s.label=4;case 4:return s.trys.push([4,6,,7]),[4,this._handleSessionRefreshError(i,r)];case 5:return s.sent(),[2];case 6:return s.sent(),[3,7];case 7:return[3,8];case 8:return s.trys.push([8,10,,12]),[4,this._refreshSessionKeyByApi(e)];case 9:return s.sent(),this.complete(),[3,12];case 10:return a=s.sent(),[4,this._handleSessionRefreshError(a,r)];case 11:return s.sent(),[3,12];case 12:return[2]}})})},t.prototype._receiveNewAuthToken=function(){var e,r=this,i=new Qi;if(this._isRefreshingAuthToken=!0,this.session.sessionKey=void 0,this.session.authToken=void 0,(e=this.handler)===null||e===void 0?void 0:e.onSessionTokenRequired){var a=null,s=function(){a&&(clearTimeout(a),a=null)},u=function(h){s(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,i.resolve(h))},d=function(h){s(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,i.reject(h))};a=setTimeout(function(){return d()},1e3*this._sdkState.sessionTokenRefreshTimeout),an(function(){return M(r,void 0,void 0,function(){var h;return R(this,function(p){return!((h=this.handler)===null||h===void 0)&&h.onSessionTokenRequired&&this.handler.onSessionTokenRequired(u,d),[2]})})})}else i.resolve(null);return i.promise},t.prototype._handleSessionRefreshError=function(e,r){return r===void 0&&(r=!1),M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return e instanceof ee&&(e.isSessionTokenExpiredError||e.code===rn.APPLICATION_NOT_FOUND)?(this.session.authToken=void 0,r?[4,this._receiveNewAuthToken()]:[3,6]):[3,6];case 1:return(i=a.sent())?(this.session.authToken=i,[4,this._refreshSessionKey(this.session.authToken,!1)]):[3,3];case 2:return a.sent(),[3,5];case 3:return[4,this.clear()];case 4:a.sent(),a.label=5;case 5:return[2];case 6:throw e}})})},t.prototype._isSessionRelatedError=function(e){return e instanceof ee&&(e.isSessionExpiredError||e.isSessionInvalidatedError)},Object.defineProperty(t.prototype,"isSessionKeyRefreshing",{get:function(){return this.session.isRefreshing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiring",{get:function(){return!!this.handler},enumerable:!1,configurable:!0}),t.prototype.authenticate=function(e,r){var i;return M(this,void 0,void 0,function(){var a,s,u;return R(this,function(d){switch(d.label){case 0:return this.session.authToken=r,a=new W2({appId:this._sdkState.appId,userId:e,includeUIKitConfig:!!((i=this._sdkState.extensions)!==null&&i!==void 0?i:{}).sb_uikit,localCacheEnabled:this._cacheContext.localCacheEnabled,expiringSession:this.isSessionExpiring}),[4,this._requestQueue.commandRouter.send(a)];case 1:return s=d.sent(),(u=s.as(t7).logi).error?[3,4]:this.session.hasChatServicePermission?[3,3]:[4,u.applyTo(this._iid)];case 2:d.sent(),d.label=3;case 3:return[3,5];case 4:throw u.error;case 5:return[2]}})})},t.prototype.login=function(e){var r;return M(this,void 0,void 0,function(){var i,a,s,u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:return i=e.key,a=e.ekey,s=e.services,u=e.userProfile,d=e.deviceTokenLastDeletedAt,h=d===void 0?0:d,this.session.sessionKey=i,this.session.services=s,fE.set(this,a),this._deviceTokenCacheEnabled=(r=u==null?void 0:u.appInfo)===null||r===void 0?void 0:r.deviceTokenCache,p=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,p.get(dE)]:[3,5];case 1:return!(g=E.sent())||g.lastDeletedAt<h?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=h,[4,this.saveDeviceToken()]):[3,3];case 2:return E.sent(),[3,4];case 3:this._deviceTokens=g.tokens.map(function(y){return new cE(cE.payloadify(y))}),this._deviceTokenLastDeletedAt=g.lastDeletedAt,E.label=4;case 4:return[3,7];case 5:return[4,p.remove(dE)];case 6:E.sent(),E.label=7;case 7:return[2]}})})},t.prototype.complete=function(){var e=this;this.dispatch("refresh"),this._dispatcher.dispatch(new B2),an(function(){return M(e,void 0,void 0,function(){var r;return R(this,function(i){return this._logger.debug("session refreshed"),!((r=this.handler)===null||r===void 0)&&r.onSessionRefreshed&&this.handler.onSessionRefreshed(),[2]})})})},t.prototype.error=function(e){var r=this;an(function(){return M(r,void 0,void 0,function(){var i;return R(this,function(a){return!((i=this.handler)===null||i===void 0)&&i.onSessionError&&this.handler.onSessionError(e),[2]})})})},t.prototype.close=function(){var e=this;this.dispatch("close"),this._dispatcher.dispatch(new G2),an(function(){return M(e,void 0,void 0,function(){var r;return R(this,function(i){return this._logger.debug("session closed"),!((r=this.handler)===null||r===void 0)&&r.onSessionClosed&&this.handler.onSessionClosed(),[2]})})})},t.prototype.refreshAuthToken=function(){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:if(e=null,!this.isSessionExpiring||this.session.isRefreshing)return[3,9];this.session.isRefreshing=!0,i.label=1;case 1:return i.trys.push([1,7,8,9]),[4,this._receiveNewAuthToken()];case 2:return(e=i.sent())?(this._logger.debug("session refreshing.."),this.session.authToken=e,[4,this._refreshSessionKey(this.session.authToken)]):[3,4];case 3:return i.sent(),[3,6];case 4:return[4,this.clear()];case 5:i.sent(),i.label=6;case 6:return[3,9];case 7:throw i.sent(),r=e?ee.sessionTokenRefreshFailed:ee.sessionTokenRequestFailed,this._dispatcher.dispatch(new ny),this.error(r),this._logger.debug("refresh auth token error = ",r),r;case 8:return this.session.isRefreshing=!1,[7];case 9:return[2]}})})},t.prototype.refreshSessionKey=function(){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:if(!this.isSessionExpiring||this.session.isRefreshing)return[3,5];this.session.isRefreshing=!0,r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,this._refreshSessionKey(this.session.authToken)];case 2:return r.sent(),[3,5];case 3:throw r.sent(),e=ee.sessionTokenRefreshFailed,this._dispatcher.dispatch(new ny),this.error(e),e;case 4:return this.session.isRefreshing=!1,[7];case 5:return[2]}})})},t.prototype.setDeviceToken=function(e,r,i){if(this._deviceTokenCacheEnabled&&this.indexOfDeviceToken(e,r)<0){var a=new cE({type:e,token:r,device_os:i==null?void 0:i.deviceOS,device_manufacturer:i==null?void 0:i.deviceManufacturer,system_push_enabled:i==null?void 0:i.systemPushEnabled});return this._deviceTokens.push(a),!0}return!1},t.prototype.unsetDeviceToken=function(e,r){if(this._deviceTokenCacheEnabled){var i=this.indexOfDeviceToken(e,r);i>=0&&this._deviceTokens.splice(i,1)}},t.prototype.unsetDeviceTokens=function(e){this._deviceTokenCacheEnabled&&(this._deviceTokens=e?this._deviceTokens.filter(function(r){return r.type!==e}):[])},t.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e)},t.prototype.saveDeviceToken=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(dE,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this.currentUser=null,this.session.clear(),this.close(),fE.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),this._pushNotificationAckManager.clear(),[2]}})})},t}(rd),$2=function(n,t){var e,r;if(n!==null&&t!==null){var i=Object.keys(n),a=Object.keys(t),s=Nn([],cn(new Set(Nn(Nn([],cn(i),!1),cn(a),!1))),!1),u={};try{for(var d=Le(s),h=d.next();!h.done;h=d.next()){var p=h.value,g=typeof n[p],E=typeof t[p];g==="undefined"?u[p]=t[p]:E==="undefined"?u[p]=n[p]:g!==E?u[p]=t[p]:g==="object"&&n[p]&&t[p]?u[p]=$2(n[p],t[p]):u[p]=t[p]}}catch(y){e={error:y}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}return u}return t};(function(n){n[n.PENDING=0]="PENDING",n[n.COLLECT_ONLY=1]="COLLECT_ONLY",n[n.ENABLED=2]="ENABLED",n[n.DISABLED=3]="DISABLED"})(vr||(vr={})),function(n){n.DAILY="daily",n.DEFAULT="default",n.REALTIME="realtime"}(l1||(l1={}));var Y_,Mm=100,tC=function(){function n(t){var e=t.deviceId,r=t.cacheContext,i=t.requestQueue;this.queue=[],this.flushWaitQueue=[],this.enabledState=vr.PENDING,this.isFlushing=!1,this._sentLogStats=[],this.deviceId=e,this.cacheContext=r,this.requestQueue=i,this.logInfo={deviceId:e,statLogs:[],generation:1,lastFlushedAt:0},this.limit=Mm}return Object.defineProperty(n.prototype,"isEnabled",{get:function(){return this.enabledState===vr.ENABLED},enumerable:!1,configurable:!0}),n.prototype.init=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return this.key=t,[4,this.cacheContext.preference.get(this.key)];case 1:return(e=r.sent())&&(this.logInfo=e),[2]}})})},n.prototype._mergeQueue=function(){this.flushWaitQueue.length>0&&(this.queue=this.queue.concat(this.flushWaitQueue),this.flushWaitQueue=[])},n.prototype._isDuplicateStat=function(t){var e=this._sentLogStats.find(function(r){var i;return r.channelUrl===t.data.channel_url&&r.messageId===((i=t.data.notificationId)!==null&&i!==void 0?i:t.data.message_id)&&r.action===t.data.action});return e||this._sentLogStats.push({channelUrl:t.data.channel_url,messageId:t.data.message_id,action:t.data.action}),!!e},n.prototype._save=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return t=Nn(Nn([],cn(this.queue),!1),cn(this.flushWaitQueue),!1),[4,this.cacheContext.preference.set(this.key,{deviceId:this.logInfo.deviceId,statLogs:t.map(function(r){return Or.payloadify(r)}),generation:this.logInfo.generation++,lastFlushedAt:this.logInfo.lastFlushedAt})];case 1:return e.sent(),[2]}})})},n.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(t){return this.queue=[],this.flushWaitQueue=[],this.logInfo.generation=1,this._save(),[2]})})},n}(),bh=function(n){function t(e){var r,i,a,s,u=e.type,d=e.data,h=e.ts,p=h===void 0?Date.now():h,g=n.call(this,{type:u,data:d,ts:p})||this;return g.date=new Date(p),g.key="".concat((r=g.date,i=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0"),"".concat(i).concat(a).concat(s)),"_").concat(u),g}return j(t,n),t}(Or),Y2=function(n){function t(e){var r=e.deviceId,i=e.statLogs,a=n.call(this)||this;return a.method=Ie.POST,a.path="".concat(M5),a.params={device_id:r,log_entries:i.map(function(s){return Or.payloadify(s)})},a}return j(t,n),t}(Te),s7=function(n){function t(e){var r=e.deviceId,i=e.cacheContext,a=e.requestQueue;return n.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return j(t,n),Object.defineProperty(t.prototype,"_isSendable",{get:function(){return this.queue.length!==0&&Date.now()-this.logInfo.lastFlushedAt>=this.statConfig.minInterval},enumerable:!1,configurable:!0}),t.prototype.init=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,n.prototype.init.call(this,e+".daily")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){return new Or({type:i.stat_type,ts:i.ts,data:i.data})}),[2]}})})},t.prototype.setConfig=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this.statConfig=e,this.statConfig.minInterval=864e5,this._mergeQueue(),r.localCacheStat?(this.enabledState=r.enabledStat?vr.ENABLED:vr.COLLECT_ONLY,[3,3]):[3,1];case 1:return this.enabledState=vr.DISABLED,[4,this.clear()];case 2:d.sent(),d.label=3;case 3:return this.isEnabled&&this._isSendable?[4,this._getUploadStats()]:[3,9];case 4:i=d.sent(),a=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),s=0,d.label=5;case 5:return s<i.length?(u=i.slice(s,1+this.statConfig.maxStatCountPerRequest),[4,sa(a)]):[3,9];case 6:return d.sent(),[4,this._flush(u)];case 7:d.sent(),d.label=8;case 8:return s+=this.statConfig.maxStatCountPerRequest,[3,5];case 9:return[2]}})})},t.prototype.put=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return this.enabledState===vr.DISABLED?[2,!0]:(r=this.enabledState===vr.PENDING||this.isFlushing?this.flushWaitQueue:this.queue,i=cn(r.filter(function(d){return d instanceof bh&&d.key===e.key}),1),(a=i[0])?a.data=$2(a.data,e.data):r.push(e),this.enabledState===vr.PENDING?[3,2]:[4,this._save()]);case 1:u.sent(),u.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this._isSendable?[4,this._getUploadStats()]:[3,5]):[3,5];case 3:return s=u.sent(),[4,this._flush(s)];case 4:return[2,u.sent()];case 5:return[2,!0]}})})},t.prototype._getUploadStats=function(){return M(this,void 0,void 0,function(){var e;return R(this,function(r){return e=this.queue.filter(function(i){if(i instanceof bh){var a=new Date,s=cn([i.date.getFullYear(),a.getFullYear()],2),u=s[0],d=s[1];if(u<d)return!0;if(u===d){var h=cn([i.date.getMonth(),a.getMonth()],2),p=h[0],g=h[1];if(p<g)return!0;if(p===g){var E=cn([i.date.getDate(),a.getDate()],2);return E[0]<E[1]}}}return!1}),[2,e]})})},t.prototype._flush=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:if(r=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,u.label=1;case 1:return u.trys.push([1,4,8,9]),i=Nn([],cn(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new Y2({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return u.sent(),this.queue=Nn([],cn(e),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=Mm,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return u.sent(),[3,9];case 4:return(s=u.sent())instanceof ee?s.code!==rn.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return u.sent(),this.enabledState=vr.DISABLED,[3,7];case 6:s.code===rn.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=vr.COLLECT_ONLY),u.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,u.label=11;case 11:return[2,r]}})})},t}(tC),u7=function(n){function t(e){var r=e.deviceId,i=e.cacheContext,a=e.requestQueue;return n.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return j(t,n),t.prototype._isSendable=function(e){if(e===void 0&&(e=!1),this.queue.length<this.statConfig.lowerThreshold)return!1;if(e){if(Date.now()-this.logInfo.lastFlushedAt<this.statConfig.minInterval)return!1}else if(this.queue.length<this.statConfig.minStatCount)return!1;return!0},t.prototype._filterQueueByType=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){return[2,r?e.filter(function(a){return a.type!==gr.FEATURE_LOCALCACHE_EVENT}):e.filter(function(a){return a.type===gr.FEATURE_LOCALCACHE_EVENT})]})})},t.prototype.init=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,n.prototype.init.call(this,e+".default")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){return i.data=W({message_init_policy:"",starting_point:0},i.data),new Or({type:i.stat_type,ts:i.ts,data:i.data})}),[2]}})})},t.prototype.setConfig=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this.statConfig=e,this._mergeQueue(),r.requestStat||r.localCacheStat?(this.enabledState=r.enabledStat?vr.ENABLED:vr.COLLECT_ONLY,i=void 0,r.requestStat||(i=!1),r.localCacheStat||(i=!0),i===void 0?[3,3]:(a=this,[4,this._filterQueueByType(this.queue,i)])):[3,4];case 1:return a.queue=d.sent(),s=this,[4,this._filterQueueByType(this.flushWaitQueue,i)];case 2:s.flushWaitQueue=d.sent(),this._save(),d.label=3;case 3:return[3,6];case 4:return this.enabledState=vr.DISABLED,[4,this.clear()];case 5:d.sent(),d.label=6;case 6:return this.isEnabled&&this._isSendable(!0)?(u=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),[4,sa(u)]):[3,9];case 7:return d.sent(),[4,this._flush(this.queue)];case 8:d.sent(),d.label=9;case 9:return[2]}})})},t.prototype.put=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return this.enabledState===vr.DISABLED?[2,!0]:((r=this.enabledState===vr.PENDING||this.isFlushing?this.flushWaitQueue:this.queue).push(e),this.enabledState===vr.PENDING?[3,2]:[4,this._save()]);case 1:i.sent(),i.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this._isSendable()?[4,this._flush(r)]:[3,4]):[3,4];case 3:return[2,i.sent()];case 4:return[2,!0]}})})},t.prototype._flush=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:if(r=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,u.label=1;case 1:return u.trys.push([1,4,8,9]),i=Nn([],cn(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new Y2({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return u.sent(),this.queue=Nn([],cn(e),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=Mm,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return u.sent(),[3,9];case 4:return(s=u.sent())instanceof ee?s.code!==rn.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return u.sent(),this.enabledState=vr.DISABLED,[3,7];case 6:s.code===rn.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=vr.COLLECT_ONLY),u.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,u.label=11;case 11:return[2,r]}})})},t}(tC),o7=function(n){function t(e){var r=e.deviceId,i=e.statLogs,a=n.call(this)||this;return a.method=Ie.POST,a.path="".concat(O5),a.params={device_id:r,log_entries:i.map(function(s){return Or.payloadify(s)})},a}return j(t,n),t}(Te),l7=function(n){function t(e){var r=e.deviceId,i=e.cacheContext,a=e.requestQueue;return n.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return j(t,n),Object.defineProperty(t.prototype,"_isSendable",{get:function(){return this.queue.length>=this.statConfig.minStatCount&&this.queue.length>this.statConfig.lowerThreshold||this.logInfo.lastFlushedAt>0&&Date.now()-this.logInfo.lastFlushedAt>=this.statConfig.minInterval},enumerable:!1,configurable:!0}),t.prototype.init=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,n.prototype.init.call(this,e+".realtime")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){var a;return i.data=ze(W(W({},i.data),{message_id:(a=i.data.notificationId)!==null&&a!==void 0?a:i.data.message_id,notificationId:void 0})),new Or({type:i.stat_type,ts:i.ts,data:i.data})}),this._sentLogStats=this.queue.map(function(i){var a;return{channelUrl:i.data.channelUrl,messageId:(a=i.data.notificationId)!==null&&a!==void 0?a:i.data.message_id,action:i.data.action}}),[2]}})})},t.prototype.setConfig=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return this.statConfig=e,this._mergeQueue(),r.notificationStat?(this.enabledState=r.enabledStat?vr.ENABLED:vr.COLLECT_ONLY,[3,3]):[3,1];case 1:return this.enabledState=vr.DISABLED,[4,this.clear()];case 2:a.sent(),a.label=3;case 3:return this.isEnabled&&this._isSendable?(i=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),[4,sa(i)]):[3,6];case 4:return a.sent(),[4,this._flush(this.queue)];case 5:a.sent(),a.label=6;case 6:return[2]}})})},t.prototype.put=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return this.enabledState===vr.DISABLED?[2,!0]:(r=this.enabledState===vr.PENDING||this.isFlushing?this.flushWaitQueue:this.queue,this._isDuplicateStat(e)?[2,!0]:(r.push(e),this.enabledState===vr.PENDING?[3,2]:[4,this._save()]));case 1:i.sent(),i.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this.isEnabled&&this._isSendable?[4,this._flush(r)]:[3,4]):[3,4];case 3:return[2,i.sent()];case 4:return[2,!0]}})})},t.prototype._flush=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:if(r=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,u.label=1;case 1:return u.trys.push([1,4,8,9]),i=Nn([],cn(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new o7({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return u.sent(),this.queue=Nn([],cn(e),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=Mm,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return u.sent(),[3,9];case 4:return(s=u.sent())instanceof ee?s.code!==rn.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return u.sent(),this.enabledState=vr.DISABLED,[3,7];case 6:s.code===rn.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=vr.COLLECT_ONLY),u.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,u.label=11;case 11:return[2,r]}})})},t}(tC),d7=function(){function n(t){var e=t.cacheContext,r=t.requestQueue,i=t.dispatcher,a=t.logger;this._collectRequestStat=!0,this._collectFeatureLocalCacheStat=!0,this._collectionNotificationStat=!0,this._retryCount=0,this.deviceId=Bu(),this.cacheContext=e,this.requestQueue=r,this.dispatcher=i,this.logger=a,this._dailyStatCollector=new s7({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue}),this._defaultStatCollector=new u7({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue}),this._notificationStatCollector=new l7({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue})}return n.prototype._migration=function(){return M(this,void 0,void 0,function(){var t,e,r,i;return R(this,function(a){switch(a.label){case 0:return[4,this.cacheContext.preference.get(this.key)];case 1:return(t=a.sent())?(e=[],t.statLogs.forEach(function(s){s.stat_type===gr.FEATURE_LOCALCACHE&&e.push(new Or({type:s.stat_type,ts:s.ts,data:s.data}))}),[4,this.cacheContext.preference.set(this.key+".daily",{deviceId:t.deviceId,statLogs:e.map(function(s){return Or.payloadify(s)}),generation:t.generation,lastFlushedAt:t.lastFlushedAt})]):[3,6];case 2:return a.sent(),r=[],t.statLogs.forEach(function(s){s.stat_type!==gr.FEATURE_LOCALCACHE&&s.stat_type!==gr.NOTIFICATION&&(s.stat_type===gr.FEATURE_LOCALCACHE_EVENT&&(s.data=W({message_init_policy:"",starting_point:0},s.data)),r.push(new Or({type:s.stat_type,ts:s.ts,data:s.data})))}),[4,this.cacheContext.preference.set(this.key+".default",{deviceId:t.deviceId,statLogs:r.map(function(s){return Or.payloadify(s)}),generation:t.generation,lastFlushedAt:t.lastFlushedAt})];case 3:return a.sent(),i=[],t.statLogs.forEach(function(s){var u;s.stat_type===gr.NOTIFICATION&&(s.data=ze(W(W({},s.data),{message_id:(u=s.data.notificationId)!==null&&u!==void 0?u:s.data.message_id,notificationId:void 0})),i.push(new Or({type:s.stat_type,ts:s.ts,data:s.data})))}),[4,this.cacheContext.preference.set(this.key+".realtime",{deviceId:t.deviceId,statLogs:i.map(function(s){return Or.payloadify(s)}),generation:t.generation,lastFlushedAt:t.lastFlushedAt})];case 4:return a.sent(),[4,this.cacheContext.preference.remove(this.key)];case 5:a.sent(),a.label=6;case 6:return[2]}})})},n.prototype.init=function(t){return M(this,void 0,void 0,function(){var e=this;return R(this,function(r){switch(r.label){case 0:return this.key=t,[4,this._migration()];case 1:return r.sent(),[4,this._dailyStatCollector.init(this.key)];case 2:return r.sent(),[4,this._defaultStatCollector.init(this.key)];case 3:return r.sent(),[4,this._notificationStatCollector.init(this.key)];case 4:return r.sent(),this.commandEventContext||(this.commandEventContext=this.dispatcher.on(function(i){return M(e,void 0,void 0,function(){var a,s,u,d,h,p;return R(this,function(g){return i instanceof Qb?(a=i.statLog,this.put(a)):i instanceof j2&&(s=i.request,u=i.features,d=i.options,h=i.statConfigInfo,this._retryCount=0,this._collectRequestStat=s,this._collectFeatureLocalCacheStat=u==null?void 0:u.localCache,this._collectionNotificationStat=u==null?void 0:u.notification,this._statConfig=h,this._dailyStatCollector.setConfig(this._statConfig.default,{localCacheStat:this._collectFeatureLocalCacheStat,enabledStat:d.ingestion}),this._defaultStatCollector.setConfig(this._statConfig.default,{requestStat:this._collectRequestStat,localCacheStat:this._collectFeatureLocalCacheStat,enabledStat:d.ingestion}),this._notificationStatCollector.setConfig((p=this._statConfig.realTime)!==null&&p!==void 0?p:this._statConfig.default,{notificationStat:this._collectionNotificationStat,enabledStat:d.ingestion})),[2]})})})),[2]}})})},n.prototype.put=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return e=!0,t instanceof bh?this._collectFeatureLocalCacheStat?[4,this._dailyStatCollector.put(t)]:[3,2]:[3,3];case 1:e=r.sent(),r.label=2;case 2:return[3,13];case 3:switch(t.type){case gr.API_RESULT:case gr.WEBSOCKET_CONNECT:return[3,4];case gr.FEATURE_LOCALCACHE:case gr.FEATURE_LOCALCACHE_EVENT:return[3,7];case gr.NOTIFICATION:return[3,10]}return[3,13];case 4:return this._collectRequestStat?[4,this._defaultStatCollector.put(t)]:[3,6];case 5:e=r.sent(),r.label=6;case 6:return[3,13];case 7:return this._collectFeatureLocalCacheStat?[4,this._defaultStatCollector.put(t)]:[3,9];case 8:e=r.sent(),r.label=9;case 9:return[3,13];case 10:return this._collectionNotificationStat?[4,this._notificationStatCollector.put(t)]:[3,12];case 11:e=r.sent(),r.label=12;case 12:return[3,13];case 13:return e?this._retryCount=0:(this._retryCount++,this._retryCount>20&&(this._dailyStatCollector.enabledState=vr.COLLECT_ONLY,this._defaultStatCollector.enabledState=vr.COLLECT_ONLY,this._notificationStatCollector.enabledState=vr.COLLECT_ONLY,this.logger.debug(ee.statLogUploadLimitExceededError))),[2]}})})},n.prototype.close=function(){this.commandEventContext&&(this.commandEventContext.close(),this.commandEventContext=void 0)},n}(),c7=function(){function n(t){var e=t.limit,r=e===void 0?5:e;this.workersByKey={},this.limit=r}return n.prototype.run=function(t,e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return this.workersByKey[t]||(this.workersByKey[t]=[]),this.workersByKey[t].length<this.limit?(this.workersByKey[t].push(e),[4,e()]):[3,2];case 1:return r=i.sent(),this.workersByKey[t].pop(),[2,r];case 2:throw ee.tooManyRequests}})})},n.prototype.clear=function(t){this.workersByKey[t]=[]},n}();(function(n){n.DELIVERY_RECEIPT="delivery_receipt",n.PUSH_ACKNOWLEDGEMENT="push_acknowledgement"})(Y_||(Y_={}));var ge,f7=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._pushAckedCache={},e}return j(t,n),t.prototype.isAcked=function(e,r){var i,a="".concat(e,"_").concat(r);return(i=this._pushAckedCache[a])!==null&&i!==void 0&&i},t.prototype.markAsAcked=function(e,r){var i="".concat(e,"_").concat(r);this._pushAckedCache[i]=!0},t.prototype.clear=function(){X.of(this._iid).logger.debug("clear push acked cache"),this._pushAckedCache={}},t.prototype.parseData=function(e){var r,i,a,s,u=X.of(this._iid).logger,d=e.sendbird;if(typeof d=="string")try{d=JSON.parse(d)}catch{throw u.info("push notification payload does not contain sendbird payload in JSON format."),ee.malformedDataError}if(!d||typeof d!="object")throw u.info("push notification payload does not contain sendbird payload in JSON format."),ee.malformedDataError;var h=(r=d.push_tracking_id)!==null&&r!==void 0?r:"",p=d.notification_message_id,g=d.notification_channel_key,E=d.notification_template_key,y=d.notification_event_deadline,C=(i=d.session_key)!==null&&i!==void 0?i:{},T=(a=C==null?void 0:C.key)!==null&&a!==void 0?a:"",A=(s=C==null?void 0:C.topics)!==null&&s!==void 0?s:[];if(typeof h!="string"||h.length===0)throw u.info("push tracking id is not available"),ee.malformedDataError;if(typeof p!="string"||p.length===0)throw u.info("message id is not available"),ee.malformedDataError;return{pushTrackingId:h,sessionKey:T,sessionTopics:A,messageId:p,channelKey:g,templateKey:E,notificationEventDeadline:y}},t}(Zr),cc=function(n){this.name=n.name,this._custom=n.custom,this._usedByModerationEngine=n.used_by_moderation_engine},h7=function(n){function t(){var e=n.call(this)||this;return e.method=Ie.GET,e.path=L5,e}return j(t,n),t}(Te),p7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.reportCategories=r.categories,i}return j(t,n),t}(Me),_7=function(n){function t(e){var r=n.call(this,e)||this;return r._categories=[],r}return j(t,n),t.prototype.categories=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this._categories.length!==0?[3,2]:[4,this._fetchCategories()];case 1:e.sent(),e.label=2;case 2:return[2,this._categories]}})})},t.prototype._fetchCategories=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return e=X.of(this._iid).requestQueue,r=new h7,[4,e.send(r)];case 1:return i=u.sent(),(a=i.as(p7).reportCategories)&&(s=this._categories).push.apply(s,Nn([],cn(a.map(function(d){return new cc(d)})),!1)),[2]}})})},t}(Zr),Cl={},X=function(){function n(t,e){var r,i,a,s,u,d,h,p,g;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!Cl[t]){Cl[t]=this;var E=(r=e.options)!==null&&r!==void 0?r:new o2,y=this.sdkState={appId:e.appId,appVersion:(i=e.appVersion)!==null&&i!==void 0?i:"",appState:"foreground",userId:void 0,extensions:{},api:{host:(a=e.apiHost)!==null&&a!==void 0?a:"https://api-".concat(e.appId,".sendbird.com")},websocket:{host:(s=e.websocketHost)!==null&&s!==void 0?s:"wss://ws-".concat(e.appId,".sendbird.com"),pingerDisabled:!!e.noPingpong,pingInterval:void 0,pongTimeout:void 0,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new q2,responseTimeout:E.websocketResponseTimeout},sessionTokenRefreshTimeout:E.sessionTokenRefreshTimeout};this.appInfo=void 0,this.subscribedUnreadMessageCount={all:0,feed:0,customTypes:{},ts:0};var C=this.logger=e.logger;this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var T=this.cacheContext=new E5({encryption:e.encryption,store:e.store,localCacheEnabled:(u=e.localCacheEnabled)!==null&&u!==void 0&&u,localCacheConfig:(d=e.localCacheConfig)!==null&&d!==void 0?d:new d2});this.debugMode=(h=e.debugMode)!==null&&h!==void 0&&h,this.maxSuperGroupChannelUnreadCount=wo.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=E.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=E.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=E.typingIndicatorThrottle,this.concurrentCallLimit=void 0,this.backOffDelay=void 0;var A=this.dispatcher=new C5,O=new b5;this.requestQueue=new i7(t,{session:O,sdkState:y,dispatcher:A,logger:C,useFetchCompat:e.useFetchCompat}),this.pushNotificationAckManager=new f7(t),this.sessionManager=new a7({_iid:t,session:O,cacheContext:T,sdkState:y,dispatcher:A,requestQueue:this.requestQueue,logger:C,pushNotificationAckManager:this.pushNotificationAckManager}),this.connectionManager=new XF(t,{sdkState:y,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:A,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:(p=e.disableWebSocketCloseEventHandling)!==null&&p!==void 0&&p,logger:C}),this.statManager=new d7({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:this.dispatcher,logger:C}),this.appStateToggleEnabled=(g=e.appStateToggleEnabled)===null||g===void 0||g,this.messageBackgroundSyncThrottleController=new c7({limit:5}),this.reportCategoryManager=new _7(t)}return Cl[t]}return n.of=function(t){if(Cl[t])return Cl[t];throw ee.lostInstance},n.clear=function(t){Cl[t]&&delete Cl[t]},n.prototype.hasExtension=function(t){return this.sdkState.extensions&&this.sdkState.extensions[t]},n}(),Om=function(){function n(){}return n.prototype.init=function(t,e){var r=e.sdkState,i=e.dispatcher,a=e.sessionManager,s=e.requestQueue,u=e.logger;e.onlineDetector;var d=e.cacheContext;this._iid=t,this._cacheContext=d,this._sdkState=r,this._dispatcher=i,this._sessionManager=a,this._requestQueue=s,this._logger=u},n}();(function(n){n.UNKNOWN="UNKNOWN",n.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",n.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",n.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",n.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",n.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",n.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",n.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",n.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",n.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",n.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",n.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",n.EVENT_CHANNEL_BANNED="EVENT_CHANNEL_BANNED",n.EVENT_CHANNEL_UNBANNED="EVENT_CHANNEL_UNBANNED",n.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",n.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",n.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",n.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",n.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",n.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",n.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",n.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",n.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",n.EVENT_CHANNEL_METADATA_CREATED="EVENT_CHANNEL_METADATA_CREATED",n.EVENT_CHANNEL_METADATA_UPDATED="EVENT_CHANNEL_METADATA_UPDATED",n.EVENT_CHANNEL_METADATA_DELETED="EVENT_CHANNEL_METADATA_DELETED",n.EVENT_CHANNEL_METACOUNTER_CREATED="EVENT_CHANNEL_METACOUNTER_CREATED",n.EVENT_CHANNEL_METACOUNTER_UPDATED="EVENT_CHANNEL_METACOUNTER_UPDATED",n.EVENT_CHANNEL_METACOUNTER_DELETED="EVENT_CHANNEL_METACOUNTER_DELETED",n.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",n.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",n.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",n.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",n.REQUEST_CHANNEL="REQUEST_CHANNEL",n.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",n.REFRESH_CHANNEL="REFRESH_CHANNEL",n.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",n.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",n.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS",n.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",n.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",n.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",n.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",n.EVENT_MESSAGE_FEEDBACK_ADDED="EVENT_MESSAGE_FEEDBACK_ADDED",n.EVENT_MESSAGE_FEEDBACK_UPDATED="EVENT_MESSAGE_FEEDBACK_UPDATED",n.EVENT_MESSAGE_FEEDBACK_DELETED="EVENT_MESSAGE_FEEDBACK_DELETED",n.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",n.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",n.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",n.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",n.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",n.REQUEST_MESSAGE="REQUEST_MESSAGE",n.EVENT_THREAD_INFO_UPDATED="EVENT_THREADINFO_UPDATED",n.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",n.EVENT_POLL_VOTED="EVENT_POLL_VOTED",n.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",n.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",n.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",n.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",n.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",n.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",n.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",n.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",n.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",n.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",n.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"})(ge||(ge={}));var vc;W({},ge);var wu=function(n){return n.startsWith("EVENT_")||n.startsWith("LOCAL_MESSAGE_")||n===ge.SYNC_MESSAGE_FILL||n===ge.SYNC_MESSAGE_CHANGELOGS||n===ge.SYNC_POLL_CHANGELOGS},mr=function(n){function t(e){var r=e.messages,i=e.source,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.messages=r,u.source=i,u.isWebSocketEventComing=s,u}return j(t,n),t}(Cr),rC=function(n){function t(e){var r=e.messageIds,i=e.source,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.messageIds=r,u.source=i,u.isWebSocketEventComing=s,u}return j(t,n),t}(Cr),Q2=function(n){function t(e){var r=e.event,i=e.source,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.event=r,u.source=i,u.isWebSocketEventComing=s,u}return j(t,n),t}(Cr),Z2=function(n){function t(e){var r=e.event,i=e.source,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.event=r,u.source=i,u.isWebSocketEventComing=s,u}return j(t,n),t}(Cr),X2=function(n){function t(e){var r=e.reqId,i=e.source,a=n.call(this)||this;return a.reqId=r,a.source=i,a}return j(t,n),t}(Cr),J2=function(n){function t(e){var r=e.polls,i=e.source,a=n.call(this)||this;return a.polls=r,a.source=i,a}return j(t,n),t}(Cr),iC=function(n){function t(e){var r=e.event,i=e.source,a=n.call(this)||this;return a.event=r,a.source=i,a}return j(t,n),t}(Cr),km=function(n){function t(e){var r=e.event,i=e.source,a=n.call(this)||this;return a.event=r,a.source=i,a}return j(t,n),t}(Cr);(function(n){n.OPEN="open",n.CLOSED="closed"})(vc||(vc={}));var eM="removed",ry=function(n){switch(n){case"open":return vc.OPEN;case"closed":return vc.CLOSED;default:return null}},nM=function(n){return!n||!!n.text&&J("string",n.text)},I_=function(n){function t(e,r){var i,a,s,u,d,h,p,g=this;return(g=n.call(this,e)||this).pollId=0,g.id=0,g.text=null,g.voteCount=0,g.createdBy=null,g.createdAt=0,g.updatedAt=0,g._lastVotedAt=0,g.pollId=(i=r.poll_id)!==null&&i!==void 0?i:0,g.id=(a=r.id)!==null&&a!==void 0?a:0,g.text=(s=r.text)!==null&&s!==void 0?s:null,g.voteCount=(u=r.vote_count)!==null&&u!==void 0?u:0,g.createdBy=(d=r.created_by)!==null&&d!==void 0?d:null,g.createdAt=(h=r.created_at)!==null&&h!==void 0?h:0,g.updatedAt=(p=r.updated_at)!==null&&p!==void 0?p:0,g}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{vote_count:e.voteCount,poll_id:e.pollId,text:e.text,created_at:e.createdAt,id:e.id,created_by:e.createdBy,updated_at:e.updatedAt})))},t}(Zr),ds=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y,C,T,A,O=this;return(O=n.call(this,e)||this).id=0,O.title=null,O.createdAt=0,O.updatedAt=0,O.closeAt=-1,O.status=vc.CLOSED,O.messageId=0,O.data=null,O.voterCount=-1,O.options=[],O.createdBy=null,O.allowUserSuggestion=!1,O.allowMultipleVotes=!1,O.votedPollOptionIds=[],O.id=(i=r.id)!==null&&i!==void 0?i:0,O.title=(a=r.title)!==null&&a!==void 0?a:null,O.createdAt=(s=r.created_at)!==null&&s!==void 0?s:0,O.updatedAt=(u=r.updated_at)!==null&&u!==void 0?u:0,O.closeAt=(d=r.close_at)!==null&&d!==void 0?d:-1,O.status=(h=ry(r.status))!==null&&h!==void 0?h:vc.CLOSED,O.messageId=(p=r.message_id)!==null&&p!==void 0?p:0,O.data=(g=r.data)!==null&&g!==void 0?g:null,O.voterCount=(E=r.voter_count)!==null&&E!==void 0?E:-1,O.options=r.options?r.options.map(function(N){return new I_(O._iid,N)}):[],O.createdBy=(y=r.created_by)!==null&&y!==void 0?y:null,O.allowUserSuggestion=(C=r.allow_user_suggestion)!==null&&C!==void 0&&C,O.allowMultipleVotes=(T=r.allow_multiple_votes)!==null&&T!==void 0&&T,O.votedPollOptionIds=(A=r.voted_option_ids)!==null&&A!==void 0?A:[],O}return j(t,n),t.prototype._applyPollUpdatePayload=function(e){var r,i,a,s,u,d,h,p,g=this;this.title=(r=e.title)!==null&&r!==void 0?r:this.title,this.updatedAt=(i=e.updated_at)!==null&&i!==void 0?i:this.updatedAt,this.closeAt=(a=e.close_at)!==null&&a!==void 0?a:this.closeAt,this.status=(s=ry(e.status))!==null&&s!==void 0?s:this.status,this.data=(u=e.data)!==null&&u!==void 0?u:this.data,this.voterCount=(d=e.voter_count)!==null&&d!==void 0?d:this.voterCount,e.options&&(this.options=e.options.map(function(E){return new I_(g._iid,E)}),this.votedPollOptionIds=e.options.filter(function(E){return E.vote_count>0}).map(function(E){return E.id})),this.allowUserSuggestion=(h=e.allow_user_suggestion)!==null&&h!==void 0?h:this.allowUserSuggestion,this.allowMultipleVotes=(p=e.allow_multiple_votes)!==null&&p!==void 0?p:this.allowMultipleVotes},t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{id:e.id,title:e.title,created_at:e.createdAt,updated_at:e.updatedAt,close_at:e.closeAt,status:e.status,message_id:e.messageId,data:e.data,voter_count:e.voterCount,options:e.options.map(function(r){return I_.payloadify(r)}),created_by:e.createdBy,allow_user_suggestion:e.allowUserSuggestion,allow_multiple_votes:e.allowMultipleVotes,voted_option_ids:e.votedPollOptionIds})))},t.prototype.applyPollUpdateEvent=function(e){var r=e._payload.poll;return!(!r||this.id!==r.id||r.updated_at<this.updatedAt)&&(this._applyPollUpdatePayload(r),!0)},t.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return!1;var r=this.options,i=r.map(function(u){return u.id}),a=e._payload,s=Math.floor(a.ts/1e3);return a.updated_vote_counts.forEach(function(u){var d=i.indexOf(u.option_id);if(d>-1){var h=r[d];s>=h._lastVotedAt&&(h.voteCount=u.vote_count,h._lastVotedAt=s)}}),a.req_id&&a.voted_option_ids&&(this.votedPollOptionIds=a.voted_option_ids),typeof a.voter_count=="number"&&(this.voterCount=a.voter_count),!0},t.prototype.serialize=function(){return Nc(this)},t}(Zr),Vu=function(){function n(t,e){var r;this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=t,this.limit=(r=e.limit)!==null&&r!==void 0?r:20}return Object.defineProperty(n.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),n.prototype._validate=function(){return J("number",this.limit)&&this.limit>0},n}(),cu=function(n){function t(e,r,i,a){var s=n.call(this,e,a)||this;return s.channelUrl=r,s.channelType=i,s}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("string",this.channelUrl)&&nt(vt,this.channelType)},t}(Vu),m7=function(n){this.pollId=0,this.messageId=0,this.pollId=n.poll_id,this.messageId=n.message_id,this._payload=n},g7=function(n){function t(e){var r=e.title,i=e.optionTexts,a=e.data,s=e.allowUserSuggestion,u=e.allowMultipleVotes,d=e.closeAt,h=n.call(this)||this;return h.method=Ie.POST,h.path=ks,h.params={title:r,options:i,data:a,allow_user_suggestion:s,allow_multiple_votes:u,close_at:d},h}return j(t,n),t}(Te),v7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new ds(e,r),i}return j(t,n),t}(Me),E7=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.pollId,s=n.call(this)||this;return s.method=Ie.GET,s.path="".concat(ks,"/").concat(encodeURIComponent(a)),s.params={channel_url:r,channel_type:i},s}return j(t,n),t}(Te),y7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new ds(e,r),i}return j(t,n),t}(Me),b7=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.pollId,s=e.pollOptionId,u=n.call(this)||this;return u.method=Ie.GET,u.path="".concat(ks,"/").concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(s)),u.params={channel_url:r,channel_type:i},u}return j(t,n),t}(Te),C7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pollOption=new I_(e,r),i}return j(t,n),t}(Me),I7=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.timestamp,s=e.token,u=n.call(this)||this;return u.method=Ie.GET,u.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/polls/changelogs"),u.params=ze({change_ts:a,token:s}),u}return j(t,n),t}(Te),T7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.updatedPolls=r.updated.map(function(a){return function(s,u){return new ds(s,u)}(e,a)}),i.deletedPollIds=r.deleted.map(function(a){return a}),i.hasMore=r.has_more,i.nextToken=r.next,i}return j(t,n),t}(Me),S7={title:"",optionTexts:[],data:void 0,allowUserSuggestion:void 0,allowMultipleVotes:void 0,closeAt:-1},tM=function(n){return J("string",n.title)&&(t=n.optionTexts,tt("string",t)&&t.every(function(e){return e.trim()!==""}))&&nM(n.data)&&J("boolean",n.allowUserSuggestion,!0)&&J("boolean",n.allowMultipleVotes,!0)&&J("number",n.closeAt,!0);var t},N7={channelUrl:"",channelType:vt.BASE,pollId:0,pollOptionId:0},rM=function(n){return J("string",n.channelUrl)&&n.channelUrl!==""&&nt(vt,n.channelType)&&J("number",n.pollId)&&n.pollId>0&&J("number",n.pollOptionId)&&n.pollOptionId>0},A7={channelUrl:"",channelType:vt.BASE,pollId:0},iM=function(n){return J("string",n.channelUrl)&&n.channelUrl!==""&&nt(vt,n.channelType)&&J("number",n.pollId)},d1={},Q_=function(){function n(t,e){var r=e.sdkState,i=e.dispatcher,a=e.sessionManager,s=e.requestQueue,u=e.logger;this._iid=t,this._sdkState=r,this._sessionManager=a,this._requestQueue=s,this._dispatcher=i,this._logger=u,d1[t]=this}return n.of=function(t){return d1[t]},n.prototype.buildPollFromSerializedData=function(t){var e=ko(t);return new ds(this._iid,ds.payloadify(e))},n.prototype.get=function(t){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return Se(iM(t)).throw(ee.invalidParameters),e=new E7(W({},t)),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(y7).poll]}})})},n.prototype.create=function(t){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return Se(tM(t)).throw(ee.invalidParameters),e=new g7(W({},t)),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(v7).poll]}})})},n.prototype.getOption=function(t){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return Se(rM(t)).throw(ee.invalidParameters),e=new b7(W({},t)),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(C7).pollOption]}})})},n.prototype.getPollChangeLogs=function(t,e,r,i){return i===void 0&&(i=ge.SYNC_POLL_CHANGELOGS),M(this,void 0,void 0,function(){var a,s,u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:return a=new I7(_n({channelType:e,channelUrl:t,timestamp:typeof r=="number"?r:null,token:typeof r=="string"?r:null})),[4,this._requestQueue.send(a)];case 1:return s=E.sent(),u=s.as(T7),d=u.updatedPolls,h=u.deletedPollIds,p=u.hasMore,g=u.nextToken,d.length>0&&this._dispatcher.dispatch(new J2({polls:d,source:i})),[2,{updatedPolls:d,deletedPollIds:h,hasMore:p,token:g}]}})})},n}(),w7=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.token,s=e.limit,u=n.call(this)||this;return u.method=Ie.GET,u.path=ks,u.params={channel_url:r,channel_type:i,token:a,limit:s},u}return j(t,n),t}(Te),R7=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).polls=((i=r.polls)!==null&&i!==void 0?i:[]).map(function(s){return new ds(e,s)}),a.token=r.next,a}return j(t,n),t}(Me),aM=function(n){function t(e,r){return n.call(this,e,r.channelUrl,r.channelType,r)||this}return j(t,n),t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new w7(W(W({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(R7),s=a.polls,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),M7=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.pollId,s=e.pollOptionId,u=e.token,d=e.limit,h=n.call(this)||this;return h.method=Ie.GET,h.path="".concat(ks,"/").concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(s),"/voters"),h.params={channel_url:r,channel_type:i,token:u,limit:d},h}return j(t,n),t}(Te),O7=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).voters=((i=r.voters)!==null&&i!==void 0?i:[]).map(function(s){return new _t(e,s)}),a.token=r.next,a}return j(t,n),t}(Me),sM=function(n){function t(e,r){var i=n.call(this,e,r.channelUrl,r.channelType,r)||this;return i.pollId=r.pollId,i.pollOptionId=r.pollOptionId,i}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("number",this.pollId)&&J("number",this.pollOptionId)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new M7(W(W({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(O7),s=a.voters,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),Zl,ju=function(){function n(t,e,r){var i,a;this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this._requireAuth=!1,this._iid=t,this.plainUrl=e.url,this.width=e.width,this.height=e.height,this.realWidth=(i=e.real_width)!==null&&i!==void 0?i:e.width,this.realHeight=(a=e.real_height)!==null&&a!==void 0?a:e.height,this._requireAuth=r}return n.payloadify=function(t){return ze(_n(t instanceof n?{url:t.plainUrl,width:t.width,height:t.height,real_width:t.realWidth,real_height:t.realHeight}:{url:"",width:t.maxWidth,height:t.maxHeight,real_width:0,real_height:0}))},Object.defineProperty(n.prototype,"url",{get:function(){var t=X.of(this._iid).sessionManager;return this._requireAuth&&t.ekey?"".concat(this.plainUrl,"?auth=").concat(t.ekey):this.plainUrl},enumerable:!1,configurable:!0}),n}(),Z_=function(n){function t(e){var r=n.call(this)||this;if(r.method=Ie.POST,r.path="".concat(T5),r.params=ze({file:e.file,channel_url:e.channelUrl}),e.thumbnailSizes)for(var i=0;i<e.thumbnailSizes.length;i++){var a=e.thumbnailSizes[i],s=a.maxWidth,u=a.maxHeight;r.params["thumbnail".concat(i+1)]="".concat(s,",").concat(u)}return r.requestId=e.requestId,r}return j(t,n),t}(Te),X_=function(n){function t(e,r){var i,a,s,u,d=this;return(d=n.call(this,e,r)||this).url=r.url,d.fileSize=(i=r.file_size)!==null&&i!==void 0?i:0,d.thumbnails=(s=(a=r.thumbnails)===null||a===void 0?void 0:a.map(function(h){return new ju(e,h,!1)}))!==null&&s!==void 0?s:[],d.requireAuth=(u=r.require_auth)!==null&&u!==void 0&&u,d}return j(t,n),t}(Me),J_=function(n){function t(e,r){var i,a,s,u,d,h=this;return(h=n.call(this,e)||this).replyCount=0,h.memberCount=0,h.lastRepliedAt=0,h.updatedAt=0,h.replyCount=(i=r.reply_count)!==null&&i!==void 0?i:0,h.memberCount=(a=r.member_count)!==null&&a!==void 0?a:0,h.mostRepliedUsers=r.most_replies&&tt("object",r.most_replies)?r.most_replies.map(function(p){return new _t(h._iid,p)}):[],h.unreadReplyCount=(s=r.unread_message_count)!==null&&s!==void 0?s:0,h.isPushNotificationEnabled=typeof r.push_enabled=="number"?r.push_enabled>0:void 0,h.lastRepliedAt=(u=r.last_replied_at)!==null&&u!==void 0?u:0,h.updatedAt=(d=r.updated_at)!==null&&d!==void 0?d:0,h}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{reply_count:e.replyCount,unread_message_count:e.unreadReplyCount,member_count:e.memberCount,most_replies:Array.isArray(e.mostRepliedUsers)?e.mostRepliedUsers.map(function(r){return _t.payloadify(r)}):[],push_enabled:typeof e.isPushNotificationEnabled=="boolean"?e.isPushNotificationEnabled?1:0:void 0,last_replied_at:e.lastRepliedAt,updated_at:e.updatedAt})))},Object.defineProperty(t.prototype,"_isUpdateRequired",{get:function(){return this.unreadReplyCount===void 0||this.isPushNotificationEnabled===void 0},enumerable:!1,configurable:!0}),t.prototype._updateFrom=function(e){var r,i;this.unreadReplyCount=(r=e.unreadReplyCount)!==null&&r!==void 0?r:this.unreadReplyCount,this.isPushNotificationEnabled=(i=e.isPushNotificationEnabled)!==null&&i!==void 0?i:this.isPushNotificationEnabled},t}(Zr);(function(n){n.ADD="add",n.DELETE="delete"})(Zl||(Zl={}));var yo,aC=function(n){var t;this.messageId=0,this.operation=null,this.updatedAt=0;var e=J("string",n.msg_id)?parseInt(n.msg_id):n.msg_id,r=n.user_id,i=n.operation?n.operation.toLowerCase():null,a=n.reaction,s=n.updated_at,u=n.count,d=n.sampled_user_ids,h=(t=n.sampled_user_info)!==null&&t!==void 0?t:{};e&&J("string",r)&&J("string",i)&&nt(Zl,i)&&J("string",a)&&a&&J("number",s)&&(this.messageId=e,this.userId=r,this.key=a,this.operation=i,this.updatedAt=s,this._count=u,this._sampledUserIds=d,this._sampledUserInfoList=h)},hE=function(n){function t(e,r,i){var a,s=this;return(s=n.call(this,e)||this).userId=r,s.nickname=i.nickname,s.plainProfileUrl=i.profile_url,s.requireAuth=(a=i.require_auth_for_profile_image)!==null&&a!==void 0&&a,s}return j(t,n),Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=X.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.payloadify=function(e){return{nickname:e.nickname,profile_url:e.plainProfileUrl,require_auth_for_profile_image:e.requireAuth}},t}(Zr),Sf=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y=this;(y=n.call(this,e)||this)._sampledUserInfoList=[],y._count=0,y._hasCurrentUserReacted=!1;var C=r.key,T=Nn([],cn((u=(s=r.sampled_user_ids)!==null&&s!==void 0?s:r.user_ids)!==null&&u!==void 0?u:[]),!1),A=(h=(d=r.last_ts)!==null&&d!==void 0?d:r.updated_at)!==null&&h!==void 0?h:0,O=(p=r.is_self_included)!==null&&p!==void 0?p:T.includes(X.of(e).sdkState.userId),N=(g=r.sampled_user_info)!==null&&g!==void 0?g:{};J("string",C)&&C&&tt("string",T)&&T.length>0&&J("number",A)&&(y.key=C,y._sampledUserIds=T,y._updatedAt=A,y._count=(E=r.count)!==null&&E!==void 0?E:T.length,y._hasCurrentUserReacted=O,Object.keys(N).forEach(function(U){y._sampledUserInfoList.push(new hE(e,U,N[U]))}));var k={};try{for(var D=Le(y.sampledUserIds),P=D.next();!P.done;P=D.next())k[P.value]=y.updatedAt}catch(U){i={error:U}}finally{try{P&&!P.done&&(a=D.return)&&a.call(D)}finally{if(i)throw i.error}}return y._version=k,y}return j(t,n),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return this._count===0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userIds",{get:function(){return this._sampledUserIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sampledUserIds",{get:function(){return this._sampledUserIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sampledUserInfoList",{get:function(){return this._sampledUserInfoList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updatedAt",{get:function(){return this._updatedAt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCurrentUserReacted",{get:function(){return this._hasCurrentUserReacted},enumerable:!1,configurable:!0}),t.payloadify=function(e){var r={};return e._sampledUserInfoList.forEach(function(i){r[i.userId]=hE.payloadify(i)}),ze(_n({key:e.key,sampled_user_ids:e._sampledUserIds,sampled_user_info:r,count:e._count,is_self_included:e._hasCurrentUserReacted,last_ts:e._updatedAt}))},t.prototype.applyEvent=function(e){var r=this;if(e.key===this.key&&this.updatedAt<=e.updatedAt)if(e._sampledUserIds)this._sampledUserIds=e._sampledUserIds,this._sampledUserInfoList=[],Object.keys(e._sampledUserInfoList).forEach(function(a){r._sampledUserInfoList.push(new hE(r._iid,a,e._sampledUserInfoList[a]))}),this._count=e._count,e._hasCurrentUserReacted!==void 0&&(this._hasCurrentUserReacted=e._hasCurrentUserReacted),this._updatedAt=e.updatedAt;else{if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var i=this._sampledUserIds.indexOf(e.userId);switch(e.operation){case Zl.ADD:i<0&&this._sampledUserIds.push(e.userId);break;case Zl.DELETE:i>=0&&this._sampledUserIds.splice(i,1)}this._count=this._sampledUserIds.length,this._version[e.userId]=e.updatedAt}this._updatedAt=Math.max(this.updatedAt,e.updatedAt)}},t}(Zr),c1=function(){function n(t){this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=t.url,t.secure_url&&(this.secureUrl=t.secure_url),t.type&&(this.type=t.type),t.width&&(this.width=t.width),t.height&&(this.height=t.height),t.alt&&(this.alt=t.alt)}return n.payloadify=function(t){var e,r;return ze(_n({url:t.url,secure_url:t.secureUrl,type:t.type,width:(e=t.width)!==null&&e!==void 0?e:0,height:(r=t.height)!==null&&r!==void 0?r:0,alt:t.alt}))},n}(),f1=function(){function n(t){this.title=null,this.url=null,this.description=null,this.defaultImage=null,t["og:title"]&&(this.title=t["og:title"]),t["og:url"]&&(this.url=t["og:url"]),t["og:description"]&&(this.description=t["og:description"]),t["og:image"]&&(this.defaultImage=new c1(t["og:image"]))}return n.payloadify=function(t){return ze(_n({"og:title":t.title,"og:url":t.url,"og:description":t.description,"og:image":t.defaultImage?c1.payloadify(t.defaultImage):null}))},n}(),cs=function(){function n(t){var e,r;this.volume=0,this.name=(e=t.name)!==null&&e!==void 0?e:"default",this.volume=(r=t.volume)!==null&&r!==void 0?r:1}return n.prototype.serialize=function(){return{name:this.name,volume:this.volume}},n.payloadify=function(t){return ze(_n({name:t.name,volume:t.volume}))},n}();(function(n){n.GOOD="good",n.BAD="bad"})(yo||(yo={}));var Lu=function(){function n(t){this.id=t.id,this.rating=t.rating,this.comment=t.comment}return n._getStatus=function(t){return t?"id"in t?"SUBMITTED":"NO_FEEDBACK":"NOT_APPLICABLE"},n._isSubmitted=function(t){return n._getStatus(t)==="SUBMITTED"},n._getPayloadByStatus=function(t){return t==="NO_FEEDBACK"?{}:null},n.payloadify=function(t){return ze(_n({id:t.id,rating:t.rating,comment:t.comment}))},n}(),Ec=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).isBlockedByMe=!1,a.role=nt(Ka,r.role)?r.role:Ka.NONE,a.isBlockedByMe=(i=r.is_blocked_by_me)!==null&&i!==void 0&&i,a}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{role:e.role,is_blocked_by_me:e.isBlockedByMe})))},t}(_t),Vi=function(){function n(t){this.key=t.key,this.value=tt("string",t.value)?Nn([],cn(t.value),!1):[]}return n.payloadify=function(t){var e;return ze(_n({key:t.key,value:(e=t.value)!==null&&e!==void 0?e:[]}))},n}(),uM=function(n){switch(n){case Rr.BASE:return"";case Rr.USER:return"MESG";case Rr.FILE:return"FILE";case Rr.ADMIN:return"ADMM"}},oM=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y=this;(y=n.call(this,e)||this).channelType=vt.BASE,y.messageType=Rr.BASE,y.mentionType=null,y.mentionedUsers=null,y.mentionedUserIds=null,y.metaArrays=[],y.extendedMessage={},y.createdAt=0,y.updatedAt=0,y.channelUrl=r.channel_url,y.channelType=nt(vt,r.channel_type)?r.channel_type:vt.GROUP,r.channel&&(r.channel.channel_url&&(y.channelUrl=r.channel.channel_url),r.channel.channel_type&&(y.channelType=r.channel.channel_type)),y.data=(i=r.data)!==null&&i!==void 0?i:"",y.customType=(a=r.custom_type)!==null&&a!==void 0?a:"",y.mentionType=nt(wi,r.mention_type)?r.mention_type:null,y.mentionedUsers=r.mentioned_users?r.mentioned_users.map(function(N){return new _t(y._iid,N)}):null,y.mentionedUserIds=(s=r.mentioned_user_ids)!==null&&s!==void 0?s:null,y.mentionedUsers&&!y.mentionedUserIds&&(y.mentionedUserIds=y.mentionedUsers.map(function(N){return N.userId}));var C=(u=r.metaarray)!==null&&u!==void 0?u:{},T=(d=r.metaarray_key_order)!==null&&d!==void 0?d:Object.keys(C).sort(function(N,k){return N.localeCompare(k)});y.metaArrays=[];for(var A=0;A<T.length;A++){var O=T[A];y.metaArrays.push(new Vi({key:O,value:C[O]||[]}))}return r.sorted_metaarray&&(y.metaArrays=r.sorted_metaarray.map(function(N){return new Vi(N)})),y.extendedMessage=(h=r.extended_message)!==null&&h!==void 0?h:{},y.extendedMessagePayload=r.extended_message_payload,y.createdAt=(g=(p=r.created_at)!==null&&p!==void 0?p:r.ts)!==null&&g!==void 0?g:0,y.updatedAt=(E=r.updated_at)!==null&&E!==void 0?E:0,y}return j(t,n),t.payloadify=function(e){var r,i;return ze(_n(W(W({},n.payloadify.call(this,e)),{channel_url:e.channelUrl,channel_type:e.channelType,type:uM(e.messageType),data:e.data,custom_type:e.customType,mention_type:e.mentionType,mentioned_user_ids:e.mentionedUserIds,mentioned_users:(r=e.mentionedUsers)===null||r===void 0?void 0:r.map(function(a){return _t.payloadify(a)}),sorted_metaarray:(i=e.metaArrays)===null||i===void 0?void 0:i.map(function(a){return Vi.payloadify(a)}),extended_message:e.extendedMessage,extended_message_payload:e.extendedMessagePayload,created_at:e.createdAt,updated_at:e.updatedAt})))},t.prototype.isIdentical=function(e){return!0},t.prototype.isEqual=function(e){return u2(this,e)},t.prototype.isUserMessage=function(){return this.messageType===Rr.USER},t.prototype.isFileMessage=function(){return this.messageType===Rr.FILE&&!Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isMultipleFilesMessage=function(){return this.messageType===Rr.FILE&&Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isAdminMessage=function(){return this.messageType===Rr.ADMIN},t.prototype.serialize=function(){return Nc(this)},t.prototype.getMetaArraysByKeys=function(e){return this.metaArrays.filter(function(r){return e.includes(r.key)})},t}(Zr),lM=function(n){function t(e,r){var i,a,s=this;return(s=n.call(this,e)||this).channelUrl=(i=r.channel_url)!==null&&i!==void 0?i:"",s.channelType=(a=r.channel_type)!==null&&a!==void 0?a:vt.GROUP,s.reader=new _t(s._iid,r.user),s.readAt=r.ts,s}return j(t,n),t}(Zr),k7=function(n){function t(e){var r=e.channelUrl;return n.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:r}})||this}return j(t,n),t}(Ai);(function(n){function t(e){var r=n.call(this)||this,i=e.channelUrl,a=e.channelType,s=e.userId,u=e.notificationIds;return r.method=Ie.PUT,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/messages/mark_as_read"),r.params=ze(_n({user_id:s,message_ids:u})),r}return j(t,n),t})(Te);var dM=function(n){function t(e,r,i){var a=n.call(this,e,"READ",i)||this;return a.readStatus=new lM(e,i),a}return j(t,n),t}(dr);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.readAt=r.ts,i.unreadMessageCount=r.unread_message_count,i}return j(t,n),t})(Me);var D7=function(n){function t(e){var r=e.channelUrl,i=e.messageId;return n.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:r,parent_message_id:i}})||this}return j(t,n),t}(Ai),L7=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.pushEnabled,u=n.call(this)||this;return u.method=Ie.PUT,u.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/thread_push"),u.params={push_enabled:s},u}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var x7=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.rating,u=e.comment,d=n.call(this)||this;return d.method=Ie.POST,d.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks"),d.params={rating:s,comment:u},d}return j(t,n),t}(Te),U7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.feedback=new Lu(r),i}return j(t,n),t}(Me),P7=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.feedbackId,u=e.rating,d=e.comment,h=n.call(this)||this;return h.method=Ie.PUT,h.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks/").concat(s),h.params={rating:u,comment:d},h}return j(t,n),t}(Te),F7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.feedback=new Lu(r),i}return j(t,n),t}(Me),H7=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.feedbackId,u=n.call(this)||this;return u.method=Ie.DELETE,u.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks/").concat(s),u}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.feedback=new Lu(r),i}j(t,n)})(Me);var Ol,h1,iy=function(n){function t(e,r){var i,a,s,u,d,h=this;return(h=n.call(this,e)||this).plainUrl="",h.fileName=null,h.mimeType=null,h.fileSize=0,h.thumbnails=[],h._requireAuth=!1,h.plainUrl=(i=r.url)!==null&&i!==void 0?i:"",h.fileName=(a=r.file_name)!==null&&a!==void 0?a:null,h.mimeType=(s=r.file_type)!==null&&s!==void 0?s:null,h.fileSize=(u=r.file_size)!==null&&u!==void 0?u:0,h._requireAuth=(d=r.require_auth)!==null&&d!==void 0&&d,h.thumbnails=r.thumbnails?r.thumbnails.map(function(p){var g;return new ju(h._iid,typeof p=="string"?{url:p,width:0,height:0}:W(W({},p),{url:((g=p.url)!==null&&g!==void 0?g:"").split("auth=")[0]}),h._requireAuth)}):[],h}return j(t,n),t.payloadify=function(e){var r;return ze(_n({url:e.plainUrl,file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:(r=e.thumbnails)===null||r===void 0?void 0:r.map(function(i){var a;return{url:((a=i.plainUrl)!==null&&a!==void 0?a:"").split("auth=")[0],width:i.width,height:i.height,real_width:i.realWidth,real_height:i.realHeight}}),require_auth:e._requireAuth}))},Object.defineProperty(t.prototype,"url",{get:function(){var e=X.of(this._iid).sessionManager;return this._requireAuth&&e.ekey?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t}(Zr),cM=function(n){var t=n.channelUrl,e=n.channelType,r=n.parentMessage;this.channelUrl=t,this.channelType=e,this.parentMessage=r};(function(n){n.NUMBER="number",n.ENUM="enum",n.TEXT="text",n.REGEX="regex",n.DECIMAL_PLACE="decimal_place"})(Ol||(Ol={})),function(n){n.TEXT="text",n.TEXTAREA="textarea",n.NUMBER="number",n.PHONE="phone",n.EMAIL="email",n.CHIP="chip"}(h1||(h1={}));var To,ja,p1=function(){function n(t,e){var r=e.id,i=e.name,a=e.items,s=e.version,u=e.is_submitted;this.messageId=t,this.id=r,this.name=i,this.items=a.map(function(d){return new _1(d)}).sort(function(d,h){return d.sortOrder-h.sortOrder}),this.version=s??1,this._isSubmitted=u}return Object.defineProperty(n.prototype,"isSubmitted",{get:function(){var t;return(t=this._isSubmitted)!==null&&t!==void 0?t:this.items.some(function(e){return Array.isArray(e.submittedValues)})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSubmittable",{get:function(){return this.items.every(function(t){return t.required?!!(Array.isArray(t.draftValues)&&t.draftValues.length>0)&&t.isValid(t.draftValues):!(Array.isArray(t.draftValues)&&t.draftValues.length>0)||t.isValid(t.draftValues)})},enumerable:!1,configurable:!0}),n.payloadify=function(t){return ze(_n({id:t.id,name:t.name,items:t.items.map(function(e){return _1.payloadify(e)}),version:t.version,is_submitted:t._isSubmitted}))},n.isMessageFormPayload=function(t){return!!(t!=null&&t.message_form)},n}(),_1=function(){function n(t){var e=t.id,r=t.name,i=t.required,a=t.sort_order,s=t.placeholder,u=t.style,d=t.item_type,h=t.validators,p=t.value,g=t.values;this.id=e,this.name=r,this.required=i,this.sortOrder=a,this.placeholder=s,Object.keys(u).length===0?this.style={layout:d}:this.style=ze({layout:u.layout,options:u.options,defaultOptions:u.default_options,resultCount:u.result_count}),g?this.submittedValues=g:p&&(this.submittedValues=[p]),this._validators=h}return n.prototype.isValid=function(t){var e=this;return t.every(function(r){var i=function(a,s){return s.every(function(u){switch(u.key){case Ol.NUMBER:var d=Number(a);return!(isNaN(d)||u.min&&typeof u.min!="number"||u.max&&typeof u.max!="number"||typeof u.min=="number"&&d<u.min||typeof u.max=="number"&&d>u.max);case Ol.ENUM:return typeof a=="string"&&(!(u.enums&&Array.isArray(u.enums)&&u.enums.length>0&&!u.enums.includes(a))||u.allow_other);case Ol.TEXT:return!(typeof a!="string"||typeof u.min_length=="number"&&a.length<u.min_length||typeof u.max_length=="number"&&a.length>u.max_length);case Ol.REGEX:return!(typeof a!="string"||u.regex&&(typeof u.regex!="string"||!new RegExp(u.regex).test(a)));case Ol.DECIMAL_PLACE:return a.length!==0&&(d=Number(a),!(isNaN(d)||(!u.max_decimal_place||typeof u.max_decimal_place=="number")&&u.max_decimal_place&&!function(h,p){var g=h.toString(),E=g.indexOf(".");return E===-1||g.slice(E+1).length<=p}(d,u.max_decimal_place)));default:return!0}})}(r,e._validators);return i})},n.payloadify=function(t){return ze(_n({id:t.id,name:t.name,required:t.required,sort_order:t.sortOrder,placeholder:t.placeholder,style:ze({layout:t.style.layout,options:t.style.options,default_options:t.style.defaultOptions,result_count:t.style.resultCount}),item_type:t.style.layout,validators:t._validators,values:t.submittedValues}))},n}(),B7=function(n){function t(e){var r=n.call(this)||this;return r.method=Ie.POST,r.path="".concat(D5,"/").concat(e.formId,"/submit"),r.params=ze({message_id:e.messageId,items:e.items}),r}return j(t,n),t}(Te);(function(n){n.PENDING="pending",n.SENT="sent",n.FAILED="failed",n.CANCELED="canceled"})(To||(To={})),function(n){n.PENDING="pending",n.IN_QUEUE="in_queue",n.SENT="sent",n.FAILED="failed",n.CANCELED="canceled",n.REMOVED="removed"}(ja||(ja={}));var Vl,Hi=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y=this;return(y=n.call(this,e,r)||this).parentMessage=null,y.silent=!1,y.isOperatorMessage=!1,y.threadInfo=null,y.reactions=[],y.appleCriticalAlertOptions=null,y.scheduledInfo=null,y.suggestedReplies=null,y.myFeedback=null,y.myFeedbackStatus="NOT_APPLICABLE",y.messageForm=null,y._isContinuousMessages=!1,y._scheduledStatus=null,y._poll=null,y.messageId=(a=(i=r.msg_id)!==null&&i!==void 0?i:r.message_id)!==null&&a!==void 0?a:0,y.parentMessageId=(s=typeof r.parent_message_id=="string"?parseInt(r.parent_message_id):r.parent_message_id)!==null&&s!==void 0?s:0,y.threadInfo=r.thread_info?new J_(y._iid,r.thread_info):null,r.reactions_summary?y.reactions=r.reactions_summary.map(function(C){return new Sf(e,C)}):r.reactions?y.reactions=r.reactions.map(function(C){return new Sf(e,C)}):y.reactions=[],y.ogMetaData=r.og_tag?new f1(r.og_tag):null,y.silent=(u=r.silent)!==null&&u!==void 0&&u,y.isOperatorMessage=(d=r.is_op_msg)!==null&&d!==void 0&&d,y.appleCriticalAlertOptions=r.apple_critical_alert_options?new cs(r.apple_critical_alert_options):null,typeof r.scheduled_message_id=="number"&&typeof r.scheduled_at=="number"&&r.scheduled_status&&(y.scheduledInfo={scheduledMessageId:r.scheduled_message_id,scheduledAt:r.scheduled_at},y._scheduledStatus=r.scheduled_status),y._isContinuousMessages=(h=r.is_continuous_messages)!==null&&h!==void 0&&h,y.myFeedback=Lu._isSubmitted(r.feedback)?new Lu(r.feedback):null,y.myFeedbackStatus=Lu._getStatus(r.feedback),y.suggestedReplies=(g=(p=r.extended_message_payload)===null||p===void 0?void 0:p.suggested_replies)!==null&&g!==void 0?g:null,y.messageForm=p1.isMessageFormPayload(r.extended_message_payload)?new p1(y.messageId,r.extended_message_payload.message_form):null,y.message=(E=r.message)!==null&&E!==void 0?E:"",y._poll=r.poll?new ds(y._iid,r.poll):null,y}return j(t,n),t.payloadify=function(e){var r,i;return ze(_n(W(W({},n.payloadify.call(this,e)),{message_id:e.messageId,parent_message_id:e.parentMessageId,thread_info:e.threadInfo?J_.payloadify(e.threadInfo):null,reactions_summary:e.reactions.map(function(a){return Sf.payloadify(a)}),og_tag:e.ogMetaData?f1.payloadify(e.ogMetaData):null,silent:e.silent,is_op_msg:e.isOperatorMessage,apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,scheduled_message_id:(r=e.scheduledInfo)===null||r===void 0?void 0:r.scheduledMessageId,scheduled_at:(i=e.scheduledInfo)===null||i===void 0?void 0:i.scheduledAt,scheduled_status:e._scheduledStatus,feedback:e.myFeedback?Lu.payloadify(e.myFeedback):Lu._getPayloadByStatus(e.myFeedbackStatus),message:e.message,poll:e._poll?ds.payloadify(e._poll):null})))},t._getParentMessageInfoPayload=function(e){return ze(_n({type:uM(e.messageType),ts:e.createdAt,user:e.sender?Ec.payloadify(e.sender):null,message:e.message,file:{url:e.plainUrl,name:e.name,type:e.type,require_auth:e.requireAuth},files:Array.isArray(e.fileInfoList)?e.fileInfoList.map(function(r){return iy.payloadify(r)}):null}))},t.prototype.isIdentical=function(e){return this.messageId===e.messageId},t.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(e.threadInfo._isUpdateRequired&&this.threadInfo&&e.threadInfo._updateFrom(this.threadInfo),this.threadInfo=e.threadInfo,!0)},t.prototype._findReactionIndex=function(e){for(var r=0;r<this.reactions.length;r++)if(this.reactions[r].key===e)return r;return-1},t.prototype.applyReactionEvent=function(e){var r=X.of(this._iid).sdkState;if(this.messageId===e.messageId)switch(e.operation){case Zl.ADD:e.userId===r.userId&&(e._hasCurrentUserReacted=!0),(i=this._findReactionIndex(e.key))!==-1?this.reactions[i].applyEvent(e):e._sampledUserIds?this.reactions.push(new Sf(this._iid,{key:e.key,sampled_user_ids:e._sampledUserIds,sampled_user_info:e._sampledUserInfoList,count:e._count,is_self_included:e._hasCurrentUserReacted,last_ts:e.updatedAt})):this.reactions.push(new Sf(this._iid,{key:e.key,user_ids:[e.userId],updated_at:e.updatedAt}));break;case Zl.DELETE:var i;(i=this._findReactionIndex(e.key))!==-1&&(e._sampledUserIds?e._count===0?this.reactions.splice(i,1):(e.userId===r.userId&&(e._hasCurrentUserReacted=!1),this.reactions[i].applyEvent(e)):(this.reactions[i].applyEvent(e),this.reactions[i].isEmpty&&this.reactions.splice(i,1)))}},t.prototype.applyParentMessage=function(e){if(!this.parentMessage)return this.parentMessage=e,!0;if(this.parentMessageId===e.messageId){var r=this.parentMessage.updatedAt;if(e.updatedAt>=r)return this.parentMessage=e,!0}return!1},t.prototype.applyPoll=function(e){return!(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt)&&(this._poll=e,!0)},Object.defineProperty(t.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),t.prototype._triggerThreadInfoUpdatedEvent=function(){return M(this,void 0,void 0,function(){var e;return R(this,function(r){return(e=X.of(this._iid).dispatcher).dispatch(new cM({channelType:vt.GROUP,channelUrl:this.channelUrl,parentMessage:this})),e.dispatch(new mr({messages:[this],source:ge.EVENT_MESSAGE_THREADINFO_UPDATED})),[2]})})},t.prototype.markThreadAsRead=function(){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=X.of(this._iid).requestQueue,r=new D7({channelUrl:this.channelUrl,messageId:this.messageId}),[4,e.send(r)];case 1:return i.sent(),this.threadInfo&&this.threadInfo.unreadReplyCount!==0?(this.threadInfo.unreadReplyCount=0,[4,this._triggerThreadInfoUpdatedEvent()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.setPushNotificationEnabled=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return r=X.of(this._iid).requestQueue,i=new L7({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,pushEnabled:e}),[4,r.send(i)];case 1:return a.sent(),this.threadInfo&&this.threadInfo.isPushNotificationEnabled!==e&&(this.threadInfo.isPushNotificationEnabled=e),[2]}})})},t.prototype.submitMessageForm=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:if(r=X.of(this._iid).requestQueue,i=null,a=null,s=this.messageForm,!e&&s){if(!s.isSubmittable)throw new ee({code:rn.INVALID_PARAMETER,message:"The form is not submittable. Please check all form items are valid before submitting."});if(s.isSubmitted)throw new ee({code:rn.INVALID_PARAMETER,message:"The form has already been submitted."});i=s.id,a=s.items.reduce(function(h,p){return h.push({form_item_id:p.id,values:Array.isArray(p.draftValues)?p.draftValues:[]}),h},[])}else e&&(i=e.formId,a=Object.entries(e.answers).reduce(function(h,p){var g=cn(p,2),E=g[0],y=g[1],C=Number(E);if(Number.isNaN(C))throw new ee({code:rn.INVALID_PARAMETER,message:"Keys in answers must be numeric string."});return h.push({form_item_id:C,value:y}),h},[]));if(!i||!a)throw new ee({code:rn.INVALID_PARAMETER,message:"Missing one or more required inputs: formId, answers."});return u=new B7({messageId:this.messageId,formId:i,items:a}),[4,r.send(u)];case 1:return d.sent(),[2]}})})},t.prototype.submitFeedback=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return r=X.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new x7({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,rating:e.rating,comment:e.comment}),[4,i.send(s)];case 1:return u=h.sent(),d=u.as(U7),this.myFeedback=d.feedback,this.myFeedbackStatus="SUBMITTED",a.dispatch(new mr({messages:[this],source:ge.EVENT_MESSAGE_FEEDBACK_ADDED})),[2]}})})},t.prototype.updateFeedback=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return r=X.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new P7({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:e.id,rating:e.rating,comment:e.comment}),[4,i.send(s)];case 1:return u=h.sent(),d=u.as(F7),this.myFeedback=d.feedback,this.myFeedbackStatus="SUBMITTED",a.dispatch(new mr({messages:[this],source:ge.EVENT_MESSAGE_FEEDBACK_UPDATED})),[2]}})})},t.prototype.deleteFeedback=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return r=X.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new H7({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:e}),[4,i.send(s)];case 1:return u.sent(),this.myFeedback=null,this.myFeedbackStatus="NO_FEEDBACK",a.dispatch(new mr({messages:[this],source:ge.EVENT_MESSAGE_FEEDBACK_DELETED})),[2]}})})},t}(oM),Lr=function(n){function t(e,r){var i,a,s,u,d=this;if((d=n.call(this,e,r)||this).reqId="",d.replyToChannel=!1,d.errorCode=0,d.sender=r.user?new Ec(d._iid,r.user):r.sender_id,d.reqId=(a=(i=r.req_id)!==null&&i!==void 0?i:r.request_id)!==null&&a!==void 0?a:"",d.replyToChannel=(s=r.is_reply_to_channel)!==null&&s!==void 0&&s,r.request_state&&nt(jt,r.request_state)&&(d.sendingStatus=r.request_state),!d.sendingStatus)if(d.messageId>0)d.sendingStatus=jt.SUCCEEDED;else if(d.scheduledInfo)switch(r.scheduled_status&&(d._scheduledStatus=r.scheduled_status),r.scheduled_status){case ja.SENT:case ja.IN_QUEUE:d.sendingStatus=jt.SUCCEEDED;break;case ja.PENDING:d.sendingStatus=jt.SCHEDULED;break;case ja.FAILED:case ja.REMOVED:d.sendingStatus=jt.FAILED;break;case ja.CANCELED:d.sendingStatus=jt.CANCELED}else d.sendingStatus=jt.PENDING;return d.errorCode=(u=r.error_code)!==null&&u!==void 0?u:0,d._messageToken=r.mesg_token,d}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{user:Ec.payloadify(e.sender),req_id:e.reqId,is_reply_to_channel:e.replyToChannel,request_state:e.sendingStatus,error_code:e.errorCode,mesg_token:e._messageToken})))},Object.defineProperty(t.prototype,"isResendable",{get:function(){return(this.sendingStatus===jt.FAILED||this.sendingStatus===jt.CANCELED)&&g5(this.errorCode)},enumerable:!1,configurable:!0}),t.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId},t}(Hi),Lh={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:Ni.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},Dm=function(n){return J("number",n.prevResultSize)&&J("number",n.nextResultSize)&&J("boolean",n.isInclusive)&&J("boolean",n.reverse)&&J("string",n.messageTypeFilter)&&nt(Ni,n.messageTypeFilter)&&tt("string",n.customTypesFilter,!0)&&tt("string",n.senderUserIdsFilter,!0)&&J("boolean",n.includeMetaArray)&&J("boolean",n.includeReactions)&&J("boolean",n.includeParentMessageInfo)},Xl=function(n){function t(e,r){var i,a,s,u=this;if((u=n.call(this,e,r)||this).translations={},u.messageType=Rr.ADMIN,u.translations=(i=r.translations)!==null&&i!==void 0?i:{},r.parent_message_info){var d=r.parent_message_info;u.parentMessage=Ri(e,ze(_n(W(W({},d),{message_id:u.parentMessageId,channel_url:u.channelUrl,channel_type:u.channelType,file:d.file,url:(a=d.file)===null||a===void 0?void 0:a.url,require_auth:(s=d.file)===null||s===void 0?void 0:s.require_auth}))))}return u}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{translations:e.translations,parent_message_info:e.parentMessage?n._getParentMessageInfoPayload.call(this,e.parentMessage):null})))},t.prototype.getThreadedMessagesByTimestamp=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},Lh),r),Se(this.messageId>0&&J("number",e)&&Dm(i)).throw(ee.invalidParameters),[4,ni.of(this._iid).getThreadedMessagesByTimestamp(this,e,i)];case 1:return[2,a.sent()]}})})},t}(Hi),m1=function(){function n(t){var e,r;this.detail={},this.type=(e=t.type)!==null&&e!==void 0?e:"",this.vendor=(r=t.vendor)!==null&&r!==void 0?r:"",t.detail&&J("object",t.detail)&&!Array.isArray(t.detail)&&(this.detail=t.detail)}return n.payloadify=function(t){return ze(_n({type:t.type,vendor:t.vendor,detail:t.detail}))},n}(),g1=function(){function n(t){this.status=t.status,t.original_message_info&&(this.originalMessageInfo={createdAt:t.original_message_info.ts,messageId:t.original_message_info.id})}return n.payloadify=function(t){return ze({status:t.status,original_message_info:t.originalMessageInfo?{id:t.originalMessageInfo.messageId,ts:t.originalMessageInfo.createdAt}:void 0})},n}(),Si=function(n){function t(e,r){var i,a,s,u,d,h,p,g=this;if((g=n.call(this,e,r)||this).messageParams=null,g.mentionedMessageTemplate=void 0,g.translations={},g.translationTargetLanguages=[],g.messageSurvivalSeconds=-1,g.plugins=[],g.messageType=Rr.USER,g.translations=(s=r.translations)!==null&&s!==void 0?s:{},g.translationTargetLanguages=(u=r.target_langs)!==null&&u!==void 0?u:[],Object.keys(g.translations).length===0&&g.translationTargetLanguages.length>0)try{for(var E=Le(g.translationTargetLanguages),y=E.next();!y.done;y=E.next()){var C=y.value;g.translations[C]=""}}catch(A){i={error:A}}finally{try{y&&!y.done&&(a=E.return)&&a.call(E)}finally{if(i)throw i.error}}if(g.mentionedMessageTemplate=r.mentioned_message_template,g.messageSurvivalSeconds=(d=r.message_survival_seconds)!==null&&d!==void 0?d:-1,g.plugins=r.plugins?r.plugins.map(function(A){return new m1(A)}):[],r.parent_message_info){var T=r.parent_message_info;g.parentMessage=Ri(e,ze(_n(W(W({},T),{created_at:T.ts,message_id:g.parentMessageId,channel_url:g.channelUrl,channel_type:g.channelType,file:T.file,url:(h=T.file)===null||h===void 0?void 0:h.url,require_auth:(p=T.file)===null||p===void 0?void 0:p.require_auth}))))}return r.review_info&&(g.messageReviewInfo=new g1(r.review_info)),g}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{translations:e.translations,message_survival_seconds:e.messageSurvivalSeconds,mentioned_message_template:e.mentionedMessageTemplate,plugins:e.plugins.map(function(r){return m1.payloadify(r)}),parent_message_info:e.parentMessage?n._getParentMessageInfoPayload.call(this,e.parentMessage):null,review_info:e.messageReviewInfo?g1.payloadify(e.messageReviewInfo):void 0})))},t.prototype.getThreadedMessagesByTimestamp=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},Lh),r),Se(this.messageId>0&&J("number",e)&&Dm(i)).throw(ee.invalidParameters),[4,ni.of(this._iid).getThreadedMessagesByTimestamp(this,e,i)];case 1:return[2,a.sent()]}})})},t}(Lr),Wa=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E=this;if((E=n.call(this,e,r)||this).messageParams=null,E.fileInfoList=[],E.messageSurvivalSeconds=-1,E.messageType=Rr.FILE,E.data=(s=(a=(i=r.file)===null||i===void 0?void 0:i.data)!==null&&a!==void 0?a:r.custom)!==null&&s!==void 0?s:"",E.fileInfoList=(d=(u=r.files)===null||u===void 0?void 0:u.map(function(C){return new iy(e,C)}))!==null&&d!==void 0?d:[],E.messageSurvivalSeconds=(h=r.message_survival_seconds)!==null&&h!==void 0?h:-1,r.parent_message_info){var y=r.parent_message_info;E.parentMessage=Ri(e,ze(_n(W(W({},y),{created_at:y.ts,message_id:E.parentMessageId,channel_url:E.channelUrl,channel_type:E.channelType,file:y.file,url:(p=y.file)===null||p===void 0?void 0:p.url,require_auth:(g=y.file)===null||g===void 0?void 0:g.require_auth}))))}return E}return j(t,n),t.prototype.getThreadedMessagesByTimestamp=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},Lh),r),Se(this.messageId>0&&J("number",e)&&Dm(i)).throw(ee.invalidParameters),[4,ni.of(this._iid).getThreadedMessagesByTimestamp(this,e,i)];case 1:return[2,a.sent()]}})})},t.payloadify=function(e){var r,i,a,s,u,d;return ze(_n(W(W({},n.payloadify.call(this,e)),{file:{name:(i=(r=e.fileInfoList[0])===null||r===void 0?void 0:r.fileName)!==null&&i!==void 0?i:"",size:(s=(a=e.fileInfoList[0])===null||a===void 0?void 0:a.fileSize)!==null&&s!==void 0?s:0,type:(d=(u=e.fileInfoList[0])===null||u===void 0?void 0:u.mimeType)!==null&&d!==void 0?d:"",data:e.data},files:Array.isArray(e.fileInfoList)?e.fileInfoList.map(function(h){return iy.payloadify(h)}):null,message_survival_seconds:e.messageSurvivalSeconds,parent_message_info:e.parentMessage?n._getParentMessageInfoPayload.call(this,e.parentMessage):null})))},t._isMultipleFilesMessagePayload=function(e){var r=e.files;return Array.isArray(r)&&r.length>=2},t._isMultipleFilesMessageSerializedData=function(e){var r=e.fileInfoList;return Array.isArray(r)},t}(Lr);(function(n){n.SENT="SENT",n.READ="READ"})(Vl||(Vl={}));var Jl=function(n){function t(e,r){var i,a,s=this;if((s=n.call(this,e,r)||this).notificationData=null,s.notificationId=r.notification_message_id,s.messageType=Rr.ADMIN,s.messageStatus=(i=r.message_status)!==null&&i!==void 0?i:Vl.SENT,s.priority=(a=r.priority)!==null&&a!==void 0?a:WE.NORMAL,s.notificationEventDeadline=r.notification_event_deadline,s.extendedMessage.sub_type===0)try{var u=JSON.parse(s.extendedMessage.sub_data),d=u.label,h=u.tags,p=h===void 0?[]:h,g=u.template_key,E=u.template_variables;s.notificationData={label:d,tags:p,templateKey:g,templateVariables:E}}catch{}return s}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{notification_message_id:e.notificationId,message_status:e.messageStatus,priority:e.priority,notification_event_deadline:e.notificationEventDeadline})))},t.prototype.isIdentical=function(e){return this.notificationId===e.notificationId},t}(oM),ay=function(n){if(n.notificationId)return Jl.payloadify(n);switch(n.messageType){case Rr.USER:return Si.payloadify(n);case Rr.FILE:return n.fileInfoList?Wa.payloadify(n):Wr.payloadify(n);case Rr.ADMIN:return Xl.payloadify(n);default:throw ee.unknown}},Ri=function(n,t){if(t.notification_message_id)return new Jl(n,t);switch(t.type){case"MESG":return new Si(n,t);case"FILE":return Wa._isMultipleFilesMessagePayload(t)?new Wa(n,t):new Wr(n,t);case"ADMM":case"BRDM":return new Xl(n,t);default:return null}},Wr=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y,C,T,A,O,N=this;(N=n.call(this,e,r)||this).messageParams=null,N.plainUrl="",N.requireAuth=!1,N.thumbnails=[],N.messageSurvivalSeconds=-1,N.messageType=Rr.FILE;var k=r.file;if(N.plainUrl=((a=(i=k==null?void 0:k.url)!==null&&i!==void 0?i:r.url)!==null&&a!==void 0?a:"").split("?auth=")[0],N.name=(u=(s=k==null?void 0:k.name)!==null&&s!==void 0?s:r.name)!==null&&u!==void 0?u:"File",N.size=(h=(d=k==null?void 0:k.size)!==null&&d!==void 0?d:r.size)!==null&&h!==void 0?h:0,N.data=(g=(p=k==null?void 0:k.data)!==null&&p!==void 0?p:r.custom)!==null&&g!==void 0?g:"",N.type=k?(E=k.type)!==null&&E!==void 0?E:"":(y=r.type)!==null&&y!==void 0?y:"",N.requireAuth=(C=r.require_auth)!==null&&C!==void 0&&C,N.thumbnails=r.thumbnails?r.thumbnails.map(function(P){var U;return new ju(N._iid,typeof P=="string"?{url:P,width:0,height:0}:W(W({},P),{url:((U=P.url)!==null&&U!==void 0?U:"").split("auth=")[0]}),N.requireAuth)}):[],N.messageSurvivalSeconds=(T=r.message_survival_seconds)!==null&&T!==void 0?T:-1,r.parent_message_info){var D=r.parent_message_info;N.parentMessage=Ri(e,ze(_n(W(W({},D),{created_at:D.ts,message_id:N.parentMessageId,channel_url:N.channelUrl,channel_type:N.channelType,file:D.file,url:(A=D.file)===null||A===void 0?void 0:A.url,require_auth:(O=D.file)===null||O===void 0?void 0:O.require_auth}))))}return N}return j(t,n),t.payloadify=function(e){var r;return ze(_n(W(W({},n.payloadify.call(this,e)),{url:e.plainUrl,require_auth:e.requireAuth,file:{name:e.name,size:e.size,type:e.type,data:e.data},thumbnails:(r=e.thumbnails)===null||r===void 0?void 0:r.map(function(i){return{url:i.plainUrl,width:i.width,height:i.height,real_width:i.realWidth,real_height:i.realHeight}}),message_survival_seconds:e.messageSurvivalSeconds,parent_message_info:e.parentMessage?n._getParentMessageInfoPayload.call(this,e.parentMessage):null})))},Object.defineProperty(t.prototype,"url",{get:function(){var e=X.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t.prototype.getThreadedMessagesByTimestamp=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},Lh),r),Se(this.messageId>0&&J("number",e)&&Dm(i)).throw(ee.invalidParameters),[4,ni.of(this._iid).getThreadedMessagesByTimestamp(this,e,i)];case 1:return[2,a.sent()]}})})},t}(Lr),em=function(n){function t(e,r){var i=r.file,a=r.fileUrl,s=r.fileName,u=r.fileSize,d=r.mimeType,h=r.thumbnailSizes,p=r._uploadedMetaData,g=r._thumbnails,E=n.call(this,e)||this;return E._plainUrl=a,E.file=i,E.fileName=s,E.fileSize=u,E.mimeType=d,E.thumbnailSizes=h,E._uploadedMetaData=p,E._thumbnails=g,E}return j(t,n),t.getPlainUrl=function(e){return e instanceof t?e._plainUrl:e.fileUrl},Object.defineProperty(t.prototype,"fileUrl",{get:function(){var e,r=X.of(this._iid).sessionManager;return this._plainUrl&&(!((e=this._uploadedMetaData)===null||e===void 0)&&e.requireAuth)&&r.ekey?"".concat(this._plainUrl,"?auth=").concat(r.ekey):this._plainUrl},set:function(e){this._plainUrl=e},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{file:this.file,fileUrl:this._plainUrl,fileName:this.fileName,fileSize:this.fileSize,mimeType:this.mimeType,thumbnailSizes:this.thumbnailSizes,_thumbnails:this._thumbnails,_uploadedMetaData:this._uploadedMetaData}},t}(Zr),G7=function(n){function t(e){var r,i,a,s,u=[];return e.mentionType===wi.USERS&&(e.mentionedUserIds?u=e.mentionedUserIds:e.mentionedUsers&&(u=e.mentionedUsers.map(function(d){return d.userId}))),n.call(this,{code:"FILE",ackRequired:!0,payload:ze(_n({channel_url:e.channelUrl,files:e.files?fM(e.files):null,url:e.url,name:(r=e.fileName)!==null&&r!==void 0?r:"",type:(i=e.mimeType)!==null&&i!==void 0?i:"",size:(a=e.fileSize)!==null&&a!==void 0?a:0,custom:e.data,custom_type:e.customType,thumbnails:(s=e._thumbnails)===null||s===void 0?void 0:s.map(function(d){return ju.payloadify(d)}),require_auth:e.requireAuth,metaarray:e.metaArrays,mention_type:e.mentionType,mentioned_user_ids:u,push_option:e.pushNotificationDeliveryOption&&e.pushNotificationDeliveryOption!==Ms.DEFAULT?e.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,silent:e.silent,reply_to_channel:e.isReplyToChannel,parent_message_id:e.parentMessageId?e.parentMessageId:null,req_id:e.reqId,poll_id:e.pollId,pin_message:e.isPinnedMessage,message:e.message}))})||this}return j(t,n),t}(Ai),V7=function(n){function t(e){var r,i,a=this;a=n.call(this)||this;var s=[];return e.mentionType===wi.USERS&&(e.mentionedUserIds?s=e.mentionedUserIds:e.mentionedUsers&&(s=e.mentionedUsers.map(function(u){return u.userId}))),a.method=Ie.POST,a.path="".concat(Lt(e.channelType),"/").concat(encodeURIComponent(e.channelUrl),"/messages"),a.params=ze(_n({message_type:Rr.FILE,user_id:e.userId,files:e.files?fM(e.files):null,url:e.fileUrl,mention_type:e.mentionType,mentioned_user_ids:s,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,data:e.data,custom_type:e.customType,thumbnails:(r=e._thumbnails)===null||r===void 0?void 0:r.map(function(u){return ju.payloadify(u)}),require_auth:e.requireAuth,sorted_metaarray:(i=e.metaArrays)===null||i===void 0?void 0:i.map(function(u){return Vi.payloadify(u)}),push_option:e.pushNotificationDeliveryOption,parent_message_id:e.parentMessageId?e.parentMessageId:null,apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,reply_to_channel:e.isReplyToChannel,req_id:e.reqId,poll_id:e.pollId,pin_message:e.isPinnedMessage})),a}return j(t,n),t}(Te),sC=function(n){function t(e,r,i){var a,s,u,d,h=this;(h=n.call(this,e,"FILE",i)||this).message=i.files&&i.files.length>=2?new Wa(e,i):new Wr(e,i);var p=X.of(e).sdkState;return h.isMentioned=_c(h.message.mentionType,(u=(a=h.message.mentionedUserIds)!==null&&a!==void 0?a:(s=h.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(g){return g.userId}))!==null&&u!==void 0?u:[],p.userId),h.forceUpdateLastMessage=(d=i.force_update_last_message)!==null&&d!==void 0&&d,h}return j(t,n),t}(dr),j7=function(n){function t(e,r){var i,a,s,u,d=this;(d=n.call(this,e,r)||this).message=r.files&&r.files.length>=2?new Wa(e,r):new Wr(e,r);var h=X.of(e).sdkState;return d.isMentioned=_c(d.message.mentionType,(s=(i=d.message.mentionedUserIds)!==null&&i!==void 0?i:(a=d.message.mentionedUsers)===null||a===void 0?void 0:a.map(function(p){return p.userId}))!==null&&s!==void 0?s:[],h.userId),d.forceUpdateLastMessage=(u=r.force_update_last_message)!==null&&u!==void 0&&u,d}return j(t,n),t}(Me);function fM(n){return n.map(function(t){var e,r;return ze(_n({url:em.getPlainUrl(t),file_name:t.fileName,file_type:t.mimeType,file_size:t.fileSize,thumbnails:(e=t._thumbnails)===null||e===void 0?void 0:e.map(function(i){return ju.payloadify(i)}),require_auth:(r=t._uploadedMetaData)===null||r===void 0?void 0:r.requireAuth}))})}var ri;(function(n){n[n.PENDING=0]="PENDING",n[n.UPLOADING=1]="UPLOADING",n[n.UPLOADED=2]="UPLOADED",n[n.SENDING=3]="SENDING",n[n.FAILED=4]="FAILED"})(ri||(ri={}));var q7=function(){function n(t,e){var r=e.sdkState,i=e.dispatcher,a=e.requestQueue,s=e.onlineDetector,u=e.cacheContext,d=this;this._queueMap=new Map,this._iid=t,this._sdkState=r,this._requestQueue=a,this._cacheContext=u,this._dispatcher=i,this._dispatcher.on(function(h){h instanceof Aa&&(d._connectionState=h.stateType)}),this._onlineDetector=s}return Object.defineProperty(n.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===Gt.CONNECTED||this._connectionState===Gt.CONNECTING||this._connectionState===Gt.RECONNECTING},enumerable:!1,configurable:!0}),n.prototype._sendFileMessage=function(t,e){return M(this,void 0,void 0,function(){var r,i,a;return R(this,function(s){switch(s.label){case 0:return r=this._createSendFileMessageRequestParams(t,e),this._shouldSendThroughWebSocket?(i=new G7(r),[4,this._requestQueue.send(i)]):[3,2];case 1:return a=s.sent(),[2,a.as(sC).message];case 2:return i=new V7(W(W({},r),{userId:this._sdkState.userId})),[4,this._requestQueue.send(i)];case 3:return a=s.sent(),[2,a.as(j7).message]}})})},n.prototype._createSendFileMessageRequestParams=function(t,e){var r=W(W({},e.params),{channelUrl:t.url,channelType:t.channelType,reqId:e.requestId,url:""});if(e.multipleFileUploadInfo){var i=e.params;r.files=i.fileInfoList}else i=e.params,r.url=i.fileUrl,r.requireAuth=i.requireAuth;return r},n.prototype._resolveMessageQueue=function(t){var e;return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g,E,y,C,T;return R(this,function(A){switch(A.label){case 0:if(!(r=this._queueMap.get(t.url)))return[3,21];if(r.isResolving)return[3,20];r.isResolving=!0,i=[],a=!0,A.label=1;case 1:A.trys.push([1,15,16,17]),s=Le(r.messageQueue),u=s.next(),A.label=2;case 2:if(u.done)return[3,14];switch(d=u.value,d.state){case ri.PENDING:case ri.UPLOADING:return[3,3];case ri.UPLOADED:return[3,4];case ri.FAILED:return[3,12]}return[3,13];case 3:return a=!1,i.push(d),[3,13];case 4:if(!a)return[3,10];A.label=5;case 5:return A.trys.push([5,8,,9]),d.state=ri.SENDING,[4,this._sendFileMessage(t,d)];case 6:return h=A.sent(),d.deferred.resolve(h),[4,sa(100)];case 7:return A.sent(),[3,9];case 8:return p=A.sent(),d.deferred.reject(p),[3,9];case 9:return[3,11];case 10:i.push(d),A.label=11;case 11:return[3,13];case 12:return g=(e=d.error)!==null&&e!==void 0?e:ee.unknown,d.deferred.reject(g.code===rn.REQUEST_CANCELED?ee.fileUploadCanceled:g),[3,13];case 13:return u=s.next(),[3,2];case 14:return[3,17];case 15:return E=A.sent(),C={error:E},[3,17];case 16:try{u&&!u.done&&(T=s.return)&&T.call(s)}finally{if(C)throw C.error}return[7];case 17:return y=r.isResolveRequestPending,r.messageQueue=i,r.isResolving=!1,r.isResolveRequestPending=!1,y?[4,this._resolveMessageQueue(t)]:[3,19];case 18:A.sent(),A.label=19;case 19:return[3,21];case 20:r.isResolveRequestPending=!0,A.label=21;case 21:return[2]}})})},n.prototype._uploadNextPendingItem=function(t){var e;return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g,E;return R(this,function(y){switch(y.label){case 0:return(r=this._queueMap.get(t.url))&&(i=r.messageQueue.find(function(C){return C.state===ri.PENDING}))?i.multipleFileUploadInfo?(a=i.multipleFileUploadInfo,s=a.uploadIndex,u=a.uploadCount,d=a.requestHandler,E=i.params,h=E.fileInfoList[s],!oi(h.file)||!((e=h._uploadedMetaData)===null||e===void 0)&&e.isUploaded?[3,2]:[4,this._tryUploadNextItemAndUpdateItemState(t,r,i)]):[3,4]:[3,9];case 1:return y.sent(),[3,3];case 2:i.state=s<u-1?ri.PENDING:ri.UPLOADED,y.label=3;case 3:return p=E.fileInfoList[s],g=i.multipleFileUploadInfo.uploadIndex++,i.multipleFileUploadInfo.isCopy||d==null||d._triggerOnFileUploaded(i.requestId,g,p,i.error),[3,7];case 4:return E=i.params,oi(E.file)?[4,this._tryUploadNextItemAndUpdateItemState(t,r,i)]:[3,6];case 5:return y.sent(),[3,7];case 6:E.thumbnailSizes=[],i.state=ri.UPLOADED,y.label=7;case 7:return this._uploadNextPendingItem(t),[4,this._resolveMessageQueue(t)];case 8:y.sent(),y.label=9;case 9:return[2]}})})},n.prototype._tryUploadNextItemAndUpdateItemState=function(t,e,r){return M(this,void 0,void 0,function(){var i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return[4,this._onlineDetector.isOnline()];case 1:if(i=p.sent(),!X.of(this._iid).sessionManager.currentUser||!i)return r.error=ee.connectionRequired,r.state=ri.FAILED,[2];if(!(e.uploadQueue.length<6))return[3,9];r.state=ri.UPLOADING,e.uploadQueue.push(r),p.label=2;case 2:return p.trys.push([2,7,,8]),r.multipleFileUploadInfo?(a=r.multipleFileUploadInfo,s=a.uploadIndex,u=a.uploadCount,d=r.params,[4,this._uploadNextFileForMultipleFilesItemAndUpdateParams(t,r,d)]):[3,4];case 3:return p.sent(),r.state=s<u-1?ri.PENDING:ri.UPLOADED,[3,6];case 4:return d=r.params,[4,this._uploadNextFileForSingleFileItemAndUpdateParams(t,r,d)];case 5:p.sent(),r.state=ri.UPLOADED,p.label=6;case 6:return[3,8];case 7:switch((h=p.sent()).code){case rn.REQUEST_FAILED:r.error=new ee({code:rn.NETWORK_ERROR,message:"Failed to upload a file."});break;case rn.REQUEST_CANCELED:r.error=ee.fileUploadCanceled;break;default:r.error=h}return r.state=ri.FAILED,[3,8];case 8:this._dequeueUploadItem(e,r),p.label=9;case 9:return[2]}})})},n.prototype._dequeueUploadItem=function(t,e){var r=t.uploadQueue.findIndex(function(i){return i.requestId===e.requestId});r>=0&&t.uploadQueue.splice(r,1)},n.prototype._uploadNextFileForSingleFileItemAndUpdateParams=function(t,e,r){var i,a,s;return M(this,void 0,void 0,function(){var u,d,h,p,g,E,y,C,T,A;return R(this,function(O){switch(O.label){case 0:return u=new Z_({file:r.file,channelUrl:t.url,thumbnailSizes:r.thumbnailSizes,requestId:e.requestId}),[4,this._requestQueue.send(u)];case 1:return d=O.sent(),h=d.as(X_),p=h.url,g=h.fileSize,E=g===void 0?r.fileSize:g,y=h.thumbnails,C=y===void 0?[]:y,T=h.requireAuth,A=T!==void 0&&T,r.fileName=(i=r.fileName)!==null&&i!==void 0?i:r.file.name,r.mimeType=(a=r.mimeType)!==null&&a!==void 0?a:r.file.type,r.fileSize=(s=r.fileSize)!==null&&s!==void 0?s:r.file.size,r.fileUrl=p,r.fileSize=E,r.requireAuth=A,r._thumbnails=C,[2]}})})},n.prototype._uploadNextFileForMultipleFilesItemAndUpdateParams=function(t,e,r){var i,a,s;return M(this,void 0,void 0,function(){var u,d,h,p,g,E,y,C,T,A,O;return R(this,function(N){switch(N.label){case 0:return u=e.multipleFileUploadInfo.uploadIndex,d=r.fileInfoList[u],h=new Z_({file:d.file,channelUrl:t.url,thumbnailSizes:d.thumbnailSizes,requestId:e.requestId}),[4,this._requestQueue.send(h)];case 1:return p=N.sent(),g=p.as(X_),E=g.url,y=g.fileSize,C=y===void 0?d.fileSize:y,T=g.thumbnails,A=g.requireAuth,O=A!==void 0&&A,d.fileName=(i=d.fileName)!==null&&i!==void 0?i:d.file.name,d.mimeType=(a=d.mimeType)!==null&&a!==void 0?a:d.file.type,d.fileSize=(s=d.fileSize)!==null&&s!==void 0?s:d.file.size,d.file=void 0,d.fileUrl=E,d.fileSize=C,d._thumbnails=T,d._uploadedMetaData=W(W({},d._uploadedMetaData),{requireAuth:O,isUploaded:!0}),d instanceof em||(r.fileInfoList[u]=new em(this._iid,d)),[2]}})})},n.prototype.request=function(t,e,r,i){return i===void 0&&(i={}),M(this,void 0,void 0,function(){var a,s,u,d,h;return R(this,function(p){return this._queueMap.has(t.url)||(a={messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1},this._queueMap.set(t.url,a)),s=this._queueMap.get(t.url),u=new Qi,d={requestId:e,params:r,state:ri.PENDING,deferred:u},function(g){return"fileInfoList"in g}(r)&&(h=W({uploadIndex:0,uploadCount:r.fileInfoList.length},i),d.multipleFileUploadInfo=h),s.messageQueue.push(d),this._uploadNextPendingItem(t),[2,u.promise]})})},n.prototype.cancel=function(t,e){var r,i,a=this._queueMap.get(t.url);if(a){var s=e?[a.messageQueue.find(function(C){return C.requestId===e})]:Nn([],cn(a.messageQueue),!1);try{for(var u=Le(s),d=u.next();!d.done;d=u.next()){var h=d.value;if(h)switch(h.state){case ri.PENDING:if(h.state=ri.FAILED,h.error=ee.requestCanceled,h.multipleFileUploadInfo&&!h.multipleFileUploadInfo.isCopy){var p=h.multipleFileUploadInfo,g=p.uploadIndex,E=p.requestHandler,y=h.params.fileInfoList[g];E==null||E._triggerOnFileUploaded(h.requestId,g,y,ee.fileUploadCanceled)}this._resolveMessageQueue(t);break;case ri.UPLOADING:this._requestQueue.cancel(h.requestId),this._dispatcher.dispatch(new j_({requestId:h.requestId}))}}}catch(C){r={error:C}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}else e&&(this._requestQueue.cancel(e),this._dispatcher.dispatch(new j_({requestId:e})))},n}(),sy,uh={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:Ni.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,replyType:ti.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},v1=function(n){return J("number",n.prevResultSize)&&J("number",n.nextResultSize)&&J("boolean",n.isInclusive)&&J("boolean",n.reverse)&&J("string",n.messageTypeFilter)&&nt(Ni,n.messageTypeFilter)&&tt("string",n.customTypesFilter,!0)&&tt("string",n.senderUserIdsFilter,!0)&&nt(ti,n.replyType)&&J("boolean",n.includeMetaArray)&&J("boolean",n.includeReactions)&&J("boolean",n.includeParentMessageInfo)&&J("boolean",n.includeThreadInfo)&&J("boolean",n.showSubchannelMessagesOnly)},uy={replyType:ti.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},E1=function(n){return nt(ti,n.replyType)&&J("boolean",n.includeReactions)&&J("boolean",n.includeMetaArray)&&J("boolean",n.includeParentMessageInfo)&&J("boolean",n.includeThreadInfo)},z7=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.includeMetaArray,u=e.includeReactions,d=e.includeThreadInfo,h=e.includeParentMessageInfo,p=n.call(this)||this;return p.method=Ie.GET,p.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(encodeURIComponent(a)),p.params={is_sdk:!0,with_sorted_meta_array:s,include_reactions_summary:u!=null&&u,include_thread_info:d,include_parent_message_info:h,include_poll_details:!0},p}return j(t,n),t}(Te),K7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=r?Ri(e,W({},r)):null,i}return j(t,n),t}(Me),Jp=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.timestamp,s=e.token,u=e.prevResultSize,d=e.nextResultSize,h=e.isInclusive,p=e.reverse,g=e.messageTypeFilter,E=e.customTypesFilter,y=e.senderUserIdsFilter,C=e.replyType,T=e.includeMetaArray,A=e.includeReactions,O=e.parentMessageId,N=e.includeThreadInfo,k=e.includeParentMessageInfo,D=e.showSubchannelMessagesOnly,P=e.checkingHasNext,U=e.checkingContinuousMessages,L=n.call(this)||this;return L.method=Ie.GET,L.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages"),L.params=ze(_n({is_sdk:!0,prev_limit:u,next_limit:d,include:h,reverse:p,message_ts:a,message_id:s,message_type:g??null,custom_types:E,sender_ids:y,include_reply_type:C,with_sorted_meta_array:T,include_reactions_summary:A,parent_message_id:O,include_thread_info:N,include_parent_message_info:k,show_subchannel_message_only:D,include_poll_details:!0,checking_has_next:P,checking_continuous_messages:U})),L}return j(t,n),t}(Te),e_=function(n){function t(e,r){var i=n.call(this,e,r)||this;return r.is_continuous_messages!==void 0&&(i.isContinuousMessages=r.is_continuous_messages),r.has_next!==void 0&&(i.hasNext=r.has_next),i.messages=r.messages.map(function(a){return Ri(e,a)}),i}return j(t,n),t}(Me),W7=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.timestamp,s=e.token,u=e.replyType,d=e.includeMetaArray,h=e.includeReactions,p=e.includeThreadInfo,g=e.includeParentMessageInfo,E=n.call(this)||this;return E.method=Ie.GET,E.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/changelogs"),E.params={change_ts:a,token:s,with_sorted_meta_array:d,include_reactions_summary:h,include_thread_info:p,include_reply_type:u,include_parent_message_info:g,include_poll_details:!0},E}return j(t,n),t}(Te),$7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.updatedMessages=r.updated.map(function(a){return Ri(e,a)}),i.deletedMessagesInfo=r.deleted.map(function(a){return{messageId:a.message_id,deletedAt:a.deleted_at}}),i.hasMore=r.has_more,i.nextToken=r.next,i.forceUseNextToken=r.force_use_next_token||!1,i}return j(t,n),t}(Me),Y7=function(n){function t(e){var r=e.channelUrl,i=e.scheduledMessageId,a=n.call(this)||this;return a.method=Ie.GET,a.path="".concat(qi,"/").concat(encodeURIComponent(r),"/scheduled_messages/").concat(encodeURIComponent(i)),a.params={},a}return j(t,n),t}(Te),Q7=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=r?Ri(e,W({},r)):null,i}return j(t,n),t}(Me);(function(n){n.MUTED="muted",n.BANNED="banned"})(sy||(sy={}));var y1=function(){function n(t){var e,r,i,a;this.restrictionType=null,nt(sy,t.restriction_type)&&(this.restrictionType=t.restriction_type),this.description=(e=t.description)!==null&&e!==void 0?e:null,this.endAt=(i=(r=t.end_at)!==null&&r!==void 0?r:t.muted_end_at)!==null&&i!==void 0?i:-1,this.remainingDuration=(a=t.remaining_duration)!==null&&a!==void 0?a:-1}return n.payloadify=function(t){return ze(_n({restriction_type:t.restrictionType,description:t.description,end_at:t.endAt,remaining_duration:t.remainingDuration}))},n}(),ud=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.restrictionInfo=new y1(r),i}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),y1.payloadify(e.restrictionInfo))))},t}(_t),Z7=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).isMuted=!1,a.isMuted=(i=r.is_muted)!==null&&i!==void 0&&i,a}return j(t,n),t}(_t),Ia=function(){function n(){this._onPending=Kn,this._onFailed=Kn,this._onSucceeded=Kn}return n.prototype._trigger=function(t){switch(t==null?void 0:t.sendingStatus){case jt.PENDING:t.errorCode===0&&this._onPending(t);break;case jt.SCHEDULED:case jt.SUCCEEDED:this._onSucceeded(t)}},n.prototype._triggerFailed=function(t,e){switch(e==null?void 0:e.sendingStatus){case jt.FAILED:case jt.CANCELED:this._onFailed(t,e.scheduledInfo?null:e)}},n.prototype.onPending=function(t){return this._onPending=t,this},n.prototype.onFailed=function(t){return this._onFailed=t,this},n.prototype.onSucceeded=function(t){return this._onSucceeded=t,this},n}(),Lm={data:void 0,customType:void 0,mentionType:wi.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,metaArrays:void 0,parentMessageId:void 0,isReplyToChannel:!1,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0,isPinnedMessage:!1,pollId:void 0},xm=function(n){return J("string",n.data,!0)&&J("string",n.customType,!0)&&nt(wi,n.mentionType)&&tt("string",n.mentionedUserIds,!0)&&tt(_t,n.mentionedUsers,!0)&&tt(Vi,n.metaArrays,!0)&&J("number",n.parentMessageId,!0)&&J("boolean",n.isReplyToChannel)&&nt(Ms,n.pushNotificationDeliveryOption,!0)&&J(cs,n.appleCriticalAlertOptions,!0)&&J("boolean",n.isPinnedMessage,!0)&&J("number",n.pollId,!0)},b1=function(n){return{isReplyToChannel:n.isReplyToChannel,pushNotificationDeliveryOption:n.pushNotificationDeliveryOption,pollId:n.pollId}},hM=W(W({},Lm),{message:"",mentionedMessageTemplate:void 0,translationTargetLanguages:void 0,extendedMessagePayload:void 0});function pM(n){var t,e,r;return(t=n.messageParams)!==null&&t!==void 0?t:_n(W(W({},n),{mentionType:n.mentionType,mentionedUserIds:(e=n.mentionedUserIds)!==null&&e!==void 0?e:(r=n.mentionedUsers)===null||r===void 0?void 0:r.map(function(i){return i.userId}),mentionedMessageTemplate:n.mentionedMessageTemplate,translationTargetLanguages:Object.keys(n.translations),pushNotificationDeliveryOption:Ms.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1}))}var zl,oy=function(n){var t;return ze(_n({data:n.data,customType:n.customType,mentionType:n.mentionType,mentionedUsers:n.mentionedUsers,mentionedUserIds:n.mentionedUserIds,mentionedMessageTemplate:n.mentionedMessageTemplate,metaArrays:n.metaArrays,pollId:(t=n.poll)===null||t===void 0?void 0:t.id,parentMessageId:n.parentMessageId,appleCriticalAlertOptions:n.appleCriticalAlertOptions,message:n.message,translationTargetLanguages:Object.keys(n.translations),extendedMessagePayload:n.extendedMessagePayload}))},_M=function(n){return xm(n)&&J("string",n.message)&&J("string",n.mentionedMessageTemplate,!0)&&tt("string",n.translationTargetLanguages,!0)&&J("object",n.extendedMessagePayload,!0)};(function(n){n.FILE="file",n.BLOB="blob",n.BLOB_LIKE_OBJECT="blobLikeObject",n.URL="url"})(zl||(zl={}));var T_=function(n){return typeof window<"u"&&"Blob"in window&&typeof Blob<"u"&&n instanceof Blob},pE=function(n){return n===zl.BLOB||n===zl.FILE},C1=function(n){return{file:n.file,fileKey:n.fileKey,fileType:n.fileType,isReplyToChannel:n.isReplyToChannel,pushNotificationDeliveryOption:n.pushNotificationDeliveryOption}},I1=W(W({},Lm),{file:void 0,fileKey:void 0,fileUrl:void 0,fileName:void 0,fileType:void 0,fileSize:void 0,mimeType:void 0,thumbnailSizes:void 0,requireAuth:!1,message:void 0});function mM(n){var t,e,r,i;return(t=n.messageParams)!==null&&t!==void 0?t:_n(W(W({},n),{fileUrl:n.plainUrl,fileName:n.name,fileSize:n.size,mimeType:n.type,mentionType:n.mentionType,mentionedUserIds:(e=n.mentionedUserIds)!==null&&e!==void 0?e:(r=n.mentionedUsers)===null||r===void 0?void 0:r.map(function(a){return a.userId}),pushNotificationDeliveryOption:Ms.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:(i=n.thumbnails)===null||i===void 0?void 0:i.map(function(a){return{maxWidth:a.width,maxHeight:a.height}}),requireAuth:n.requireAuth,isPinnedMessage:!1,_thumbnails:n.thumbnails,message:n.message}))}var oh,ly=function(n,t){var e,r;return n.messageParams?(!n.url&&oi(t)&&(n.messageParams.file=t),n.messageParams):ze(_n({data:n.data,customType:n.customType,mentionType:n.mentionType,mentionedUsers:n.mentionedUsers,mentionedUserIds:n.mentionedUserIds,metaArrays:n.metaArrays,parentMessageId:n.parentMessageId,appleCriticalAlertOptions:n.appleCriticalAlertOptions,file:t,fileUrl:n.url,fileName:n.name,fileSize:n.size,mimeType:n.type,thumbnailSizes:(e=n.thumbnails)===null||e===void 0?void 0:e.map(function(i){return{maxWidth:i.width,maxHeight:i.height}}),message:n.message,pollId:(r=n.poll)===null||r===void 0?void 0:r.id}))},T1=function(n){return xm(n)&&(oi(n.file)||J("string",n.fileUrl))&&J("string",n.fileName,!0)&&J("string",n.mimeType,!0)&&J("number",n.fileSize,!0)&&J("string",n.message,!0)&&(n.thumbnailSizes===null||n.thumbnailSizes===void 0||Array.isArray(n.thumbnailSizes)&&n.thumbnailSizes.every(function(t){return J("object",t)&&t.maxWidth>0&&t.maxHeight>0}))},uC={data:void 0,customType:void 0,mentionType:wi.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,metaArrays:void 0,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0},oC=function(n){return J("string",n.data,!0)&&J("string",n.customType,!0)&&nt(wi,n.mentionType)&&tt("string",n.mentionedUserIds,!0)&&tt(_t,n.mentionedUsers,!0)&&tt(Vi,n.metaArrays,!0)&&nt(Ms,n.pushNotificationDeliveryOption,!0)&&J(cs,n.appleCriticalAlertOptions,!0)},gM=W(W({},uC),{message:void 0,mentionedMessageTemplate:void 0,translationTargetLanguages:void 0,pollId:void 0}),vM=function(n){return oC(n)&&J("string",n.mentionedMessageTemplate,!0)&&J("string",n.message,!0)&&tt("string",n.translationTargetLanguages,!0)&&J("number",n.pollId,!0)},X7=W({},uC),J7=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.token,s=e.limit,u=n.call(this)||this;return u.method=Ie.GET,u.path="".concat(Lt(i),"/").concat(encodeURIComponent(r),"/operators"),u.params={token:a,limit:s},u}return j(t,n),t}(Te),e8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.operators=r.operators.map(function(a){return new _t(e,a)}),i.token=r.next,i}return j(t,n),t}(Me),n8=function(n){function t(e,r,i,a){return n.call(this,e,r,i,a)||this}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,r=X.of(this._iid).requestQueue,i=new J7(W(W({},this),{channelUrl:this.channelUrl,token:this._token})),[4,r.send(i)]):[3,2]):[3,5];case 1:return a=h.sent(),s=a.as(e8),u=s.operators,d=s.token,this._token=d,this._hasNext=!!d,this._isLoading=!1,[2,u];case 2:return[2,e];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),t8=function(n){function t(e,r,i,a){var s,u,d,h,p,g,E,y,C,T,A=this;return(A=n.call(this,e,r,i,a)||this).reverse=!1,A.messageTypeFilter=Ni.ALL,A.customTypesFilter=null,A.senderUserIdsFilter=null,A.replyType=ti.NONE,A.includeMetaArray=!1,A.includeReactions=!1,A.includeParentMessageInfo=!1,A.includeThreadInfo=!1,A.showSubchannelMessagesOnly=!1,A._edge=Number.MAX_SAFE_INTEGER,A.reverse=(s=a.reverse)!==null&&s!==void 0&&s,A.messageTypeFilter=(u=a.messageTypeFilter)!==null&&u!==void 0?u:Ni.ALL,A.customTypesFilter=(d=a.customTypesFilter)!==null&&d!==void 0?d:null,A.senderUserIdsFilter=(h=a.senderUserIdsFilter)!==null&&h!==void 0?h:null,A.replyType=(p=a.replyType)!==null&&p!==void 0?p:ti.NONE,A.includeMetaArray=(g=a.includeMetaArray)!==null&&g!==void 0&&g,A.includeReactions=(E=a.includeReactions)!==null&&E!==void 0&&E,A.includeParentMessageInfo=(y=a.includeParentMessageInfo)!==null&&y!==void 0&&y,A.includeThreadInfo=(C=a.includeThreadInfo)!==null&&C!==void 0&&C,A.showSubchannelMessagesOnly=(T=a.showSubchannelMessagesOnly)!==null&&T!==void 0&&T,A}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("boolean",this.reverse)&&nt(Ni,this.messageTypeFilter)&&nt(ti,this.replyType)&&tt("string",this.customTypesFilter,!0)&&tt("string",this.senderUserIdsFilter,!0)&&J("boolean",this.includeMetaArray)&&J("boolean",this.includeReactions)&&J("boolean",this.includeParentMessageInfo)&&J("boolean",this.includeThreadInfo)&&J("boolean",this.showSubchannelMessagesOnly)},t.prototype.load=function(){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,ni.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,_n({prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly}))]):[3,2]:[3,5];case 1:return e=r.sent(),this._edge=Math.min.apply(Math,Nn([Number.MAX_SAFE_INTEGER],cn(e.map(function(i){return i.createdAt})),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),r8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.limit,u=e.token;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/mute"),r.params={limit:s,token:u},r}return j(t,n),t}(Te),i8=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.mutedUsers=[];var a=r.next,s=r.muted_list;return i.token=a,s&&s.length>0&&(i.mutedUsers=s.map(function(u){return new ud(e,u)})),i}return j(t,n),t}(Me),a8=function(n){function t(e,r,i,a){return n.call(this,e,r,i,a)||this}return j(t,n),t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new r8(W(W({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(i8),s=a.mutedUsers,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),s8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.limit,u=e.token;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/ban"),r.params=ze({limit:s,token:u}),r}return j(t,n),t}(Te),u8=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.bannedUsers=[];var a=r.next,s=r.banned_list;return i.token=a,s&&s.length>0&&(i.bannedUsers=s.map(function(u){return new ud(e,u.user)})),i}return j(t,n),t}(Me),o8=function(n){function t(e,r,i,a){return n.call(this,e,r,i,a)||this}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new s8(W(W({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(u8),s=a.bannedUsers,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu);(function(n){n.SPAM="spam",n.HARASSING="harassing",n.SUSPICIOUS="suspicious",n.INAPPROPRIATE="inappropriate"})(oh||(oh={}));var l8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.operatorUserIds;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/operators"),r.params={operator_ids:s},r}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var d8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.operatorUserIds;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/operators"),r.params={operator_ids:s},r}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var c8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/mute/").concat(s),r}return j(t,n),t}(Te),f8=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.isMuted=!1,i.startAt=0,i.endAt=0;var a=r.is_muted,s=r.start_at,u=r.end_at,d=r.remaining_duration,h=r.description;return i.isMuted=a,i.startAt=s,i.endAt=u,i.remainingDuration=d,i.description=h,i}return j(t,n),t}(Me),S1=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.keys;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={keys:s,include_ts:!0},r}return j(t,n),t}(Te),N1=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.metadata,s=r.ts;return i.metadata=a,i.ts=s,i}return j(t,n),t}(Me),h8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.metadata;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={metadata:s,include_ts:!0},r}return j(t,n),t}(Te),p8=function(n){function t(e,r){var i,a,s=this;return(s=n.call(this,e,r)||this).metaData=(i=r.metadata)!==null&&i!==void 0?i:{},s.ts=(a=r.ts)!==null&&a!==void 0?a:null,s}return j(t,n),t}(Me),_8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.metadata,u=e.upsert;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={metadata:s,include_ts:!0,upsert:u!=null&&u},r}return j(t,n),t}(Te),m8=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.metadata,s=r.ts;return i.metadata=a,i.ts=s,i}return j(t,n),t}(Me),EM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return i.data&&(a.created=i.data.created,a.updated=i.data.updated,a.deleted=i.data.deleted),a}return j(t,n),t}(dr),g8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.key;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metadata/").concat(s),r.params={include_ts:!0},r}return j(t,n),t}(Te),v8=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.ts;return i.ts=a,i}return j(t,n),t}(Me),E8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={include_ts:!0},r}return j(t,n),t}(Te),y8=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.ts;return i.ts=a,i}return j(t,n),t}(Me),A1=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.keys;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={keys:s},r}return j(t,n),t}(Te),w1=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metaCounter=r,i}return j(t,n),t}(Me),b8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.metaCounter;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={metacounter:s},r}return j(t,n),t}(Te),C8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metaCounter=r,i}return j(t,n),t}(Me),_E=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.metaCounter,u=e.upsert,d=u!==void 0&&u,h=e.mode,p=h===void 0?"set":h;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={metacounter:s,upsert:d,mode:p},r}return j(t,n),t}(Te),mE=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metaCounter=r,i}return j(t,n),t}(Me),yM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return i.data&&(a.created=i.data.created,a.updated=i.data.updated,a.deleted=i.data.deleted),a}return j(t,n),t}(dr),I8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.key;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metacounter/").concat(s),r.params={},r}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var T8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={},r}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var S8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId,u=e.seconds,d=e.description;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/mute"),r.params={user_id:s,seconds:u,description:d},r}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var bM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new ud(e,i.data),a}return j(t,n),t}(dr),N8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/mute/").concat(encodeURIComponent(s)),r}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var CM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new ud(e,i.data),a}return j(t,n),t}(dr),A8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId,u=e.seconds,d=e.description;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/ban"),r.params=ze({user_id:s,seconds:u,description:d}),r}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var IM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new ud(e,i.data),i.data.member_count&&(a.memberCount=i.data.member_count),i.data.joined_member_count&&(a.joinedMemberCount=i.data.joined_member_count),a}return j(t,n),t}(dr),w8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/ban/").concat(encodeURIComponent(s)),r}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var TM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new ud(e,i.data),a}return j(t,n),t}(dr),R1=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.freezing;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(Lt(a),"/").concat(encodeURIComponent(i),"/freeze"),r.params={freeze:s},r}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var SM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.freeze=i.data.freeze,a}return j(t,n),t}(dr),lC=function(n){return n instanceof cc?n._custom?"custom":n.name:n},dC=function(n){if(n instanceof cc&&n._custom)return n.name},R8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.category,u=e.userId,d=e.description;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(p2(a),"/").concat(encodeURIComponent(i)),r.params=ze({report_category:lC(s),reporting_user_id:u,report_description:d,custom_report_category_name:dC(s)}),r}return j(t,n),t}(Te),M8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.category,u=e.userId,d=e.offendingUserId,h=e.description;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(YE,"/users/").concat(d),r.params=ze({channel_url:i,channel_type:a===vt.OPEN?"open_channels":"group_channels",report_category:lC(s),reporting_user_id:u,report_description:h,custom_report_category_name:dC(s)}),r}return j(t,n),t}(Te),O8=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.category,u=e.userId,d=e.offendingUserId,h=e.messageId,p=e.description;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(p2(a),"/").concat(encodeURIComponent(i),"/messages/").concat(h),r.params=ze({report_category:lC(s),reporting_user_id:u,report_description:p,offending_user_id:d,custom_report_category_name:dC(s)}),r}return j(t,n),t}(Te),k8=function(n){function t(e){var r=[];return e.mentionType===wi.USERS&&(e.mentionedUserIds?r=e.mentionedUserIds:e.mentionedUsers&&(r=e.mentionedUsers.map(function(i){return i.userId}))),n.call(this,{code:"MESG",ackRequired:!0,payload:ze(_n({channel_url:e.channelUrl,message:e.message,data:e.data,custom_type:e.customType,metaarray:e.metaArrays,mention_type:e.mentionType,mentioned_user_ids:r,mentioned_message_template:e.mentionedMessageTemplate,target_langs:e.translationTargetLanguages,push_option:e.pushNotificationDeliveryOption&&e.pushNotificationDeliveryOption!==Ms.DEFAULT?e.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:e.appleCriticalAlertOptions,silent:e.silent,reply_to_channel:e.isReplyToChannel,parent_message_id:e.parentMessageId?e.parentMessageId:null,req_id:e.reqId,poll_id:e.pollId,pin_message:e.isPinnedMessage,extended_message_payload:e.extendedMessagePayload}))})||this}return j(t,n),t}(Ai),cC=function(n){function t(e,r,i){var a,s,u,d,h=this;(h=n.call(this,e,"MESG",i)||this).message=new Si(e,i);var p=X.of(e).sdkState;return h.isMentioned=_c(h.message.mentionType,(u=(a=h.message.mentionedUserIds)!==null&&a!==void 0?a:(s=h.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(g){return g.userId}))!==null&&u!==void 0?u:[],p.userId),h.forceUpdateLastMessage=(d=i.force_update_last_message)!==null&&d!==void 0&&d,h}return j(t,n),t}(dr),M1=function(n){function t(e){var r=null;return e.mentionType===wi.USERS&&(e.mentionedUserIds?r=e.mentionedUserIds:e.mentionedUsers&&(r=e.mentionedUsers.map(function(i){return i.userId}))),n.call(this,{code:"MEDI",ackRequired:!0,payload:ze(_n({channel_url:e.channelUrl,msg_id:e.messageId,message:e.message,data:e.data,custom_type:e.customType,metaarray:e.metaArrayParams,mention_type:e.mentionType,mentioned_user_ids:r,mentioned_message_template:e.mentionedMessageTemplate,apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,poll_id:e.pollId}))})||this}return j(t,n),t}(Ai),nm=function(n){function t(e,r,i){var a,s,u,d,h,p=this;(p=n.call(this,e,"MEDI",i)||this).message=new Si(e,i);var g=X.of(e).sdkState;return p.mentionCountChange=$b({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(u=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&u!==void 0?u:[]},_n({mentionType:p.message.mentionType,mentionedUserIds:(d=p.message.mentionedUserIds)!==null&&d!==void 0?d:(h=p.message.mentionedUsers)===null||h===void 0?void 0:h.map(function(E){return E.userId})}),g.userId),p}return j(t,n),t}(dr),O1=function(n){function t(e){var r=null;return e.mentionType===wi.USERS&&(e.mentionedUserIds?r=e.mentionedUserIds:e.mentionedUsers&&(r=e.mentionedUsers.map(function(i){return i.userId}))),n.call(this,{code:"FEDI",ackRequired:!0,payload:ze(_n({channel_url:e.channelUrl,msg_id:e.messageId,data:e.data,custom_type:e.customType,metaarray:e.metaArrayParams,mention_type:e.mentionType,mentioned_user_ids:r,apple_critical_alert_options:e.appleCriticalAlertOptions}))})||this}return j(t,n),t}(Ai),tm=function(n){function t(e,r,i){var a,s,u,d,h,p=this;(p=n.call(this,e,"FEDI",i)||this).message=new Wr(e,i);var g=X.of(e).sdkState;return p.mentionCountChange=$b({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(u=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&u!==void 0?u:[]},_n({mentionType:p.message.mentionType,mentionedUserIds:(d=p.message.mentionedUserIds)!==null&&d!==void 0?d:(h=p.message.mentionedUsers)===null||h===void 0?void 0:h.map(function(E){return E.userId})}),g.userId),p}return j(t,n),t}(dr),D8=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.reactionKey,u=n.call(this)||this;return u.method=Ie.POST,u.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/reactions"),u.params={reaction:s},u}return j(t,n),t}(Te),L8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.reactionEvent=new aC(r),i}return j(t,n),t}(Me),x8=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.reactionKey,u=n.call(this)||this;return u.method=Ie.DELETE,u.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/reactions"),u.params={reaction:s},u}return j(t,n),t}(Te),U8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.reactionEvent=new aC(W({},r)),i}return j(t,n),t}(Me),P8=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.translationTargetLanguages,u=n.call(this)||this;return u.method=Ie.POST,u.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(encodeURIComponent(a),"/translation"),u.params={target_langs:s},u}return j(t,n),t}(Te),F8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new Si(e,r),i}return j(t,n),t}(Me),H8=function(n){function t(e){var r,i=this;i=n.call(this)||this;var a=[];e.mentionType===wi.USERS&&(e.mentionedUserIds?a=e.mentionedUserIds:e.mentionedUsers&&(a=e.mentionedUsers.map(function(d){return d.userId})));var s=e.channelType,u=e.channelUrl;return i.method=Ie.POST,i.path="".concat(Lt(s),"/").concat(encodeURIComponent(u),"/scheduled_messages"),i.params=ze(_n({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:pc.USER,message:e.message,custom_type:e.customType,data:e.data,mention_type:e.mentionType,mentioned_user_ids:a,sorted_metaarray:(r=e.metaArrays)===null||r===void 0?void 0:r.map(function(d){return Vi.payloadify(d)}),apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,target_langs:e.translationTargetLanguages,push_option:e.pushNotificationDeliveryOption})),i}return j(t,n),t}(Te),NM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new Si(e,r),i}return j(t,n),t}(Me),B8=function(n){function t(e){var r,i,a=this;a=n.call(this)||this;var s=[];e.mentionType===wi.USERS&&(e.mentionedUserIds?s=e.mentionedUserIds:e.mentionedUsers&&(s=e.mentionedUsers.map(function(h){return h.userId})));var u=e.channelType,d=e.channelUrl;return a.method=Ie.POST,a.path="".concat(Lt(u),"/").concat(encodeURIComponent(d),"/scheduled_messages"),a.params=_n({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:pc.FILE,url:e.fileUrl,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,thumbnails:(r=e._thumbnails)===null||r===void 0?void 0:r.map(function(h){return ju.payloadify(h)}),custom_type:e.customType,data:e.data,require_auth:e.requireAuth,mention_type:e.mentionType,mentioned_user_ids:s,sorted_metaarray:(i=e.metaArrays)===null||i===void 0?void 0:i.map(function(h){return Vi.payloadify(h)}),apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,push_option:e.pushNotificationDeliveryOption}),a}return j(t,n),t}(Te),G8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new Wr(e,r),i}return j(t,n),t}(Me),V8=function(n){function t(e){var r=e.pollId,i=e.title,a=e.data,s=e.allowUserSuggestion,u=e.allowMultipleVotes,d=e.closeAt,h=n.call(this)||this;return h.method=Ie.PUT,h.path="".concat(ks,"/").concat(encodeURIComponent(r)),h.params={title:i,data:a,allow_user_suggestion:s,allow_multiple_votes:u,close_at:d},h}return j(t,n),t}(Te),j8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new ds(e,r),i}return j(t,n),t}(Me),q8=function(n){function t(e){var r=e.pollId,i=n.call(this)||this;return i.method=Ie.DELETE,i.path="".concat(ks,"/").concat(encodeURIComponent(r)),i}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var z8=function(n){function t(e){var r=e.pollId,i=n.call(this)||this;return i.method=Ie.PUT,i.path="".concat(ks,"/").concat(encodeURIComponent(r),"/close"),i}return j(t,n),t}(Te),K8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new ds(e,r),i}return j(t,n),t}(Me),W8=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.pollId,s=e.optionText,u=n.call(this)||this;return u.method=Ie.POST,u.path="".concat(ks,"/").concat(encodeURIComponent(a),"/options"),u.params={channel_url:r,channel_type:i,text:s},u}return j(t,n),t}(Te),$8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new ds(e,r),i}return j(t,n),t}(Me),Y8=function(n){function t(e){var r=e.pollId,i=e.pollOptionId,a=e.optionText,s=n.call(this)||this;return s.method=Ie.PUT,s.path="".concat(ks,"/").concat(encodeURIComponent(r),"/options/").concat(encodeURIComponent(i)),s.params={text:a},s}return j(t,n),t}(Te),Q8=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new ds(e,r),i}return j(t,n),t}(Me),Z8=function(n){function t(e){var r=e.pollId,i=e.pollOptionId,a=n.call(this)||this;return a.method=Ie.DELETE,a.path="".concat(ks,"/").concat(encodeURIComponent(r),"/options/").concat(encodeURIComponent(i)),a}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var X8=function(n){function t(e){var r=e.reqId,i=e.channelType,a=e.channelUrl,s=e.pollId,u=e.pollOptionIds;return n.call(this,{code:"VOTE",ackRequired:!0,payload:ze({req_id:r,channel_type:i===vt.OPEN?"open_channels":"group_channels",channel_url:a,poll_id:s,option_ids:u})})||this}return j(t,n),t}(Ai),fC=function(n){function t(e,r,i){var a=n.call(this,e,"VOTE",i)||this;return a.event=new m7(i),a.channelUrl=i.channel_url,a.channelType=i.channel_type,a}return j(t,n),t}(dr),AM=100,wM="GroupChannel",J8="url",RM=100,dy="Message",eH="messageId",MM="NotificationMessage",nH="notificationId",tH="Poll",rH="pollId",iH="FeedChannel",aH="url";function sH(n){var t,e,r;return(t=n.messageParams)!==null&&t!==void 0?t:_n(W(W({},n),{isReplyToChannel:!1,mentionedUserIds:(e=n.mentionedUserIds)!==null&&e!==void 0?e:(r=n.mentionedUsers)===null||r===void 0?void 0:r.map(function(i){return i.userId}),pushNotificationDeliveryOption:Ms.DEFAULT,isPinnedMessage:!1,fileInfoList:n.fileInfoList.map(function(i){var a;return{fileUrl:i.plainUrl,fileName:i.fileName,fileSize:i.fileSize,mimeType:i.mimeType,thumbnailSizes:(a=i.thumbnails)===null||a===void 0?void 0:a.map(function(s){return{maxWidth:s.width,maxHeight:s.height}}),_thumbnails:i.thumbnails,_uploadedMetaData:{requireAuth:i._requireAuth,isUploaded:!0}}})}))}var uH=W(W({},Lm),{fileInfoList:[],message:""}),oH=function(n){return(oi(n.file)||J("string",n.fileUrl))&&J("string",n.fileName,!0)&&J("string",n.mimeType,!0)&&J("number",n.fileSize,!0)&&(n.thumbnailSizes===void 0||Array.isArray(n.thumbnailSizes)&&n.thumbnailSizes.every(function(t){return t.maxWidth>0&&t.maxHeight>0}))},S_=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._onFileUploaded=Kn,e}return j(t,n),t.prototype._triggerOnFileUploaded=function(e,r,i,a){this._onFileUploaded(e,r,i,a)},t.prototype.onFileUploaded=function(e){return this._onFileUploaded=e,this},t.prototype.onPending=function(e){return n.prototype.onPending.call(this,e),this},t.prototype.onFailed=function(e){return n.prototype.onFailed.call(this,e),this},t.prototype.onSucceeded=function(e){return n.prototype.onSucceeded.call(this,e),this},t}(Ia),lH=function(n){function t(e,r){var i=n.call(this,e)||this;return i.message=null,i.message=Ri(e,r.message),i}return j(t,n),t}(Zr),dH=function(n){function t(e){var r=this,i=e.channelType,a=e.channelUrl,s=e.limit,u=e.token,d=e.includeReactions,h=e.includeMetaArray,p=e.includeParentMessageInfo,g=e.includeThreadInfo,E=e.includePollDetails;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(Lt(i),"/").concat(encodeURIComponent(a),"/pinned_messages"),r.params=ze({limit:s,token:u,include_reactions_summary:d,with_sorted_meta_array:h,include_thread_info:g,include_parent_message_info:p,include_poll_details:E}),r}return j(t,n),t}(Te),cH=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.pinned_messages,s=r.has_more,u=r.next;return i.pinnedMessages=a.map(function(d){return new lH(e,d)}),i.hasMore=s,i.token=u,i}return j(t,n),t}(Me),fH=function(n){function t(e,r,i,a){var s=n.call(this,e,r,i,a)||this;return s.includeMetaArray=a.includeMetaArray,s.includeReactions=a.includeReactions,s.includeParentMessageInfo=a.includeParentMessageInfo,s.includeThreadInfo=a.includeThreadInfo,s.includePollDetails=a.includePollDetails,s}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("boolean",this.includeMetaArray,!0)&&J("boolean",this.includeReactions,!0)&&J("boolean",this.includeParentMessageInfo,!0)&&J("boolean",this.includeThreadInfo,!0)&&J("boolean",this.includePollDetails,!0)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new dH(W(W({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=h.sent(),a=i.as(cH),s=a.pinnedMessages,u=a.hasMore,d=a.token,this._token=d,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),hH=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=n.call(this)||this;return s.method=Ie.POST,s.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/pin"),s}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var pH=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=n.call(this)||this;return s.method=Ie.DELETE,s.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/pin"),s}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var Ii,_H=2;(function(n){n.SEND="send",n.RESEND="resend",n.COPY="copy"})(Ii||(Ii={}));var yr,rm=function(n){function t(e,r){var i,a,s,u,d,h,p,g=this;return(g=n.call(this,e)||this)._name="",g._createdAt=0,g.pinnedMessageIds=[],g.channelType=vt.BASE,g.coverUrl="",g.customType="",g.data="",g.isFrozen=!1,g.isEphemeral=!1,g.creator=null,g._messageCollectionLastAccessedAt=0,g._url=r.channel_url,g._name=(i=r.name)!==null&&i!==void 0?i:"",g._createdAt=1e3*r.created_at,g.coverUrl=(a=r.cover_url)!==null&&a!==void 0?a:"",g.customType=(s=r.custom_type)!==null&&s!==void 0?s:"",g.data=(u=r.data)!==null&&u!==void 0?u:"",g.isFrozen=(d=r.freeze)!==null&&d!==void 0&&d,g.isEphemeral=(h=r.is_ephemeral)!==null&&h!==void 0&&h,g.creator=r.created_by?new _t(g._iid,r.created_by):null,r.metadata&&Object.keys(r.metadata).length>0&&r.ts?(g._cachedMetaData=new Map,Object.keys(r.metadata).forEach(function(E){g._cachedMetaData.set(E,{value:r.metadata[E],isRemoved:!1,updatedAt:r.ts})})):typeof r.metadata=="string"&&(g._cachedMetaData=new Map(Object.entries(JSON.parse(r.metadata)))),g.pinnedMessageIds=(p=r.pinned_message_ids)!==null&&p!==void 0?p:[],g}return j(t,n),Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return W(W({},this),{url:this._url,name:this._name,createdAt:this._createdAt})},t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{channel_url:e.url,name:e.name,cover_url:e.coverUrl,custom_type:e.customType,data:e.data,freeze:e.isFrozen,is_ephemeral:e.isEphemeral,created_by:e.creator?_t.payloadify(e.creator):null,created_at:e.createdAt/1e3,metadata:e.cachedMetaData,pinned_message_ids:e.pinnedMessageIds})))},t.prototype.isGroupChannel=function(){return this.channelType===vt.GROUP},t.prototype.isOpenChannel=function(){return this.channelType===vt.OPEN},t.prototype.isFeedChannel=function(){return this.channelType===vt.FEED},Object.defineProperty(t.prototype,"cachedMetaData",{get:function(){var e={};return this._cachedMetaData&&this._cachedMetaData.forEach(function(r,i){r.isRemoved||(e[i]=r.value)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messageCollectionLastAccessedAt",{get:function(){return this._messageCollectionLastAccessedAt},enumerable:!1,configurable:!0}),t.prototype._serializeCachedMetaData=function(){return this._cachedMetaData?{cachedMetaData:JSON.stringify(Object.fromEntries(this._cachedMetaData))}:{}},t.prototype._updateMessageCollectionLastAccessedAt=function(){this._messageCollectionLastAccessedAt=Date.now()},t.prototype._update=function(e){var r=ze(e);Object.assign(this,r)},t.prototype._upsertCachedMetaData=function(e,r){var i=this;Object.keys(e).forEach(function(a){i._cachedMetaData||(i._cachedMetaData=new Map);var s=i._cachedMetaData.get(a);(!s||s.updatedAt<=r)&&i._cachedMetaData.set(a,{value:e[a],isRemoved:!1,updatedAt:r})})},t.prototype._updateCachedMetaData=function(e,r){var i=this,a=!1;return this._cachedMetaData?this._cachedMetaData.forEach(function(s,u){var d;s.updatedAt<=r&&(i._cachedMetaData.set(u,{value:(d=e[u])!==null&&d!==void 0?d:s.value,isRemoved:!e[u],updatedAt:r}),a=!0)}):(this._cachedMetaData=new Map,Object.keys(e).forEach(function(s){i._cachedMetaData.set(s,{value:e[s],isRemoved:!1,updatedAt:r})}),a=!0),{isUpdated:a}},t.prototype._removeFromCachedMetaData=function(e,r){var i=this;this._cachedMetaData&&e.forEach(function(a){var s=i._cachedMetaData.get(a);s&&s.updatedAt<r&&(s.isRemoved=!0,s.updatedAt=r)})},t.prototype._clearCachedMetaData=function(){this._cachedMetaData&&this._cachedMetaData.clear()},t.prototype._runIfHandleableWithGroupChannel=function(e){this.isGroupChannel()?e(this):this.isFeedChannel()&&e(this.groupChannel)},t.prototype._generateRequestId=function(){return"rq-".concat(Bu())},t.prototype.isIdentical=function(e){return e&&this.url===e.url},t.prototype.isEqual=function(e){return u2(this,e)},t.prototype.createOperatorListQuery=function(e){return e===void 0&&(e={}),new n8(this._iid,this.url,this.channelType,e)},t.prototype.createMutedUserListQuery=function(e){return e===void 0&&(e={}),new a8(this._iid,this.url,this.channelType,e)},t.prototype.createBannedUserListQuery=function(e){return e===void 0&&(e={}),new o8(this._iid,this.url,this.channelType,e)},t.prototype.createPreviousMessageListQuery=function(e){return e===void 0&&(e={}),new t8(this._iid,this.url,this.channelType,e)},t.prototype.createPinnedMessageListQuery=function(e){return e===void 0&&(e={}),new fH(this._iid,this.url,this.channelType,e)},t.prototype.addOperators=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return Se(tt("string",e)).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new l8({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.removeOperators=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return Se(tt("string",e)).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new d8({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.getMyMutedInfo=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p,g,E;return R(this,function(y){switch(y.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new c8({channelUrl:this.url,channelType:this.channelType,userId:r.userId}),[4,i.send(a)];case 1:return s=y.sent(),u=s.as(f8),d=u.isMuted,h=u.startAt,p=u.endAt,g=u.remainingDuration,E=u.description,[2,{isMuted:d,startAt:h,endAt:p,remainingDuration:g,description:E}]}})})},t.prototype.getMetaData=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return Se(tt("string",e)).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new S1({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,r.send(i)];case 1:return a=h.sent(),s=a.as(N1),u=s.metadata,d=s.ts,this._upsertCachedMetaData(u,d),[2,u]}})})},t.prototype.getAllMetaData=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return e=X.of(this._iid).requestQueue,r=new S1({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(r)];case 1:return i=d.sent(),a=i.as(N1),s=a.metadata,u=a.ts,this._updateCachedMetaData(s,u),[2,s]}})})},t.prototype.createMetaData=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return r=X.of(this._iid).requestQueue,i=new h8({channelUrl:this.url,channelType:this.channelType,metadata:e}),[4,r.send(i)];case 1:return a=u.sent(),s=a.as(p8).metaData,this._upsertCachedMetaData(s,0),[2,s]}})})},t.prototype.updateMetaData=function(e,r){return r===void 0&&(r=!1),M(this,void 0,void 0,function(){var i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return i=X.of(this._iid).requestQueue,a=new _8({channelUrl:this.url,channelType:this.channelType,metadata:e,upsert:r}),[4,i.send(a)];case 1:return s=p.sent(),u=s.as(m8),d=u.metadata,h=u.ts,this._upsertCachedMetaData(d,h),[2,d]}})})},t.prototype.deleteMetaData=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(J("string",e)).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new g8({channelUrl:this.url,channelType:this.channelType,key:e}),[4,r.send(i)];case 1:return a=u.sent(),s=a.as(v8).ts,this._removeFromCachedMetaData([e],s),[2]}})})},t.prototype.deleteAllMetaData=function(){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return e=X.of(this._iid).requestQueue,r=new E8({channelUrl:this.url,channelType:this.channelType}),[4,e.send(r)];case 1:return i=s.sent(),a=i.as(y8).ts,this._removeFromCachedMetaData(Nn([],cn(this._cachedMetaData.keys()),!1),a),[2]}})})},t.prototype.getMetaCounters=function(e){return M(this,void 0,void 0,function(){var r,i,a;return R(this,function(s){switch(s.label){case 0:return Se(tt("string",e)).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new A1({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(w1).metaCounter]}})})},t.prototype.getAllMetaCounters=function(){return M(this,void 0,void 0,function(){var e,r,i;return R(this,function(a){switch(a.label){case 0:return e=X.of(this._iid).requestQueue,r=new A1({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(r)];case 1:return i=a.sent(),[2,i.as(w1).metaCounter]}})})},t.prototype.createMetaCounters=function(e){return M(this,void 0,void 0,function(){var r,i,a;return R(this,function(s){switch(s.label){case 0:return r=X.of(this._iid).requestQueue,i=new b8({channelUrl:this.url,channelType:this.channelType,metaCounter:e}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(C8).metaCounter]}})})},t.prototype.updateMetaCounters=function(e,r){return r===void 0&&(r=!1),M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return i=X.of(this._iid).requestQueue,a=new _E({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:r}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(mE).metaCounter]}})})},t.prototype.increaseMetaCounters=function(e){return M(this,void 0,void 0,function(){var r,i,a;return R(this,function(s){switch(s.label){case 0:return r=X.of(this._iid).requestQueue,i=new _E({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"increase"}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(mE).metaCounter]}})})},t.prototype.decreaseMetaCounters=function(e){return M(this,void 0,void 0,function(){var r,i,a;return R(this,function(s){switch(s.label){case 0:return r=X.of(this._iid).requestQueue,i=new _E({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"decrease"}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(mE).metaCounter]}})})},t.prototype.deleteMetaCounter=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return Se(J("string",e)).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new I8({channelUrl:this.url,channelType:this.channelType,key:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.deleteAllMetaCounters=function(){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=X.of(this._iid).requestQueue,r=new T8({channelUrl:this.url,channelType:this.channelType}),[4,e.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.muteUser=function(e,r,i){return M(this,void 0,void 0,function(){return R(this,function(a){return[2,this.muteUserWithUserId(e.userId,r,i)]})})},t.prototype.muteUserWithUserId=function(e,r,i){return M(this,void 0,void 0,function(){var a,s;return R(this,function(u){switch(u.label){case 0:return Se(J("string",e)&&J("number",r,!0)&&J("string",i,!0)).throw(ee.invalidParameters),a=X.of(this._iid).requestQueue,s=new S8({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:r,description:i}),[4,a.send(s)];case 1:return u.sent(),[2]}})})},t.prototype.unmuteUser=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2,this.unmuteUserWithUserId(e.userId)]})})},t.prototype.unmuteUserWithUserId=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return Se(J("string",e)).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new N8({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.banUser=function(e,r,i){return M(this,void 0,void 0,function(){return R(this,function(a){return[2,this.banUserWithUserId(e.userId,r,i)]})})},t.prototype.banUserWithUserId=function(e,r,i){return M(this,void 0,void 0,function(){var a,s;return R(this,function(u){switch(u.label){case 0:return Se(J("string",e)&&J("number",r,!0)&&J("string",i,!0)).throw(ee.invalidParameters),a=X.of(this._iid).requestQueue,s=new A8({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:r,description:i}),[4,a.send(s)];case 1:return u.sent(),[2]}})})},t.prototype.unbanUser=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2,this.unbanUserWithUserId(e.userId)]})})},t.prototype.unbanUserWithUserId=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return Se(J("string",e)).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new w8({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.freeze=function(){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=X.of(this._iid).requestQueue,r=new R1({channelUrl:this.url,channelType:this.channelType,freezing:!0}),[4,e.send(r)];case 1:return i.sent(),this.isFrozen=!0,[2]}})})},t.prototype.unfreeze=function(){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=X.of(this._iid).requestQueue,r=new R1({channelUrl:this.url,channelType:this.channelType,freezing:!1}),[4,e.send(r)];case 1:return i.sent(),this.isFrozen=!1,[2]}})})},t.prototype.getMessagesByMessageId=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},uh),r),Se(J("number",e)&&v1(i)).throw(ee.invalidParameters),[4,ni.of(this._iid).getMessagesByMessageId(this.url,this.channelType,e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getMessagesByTimestamp=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},uh),r),Se(J("number",e)&&v1(i)).throw(ee.invalidParameters),[4,ni.of(this._iid).getMessagesByTimestamp(this.url,this.channelType,e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getMessageChangeLogsSinceTimestamp=function(e,r){return r===void 0&&(r={}),M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},uy),r),Se(J("number",e)&&E1(i)).throw(ee.invalidParameters),[4,ni.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getMessageChangeLogsSinceToken=function(e,r){return r===void 0&&(r={}),M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},uy),r),Se(J("string",e)&&E1(i)).throw(ee.invalidParameters),[4,ni.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,i)];case 1:return[2,a.sent()]}})})},t.prototype._createPendingSendableMessagePayload=function(e,r,i){var a,s=X.of(this._iid).sessionManager;return ze(_n({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:e.parentMessageId,data:e.data,custom_type:e.customType,mention_type:e.mentionType,sorted_metaarray:e.metaArrays?e.metaArrays.map(function(u){return Vi.payloadify(u)}):null,apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,created_at:i,user:s.currentUser?Ec.payloadify(s.currentUser):null,req_id:r,request_state:jt.PENDING,mentioned_user_ids:e.mentionedUserIds,mentioned_users:(a=e.mentionedUsers)===null||a===void 0?void 0:a.map(function(u){return _t.payloadify(u)})}))},t.prototype._createPendingUserMessage=function(e,r,i){var a,s,u={};if(e.translationTargetLanguages)try{for(var d=Le(e.translationTargetLanguages),h=d.next();!h.done;h=d.next())u[h.value]=""}catch(E){a={error:E}}finally{try{h&&!h.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}var p=ze(W(W({},this._createPendingSendableMessagePayload(e,r,i)),{type:Rr.USER,message:e.message,translations:u,extended_message_payload:e.extendedMessagePayload})),g=new Si(this._iid,p);return g.messageParams=e,g},t.prototype._createPendingScheduledUserMessage=function(e,r,i){var a=this._createPendingUserMessage(e,r,i);return a.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},a},t.prototype._createPendingFileMessage=function(e,r,i){var a,s,u,d,h,p,g,E=ze(W(W({},this._createPendingSendableMessagePayload(e,r,i)),{type:Rr.FILE,url:e.fileUrl,file:{name:(a=e.fileName)!==null&&a!==void 0?a:(s=e.file)===null||s===void 0?void 0:s.name,size:(u=e.fileSize)!==null&&u!==void 0?u:(d=e.file)===null||d===void 0?void 0:d.size,type:(h=e.mimeType)!==null&&h!==void 0?h:(p=e.file)===null||p===void 0?void 0:p.type,data:e.data},thumbnails:(g=e._thumbnails)===null||g===void 0?void 0:g.map(function(C){return ju.payloadify(C)}),message:e.message})),y=new Wr(this._iid,E);return y.messageParams=e,y},t.prototype._createPendingMultipleFilesMessage=function(e,r,i){var a=ze(W(W({},this._createPendingSendableMessagePayload(e,r,i)),{type:Rr.FILE,file:e.fileInfoList.length>0?{name:e.fileInfoList[0].fileName,size:e.fileInfoList[0].fileSize,type:e.fileInfoList[0].mimeType,data:e.data}:void 0,message:e.message})),s=new Wa(this._iid,a);return s.messageParams=e,s},t.prototype._validateFailedFileMessageHasFile=function(e,r){var i;return!!e.url||oi(r)||oi((i=e.messageParams)===null||i===void 0?void 0:i.file)},t.prototype._createPendingScheduledFileMessage=function(e,r,i){var a=this._createPendingFileMessage(e,r,i);return a.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},a},t.prototype._markMessageAsFailed=function(e,r,i){i===void 0&&(i=!1),e.errorCode=r.code,r.code===rn.REQUEST_CANCELED||r.code===rn.FILE_UPLOAD_CANCEL_FAILED?e.sendingStatus=jt.CANCELED:i||(e.sendingStatus=jt.FAILED)},t.prototype.sendUserMessage=function(e){var r=W(W({},hM),e);return Se(_M(r)).throw(ee.invalidParameters),this._sendUserMessage(r)},t.prototype._sendUserMessage=function(e,r,i){var a=this;r===void 0&&(r=Ii.SEND);var s=X.of(this._iid),u=s.dispatcher,d=s.requestQueue,h=i??this._generateRequestId(),p=Date.now(),g=new Ia;return sa(2).then(function(){var E=a._createPendingUserMessage(e,h,p);u.dispatch(new mr({messages:[E],source:r===Ii.RESEND?ge.LOCAL_MESSAGE_RESEND_STARTED:ge.EVENT_MESSAGE_SENT_PENDING})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(C){return[2,g._trigger(E)]})})});var y=new k8(W(W({},e),{channelUrl:a.url,channelType:a.channelType,reqId:h}));d.send(y).then(function(C){var T=C.as(cC).message;u.dispatch(new mr({messages:[T],source:ge.EVENT_MESSAGE_SENT_SUCCESS})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(A){return[2,g._trigger(T)]})})})}).catch(function(C){if(Gi(C))throw C;sa(2).then(function(){var T=a._createPendingUserMessage(e,h,p),A=X.of(a._iid).cacheContext,O=A.localCacheEnabled&&A.localCacheConfig.enableAutoResend&&B_(C.code);a._markMessageAsFailed(T,C,O),u.dispatch(new mr({messages:[T],source:T.sendingStatus===jt.PENDING?ge.REQUEST_RESEND_MESSAGE:ge.EVENT_MESSAGE_SENT_FAILED})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(N){return[2,g._triggerFailed(C,T)]})})})})})}),g},t.prototype._autoResendUserMessage=function(e){return Se(e instanceof Si&&!!e.messageParams).throw(ee.invalidParameters),this._sendUserMessage(e.messageParams,Ii.SEND,e.reqId)},t.prototype.resendUserMessage=function(e){var r;return M(this,void 0,void 0,function(){var i,a;return R(this,function(s){return Se(e instanceof Si&&!e.scheduledInfo).throw(ee.invalidParameters),i=new Qi,a=(r=e.messageParams)!==null&&r!==void 0?r:oy(e),this._sendUserMessage(a,Ii.RESEND,e.reqId).onFailed(function(u){return i.reject(u)}).onSucceeded(function(u){return i.resolve(u)}),[2,i.promise]})})},t.prototype.updateUserMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u;return R(this,function(d){switch(d.label){case 0:return i=W(W({},gM),r),Se(J("number",e)&&vM(i)).throw(ee.invalidParameters),a=X.of(this._iid).requestQueue,s=new M1(W({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:i.metaArrays?{array:i.metaArrays,mode:"add",upsert:!0}:void 0},i)),[4,a.send(s)];case 1:return u=d.sent(),[2,u.as(nm).message]}})})},t.prototype.copyUserMessage=function(e,r){var i,a,s;return M(this,void 0,void 0,function(){var u,d;return R(this,function(h){return Se(e instanceof t&&r instanceof Si&&r.sendingStatus===jt.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(ee.invalidParameters),Se(!r.poll).throw(ee.notSupportedError),u=new Qi,d=(i=r.messageParams)!==null&&i!==void 0?i:_n(W(W({},r),{mentionType:r.mentionType,mentionedUserIds:(a=r.mentionedUserIds)!==null&&a!==void 0?a:(s=r.mentionedUsers)===null||s===void 0?void 0:s.map(function(p){return p.userId}),translationTargetLanguages:Object.keys(r.translations),pushNotificationDeliveryOption:Ms.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1})),e._sendUserMessage(d).onSucceeded(function(p){u.resolve(p)}).onFailed(function(p){return u.reject(p)}),[2,u.promise]})})},t.prototype.translateUserMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(e instanceof Si&&e.messageId>0&&tt("string",r)).throw(ee.invalidParameters),i=X.of(this._iid).requestQueue,a=new P8({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,translationTargetLanguages:r}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(F8).message]}})})},t.prototype._createScheduledUserMessage=function(e,r){var i=this,a=X.of(this._iid).requestQueue,s=Date.now(),u=this._generateRequestId();sa(2).then(function(){var h=i._createPendingScheduledUserMessage(e,u,s);an(function(){return M(i,void 0,void 0,function(){return R(this,function(p){return[2,r._trigger(h)]})})})});var d=new H8(W({reqId:u,channelType:this.channelType,channelUrl:this.url},e));a.send(d).then(function(h){var p=h.as(NM).message;an(function(){return M(i,void 0,void 0,function(){return R(this,function(g){return[2,r._trigger(p)]})})})}).catch(function(h){if(Gi(h))throw h;sa(2).then(function(){var p=i._createPendingScheduledUserMessage(e,u,s);i._markMessageAsFailed(p,h),an(function(){return M(i,void 0,void 0,function(){return R(this,function(g){return[2,r._triggerFailed(h,p)]})})})})})},t.prototype.sendFileMessage=function(e){var r=W(W({},I1),e);return Se(T1(r)).throw(ee.invalidParameters),this._sendFileMessage(r)},t.prototype.sendMultipleFilesMessage=function(e){var r,i=W(W({},uH),e),a=X.of(this._iid);Se(function(u,d){return d===void 0&&(d=zF),xm(u)&&J("string",u.message,!0)&&Array.isArray(u.fileInfoList)&&u.fileInfoList.length>=2&&u.fileInfoList.length<=d&&u.fileInfoList.every(function(h){return oH(h)})}(i,(r=a.appInfo)===null||r===void 0?void 0:r.multipleFilesMessageFileCountLimit)).throw(ee.invalidParameters);var s=!!e.fileInfoList.find(function(u){var d=a.appInfo.uploadSizeLimit;return u.file instanceof Blob&&u.file.size>d||u.fileSize>d});return Se(!s).throw(ee.fileSizeLimitExceededError),this._sendMultipleFilesMessage(i)},t.prototype._sendFileMessage=function(e,r,i){var a=this;r===void 0&&(r=Ii.SEND);var s=X.of(this._iid).dispatcher,u=ni.of(this._iid).fileMessageQueue,d=i??this._generateRequestId(),h=Date.now(),p=new Ia;return sa(2).then(function(){var g=a._createPendingFileMessage(e,d,h);s.dispatch(new mr({messages:[g],source:r===Ii.RESEND?ge.LOCAL_MESSAGE_RESEND_STARTED:ge.EVENT_MESSAGE_SENT_PENDING})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(E){return[2,p._trigger(g)]})})}),u.request(a,d,e).then(function(E){s.dispatch(new mr({messages:[E],source:ge.EVENT_MESSAGE_SENT_SUCCESS})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(y){return[2,p._trigger(E)]})})})}).catch(function(E){if(Gi(E))throw E;sa(2).then(function(){var y=a._createPendingFileMessage(e,d,h),C=X.of(a._iid).cacheContext,T=C.localCacheEnabled&&C.localCacheConfig.enableAutoResend&&B_(E.code);a._markMessageAsFailed(y,E,T),s.dispatch(new mr({messages:[y],source:y.sendingStatus===jt.PENDING?ge.REQUEST_RESEND_MESSAGE:E.code===rn.FILE_UPLOAD_CANCEL_FAILED?ge.LOCAL_MESSAGE_CANCELED:ge.EVENT_MESSAGE_SENT_FAILED})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(A){return[2,p._triggerFailed(E,y)]})})})})})}),p},t.prototype._autoResendFileMessage=function(e){Se(e instanceof Wr&&!!e.messageParams).throw(ee.invalidParameters);var r=X.of(this._iid).logger;return r.debug("autoResendFileMessage pending",e),this._sendFileMessage(e.messageParams,Ii.SEND,e.reqId).onFailed(function(i){r.debug("autoResendFileMessage failed",i)}).onSucceeded(function(i){r.debug("autoResendFileMessage success",i)})},t.prototype._sendMultipleFilesMessage=function(e,r,i){var a=this,s=X.of(this._iid).dispatcher,u=ni.of(this._iid).fileMessageQueue,d=i??this._generateRequestId(),h=Date.now(),p=new S_;return sa(2).then(function(){var g=a._createPendingMultipleFilesMessage(e,d,h);s.dispatch(new mr({messages:[g],source:r===Ii.RESEND?ge.LOCAL_MESSAGE_RESEND_STARTED:ge.EVENT_MESSAGE_SENT_PENDING})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(E){return[2,p._trigger(g)]})})}),u.request(a,d,e,{requestHandler:p,isCopy:r===Ii.COPY}).then(function(E){s.dispatch(new mr({messages:[E],source:ge.EVENT_MESSAGE_SENT_SUCCESS})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(y){return[2,p._trigger(E)]})})})}).catch(function(E){if(Gi(E))throw E;sa(2).then(function(){var y=a._createPendingMultipleFilesMessage(e,d,h);a._markMessageAsFailed(y,E),s.dispatch(new mr({messages:[y],source:ge.EVENT_MESSAGE_SENT_FAILED})),an(function(){return M(a,void 0,void 0,function(){return R(this,function(C){return[2,p._triggerFailed(E,y)]})})})})})}),p},t.prototype._createScheduledFileMessage=function(e,r,i,a){var s=this,u=X.of(this._iid).requestQueue,d=new B8(W(W({reqId:i,channelType:this.channelType,channelUrl:this.url},e),{fileUrl:e.fileUrl,requireAuth:e.requireAuth}));u.send(d).then(function(h){var p=h.as(G8).message;an(function(){return M(s,void 0,void 0,function(){return R(this,function(g){return[2,r._trigger(p)]})})})}).catch(function(h){if(Gi(h))throw h;sa(2).then(function(){var p=s._createPendingScheduledFileMessage(e,i,a);s._markMessageAsFailed(p,h),an(function(){return M(s,void 0,void 0,function(){return R(this,function(g){return[2,r._triggerFailed(h,p)]})})})})})},t.prototype.sendFileMessages=function(e){var r,i;Se(e.every(function(h){return T1(W(W({},I1),h))})).throw(ee.invalidParameters);var a=new Ia;try{for(var s=Le(e),u=s.next();!u.done;u=s.next()){var d=u.value;this.sendFileMessage(d).onPending(function(h){return a._trigger(h)}).onFailed(function(h,p){return a._triggerFailed(h,p)}).onSucceeded(function(h){return a._trigger(h)})}}catch(h){r={error:h}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a},t.prototype.resendFileMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){return i=this._validateFailedFileMessageHasFile(e,r),Se(e instanceof Wr&&i&&!e.scheduledInfo).throw(ee.invalidParameters),a=new Qi,s=ly(e,r),this._sendFileMessage(s,Ii.RESEND,e.reqId).onFailed(function(d){return a.reject(d)}).onSucceeded(function(d){return a.resolve(d)}),[2,a.promise]})})},t.prototype.resendMessage=function(e,r){var i,a;if(Se(e instanceof Lr&&!e.scheduledInfo&&e.isResendable).throw(ee.invalidParameters),e.isUserMessage()){var s=(i=e.messageParams)!==null&&i!==void 0?i:oy(e);return this._sendUserMessage(s,Ii.RESEND,e.reqId)}if(e.isFileMessage()){var u=this._validateFailedFileMessageHasFile(e,r);return Se(u).throw(ee.invalidParameters),s=(a=e.messageParams)!==null&&a!==void 0?a:ly(e,r),this._sendFileMessage(s,Ii.RESEND,e.reqId)}if(e.isMultipleFilesMessage())throw ee.channelTypeNotSupportedError},t.prototype.updateFileMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u;return R(this,function(d){switch(d.label){case 0:return i=W(W({},X7),r),Se(J("number",e)&&function(h){return oC(h)}(i)).throw(ee.invalidParameters),a=X.of(this._iid).requestQueue,s=new O1(W({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:i.metaArrays?{array:i.metaArrays,mode:"add",upsert:!0}:void 0},i)),[4,a.send(s)];case 1:return u=d.sent(),[2,u.as(tm).message]}})})},t.prototype.uploadFile=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return r=X.of(this._iid).requestQueue,i=Bu(),(a=new Z_({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:i})).uploadProgressHandler=e.progressHandler,e.uploadStartedHandler&&e.uploadStartedHandler(i),[4,r.send(a)];case 1:return s=p.sent(),u=s.as(X_),d=u.url,h=u.thumbnails,[2,{requestId:i,url:d,thumbnails:h}]}})})},t.prototype.cancelUploadingFileMessage=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return Se(J("string",e)).throw(ee.invalidParameters),ni.of(this._iid).fileMessageQueue.cancel(this,e),[2,!0]})})},t.prototype.copyFileMessage=function(e,r){var i,a,s;return M(this,void 0,void 0,function(){var u,d;return R(this,function(h){return Se(e instanceof t&&r instanceof Wr&&r.sendingStatus===jt.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(ee.invalidParameters),u=new Qi,d=_n(W(W({},r),{fileUrl:r.url,fileName:r.name,fileSize:r.size,mimeType:r.type,mentionType:r.mentionType,mentionedUserIds:(i=r.mentionedUserIds)!==null&&i!==void 0?i:(a=r.mentionedUsers)===null||a===void 0?void 0:a.map(function(p){return p.userId}),pushNotificationDeliveryOption:Ms.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:(s=r.thumbnails)===null||s===void 0?void 0:s.map(function(p){return{maxWidth:p.width,maxHeight:p.height}}),requireAuth:r.requireAuth,isPinnedMessage:!1})),e._sendFileMessage(d).onSucceeded(function(p){return u.resolve(p)}).onFailed(function(p){return u.reject(p)}),[2,u.promise]})})},t.prototype.copyMessage=function(e,r){Se(e instanceof t&&r instanceof Lr&&r.sendingStatus===jt.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(ee.invalidParameters);var i=r,a=e;if(i.isUserMessage()){Se(!i.poll).throw(ee.notSupportedError);var s=pM(i);return a._sendUserMessage(s)}if(i.isFileMessage())return s=mM(i),a._sendFileMessage(s);if(r.isMultipleFilesMessage())throw ee.channelTypeNotSupportedError},t.prototype.deleteMessage=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return Se(e instanceof Hi).throw(ee.invalidParameters),e.messageId>0?(r=X.of(this._iid).requestQueue,i=new g2({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,messageToken:e instanceof Lr?e._messageToken:void 0}),[4,r.send(i)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},t.prototype.addReaction=function(e,r){return M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(e instanceof Hi&&e.messageId>0&&J("string",r)).throw(ee.invalidParameters),i=X.of(this._iid).requestQueue,a=new D8({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:r}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(L8).reactionEvent]}})})},t.prototype.deleteReaction=function(e,r){return M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(e instanceof Hi&&e.messageId>0&&J("string",r)).throw(ee.invalidParameters),i=X.of(this._iid).requestQueue,a=new x8({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:r}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(U8).reactionEvent]}})})},t.prototype._updateUserMessageMetaArray=function(e,r,i,a){return M(this,void 0,void 0,function(){var s,u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:return s=X.of(this._iid),u=s.dispatcher,d=s.requestQueue,h=new M1({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:r,mode:i,upsert:a}}),[4,d.send(h)];case 1:return p=E.sent(),g=p.as(nm).message,u.dispatch(new mr({messages:[g],source:ge.EVENT_MESSAGE_UPDATED})),[2,g]}})})},t.prototype._updateFileMessageMetaArray=function(e,r,i,a){return M(this,void 0,void 0,function(){var s,u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:return s=X.of(this._iid),u=s.dispatcher,d=s.requestQueue,h=new O1({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:r,mode:i,upsert:a}}),[4,d.send(h)];case 1:return p=E.sent(),g=p.as(tm).message,u.dispatch(new mr({messages:[g],source:ge.EVENT_MESSAGE_UPDATED})),[2,g]}})})},t.prototype.createMessageMetaArrayKeys=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){return Se(e instanceof Hi&&e.messageId>0&&tt("string",r)).throw(ee.invalidParameters),i=r.map(function(s){return new Vi({key:s})}),e instanceof Wr?[2,this._updateFileMessageMetaArray(e.messageId,i,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,i,"add",!0)]})})},t.prototype.deleteMessageMetaArrayKeys=function(e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){return Se(e instanceof Hi&&e.messageId>0&&tt("string",r)).throw(ee.invalidParameters),i=r.map(function(s){return new Vi({key:s})}),e instanceof Wr?[2,this._updateFileMessageMetaArray(e.messageId,i,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,i,"remove",!0)]})})},t.prototype.addMessageMetaArrayValues=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){return Se(e instanceof Hi&&e.messageId>0&&r.every(function(a){return a instanceof Vi})).throw(ee.invalidParameters),e instanceof Wr?[2,this._updateFileMessageMetaArray(e.messageId,r,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,r,"add",!0)]})})},t.prototype.removeMessageMetaArrayValues=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){return Se(e instanceof Hi&&e.messageId>0&&r.every(function(a){return a instanceof Vi})).throw(ee.invalidParameters),e instanceof Wr?[2,this._updateFileMessageMetaArray(e.messageId,r,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,r,"remove",!0)]})})},t.prototype.report=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u;return R(this,function(d){switch(d.label){case 0:return Se((nt(oh,e)||e instanceof cc)&&J("string",r)).throw(ee.invalidParameters),i=X.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new R8({channelUrl:this.url,channelType:this.channelType,userId:a.userId,category:e,description:r}),[4,s.send(u)];case 1:return d.sent(),[2]}})})},t.prototype.reportUser=function(e,r,i){return M(this,void 0,void 0,function(){var a,s,u,d;return R(this,function(h){switch(h.label){case 0:return Se(e instanceof _t&&(nt(oh,r)||r instanceof cc)&&J("string",i)).throw(ee.invalidParameters),a=X.of(this._iid),s=a.sdkState,u=a.requestQueue,d=new M8({channelUrl:this.url,channelType:this.channelType,userId:s.userId,offendingUserId:e.userId,category:r,description:i}),[4,u.send(d)];case 1:return h.sent(),[2]}})})},t.prototype.reportMessage=function(e,r,i){return M(this,void 0,void 0,function(){var a,s,u,d;return R(this,function(h){switch(h.label){case 0:return Se(e instanceof Lr&&(nt(oh,r)||r instanceof cc)&&J("string",i)).throw(ee.invalidParameters),a=X.of(this._iid),s=a.sdkState,u=a.requestQueue,d=new O8({channelUrl:this.url,channelType:this.channelType,userId:s.userId,offendingUserId:e.sender.userId,messageId:e.messageId,category:r,description:i,messageToken:e._messageToken}),[4,u.send(d)];case 1:return h.sent(),[2]}})})},t.prototype.updatePoll=function(e,r){return M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(J("number",e)&&function(d){return J("string",d.title,!0)&&nM(d.data)&&J("boolean",d.allowUserSuggestion,!0)&&J("boolean",d.allowMultipleVotes,!0)&&J("number",d.closeAt,!0)}(r)).throw(ee.invalidParameters),i=X.of(this._iid).requestQueue,a=new V8(W({pollId:e},r)),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(j8).poll]}})})},t.prototype.deletePoll=function(e){return M(this,void 0,void 0,function(){var r,i,a;return R(this,function(s){switch(s.label){case 0:return r=J("number",e),Se(r).throw(ee.invalidParameters),i=X.of(this._iid).requestQueue,a=new q8({pollId:e}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},t.prototype.closePoll=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return r=J("number",e),Se(r).throw(ee.invalidParameters),i=X.of(this._iid).requestQueue,a=new z8({pollId:e}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(K8).poll]}})})},t.prototype.addPollOption=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u;return R(this,function(d){switch(d.label){case 0:return i=J("number",e)&&J("string",r)&&r.trim()!=="",Se(i).throw(ee.invalidParameters),a=X.of(this._iid).requestQueue,s=new W8({channelUrl:this.url,channelType:this.channelType,pollId:e,optionText:r}),[4,a.send(s)];case 1:return u=d.sent(),[2,u.as($8).poll]}})})},t.prototype.updatePollOption=function(e,r,i){return M(this,void 0,void 0,function(){var a,s,u,d;return R(this,function(h){switch(h.label){case 0:return a=J("number",e)&&J("number",r)&&J("string",i)&&i.trim()!=="",Se(a).throw(ee.invalidParameters),s=X.of(this._iid).requestQueue,u=new Y8({pollId:e,pollOptionId:r,optionText:i}),[4,s.send(u)];case 1:return d=h.sent(),[2,d.as(Q8).poll]}})})},t.prototype.deletePollOption=function(e,r){return M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return i=J("number",e)&&J("number",r),Se(i).throw(ee.invalidParameters),a=X.of(this._iid).requestQueue,s=new Z8({pollId:e,pollOptionId:r}),[4,a.send(s)];case 1:return u.sent(),[2]}})})},t.prototype.votePoll=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u,d,h,p;return R(this,function(g){switch(g.label){case 0:return i=J("number",e)&&tt("number",r),Se(i).throw(ee.invalidParameters),a=X.of(this._iid),s=a.requestQueue,u=a.dispatcher,d=new X8({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionIds:r}),[4,s.send(d)];case 1:return h=g.sent(),p=h.as(fC).event,u.dispatch(new km({event:p,source:ge.EVENT_POLL_VOTED})),[2,p]}})})},t.prototype.getPollChangeLogsSinceTimestamp=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return Se(J("number",e)).throw(ee.invalidParameters),[4,Q_.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,r.sent()]}})})},t.prototype.getPollChangeLogsSinceToken=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return Se(J("string",e,!0)),[4,Q_.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,r.sent()]}})})},t.prototype.createPollListQuery=function(e){return e===void 0&&(e=10),new aM(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:e})},t.prototype.createPollVoterListQuery=function(e,r,i){return i===void 0&&(i=20),new sM(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionId:r,limit:i})},t.prototype.pinMessage=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return Se(J("number",e)&&e>0).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new hH({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.unpinMessage=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return Se(J("number",e)&&e>0).throw(ee.invalidParameters),r=X.of(this._iid).requestQueue,i=new pH({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t}(Zr),OM=function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return j(t,n),t}(function(){this.onConnected=Kn,this.onReconnectStarted=Kn,this.onReconnectSucceeded=Kn,this.onReconnectFailed=Kn,this.onDisconnected=Kn}),k1=function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return j(t,n),t}(function(){this.onSessionExpired=Kn,this.onSessionTokenRequired=function(n){return n(null)},this.onSessionError=Kn,this.onSessionRefreshed=Kn,this.onSessionClosed=Kn}),mH=function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return j(t,n),t}(function(){this.onFriendsDiscovered=Kn,this.onTotalUnreadMessageCountChanged=Kn,this.onTotalUnreadMessageCountUpdated=Kn}),gH=function(n){function t(e){var r=e.limit,i=e.token,a=e.userIdsFilter,s=e.metaDataKeyFilter,u=e.metaDataValuesFilter,d=e.nicknameStartsWithFilter,h=n.call(this)||this;return h.method=Ie.GET,h.path=xt,h.params=ze({limit:r,token:i,user_ids:a,metadatakey:s,metadatavalues_in:u,nickname_startswith:d}),h}return j(t,n),t}(Te),vH=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.users=r.users.map(function(a){return new _t(e,a)}),i.next=r.next,i}return j(t,n),t}(Me),EH=function(n){function t(e,r){var i,a,s,u=this;return(u=n.call(this,e,r)||this).userIdsFilter=null,u.metaDataKeyFilter=null,u.metaDataValuesFilter=null,u.nicknameStartsWithFilter=null,u.userIdsFilter=(i=r.userIdsFilter)!==null&&i!==void 0?i:null,u.metaDataKeyFilter=(a=r.metaDataKeyFilter)!==null&&a!==void 0?a:null,u.metaDataValuesFilter=(s=r.metaDataValuesFilter)!==null&&s!==void 0?s:null,u.nicknameStartsWithFilter=r.nicknameStartsWithFilter||null,u}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&tt("string",this.userIdsFilter,!0)&&J("string",this.metaDataKeyFilter,!0)&&tt("string",this.metaDataValuesFilter,!0)&&J("string",this.nicknameStartsWithFilter,!0)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new gH(_n(W(W({},this),{token:this._token}))),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(vH),s=a.users,u=a.next,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(Vu),yH=function(n){function t(e){var r=e.userId,i=e.limit,a=e.token,s=e.userIdsFilter,u=n.call(this)||this;return u.method=Ie.GET,u.path="".concat(xt,"/").concat(r,"/block"),u.params=ze({limit:i,token:a,user_ids:s}),u}return j(t,n),t}(Te),bH=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.users=r.users.map(function(a){return new _t(e,a)}),i.next=r.next,i}return j(t,n),t}(Me),CH=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).userIdsFilter=null,a.userIdsFilter=(i=r.userIdsFilter)!==null&&i!==void 0?i:null,a}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&tt("string",this.userIdsFilter,!0)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new yH(_n(W(W({},this),{userId:r.userId,token:this._token}))),[4,i.send(a)]):[3,2]:[3,5];case 1:return s=p.sent(),u=s.as(bH),d=u.users,h=u.next,this._token=h,this._hasNext=!!h,this._isLoading=!1,[2,d];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(Vu),IH=function(n){function t(e){var r=e.userId,i=e.limit,a=e.token,s=n.call(this)||this;return s.method=Ie.GET,s.path="".concat(xt,"/").concat(encodeURIComponent(r),"/friends"),s.params={limit:i,token:a},s}return j(t,n),t}(Te),TH=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.hasMore=r.has_more,i.users=r.users.map(function(a){return new _t(e,a)}),i.next=r.next,i}return j(t,n),t}(Me),SH=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p;return R(this,function(g){switch(g.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new IH(W(W({},this),{userId:r.userId,token:this._token})),[4,i.send(a)]):[3,2]:[3,5];case 1:return s=g.sent(),u=s.as(TH),d=u.users,h=u.hasMore,p=u.next,this._token=p,this._hasNext=h,this._isLoading=!1,[2,d];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(Vu),n_={},xh=function(){function n(t){var e=t.dbname,r=t.itemSizeLimit,i=r===void 0?1048576:r,a=t.cacheLimit,s=a===void 0?256:a,u=t.blockHashBase,d=u===void 0?2:u,h=t.blockHashMultiplier,p=h===void 0?10:h,g=t.blockHashConstant,E=g===void 0?11:g,y=t.transactionApplyDelay,C=y===void 0?200:y,T=t.disableLogger,A=T!==void 0&&T;return n_[e]||(this.itemSizeLimit=i,this.cacheLimit=s,this.blockHashBase=d,this.blockHashMultiplier=p,this.blockHashConstant=E,this.transactionApplyDelay=C,this.disableLogger=A,n_[e]=this),n_[e]}return n.get=function(t){return n_[t]},n}();(function(n){n[n.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",n[n.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",n[n.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",n[n.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",n[n.STORE_IS_FULL=61001003]="STORE_IS_FULL",n[n.STORE_NOT_INITIALIZED=61001004]="STORE_NOT_INITIALIZED",n[n.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",n[n.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",n[n.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",n[n.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",n[n.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",n[n.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",n[n.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",n[n.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",n[n.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",n[n.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",n[n.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",n[n.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",n[n.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",n[n.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",n[n.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",n[n.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",n[n.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",n[n.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",n[n.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",n[n.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND"})(yr||(yr={}));var jl,$t=function(n){function t(e){var r=e.code,i=r===void 0?yr.UNKNOWN_ERROR:r,a=e.message,s=a===void 0?"Unknown error occurred.":a,u=n.call(this,s)||this;return u.code=i,Object.setPrototypeOf(u,t.prototype),u}return j(t,n),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:yr.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:yr.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:yr.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:yr.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotInitialized",{get:function(){return new t({code:yr.STORE_NOT_INITIALIZED,message:"Store is not initialized."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:yr.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:yr.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:yr.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeEncryptionInvalid",{get:function(){return new t({code:yr.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:yr.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:yr.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:yr.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:yr.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:yr.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:yr.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:yr.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:yr.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:yr.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:yr.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:yr.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:yr.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:yr.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:yr.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:yr.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:yr.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),t}(Error);(function(n){n.INIT="init",n.READY="ready",n.CLOSED="closed"})(jl||(jl={}));var D1,ua=function(n,t){if(t===void 0&&(t=new WeakMap),typeof n=="object"&&n!==null){if(t.has(n))throw $t.circularReferenceFound;var e;return t.set(n,!0),Array.isArray(n)?e=n.map(function(r){return ua(r,t)}):n instanceof RegExp||n instanceof Date?e=n:(e={},Object.keys(n).forEach(function(r){e[r]=ua(n[r],t)})),t.delete(n),e}return n},Uu=function(n,t){if(t==null)return 1;if(n==null)return-1;if(typeof n!=typeof t)throw $t.compareTypesNotMatch;var e=0;switch(typeof n){case"boolean":case"number":e=n-t;break;case"string":e=n.localeCompare(t)}return e},L1=function(n,t){for(var e=0,r=0;r<n.length;r++)e=n.charCodeAt(r)+(e<<6)+(e<<16)-e;return(e>>>0)%t},t_=function(n){return new Promise(function(t){setTimeout(function(){return t()},n)})},Kl=function(n,t){if(!t)return!1;if(typeof n!="function"){for(var e in n)if(["/and","&&"].includes(e)){if(n[e].some(function(d){return!Kl(d,t)}))return!1}else if(["/or","||"].includes(e)){if(n[e].every(function(d){return!Kl(d,t)}))return!1}else if(e==="/where"){if(!(0,n[e])(t))return!1}else{var r=e;if(typeof n[r]=="object"){var i=n[r];for(var a in i)switch(a){case"/eq":case"=":if((s=t[r])!==(u=i[a]))return!1;break;case"/neq":case"!=":if((s=t[r])===(u=i[a]))return!1;break;case"/gt":case">":var s=t[r],u=i[a];if(!(Uu(s,u)>0))return!1;break;case"/gte":case">=":if(s=t[r],u=i[a],!(Uu(s,u)>=0))return!1;break;case"/lt":case"<":if(s=t[r],u=i[a],!(Uu(s,u)<0))return!1;break;case"/lte":case"<=":if(s=t[r],u=i[a],!(Uu(s,u)<=0))return!1;break;case"/in":if(s=t[r],!(u=i[a]).includes(s))return!1;break;case"/nin":if(s=t[r],(u=i[a]).includes(s))return!1;break;case"/contain":if(s=t[r],u=i[a],!s.includes(u))return!1;break;case"/regex":if(s=t[r],!(u=i[a]).test(s))return!1;break;case"/where":if(s=t[r],!(0,i[a])(s))return!1}}else if(typeof n[r]=="function"){if(!n[r](t[r]))return!1}else if(n[r]!==t[r])return!1}return!0}return n(t)},Kf=function(){},x1=function(){return Promise.resolve()},NH=function(n){return n},U1=function(n,t){t()};(function(n){n[n.FORWARD=0]="FORWARD",n[n.BACKWARD=1]="BACKWARD"})(D1||(D1={}));var Wl,Bi,$s,AH=function(){function n(t){var e=t.initialPrevValue,r=e===void 0?null:e,i=t.initialNextValue,a=i===void 0?null:i,s=t.iterator,u=t.map,d=u===void 0?NH:u,h=t.backward,p=h===void 0?x1:h,g=t.forward,E=g===void 0?x1:g,y=t.complete,C=y===void 0?Kf:y;this._prevValue=r,this._nextValue=a,this._error=null,this._map=d,this._backward=p,this._forward=E,this._iterator=s,this._complete=C}return Object.defineProperty(n.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"nextValue",{get:function(){return this._map(this._nextValue)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),n.prototype.prev=function(){return M(this,void 0,void 0,function(){var t,e,r;return R(this,function(i){switch(i.label){case 0:if(!this.hasPrevious)return[3,6];i.label=1;case 1:return i.trys.push([1,3,,4]),t=this._prevValue,e=this,[4,this._backward()];case 2:return e._prevValue=i.sent()||null,this._nextValue=t,[3,4];case 3:return r=i.sent(),this._error=r,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,i.sent()];case 6:this._complete(),i.label=7;case 7:return[2]}})})},n.prototype.next=function(){return M(this,void 0,void 0,function(){var t,e,r;return R(this,function(i){switch(i.label){case 0:if(!this.hasNext)return[3,6];i.label=1;case 1:return i.trys.push([1,3,,4]),t=this._nextValue,e=this,[4,this._forward()];case 2:return e._nextValue=i.sent()||null,this._prevValue=t,[3,4];case 3:return r=i.sent(),this._error=r,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,i.sent()];case 6:this._complete(),i.label=7;case 7:return[2]}})})},n.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete()},n}(),cy=function(){function n(t){var e=t.condition,r=e===void 0?{}:e,i=t.backward,a=i!==void 0&&i,s=t.blockManager,u=t.indexer;this.condition=r,this.backward=a,this._blockManager=s,this._indexer=u}return n.prototype.findOptimizedStartPosition=function(){var t=this,e=["=","/eq",">",">=","/gt","/gte"],r=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var i=this._indexer.origin.length-1;if(typeof this.condition!="function")for(y=0;y<this._indexer.fields.length;y++){var a=this._indexer.fields[y],s=1;if(a[0]==="-"&&(a=a.slice(1),s=-1),this.condition[a]){if(typeof this.condition[a]=="object"){var u=s>0?r:e;for(var d in this.condition[a])if(u.includes(d)){for(var h=i;h>=0;h--)if(s*Uu(this._indexer.origin[h].columnValues[y],this.condition[a][d])<=0){i=h;break}}}else for(h=i;h>=0;h--)if(s*Uu(this._indexer.origin[h].columnValues[y],this.condition[a])<=0){i=h;break}}}return Math.min(i+1,this._indexer.origin.length-1)}var p=0;if(typeof this.condition!="function")for(var g=function(C){var T=E._indexer.fields[C],A=1;if(T[0]==="-"&&(T=T.slice(1),A=-1),E.condition[T]){if(typeof E.condition[T]=="object")Object.keys(E.condition[T]).forEach(function(N){if((A>0?e:r).includes(N)){for(var k=p;k<t._indexer.origin.length;k++)if(A*Uu(t._indexer.origin[k].columnValues[C],t.condition[T][N])>=0){p=k;break}}});else for(var O=p;O<E._indexer.origin.length;O++)if(A*Uu(E._indexer.origin[O].columnValues[C],E.condition[T])>=0){p=O;break}}},E=this,y=0;y<this._indexer.fields.length;y++)g(y);return Math.max(p-1,0)},n.prototype.each=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h=this;return R(this,function(p){switch(p.label){case 0:if(e=this.findOptimizedStartPosition(),r=0,this.backward&&this._indexer.origin[e]&&(r=this._indexer.origin[e].keys.length-1),i=function(){if(h._indexer.origin[e]){if(!h._indexer.origin[e].keys[++r]){if(!h._indexer.origin[++e])return!1;r=0}return!0}return!1},a=function(){if(h._indexer.origin[e]){if(!h._indexer.origin[e].keys[--r]){if(!h._indexer.origin[--e])return!1;r=h._indexer.origin[e].keys.length-1}return!0}return!1},s=null,!this._indexer.origin[e])return[3,4];u=this.backward?a:i,p.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[e].keys[r])];case 2:if((d=p.sent())&&Kl(this.condition,d))return s=d,[3,4];p.label=3;case 3:if(u())return[3,1];p.label=4;case 4:return[4,new Promise(function(g){var E=new AH({initialNextValue:ua(s),iterator:t,forward:function(){return M(h,void 0,void 0,function(){var y,C;return R(this,function(T){switch(T.label){case 0:y=this.backward?a:i,T.label=1;case 1:return y()?[4,this._blockManager.getFromBlock(this._indexer.origin[e].keys[r])]:[3,3];case 2:return(C=T.sent())&&Kl(this.condition,C)?[2,ua(C)]:[3,1];case 3:return[2,null]}})})},backward:function(){return M(h,void 0,void 0,function(){var y,C;return R(this,function(T){switch(T.label){case 0:y=this.backward?i:a,T.label=1;case 1:return y()?[4,this._blockManager.getFromBlock(this._indexer.origin[e].keys[r])]:[3,3];case 2:return(C=T.sent())&&Kl(this.condition,C)?[2,ua(C)]:[3,1];case 3:return[2,null]}})})},complete:g});t(E)})];case 5:return[2,p.sent()]}})})},n}(),wH=function(){function n(t){var e=t.condition,r=e===void 0?{}:e,i=t.backward,a=i!==void 0&&i,s=t.mutex,u=t.blockManager,d=t.indexer;this._mutex=s,this._iterator=new cy({condition:r,backward:a,blockManager:u,indexer:d})}return n.prototype.fetch=function(t){return t===void 0&&(t={}),M(this,void 0,void 0,function(){var e,r,i,a,s=this;return R(this,function(u){switch(u.label){case 0:if(e=Math.max(t.offset||0,0),(r=typeof t.limit=="number"?t.limit:Number.MAX_SAFE_INTEGER)===0)return[2,[]];if(r<0)throw $t.collectionQueryNotValid;u.label=1;case 1:return u.trys.push([1,4,,5]),i=[],[4,this._mutex.lock()];case 2:return u.sent(),[4,this._iterator.each(function(d){return M(s,void 0,void 0,function(){return R(this,function(h){return d.error?d.stop():d.hasNext?e===0?(i.push(d.nextValue),0<r&&r<=i.length?d.stop():d.next()):(e--,d.next()):d.stop(),[2]})})})];case 3:return u.sent(),this._mutex.unlock(),[2,i];case 4:throw a=u.sent(),this._mutex.unlock(),a;case 5:return[2]}})})},n.prototype.count=function(){return M(this,void 0,void 0,function(){var t,e,r=this;return R(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=0,[4,this._mutex.lock()];case 1:return i.sent(),[4,this._iterator.each(function(a){return M(r,void 0,void 0,function(){return R(this,function(s){return a.error?a.stop():a.hasNext?(t++,a.next()):a.stop(),[2]})})})];case 2:return i.sent(),this._mutex.unlock(),[2,t];case 3:throw e=i.sent(),this._mutex.unlock(),e;case 4:return[2]}})})},n}(),hC=function(n){return"".concat("nest","@").concat(n)},ed=function(n,t){return"".concat(hC(n),"/").concat(t)},gE=function(n,t){return"".concat(ed(n,t),".metadata")},fy=function(n,t){return"".concat(ed(n,t),"/block.")},P1=function(n,t){return"".concat(ed(n,t),"/blob.")},RH=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.store;this.dbname=e,this.collectionName=r,this.store=i}return n.prototype.get=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p;return R(this,function(g){switch(g.label){case 0:return[4,this.store.get(t)];case 1:return(e=g.sent())?(r=e.data,i=e.type,typeof fetch>"u"?[3,4]:[4,fetch(r)]):[3,5];case 2:return[4,g.sent().blob()];case 3:return[2,g.sent()];case 4:for(a=[],s=atob(r.split(",")[1]),u=0;u<s.length;u+=512){for(d=s.slice(u,u+512),h=new Array(d.length),p=0;p<d.length;p++)h[p]=d.charCodeAt(p);a.push(new Uint8Array(h))}return[2,new Blob(a,{type:i})];case 5:return[2,null]}})})},n.prototype.save=function(t,e){return e===void 0&&(e="".concat(Date.now())),M(this,void 0,void 0,function(){var r,i,a,s,u=this;return R(this,function(d){switch(d.label){case 0:return[4,new Promise(function(h){var p=function(E,y,C,T){return T===void 0&&(T=0),"".concat(P1(E,y)).concat(C,".").concat(T)}(u.dbname,u.collectionName,e),g=new FileReader;g.onload=function(){h({blobId:p,data:g.result,type:t.type})},g.readAsDataURL(t)})];case 1:return r=d.sent(),i=r.blobId,a=r.data,s=r.type,[4,this.store.set({key:i,value:{data:a,type:s}})];case 2:return d.sent(),[2,i]}})})},n.prototype.remove=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this.store.remove(t)];case 1:return e.sent(),[2]}})})},n.prototype.clear=function(){return M(this,void 0,void 0,function(){var t,e,r=this;return R(this,function(i){switch(i.label){case 0:return t=P1(this.dbname,this.collectionName),[4,this.store.getAllKeys()];case 1:return e=i.sent(),[4,Promise.all(e.filter(function(a){return a.startsWith(t)}).map(function(a){return M(r,void 0,void 0,function(){return R(this,function(s){switch(s.label){case 0:return[4,this.store.remove(a)];case 1:return[2,s.sent()]}})})}))];case 2:return i.sent(),[2]}})})},n}();(function(n){n[n.COMMIT=0]="COMMIT",n[n.WRITE=1]="WRITE",n[n.ERROR=2]="ERROR"})(Wl||(Wl={})),function(n){n.PENDING="pending",n.PERSISTENT="persistent",n.VOLATILE="volatile"}(Bi||(Bi={})),function(n){n[n.NO_CACHE=0]="NO_CACHE",n[n.DEFAULT=1]="DEFAULT",n[n.PERSISTENT=2]="PERSISTENT"}($s||($s={}));var lh,Pi,F1=[Bi.PENDING,Bi.VOLATILE],r_={},la=function(){function n(t){var e=t.dbname,r=t.limit,i=r===void 0?256:r;return r_[e]||(this.dbname=e,this._items=[],this._limit=i,r_[e]=this),r_[e]}return n.get=function(t){return r_[t]},Object.defineProperty(n.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),n.prototype.find=function(t,e,r){return r===void 0&&(r=$s.DEFAULT),M(this,void 0,void 0,function(){var i,a;return R(this,function(s){switch(s.label){case 0:return(i=this.get(e))?[3,2]:[4,t.get(e)];case 1:return(a=s.sent())&&(i={key:e,value:a,state:r===$s.PERSISTENT?Bi.PERSISTENT:Bi.VOLATILE},this.put(i)),[3,3];case 2:r===$s.PERSISTENT&&(i.state=Bi.PERSISTENT),s.label=3;case 3:return[2,i]}})})},n.prototype.get=function(t,e){e===void 0&&(e=$s.DEFAULT);var r=this._items.map(function(a){return a.key}).indexOf(t);if(r>-1){var i=this._items[r];return e===$s.PERSISTENT&&(i.state=Bi.PERSISTENT),e!==$s.NO_CACHE&&this.put(i),i}return null},n.prototype.put=function(t){var e,r;if(this._limit>0){var i=this._items.map(function(g){return g.key}).indexOf(t.key);if(i>-1)F1.includes(this._items[i].state)&&F1.includes(t.state)?(this._items.splice(i,1),this._items.push(t)):(this._items[i].state=t.state,this._items[i].value=t.value);else{this._items.push(t);var a=this._items.filter(function(g){return g.state===Bi.VOLATILE}),s=a.length-this._limit;if(s>0){var u=[];try{for(var d=Le(this._items),h=d.next();!h.done;h=d.next()){var p=h.value;p.state===Bi.VOLATILE&&s>0?s--:u.push(p)}}catch(g){e={error:g}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}this._items=u}}}},n.prototype.remove=function(t){var e=this._items.map(function(r){return r.key}).indexOf(t);e>-1&&this._items.splice(e,1)},n.prototype.clearByCondition=function(t){this._items=this._items.filter(function(e){return!t(e)})},n.prototype.clearForDatabase=function(t){this.clearByCondition(function(e){return e.key.startsWith(hC(t))})},n.prototype.clear=function(t){t===void 0&&(t=!1),this._items=t?[]:this._items.filter(function(e){return e.state!==Bi.VOLATILE})},n}(),MH=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.store;this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=e,this.collectionName=r,this.metadataKey=function(a,s){return"".concat(ed(a,s),"/trans.metadata")}(e,r),this.recordsetKey=function(a,s){return"".concat(ed(a,s),"/trans.recordset")}(e,r),this._store=i}return Object.defineProperty(n.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),n.prototype._getReducedRecordset=function(t){return t===void 0&&(t=[]),M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(e=r.sent()||[]).push.apply(e,Nn([],cn(t),!1)),[2,this._reduceRecordSet(e)]}})})},n.prototype._reduceRecordSet=function(t){for(var e=[],r={},i=t.length-1;i>=0;i--){for(var a=t[i],s=[],u=a.requests.length-1;u>=0;u--){var d=a.requests[u],h=d.data;r[h.key]||(s.unshift(d),r[h.key]=!0)}s.length>0&&(a.requests=s,e.unshift(a))}return e},n.prototype._applyRecord=function(t,e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:r=la.get(this.dbname),i=e.generation,a=e.requests,s=null,E.label=1;case 1:return E.trys.push([1,3,,4]),[4,this._store.setMany(a.map(function(y){return W(W({},y.data),{generation:i})}))];case 2:for(u=E.sent(),d=0;d<a.length;d++)u[d]instanceof Error&&(s||(s=u[d]),h=a[d].data,r.put(W(W({},h),{state:Bi.PERSISTENT})));return[3,4];case 3:return p=E.sent(),s=p,[3,4];case 4:return s?[3,6]:(g=t.filter(function(y){return y.generation!==i}),[4,this._store.set({key:this.recordsetKey,value:g})]);case 5:return E.sent(),this._onWrite.forEach(function(y){y(a.map(function(C){return C.data}))}),[3,7];case 6:this._onError.forEach(function(y){s&&y(s)}),E.label=7;case 7:return[2]}})})},n.prototype.init=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return t=this,[4,this._store.get(this.metadataKey)];case 1:return t._metadata=h.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:e=h.sent(),h.label=3;case 3:h.trys.push([3,8,9,10]),r=Le(e),i=r.next(),h.label=4;case 4:return i.done?[3,7]:(a=i.value,[4,this._applyRecord(e,a)]);case 5:h.sent(),h.label=6;case 6:return i=r.next(),[3,4];case 7:return[3,10];case 8:return s=h.sent(),u={error:s},[3,10];case 9:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(u)throw u.error}return[7];case 10:return[2]}})})},n.prototype.on=function(t,e,r){switch(t){case Wl.COMMIT:this._onCommit.set(e,r);break;case Wl.WRITE:this._onWrite.set(e,r);break;case Wl.ERROR:this._onError.set(e,r)}},n.prototype.requestWrite=function(t,e){this._requests.push({data:t,options:e}),la.get(this.dbname).put(W({state:Bi.PENDING},t))},n.prototype.requestMultipleWrite=function(t,e){var r,i,a=la.get(this.dbname);try{for(var s=Le(t),u=s.next();!u.done;u=s.next()){var d=u.value;this._requests.push({data:d,options:e}),a.put(W({state:Bi.PENDING},d))}}catch(h){r={error:h}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},n.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(t){return la.get(this.dbname).clearByCondition(function(e){return e.state===Bi.PENDING}),this._requests=[],[2]})})},n.prototype.commit=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u,d,h,p,g,E,y=this;return R(this,function(C){switch(C.label){case 0:if(!((t=this._requests).length>0))return[3,4];for(e=[],r={},d=t.length-1;d>=0;d--)i=t[d],p=i.data,r[p.key]||(r[p.key]=!0,e.unshift(i));return a={generation:this.generation,requests:e},[4,this._getReducedRecordset([a])];case 1:return s=C.sent(),[4,this._store.set({key:this.recordsetKey,value:s})];case 2:return C.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata})];case 3:for(C.sent(),u=la.get(this.dbname),d=0;d<e.length;d++)h=e[d],p=h.data,g=h.options,u.put(W(W({},p),{state:g&&g.persistent?Bi.PERSISTENT:Bi.VOLATILE}));this._requests=[],this._onCommit.forEach(function(T){T(t.map(function(A){return A.data}))}),E=xh.get(this.dbname),setTimeout(function(){try{y._applyRecord(s,a)}catch(T){y._onError.forEach(function(A){return A(T)})}},E.transactionApplyDelay),C.label=4;case 4:return[2]}})})},n}(),N_=function(){function n(t){var e=t.blockId,r=t.keyName,i=t.items,a=i===void 0?[]:i,s=t.limit;this.blockId=e,this.keyName=r,this.limit=s,this._items=Nn([],cn(a),!1)}return n.createFromCacheItem=function(t){return t?new n(t.value):null},Object.defineProperty(n.prototype,"isEmpty",{get:function(){return this._items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),n.prototype.serialize=function(){return{blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items}},n.prototype.getItemByKey=function(t){var e=this,r=this._items.find(function(i){var a=i[e.keyName];return t===a});return r??null},n.prototype.has=function(t){var e=this;return this._items.map(function(r){return r[e.keyName]}).includes(t)},n.prototype.add=function(t){var e=this,r=this._items.map(function(i){return i[e.keyName]}).indexOf(t[this.keyName]);return r<0?this._items.length<this.limit&&(this._items.push(t),!0):(this._items[r]=t,!0)},n.prototype.remove=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e][this.keyName]===t)return this._items.splice(e,1),!0;return!1},n.prototype.clear=function(){this._items=[]},n}(),OH=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.metadata,a=t.hashFunction,s=a===void 0?L1:a,u=t.transaction,d=t.store;this.dbname=e,this.collectionName=r,this.hashFunction=s,this.metadata=i,this._transaction=u,this._store=d}return Object.defineProperty(n.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),n.prototype.createBlockId=function(t,e){return e===void 0&&(e=this.metadata.blockLevel),r=this.dbname,i=this.collectionName,a=e,s="".concat(function(u,d,h){var p=h.base*Math.pow(h.multiplier,d)+h.constant;return(h.hashFunction||L1)(u,p)}(t,e,{hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant})),"".concat(fy(r,i)).concat(a,".").concat(s);var r,i,a,s},n.prototype._findBlock=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:e=la.get(this.dbname),r=this.metadata.blockLevel,u.label=1;case 1:return r>0?(i=this.createBlockId(t,r),[4,e.find(this._store,i)]):[3,4];case 2:if((a=u.sent())&&(s=N_.createFromCacheItem(a),s==null?void 0:s.getItemByKey(t)))return[2,s];u.label=3;case 3:return r--,[3,1];case 4:return[2,null]}})})},n.prototype.getFromBlock=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return[4,this._findBlock(t)];case 1:return[2,(e=r.sent())?e.getItemByKey(t):null]}})})},n.prototype.putToBlock=function(t,e){return M(this,void 0,void 0,function(){var r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return r=xh.get(this.dbname),i=this.createBlockId(t),a=Math.floor(this._store.itemSizeLimit/r.itemSizeLimit),[4,la.get(this.dbname).find(this._store,i)];case 1:return s=d.sent(),(u=s?N_.createFromCacheItem(s):new N_({blockId:i,keyName:this.keyName,items:[],limit:a}))!=null&&u.add(e)?(this._transaction.requestWrite({key:u.blockId,value:u.serialize()}),[2,!0]):[2,!1]}})})},n.prototype.removeFromBlock=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return[4,this._findBlock(t)];case 1:return(e=r.sent())&&e.remove(t)?(this._transaction.requestWrite({key:e.blockId,value:e.serialize()}),[2,!0]):[2,!1]}})})},n.prototype.clearAllBlocks=function(){return M(this,void 0,void 0,function(){var t,e,r;return R(this,function(i){switch(i.label){case 0:return t=fy(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return e=i.sent(),r=e.filter(function(a){return a.startsWith(t)}),[4,this._store.removeMany(r)];case 2:return i.sent(),[4,this._transaction.clear()];case 3:return i.sent(),la.get(this.dbname).clearByCondition(function(a){return a.key.startsWith(t)}),[2]}})})},n}(),ho=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.keyName,a=t.fields,s=t.transaction,u=t.store,d=this;this._origin=[],this._table=[];var h=function(p,g,E){return"".concat(ed(p,g),"/index.").concat(E)}(e,r,a.join(">"));this.dbname=e,this.collectionName=r,this.keyName=i,this.fields=a,this.indexerKey=h,this._store=u,this._transaction=s,this._transaction.on(Wl.COMMIT,this.indexerKey,function(){return d.commit()}),this._transaction.on(Wl.ERROR,this.indexerKey,function(){return d.abort()})}return n.createKey=function(t){return t.join(">")},n.parseKey=function(t){return t.split(">")},n.prototype._addItem=function(t){var e=t[this.keyName],r=this.getColumnValues(t),i=cn(this.indexOf(r),2),a=i[0];return i[1]?!this._table[a].keys.includes(e)&&(this._table[a].keys.push(e),!0):(this._table.splice(a,0,{columnValues:r,keys:[e]}),!0)},n.prototype._removeItem=function(t){var e=t[this.keyName],r=this.getColumnValues(t),i=cn(this.indexOf(r),2),a=i[0];if(i[1]){var s=this._table[a].keys.indexOf(e);if(s>-1)return this._table[a].keys.splice(s,1),this._table[a].keys.length===0&&this._table.splice(a,1),!0}return!1},Object.defineProperty(n.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),n.prototype.getColumnValues=function(t){var e,r,i,a,s=[];try{for(var u=Le(this.fields),d=u.next();!d.done;d=u.next()){var h=d.value;if(h[0]==="-"&&(h=h.slice(1)),i=t[h],a=void 0,a=typeof i,i!==null&&a!=="undefined"&&a!=="boolean"&&a!=="number"&&a!=="string")throw $t.indexTypesNotMatch;s.push(t[h])}}catch(p){e={error:p}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return s},n.prototype.diff=function(t,e){for(var r in this.fields){var i=this.fields[r][0]==="-"?-1:1,a=Uu(t[r],e[r]);if(a!==0)return i*a}return 0},n.prototype.indexOf=function(t){if(this._table.length>0){for(var e=0,r=this._table.length-1;e<=r;){var i=Math.floor((e+r)/2),a=this.diff(t,this._table[i].columnValues);if(a>0)e=i+1;else{if(!(a<0))return[i,!0];r=i-1}}return[e,!1]}return[0,!1]},n.prototype.ensure=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u,d,h,p,g,E,y,C,T,A,O;return R(this,function(N){switch(N.label){case 0:return[4,(t=la.get(this.dbname)).find(this._store,this.indexerKey,$s.PERSISTENT)];case 1:return(e=N.sent())?[3,11]:(r=fy(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:i=N.sent(),N.label=3;case 3:N.trys.push([3,8,9,10]),a=Le(i),s=a.next(),N.label=4;case 4:return s.done?[3,7]:(u=s.value).startsWith(r)?[4,t.find(this._store,u,$s.NO_CACHE)]:[3,6];case 5:if(d=N.sent(),h=N_.createFromCacheItem(d))try{for(A=void 0,p=Le(h.items),g=p.next();!g.done;g=p.next())E=g.value,this._addItem(E)}catch(k){A={error:k}}finally{try{g&&!g.done&&(O=p.return)&&O.call(p)}finally{if(A)throw A.error}}N.label=6;case 6:return s=a.next(),[3,4];case 7:return[3,10];case 8:return y=N.sent(),C={error:y},[3,10];case 9:try{s&&!s.done&&(T=a.return)&&T.call(a)}finally{if(C)throw C.error}return[7];case 10:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,12];case 11:this._origin=e.value,this._table=ua(this._origin),N.label=12;case 12:return[2]}})})},n.prototype.drop=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return la.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return t.sent(),[2]}})})},n.prototype.addItem=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){return this._addItem(t)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},n.prototype.removeItem=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){return this._removeItem(t)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},n.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(t){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},n.prototype.commit=function(){this._origin=this._table,this._table=ua(this._origin)},n.prototype.abort=function(){this._table=ua(this._origin)},n}(),im=function(){return typeof document<"u"&&typeof navigator<"u"&&navigator.product!=="ReactNative"},H1=function(){var n=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(n+16*Math.random())%16|0;return n=Math.floor(n/16),(t==="x"?e:3&e|8).toString(16)})};(function(n){n[n.PROCESSING=0]="PROCESSING",n[n.DONE=1]="DONE"})(lh||(lh={})),function(n){n.NEWNODE="newnode",n.REMOVENODE="removenode",n.CLAIM_HOST="claimhost",n.SYNC_HOST="synchost",n.REQUEST_LOCK="requestlock",n.ACQUIRE_LOCK="acquirelock",n.RELEASE_LOCK="releaselock"}(Pi||(Pi={}));var ys,vE={},pC=function(){function n(t,e){e===void 0&&(e={});var r=this;return this._state=lh.PROCESSING,this._queue=[],this._activationQueue=[],vE[t]&&!e.forceCreate||(this.nodeId=H1(),this.key=t,im()&&(e.startAsInvisible?this.registerNode():document.visibilityState==="visible"?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",function(){document.visibilityState==="visible"&&r.claimHost()}),window.addEventListener("message",function(i){var a,s,u=i.data;if(u!=null&&u.isNestDbMessage){var d=u.nodeId,h=u.requestId,p=u.key,g=u.op,E=u.data;if(d!==r.nodeId&&p===r.key)switch(g){case Pi.NEWNODE:r._sendSync();break;case Pi.CLAIM_HOST:r._sendSync(),r._hostId=d;break;case Pi.SYNC_HOST:if(!r.isInSync){r._activationTimeout&&clearTimeout(r._activationTimeout);var y=E,C=y.currentItemRequestId,T=y.queue,A=function(D){var P=r._queue.findIndex(function(U){return U.requestId===D.requestId});P<0&&r._requestLock({isNestDbMessage:!0,nodeId:D.nodeId,requestId:D.requestId,key:r.key,op:Pi.REQUEST_LOCK,ts:D.ts})};try{for(var O=Le(T),N=O.next();!N.done;N=O.next())A(N.value)}catch(D){a={error:D}}finally{try{N&&!N.done&&(s=O.return)&&s.call(O)}finally{if(a)throw a.error}}r._currentItem=r._queue.find(function(D){return D.requestId===C}),r._completeSync()}break;case Pi.REMOVENODE:r._queue=r._queue.filter(function(D){return D.nodeId!==u.nodeId}),r._currentItem&&r._currentItem.nodeId===u.nodeId&&(r._currentItem=void 0,r._acquire(r._queue[0]));break;case Pi.REQUEST_LOCK:r._requestLock(u);break;case Pi.ACQUIRE_LOCK:var k=r._queue.find(function(D){return D.requestId===h});r._acquire(k);break;case Pi.RELEASE_LOCK:r._release(h)}}}),window.addEventListener("beforeunload",function(){r._send(Pi.REMOVENODE)})),vE[t]=this),vE[t]}return Object.defineProperty(n.prototype,"locked",{get:function(){return!!this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isHost",{get:function(){return this._hostId===this.nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isInSync",{get:function(){return this._state==lh.DONE},enumerable:!1,configurable:!0}),n.prototype._send=function(t,e){var r;e===void 0&&(e={});var i={isNestDbMessage:!0,nodeId:this.nodeId,requestId:(r=e==null?void 0:e.requestId)!==null&&r!==void 0?r:H1(),key:this.key,op:t,data:e.data,ts:Date.now()};return im()&&window.postMessage(i,"*"),i},n.prototype._acquire=function(t){t?(this._currentItem=t,this._currentItem.onAcquired&&this._currentItem.onAcquired(t.requestId)):this._currentItem=void 0},n.prototype._release=function(t){if(this._currentItem&&this._currentItem.requestId===t){var e=this._currentItem;this._currentItem=void 0,e.nodeId===this.nodeId&&this._send(Pi.RELEASE_LOCK,{requestId:e.requestId});var r=this._queue.findIndex(function(i){return i.requestId===t});r>-1&&this._queue.splice(r,1),e.onReleased&&e.onReleased(t)}},n.prototype._requestLock=function(t){var e=this;return new Promise(function(r){for(var i={nodeId:t.nodeId,requestId:t.requestId,ts:t.ts,onAcquired:function(u){e.isHost&&e._send(Pi.ACQUIRE_LOCK,{requestId:u}),r()},onReleased:function(){e._acquire(e._queue[0])}},a=!1,s=0;s<e._queue.length;s++)if(e._queue[s].ts>i.ts){e._queue.splice(s,0,i),a=!0;break}a||e._queue.push(i),e._currentItem||e._acquire(e._queue[0])})},n.prototype._sendSync=function(){var t;this.isHost&&this._send(Pi.SYNC_HOST,{data:{currentItemRequestId:(t=this._currentItem)===null||t===void 0?void 0:t.requestId,queue:this._queue.map(function(e){return{nodeId:e.nodeId,requestId:e.requestId,ts:e.ts}})}})},n.prototype._waitUntilSyncCompleted=function(){return M(this,void 0,void 0,function(){var t=this;return R(this,function(e){return this.isHost&&!this.isInSync?[2,new Promise(function(r){t._activationQueue.push(r)})]:[2]})})},n.prototype._waitSync=function(){var t=this;this.isInSync||(this._activationTimeout=setTimeout(function(){t._completeSync()},8))},n.prototype._completeSync=function(){this.isInSync||(this._state=lh.DONE,this._activationQueue.forEach(function(t){return t()}),this._activationQueue=[])},n.prototype.registerNode=function(){this._send(Pi.NEWNODE),this._waitSync()},n.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(Pi.CLAIM_HOST),this._waitSync()},n.prototype.lock=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return[4,this._waitUntilSyncCompleted()];case 1:return e.sent(),t=this._send(Pi.REQUEST_LOCK),[4,this._requestLock(t)];case 2:return e.sent(),[2]}})})},n.prototype.unlock=function(){var t;!((t=this._currentItem)===null||t===void 0)&&t.requestId&&this._release(this._currentItem.requestId)},n}(),EE=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.keyName,a=t.keyHash,s=t.indexes,u=t.store,d=this;this._state=jl.INIT,this._indexers=[],this.dbname=e,this.name=r,this.keyName=i,this.indexes=Nn([[i]],cn(s.filter(function(h){return ho.createKey(h)!==d.keyName})),!1),this._keyHash=a,this._store=u,this._mutex=new pC(function(h,p){return"".concat(ed(h,p),".lock")}(e,r)),this._blobContainer=new RH({dbname:e,collectionName:r,store:u}),this._transaction=new MH({dbname:e,collectionName:r,store:u})}return n.metadataOf=function(t,e,r){return M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=gE(t,e),[4,r.get(i)];case 1:return[2,a.sent()]}})})},Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isReady",{get:function(){return this._state===jl.READY},enumerable:!1,configurable:!0}),n.prototype.init=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u,d,h,p,g,E,y,C,T=this;return R(this,function(A){switch(A.label){case 0:return[4,this._mutex.lock()];case 1:A.sent(),A.label=2;case 2:return A.trys.push([2,9,,10]),t=xh.get(this.dbname),[4,n.metadataOf(this.dbname,this.name,this._store)];case 3:return e=A.sent(),this._metadata=e||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:A.sent(),this._blockManager=new OH({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=Nn([],cn(this.indexes),!1),i=[],a=r.map(function(O){return ho.createKey(O)}),s=e?e.indexes.map(function(O){return ho.createKey(O)}):[];try{for(u=Le(s),d=u.next();!d.done;d=u.next())h=d.value,a.includes(h)||i.push(ho.parseKey(h))}catch(O){y={error:O}}finally{try{d&&!d.done&&(C=u.return)&&C.call(u)}finally{if(y)throw y.error}}return(p=[]).push.apply(p,Nn([],cn(r.map(function(O){var N=new ho({dbname:T.dbname,collectionName:T.name,keyName:T.keyName,fields:O,transaction:T._transaction,store:T._store});return T._indexers.push(N),N.ensure()})),!1)),p.push.apply(p,Nn([],cn(i.map(function(O){return new ho({dbname:T.dbname,collectionName:T.name,keyName:T.keyName,fields:O,transaction:T._transaction,store:T._store}).drop()})),!1)),[4,Promise.all(p)];case 5:return A.sent(),[4,this._transaction.commit()];case 6:return A.sent(),a.sort().join(",")===s.sort().join(",")?[3,8]:(g=gE(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:g,value:this._metadata})]);case 7:A.sent(),A.label=8;case 8:return this._state=jl.READY,this._mutex.unlock(),[3,10];case 9:throw E=A.sent(),this._mutex.unlock(),E;case 10:return[2]}})})},n.prototype.close=function(){this._state=jl.CLOSED},n.prototype._hasPropertyOfKeyName=function(t){var e=t[this.keyName];return typeof e=="string"&&!!e},n.prototype._getIndexerBy=function(t){var e,r;t===void 0&&(t=null),t||(t=[this.keyName]);var i=ho.createKey(t);try{for(var a=Le(this._indexers),s=a.next();!s.done;s=a.next()){var u=s.value;if(i===ho.createKey(u.fields))return u}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}throw $t.indexTableIsRequired},n.prototype._upgradeBlockLevel=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return t=gE(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:t,value:this._metadata})];case 1:return e.sent(),[2]}})})},n.prototype._requestInsert=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return e=t[this.keyName],[4,this._blockManager.getFromBlock(e)];case 1:return d.sent()?[3,13]:[4,this._blockManager.putToBlock(e,t)];case 2:return d.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return d.sent(),[4,this._blockManager.putToBlock(e,t)];case 4:d.sent(),d.label=5;case 5:d.trys.push([5,10,11,12]),r=Le(this._indexers),i=r.next(),d.label=6;case 6:return i.done?[3,9]:[4,i.value.addItem(t)];case 7:d.sent(),d.label=8;case 8:return i=r.next(),[3,6];case 9:return[3,12];case 10:return a=d.sent(),s={error:a},[3,12];case 11:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}return[7];case 12:return[3,14];case 13:throw $t.collectionInsertDuplicate;case 14:return[2]}})})},n.prototype._requestUpsert=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p,g,E,y,C;return R(this,function(T){switch(T.label){case 0:return e=t[this.keyName],[4,this._blockManager.getFromBlock(e)];case 1:return(r=T.sent())?[3,13]:[4,this._blockManager.putToBlock(e,t)];case 2:return T.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return T.sent(),[4,this._blockManager.putToBlock(e,t)];case 4:T.sent(),T.label=5;case 5:T.trys.push([5,10,11,12]),i=Le(this._indexers),a=i.next(),T.label=6;case 6:return a.done?[3,9]:[4,(h=a.value).addItem(t)];case 7:T.sent(),T.label=8;case 8:return a=i.next(),[3,6];case 9:return[3,12];case 10:return s=T.sent(),g={error:s},[3,12];case 11:try{a&&!a.done&&(E=i.return)&&E.call(i)}finally{if(g)throw g.error}return[7];case 12:return[3,23];case 13:return[4,this._blockManager.putToBlock(e,t)];case 14:T.sent(),T.label=15;case 15:T.trys.push([15,21,22,23]),u=Le(this._indexers),d=u.next(),T.label=16;case 16:return d.done?[3,20]:(h=d.value).diff(h.getColumnValues(r),h.getColumnValues(t))===0?[3,19]:[4,h.removeItem(r)];case 17:return T.sent(),[4,h.addItem(t)];case 18:T.sent(),T.label=19;case 19:return d=u.next(),[3,16];case 20:return[3,23];case 21:return p=T.sent(),y={error:p},[3,23];case 22:try{d&&!d.done&&(C=u.return)&&C.call(u)}finally{if(y)throw y.error}return[7];case 23:return[2]}})})},n.prototype._requestUpdate=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return e=t[this.keyName],[4,this._blockManager.getFromBlock(e)];case 1:return(r=p.sent())?[4,this._blockManager.putToBlock(e,t)]:[3,11];case 2:p.sent(),p.label=3;case 3:p.trys.push([3,9,10,11]),i=Le(this._indexers),a=i.next(),p.label=4;case 4:return a.done?[3,8]:(s=a.value).diff(s.getColumnValues(r),s.getColumnValues(t))===0?[3,7]:[4,s.removeItem(r)];case 5:return p.sent(),[4,s.addItem(t)];case 6:p.sent(),p.label=7;case 7:return a=i.next(),[3,4];case 8:return[3,11];case 9:return u=p.sent(),d={error:u},[3,11];case 10:try{a&&!a.done&&(h=i.return)&&h.call(i)}finally{if(d)throw d.error}return[7];case 11:return[2]}})})},n.prototype._requestRemove=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return[4,this._blockManager.getFromBlock(t)];case 1:return(e=d.sent())?[4,this._blockManager.removeFromBlock(t)]:[3,10];case 2:d.sent(),d.label=3;case 3:d.trys.push([3,8,9,10]),r=Le(this._indexers),i=r.next(),d.label=4;case 4:return i.done?[3,7]:[4,i.value.removeItem(e)];case 5:d.sent(),d.label=6;case 6:return i=r.next(),[3,4];case 7:return[3,10];case 8:return a=d.sent(),s={error:a},[3,10];case 9:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}return[7];case 10:return[2]}})})},n.prototype._requestClear=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a;return R(this,function(s){switch(s.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:s.sent(),s.label=2;case 2:s.trys.push([2,7,8,9]),t=Le(this._indexers),e=t.next(),s.label=3;case 3:return e.done?[3,6]:[4,e.value.clear()];case 4:s.sent(),s.label=5;case 5:return e=t.next(),[3,3];case 6:return[3,9];case 7:return r=s.sent(),i={error:r},[3,9];case 8:try{e&&!e.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}return[7];case 9:return[2]}})})},n.prototype.getByKey=function(t){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,6];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(t)];case 3:return e=i.sent(),this._mutex.unlock(),[2,ua(e)];case 4:throw r=i.sent(),this._mutex.unlock(),r;case 5:return[3,7];case 6:throw $t.collectionNotReady;case 7:return[2]}})})},n.prototype.query=function(t){if(t===void 0&&(t={}),this.isReady)return new wH({condition:t.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(t.index),backward:!!t.backward});throw $t.collectionNotReady},n.prototype.insertOne=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(t))throw $t.collectionKeyNotGiven;return[4,this._requestInsert(ua(t))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,t];case 5:return e=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw $t.collectionNotReady;case 9:return[2]}})})},n.prototype.insertMany=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h=this;return R(this,function(p){switch(p.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:p.sent(),p.label=2;case 2:if(p.trys.push([2,12,,14]),t.some(function(g){return!h._hasPropertyOfKeyName(g)}))throw $t.collectionKeyNotGiven;p.label=3;case 3:p.trys.push([3,8,9,10]),e=Le(t),r=e.next(),p.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._requestInsert(ua(i))]);case 5:p.sent(),p.label=6;case 6:return r=e.next(),[3,4];case 7:return[3,10];case 8:return a=p.sent(),u={error:a},[3,10];case 9:try{r&&!r.done&&(d=e.return)&&d.call(e)}finally{if(u)throw u.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return p.sent(),this._mutex.unlock(),[2,t];case 12:return s=p.sent(),[4,this._transaction.clear()];case 13:throw p.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw $t.collectionNotReady;case 16:return[2]}})})},n.prototype.upsertOne=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(t))throw $t.collectionKeyNotGiven;return[4,this._requestUpsert(ua(t))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,t];case 5:return e=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw $t.collectionNotReady;case 9:return[2]}})})},n.prototype.upsertMany=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h=this;return R(this,function(p){switch(p.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:p.sent(),p.label=2;case 2:if(p.trys.push([2,12,,14]),t.some(function(g){return!h._hasPropertyOfKeyName(g)}))throw $t.collectionKeyNotGiven;p.label=3;case 3:p.trys.push([3,8,9,10]),e=Le(t),r=e.next(),p.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._requestUpsert(ua(i))]);case 5:p.sent(),p.label=6;case 6:return r=e.next(),[3,4];case 7:return[3,10];case 8:return a=p.sent(),u={error:a},[3,10];case 9:try{r&&!r.done&&(d=e.return)&&d.call(e)}finally{if(u)throw u.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return p.sent(),this._mutex.unlock(),[2,t];case 12:return s=p.sent(),[4,this._transaction.clear()];case 13:throw p.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw $t.collectionNotReady;case 16:return[2]}})})},n.prototype.update=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(t))throw $t.collectionKeyNotGiven;return[4,this._requestUpdate(ua(t))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,t];case 5:return e=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw $t.collectionNotReady;case 9:return[2]}})})},n.prototype.updateIf=function(t,e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O=this;return R(this,function(N){switch(N.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,16];case 1:N.sent(),N.label=2;case 2:return N.trys.push([2,13,,15]),r=t.where,i=r===void 0?{}:r,a=t.index,s=a===void 0?null:a,u=t.backward,d=u!==void 0&&u,h=[],[4,new cy({condition:i,blockManager:this._blockManager,backward:d,indexer:this._getIndexerBy(s)}).each(function(k){return M(O,void 0,void 0,function(){var D;return R(this,function(P){if(k.error)throw k.stop(),k.error;return k.hasNext?(D=k.nextValue,Kl(i,D)&&e.set&&(typeof e.set!="function"?Object.keys(e.set).forEach(function(U){var L;D[U]=(L=e.set)===null||L===void 0?void 0:L[U]}):e.set(D),h.push(D)),k.next()):k.stop(),[2]})})})];case 3:N.sent(),N.label=4;case 4:N.trys.push([4,9,10,11]),p=Le(h),g=p.next(),N.label=5;case 5:return g.done?[3,8]:(E=g.value,[4,this._requestUpdate(ua(E))]);case 6:N.sent(),N.label=7;case 7:return g=p.next(),[3,5];case 8:return[3,11];case 9:return y=N.sent(),T={error:y},[3,11];case 10:try{g&&!g.done&&(A=p.return)&&A.call(p)}finally{if(T)throw T.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return N.sent(),this._mutex.unlock(),[2,h];case 13:return C=N.sent(),[4,this._transaction.clear()];case 14:throw N.sent(),this._mutex.unlock(),C;case 15:return[3,17];case 16:throw this._transaction.clear(),$t.collectionNotReady;case 17:return[2]}})})},n.prototype.remove=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,5,,7]),[4,this._requestRemove(t)];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[3,7];case 5:return e=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw $t.collectionNotReady;case 9:return[2]}})})},n.prototype.removeIf=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p,g,E,y,C,T,A=this;return R(this,function(O){switch(O.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:O.sent(),O.label=2;case 2:return O.trys.push([2,13,,14]),e=t.where,r=e===void 0?{}:e,i=t.index,a=i===void 0?null:i,s=t.backward,u=s!==void 0&&s,d=[],[4,new cy({condition:r,blockManager:this._blockManager,backward:u,indexer:this._getIndexerBy(a)}).each(function(N){return M(A,void 0,void 0,function(){var k,D;return R(this,function(P){if(N.error)throw N.stop(),N.error;return N.hasNext?(k=N.nextValue,Kl(r,k)&&(D=k[this.keyName],d.push(D)),N.next()):N.stop(),[2]})})})];case 3:O.sent(),O.label=4;case 4:O.trys.push([4,9,10,11]),h=Le(d),p=h.next(),O.label=5;case 5:return p.done?[3,8]:(g=p.value,[4,this._requestRemove(g)]);case 6:O.sent(),O.label=7;case 7:return p=h.next(),[3,5];case 8:return[3,11];case 9:return E=O.sent(),C={error:E},[3,11];case 10:try{p&&!p.done&&(T=h.return)&&T.call(h)}finally{if(C)throw C.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return O.sent(),this._mutex.unlock(),[2,d];case 13:throw y=O.sent(),this._mutex.unlock(),y;case 14:return[3,16];case 15:throw this._transaction.clear(),$t.collectionNotReady;case 16:return[2]}})})},n.prototype.clear=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return e.sent(),[4,this._transaction.commit()];case 4:return e.sent(),this._mutex.unlock(),[3,7];case 5:return t=e.sent(),[4,this._transaction.clear()];case 6:throw e.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw $t.collectionNotReady;case 9:return[2]}})})},n.prototype.getBlob=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this._blobContainer.get(t)];case 1:return[2,e.sent()]}})})},n.prototype.saveBlob=function(t,e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._blobContainer.save(t,e)];case 1:return[2,r.sent()]}})})},n.prototype.removeBlob=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this._blobContainer.remove(t)];case 1:return e.sent(),[2]}})})},n.prototype.removeAllBlobs=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,this._blobContainer.clear()];case 1:return t.sent(),[2]}})})},n}(),yE="[NESTDB]",i_=!0,Sl=function(){function n(){}return n.off=function(){i_=!1},n.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i_&&console.log.apply(console,Nn(["".concat(yE,"[LOG]")],cn(t),!1))},n.warning=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i_&&console.warn.apply(console,Nn(["".concat(yE,"[WARNING]")],cn(t),!1))},n.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i_&&console.error.apply(console,Nn(["".concat(yE,"[ERROR]")],cn(t),!1))},n}(),kH=[{},{a:700400,n:"error"}],Um=function(){function n(t){var e,r,i;this.encryption=(e=t.encryption)!==null&&e!==void 0?e:l2,this.itemSizeLimit=(r=t.itemSizeLimit)!==null&&r!==void 0?r:4194304,this.metadataBuffer=(i=t.metadataBuffer)!==null&&i!==void 0?i:256}return Object.defineProperty(n.prototype,"_encryptionCheckKey",{get:function(){return"".concat(this.dbname,".encrypt")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_reservedKeys",{get:function(){return[this._encryptionCheckKey]},enumerable:!1,configurable:!0}),n.prototype._getRawKey=function(t,e){return e===void 0&&(e=""),"".concat(t).concat(e)},n.prototype._generateShardPostfixArray=function(t){return t===void 0&&(t=1),Nn([],cn(Array(t).keys()),!1)},n.prototype._shardify=function(t){var e=this,r=t.key,i=t.value,a=JSON.stringify(this.encryption.encrypt(i)),s=Math.ceil(a.length/this.adjustedItemSizeLimit);return this._generateShardPostfixArray(s).map(function(u){var d={key:e._getRawKey(r,".".concat(u)),data:a.substring(u*e.adjustedItemSizeLimit,(u+1)*e.adjustedItemSizeLimit)};return u===0&&(d.metadata={shards:s}),d})},n.prototype._resetIfEncryptionChanged=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u,d,h,p=this;return R(this,function(g){switch(g.label){case 0:return[4,this.get(this._encryptionCheckKey)];case 1:if(t=g.sent(),e={encrypted:kH.map(function(E){var y;return(y=p.encryption)===null||y===void 0?void 0:y.encrypt(E)})},!t)return[3,8];if(!t.encrypted||!Array.isArray(t.encrypted))return[3,6];for(a in r=t.encrypted,i=[],r)i.push(a);s=0,g.label=2;case 2:return s<i.length?(a=i[s])in r?(u=a,d=JSON.stringify(t.encrypted[u]),h=JSON.stringify(e.encrypted[u]),d===h?[3,4]:(Sl.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this.clear()])):[3,4]:[3,5];case 3:return g.sent(),[3,5];case 4:return s++,[3,2];case 5:return[3,8];case 6:return[4,this.clear()];case 7:g.sent(),g.label=8;case 8:return[4,this.set({key:this._encryptionCheckKey,value:e})];case 9:return g.sent(),[2]}})})},Object.defineProperty(n.prototype,"adjustedItemSizeLimit",{get:function(){return Math.max(this.itemSizeLimit-this.metadataBuffer,4)},enumerable:!1,configurable:!0}),n.prototype.usage=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return t=0,[4,this._getAllRawKeys()];case 1:e=p.sent(),p.label=2;case 2:p.trys.push([2,7,8,9]),r=Le(e),i=r.next(),p.label=3;case 3:return i.done?[3,6]:(a=i.value,[4,this._getRaw(a)]);case 4:(s=p.sent())&&(t+=JSON.stringify(s).length),p.label=5;case 5:return i=r.next(),[3,3];case 6:return[3,9];case 7:return u=p.sent(),d={error:u},[3,9];case 8:try{i&&!i.done&&(h=r.return)&&h.call(r)}finally{if(d)throw d.error}return[7];case 9:return[2,t]}})})},n.prototype.getAllKeys=function(){return M(this,void 0,void 0,function(){var t=this;return R(this,function(e){switch(e.label){case 0:return[4,this._getAllRawKeys()];case 1:return[2,e.sent().filter(function(r){return r.endsWith(".0")}).map(function(r){return r.replace(/\.0$/,"")}).filter(function(r){return!t._reservedKeys.includes(r)})]}})})},n.prototype.get=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d=this;return R(this,function(h){switch(h.label){case 0:return e=this._getRawKey(t,".0"),[4,this._getRaw(e)];case 1:if(!(r=h.sent()))return[3,7];h.label=2;case 2:return h.trys.push([2,6,,7]),i=r.data,(a=r.metadata)!=null&&a.shards&&a.shards>1?[4,Promise.all(this._generateShardPostfixArray(a==null?void 0:a.shards).map(function(p){return M(d,void 0,void 0,function(){var g,E;return R(this,function(y){switch(y.label){case 0:return p>0?(g=this._getRawKey(t,".".concat(p)),[4,this._getRaw(g)]):[3,2];case 1:if(!(E=y.sent()))throw $t.storeBrokenIntegrity;return[2,E.data];case 2:return[2,i]}})})}))]:[3,4];case 3:return u=h.sent(),[3,5];case 4:u=[i],h.label=5;case 5:return s=u,[2,this.encryption.decrypt(JSON.parse(s.join("")))];case 6:return h.sent(),[2,null];case 7:return[2,null]}})})},n.prototype.set=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return e=this._shardify(t),[4,this._setRaw(e)];case 1:return r.sent(),[2,W({},t.value)]}})})},n.prototype.setMany=function(t){return M(this,void 0,void 0,function(){var e,r=this;return R(this,function(i){switch(i.label){case 0:return e=[],[4,this._setRaw(e.concat.apply(e,Nn([],cn(t.map(function(a){return r._shardify(a)})),!1)))];case 1:return i.sent(),[2,t.map(function(a){return a.value})]}})})},n.prototype.remove=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u=this;return R(this,function(d){switch(d.label){case 0:return e=this._getRawKey(t,".0"),[4,this._getRaw(e)];case 1:return(r=d.sent())?(i=r.metadata,a=this._generateShardPostfixArray(i==null?void 0:i.shards).map(function(h){return u._getRawKey(t,".".concat(h))}),[4,this._removeRaw(a)]):[3,3];case 2:return d.sent(),(s=la.get(this.dbname))==null||s.remove(t),[2,!0];case 3:return[2,!1]}})})},n.prototype.removeMany=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p,g,E=this;return R(this,function(y){switch(y.label){case 0:e=la.get(this.dbname),r=[],i=function(C){var T,A,O;return R(this,function(N){switch(N.label){case 0:return T=a._getRawKey(C,".0"),[4,a._getRaw(T)];case 1:return(A=N.sent())&&(O=A.metadata,r.push.apply(r,Nn([],cn(a._generateShardPostfixArray(O==null?void 0:O.shards).map(function(k){return E._getRawKey(C,".".concat(k))})),!1))),e==null||e.remove(C),[2]}})},a=this,y.label=1;case 1:y.trys.push([1,6,7,8]),s=Le(t),u=s.next(),y.label=2;case 2:return u.done?[3,5]:(d=u.value,[5,i(d)]);case 3:y.sent(),y.label=4;case 4:return u=s.next(),[3,2];case 5:return[3,8];case 6:return h=y.sent(),p={error:h},[3,8];case 7:try{u&&!u.done&&(g=s.return)&&g.call(s)}finally{if(p)throw p.error}return[7];case 8:return r.length>0?[4,this._removeRaw(r)]:[3,10];case 9:y.sent(),y.label=10;case 10:return[2,t]}})})},n.prototype.clear=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){return(t=la.get(this.dbname))==null||t.clearForDatabase(this.dbname),[2]})})},n}(),ra={},kl=function(n){function t(e){e===void 0&&(e={});var r,i=this;i=n.call(this,W(W({},e),{itemSizeLimit:(r=e.itemSizeLimit)!==null&&r!==void 0?r:4194304}))||this;var a=e.delay,s=a===void 0?1:a;return i.delay=s,i.observer={},i}return j(t,n),Object.defineProperty(t.prototype,"rawData",{get:function(){return ra[this.dbname]},set:function(e){ra[this.dbname]=e},enumerable:!1,configurable:!0}),t.prototype._getAllRawKeys=function(){return M(this,void 0,void 0,function(){return R(this,function(e){if(ra[this.dbname])return[2,Object.keys(ra[this.dbname])];throw $t.storeNotAvailable})})},t.prototype._getRaw=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return ra[this.dbname]?[4,t_(this.delay)]:[3,2];case 1:return r.sent(),[2,ra[this.dbname][e]?W({key:e},ra[this.dbname][e]):null];case 2:throw $t.storeNotAvailable}})})},t.prototype._setRaw=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p;return R(this,function(g){switch(g.label){case 0:return ra[this.dbname]?[4,t_(this.delay)]:[3,2];case 1:g.sent();try{for(r=Le(e),i=r.next();!i.done;i=r.next())a=i.value,s=a.key,u=a.data,d=a.metadata,ra[this.dbname][s]=Object.freeze({data:u,metadata:d})}catch(E){h={error:E}}finally{try{i&&!i.done&&(p=r.return)&&p.call(r)}finally{if(h)throw h.error}}return[3,3];case 2:throw $t.storeNotAvailable;case 3:return[2]}})})},t.prototype._removeRaw=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return ra[this.dbname]?[4,t_(this.delay)]:[3,2];case 1:d.sent();try{for(r=Le(e),i=r.next();!i.done;i=r.next())a=i.value,ra[this.dbname][a]&&delete ra[this.dbname][a]}catch(h){s={error:h}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}return[3,3];case 2:throw $t.storeNotAvailable;case 3:return[2]}})})},t.prototype.observe=function(e,r,i){var a=this;this.observer[e]||(this.observer[e]={}),r.forEach(function(s){return a.observer[e][s]=i})},t.prototype.checkAvailability=function(){return M(this,void 0,void 0,function(){return R(this,function(e){return[2]})})},t.prototype.init=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return this.dbname=e,ra[this.dbname]||(ra[this.dbname]={}),[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},t.prototype.set=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){if((r=this.observer[e.key])&&typeof r.set=="function"&&(i=r.set()))throw i;return[2,n.prototype.set.call(this,e)]})})},t.prototype.setMany=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){try{for(r=Le(e),i=r.next();!i.done;i=r.next())if(a=i.value,(s=this.observer[a.key])&&typeof s.set=="function"&&(u=s.set()))throw u}catch(g){d={error:g}}finally{try{i&&!i.done&&(h=r.return)&&h.call(r)}finally{if(d)throw d.error}}return[2,n.prototype.setMany.call(this,e)]})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,n.prototype.clear.call(this)];case 1:return e.sent(),[4,t_(this.delay)];case 2:return e.sent(),ra[this.dbname]={},[2]}})})},t}(Um),B1="NestDBStore";(function(n){n[n.UNINITIALIZED=0]="UNINITIALIZED",n[n.OPENING=1]="OPENING",n[n.OPEN=2]="OPEN",n[n.CLOSED=3]="CLOSED"})(ys||(ys={}));var Ys,DH=function(n){function t(e){e===void 0&&(e={});var r,i=this;return(i=n.call(this,W(W({},e),{itemSizeLimit:(r=e.itemSizeLimit)!==null&&r!==void 0?r:104857600}))||this)._storeName=B1,i._state=ys.UNINITIALIZED,i._openJobQueue=[],i._window=typeof window<"u"?window:void 0,i._indexedDb=i._window?i._window.indexedDB||i._window.mozIndexedDB||i._window.webkitIndexedDB||i._window.msIndexedDB:void 0,i}return j(t,n),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.isTransactionInactiveError=function(e){return e instanceof Error&&e.message.includes("The transaction is inactive")},t.prototype._putToObjectStore=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){return[2,new Promise(function(a,s){var u=e.put(r);u.addEventListener("success",function(d){a(d.target.result)}),u.addEventListener("error",function(){s("Failed to write.")})})]})})},t.prototype._deleteFromObjectStore=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){return[2,new Promise(function(a,s){var u=e.delete(r);u.addEventListener("success",function(){return a(r)}),u.addEventListener("error",function(d){return s(d.target.error)})})]})})},t.prototype._openDatabase=function(e){var r=this;return new Promise(function(i,a){if(r._indexedDb){r._state=ys.OPENING;var s=r._indexedDb.open(e);s.addEventListener("upgradeneeded",function(u){u.target.result.createObjectStore(B1,{keyPath:"key"})}),s.addEventListener("success",function(u){r._state=ys.OPEN,r._database=u.target.result,r._openJobQueue.forEach(function(d){return d()}),r._openJobQueue=[],r._database.onclose=function(){r._database=void 0,r._state=ys.OPENING,setTimeout(function(){r._openDatabase(e)},5)},i(r._database)}),s.addEventListener("error",function(u){r._state=ys.UNINITIALIZED,a(u.target.error)})}else a($t.storeNotAvailable)})},t.prototype._getObjectStore=function(e){return M(this,void 0,void 0,function(){var r=this;return R(this,function(i){switch(i.label){case 0:return this._database?[2,this._database.transaction(this._storeName,e).objectStore(this._storeName)]:[3,1];case 1:switch(this._state){case ys.UNINITIALIZED:case ys.OPEN:return[3,2];case ys.OPENING:case ys.CLOSED:return[3,3]}return[3,4];case 2:throw $t.storeNotInitialized;case 3:return[2,new Promise(function(a){r._openJobQueue.push(function(){return a(r._getObjectStore(e))})})];case 4:return[4,this._getObjectStore(e)];case 5:return[2,i.sent()]}})})},t.prototype._getAllRawKeys=function(){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return e=r.sent(),[4,new Promise(function(i,a){var s=e.getAllKeys();s.addEventListener("success",function(u){i(u.target.result)}),s.addEventListener("error",function(u){return a(u.target.error)})})];case 2:return[2,r.sent()]}})})},t.prototype._getRaw=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return r=i.sent(),[4,new Promise(function(a,s){var u=r.get(e);u.addEventListener("success",function(d){var h;a((h=d==null?void 0:d.target)===null||h===void 0?void 0:h.result)}),u.addEventListener("error",function(d){return s(d.target.error)})})];case 2:return[2,i.sent()]}})})},t.prototype._setRaw=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g=this;return R(this,function(E){switch(E.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:r=E.sent(),E.label=2;case 2:return E.trys.push([2,4,,15]),[4,Promise.all(e.map(function(y){return g._putToObjectStore(r,y)}))];case 3:return E.sent(),[3,15];case 4:if(i=E.sent(),!this.isTransactionInactiveError(i))return[3,13];E.label=5;case 5:E.trys.push([5,10,11,12]),a=Le(e),s=a.next(),E.label=6;case 6:return s.done?[3,9]:(u=s.value,[4,this._putToObjectStore(r,u)]);case 7:E.sent(),E.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return d=E.sent(),h={error:d},[3,12];case 11:try{s&&!s.done&&(p=a.return)&&p.call(a)}finally{if(h)throw h.error}return[7];case 12:return[3,14];case 13:throw i;case 14:return[3,15];case 15:return[2]}})})},t.prototype._removeRaw=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g=this;return R(this,function(E){switch(E.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:r=E.sent(),E.label=2;case 2:return E.trys.push([2,4,,15]),[4,Promise.all(e.map(function(y){return g._deleteFromObjectStore(r,y)}))];case 3:return E.sent(),[3,15];case 4:if(i=E.sent(),!this.isTransactionInactiveError(i))return[3,13];E.label=5;case 5:E.trys.push([5,10,11,12]),a=Le(e),s=a.next(),E.label=6;case 6:return s.done?[3,9]:(u=s.value,[4,this._deleteFromObjectStore(r,u)]);case 7:E.sent(),E.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return d=E.sent(),h={error:d},[3,12];case 11:try{s&&!s.done&&(p=a.return)&&p.call(a)}finally{if(h)throw h.error}return[7];case 12:return[3,14];case 13:throw i;case 14:return[3,15];case 15:return[2]}})})},t.prototype._triggerDatabaseClose=function(){this._database&&this._database.onclose&&this._database.onclose(new Event("dummy"))},t.prototype.checkAvailability=function(){return M(this,void 0,void 0,function(){var e,r=this;return R(this,function(i){switch(i.label){case 0:if(!((e=typeof window<"u"?window:null)!=null&&e.indexedDB||e!=null&&e.mozIndexedDB||e!=null&&e.webkitIndexedDB||e!=null&&e.msIndexedDB))return[3,6];if(this._indexedDb=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,!this._window||!im())return[3,4];if(!(im()&&navigator.userAgent&&navigator.userAgent.includes("Edge/")))return[3,1];if(!this._window.indexedDB&&(e.PointerEvent||e.MSPointerEvent))throw $t.storeNotAvailableInPrivateBrowsing;return[3,3];case 1:return[4,new Promise(function(a,s){if(r._indexedDb)try{var u=r._indexedDb.open("_testMozilla");u.onerror=function(){return s($t.storeNotAvailableInPrivateBrowsing)},u.onsuccess=function(d){if(d.target.result.close(),r._indexedDb){var h=r._indexedDb.deleteDatabase("_testMozilla");h.onerror=function(){return a()},h.onsuccess=function(){return a()}}else s($t.storeNotAvailable)}}catch{s($t.storeNotAvailableInPrivateBrowsing)}else s($t.storeNotAvailable)})];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:throw $t.storeNotAvailable;case 5:return[3,7];case 6:throw $t.storeNotAvailable;case 7:return[2]}})})},t.prototype.init=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return this.dbname=e,[4,this.checkAvailability()];case 1:return r.sent(),[4,this._openDatabase(e)];case 2:return r.sent(),[4,this._resetIfEncryptionChanged()];case 3:return r.sent(),[2]}})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return[4,n.prototype.clear.call(this)];case 1:return r.sent(),[4,this._getObjectStore("readwrite")];case 2:return e=r.sent(),[4,new Promise(function(i,a){var s=e.clear();s.addEventListener("success",function(){return i()}),s.addEventListener("error",function(u){return a(u.target.error)})})];case 3:return[2,r.sent()]}})})},t}(Um),LH=function(n){function t(e){var r=this,i=e.AsyncStorage,a=e.itemSizeLimit,s=a===void 0?2097152:a,u=h5(e,["AsyncStorage","itemSizeLimit"]);return(r=n.call(this,W(W({},u),{itemSizeLimit:s}))||this)._asyncStorage=i,r}return j(t,n),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return M(this,void 0,void 0,function(){var e,r=this;return R(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.getAllKeys()];case 1:return e=i.sent(),[2,e.filter(function(a){return r._isBelonging(a)}).map(function(a){return a.substring("".concat(r.dbname,"/").length)})]}})})},t.prototype._getRaw=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return[2,(r=i.sent())?JSON.parse(r):null]}})})},t.prototype._setRaw=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:r=[];try{for(i=Le(e),a=i.next();!a.done;a=i.next())s=a.value,u=s.key,s.data.length<=this.adjustedItemSizeLimit&&r.push([this._getActualKey(u),JSON.stringify(s)])}catch(g){d={error:g}}finally{try{a&&!a.done&&(h=i.return)&&h.call(i)}finally{if(d)throw d.error}}return[4,this._asyncStorage.multiSet(r)];case 1:return p.sent(),[2]}})})},t.prototype._removeRaw=function(e){return M(this,void 0,void 0,function(){var r=this;return R(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.multiRemove(e.map(function(a){return r._getActualKey(a)}))];case 1:return i.sent(),[2]}})})},t.prototype.checkAvailability=function(){return M(this,void 0,void 0,function(){return R(this,function(e){if(!this._asyncStorage)throw $t.storeNotAvailable;return[2]})})},t.prototype.init=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return[4,n.prototype.clear.call(this)];case 1:return r.sent(),[4,this.getAllKeys()];case 2:return e=r.sent(),[4,this.removeMany(e)];case 3:return r.sent(),[2]}})})},t}(Um),xH=function(n){function t(e){var r,i=this;return(i=n.call(this,W(W({},e),{itemSizeLimit:(r=e.itemSizeLimit)!==null&&r!==void 0?r:6291456}))||this)._mmkv=e.MMKV,i}return j(t,n),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return M(this,void 0,void 0,function(){var e,r=this;return R(this,function(i){switch(i.label){case 0:return[4,this._mmkv.getAllKeys()];case 1:return e=i.sent(),[2,e.filter(function(a){return r._isBelonging(a)}).map(function(a){return a.substring("".concat(r.dbname,"/").length)})]}})})},t.prototype._getRaw=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return[4,this._mmkv.getString(this._getActualKey(e))];case 1:return[2,(r=i.sent())?JSON.parse(r):null]}})})},t.prototype._setRaw=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){try{for(r=Le(e),i=r.next();!i.done;i=r.next())a=i.value,s=a.key,a.data.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(s),JSON.stringify(a))}catch(p){u={error:p}}finally{try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(u)throw u.error}}return[2]})})},t.prototype._removeRaw=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u;return R(this,function(d){try{for(r=Le(e),i=r.next();!i.done;i=r.next())a=i.value,this._mmkv.delete(this._getActualKey(a))}catch(h){s={error:h}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}return[2]})})},t.prototype.checkAvailability=function(){return M(this,void 0,void 0,function(){return R(this,function(e){if(!this._mmkv)throw $t.storeNotAvailable;return[2]})})},t.prototype.init=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:return[4,n.prototype.clear.call(this)];case 1:return r.sent(),[4,this.getAllKeys()];case 2:return e=r.sent(),[4,this.removeMany(e)];case 3:return r.sent(),[2]}})})},t}(Um);(function(n){n.INIT="INIT",n.OPENING="OPENING",n.OPENED="OPENED",n.CLOSED="CLOSED"})(Ys||(Ys={}));var Ou,UH=function(){function n(t){var e=t.name,r=t.version,i=t.store,a=t.config;this.name=e,this._version=r,this._state=Ys.INIT,this._config=a||new xh({dbname:e}),this._store=i,this._event={success:Kf,error:Kf,storeReplaced:Kf,upgrade:U1},this._collections=new Map,this._globalMutex=new pC("".concat(this.name,".lock")),this._config.disableLogger&&Sl.off(),new la({dbname:e,limit:this._config.cacheLimit})}return Object.defineProperty(n.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),n.prototype._initializeCollection=function(t,e){var r;return M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return a=this._collections.get(t),e?(i=new EE({dbname:this.name,collectionName:t,keyName:e.keyName,indexes:(r=e.index)!==null&&r!==void 0?r:[[e.keyName]],store:this._store}),[3,3]):[3,1];case 1:return a&&a.state===jl.READY?[3,3]:[4,EE.metadataOf(this.name,t,this._store)];case 2:(s=u.sent())&&(i=new EE({dbname:this.name,collectionName:t,keyName:s.keyName,indexes:s.indexes,store:this._store})),u.label=3;case 3:return i?(this._collections.set(t,i),[4,i.init()]):[3,5];case 4:u.sent(),u.label=5;case 5:return[2]}})})},n.prototype.estimateUsage=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,(e=this._store,M(void 0,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,e.usage()];case 1:return[2,r.sent()]}})}))];case 1:return[2,t.sent()]}var e})})},n.prototype.commitSchema=function(t){return M(this,void 0,void 0,function(){var e=this;return R(this,function(r){switch(r.label){case 0:return this._state!==Ys.OPENING?[3,2]:[4,Promise.all(t.map(function(i){return M(e,void 0,void 0,function(){return R(this,function(a){switch(a.label){case 0:return[4,this._initializeCollection(i.collectionName,i)];case 1:return a.sent(),[2]}})})}))];case 1:return r.sent(),[3,3];case 2:throw $t.databaseSchemaNotOnUpgrade;case 3:return[2]}})})},n.prototype.open=function(){var t;return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p,g,E=this;return R(this,function(y){switch(y.label){case 0:return[4,this._globalMutex.lock()];case 1:if(y.sent(),this._state===Ys.OPENED)return[3,20];this._state=Ys.OPENING,y.label=2;case 2:return y.trys.push([2,13,,20]),[4,this._store.init(this.name)];case 3:return y.sent(),C=this.name,e="".concat(hC(C),".metadata"),r={version:0,collectionNames:[]},[4,this._store.get(e)];case 4:i=(t=y.sent())!==null&&t!==void 0?t:r,y.label=5;case 5:y.trys.push([5,10,11,12]),a=Le(i.collectionNames),s=a.next(),y.label=6;case 6:return s.done?[3,9]:(u=s.value,[4,this._initializeCollection(u)]);case 7:y.sent(),y.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return d=y.sent(),p={error:d},[3,12];case 11:try{s&&!s.done&&(g=a.return)&&g.call(a)}finally{if(p)throw p.error}return[7];case 12:return[2,new Promise(function(T,A){var O=function(k){i.version<E._version?E._event.upgrade(i.version,function(D){return M(E,void 0,void 0,function(){var P;return R(this,function(U){switch(U.label){case 0:if(D)return[3,5];i.version++,i.collectionNames=Array.from(this._collections.keys()),U.label=1;case 1:return U.trys.push([1,3,,4]),[4,this._store.set({key:e,value:i})];case 2:return U.sent(),k({continued:!0}),[3,4];case 3:return P=U.sent(),k({continued:!1,err:P}),[3,4];case 4:return[3,6];case 5:k({continued:!1,err:D}),U.label=6;case 6:return[2]}})})}):k({continued:!1})},N=function(k){var D=k.continued,P=D!==void 0&&D,U=k.err,L=U===void 0?null:U;P?setTimeout(function(){return O(N)},10):L?(Sl.error(L.message),E._globalMutex.unlock(),E._event.error(L),A(L)):Promise.all(i.collectionNames.map(function(B){return E._initializeCollection(B)})).then(function(){E._state=Ys.OPENED,E._globalMutex.unlock(),E._event.success(),T()}).catch(function(B){Sl.error(B.message),E._globalMutex.unlock(),E._event.error(B),A(B)})};O(N)})];case 13:switch(h=y.sent(),h.code){case yr.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,14];case yr.STORE_NOT_AVAILABLE:return[3,16]}return[3,18];case 14:return Sl.warning("Access to the local storage is not allowed. Switched to MemoryStore automatically."),this._store=new kl({}),this._globalMutex.unlock(),this._event.error(h),this._event.storeReplaced(this._store),[4,this.open()];case 15:return y.sent(),[3,19];case 16:return Sl.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new kl({}),this._globalMutex.unlock(),this._event.error(h),this._event.storeReplaced(this._store),[4,this.open()];case 17:return y.sent(),[3,19];case 18:throw Sl.error(h.message),this._globalMutex.unlock(),this._event.error(h),h;case 19:return[3,20];case 20:return[2]}var C})})},n.prototype.close=function(){this._collections.forEach(function(t){return t.close()}),this._state=Ys.CLOSED},n.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,Promise.all(Array.from(this._collections.values()).map(function(e){return e.clear()}))];case 1:return t.sent(),[2]}})})},n.prototype.reset=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return(t=la.get(this.name))&&t.clearForDatabase(this.name),[4,this._store.clear()];case 1:return e.sent(),[2]}})})},n.prototype.on=function(t,e){this._event[t]=e},n.prototype.off=function(t){typeof this._event[t]=="function"&&(t==="upgrade"?this._event[t]=U1:this._event[t]=Kf)},n.prototype.collection=function(t){var e=this._collections.get(t);if(e)return e;throw $t.collectionNotReady},n}();(function(n){n[n.VERBOSE=0]="VERBOSE",n[n.DEBUG=1]="DEBUG",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.NONE=5]="NONE"})(Ou||(Ou={}));var Ei,PH=function(){function n(){this.level=Ou.WARN}return n.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=Ou.VERBOSE&&console.log.apply(console,Nn(["[verbose]"],cn(t),!1))},n.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=Ou.DEBUG&&console.log.apply(console,Nn(["[debug]"],cn(t),!1))},n.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=Ou.INFO&&console.log.apply(console,Nn(["[info]"],cn(t),!1))},n.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=Ou.WARN&&console.warn.apply(console,Nn(["[warn]"],cn(t),!1))},n.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=Ou.ERROR&&console.error.apply(console,Nn(["[error]"],cn(t),!1))},n}(),Uo=function(){function n(t){var e,r,i,a;this.messageTypeFilter=(e=t==null?void 0:t.messageTypeFilter)!==null&&e!==void 0?e:Ni.ALL,this.customTypesFilter=(r=t==null?void 0:t.customTypesFilter)!==null&&r!==void 0?r:null,this.senderUserIdsFilter=(i=t==null?void 0:t.senderUserIdsFilter)!==null&&i!==void 0?i:null,this.replyType=(a=t==null?void 0:t.replyType)!==null&&a!==void 0?a:ti.NONE}return n.prototype.clone=function(){var t=new n,e=JSON.parse(JSON.stringify(this));return Object.keys(e).forEach(function(r){t[r]=e[r]}),t},n.prototype.match=function(t){switch(this.messageTypeFilter){case Ni.USER:if(t.messageType!==Rr.USER)return!1;break;case Ni.FILE:if(t.messageType!==Rr.FILE)return!1;break;case Ni.ADMIN:if(t.messageType!==Rr.ADMIN)return!1}if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(t.customType)||this.senderUserIdsFilter&&this.senderUserIdsFilter.length>0&&(!(t instanceof Lr)||!this.senderUserIdsFilter.includes(t.sender.userId)))return!1;if(t instanceof Hi)switch(this.replyType){case ti.NONE:if(t.parentMessageId>0)return!1;break;case ti.ONLY_REPLY_TO_CHANNEL:if(t instanceof Lr&&t.parentMessageId>0&&!t.replyToChannel)return!1}return!0},n}();(function(n){n.CHANNEL_LATEST="channel_latest",n.NEWEST_CHILD_MESSAGE="newest_child_message"})(Ei||(Ei={}));var dh,eu=function(n){switch(n){case Ei.CHANNEL_LATEST:return["channelUrl","-createdAt","-messageId"];case Ei.NEWEST_CHILD_MESSAGE:return["channelUrl","-parentMessageId","-createdAt","-messageId"]}},FH=function(){return["channelUrl","-createdAt","-notificationId"]},HH=W(W({},hM),{scheduledAt:void 0}),BH=function(n){return _M(n)&&J("number",n.scheduledAt,!0)},GH=W(W({},Lm),{scheduledAt:0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),VH=function(n){return xm(n)&&J("number",n.scheduledAt)&&(oi(n.file)||J("string",n.fileUrl))&&J("string",n.fileName,!0)&&J("string",n.mimeType,!0)&&J("number",n.fileSize,!0)&&(n.thumbnailSizes===null||n.thumbnailSizes===void 0||n.thumbnailSizes.every(function(t){return J("object",t)&&t.maxWidth>0&&t.maxHeight>0}))},kM="UnsentMessage",jH="reqId",a_={},nd=function(n){function t(e){var r=n.call(this,e)||this;return r._mutex=new pC("unsendmessagecache.lock"),a_[e]=r,r}return j(t,n),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return X.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,r){return r===void 0&&(r=!1),a_[e]&&!r||(a_[e]=new t(e)),a_[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb,r=e==null?void 0:e.collection(kM);if(!r)throw ee.databaseError;return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){if(e.messageId>0)throw ee.invalidParameters;var r,i=W({},e.serialize());return e instanceof Si?(e.messageParams&&(i.messageParams=b1(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(i.scheduledInfo.scheduledMessageParams=(r=e.scheduledInfo.scheduledMessageParams,W(W({},b1(r)),{scheduledAt:r.scheduledAt})))):e instanceof Wr?(e.messageParams&&(i.messageParams=C1(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(i.scheduledInfo.scheduledMessageParams=function(a){return W(W({},C1(a)),{scheduledAt:a.scheduledAt})}(e.scheduledInfo.scheduledMessageParams))):e instanceof Wa&&e.messageParams&&(i.messageParams=function(a){return ze({fileInfoList:a.fileInfoList,isReplyToChannel:a.isReplyToChannel,pushNotificationDeliveryOption:a.pushNotificationDeliveryOption})}(e.messageParams)),i},t.prototype._deserialize=function(e){return e=W(W({},e),{messageId:parseInt(e.messageId)}),ni.of(this._iid).buildMessageFromSerializedData(e)},t.prototype._deserializeWithMessageCreateParams=function(e){var r,i,a;return M(this,void 0,void 0,function(){var s,u,d,h,p,g,E=this;return R(this,function(y){switch(y.label){case 0:return s=ni.of(this._iid),u=this._deserialize(e),e.messageParams?u instanceof Si?(h=e.messageParams,u.messageParams=s.buildUserMessageCreateParamsFromSerializedData(h,u),[3,6]):[3,1]:[3,6];case 1:return u instanceof Wr?(h=e.messageParams).fileKey&&typeof h.fileKey=="string"&&pE((r=h.fileType)!==null&&r!==void 0?r:"")?(d=h,[4,this.collection.getBlob(h.fileKey)]):[3,3]:[3,4];case 2:d.file=(i=y.sent())!==null&&i!==void 0?i:void 0,y.label=3;case 3:return u.messageParams=s.buildFileMessageCreateParamsFromSerializedData(h,u),[3,6];case 4:return u instanceof Wa&&(h=e.messageParams)&&h.fileInfoList?(u.messageParams=s.buildMultipleFilesMessageCreateParamsFromSerializedData(h,u),[4,Promise.all(u.messageParams.fileInfoList.map(function(C){return M(E,void 0,void 0,function(){var T,A,O,N,k;return R(this,function(D){switch(D.label){case 0:return typeof((A=C._uploadedMetaData)===null||A===void 0?void 0:A.fileKey)=="string"&&pE((N=(O=C._uploadedMetaData)===null||O===void 0?void 0:O.fileType)!==null&&N!==void 0?N:"")?(T=C,[4,this.collection.getBlob(C._uploadedMetaData.fileKey)]):[3,2];case 1:T.file=(k=D.sent())!==null&&k!==void 0?k:void 0,D.label=2;case 2:return[2]}})})}))]):[3,6];case 5:y.sent(),y.label=6;case 6:return u.scheduledInfo&&e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams?u instanceof Si?(p=e.scheduledInfo.scheduledMessageParams,u.scheduledInfo.scheduledMessageParams=s.buildScheduledUserMessageCreateParamsFromSerializedData(p,u),[3,10]):[3,7]:[3,10];case 7:return u instanceof Wr?(p=e.scheduledInfo.scheduledMessageParams).fileKey&&typeof p.fileKey=="string"&&typeof p.fileType=="string"&&pE(p.fileType)?(g=p,[4,this.collection.getBlob(p.fileKey)]):[3,9]:[3,10];case 8:g.file=(a=y.sent())!==null&&a!==void 0?a:void 0,y.label=9;case 9:u.scheduledInfo.scheduledMessageParams=s.buildScheduledFileMessageCreateParamsFromSerializedData(p,u),y.label=10;case 10:return[2,u]}})})},t.prototype._getFileInfoBlobKey=function(e,r){return"".concat(e,".").concat(r)},t.prototype.get=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(r=i.sent())return[2,this._deserializeWithMessageCreateParams(r)];i.label=2;case 2:return[2,void 0]}})})},t.prototype.fetch=function(e){var r=e.channelUrl,i=e.filter,a=i===void 0?new Uo:i,s=e.order,u=s===void 0?Ei.CHANNEL_LATEST:s,d=e.sendingStatus,h=e.backward,p=h!==void 0&&h,g=e.parentMessageId;return M(this,void 0,void 0,function(){var E,y,C,T,A=this;return R(this,function(O){switch(O.label){case 0:return this.localCacheEnabled?(E=eu(u),y={"/where":function(N){return!!(u!==Ei.NEWEST_CHILD_MESSAGE||g&&N.parentMessageId!==0&&N.parentMessageId===g)&&a.match(A._deserialize(N))}},r&&(y.channelUrl=r),d&&(y.sendingStatus=d),C={where:y,index:E,backward:p},[4,this.collection.query(C)]):[3,3];case 1:return[4,O.sent().fetch({})];case 2:return T=O.sent(),[2,Promise.all(T.map(function(N){return M(A,void 0,void 0,function(){return R(this,function(k){switch(k.label){case 0:return[4,this._deserializeWithMessageCreateParams(N)];case 1:return[2,k.sent()]}})})}))];case 3:return[2,[]]}})})},t.prototype.getAllChildMessages=function(e,r){return r===void 0&&(r=new Uo),M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return[4,this.fetch({filter:r,order:Ei.NEWEST_CHILD_MESSAGE,channelUrl:e.channelUrl,backward:!1,parentMessageId:e.messageId})];case 1:return[2,i.sent()]}})})},t.prototype.upsert=function(e){return M(this,void 0,void 0,function(){var r=this;return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(a){return M(r,void 0,void 0,function(){var s;return R(this,function(u){switch(u.label){case 0:return a instanceof Wr||a instanceof Wa?[4,this._mutex.lock()]:[3,4];case 1:return u.sent(),[4,this.saveBlob(a)];case 2:return u.sent(),[4,this._mutex.unlock()];case 3:u.sent(),u.label=4;case 4:return s=this._serialize(a),[4,this.collection.upsertOne(s)];case 5:return u.sent(),[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.upsertChildMessages=function(e){return M(this,void 0,void 0,function(){var r=this;return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(a){return M(r,void 0,void 0,function(){var s;return R(this,function(u){switch(u.label){case 0:return s=[],a.threadInfo&&a.threadInfo.replyCount>0?[4,this.getAllChildMessages(a)]:[3,2];case 1:s=u.sent(),u.label=2;case 2:return s.length>0?(s.forEach(function(d){return d.applyParentMessage(a)}),[4,this.upsert(s)]):[3,4];case 3:u.sent(),u.label=4;case 4:return[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.remove=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:if(!this.localCacheEnabled)return[3,8];h.label=1;case 1:h.trys.push([1,6,7,8]),r=Le(e),i=r.next(),h.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove(a)]);case 3:h.sent(),h.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=h.sent(),u={error:s},[3,8];case 7:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(u)throw u.error}return[7];case 8:return[2]}})})},t.prototype.removeMessagesOfChannel=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e}})]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.saveBlob=function(e){return M(this,void 0,void 0,function(){var r,i,a,s=this;return R(this,function(u){switch(u.label){case 0:return e instanceof Wr?e.messageParams&&(a=e.messageParams).file&&T_(a.file)?[4,this.collection.saveBlob(a.file,e.reqId)]:[3,2]:[3,5];case 1:i=u.sent(),a.fileKey=i,a.fileType=zl.BLOB,u.label=2;case 2:return e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(r=e.scheduledInfo.scheduledMessageParams).file&&T_(r.file)?[4,this.collection.saveBlob(r.file,e.reqId)]:[3,4];case 3:i=u.sent(),r.fileKey=i,r.fileType=zl.BLOB,u.label=4;case 4:return[3,7];case 5:return e instanceof Wa&&(a=e.messageParams)&&a.fileInfoList&&Array.isArray(a.fileInfoList)?[4,Promise.all(a.fileInfoList.map(function(d,h){return M(s,void 0,void 0,function(){var p;return R(this,function(g){switch(g.label){case 0:return d.file&&T_(d.file)?[4,this.collection.saveBlob(d.file,this._getFileInfoBlobKey(e.reqId,h))]:[3,2];case 1:p=g.sent(),d._uploadedMetaData||(d._uploadedMetaData={}),d._uploadedMetaData.fileKey=p,d._uploadedMetaData.fileType=zl.BLOB,g.label=2;case 2:return[2]}})})}))]:[3,7];case 6:u.sent(),u.label=7;case 7:return[2]}})})},t}(Zr),s_={},fc=function(n){function t(e){var r=n.call(this,e)||this;return s_[e]=r,r}return j(t,n),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return X.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return X.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return nd.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,r){return r===void 0&&(r=!1),s_[e]&&!r||(s_[e]=new t(e)),s_[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return Se(!!e).throw(ee.databaseError),e.collection(dy)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return W(W({},e.serialize()),{messageId:"".concat(e.messageId)})},t.prototype._deserialize=function(e){return e=W(W({},e),{messageId:parseInt(e.messageId)}),ni.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(r=i.sent())return[2,this._deserialize(r)];i.label=2;case 2:return[2,void 0]}})})},t.prototype.fetch=function(e){var r=e.channelUrl,i=e.token,a=e.limit,s=a===void 0?100:a,u=e.filter,d=u===void 0?new Uo:u,h=e.order,p=h===void 0?Ei.CHANNEL_LATEST:h,g=e.backward,E=g!==void 0&&g,y=e.parentMessageId,C=e.isPollOnly,T=C!==void 0&&C,A=e.exactMatch,O=A!==void 0&&A,N=e.inclusive,k=N===void 0||N;return M(this,void 0,void 0,function(){var D,P,U,L=this;return R(this,function(B){switch(B.label){case 0:return this.localCacheEnabled?(D=eu(p),P={where:{channelUrl:r,"/where":function(q){if(i!=null&&i!=="")switch(p){case Ei.CHANNEL_LATEST:if(O&&q.createdAt!==i)return!1;if(E){if(k&&q.createdAt<i||!k&&q.createdAt<=i)return!1}else if(k&&q.createdAt>i||!k&&q.createdAt>=i)return!1;break;case Ei.NEWEST_CHILD_MESSAGE:if(!y||q.parentMessageId===0||q.parentMessageId!==y)return!1}return!(T&&!q._poll)&&d.match(L._deserialize(q))}},index:D,backward:E},[4,this.collection.query(P)]):[3,3];case 1:return[4,B.sent().fetch({limit:s??void 0})];case 2:return U=B.sent(),[2,Promise.all(U.map(function(q){return M(L,void 0,void 0,function(){return R(this,function(z){return[2,this._deserialize(q)]})})}))];case 3:return[2,[]]}})})},t.prototype.getAllChildMessages=function(e,r){return r===void 0&&(r=new Uo),M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return[4,this.fetch({channelUrl:e.channelUrl,token:Date.now(),limit:null,backward:!1,filter:r,order:Ei.NEWEST_CHILD_MESSAGE,parentMessageId:e.messageId})];case 1:return[2,i.sent()]}})})},t.prototype.upsert=function(e){var r;return M(this,void 0,void 0,function(){var i,a,s,u,d,h,p,g,E=this;return R(this,function(y){switch(y.label){case 0:return this.localCacheEnabled?[4,this.saveBlobs(e)]:[3,13];case 1:y.sent(),y.label=2;case 2:y.trys.push([2,7,8,9]),i=Le(e),a=i.next(),y.label=3;case 3:return a.done?[3,6]:(s=a.value,!((r=s.threadInfo)===null||r===void 0)&&r._isUpdateRequired?[4,this.get(s.messageId)]:[3,5]);case 4:(u=y.sent())!=null&&u.threadInfo&&s.threadInfo._updateFrom(u.threadInfo),y.label=5;case 5:return a=i.next(),[3,3];case 6:return[3,9];case 7:return d=y.sent(),p={error:d},[3,9];case 8:try{a&&!a.done&&(g=i.return)&&g.call(i)}finally{if(p)throw p.error}return[7];case 9:return h=e.map(function(C){return E._serialize(C)}),[4,this.collection.upsertMany(h)];case 10:return y.sent(),[4,this.upsertChildMessages(e)];case 11:return y.sent(),[4,this._unsentMessageCache.upsertChildMessages(e)];case 12:y.sent(),y.label=13;case 13:return[2]}})})},t.prototype.upsertChildMessages=function(e){return M(this,void 0,void 0,function(){var r=this;return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(a){return M(r,void 0,void 0,function(){var s,u;return R(this,function(d){switch(d.label){case 0:return s=[],!((u=a.threadInfo)===null||u===void 0)&&u.replyCount&&a.threadInfo.replyCount>0?[4,this.getAllChildMessages(a)]:[3,2];case 1:s=d.sent(),d.label=2;case 2:return s.length>0?(s.forEach(function(h){return h.applyParentMessage(a)}),[4,this.upsert(s)]):[3,4];case 3:d.sent(),d.label=4;case 4:return[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.remove=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:if(!this.localCacheEnabled)return[3,8];h.label=1;case 1:h.trys.push([1,6,7,8]),r=Le(e),i=r.next(),h.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove("".concat(a))]);case 3:h.sent(),h.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=h.sent(),u={error:s},[3,8];case 7:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(u)throw u.error}return[7];case 8:return[2]}})})},t.prototype.removeMessagesOfChannel=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:eu(Ei.CHANNEL_LATEST)})]:[3,6];case 1:return i.sent(),[4,(r=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:i.sent(),i.label=6;case 6:return[2]}})})},t.prototype.removeUnderOffset=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":r}},index:eu(Ei.CHANNEL_LATEST)})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.countBetween=function(e,r,i){return M(this,void 0,void 0,function(){var a,s=this;return R(this,function(u){switch(u.label){case 0:return this.localCacheEnabled?(a=eu(Ei.CHANNEL_LATEST),[4,this.collection.query({where:{channelUrl:e,"/where":function(d){var h=s._deserialize(d);return i.includes(h.createdAt)&&r.match(h)}},index:a}).count()]):[3,2];case 1:return[2,u.sent()];case 2:return[2,0]}})})},t.prototype.saveBlobs=function(e){return M(this,void 0,void 0,function(){var r=this;return R(this,function(i){switch(i.label){case 0:return[4,Promise.all(e.map(function(a){return M(r,void 0,void 0,function(){var s,u;return R(this,function(d){switch(d.label){case 0:return a instanceof Wr&&a.messageParams&&(s=a.messageParams).file&&T_(s.file)?[4,this.collection.saveBlob(s.file,a.reqId)]:[3,2];case 1:u=d.sent(),s.fileKey=u,d.label=2;case 2:return[2]}})})}))];case 1:return i.sent(),[2]}})})},t.prototype._getGroupChannelPreferenceSize=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return r=0,[4,(i=this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 1:return a=h.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 2:return s=h.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 3:return u=h.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 4:return d=h.sent(),a&&(r+=JSON.stringify(a).length),s&&(r+=JSON.stringify(s).length),u&&(r+=JSON.stringify(u).length),d&&(r+=JSON.stringify(d).length),[2,r]}})})},t}(Zr),u_={},qH=function(n){function t(e){var r=n.call(this,e)||this;return u_[e]=r,r}return j(t,n),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return X.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return X.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,r){return r===void 0&&(r=!1),u_[e]&&!r||(u_[e]=new t(e)),u_[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return Se(!!e).throw(ee.databaseError),e.collection(MM)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return W({},e.serialize())},t.prototype._deserialize=function(e){return ni.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(r=i.sent())return[2,this._deserialize(r)];i.label=2;case 2:return[2,void 0]}})})},t.prototype.fetch=function(e){var r=e.channelUrl,i=e.token,a=e.limit,s=a===void 0?100:a,u=e.filter,d=u===void 0?new Uo:u,h=e.backward,p=h!==void 0&&h,g=e.exactMatch,E=g!==void 0&&g,y=e.inclusive,C=y===void 0||y;return M(this,void 0,void 0,function(){var T,A=this;return R(this,function(O){switch(O.label){case 0:return this.localCacheEnabled?(T={where:{channelUrl:r,"/where":function(N){if(i){if(E&&N.createdAt!==i)return!1;if(p){if(C&&N.createdAt<i||!C&&N.createdAt<=i)return!1}else if(C&&N.createdAt>i||!C&&N.createdAt>=i)return!1}return d.match(A._deserialize(N))}},index:["channelUrl","-createdAt","-notificationId"],backward:p},[4,this.collection.query(T)]):[3,3];case 1:return[4,O.sent().fetch({limit:s??void 0})];case 2:return[2,O.sent().map(function(N){return A._deserialize(N)})];case 3:return[2,[]]}})})},t.prototype.upsert=function(e){return M(this,void 0,void 0,function(){var r,i=this;return R(this,function(a){switch(a.label){case 0:return this.localCacheEnabled?(r=e.map(function(s){return i._serialize(s)}),[4,this.collection.upsertMany(r)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},t.prototype.remove=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:if(!this.localCacheEnabled)return[3,8];h.label=1;case 1:h.trys.push([1,6,7,8]),r=Le(e),i=r.next(),h.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove(a)]);case 3:h.sent(),h.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=h.sent(),u={error:s},[3,8];case 7:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(u)throw u.error}return[7];case 8:return[2]}})})},t.prototype.markAsReadByTimestamp=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,messageStatus:Vl.SENT,createdAt:{"<":r}}},{set:{messageStatus:Vl.READ}})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.markAsReadByMessageIds=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,notificationId:{"/in":r},messageStatus:Vl.SENT}},{set:{messageStatus:Vl.READ}})]:[3,2];case 1:return[2,i.sent().length];case 2:return[2,0]}})})},t.prototype.removeMessagesOfChannel=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:["channelUrl","-createdAt","-notificationId"]})]:[3,6];case 1:return i.sent(),[4,(r=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:i.sent(),i.label=6;case 6:return[2]}})})},t.prototype.removeUnderOffset=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":r}},index:eu(Ei.CHANNEL_LATEST)})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.countBetween=function(e,r,i){return M(this,void 0,void 0,function(){var a,s=this;return R(this,function(u){switch(u.label){case 0:return this.localCacheEnabled?(a=["channelUrl","-createdAt","-notificationId"],[4,this.collection.query({where:{channelUrl:e,"/where":function(d){var h=s._deserialize(d);return i.includes(h.createdAt)&&r.match(h)}},index:a}).count()]):[3,2];case 1:return[2,u.sent()];case 2:return[2,0]}})})},t}(Zr),Nf={},DM=function(n){function t(e){var r=n.call(this,e)||this;return r._observers=new Map,r._dispatcherContext=r._dispatcher.on(function(i){return M(r,void 0,void 0,function(){var a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B=this;return R(this,function(q){switch(q.label){case 0:return i instanceof mr?(a=i.messages,L=i.source,p=i.isWebSocketEventComing,s=a.filter(function(z){return z instanceof Hi&&z.channelType!==vt.OPEN&&z.messageId>0}),u=a.filter(function(z){return z instanceof Hi&&z.channelType!==vt.OPEN&&z.messageId===0}),d=a.filter(function(z){return z instanceof Jl}),s.length>0?[4,Pr(function(){return M(B,void 0,void 0,function(){return R(this,function(z){switch(z.label){case 0:return[4,this._messageCache.upsert(s)];case 1:return z.sent(),[4,this._unsentMessageCache.remove(s.map(function(Y){return Y instanceof Lr?Y.reqId:null}).filter(function(Y){return Y!==null}))];case 2:return z.sent(),[2]}})})})]:[3,2]):[3,7];case 1:q.sent(),p||this._broadcastUpdateEvent(s,L),q.label=2;case 2:return u.length>0?[4,Pr(function(){return M(B,void 0,void 0,function(){return R(this,function(z){switch(z.label){case 0:return[4,this._unsentMessageCache.upsert(u)];case 1:return z.sent(),[2]}})})})]:[3,4];case 3:q.sent(),p||this._broadcastUpdateEvent(u,L),q.label=4;case 4:return d.length>0?[4,Pr(function(){return M(B,void 0,void 0,function(){return R(this,function(z){switch(z.label){case 0:return[4,this._notificationCache.upsert(d)];case 1:return z.sent(),[2]}})})})]:[3,6];case 5:q.sent(),p||this._broadcastUpdateEvent(d,L),q.label=6;case 6:return[3,24];case 7:return i instanceof rC?(h=i.messageIds,L=i.source,p=i.isWebSocketEventComing,g=h.filter(function(z){return typeof z=="number"}),E=h.filter(function(z){return typeof z=="string"}),[4,Pr(function(){return M(B,void 0,void 0,function(){return R(this,function(z){switch(z.label){case 0:return g.length>0?[4,this._messageCache.remove(g)]:[3,2];case 1:z.sent(),z.label=2;case 2:return E.length>0?[4,this._notificationCache.remove(E)]:[3,4];case 3:z.sent(),z.label=4;case 4:return[2]}})})})]):[3,9];case 8:return q.sent(),p||this._broadcastRemoveEvent(h,L),[3,24];case 9:return i instanceof X2?(y=i.reqId,L=i.source,[4,Pr(function(){return M(B,void 0,void 0,function(){return R(this,function(z){switch(z.label){case 0:return[4,this._unsentMessageCache.remove([y])];case 1:return z.sent(),[2]}})})})]):[3,11];case 10:return q.sent(),this._broadcastRemoveUnsentEvent(y,L),[3,24];case 11:return i instanceof J2?(C=i.polls,L=i.source,this._cacheContext.localCacheEnabled?(T=C.map(function(z){return z.messageId}),[4,Promise.all(T.map(function(z){return B._messageCache.get(z)}))]):[3,14]):[3,15];case 12:return(A=q.sent().filter(function(z){return z})).length>0&&C.forEach(function(z){var Y=A.find(function(Q){return Q.messageId===z.messageId});Y&&Y.applyPoll(z)}),[4,Pr(function(){return M(B,void 0,void 0,function(){return R(this,function(z){switch(z.label){case 0:return[4,this._messageCache.upsert(A)];case 1:return[2,z.sent()]}})})})];case 13:q.sent(),q.label=14;case 14:return this._broadcastPollChangeLogEvent(C,L),[3,24];case 15:return i instanceof iC?(O=i.event,L=i.source,[4,this._messageCache.get(O.messageId)]):[3,19];case 16:return(N=q.sent())&&N.isUserMessage()&&N.poll&&N.poll.applyPollUpdateEvent(O)?[4,Pr(function(){return M(B,void 0,void 0,function(){return R(this,function(z){switch(z.label){case 0:return[4,this._messageCache.upsert([N])];case 1:return[2,z.sent()]}})})})]:[3,18];case 17:q.sent(),q.label=18;case 18:return this._broadcastPollUpdateEvent(O,L),[3,24];case 19:return i instanceof km?(k=i.event,L=i.source,[4,this._messageCache.get(k.messageId)]):[3,23];case 20:return(D=q.sent())&&D.isUserMessage()&&D.poll&&D.poll.applyPollVoteEvent(k)?[4,Pr(function(){return M(B,void 0,void 0,function(){return R(this,function(z){switch(z.label){case 0:return[4,this._messageCache.upsert([D])];case 1:return[2,z.sent()]}})})})]:[3,22];case 21:q.sent(),q.label=22;case 22:return this._broadcastPollVoteEvent(k,L),[3,24];case 23:i instanceof Q2?(P=i.event,L=i.source,P.messageId>0&&this._broadcastReactionUpdateEvent(P,L)):i instanceof Z2&&(U=i.event,L=i.source,this._broadcastThreadUpdateEvent(U,L)),q.label=24;case 24:return[2]}})})}),r}return j(t,n),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return X.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dispatcher",{get:function(){return X.of(this._iid).dispatcher},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return fc.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return nd.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_notificationCache",{get:function(){return qH.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,r){var i;return r===void 0&&(r=!1),Nf[e]&&!r||(Nf[e]&&((i=Nf[e]._dispatcherContext)===null||i===void 0||i.close()),Nf[e]=new t(e)),Nf[e]},t.prototype._broadcastUpdateEvent=function(e,r){var i,a;try{for(var s=Le(this._observers.values()),u=s.next();!u.done;u=s.next()){var d=u.value;d.onUpdate&&d.onUpdate(e,r)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastPollChangeLogEvent=function(e,r){var i,a;try{for(var s=Le(this._observers.values()),u=s.next();!u.done;u=s.next()){var d=u.value;d.onPollChangeLogUpdate&&d.onPollChangeLogUpdate(e,r)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastPollUpdateEvent=function(e,r){var i,a;try{for(var s=Le(this._observers.values()),u=s.next();!u.done;u=s.next()){var d=u.value;d.onPollUpdate&&d.onPollUpdate(e,r)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastPollVoteEvent=function(e,r){var i,a;try{for(var s=Le(this._observers.values()),u=s.next();!u.done;u=s.next()){var d=u.value;d.onPollVote&&d.onPollVote(e,r)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastRemoveEvent=function(e,r){var i,a;try{for(var s=Le(this._observers.values()),u=s.next();!u.done;u=s.next()){var d=u.value;d.onRemove&&d.onRemove(e,r)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastRemoveUnsentEvent=function(e,r){var i,a;try{for(var s=Le(this._observers.values()),u=s.next();!u.done;u=s.next()){var d=u.value;d.onRemoveUnsent&&d.onRemoveUnsent(e,r)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastReactionUpdateEvent=function(e,r){var i,a;try{for(var s=Le(this._observers.values()),u=s.next();!u.done;u=s.next()){var d=u.value;d.onReactionUpdate&&d.onReactionUpdate(e,r)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastThreadUpdateEvent=function(e,r){var i,a;try{for(var s=Le(this._observers.values()),u=s.next();!u.done;u=s.next()){var d=u.value;d.onThreadInfoUpdate&&d.onThreadInfoUpdate(e,r)}}catch(h){i={error:h}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype.subscribe=function(e,r){this._observers.set(e,r)},t.prototype.unsubscribe=function(e){this._observers.delete(e)},t.prototype.unsubscribeAll=function(){this._observers.clear()},t}(Zr),zH=function(n){function t(e){var r=this,i=e.reverse,a=i!==void 0&&i,s=e.limit,u=s===void 0?20:s,d=e.keys,h=e.token;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(h2),r.params=ze({token:h,limit:u,reverse:a,order:$E.UPDATED_AT,show_ui_template:!0,show_color_variables:!0,keys:d}),r}return j(t,n),t}(Te),KH=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.next,s=r.has_more,u=s!==void 0&&s,d=r.templates;return i.nextToken=a,i.hasMore=u,i.templates=d.map(function(h){return{template:JSON.stringify(h)}}),i}return j(t,n),t}(Me),WH=function(n){function t(e){var r=this,i=e.key;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(h2,"/").concat(i),r}return j(t,n),t}(Te),$H=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.template=JSON.stringify(r),i}return j(t,n),t}(Me),G1={},ni=function(){function n(t,e){var r=e.sdkState,i=e.dispatcher,a=e.requestQueue,s=e.onlineDetector,u=e.cacheContext;this._iid=t,this._sdkState=r,this._requestQueue=a,this._dispatcher=i,this._cacheContext=u,fc.of(t),nd.of(t),DM.of(t),this.fileMessageQueue=new q7(t,{sdkState:r,dispatcher:i,requestQueue:a,onlineDetector:s,cacheContext:u}),G1[t]=this}return n.of=function(t){return G1[t]},n.prototype.buildMessageFromSerializedData=function(t){var e=ko(t);if(e.notificationId)return new Jl(this._iid,Jl.payloadify(e));switch(e.messageType){case Rr.USER:return new Si(this._iid,Si.payloadify(e));case Rr.FILE:return Wa._isMultipleFilesMessageSerializedData(e)?new Wa(this._iid,Wa.payloadify(e)):new Wr(this._iid,Wr.payloadify(e));case Rr.ADMIN:return new Xl(this._iid,Xl.payloadify(e))}throw ee.invalidParameters},n.prototype.buildUserMessageCreateParamsFromSerializedData=function(t,e){return ze(_n({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUserIds:e.mentionedUserIds,mentionedUsers:e.mentionedUsers,mentionedMessageTemplate:e.mentionedMessageTemplate,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,isReplyToChannel:t.isReplyToChannel,pushNotificationDeliveryOption:t.pushNotificationDeliveryOption,appleCriticalAlertOptions:e.appleCriticalAlertOptions,reqId:e.reqId,message:e.message,translationTargetLanguages:Object.keys(e.translations),pollId:t.pollId}))},n.prototype.buildFileMessageCreateParamsFromSerializedData=function(t,e){var r;return ze(_n({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUserIds:e.mentionedUserIds,mentionedUsers:e.mentionedUsers,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,isReplyToChannel:t.isReplyToChannel,pushNotificationDeliveryOption:t.pushNotificationDeliveryOption,appleCriticalAlertOptions:e.appleCriticalAlertOptions,reqId:e.reqId,file:t.file,fileKey:t.fileKey,fileUrl:e.plainUrl,fileName:e.name,fileSize:e.size,mimeType:e.type,thumbnailSizes:(r=e.thumbnails)===null||r===void 0?void 0:r.map(function(i){return{maxWidth:i.width,maxHeight:i.height}}),fileType:t.fileType,requireAuth:e.requireAuth}))},n.prototype.buildMultipleFilesMessageCreateParamsFromSerializedData=function(t,e){var r=this;return ze({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUserIds:e.mentionedUserIds,mentionedUsers:e.mentionedUsers,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,isReplyToChannel:t.isReplyToChannel,pushNotificationDeliveryOption:t.pushNotificationDeliveryOption,appleCriticalAlertOptions:e.appleCriticalAlertOptions,reqId:e.reqId,fileInfoList:t.fileInfoList.map(function(i){return new em(r._iid,i)})})},n.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(t,e){return W(W({},this.buildUserMessageCreateParamsFromSerializedData(t,e)),{scheduledAt:t.scheduledAt})},n.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(t,e){return W(W({},this.buildFileMessageCreateParamsFromSerializedData(t,e)),{scheduledAt:t.scheduledAt})},n.prototype.buildSenderFromSerializedData=function(t){var e=ko(t);return new Ec(this._iid,Ec.payloadify(e))},n.prototype.getMessage=function(t){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=new z7(t),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(K7).message]}})})},n.prototype.getScheduledMessage=function(t){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=new Y7(t),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(Q7).message]}})})},n.prototype.getMessagesByMessageId=function(t,e,r,i,a){return a===void 0&&(a=ge.REQUEST_MESSAGE),M(this,void 0,void 0,function(){var s,u,d;return R(this,function(h){switch(h.label){case 0:return s=new Jp(W(W({channelType:e,channelUrl:t,token:String(r)},uh),i)),[4,this._requestQueue.send(s)];case 1:return u=h.sent(),d=u.as(e_).messages,this._dispatcher.dispatch(new mr({messages:d,source:a})),[2,d]}})})},n.prototype.getMessagesByTimestamp=function(t,e,r,i,a){return a===void 0&&(a=ge.REQUEST_MESSAGE),M(this,void 0,void 0,function(){var s,u,d;return R(this,function(h){switch(h.label){case 0:return s=new Jp(W(W({channelType:e,channelUrl:t,timestamp:r},uh),i)),[4,this._requestQueue.send(s)];case 1:return u=h.sent(),d=u.as(e_).messages,this._dispatcher.dispatch(new mr({messages:d,source:a})),[2,d]}})})},n.prototype._getMessagesByTimestampForCollection=function(t,e,r,i,a,s,u){return a===void 0&&(a=ge.REQUEST_MESSAGE),M(this,void 0,void 0,function(){var d,h,p,g,E,y;return R(this,function(C){switch(C.label){case 0:return d=new Jp(W(W(W({channelType:e,channelUrl:t,timestamp:r},uh),i),{checkingHasNext:s,checkingContinuousMessages:u})),[4,this._requestQueue.send(d)];case 1:return h=C.sent(),p=h.as(e_),g=p.messages,E=p.isContinuousMessages,y=p.hasNext,this._dispatcher.dispatch(new mr({messages:g,source:a})),[2,{messages:g,isContinuousMessages:E,hasNext:y}]}})})},n.prototype.getThreadedMessagesByTimestamp=function(t,e,r,i){return i===void 0&&(i=ge.REQUEST_THREADED_MESSAGE),M(this,void 0,void 0,function(){var a,s,u,d;return R(this,function(h){switch(h.label){case 0:return a=new Jp(W(W(W({channelUrl:t.channelUrl,channelType:t.channelType,timestamp:e},Lh),r),{replyType:ti.ALL,parentMessageId:t.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(a)];case 1:return s=h.sent(),u=s.as(e_).messages,(d=u.slice(1)).forEach(function(p){p.parentMessage=t}),this._dispatcher.dispatch(new mr({messages:d,source:i})),[2,{parentMessage:u[0],threadedMessages:d}]}})})},n.prototype.getMessageTemplatesByToken=function(t,e){return e===void 0&&(e={}),M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return r=new zH(W({token:t},e)),[4,this._requestQueue.send(r)];case 1:return i=h.sent(),a=i.as(KH),s=a.hasMore,u=a.nextToken,d=a.templates,[2,{hasMore:s,token:u,templates:d}]}})})},n.prototype.getMessageTemplate=function(t){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=new WH({key:t}),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,{template:r.as($H).template}]}})})},n.prototype.getMessageChangelogs=function(t,e,r,i,a){return a===void 0&&(a=ge.REQUEST_MESSAGE_CHANGELOGS),M(this,void 0,void 0,function(){var s,u,d,h,p,g,E,y,C;return R(this,function(T){switch(T.label){case 0:return s=new W7(ze(_n(W(W({channelType:e,channelUrl:t,timestamp:typeof r=="number"?r:null,token:typeof r=="string"?r:null},uy),i)))),[4,this._requestQueue.send(s)];case 1:return u=T.sent(),d=u.as($7),h=d.updatedMessages,p=d.deletedMessagesInfo,g=d.hasMore,E=d.nextToken,y=d.forceUseNextToken,C=p.map(function(A){return A.messageId}),h.length>0&&this._dispatcher.dispatch(new mr({messages:h,source:a})),C.length>0&&this._dispatcher.dispatch(new rC({messageIds:C,source:a})),[2,{updatedMessages:h,deletedMessageIds:C,hasMore:g,token:E,forceUseNextToken:y}]}})})},n}(),LM=function(n){function t(e,r){var i=n.call(this,e)||this;i.targetMessageId=0;var a=r.thread_info,s=r.parent_message_id,u=r.channel_url,d=r.channel_type;return a&&J("object",a)&&J("number",s)&&J("string",u)&&J("string",d)&&(i.threadInfo=new J_(e,a),i.targetMessageId=s,i.channelUrl=u,i.channelType=d),i}return j(t,n),t}(Zr),YH={channelUrl:"",channelType:vt.BASE,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},QH=function(n){function t(e){var r=e.channelCustomType,i=e.keyword,a=e.limit,s=e.reverse,u=e.exactMatch,d=e.channelUrl,h=e.order,p=e.messageTimestampFrom,g=e.messageTimestampTo,E=e.advancedQuery,y=e.targetFields,C=e.nextToken,T=n.call(this)||this;return T.method=Ie.GET,T.path="".concat(A5,"/messages"),T.params={custom_type:r,query:i,limit:a,reverse:s,exact_match:u,channel_url:d,message_ts_from:p,message_ts_to:g,sort_field:h,advanced_query:E,target_fields:y,after:C},T}return j(t,n),t}(Te),ZH=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.messages=r.results.map(function(a){return Ri(e,a)}),i.hasNext=r.has_next,i.nextToken=r.end_cursor,i.totalCount=r.total_count,i}return j(t,n),t}(Me);(function(n){n.SCORE="score",n.TIMESTAMP="ts"})(dh||(dh={}));var XH=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y=this;return(y=n.call(this,e,r)||this).keyword="",y.reverse=!1,y.exactMatch=!1,y.channelUrl="",y.channelCustomType="",y.messageTimestampFrom=null,y.messageTimestampTo=null,y.order=dh.SCORE,y.advancedQuery=!1,y.targetFields=null,y._nextToken="",y.totalCount=-1,y.keyword=r.keyword,y.reverse=(i=r.reverse)!==null&&i!==void 0&&i,y.exactMatch=(a=r.exactMatch)!==null&&a!==void 0&&a,y.channelUrl=(s=r.channelUrl)!==null&&s!==void 0?s:"",y.channelCustomType=(u=r.channelCustomType)!==null&&u!==void 0?u:"",y.messageTimestampFrom=(d=r.messageTimestampFrom)!==null&&d!==void 0?d:null,y.messageTimestampTo=(h=r.messageTimestampTo)!==null&&h!==void 0?h:null,y.order=(p=r.order)!==null&&p!==void 0?p:dh.SCORE,y.advancedQuery=(g=r.advancedQuery)!==null&&g!==void 0&&g,y.targetFields=(E=r.targetFields)!==null&&E!==void 0?E:null,y}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("string",this.keyword)&&this.keyword.length>0&&J("boolean",this.reverse)&&J("boolean",this.exactMatch)&&J("string",this.channelUrl)&&J("string",this.channelCustomType)&&(J("number",this.messageTimestampFrom)||this.messageTimestampFrom===null)&&(J("number",this.messageTimestampTo)||this.messageTimestampTo===null)&&nt(dh,this.order)&&J("boolean",this.advancedQuery)&&tt("string",this.targetFields,!0)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new QH(_n(W(W({},this),{nextToken:this._nextToken?this._nextToken:null}))),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=p.sent(),a=i.as(ZH),s=a.messages,u=a.hasNext,d=a.nextToken,h=a.totalCount,this._nextToken=d,this._hasNext=u,this._isLoading=!1,this.totalCount=h,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(Vu),JH=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.limit,s=e.token,u=n.call(this)||this;return u.method=Ie.GET,u.path="".concat(Lt(r),"/").concat(encodeURIComponent(i),"/messages/parent_thread_message"),u.params=ze(_n({limit:a,token:s})),u}return j(t,n),t}(Te),eB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.next,i.messages=r.messages.map(function(a){return Ri(e,a)}),i}return j(t,n),t}(Me),nB=function(n){function t(e,r,i,a){var s=n.call(this,e,r,i,a)||this;return s._edge="",s}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.load=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new JH({channelType:this.channelType,channelUrl:this.channelUrl,token:this._edge,limit:this.limit}),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(eB),s=a.messages,u=a.token,this._edge=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),tB={channelUrl:"",scheduledMessageId:0},rB={reverse:!1,limit:20},iB=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.name="message",e}return j(t,n),t.prototype.init=function(e,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,u=r.requestQueue,d=r.logger,h=r.onlineDetector,p=r.cacheContext;n.prototype.init.call(this,e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:d,onlineDetector:h,cacheContext:p}),this._manager=new ni(e,{sdkState:i,dispatcher:a,requestQueue:u,onlineDetector:h,cacheContext:p})},t.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e)},t.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e)},t.prototype.getMessage=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return r=W(W({},YH),e),Se(function(s){return J("string",s.channelUrl)&&nt(vt,s.channelType)&&J("number",s.messageId)&&J("boolean",s.includeReactions,!0)&&J("boolean",s.includeMetaArray,!0)&&J("boolean",s.includeParentMessageInfo,!0)&&J("boolean",s.includeThreadInfo,!0)}(r)).throw(ee.invalidParameters),[4,this._manager.getMessage(r)];case 1:if((i=a.sent())instanceof Hi||i instanceof Jl||i===null)return[2,i];throw"Unknown message type is given."}})})},t.prototype.getScheduledMessage=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){return r=W(W({},tB),e),Se(function(a){return J("string",a.channelUrl)&&a.channelUrl!==""&&J("number",a.scheduledMessageId)&&a.scheduledMessageId>0}(r)).throw(ee.invalidParameters),[2,this._manager.getScheduledMessage(r)]})})},t.prototype.getMessageTemplatesByToken=function(e,r){return r===void 0&&(r={}),M(this,void 0,void 0,function(){var i;return R(this,function(a){return i=W(W({},rB),r),Se(J("string",e,!0)&&function(s){return J("boolean",s.reverse,!0)&&J("number",s.limit,!0)&&tt("string",s.keys,!0)}(i)).throw(ee.invalidParameters),[2,this._manager.getMessageTemplatesByToken(e,i)]})})},t.prototype.getMessageTemplate=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return Se(J("string",e)).throw(ee.invalidParameters),[2,this._manager.getMessageTemplate(e)]})})},t}(Om),aB=function(n,t){this.pollId=0,this.messageId=0,this.pollId=t.poll.id,this.messageId=t.poll.message_id,this._iid=n,this._payload=t},sB=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.name="poll",e}return j(t,n),t.prototype.init=function(e,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,u=r.requestQueue,d=r.logger,h=r.onlineDetector,p=r.cacheContext;n.prototype.init.call(this,e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:d,onlineDetector:h,cacheContext:p}),this._manager=new Q_(e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:d,onlineDetector:h,cacheContext:p})},t.prototype.create=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){return r=W(W({},S7),e),Se(tM(r)).throw(ee.invalidParameters),[2,this._manager.create(r)]})})},t.prototype.get=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){return r=W(W({},A7),e),Se(iM(r)).throw(ee.invalidParameters),[2,this._manager.get(r)]})})},t.prototype.getOption=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){return r=W(W({},N7),e),Se(rM(r)).throw(ee.invalidParameters),[2,this._manager.getOption(r)]})})},t.prototype.buildPollFromSerializedData=function(e){return this._manager.buildPollFromSerializedData(e)},t}(Om),Er,ch,hy;(function(n){n.LATEST_LAST_MESSAGE="latest_last_message",n.CHRONOLOGICAL="chronological",n.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",n.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"})(Er||(Er={})),function(n){n.CHRONOLOGICAL="chronological",n.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",n.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"}(ch||(ch={})),function(n){n.CREATED_AT="created_at",n.SCHEDULED_AT="scheduled_at"}(hy||(hy={}));var Ch,A_=function(n){switch(n){case Er.LATEST_LAST_MESSAGE:return["-lastMessageUpdatedAt","-createdAt","syncIndex"];case Er.CHRONOLOGICAL:return["-createdAt","syncIndex"];case Er.CHANNEL_NAME_ALPHABETICAL:return["name"];default:return["-lastMessageUpdatedAt","-createdAt","syncIndex"]}},xM=function(n){function t(e){var r=e.message,i=n.call(this)||this;return i.message=r,i}return j(t,n),t}(Cr),V1={},Wf=function(){function n(t,e){var r=e.localCacheEnabled,i=e.enableAutoResend,a=e.dispatcher,s=e.sdkState,u=e.logger,d=this;this._iid=t,V1[t]=this,this._localCacheEnabled=r,this._enableAutoResend=i,this._isProcessingAutoResend=!1,this._autoResendQueue=[],this._dispatcher=a,this._logger=u,this._sdkState=s,this._localCacheEnabled&&a.on(function(h){if(h instanceof Aa)switch(h.stateType){case Gt.CONNECTED:d._isProcessingAutoResend||d.processAutoResendRegisteredPendingMessages().then(function(){return d._processNextAutoResend()});break;case Gt.INTERNAL_DISCONNECTED:case Gt.EXTERNAL_DISCONNECTED:d._isProcessingAutoResend=!1}})}return n.of=function(t){return V1[t]},n.prototype.processNonAutoResendRegisteredPendingMessages=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return this._enableAutoResend?[4,this._fetchAllCachedPendingMessages()]:[2];case 1:t=u.sent();try{for(e=Le(t),r=e.next();!r.done;r=e.next())(i=r.value).errorCode===0&&(this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ",i.reqId),i.sendingStatus=jt.FAILED,i.errorCode=rn.ACK_TIMEOUT,this._dispatcher.dispatch(new mr({messages:[i],source:ge.LOCAL_MESSAGE_FAILED})))}catch(d){a={error:d}}finally{try{r&&!r.done&&(s=e.return)&&s.call(e)}finally{if(a)throw a.error}}return[2]}})})},n.prototype.processAutoResendRegisteredPendingMessages=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:t=h.sent();try{for(e=Le(t),r=e.next();!r.done;r=e.next())i=r.value,this._enableAutoResend&&i.errorCode&&B_(i.errorCode)&&(a=new Date().getTime(),s=i.createdAt+2592e5,this._enableAutoResend&&a<=s?this._autoResendQueue.map(function(p){return p.reqId}).indexOf(i.reqId)<0&&this._autoResendQueue.push(i):(this._logger.debug("auto-resend registered pending messaged expired. expiration date: ",new Date(s).toLocaleString()),i.sendingStatus=jt.FAILED,this._dispatcher.dispatch(new mr({messages:[i],source:ge.LOCAL_MESSAGE_FAILED}))))}catch(p){u={error:p}}finally{try{r&&!r.done&&(d=e.return)&&d.call(e)}finally{if(u)throw u.error}}return[2]}})})},n.prototype.completeCurrentAndProcessNextAutoResend=function(t){if(this._localCacheEnabled&&this._enableAutoResend&&(t.sendingStatus===jt.SUCCEEDED||t.sendingStatus===jt.FAILED&&!B_(t.errorCode))){var e=this.indexOf(t);e>=0&&this._autoResendQueue.splice(e,1),e===0&&this._processNextAutoResend()}},n.prototype._fetchAllCachedPendingMessages=function(){return M(this,void 0,void 0,function(){var t,e;return R(this,function(r){switch(r.label){case 0:return t=nd.of(this._iid),(e=new Uo).replyType=ti.ALL,[4,t.fetch({sendingStatus:jt.PENDING,backward:!0,filter:e})];case 1:return[2,r.sent()]}})})},n.prototype.indexOf=function(t){return this._autoResendQueue.length>0?this._autoResendQueue.map(function(e){return e.reqId}).indexOf(t.reqId):-1},n.prototype._isNotInQueue=function(t){return this._autoResendQueue.map(function(e){return e.reqId}).indexOf(t.reqId)===-1},n.prototype._processNextAutoResend=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){if(this._localCacheEnabled&&this._enableAutoResend&&this._sdkState.appState==="foreground")try{this._autoResendQueue.length>0?(this._isProcessingAutoResend||(this._logger.debug("auto-resend queue started."),this._isProcessingAutoResend=!0),t=this._autoResendQueue[0],this._dispatcher.dispatch(new xM({message:t})),this._logger.debug("processing auto-resend for message request id: ",t.reqId)):(this._logger.debug("auto-resend queue finished."),this._isProcessingAutoResend=!1)}catch(r){this._logger.warn("process auto-resend error: ",r),this._isProcessingAutoResend=!1}return[2]})})},n}();(function(n){n[n.USER_BLOCK=20001]="USER_BLOCK",n[n.USER_UNBLOCK=2e4]="USER_UNBLOCK",n[n.FRIEND_DISCOVERED=20900]="FRIEND_DISCOVERED"})(Ch||(Ch={}));var am=function(){function n(t){this.category=t.cat,this.data=t.data}return n.getDataAsUserBlockEvent=function(t,e){var r=e.data,i=r.blocker,a=r.blockee;return{blocker:new _t(t,i),blockee:new _t(t,a)}},n.getDataAsFriendDiscoveredEvent=function(t,e){var r=e.data.friend_discoveries;return{friendDiscoveries:Array.isArray(r)?r.map(function(i){return new _t(t,i)}):[]}},n}(),UM=function(n){function t(e,r){var i=r.userId,a=n.call(this)||this;return a._iid=e,a.userId=i,a}return j(t,n),t}(Cr),PM=function(n){function t(){return n.call(this)||this}return j(t,n),t}(Cr),FM=function(n){function t(e,r,i){var a=n.call(this,e,"USEV",i)||this;return a.event=new am(i),a}return j(t,n),t}(dr),uB=function(n){return["-lastMessageUpdatedAt","-createdAt","syncIndex"]},j1=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return j(t,n),t}(Cr),HM=function(n){this.key=n.key,this.url=n.url},BM=function(n){this.id=n.id,this.name=n.name,this.url=n.url,this.emojis=n.emojis?n.emojis.map(function(t){return new HM(t)}):[]},GM=function(n){this.emojiHash=n.emoji_hash||"",this.emojiCategories=n.emoji_categories?n.emoji_categories.map(function(t){return new BM(t)}):[]},oB={profileImage:void 0,profileUrl:void 0,nickname:void 0},q1=function(n){return function(t,e){return M(void 0,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:switch(t){case 1:case 2:case 3:case 4:return[3,1];case 5:return[3,2];case 6:return[3,4]}return[3,11];case 1:return e(),[3,12];case 2:return[4,n.reset()];case 3:return u.sent(),e(),[3,12];case 4:return u.trys.push([4,9,,10]),r=function(d){return{v2:function(){return M(void 0,void 0,void 0,function(){return R(this,function(h){switch(h.label){case 0:return[4,d.commitSchema([{collectionName:wM,keyName:J8,index:[A_(Er.LATEST_LAST_MESSAGE),A_(Er.CHRONOLOGICAL),A_(Er.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:dy,keyName:eH,index:[eu(Ei.CHANNEL_LATEST),eu(Ei.NEWEST_CHILD_MESSAGE)]},{collectionName:kM,keyName:jH,index:[eu(Ei.CHANNEL_LATEST),eu(Ei.NEWEST_CHILD_MESSAGE)]},{collectionName:tH,keyName:rH}])];case 1:return[2,h.sent()]}})})},v3:function(){return M(void 0,void 0,void 0,function(){return R(this,function(h){switch(h.label){case 0:return[4,d.commitSchema([{collectionName:iH,keyName:aH,index:[uB()]}])];case 1:return[2,h.sent()]}})})},v4:function(){return M(void 0,void 0,void 0,function(){return R(this,function(h){switch(h.label){case 0:return[4,d.commitSchema([{collectionName:MM,keyName:nH,index:[FH()]}])];case 1:return[2,h.sent()]}})})}}}(n),i=r.v2,a=r.v3,s=r.v4,[4,i()];case 5:return u.sent(),[4,a()];case 6:return u.sent(),[4,s()];case 7:return u.sent(),[4,n.collection(dy).removeIf({where:{channelType:vt.OPEN}})];case 8:case 9:return u.sent(),[3,10];case 10:return e(),[3,12];case 11:e(),u.label=12;case 12:return[2]}})})}},lB=function(){return typeof document<"u"?document.visibilityState:"visible"},dB=function(n){function t(e){var r=e.getVisibilityState,i=r===void 0?lB:r,a=e.initialState,s=a===void 0?"visible":a,u=e.isEnabled,d=u===void 0||u,h=e.pauseCheckDelay,p=h===void 0?3e4:h,g=n.call(this)||this;return g._pauseCheckDelay=3e4,g._currentState="visible",g._getVisibilityState=i,g._pauseCheckDelay=p,g._currentState=s,g._isEnabled=d,g._boundToggleState=g._toggleState.bind(g),g}return j(t,n),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAvailable",{get:function(){return typeof window<"u"&&!!window.addEventListener&&!!window.removeEventListener},enumerable:!1,configurable:!0}),t.prototype._toggleState=function(){var e=this,r=this._getVisibilityState();r!=="hidden"?this._currentState==="hidden"&&(this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=void 0),this.dispatch("resume")):this._currentState!=="hidden"&&(this._pauseDelayTimer=setTimeout(function(){e._pauseDelayTimer=void 0,e.dispatch("pause")},this._pauseCheckDelay)),this._currentState=r},t.prototype.start=function(){this._isEnabled&&this.isAvailable&&(this._boundToggleState=this._toggleState.bind(this),window.addEventListener("visibilitychange",this._boundToggleState,{capture:!0}))},t.prototype.stop=function(){this._isEnabled&&this.isAvailable&&this._boundToggleState&&window.removeEventListener("visibilitychange",this._boundToggleState,{capture:!0})},t}(rd),cB=function(){function n(t){var e=t.logger,r=t.connectionDelegate,i=r===void 0?null:r,a=this;this._onlineWorker=function(){var s;return(s=a.connectionDelegate)===null||s===void 0?void 0:s.reconnect()},this._offlineWorker=function(){var s;return(s=a.connectionDelegate)===null||s===void 0?void 0:s.disconnect()},this.unsubscribes=[],this._onlineListener=function(s){if(a.isAvailableOnWeb)return window.addEventListener("online",s),function(){return window.removeEventListener("online",s,!1)}},this._offlineListener=function(s){if(a.isAvailableOnWeb)return window.addEventListener("offline",s),function(){return window.removeEventListener("offline",s,!1)}},this.logger=e,i&&(this.connectionDelegate=i)}return Object.defineProperty(n.prototype,"isAvailableOnWeb",{get:function(){return typeof window<"u"&&!!window.addEventListener&&"ononline"in window&&"onoffline"in window&&typeof navigator<"u"&&navigator.onLine!==void 0},enumerable:!1,configurable:!0}),n.prototype.setOnlineListener=function(t){t&&typeof t=="function"&&(this._onlineListener=t)},n.prototype.setOfflineListener=function(t){t&&typeof t=="function"&&(this._offlineListener=t)},n.prototype.start=function(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)]},n.prototype.stop=function(){var t=this;this.unsubscribes.forEach(function(e){try{e==null||e()}catch(r){t.logger.warn(r.message)}}),this.unsubscribes=[]},n.prototype.isOnline=function(){return M(this,void 0,void 0,function(){return R(this,function(t){return this.isAvailableOnWeb?[2,navigator.onLine]:[2,new Promise(function(e){fetch("https://www.google.com",{method:Ie.GET,mode:"no-cors"}).then(function(){return e(!0)}).catch(function(){return e(!1)})})]})})},n}(),z1=function(n){function t(e){var r=e.userId,i=e.nickname,a=e.profileUrl,s=e.profileImage,u=e.preferredLanguages,d=n.call(this)||this;return d.method=Ie.PUT,d.path="".concat(xt,"/").concat(encodeURIComponent(r)),d.params=ze(_n({nickname:i,profile_url:a,profile_file:s,preferred_languages:u})),d}return j(t,n),t}(Te),K1=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.user=new _t(e,W({},r)),i}return j(t,n),t}(Me),fB=function(n){function t(e){var r=e.userId,i=e.token,a=e.deviceOS,s=e.deviceManufacturer,u=e.systemPushEnabled,d=n.call(this)||this;return d.method=Ie.POST,d.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/apns"),d.params=ze({apns_device_token:i,always_push:!0,device_os:a,device_manufacturer:s,system_push_enabled:u}),d}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.token,i.type=r.type?si[r.type.toLowerCase()]:si.UNKNOWN,i.user=new _t(e,r.user),i}j(t,n)})(Me);var hB=function(n){function t(e){var r=e.userId,i=e.token,a=e.deviceOS,s=e.deviceManufacturer,u=e.systemPushEnabled,d=n.call(this)||this;return d.method=Ie.POST,d.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/gcm"),d.params=ze({gcm_reg_token:i,always_push:!0,device_os:a,device_manufacturer:s,system_push_enabled:u}),d}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.token,i.type=r.type?si[r.type.toLowerCase()]:si.UNKNOWN,i.user=new _t(e,r.user),i}j(t,n)})(Me);var pB=function(n){function t(e){var r=e.userId,i=e.token,a=n.call(this)||this;return a.method=Ie.DELETE,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/apns/").concat(encodeURIComponent(i)),a}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.token,i.user=new _t(e,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}j(t,n)})(Me);var _B=function(n){function t(e){var r=e.userId,i=e.token,a=n.call(this)||this;return a.method=Ie.DELETE,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/gcm/").concat(encodeURIComponent(i)),a}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.token,i.user=new _t(e,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}j(t,n)})(Me);var mB=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.DELETE,i.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/apns"),i}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.type=r.type?si[r.type.toLowerCase()]:si.UNKNOWN,i.user=new _t(e,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}j(t,n)})(Me);var gB=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.DELETE,i.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/gcm"),i}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.type=r.type?si[r.type.toLowerCase()]:si.UNKNOWN,i.user=new _t(e,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}j(t,n)})(Me);var vB=function(n){function t(e){var r=e.userId,i=e.type,a=e.token,s=e.ts,u=n.call(this)||this;return u.method=Ie.GET,u.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/").concat(encodeURIComponent(i),"/device_tokens"),u.params={created_ts:s,token:a},u}return j(t,n),t}(Te),EB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTokens={type:r.type?si[r.type.toLowerCase()]:si.UNKNOWN,deviceTokens:r.device_tokens,hasMore:r.has_more,token:r.token},i}return j(t,n),t}(Me),yB=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(xt,"/").concat(encodeURIComponent(r),"/channel_invitation_preference"),i}return j(t,n),t}(Te),bB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.autoAccept=r.auto_accept,i}return j(t,n),t}(Me),CB=function(n){function t(e){var r=e.userId,i=e.willAutoAccept,a=n.call(this)||this;return a.method=Ie.PUT,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/channel_invitation_preference"),a.params={auto_accept:i},a}return j(t,n),t}(Te),IB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.autoAccept=r.auto_accept,i}return j(t,n),t}(Me),TB=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push_preference"),i}return j(t,n),t}(Te),SB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.preference={doNotDisturbOn:r.do_not_disturb,startHour:r.start_hour,startMin:r.start_min,endHour:r.end_hour,endMin:r.end_min,timezone:r.timezone},i}return j(t,n),t}(Me),NB=function(n){function t(e){var r=e.userId,i=e.doNotDisturbOn,a=e.startHour,s=e.startMin,u=e.endHour,d=e.endMin,h=e.timezone,p=n.call(this)||this;return p.method=Ie.PUT,p.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push_preference"),p.params={do_not_disturb:i,start_hour:a,start_min:s,end_hour:u,end_min:d,timezone:h},p}return j(t,n),t}(Te),AB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.preference={doNotDisturbOn:r.do_not_disturb,startHour:r.start_hour,startMin:r.start_min,endHour:r.end_hour,endMin:r.end_min,timezone:r.timezone},i}return j(t,n),t}(Me),wB=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push_preference"),i}return j(t,n),t}(Te),RB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.snoozePeriod={isSnoozeOn:r.snooze_enabled},typeof r.snooze_start_ts=="number"&&(i.snoozePeriod.startTs=r.snooze_start_ts),typeof r.snooze_end_ts=="number"&&(i.snoozePeriod.endTs=r.snooze_end_ts),i}return j(t,n),t}(Me),MB=function(n){function t(e){var r=e.userId,i=e.snoozeOn,a=e.startTs,s=e.endTs,u=n.call(this)||this;return u.method=Ie.PUT,u.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push_preference"),u.params={snooze_enabled:i,snooze_start_ts:a,snooze_end_ts:s},u}return j(t,n),t}(Te),OB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.snoozePeriod={isSnoozeOn:r.snooze_enabled},typeof r.snooze_start_ts=="number"&&(i.snoozePeriod.startTs=r.snooze_start_ts),typeof r.snooze_end_ts=="number"&&(i.snoozePeriod.endTs=r.snooze_end_ts),i}return j(t,n),t}(Me),kB=function(n){function t(e){var r=e.userId,i=e.blockedUserId,a=n.call(this)||this;return a.method=Ie.POST,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/block"),a.params={target_id:i},a}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.user=new _t(e,r),i}j(t,n)})(Me);var DB=function(n){function t(e){var r=e.userId,i=e.unblockedUserId,a=n.call(this)||this;return a.method=Ie.DELETE,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/block/").concat(encodeURIComponent(i)),a}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var LB=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push_preference"),i}return j(t,n),t}(Te),xB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTriggerOption=r.push_trigger_option,i}return j(t,n),t}(Me),UB=function(n){function t(e){var r=e.userId,i=e.pushTriggerOption,a=n.call(this)||this;return a.method=Ie.PUT,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push_preference"),a.params={push_trigger_option:i},a}return j(t,n),t}(Te),PB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTriggerOption=r.push_trigger_option,i}return j(t,n),t}(Me),FB=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/template"),i}return j(t,n),t}(Te),HB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.name=r.name,i}return j(t,n),t}(Me),BB=function(n){function t(e){var r=e.userId,i=e.templateName,a=n.call(this)||this;return a.method=Ie.PUT,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push/template"),a.params={name:i},a}return j(t,n),t}(Te),GB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.name=r.name,i}return j(t,n),t}(Me),VB=function(n){function t(e){var r=e.userId,i=e.token,a=n.call(this)||this;return a.method=Ie.GET,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/friends/changelogs"),a.params={token:i},a}return j(t,n),t}(Te),jB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.changelogs={addedUsers:r.added.map(function(a){return new _t(e,a)}),updatedUsers:r.updated.map(function(a){return new _t(e,a)}),deletedUserIds:r.deleted,hasMore:r.has_more,token:r.next},i}return j(t,n),t}(Me),qB=function(n){function t(e){var r=e.userId,i=e.discoveries,a=n.call(this)||this;return a.method=Ie.PUT,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/friend_discoveries"),a.params={friend_discoveries:i.map(function(s){return{friend_discovery_key:s.friendDiscoveryKey,friend_name:s.friendName}})},a}return j(t,n),t}(Te),zB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.friendDiscoveryRequestId=r.friend_discovery_request_id,i}return j(t,n),t}(Me),KB=function(n){function t(e){var r=e.userId,i=e.discoveryKeys,a=n.call(this)||this;return a.method=Ie.DELETE,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/friend_discoveries"),a.params={friend_discovery_keys:i},a}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var WB=function(n){function t(e){var r=e.userId,i=e.userIds,a=n.call(this)||this;return a.method=Ie.POST,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/friends"),a.params={user_ids:i},a}return j(t,n),t}(Te),$B=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.users=r.users.map(function(a){return new _t(e,a)}),i}return j(t,n),t}(Me),YB=function(n){function t(e){var r=e.userId,i=e.userIds,a=n.call(this)||this;return a.method=Ie.DELETE,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/friends"),a.params={user_ids:i},a}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var QB=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(xt,"/").concat(r,"/allow_friend_discovery"),i.params={},i}return j(t,n),t}(Te),ZB=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.allowFriendDiscovery=r.allow_friend_discovery,i}return j(t,n),t}(Me),XB=function(n){function t(e){var r=e.userId,i=e.allowFriendDiscovery,a=n.call(this)||this;return a.method=Ie.PUT,a.path="".concat(xt,"/").concat(r,"/allow_friend_discovery"),a.params={allow_friend_discovery:i},a}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var sm,JB=function(n){function t(){var e=n.call(this)||this;return e.method=Ie.GET,e.path=c2,e}return j(t,n),t}(Te),eG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.emojiContainer=new GM(r),i}return j(t,n),t}(Me),nG=function(n){function t(e){var r=e.categoryId,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(c2,"/").concat(r),i}return j(t,n),t}(Te),tG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.emojiCategory=new BM(r),i}return j(t,n),t}(Me),rG=function(n){function t(e){var r=e.key,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(w5,"/").concat(r),i}return j(t,n),t}(Te),iG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.emoji=new HM(r),i}return j(t,n),t}(Me),aG=function(n){function t(){var e=n.call(this)||this;return e.method=Ie.GET,e.path="".concat(R5),e}return j(t,n),t}(Te),sG=function(n){function t(e,r){var i,a=this,s=r??{};return(a=n.call(this,e,r)||this).uikitConfiguration={string:JSON.stringify(s),json:s},a.updatedAt=(i=r==null?void 0:r.updated_at)!==null&&i!==void 0?i:0,a}return j(t,n),t}(Me);(function(n){n.DELIVERED="DELIVERED",n.CLICKED="CLICKED"})(sm||(sm={}));var Af,W1=function(n){function t(e){var r=e.deviceToken,i=e.pushTrackingId,a=e.messageId,s=e.allowedPushNotification,u=e.channelKey,d=e.templateKey,h=e.eventType,p=e.notificationEventDeadline,g=n.call(this)||this;return g.method=Ie.POST,g.path=k5,g.params=ze({device_token:r,push_tracking_id:i,message_id:a,allowed_push_notification:s,channel_key:u,template_key:d,event_type:h,notification_event_deadline:p}),g}return j(t,n),t}(Te),VM=function(){function n(t,e,r){var i=this;this._storeInitialized=!1,this._iid=t,this.options=e;var a=X.of(t),s=a.sdkState,u=a.cacheContext,d=a.dispatcher,h=a.sessionManager,p=a.requestQueue,g=a.logger,E=a.userEventHandlers,y=a.appStateToggleEnabled;this._onlineDetector=new cB({logger:g,connectionDelegate:{reconnect:function(){return M(i,void 0,void 0,function(){var T,A,O,N,k,D;return R(this,function(P){switch(P.label){case 0:if(T=X.of(t),A=T.sdkState,O=T.connectionManager,(N=T.sessionManager).session.hasSession)return[3,5];P.label=1;case 1:return P.trys.push([1,3,,4]),[4,O.connect(N.session.authToken)];case 2:return P.sent(),[3,4];case 3:if(k=P.sent(),Gi(k))throw k;return g.debug("connect failed by reconnect event = ",k),[3,4];case 4:return[3,9];case 5:if(A.appState!=="foreground")return[3,9];P.label=6;case 6:return P.trys.push([6,8,,9]),[4,O.resetAndReconnect()];case 7:return P.sent(),[3,9];case 8:if(D=P.sent(),Gi(D))throw D;return g.debug("resetAndReconnect failed by reconnect event = ",D),[3,9];case 9:return d.dispatch(new j1),[2]}})})},disconnect:function(){Pr(function(){return M(i,void 0,void 0,function(){return R(this,function(T){switch(T.label){case 0:return[4,X.of(t).connectionManager.disconnect()];case 1:return T.sent(),[2]}})})})}}});var C=new Wf(t,{localCacheEnabled:u.localCacheEnabled,enableAutoResend:u.localCacheConfig.enableAutoResend,dispatcher:d,sdkState:s,logger:g});r.forEach(function(T){T.init(t,{sdkState:s,cacheContext:u,dispatcher:d,sessionManager:h,requestQueue:p,logger:g,onlineDetector:i._onlineDetector}),i[T.name]=T}),this._appStateChangeDetector=new dB({isEnabled:y}),this._appStateChangeDetector.on("resume",function(){g.debug("the page resumes from freeze"),i.setForegroundState()}).on("pause",function(){g.debug("the page freezes"),i.setBackgroundState()}),d.on(function(T){var A;if(T instanceof Aa)T.stateType===Gt.CONNECTED&&C.processNonAutoResendRegisteredPendingMessages();else if(T instanceof dr){if(T.code==="USEV"){var O=T.as(FM).event;if(O.category===Ch.FRIEND_DISCOVERED){var N=am.getDataAsFriendDiscoveredEvent(t,O).friendDiscoveries;an(function(){return M(i,void 0,void 0,function(){return R(this,function(U){return[2,E.forEach(function(L){L.onFriendsDiscovered&&L.onFriendsDiscovered(N)})]})})})}}}else if(T instanceof H2){var k=X.of(i._iid).subscribedUnreadMessageCount,D=!1,P=T.ts;typeof P=="number"&&P>k.ts&&(k.all!==T.all&&(D=!0),k.all=T.all>=0?T.all:0,T.customTypes&&Object.keys(T.customTypes).forEach(function(U){k.customTypes[U]!==T.customTypes[U]&&(D=!0),k.customTypes[U]=T.customTypes[U]}),D=D&&k.ts>0,k.ts=P),D&&an(function(){return M(i,void 0,void 0,function(){return R(this,function(U){return[2,E.forEach(function(L){L.onTotalUnreadMessageCountChanged&&L.onTotalUnreadMessageCountChanged({groupChannelCount:k.all,feedChannelCount:k.feed,customTypeUnreadCount:k.customTypes}),L.onTotalUnreadMessageCountUpdated&&L.onTotalUnreadMessageCountUpdated(k.all,k.customTypes)})]})})})}else T instanceof V2?(u.preference.set(i._getUserProfileCacheKey(s.userId),ty.payloadify(T.userProfile)),!((A=T.userProfile.appInfo.notificationInfo)===null||A===void 0)&&A.isEnabled&&u.preference.set(eC(i.appId),{value:!0})):T instanceof mc&&T.error&&T.error.isSessionInvalidatedError&&(g.debug("session revoked."),i._internalDisconnect(T.error))})}return n.init=function(t){var e=t.appId,r=t.appVersion,i=t.modules,a=i===void 0?[]:i,s=t.options,u=s===void 0?new o2:s,d=t.debugMode,h=d!==void 0&&d,p=t.customApiHost,g=t.customWebSocketHost,E=t.newInstance,y=E!==void 0&&E,C=t.logLevel,T=t.localCacheEnabled,A=T!==void 0&&T,O=t.localCacheConfig,N=O===void 0?new d2:O,k=t.localCacheEncryption,D=t.useAsyncStorageStore,P=D===void 0?null:D,U=t.useMMKVStorageStore,L=U===void 0?null:U,B=t.appStateToggleEnabled,q=B===void 0||B;if(!Af||y){var z="su-".concat(Bu()),Y=k??{encrypt:function(ue){return ue},decrypt:function(ue){return ue}},Q=new PH;Q.level=C??Ou.WARN;var $=new kl({encryption:Y});h||(ZE()?L?$=new xH({MMKV:L,encryption:Y}):P&&($=new LH({AsyncStorage:P,encryption:Y}),Q.warn("AsyncStorage store is deprecated due to the small size limit. Please use MMKVStorage store instead.")):$=new DH({encryption:Y})),new X(z,{appId:e,appVersion:r,options:u,apiHost:p??"https://api-".concat(e,".sendbird.com"),websocketHost:g??"wss://ws-".concat(e,".sendbird.com"),store:$,encryption:Y,logger:Q,localCacheEnabled:A,localCacheConfig:N,debugMode:h,appStateToggleEnabled:q});var Z=[new iB,new sB],ne=new n(z,u,Nn(Nn([],cn(a),!1),cn(Z),!1));return Af||(Af=ne),ne}return Af},Object.defineProperty(n,"instance",{get:function(){return Af},enumerable:!1,configurable:!0}),Object.defineProperty(n,"version",{get:function(){return s2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"appId",{get:function(){return X.of(this._iid).sdkState.appId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"appInfo",{get:function(){var t=X.of(this._iid).appInfo;return t??null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"appVersion",{get:function(){var t;return(t=X.of(this._iid).sdkState.appVersion)!==null&&t!==void 0?t:""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"debugMode",{get:function(){return!!X.of(this._iid).debugMode},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"logLevel",{get:function(){return X.of(this._iid).logger.level},set:function(t){X.of(this._iid).logger.level=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isCacheEnabled",{get:function(){return X.of(this._iid).cacheContext.localCacheEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localCacheConfig",{get:function(){var t=X.of(this._iid).cacheContext;return t.localCacheEnabled?t.localCacheConfig:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ekey",{get:function(){return X.of(this._iid).sessionManager.ekey},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentUser",{get:function(){var t;return(t=X.of(this._iid).sessionManager.currentUser)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"connectionState",{get:function(){var t=X.of(this._iid).connectionManager;return t.isConnected?Xs.OPEN:t.isConnecting?Xs.CONNECTING:Xs.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastConnectedAt",{get:function(){var t=X.of(this._iid),e=t.connectedAt;return t.connectionManager.isConnected?e:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fcmPushToken",{get:function(){var t;return(t=this._fcmPushToken)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apnsPushToken",{get:function(){var t;return(t=this._apnsPushToken)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),n.prototype._getNestDBVersion=function(){return 7},n.prototype._getPreferenceVersion=function(){return 8},n.prototype._getPreferenceCacheKey=function(t){return"sendbird@".concat(this.appId,"/").concat(t,".pref")},n.prototype._getUserProfileCacheKey=function(t){return"sendbird@".concat(this.appId,"/").concat(t,".profile")},n.prototype._internalDisconnect=function(t){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return e=X.of(this._iid),r=e.connectionManager,i=e.sdkState,a=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),a.cancelAll(),[4,r.logout(t)];case 1:return s.sent(),[4,this.clearCachedData()];case 2:return s.sent(),i.appState="foreground",[2]}})})},n.prototype.getMemoryStoreForDebugging=function(){var t=X.of(this._iid),e=t.debugMode,r=t.cacheContext;if(e)return r.store instanceof kl?r.store:null;throw ee.debugModeRequired},n.prototype.addExtension=function(t,e){var r=X.of(this._iid).sdkState;["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(t)>-1&&r.extensions&&(r.extensions[t]=e)},n.prototype.addSendbirdExtensions=function(t,e,r){var i,a,s=X.of(this._iid),u=s.logger,d=s.sdkState,h=new RegExp(H5);if(t.length===0)return u.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."),!1;if(t.find(function(T){return!h.test(T.version)}))return u.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."),!1;if(r)try{for(var p=Le(Object.entries(r)),g=p.next();!g.done;g=p.next()){var E=cn(g.value,2),y=E[0],C=E[1];if(/&|=/.test(y)||/&|=/.test(C))return u.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."),!1}}catch(T){i={error:T}}finally{try{g&&!g.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}return d.sendbirdRuntimeEnvironment={sendbirdExtensions:t,deviceOS:e,customData:r},!0},n.prototype.setOnlineListener=function(t){this._onlineDetector.setOnlineListener(t)},n.prototype.setOfflineListener=function(t){this._onlineDetector.setOfflineListener(t)},n.prototype._safeInitializeStore=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:e=X.of(this._iid).cacheContext,r.label=1;case 1:return r.trys.push([1,3,,5]),[4,e.store.init(t)];case 2:return r.sent(),this._storeInitialized=!0,[3,5];case 3:return r.sent(),e.replaceStore(new kl),[4,this._safeInitializeStore(t)];case 4:return r.sent(),[3,5];case 5:return[2]}})})},n.prototype.setLocaleForChatbot=function(t){var e=X.of(this._iid).sdkState,r=function(i){return i.replace(/[^a-zA-Z-_.]/g,"")}(t.trim());r&&(e.localeForChatbot=r)},n.prototype.initializeCache=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p;return R(this,function(g){switch(g.label){case 0:if(e=X.of(this._iid),r=e.sdkState,i=e.cacheContext,a=e.dispatcher,s=e.logger,r.userId&&r.userId===t)return[3,13];u="sendbird@".concat(r.appId,"/").concat(t,".db"),g.label=1;case 1:return g.trys.push([1,9,11,13]),i.localCacheEnabled?i.nestdb&&i.nestdb.state!==Ys.CLOSED&&i.nestdb.name===u?[3,3]:(d="sendbird@".concat(r.appId,"/").concat(t,".db"),(h=i.nestdb=new UH({name:d,version:this._getNestDBVersion(),store:i.store,config:new xh({dbname:d,itemSizeLimit:61440})})).on("upgrade",q1(h)),h.on("storeReplaced",function(E){i.replaceStore(E),i.localCacheEnabled=!1,h.on("upgrade",q1(h))}),[4,h.open()]):[3,6];case 2:return g.sent(),this._storeInitialized=!0,a.dispatch(new UM(this._iid,{userId:t})),[3,5];case 3:return[4,this._safeInitializeStore(u)];case 4:g.sent(),g.label=5;case 5:return r.userId=t,[3,8];case 6:return[4,this._safeInitializeStore(u)];case 7:g.sent(),r.userId=t,g.label=8;case 8:return[3,13];case 9:return p=g.sent(),s.warn("Nest DB Open Failed. ",p),i.store instanceof kl||(i.replaceStore(new kl),i.localCacheEnabled=!1),[4,this._safeInitializeStore(u)];case 10:throw g.sent(),r.userId=t,ee.databaseError;case 11:return[4,this._setupPreference(t)];case 12:return g.sent(),[7];case 13:return[2]}})})},n.prototype.getCacheDataSize=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return(t=X.of(this._iid).cacheContext).localCacheEnabled&&t.nestdb?[4,t.nestdb.estimateUsage()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,0]}})})},n.prototype.clearCachedData=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return(t=X.of(this._iid).cacheContext).localCacheEnabled&&t.nestdb?[4,t.nestdb.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this._storeInitialized?[4,t.preference.clear()]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}})})},n.prototype.clearCachedMessages=function(t){return M(this,void 0,void 0,function(){var e,r,i=this;return R(this,function(a){switch(a.label){case 0:return Se(tt("string",t)).throw(ee.invalidParameters),e=fc.of(this._iid),r=nd.of(this._iid),e&&r?[4,Promise.all(t.map(function(s){return M(i,void 0,void 0,function(){return R(this,function(u){switch(u.label){case 0:return[4,e.removeMessagesOfChannel(s)];case 1:return u.sent(),[4,r.removeMessagesOfChannel(s)];case 2:return u.sent(),[2]}})})}))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},n.prototype._setupPreference=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.cacheContext,a=e.statManager,[4,i.preference.init(this._getPreferenceCacheKey(t),this._getPreferenceVersion())];case 1:return u.sent(),[4,i.preference.get(this._getUserProfileCacheKey(t))];case 2:return(s=u.sent())&&new ty(this._iid,s).apply(),[4,a.init("sendbird@".concat(r.appId,"/").concat(t,".statlog"))];case 3:return u.sent(),[2]}})})},n.prototype._ready=function(t,e,r){return r===void 0&&(r={}),M(this,void 0,void 0,function(){var i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return Se(J("string",t)&&J("string",e,!0)).throw(ee.invalidParameters),i=X.of(this._iid),a=i.sdkState,s=i.cacheContext,u=i.connectionManager,d=r.errorForOtherUser,a.userId&&a.userId!==t?d?[3,2]:[4,u.logout()]:[3,3];case 1:return p.sent(),[3,3];case 2:throw d;case 3:return p.trys.push([3,5,,6]),[4,this.initializeCache(t)];case 4:return p.sent(),X.of(this._iid).dispatcher.dispatch(new PM),[3,6];case 5:return p.sent(),h=X.of(this._iid).logger,s.localCacheEnabled=!1,h.warn("Cache initialization failed - cache is not available."),[3,6];case 6:return[2]}})})},n.prototype.authenticateFeed=function(t,e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this.authenticate(t,e)];case 1:return[2,r.sent()]}})})},n.prototype.authenticate=function(t,e,r){var i;return r===void 0&&(r=H_.SESSION_TOKEN),M(this,void 0,void 0,function(){var a,s,u;return R(this,function(d){switch(d.label){case 0:return a=X.of(this._iid),s=a.sessionManager,u=a.connectionManager,[4,this._ready(t,e,{errorForOtherUser:u.isConnected?ee.alreadyConnectedAsAnotherUser:void 0})];case 1:return d.sent(),!((i=s.session.services)===null||i===void 0)&&i.includes(G_.CHAT)?[3,3]:(s.handler||e&&r!==H_.ACCESS_TOKEN||this.setSessionHandler(new k1),[4,s.authenticate(t,e)]);case 2:d.sent(),d.label=3;case 3:return[2,this.currentUser]}})})},n.prototype.connect=function(t,e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._ready(t,e)];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,X.of(this._iid).connectionManager.connect(e)];case 3:return r.sent(),[3,5];case 4:return this._onlineDetector.start(),this._appStateChangeDetector.start(),[7];case 5:return[2,this.currentUser]}})})},n.prototype.reconnect=function(){var t=X.of(this._iid),e=t.connectionManager,r=t.sdkState,i=t.sessionManager.session.hasSession;return i&&(this._appStateChangeDetector.start(),this._onlineDetector.start(),e.resetAndReconnect().then(function(){r.appState="foreground"}).catch(function(){})),i},n.prototype.disconnect=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,this._internalDisconnect()];case 1:return t.sent(),[2]}})})},n.prototype.disconnectWebSocket=function(){return M(this,void 0,void 0,function(){var t,e,r;return R(this,function(i){switch(i.label){case 0:return t=X.of(this._iid),e=t.connectionManager,r=t.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),r.cancelAll(),[4,e.disconnectWebSocket(!0)];case 1:return i.sent(),[2]}})})},n.prototype.setBackgroundState=function(){var t=X.of(this._iid),e=t.connectionManager,r=t.sdkState,i=t.logger;r.appState==="foreground"&&(r.appState="background",i.debug("going background state"),e.background().catch(function(a){i.debug("setBackgroundState error = ",a)}))},n.prototype.setForegroundState=function(){var t=X.of(this._iid),e=t.connectionManager,r=t.sdkState,i=t.dispatcher,a=t.logger;r.appState==="background"&&(r.appState="foreground",a.debug("going foreground state"),e.resetAndReconnect().catch(function(s){a.debug("setForgroundState error = ",s)}),i.dispatch(new j1))},n.prototype.setSessionHandler=function(t){Se(t instanceof k1).throw(ee.invalidParameters),X.of(this._iid).sessionManager.handler=t},n.prototype.addUserEventHandler=function(t,e){Se(J("string",t)&&e instanceof mH).throw(ee.invalidParameters),X.of(this._iid).userEventHandlers.set(t,e)},n.prototype.removeUserEventHandler=function(t){X.of(this._iid).userEventHandlers.delete(t)},n.prototype.removeAllUserEventHandler=function(){X.of(this._iid).userEventHandlers.clear()},n.prototype.addConnectionHandler=function(t,e){Se(J("string",t)&&e instanceof OM).throw(ee.invalidParameters),X.of(this._iid).connectionHandlers.set(t,e)},n.prototype.removeConnectionHandler=function(t){X.of(this._iid).connectionHandlers.delete(t)},n.prototype.removeAllConnectionHandler=function(){X.of(this._iid).connectionHandlers.clear()},n.prototype.createApplicationUserListQuery=function(t){return t===void 0&&(t={}),new EH(this._iid,t)},n.prototype.createBlockedUserListQuery=function(t){return t===void 0&&(t={}),new CH(this._iid,t)},n.prototype.createFriendListQuery=function(t){return t===void 0&&(t={}),new SH(this._iid,t)},n.prototype.createMessageSearchQuery=function(t){return new XH(this._iid,t)},n.prototype.createPollListQuery=function(t){return new aM(this._iid,W({},t))},n.prototype.createPollVoterListQuery=function(t){return new sM(this._iid,W({},t))},n.prototype.buildUserFromSerializedData=function(t){var e=ko(t);return new _t(this._iid,_t.payloadify(e))},n.prototype.updateCurrentUserInfo=function(t){return t===void 0&&(t={}),M(this,void 0,void 0,function(){var e,r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return e=W(W({},oB),t),Se(function(p){return oi(p.profileImage,!0)&&J("string",p.profileUrl,!0)&&J("string",p.nickname,!0)}(e)).throw(ee.invalidParameters),this.currentUser?(r=X.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new z1(W({userId:i.userId},e)),[4,a.send(s)]):[3,2];case 1:return u=h.sent(),d=u.as(K1).user,this.currentUser&&(e.nickname&&(this.currentUser.nickname=d.nickname),(e.profileUrl||e.profileImage)&&(this.currentUser.plainProfileUrl=d.profileUrl)),[2,d];case 2:throw ee.connectionRequired}})})},n.prototype.updateCurrentUserInfoWithPreferredLanguages=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return Se(tt("string",t)).throw(ee.invalidParameters),this.currentUser?(e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new z1({userId:r.userId,preferredLanguages:t}),[4,i.send(a)]):[3,2];case 1:return s=d.sent(),u=s.as(K1).user,this.currentUser&&(this.currentUser.preferredLanguages=u.preferredLanguages),[2,u];case 2:throw ee.connectionRequired}})})},n.prototype.registerFCMPushTokenForCurrentUser=function(t,e){var r,i;return M(this,void 0,void 0,function(){var a,s,u,d,h,p,g=this;return R(this,function(E){switch(E.label){case 0:if(Se(J("string",t)&&J("string",e==null?void 0:e.deviceManufacturer,!0)).throw(ee.invalidParameters),e!=null&&e.deviceOS&&Se(nt(Io,e.deviceOS.platform,!0)&&J("string",e.deviceOS.version,!0)).throw(ee.invalidParameters),!this.currentUser)return[3,6];a={deviceOS:"".concat(((r=e==null?void 0:e.deviceOS)===null||r===void 0?void 0:r.platform)||Io.ANDROID,"-").concat(((i=e==null?void 0:e.deviceOS)===null||i===void 0?void 0:i.version)||"unknown"),deviceManufacturer:e==null?void 0:e.deviceManufacturer,systemPushEnabled:e==null?void 0:e.systemPushEnabled},E.label=1;case 1:return E.trys.push([1,4,,5]),s=X.of(this._iid),u=s.sessionManager,d=s.sdkState,h=s.requestQueue,u.hasDeviceToken(si.FCM,t)?[2,$i.SUCCESS]:(p=new hB({userId:d.userId,token:t,deviceOS:a.deviceOS,deviceManufacturer:a.deviceManufacturer,systemPushEnabled:a.systemPushEnabled}),[4,h.send(p)]);case 2:return E.sent(),[4,Pr(function(){return M(g,void 0,void 0,function(){return R(this,function(y){switch(y.label){case 0:return u.setDeviceToken(si.FCM,t,a),[4,u.saveDeviceToken()];case 1:return y.sent(),[2]}})})})];case 3:return E.sent(),this._fcmPushToken="",[2,$i.SUCCESS];case 4:return E.sent(),[2,$i.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=t,[2,$i.PENDING];case 7:return[2]}})})},n.prototype.unregisterFCMPushTokenForCurrentUser=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d=this;return R(this,function(h){switch(h.label){case 0:if(Se(J("string",t)).throw(ee.invalidParameters),!this.currentUser)return[3,6];h.label=1;case 1:return h.trys.push([1,4,,5]),e=X.of(this._iid),r=e.sessionManager,i=e.sdkState,a=e.requestQueue,s=new _B({userId:i.userId,token:t}),[4,a.send(s)];case 2:return u=h.sent().lastDeletedAt,[4,Pr(function(){return M(d,void 0,void 0,function(){return R(this,function(p){switch(p.label){case 0:return r.unsetDeviceToken(si.FCM,t),r.setDeviceTokenDeletedAt(u),[4,r.saveDeviceToken()];case 1:return p.sent(),[2]}})})})];case 3:return h.sent(),this._fcmPushToken="",[2,$i.SUCCESS];case 4:return h.sent(),[2,$i.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=t,[2,$i.PENDING];case 7:return[2]}})})},n.prototype.unregisterFCMPushTokenAllForCurrentUser=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u=this;return R(this,function(d){switch(d.label){case 0:return this.currentUser?(t=X.of(this._iid),e=t.sessionManager,r=t.sdkState,i=t.requestQueue,a=new gB({userId:r.userId}),[4,i.send(a)]):[3,3];case 1:return s=d.sent().lastDeletedAt,[4,Pr(function(){return M(u,void 0,void 0,function(){return R(this,function(h){switch(h.label){case 0:return e.unsetDeviceTokens(si.FCM),e.setDeviceTokenDeletedAt(s),[4,e.saveDeviceToken()];case 1:return h.sent(),[2]}})})})];case 2:d.sent(),d.label=3;case 3:return[2]}})})},n.prototype.registerAPNSPushTokenForCurrentUser=function(t,e){var r,i;return M(this,void 0,void 0,function(){var a,s,u,d,h,p,g=this;return R(this,function(E){switch(E.label){case 0:if(Se(J("string",t)&&J("string",e==null?void 0:e.deviceManufacturer,!0)).throw(ee.invalidParameters),e!=null&&e.deviceOS&&Se(nt(Io,e.deviceOS.platform,!0)&&J("string",e.deviceOS.version,!0)).throw(ee.invalidParameters),!this.currentUser)return[3,6];a={deviceOS:"".concat(((r=e==null?void 0:e.deviceOS)===null||r===void 0?void 0:r.platform)||Io.IOS,"-").concat(((i=e==null?void 0:e.deviceOS)===null||i===void 0?void 0:i.version)||"unknown"),deviceManufacturer:e==null?void 0:e.deviceManufacturer,systemPushEnabled:e==null?void 0:e.systemPushEnabled},E.label=1;case 1:return E.trys.push([1,4,,5]),s=X.of(this._iid),u=s.sessionManager,d=s.sdkState,h=s.requestQueue,u.hasDeviceToken(si.APNS,t)?[2,$i.SUCCESS]:(p=new fB({userId:d.userId,token:t,deviceOS:a.deviceOS,deviceManufacturer:a.deviceManufacturer,systemPushEnabled:a.systemPushEnabled}),[4,h.send(p)]);case 2:return E.sent(),[4,Pr(function(){return M(g,void 0,void 0,function(){return R(this,function(y){switch(y.label){case 0:return u.setDeviceToken(si.APNS,t,a),[4,u.saveDeviceToken()];case 1:return y.sent(),[2]}})})})];case 3:return E.sent(),this._apnsPushToken="",[2,$i.SUCCESS];case 4:return E.sent(),[2,$i.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=t,[2,$i.PENDING];case 7:return[2]}})})},n.prototype.unregisterAPNSPushTokenForCurrentUser=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d=this;return R(this,function(h){switch(h.label){case 0:if(Se(J("string",t)).throw(ee.invalidParameters),!this.currentUser)return[3,6];h.label=1;case 1:return h.trys.push([1,4,,5]),e=X.of(this._iid),r=e.sessionManager,i=e.sdkState,a=e.requestQueue,s=new pB({userId:i.userId,token:t}),[4,a.send(s)];case 2:return u=h.sent().lastDeletedAt,[4,Pr(function(){return M(d,void 0,void 0,function(){return R(this,function(p){switch(p.label){case 0:return r.unsetDeviceToken(si.APNS,t),r.setDeviceTokenDeletedAt(u),[4,r.saveDeviceToken()];case 1:return p.sent(),[2]}})})})];case 3:return h.sent(),this._apnsPushToken="",[2,$i.SUCCESS];case 4:return h.sent(),[2,$i.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=t,[2,$i.PENDING];case 7:return[2]}})})},n.prototype.unregisterAPNSPushTokenAllForCurrentUser=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a,s,u=this;return R(this,function(d){switch(d.label){case 0:return this.currentUser?(t=X.of(this._iid),e=t.sessionManager,r=t.sdkState,i=t.requestQueue,a=new mB({userId:r.userId}),[4,i.send(a)]):[3,3];case 1:return s=d.sent().lastDeletedAt,[4,Pr(function(){return M(u,void 0,void 0,function(){return R(this,function(h){switch(h.label){case 0:return e.unsetDeviceTokens(si.APNS),e.setDeviceTokenDeletedAt(s),[4,e.saveDeviceToken()];case 1:return h.sent(),[2]}})})})];case 2:d.sent(),d.label=3;case 3:return[2]}})})},n.prototype.markPushNotificationAsDelivered=function(t,e){var r;return e===void 0&&(e=!0),M(this,void 0,void 0,function(){var i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U;return R(this,function(L){switch(L.label){case 0:if(i=X.of(this._iid),a=i.logger,s=i.sessionManager,u=i.requestQueue,d=i.pushNotificationAckManager,a.debug("markPushNotificationAsDelivered:",t),h=sm.DELIVERED,p=d.parseData(t),g=p.pushTrackingId,E=p.sessionTopics,y=p.sessionKey,C=p.messageId,T=p.channelKey,A=p.templateKey,O=p.notificationEventDeadline,!y||!E.includes(Y_.PUSH_ACKNOWLEDGEMENT))throw a.info("Can't use markPushNotificationAsDelivered() feature."),ee.malformedDataError;if(d.isAcked(g,h))return a.info("already delivered push notification:",g),[2];N=!!T,k=e&&N,D=(r=s.deviceTokens[0])===null||r===void 0?void 0:r.token,P=new W1({deviceToken:D??"",pushTrackingId:g,eventType:h,messageId:C,channelKey:T,templateKey:A,notificationEventDeadline:O,allowedPushNotification:k}),y&&(P.headers["Session-Key"]=y),L.label=1;case 1:return L.trys.push([1,3,,4]),[4,u.send(P)];case 2:return L.sent(),d.markAsAcked(g,h),[3,4];case 3:throw U=L.sent(),a.debug("failed to mark push notification as delivered. push tracking id: ".concat(g,". error: ").concat(U)),U;case 4:return[2]}})})},n.prototype.markPushNotificationAsClicked=function(t){var e;return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k;return R(this,function(D){switch(D.label){case 0:if(r=X.of(this._iid),i=r.logger,a=r.sessionManager,s=r.requestQueue,u=r.pushNotificationAckManager,i.debug("markPushNotificationAsClicked:",t),d=sm.CLICKED,h=u.parseData(t),p=h.pushTrackingId,g=h.sessionTopics,E=h.sessionKey,y=h.messageId,C=h.channelKey,T=h.templateKey,A=h.notificationEventDeadline,!E||!g.includes(Y_.PUSH_ACKNOWLEDGEMENT))throw i.info("Can't use markPushNotificationAsClicked() feature."),ee.malformedDataError;if(u.isAcked(p,d))return i.info("already clicked push notification:",p),[2];O=(e=a.deviceTokens[0])===null||e===void 0?void 0:e.token,N=new W1({deviceToken:O??"",pushTrackingId:p,eventType:d,messageId:y,channelKey:C,templateKey:T,notificationEventDeadline:A}),E&&(N.headers["Session-Key"]=E),D.label=1;case 1:return D.trys.push([1,3,,4]),[4,s.send(N)];case 2:return D.sent(),u.markAsAcked(p,d),[3,4];case 3:throw k=D.sent(),i.debug("failed to mark push notification as clicked. push tracking id: ".concat(p,". error: ").concat(k)),k;case 4:return[2]}})})},n.prototype.getChannelInvitationPreference=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a;return R(this,function(s){switch(s.label){case 0:return t=X.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new yB({userId:e.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,{autoAccept:a.as(bB).autoAccept}]}})})},n.prototype.setChannelInvitationPreference=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(J("boolean",t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new CB({userId:r.userId,willAutoAccept:t}),[4,i.send(a)];case 1:return s=u.sent(),[2,{autoAccept:s.as(IB).autoAccept}]}})})},n.prototype.getDoNotDisturb=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a;return R(this,function(s){switch(s.label){case 0:return t=X.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new TB({userId:e.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(SB).preference]}})})},n.prototype.setDoNotDisturb=function(t,e,r,i,a,s){return e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=""),M(this,void 0,void 0,function(){var u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:return Se(J("boolean",t)&&J("number",e)&&J("number",r)&&J("number",i)&&J("number",a)&&J("string",s)).throw(ee.invalidParameters),u=X.of(this._iid),d=u.sdkState,h=u.requestQueue,p=new NB({userId:d.userId,doNotDisturbOn:t,startHour:e,startMin:r,endHour:i,endMin:a,timezone:s}),[4,h.send(p)];case 1:return g=E.sent(),[2,g.as(AB).preference]}})})},n.prototype.getSnoozePeriod=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a;return R(this,function(s){switch(s.label){case 0:return t=X.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new wB({userId:e.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(RB).snoozePeriod]}})})},n.prototype.setSnoozePeriod=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=0),M(this,void 0,void 0,function(){var i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return Se(J("boolean",t)&&J("number",e)&&J("number",r)).throw(ee.invalidParameters),i=X.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new MB({userId:a.userId,snoozeOn:t,startTs:e,endTs:r}),[4,s.send(u)];case 1:return d=h.sent(),[2,d.as(OB).snoozePeriod]}})})},n.prototype.getMyPushTokensByToken=function(t,e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g,E,y,C;return R(this,function(T){switch(T.label){case 0:return Se(J("string",t)&&nt(si,e)).throw(ee.invalidParameters),r=X.of(this._iid),i=r.sdkState,a=r.requestQueue,s=r.sessionManager,u=new vB({userId:i.userId,type:e,token:t}),[4,a.send(u)];case 1:d=T.sent(),h=d.as(EB).pushTokens;try{for(p=Le(h.deviceTokens),g=p.next();!g.done;g=p.next())E=g.value,s.setDeviceToken(h.type,E)}catch(A){y={error:A}}finally{try{g&&!g.done&&(C=p.return)&&C.call(p)}finally{if(y)throw y.error}}return[4,s.saveDeviceToken()];case 2:return T.sent(),[2,h]}})})},n.prototype.getPushTriggerOption=function(){return M(this,void 0,void 0,function(){var t,e,r,i;return R(this,function(a){switch(a.label){case 0:return t=X.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new LB({userId:e.userId}),[4,r.send(i)];case 1:return[2,a.sent().as(xB).pushTriggerOption]}})})},n.prototype.setPushTriggerOption=function(t){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return Se(nt(Pl,t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new UB({userId:r.userId,pushTriggerOption:t}),[4,i.send(a)];case 1:return[2,s.sent().as(PB).pushTriggerOption]}})})},n.prototype.getPushTemplate=function(){return M(this,void 0,void 0,function(){var t,e,r,i;return R(this,function(a){switch(a.label){case 0:return t=X.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new FB({userId:e.userId}),[4,r.send(i)];case 1:return[2,a.sent().as(HB).name]}})})},n.prototype.setPushTemplate=function(t){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return Se(nt(KE,t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new BB({userId:r.userId,templateName:t}),[4,i.send(a)];case 1:return[2,s.sent().as(GB).name]}})})},n.prototype.blockUser=function(t){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return Se(t instanceof _t||J("string",t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new kB({userId:r.userId,blockedUserId:t instanceof _t?t.userId:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.blockUserWithUserId=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){return[2,this.blockUser(t)]})})},n.prototype.unblockUser=function(t){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return Se(t instanceof _t||J("string",t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new DB({userId:r.userId,unblockedUserId:t instanceof _t?t.userId:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.unblockUserWithUserId=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){return[2,this.unblockUser(t)]})})},n.prototype.getFriendChangeLogsByToken=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(J("string",t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new VB({userId:r.userId,token:t}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(jB).changelogs]}})})},n.prototype.getAllowFriendDiscovery=function(){return M(this,void 0,void 0,function(){var t,e,r,i,a;return R(this,function(s){switch(s.label){case 0:return t=X.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new QB({userId:e.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(ZB).allowFriendDiscovery]}})})},n.prototype.setAllowFriendDiscovery=function(t){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return Se(J("boolean",t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new XB({userId:r.userId,allowFriendDiscovery:t}),[4,i.send(a)];case 1:return s.sent(),[2,t]}})})},n.prototype.uploadFriendDiscoveries=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new qB({userId:r.userId,discoveries:t}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(zB).friendDiscoveryRequestId]}})})},n.prototype.deleteFriendDiscovery=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){return[2,this.deleteFriendDiscoveries([t])]})})},n.prototype.deleteFriendDiscoveries=function(t){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return Se(tt("string",t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new KB({userId:r.userId,discoveryKeys:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.addFriends=function(t){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(tt("string",t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new WB({userId:r.userId,userIds:t}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as($B).users]}})})},n.prototype.deleteFriend=function(t){return M(this,void 0,void 0,function(){return R(this,function(e){return[2,this.deleteFriends([t])]})})},n.prototype.deleteFriends=function(t){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return Se(tt("string",t)).throw(ee.invalidParameters),e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new YB({userId:r.userId,userIds:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.getAllEmoji=function(){return M(this,void 0,void 0,function(){var t,e,r;return R(this,function(i){switch(i.label){case 0:return t=X.of(this._iid).requestQueue,e=new JB,[4,t.send(e)];case 1:return r=i.sent(),[2,r.as(eG).emojiContainer]}})})},n.prototype.getEmojiCategory=function(t){return M(this,void 0,void 0,function(){var e,r,i;return R(this,function(a){switch(a.label){case 0:return e=X.of(this._iid).requestQueue,r=new nG({categoryId:t}),[4,e.send(r)];case 1:return i=a.sent(),[2,i.as(tG).emojiCategory]}})})},n.prototype.getEmoji=function(t){return M(this,void 0,void 0,function(){var e,r,i;return R(this,function(a){switch(a.label){case 0:return e=X.of(this._iid).requestQueue,r=new rG({key:t}),[4,e.send(r)];case 1:return i=a.sent(),[2,i.as(iG).emoji]}})})},n.prototype.getUIKitConfiguration=function(){return M(this,void 0,void 0,function(){var t,e,r,i;return R(this,function(a){switch(a.label){case 0:return t=X.of(this._iid),Se(t.hasExtension("sb_uikit")).throw(ee.notSupportedError),e=t.requestQueue,r=new aG,[4,e.send(r)];case 1:return i=a.sent(),[2,i.as(sG).uikitConfiguration]}})})},n.prototype.getReportCategoryInfoList=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,X.of(this._iid).reportCategoryManager.categories()];case 1:return[2,t.sent()]}})})},n}(),Wt;(function(n){n[n.NONE=0]="NONE",n[n.CHANNEL_ENTER=10102]="CHANNEL_ENTER",n[n.CHANNEL_EXIT=10103]="CHANNEL_EXIT",n[n.USER_CHANNEL_MUTE=10201]="USER_CHANNEL_MUTE",n[n.USER_CHANNEL_UNMUTE=10200]="USER_CHANNEL_UNMUTE",n[n.USER_CHANNEL_BAN=10601]="USER_CHANNEL_BAN",n[n.USER_CHANNEL_UNBAN=10600]="USER_CHANNEL_UNBAN",n[n.CHANNEL_FREEZE=10701]="CHANNEL_FREEZE",n[n.CHANNEL_UNFREEZE=10700]="CHANNEL_UNFREEZE",n[n.TYPING_START=10900]="TYPING_START",n[n.TYPING_END=10901]="TYPING_END",n[n.CHANNEL_JOIN=1e4]="CHANNEL_JOIN",n[n.CHANNEL_LEAVE=10001]="CHANNEL_LEAVE",n[n.CHANNEL_OPERATOR_UPDATE=10002]="CHANNEL_OPERATOR_UPDATE",n[n.CHANNEL_INVITE=10020]="CHANNEL_INVITE",n[n.CHANNEL_ACCEPT_INVITE=10021]="CHANNEL_ACCEPT_INVITE",n[n.CHANNEL_DECLINE_INVITE=10022]="CHANNEL_DECLINE_INVITE",n[n.CHANNEL_PROP_CHANGED=11e3]="CHANNEL_PROP_CHANGED",n[n.CHANNEL_DELETED=12e3]="CHANNEL_DELETED",n[n.CHANNEL_META_DATA_CHANGED=11100]="CHANNEL_META_DATA_CHANGED",n[n.CHANNEL_META_COUNTERS_CHANGED=11200]="CHANNEL_META_COUNTERS_CHANGED",n[n.CHANNEL_HIDE=13e3]="CHANNEL_HIDE",n[n.CHANNEL_UNHIDE=13001]="CHANNEL_UNHIDE",n[n.PINNED_MESSAGE_CHANGED=11300]="PINNED_MESSAGE_CHANGED"})(Wt||(Wt={}));var uG=function(){function n(t){var e;this.channelUrl=t.channel_url,this.channelType=t.channel_type,this.category=t.cat,this.data=(e=t.data)!==null&&e!==void 0?e:{},this.ts=t.ts}return Object.defineProperty(n.prototype,"isGroupChannelEvent",{get:function(){return this.channelType===vt.GROUP},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isOpenChannelEvent",{get:function(){return this.channelType===vt.OPEN},enumerable:!1,configurable:!0}),n}(),qu=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.event=new uG(i),a}return j(t,n),t}(dr),jM=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this,s=i.data.operators,u=s===void 0?[]:s;return a.operators=u.map(function(d){return new _t(a._iid,d)}),a}return j(t,n),t}(qu),qM=function(n){function t(e,r,i){var a,s=this;return(s=n.call(this,e,"SYEV",i)||this).pinnedMessageIds=[],s.latestPinnedMessage=null,s.ts=0,i.data&&(s.pinnedMessageIds=(a=i.data.pinned_message_ids)!==null&&a!==void 0?a:[],s.latestPinnedMessage=i.data.latest_pinned_message?Ri(e,W({},i.data.latest_pinned_message)):null),s.ts=i.ts,s}return j(t,n),t}(dr),zM=function(n){function t(e,r){var i=n.call(this,e)||this;return i._logger=r.logger,i._sdkState=r.sdkState,i._sessionManager=r.sessionManager,i._requestQueue=r.requestQueue,i._dispatcher=r.dispatcher,i._cacheContext=r.cacheContext,i._channelType=r.channelType,i}return j(t,n),Object.defineProperty(t.prototype,"_messageBroadcast",{get:function(){return DM.of(this._iid)},enumerable:!1,configurable:!0}),t.prototype.subscribeMessageEvent=function(e,r){this._messageBroadcast.subscribe(e,r)},t.prototype.unsubscribeMessageEvent=function(e){this._messageBroadcast.unsubscribe(e)},t.prototype.getMessageFromCache=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2,null]})})},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,r,i){return M(this,void 0,void 0,function(){return R(this,function(a){return[2,[]]})})},t.prototype.getMessagesFromCache=function(e,r,i,a,s,u){return M(this,void 0,void 0,function(){return R(this,function(d){return[2,[]]})})},t.prototype.getPollMessagesFromCache=function(e,r,i,a){return M(this,void 0,void 0,function(){return R(this,function(s){return[2,[]]})})},t.prototype.getCachedMessageCountBetween=function(e,r,i,a){return M(this,void 0,void 0,function(){return R(this,function(s){return[2,0]})})},t.prototype.getUnsentMessagesFromCache=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){return[2,[]]})})},t.prototype.removeFailedMessageFromCache=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2]})})},t}(Zr),KM=function(n){function t(e,r,i){var a,s,u,d,h=this;(h=n.call(this,e,"ADMM",i)||this).message=new Xl(e,i);var p=X.of(e).sdkState;return h.isMentioned=_c(h.message.mentionType,(u=(a=h.message.mentionedUserIds)!==null&&a!==void 0?a:(s=h.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(g){return g.userId}))!==null&&u!==void 0?u:[],p.userId),h.forceUpdateLastMessage=(d=i.force_update_last_message)!==null&&d!==void 0&&d,h}return j(t,n),t}(dr),WM=function(n){function t(e,r,i){var a,s,u,d,h,p=this;(p=n.call(this,e,"AEDI",i)||this).message=new Xl(e,i);var g=X.of(e).sdkState;return p.mentionCountChange=$b({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(u=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&u!==void 0?u:[]},_n({mentionType:p.message.mentionType,mentionedUserIds:(d=p.message.mentionedUserIds)!==null&&d!==void 0?d:(h=p.message.mentionedUsers)===null||h===void 0?void 0:h.map(function(E){return E.userId})}),g.userId),p}return j(t,n),t}(dr),$M=function(n){function t(e,r,i){var a=n.call(this,e,"MRCT",i)||this;return a.channelUrl=i.channel_url,a.channelType=i.channel_type,a.event=new aC(i),a}return j(t,n),t}(dr),YM=function(n){function t(e,r,i){var a=n.call(this,e,"MTHD",i)||this;return a.event=new LM(e,i),a}return j(t,n),t}(dr),QM=function(n){function t(e,r,i){var a=n.call(this,e,"MCNT",i)||this;return a.groupChannelMemberCounts=i.group_channels.map(function(s){return{channelUrl:s.channel_url,memberCount:s.member_count,joinedMemberCount:s.joined_member_count,updatedAt:s.ts}}),a.openChannelMemberCounts=i.open_channels.map(function(s){return{channelUrl:s.channel_url,participantCount:s.participant_count,updatedAt:s.ts}}),a}return j(t,n),t}(dr),ZM=function(n){function t(e,r,i){var a=n.call(this,e,"PEDI",i)||this;return a.event=new aB(e,i),a.status=ry(i.poll.status)||i.poll.status,a.channelUrl=i.channel_url,a.channelType=i.channel_type,a}return j(t,n),t}(dr),Dr;(function(n){n.NONE="none",n.JOINED="joined",n.INVITED="invited",n.LEFT="left"})(Dr||(Dr={}));var iu,oa,da,Lo,Ss,um,Pu,Ih,qa=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.state=null,i.role=null,i.isMuted=!1,i.isBlockedByMe=!1,i.isBlockingMe=!1,i.state=nt(Dr,r.state)?r.state:null,i.role=nt(Ka,r.role)?r.role:null,typeof r.is_muted=="boolean"&&(i.isMuted=r.is_muted),typeof r.is_blocked_by_me=="boolean"&&(i.isBlockedByMe=r.is_blocked_by_me),typeof r.is_blocking_me=="boolean"&&(i.isBlockingMe=r.is_blocking_me),i}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{state:e.state,role:e.role,is_muted:e.isMuted,is_blocked_by_me:e.isBlockedByMe,is_blocking_me:e.isBlockingMe})))},t}(ud),oG=function(n){function t(e,r){var i,a,s=this;return(s=n.call(this,e)||this).channelUrl=(i=r.channel_url)!==null&&i!==void 0?i:"",s.channelType=(a=r.channel_type)!==null&&a!==void 0?a:vt.GROUP,s.member=new _t(s._iid,r.user),s.deliveryAt=r.ts,s}return j(t,n),t}(Zr);(function(n){n.ALL="all",n.PUBLIC="public",n.PRIVATE="private"})(iu||(iu={})),function(n){n.ALL="all",n.JOINED="joined_only",n.INVITED="invited_only",n.INVITED_BY_FRIEND="invited_by_friend",n.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(oa||(oa={})),function(n){n.ALL="all",n.SUPER="super",n.NON_SUPER="nonsuper",n.BROADCAST_ONLY="broadcast_only",n.EXCLUSIVE_ONLY="exclusive_only"}(da||(da={})),function(n){n.ALL="all",n.UNREAD_MESSAGE="unread_message"}(Lo||(Lo={})),function(n){n.ALL="all",n.UNHIDDEN="unhidden_only",n.HIDDEN="hidden_only",n.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",n.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Ss||(Ss={})),function(n){n.ALL="all",n.OPERATOR="operator",n.NONOPERATOR="nonoperator"}(um||(um={})),function(n){n.AND="AND",n.OR="OR"}(Pu||(Pu={})),function(n){n.MEMBER_NICKNAME="member_nickname",n.CHANNEL_NAME="channel_name"}(Ih||(Ih={}));var br,XM=function(){function n(t){var e,r,i,a,s,u,d,h,p,g,E,y,C,T,A;this._searchFilter=null,this._userIdsFilter=null,this.includeEmpty=(e=t==null?void 0:t.includeEmpty)!==null&&e!==void 0&&e,this.nicknameContainsFilter=(r=t==null?void 0:t.nicknameContainsFilter)!==null&&r!==void 0?r:null,this.nicknameStartsWithFilter=(i=t==null?void 0:t.nicknameStartsWithFilter)!==null&&i!==void 0?i:null,this.nicknameExactMatchFilter=(a=t==null?void 0:t.nicknameExactMatchFilter)!==null&&a!==void 0?a:null,this.channelNameContainsFilter=(s=t==null?void 0:t.channelNameContainsFilter)!==null&&s!==void 0?s:"",this.myMemberStateFilter=(u=t==null?void 0:t.myMemberStateFilter)!==null&&u!==void 0?u:oa.ALL,this.customTypesFilter=(d=t==null?void 0:t.customTypesFilter)!==null&&d!==void 0?d:null,this.channelUrlsFilter=(h=t==null?void 0:t.channelUrlsFilter)!==null&&h!==void 0?h:null,this.superChannelFilter=(p=t==null?void 0:t.superChannelFilter)!==null&&p!==void 0?p:da.ALL,this.publicChannelFilter=(g=t==null?void 0:t.publicChannelFilter)!==null&&g!==void 0?g:iu.ALL,this.customTypeStartsWithFilter=(E=t==null?void 0:t.customTypeStartsWithFilter)!==null&&E!==void 0?E:null,this.unreadChannelFilter=(y=t==null?void 0:t.unreadChannelFilter)!==null&&y!==void 0?y:Lo.ALL,this.hiddenChannelFilter=(C=t==null?void 0:t.hiddenChannelFilter)!==null&&C!==void 0?C:Ss.UNHIDDEN,this.includeFrozen=(T=t==null?void 0:t.includeFrozen)===null||T===void 0||T,t!=null&&t.createdAfter&&(this.createdAfter=t.createdAfter),t!=null&&t.createdBefore&&(this.createdBefore=t.createdBefore),this.includeMetaData=(A=t==null?void 0:t.includeMetaData)===null||A===void 0||A}return n.prototype._isFriend=function(t){return!(!t||!t.friendDiscoveryKey&&!t.friendName)},Object.defineProperty(n.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),n.prototype.setSearchFilter=function(t,e){Array.isArray(t)&&t.length!==0&&typeof e=="string"&&e&&(this._searchFilter={query:e,fields:t})},Object.defineProperty(n.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),n.prototype.setUserIdsFilter=function(t,e,r){r===void 0&&(r=Pu.AND),this._userIdsFilter={userIds:t,includeMode:e,queryType:r}},n.prototype.clone=function(){var t,e=new n;this.searchFilter&&e.setSearchFilter(this.searchFilter.fields,(t=this.searchFilter.query)!==null&&t!==void 0?t:void 0),this.userIdsFilter&&e.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var r=JSON.parse(JSON.stringify(this));return Object.keys(r).forEach(function(i){e[i]=r[i]}),e},n.prototype.match=function(t,e){if(this._searchFilter){var r=this._searchFilter,i=r.query,a=r.fields;if(i&&a&&a.length>0&&!a.some(function(C){switch(C){case Ih.CHANNEL_NAME:return t.name.toLowerCase().includes(i.toLowerCase());case Ih.MEMBER_NICKNAME:return t.members.some(function(T){return T.nickname.toLowerCase().includes(i.toLowerCase())});default:return!0}}))return!1}if(this._userIdsFilter){var s=this._userIdsFilter,u=s.userIds,d=s.includeMode,h=s.queryType,p=t.members.map(function(C){return C.userId});if(d){if(u.length>0)switch(h){case Pu.AND:if(u.some(function(C){return!p.includes(C)}))return!1;break;case Pu.OR:if(u.every(function(C){return!p.includes(C)}))return!1}}else if(u.includes(e)||u.push(e),t.members.length>u.length||!v5(u,p))return!1}if(!this.includeEmpty&&!t.lastMessage||!this.includeFrozen&&t.isFrozen||this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(t.customType)||this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(t.customType)||this.channelNameContainsFilter&&!t.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var g=this.nicknameContainsFilter.toLowerCase();if(!t.members.some(function(C){return C.userId!==e&&C.nickname.toLowerCase().includes(g)}))return!1}if(this.nicknameStartsWithFilter){var E=this.nicknameStartsWithFilter.toLowerCase();if(!t.members.some(function(C){return C.userId!==e&&C.nickname.toLowerCase().startsWith(E)}))return!1}if(this.nicknameExactMatchFilter){var y=this.nicknameExactMatchFilter.toLowerCase();if(!t.members.some(function(C){return C.userId!==e&&C.nickname.toLowerCase()!=y}))return!1}if(this.channelUrlsFilter&&this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(t.url))return!1;if(this.myMemberStateFilter)switch(this.myMemberStateFilter){case oa.ALL:if(t.myMemberState==="none")return!1;break;case oa.JOINED:if(t.myMemberState!=="joined")return!1;break;case oa.INVITED:if(t.myMemberState!=="invited")return!1;break;case oa.INVITED_BY_FRIEND:if(t.myMemberState!=="invited"||!this._isFriend(t.inviter))return!1;break;case oa.INVITED_BY_NON_FRIEND:if(t.myMemberState!=="invited"||this._isFriend(t.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case Ss.UNHIDDEN:if(t.isHidden||t.hiddenState!=="unhidden")return!1;break;case Ss.HIDDEN:if(!t.isHidden)return!1;break;case Ss.HIDDEN_ALLOW_AUTO_UNHIDE:if(!t.isHidden||t.hiddenState!=="hidden_allow_auto_unhide")return!1;break;case Ss.HIDDEN_PREVENT_AUTO_UNHIDE:if(!t.isHidden||t.hiddenState!=="hidden_prevent_auto_unhide")return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===Lo.UNREAD_MESSAGE&&t.unreadMessageCount===0)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case iu.PUBLIC:if(!t.isPublic)return!1;break;case iu.PRIVATE:if(t.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case da.SUPER:if(!t.isSuper)return!1;break;case da.NON_SUPER:if(t.isSuper)return!1}return!(this.createdAfter&&t.createdAt<this.createdAfter)&&!(this.createdBefore&&t.createdAt>this.createdBefore)},n}(),lG=function(n){function t(e,r){var i=r.sdkState,a=r.cacheContext,s=n.call(this,e)||this;return s._channels=new Map,s._sdkState=i,s._cacheContext=a,s}return j(t,n),Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return Se(!!e).throw(ee.databaseError),e.collection(wM)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e,r){return r===void 0&&(r=0),W(W({},e.serialize()),{lastMessageUpdatedAt:e.lastMessage?e.lastMessage.createdAt:0,syncIndex:r})},t.prototype._deserialize=function(e){return ai.of(this._iid).buildGroupChannelFromSerializedData(e)},Object.defineProperty(t.prototype,"channels",{get:function(){return Nn([],cn(this._channels.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.isCachedInMemory=function(e){return this._channels.has(e)},t.prototype.filterOffsetChanged=function(e){var r=this;return e.filter(function(i){if(r._channels.has(i.url))return r._channels.get(i.url).messageOffsetTimestamp<i.messageOffsetTimestamp})},t.prototype.get=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:return this._channels.has(e)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(r=a.sent())return i=this._deserialize(r),this._channels.set(e,i),[2,i];a.label=2;case 2:return[2,void 0];case 3:return[2,this._channels.get(e)]}})})},t.prototype.fetch=function(e){var r=e.token,i=e.limit,a=i===void 0?AM:i,s=e.backward,u=s!==void 0&&s,d=e.filter,h=d===void 0?new XM:d,p=e.order,g=p===void 0?Er.LATEST_LAST_MESSAGE:p,E=e.borderlineChannelUrl;return M(this,void 0,void 0,function(){var y,C,T,A,O,N=this;return R(this,function(k){switch(k.label){case 0:return this.localCacheEnabled?(y=!!E,C=A_(g),T={where:function(D){if(r)switch(g){case Er.CHANNEL_NAME_ALPHABETICAL:if(!u&&D.name.localeCompare(r)<0||u&&D.name.localeCompare(r)>0)return!1;break;case Er.CHRONOLOGICAL:if(!u&&D.createdAt>r||u&&D.createdAt<r)return!1;break;case Er.LATEST_LAST_MESSAGE:if(!u&&D.lastMessageUpdatedAt>r||u&&D.lastMessageUpdatedAt<r)return!1}return y&&E&&E===D.url?(y=!1,!1):!y&&h.match(N._deserialize(D),N._sdkState.userId)},index:C,backward:u},[4,this.collection.query(T)]):[3,3];case 1:return[4,k.sent().fetch({limit:a})];case 2:return A=k.sent(),(O=A.map(function(D){return N._deserialize(D)})).forEach(function(D){!h.includeMetaData&&D.cachedMetaData&&D._clearCachedMetaData(),N._channels.has(D.url)||N._channels.set(D.url,D)}),[2,O];case 3:return[2,[]]}})})},t.prototype.upsert=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u=this;return R(this,function(d){switch(d.label){case 0:if(i=[],e.forEach(function(h){if(u._channels.has(h.url)){var p=u._channels.get(h.url);p._pinnedMessagesUpdatedAt<h._pinnedMessagesUpdatedAt&&(p._pinnedMessagesUpdatedAt=h._pinnedMessagesUpdatedAt),p._messageCollectionLastAccessedAt>h._messageCollectionLastAccessedAt&&Object.assign(h,{_messageCollectionLastAccessedAt:void 0}),h.cachedMetaData&&r&&(p._updateCachedMetaData(h.cachedMetaData,r).isUpdated||Object.assign(h,{_cachedMetaData:void 0})),p._update(h),i.push(p)}else u._channels.set(h.url,h),i.push(h)}),!this.localCacheEnabled)return[3,2];for(a=[],s=0;s<i.length;s++)a.push(this._serialize(i[s],s));return[4,this.collection.upsertMany(a)];case 1:d.sent(),d.label=2;case 2:return[2,i]}})})},t.prototype.remove=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:h.trys.push([0,5,6,7]),r=Le(e),i=r.next(),h.label=1;case 1:return i.done?[3,4]:(a=i.value,this._channels.delete(a),this.localCacheEnabled?[4,this.collection.remove(a)]:[3,3]);case 2:h.sent(),h.label=3;case 3:return i=r.next(),[3,1];case 4:return[3,7];case 5:return s=h.sent(),u={error:s},[3,7];case 6:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(u)throw u.error}return[7];case 7:return[2]}})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.clearMemoryCache=function(){this._channels.clear()},t.prototype._setBlockStateOfAllChannels=function(e,r,i){return M(this,void 0,void 0,function(){var a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L;return R(this,function(B){switch(B.label){case 0:if(a=[],e===this._sdkState.userId)try{for(s=Le(this._channels.values()),u=s.next();!u.done;u=s.next()){E=u.value;try{for(N=void 0,d=Le(E.members),h=d.next();!h.done;h=d.next())if((T=h.value).userId===r){T.isBlockedByMe=i,a.push(E);break}}catch(q){N={error:q}}finally{try{h&&!h.done&&(k=d.return)&&k.call(d)}finally{if(N)throw N.error}}}}catch(q){A={error:q}}finally{try{u&&!u.done&&(O=s.return)&&O.call(s)}finally{if(A)throw A.error}}else if(r===this._sdkState.userId)try{for(p=Le(this._channels.values()),g=p.next();!g.done;g=p.next()){E=g.value;try{for(U=void 0,y=Le(E.members),C=y.next();!C.done;C=y.next())if((T=C.value).userId===e){T.isBlockingMe=i,a.push(E);break}}catch(q){U={error:q}}finally{try{C&&!C.done&&(L=y.return)&&L.call(y)}finally{if(U)throw U.error}}}}catch(q){D={error:q}}finally{try{g&&!g.done&&(P=p.return)&&P.call(p)}finally{if(D)throw D.error}}return a.length>0?[4,this.upsert(a)]:[3,2];case 1:B.sent(),B.label=2;case 2:return[2]}})})},t.prototype.block=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return[4,this._setBlockStateOfAllChannels(e,r,!0)];case 1:return i.sent(),[2]}})})},t.prototype.unblock=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return[4,this._setBlockStateOfAllChannels(e,r,!1)];case 1:return i.sent(),[2]}})})},t.prototype.markAsRead=function(e,r){return r===void 0&&(r=Nn([],cn(this._channels.keys()),!1)),M(this,void 0,void 0,function(){var i,a,s,u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:i=[],E.label=1;case 1:E.trys.push([1,6,7,8]),a=Le(r),s=a.next(),E.label=2;case 2:return s.done?[3,5]:(u=s.value,[4,this.get(u)]);case 3:(d=E.sent())!=null&&d._updateUnreadMemberState(this._sdkState.userId,e)&&(d._updateUnreadCount(0,0),i.push(d)),E.label=4;case 4:return s=a.next(),[3,2];case 5:return[3,8];case 6:return h=E.sent(),p={error:h},[3,8];case 7:try{s&&!s.done&&(g=a.return)&&g.call(a)}finally{if(p)throw p.error}return[7];case 8:return i.length>0?[4,this.upsert(i)]:[3,10];case 9:E.sent(),E.label=10;case 10:return[2]}})})},t}(Zr),w_={invitedUserIds:void 0,channelUrl:void 0,coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isSuper:void 0,isBroadcast:void 0,isExclusive:void 0,isPublic:void 0,isDiscoverable:void 0,isStrict:void 0,isEphemeral:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},py=function(n){return tt("string",n.invitedUserIds,!0)&&J("string",n.channelUrl,!0)&&J("string",n.coverUrl,!0)&&(oi(n.coverImage)||J("string",n.coverImage,!0))&&J("boolean",n.isDistinct,!0)&&J("boolean",n.isSuper,!0)&&J("boolean",n.isBroadcast,!0)&&J("boolean",n.isExclusive,!0)&&J("boolean",n.isPublic,!0)&&J("boolean",n.isStrict,!0)&&J("boolean",n.isDiscoverable,!0)&&J("boolean",n.isEphemeral,!0)&&J("string",n.accessCode,!0)&&J("string",n.name,!0)&&J("string",n.data,!0)&&J("string",n.customType,!0)&&tt("string",n.operatorUserIds,!0)&&J("number",n.messageSurvivalSeconds,!0)},om={customTypes:void 0,includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,includeChatNotification:!1},_y=function(n){return tt("string",n.customTypes,!0)&&J("boolean",n.includeEmpty,!0)&&J("boolean",n.includeFrozen,!0)&&J("boolean",n.includeMetaData,!0)&&J("boolean",n.includeChatNotification,!0)},JM={myMemberStateFilter:oa.ALL},eO=function(n){return nt(oa,n.myMemberStateFilter)};(function(n){n.GROUP_CHANNEL_UNREAD_MENTION_COUNT="group_channel_unread_mention_count",n.NONSUPER_UNREAD_MENTION_COUNT="non_super_group_channel_unread_mention_count",n.SUPER_UNREAD_MENTION_COUNT="super_group_channel_unread_mention_count",n.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT="group_channel_unread_message_count",n.NONSUPER_UNREAD_MESSAGE_COUNT="non_super_group_channel_unread_message_count",n.SUPER_UNREAD_MESSAGE_COUNT="super_group_channel_unread_message_count",n.GROUP_CHANNEL_INVITATION_COUNT="group_channel_invitation_count",n.NONSUPER_INVITATION_COUNT="non_super_group_channel_invitation_count",n.SUPER_INVITATION_COUNT="super_group_channel_invitation_count"})(br||(br={}));var dG={keys:[br.GROUP_CHANNEL_UNREAD_MENTION_COUNT,br.NONSUPER_UNREAD_MENTION_COUNT,br.SUPER_UNREAD_MENTION_COUNT,br.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT,br.NONSUPER_UNREAD_MESSAGE_COUNT,br.SUPER_UNREAD_MESSAGE_COUNT,br.GROUP_CHANNEL_INVITATION_COUNT,br.NONSUPER_INVITATION_COUNT,br.SUPER_INVITATION_COUNT],customTypeFilters:void 0,customTypesFilter:void 0},cG={channelCustomTypesFilter:void 0,superChannelFilter:da.ALL},fG=function(n){return tt("string",n.channelCustomTypesFilter,!0)&&nt(da,n.superChannelFilter)},hG={channelUrl:void 0,scheduledStatus:void 0,messageTypeFilter:Ni.ALL};W({},ge);var R_=function(n){return n.startsWith("EVENT_")||n===ge.SYNC_CHANNEL_CHANGELOGS||n===ge.REFRESH_CHANNEL},pt=function(n){function t(e){var r=e.channels,i=e.context,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=e.ts,d=n.call(this)||this;return d.channels=r,d.context=i,d.isWebSocketEventComing=s,d.ts=u,d}return j(t,n),t}(Cr),Su=function(n){function t(e){var r=e.channelUrls,i=e.context,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.channelUrls=r,u.context=i,u.isWebSocketEventComing=s,u}return j(t,n),t}(Cr),pG=function(){function n(t){var e=t.groupChannelCache,r=t.messageCache,i=t.unsentMessageCache,a=t.dispatcher,s=this;this._observers=new Map,a.on(function(u){return M(s,void 0,void 0,function(){var d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z=this;return R(this,function(Y){switch(Y.label){case 0:if(!(u instanceof pt))return[3,19];if(d=u.channels,D=u.context,P=u.isWebSocketEventComing,h=d.filter(function(Q){return Q instanceof Qa}),D.source!==ge.EVENT_CHANNEL_RESET_HISTORY&&D.source!==ge.EVENT_CHANNEL_HIDDEN)return[3,9];Y.label=1;case 1:Y.trys.push([1,6,7,8]),p=Le(h),g=p.next(),Y.label=2;case 2:return g.done?[3,5]:(A=g.value,[4,r.removeUnderOffset(A.url,A.messageOffsetTimestamp)]);case 3:Y.sent(),Y.label=4;case 4:return g=p.next(),[3,2];case 5:return[3,8];case 6:return E=Y.sent(),U={error:E},[3,8];case 7:try{g&&!g.done&&(L=p.return)&&L.call(p)}finally{if(U)throw U.error}return[7];case 8:return[3,17];case 9:y=e.filterOffsetChanged(h),Y.label=10;case 10:Y.trys.push([10,15,16,17]),C=Le(y),T=C.next(),Y.label=11;case 11:return T.done?[3,14]:(A=T.value,[4,r.removeUnderOffset(A.url,A.messageOffsetTimestamp)]);case 12:Y.sent(),Y.label=13;case 13:return T=C.next(),[3,11];case 14:return[3,17];case 15:return O=Y.sent(),B={error:O},[3,17];case 16:try{T&&!T.done&&(q=C.return)&&q.call(C)}finally{if(B)throw B.error}return[7];case 17:return[4,e.upsert(h,u.ts)];case 18:return N=Y.sent(),P||this._broadcastUpdateEvent(N,D),[3,24];case 19:return u instanceof Su?(k=u.channelUrls,D=u.context,P=u.isWebSocketEventComing,[4,e.remove(k)]):[3,22];case 20:return Y.sent(),[4,Pr(function(){return M(z,void 0,void 0,function(){var Q,$,Z,ne,ue,pe;return R(this,function(he){switch(he.label){case 0:he.trys.push([0,6,7,8]),Q=Le(k),$=Q.next(),he.label=1;case 1:return $.done?[3,5]:(Z=$.value,[4,r.removeMessagesOfChannel(Z)]);case 2:return he.sent(),[4,i.removeMessagesOfChannel(Z)];case 3:he.sent(),he.label=4;case 4:return $=Q.next(),[3,1];case 5:return[3,8];case 6:return ne=he.sent(),ue={error:ne},[3,8];case 7:try{$&&!$.done&&(pe=Q.return)&&pe.call(Q)}finally{if(ue)throw ue.error}return[7];case 8:return[2]}})})})];case 21:return Y.sent(),P||this._broadcastRemoveEvent(k,D),[3,24];case 22:return u instanceof UM?[4,e.fetch({token:Number.MAX_SAFE_INTEGER,limit:Number.MAX_SAFE_INTEGER})]:[3,24];case 23:Y.sent(),Y.label=24;case 24:return[2]}})})})}return n.prototype._broadcastUpdateEvent=function(t,e){var r,i;try{for(var a=Le(this._observers.values()),s=a.next();!s.done;s=a.next()){var u=s.value;u.onUpdate&&u.onUpdate(t,e)}}catch(d){r={error:d}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},n.prototype._broadcastRemoveEvent=function(t,e){var r,i;try{for(var a=Le(this._observers.values()),s=a.next();!s.done;s=a.next()){var u=s.value;u.onRemove&&u.onRemove(t,e)}}catch(d){r={error:d}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},n.prototype.subscribe=function(t,e){this._observers.set(t,e)},n.prototype.unsubscribe=function(t){this._observers.delete(t)},n.prototype.unsubscribeAll=function(){this._observers.clear()},n}(),_G=function(n){function t(e){var r=e.userId,i=e.ts,a=e.token,s=e.filter,u=e.includeChatNotification,d=u!==void 0&&u,h=n.call(this)||this,p=W(W({},om),s),g=p.customTypes,E=p.includeEmpty,y=p.includeFrozen;return h.method=Ie.GET,h.path="".concat(xt,"/").concat(encodeURIComponent(r),"/my_group_channels/changelogs"),h.params=ze(_n({show_delivery_receipt:!0,show_member:!0,show_read_receipt:!0,change_ts:i||null,token:a,custom_types:g,show_empty:E,show_frozen:y,include_chat_notification:d})),h}return j(t,n),t}(Te),mG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.updatedChannels=r.updated.map(function(a){return new Qa(e,Object.assign(a,{ts:r.ts}))}),i.deletedChannelUrls=r.deleted,i.hasMore=r.has_more,i.token=r.next,i.ts=r.ts,i}return j(t,n),t}(Me),my=function(n){function t(e){var r=e.channelUrl,i=e.isInternalCall,a=e.showLatestMessage,s=n.call(this)||this;return s.method=Ie.GET,s.path="".concat(i?S5:qi,"/").concat(encodeURIComponent(r)),s.params={show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_latest_message:a!=null&&a},s}return j(t,n),t}(Te),gy=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Qa(e,r),i}return j(t,n),t}(Me),Qd={includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,includeChatNotification:!1,channelUrlsFilter:void 0,customTypesFilter:void 0,customTypeStartsWithFilter:void 0,nicknameContainsFilter:void 0,nicknameStartsWithFilter:void 0,nicknameExactMatchFilter:void 0,channelNameContainsFilter:void 0,myMemberStateFilter:oa.ALL,unreadChannelFilter:Lo.ALL,superChannelFilter:da.ALL,publicChannelFilter:iu.ALL,hiddenChannelFilter:Ss.ALL,userIdsFilter:{userIds:[],includeMode:!0,queryType:Pu.AND},searchFilter:{query:void 0,fields:[]},metadataKey:void 0,metadataValues:void 0,metadataOrderKeyFilter:void 0,metadataValueStartsWith:void 0,order:Er.LATEST_LAST_MESSAGE,createdAfter:void 0,createdBefore:void 0},gG=function(n){function t(e){var r=this,i=e.userId,a=e.token,s=e.limit,u=e.order,d=e.includeEmpty,h=e.myMemberStateFilter,p=e.superChannelFilter,g=e.publicChannelFilter,E=e.unreadChannelFilter,y=e.nicknameContainsFilter,C=e.nicknameStartsWithFilter,T=e.nicknameExactMatchFilter,A=e.channelNameContainsFilter,O=e.channelUrlsFilter,N=e.customTypesFilter,k=e.customTypeStartsWithFilter,D=e.hiddenChannelFilter,P=e.metadataOrderKeyFilter,U=e.metadataKey,L=e.metadataValues,B=e.metadataValueStartsWith,q=e.includeFrozen,z=e.includeMetaData,Y=e.searchFilter,Q=e.userIdsFilter,$=e.includeChatNotification,Z=$!==void 0&&$,ne=e.includeLeftChannel,ue=ne!==void 0&&ne,pe=e.createdAfter,he=e.createdBefore;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(xt,"/").concat(encodeURIComponent(i),"/my_group_channels"),r.params=ze({token:a,limit:s,order:u??Qd.order,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:d??Qd.includeEmpty,member_state_filter:h??Qd.myMemberStateFilter,super_mode:p??Qd.superChannelFilter,public_mode:g??Qd.publicChannelFilter,unread_filter:E??Qd.unreadChannelFilter,members_nickname_contains:y,members_nickname_startswith:C,members_nickname:T,name_contains:A,channel_urls:O,custom_types:N,custom_type_startswith:k,hidden_mode:D,metadata_order_key:P,metadata_key:U,metadata_values:L,metadata_value_startswith:B,show_frozen:q,show_metadata:z,include_chat_notification:Z,include_left_channel:ue,created_after:pe,created_before:he}),Y&&Y.query&&Y.fields&&(r.params.search_query=Y.query,r.params.search_fields=Y.fields),Q&&Q.userIds&&Q.userIds.length>0&&(Q.includeMode?(r.params.members_include_in=Q.userIds,r.params.query_type=Q.queryType.toUpperCase()):r.params.members_exactly_in=Q.userIds),r}return j(t,n),t}(Te),vG=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.channels=[];var a=r.next,s=r.channels,u=r.ts;return i.token=a,s&&s.length>0&&(i.channels=s.map(function(d){return d.ts=u,new Qa(e,d)})),i.ts=u??0,i}return j(t,n),t}(Me),EG=function(n){function t(e){var r=e.userId,i=e.filter,a=n.call(this)||this,s=i.myMemberStateFilter;return a.method=Ie.GET,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/group_channel_count"),a.params={state:s??oa.ALL},a}return j(t,n),t}(Te),yG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.groupChannelCount=r.group_channel_count,i}return j(t,n),t}(Me),bG=function(n){function t(e){var r=e.userId,i=e.filter,a=n.call(this)||this,s=i.keys,u=i.customTypeFilters,d=i.customTypesFilter;return a.method=Ie.GET,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/unread_item_count"),a.params=ze({item_keys:s,custom_types:d??u}),a}return j(t,n),t}(Te),CG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return typeof r[br.GROUP_CHANNEL_UNREAD_MENTION_COUNT]=="number"&&(i.groupChannelUnreadMentionCount=r[br.GROUP_CHANNEL_UNREAD_MENTION_COUNT]),typeof r[br.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]=="number"&&(i.groupChannelUnreadMessageCount=r[br.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]),typeof r[br.GROUP_CHANNEL_INVITATION_COUNT]=="number"&&(i.groupChannelInvitationCount=r[br.GROUP_CHANNEL_INVITATION_COUNT]),typeof r[br.SUPER_UNREAD_MENTION_COUNT]=="number"&&(i.superGroupChannelUnreadMentionCount=r[br.SUPER_UNREAD_MENTION_COUNT]),typeof r[br.SUPER_UNREAD_MESSAGE_COUNT]=="number"&&(i.superGroupChannelUnreadMessageCount=r[br.SUPER_UNREAD_MESSAGE_COUNT]),typeof r[br.SUPER_INVITATION_COUNT]=="number"&&(i.superGroupChannelInvitationCount=r[br.SUPER_INVITATION_COUNT]),typeof r[br.NONSUPER_UNREAD_MENTION_COUNT]=="number"&&(i.nonSuperGroupChannelUnreadMentionCount=r[br.NONSUPER_UNREAD_MENTION_COUNT]),typeof r[br.NONSUPER_UNREAD_MESSAGE_COUNT]=="number"&&(i.nonSuperGroupChannelUnreadMessageCount=r[br.NONSUPER_UNREAD_MESSAGE_COUNT]),typeof r[br.NONSUPER_INVITATION_COUNT]=="number"&&(i.nonSuperGroupChannelInvitationCount=r[br.NONSUPER_INVITATION_COUNT]),i}return j(t,n),t}(Me),IG=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=Ie.GET,i.path="".concat(xt,"/").concat(encodeURIComponent(r),"/unread_channel_count"),i}return j(t,n),t}(Te),TG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.unreadCount=r.unread_count,i}return j(t,n),t}(Me),SG=function(n){function t(e){var r=e.userId,i=e.filter,a=e.includeFeedChannel,s=a!==void 0&&a,u=n.call(this)||this,d=i.channelCustomTypesFilter,h=i.superChannelFilter;return u.method=Ie.GET,u.path="".concat(xt,"/").concat(encodeURIComponent(r),"/unread_message_count"),u.params={super_mode:h??da.ALL,custom_types:d,include_feed_channel:s},u}return j(t,n),t}(Te),NG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.unreadCount=r.unread_count,i.unreadFeedCount=r.unread_feed_count,i}return j(t,n),t}(Me),AG=function(n){function t(e){var r=e.channelUrl,i=e.scheduledStatus,a=e.messageTypeFilter,s=n.call(this)||this;return s.method=Ie.GET,s.path="".concat(f2,"/count"),s.params={channel_url:r,status:RG(i)},a&&(s.params.message_type=a),s}return j(t,n),t}(Te),wG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.count=r.count,i}return j(t,n),t}(Me),RG=function(n){if(!n)return[];var t=[];return n.forEach(function(e){switch(e){case To.PENDING:t.push(ja.PENDING);break;case To.SENT:t.push(ja.IN_QUEUE),t.push(ja.SENT);break;case To.CANCELED:t.push(ja.CANCELED);break;case To.FAILED:t.push(ja.FAILED)}}),t},MG=function(n){function t(e){var r=this,i=e.userId,a=e.channelUrl,s=e.coverUrl,u=e.coverImage,d=e.isDistinct,h=e.isSuper,p=e.isBroadcast,g=e.isPublic,E=e.isExclusive,y=e.isDiscoverable,C=e.isStrict,T=e.isEphemeral,A=e.accessCode,O=e.name,N=e.data,k=e.customType,D=e.messageSurvivalSeconds,P=e.invitedUserIds,U=e.operatorUserIds;return(r=n.call(this)||this).method=Ie.POST,r.path=qi,r.params=ze({user_ids:Nn([i],cn(P??[]),!1).filter(function(L,B,q){return B===q.indexOf(L)}),channel_url:a,cover_url:s,cover_file:u,is_distinct:d,is_super:h,is_broadcast:p,is_exclusive:E,is_public:g,is_discoverable:y,strict:C,is_ephemeral:T,access_code:A,name:O,data:N,custom_type:k,operator_ids:U,message_survival_seconds:D}),r}return j(t,n),t}(Te),OG=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).channel=new Qa(e,r),a.isCreated=(i=r.is_created)===null||i===void 0||i,a}return j(t,n),t}(Me),$1=function(n){function t(e){var r=e.userId,i=e.channelUrls,a=n.call(this)||this;return a.method=Ie.PUT,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/mark_as_read_all"),a.params={channel_urls:i},a}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var kG=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId,s=e.accessCode;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/join"),r.params={user_id:a,access_code:s},r}return j(t,n),t}(Te),DG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Qa(e,r),i}return j(t,n),t}(Me),LG=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this,s=i.data,u=s.member_count,d=u===void 0?0:u,h=s.joined_member_count,p=h===void 0?0:h,g=s.users,E=g===void 0?null:g;return a.memberCount=d,a.joinedMemberCount=p,a.members=Array.isArray(E)?E.map(function(y){return new qa(e,y)}):[new qa(e,i.data)],a}return j(t,n),t}(qu),xG=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId,s=e.shouldRemoveOperatorStatus;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/leave"),r.params={user_id:a,should_remove_operator_status:s},r}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var UG=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this,s=i.data,u=s.member_count,d=u===void 0?0:u,h=s.joined_member_count,p=h===void 0?0:h;return a.memberCount=d,a.joinedMemberCount=p,a.member=new qa(a._iid,i.data),a}return j(t,n),t}(qu),PG=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userIds;return(r=n.call(this)||this).method=Ie.POST,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/invite"),r.params={user_ids:a},r}return j(t,n),t}(Te),FG=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Qa(e,r),i}return j(t,n),t}(Me),HG=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this;a.inviter=null;var s=i.data,u=s.member_count,d=u===void 0?0:u,h=s.joined_member_count,p=h===void 0?0:h,g=s.inviter,E=s.invitees,y=E===void 0?[]:E;return a.memberCount=d,a.joinedMemberCount=p,g&&Object.keys(g).length>0&&(a.inviter=new _t(e,g)),a.invitees=y.map(function(C){return new qa(e,C)}),a}return j(t,n),t}(qu),BG=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/decline"),r.params={user_id:a},r}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Qa(e,r),i.channel.myMemberState=Dr.NONE,i}j(t,n)})(Me);var GG=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this,s=i.data,u=s.member_count,d=s.joined_member_count,h=s.inviter,p=s.invitee;return a.memberCount=u??0,a.joinedMemberCount=d??0,a.inviter=new _t(e,h),a.invitee=new qa(e,p),a}return j(t,n),t}(qu),vy={hidePreviousMessages:!1,allowAutoUnhide:!0},VG=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId,s=e.hidePreviousMessages,u=e.allowAutoUnhide;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/hide"),r.params={user_id:a,hide_previous_messages:s??vy.hidePreviousMessages,allow_auto_unhide:u??vy.allowAutoUnhide},r}return j(t,n),t}(Te),jG=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.ts_message_offset;return i.messageOffsetTimestamp=a,i}return j(t,n),t}(Me),qG=function(n){function t(e,r,i){var a,s,u,d=this;return(d=n.call(this,e,"SYEV",i)||this).allowAutoUnhide=null,d.hidePreviousMessages=null,d.messageOffsetTimestamp=null,i.data&&(d.allowAutoUnhide=(a=i.data.allow_auto_unhide)!==null&&a!==void 0?a:null,d.hidePreviousMessages=(s=i.data.hide_previous_messages)!==null&&s!==void 0?s:null),d.messageOffsetTimestamp=(u=i.ts_message_offset)!==null&&u!==void 0?u:null,d}return j(t,n),t}(dr),zG=function(n){function t(e){var r=e.channelUrl,i=e.time;return n.call(this,{code:"TPST",ackRequired:!1,payload:{channel_url:r,time:i}})||this}return j(t,n),t}(Ai),KG=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new _t(e,i.data),a}return j(t,n),t}(dr),WG=function(n){function t(e){var r=e.channelUrl,i=e.time;return n.call(this,{code:"TPEN",ackRequired:!1,payload:{channel_url:r,time:i}})||this}return j(t,n),t}(Ai),$G=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new _t(e,i.data),a}return j(t,n),t}(dr),YG=function(n){function t(e){var r=e.channelUrl,i=e.messageId;return n.call(this,{code:"MACK",ackRequired:!1,payload:{channel_url:r,msg_id:i}})||this}return j(t,n),t}(Ai),nO=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z,Y=this;return(Y=n.call(this,e,r)||this).includeEmpty=!1,Y.includeFrozen=!0,Y.includeMetaData=!0,Y.includeChatNotification=!1,Y.channelUrlsFilter=null,Y.customTypesFilter=null,Y.customTypeStartsWithFilter=null,Y.nicknameContainsFilter=null,Y.nicknameStartsWithFilter=null,Y.nicknameExactMatchFilter=null,Y.channelNameContainsFilter="",Y.myMemberStateFilter=oa.ALL,Y.unreadChannelFilter=Lo.ALL,Y.superChannelFilter=da.ALL,Y.publicChannelFilter=iu.ALL,Y.hiddenChannelFilter=Ss.UNHIDDEN,Y.searchFilter={fields:[],query:null},Y.userIdsFilter={userIds:[],includeMode:!0,queryType:Pu.AND},Y.metadataKey=null,Y.metadataValues=null,Y.metadataOrderKeyFilter=null,Y.metadataValueStartsWith=null,Y.order=Er.LATEST_LAST_MESSAGE,Y.includeEmpty=(i=r.includeEmpty)!==null&&i!==void 0&&i,Y.includeFrozen=(a=r.includeFrozen)===null||a===void 0||a,Y.includeMetaData=(s=r.includeMetaData)===null||s===void 0||s,Y.includeChatNotification=(u=r.includeChatNotification)!==null&&u!==void 0&&u,Y.channelUrlsFilter=(d=r.channelUrlsFilter)!==null&&d!==void 0?d:null,Y.customTypesFilter=(h=r.customTypesFilter)!==null&&h!==void 0?h:null,Y.customTypeStartsWithFilter=(p=r.customTypeStartsWithFilter)!==null&&p!==void 0?p:"",Y.nicknameContainsFilter=(g=r.nicknameContainsFilter)!==null&&g!==void 0?g:null,Y.nicknameStartsWithFilter=(E=r.nicknameStartsWithFilter)!==null&&E!==void 0?E:null,Y.nicknameExactMatchFilter=(y=r.nicknameExactMatchFilter)!==null&&y!==void 0?y:null,Y.channelNameContainsFilter=(C=r.channelNameContainsFilter)!==null&&C!==void 0?C:"",Y.myMemberStateFilter=(T=r.myMemberStateFilter)!==null&&T!==void 0?T:oa.ALL,Y.unreadChannelFilter=(A=r.unreadChannelFilter)!==null&&A!==void 0?A:Lo.ALL,Y.superChannelFilter=(O=r.superChannelFilter)!==null&&O!==void 0?O:da.ALL,Y.publicChannelFilter=(N=r.publicChannelFilter)!==null&&N!==void 0?N:iu.ALL,Y.hiddenChannelFilter=(k=r.hiddenChannelFilter)!==null&&k!==void 0?k:Ss.UNHIDDEN,Y.searchFilter=(D=r.searchFilter)!==null&&D!==void 0?D:{fields:[],query:null},Y.userIdsFilter=(P=r.userIdsFilter)!==null&&P!==void 0?P:{userIds:[],includeMode:!0,queryType:Pu.AND},Y.metadataKey=(U=r.metadataKey)!==null&&U!==void 0?U:null,Y.metadataValues=(L=r.metadataValues)!==null&&L!==void 0?L:null,Y.metadataOrderKeyFilter=(B=r.metadataOrderKeyFilter)!==null&&B!==void 0?B:null,Y.metadataValueStartsWith=(q=r.metadataValueStartsWith)!==null&&q!==void 0?q:null,Y.order=(z=r.order)!==null&&z!==void 0?z:Er.LATEST_LAST_MESSAGE,r.createdAfter&&(Y.createdAfter=r.createdAfter),r.createdBefore&&(Y.createdBefore=r.createdBefore),Y}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("boolean",this.includeEmpty)&&J("boolean",this.includeFrozen)&&J("boolean",this.includeMetaData)&&J("string",this.channelNameContainsFilter)&&tt("string",this.channelUrlsFilter,!0)&&tt("string",this.customTypesFilter,!0)&&J("string",this.customTypeStartsWithFilter)&&J("string",this.nicknameContainsFilter,!0)&&J("string",this.nicknameStartsWithFilter,!0)&&J("string",this.nicknameExactMatchFilter,!0)&&nt(oa,this.myMemberStateFilter)&&nt(da,this.superChannelFilter)&&nt(iu,this.publicChannelFilter)&&nt(Lo,this.unreadChannelFilter)&&nt(Ss,this.hiddenChannelFilter)&&tt(Ih,this.searchFilter.fields)&&J("string",this.searchFilter.query,!0)&&tt("string",this.userIdsFilter.userIds)&&J("boolean",this.userIdsFilter.includeMode)&&nt(Pu,this.userIdsFilter.queryType)&&nt(Er,this.order)&&J("string",this.metadataOrderKeyFilter,!0)&&J("string",this.metadataKey,!0)&&tt("string",this.metadataValues,!0)&&J("string",this.metadataValueStartsWith,!0)&&MN(this.createdAfter,!0)&&MN(this.createdBefore,!0)},t.prototype.serialize=function(){return Nc(this)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i;return R(this,function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,ai.of(this._iid).getMyGroupChannels(this._token,_n(W({},this)),this.limit,ge.REQUEST_CHANNEL,!0)]):[3,2]:[3,5];case 1:return e=a.sent(),r=e.channels,i=e.token,this._token=i,this._hasNext=!!i,this._isLoading=!1,[2,r];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(Vu),QG=function(n){function t(e){var r=e.channelUrl,i=e.userId,a=n.call(this)||this;return a.method=Ie.PUT,a.path="".concat(qi,"/").concat(encodeURIComponent(r),"/messages/mark_as_delivered"),a.params=ze({user_id:i}),a}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var Ru,ZG=function(n){function t(e,r,i){var a=n.call(this,e,"DLVR",i)||this;return a.channelUrl=i.channel_url,a.deliveredStateUpdate=i.updated,a}return j(t,n),t}(dr),Js=function(){function n(t){var e=t.top,r=e===void 0?Number.MAX_SAFE_INTEGER:e,i=t.bottom,a=i===void 0?0:i;this.top=r,this.bottom=a}return n.prototype.includes=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.every(function(i){return t.top<=i&&i<=t.bottom})},n.prototype.overlap=function(t){return this.includes(t.top)||this.includes(t.bottom)},n.prototype.intersect=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.some(function(i){return t.top<=i&&i<=t.bottom})},n.prototype.extends=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.top=Math.min.apply(Math,Nn([this.top],cn(t),!1)),this.bottom=Math.max.apply(Math,Nn([this.bottom],cn(t),!1))},n}(),Il={},ai=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,W(W({},r),{channelType:vt.GROUP}))||this)._leftChannels=new Map,a._markAsReadAllLastSentAt=0,a._forceDisableMack=(i=r.forceDisableMack)!==null&&i!==void 0&&i,a._groupChannelHandlers=new Map,a._groupChannelCache=new lG(a._iid,{sdkState:r.sdkState,cacheContext:r.cacheContext}),a._groupChannelBroadcast=new pG({dispatcher:r.dispatcher,groupChannelCache:a._groupChannelCache,messageCache:fc.of(a._iid),unsentMessageCache:nd.of(a._iid)}),setInterval(function(){var s,u,d=function(g){g.invalidateTypingStatus()&&(a._dispatcher.dispatch(new pt({channels:[g],context:{source:ge.EVENT_CHANNEL_TYPING_STATUS_UPDATE}})),a._groupChannelHandlers.forEach(function(E){E.onTypingStatusUpdated&&E.onTypingStatusUpdated(g)}))};try{for(var h=Le(a._groupChannelCache.channels),p=h.next();!p.done;p=h.next())d(p.value)}catch(g){s={error:g}}finally{try{p&&!p.done&&(u=h.return)&&u.call(h)}finally{if(s)throw s.error}}},1e3),a._dispatcher.on(function(s){s instanceof dr?a._handleEvent(s).catch(function(u){if(Gi(u)&&a._sdkState.appState==="foreground")throw u}):s instanceof xM?M(a,void 0,void 0,function(){var u,d;return R(this,function(h){switch(h.label){case 0:return u=s.message,[4,this.getChannelFromCache(u.channelUrl)];case 1:return(d=h.sent())&&!d.isFrozen?[3,3]:[4,this.getChannelWithoutCache(u.channelUrl,!0)];case 2:d=h.sent(),h.label=3;case 3:return d.isFrozen||(u instanceof Si?d._autoResendUserMessage(u):u instanceof Wr&&d._autoResendFileMessage(u)),[2]}})}):s instanceof PM?a.reduceDBSize():s instanceof cM&&M(a,void 0,void 0,function(){var u,d,h,p,g,E=this;return R(this,function(y){switch(y.label){case 0:return u=s.channelUrl,d=s.channelType,h=s.parentMessage,p=new LM(this._iid,{channel_type:vt.GROUP,channel_url:u,parent_message_id:h.messageId,thread_info:J_.payloadify(h.threadInfo)}),d!==vt.GROUP?[3,2]:[4,this.getChannel(u,!0)];case 1:g=y.sent(),an(function(){return M(E,void 0,void 0,function(){var C,T,A,O,N;return R(this,function(k){try{for(C=Le(this._groupChannelHandlers.values()),T=C.next();!T.done;T=C.next())(A=T.value).onThreadInfoUpdated&&A.onThreadInfoUpdated(g,p)}catch(D){O={error:D}}finally{try{T&&!T.done&&(N=C.return)&&N.call(C)}finally{if(O)throw O.error}}return[2]})})}),y.label=2;case 2:return[2]}})})}),Il[e]||(Il[e]=a),a}return j(t,n),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return fc.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return nd.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e){return Il[e]||(Il[e]=new t(e,X.of(e))),Il[e]},t.clear=function(e){Il[e]&&delete Il[e]},Object.defineProperty(t.prototype,"handlers",{get:function(){return Nn([],cn(this._groupChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.buildGroupChannelFromSerializedData=function(e){var r=ko(e);return new Qa(this._iid,Qa.payloadify(r))},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){var r=ko(e);return new nO(this._iid,r)},t.prototype.buildMemberFromSerializedData=function(e){var r=ko(e);return new qa(this._iid,qa.payloadify(r))},t.prototype.getChannelFromCache=function(e){var r;return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return[4,this._groupChannelCache.get(e)];case 1:return[2,(r=i.sent())!==null&&r!==void 0?r:null]}})})},t.prototype.getChannelsFromCache=function(e,r,i,a,s){return M(this,void 0,void 0,function(){return R(this,function(u){switch(u.label){case 0:return[4,this._groupChannelCache.fetch({token:e,filter:r,order:i,limit:a,borderlineChannelUrl:s})];case 1:return[2,u.sent()]}})})},t.prototype.upsertChannelsToCache=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._groupChannelCache.upsert(e)];case 1:return[2,r.sent()]}})})},t.prototype.removeChannelsFromCache=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._groupChannelCache.remove(e)];case 1:return r.sent(),[2]}})})},t.prototype.clearChannelsFromCache=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this._groupChannelCache.clear()];case 1:return e.sent(),[2]}})})},t.prototype.reduceDBSize=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p,g,E,y,C,T,A;return R(this,function(O){switch(O.label){case 0:return e=fc.of(this._iid),r=X.of(this._iid).cacheContext,i=r.localCacheConfig,a=r.nestdb,r.localCacheEnabled&&a&&a.state==Ys.OPENED?(s=1024*i.maxSize*1024,[4,a.estimateUsage()]):[2];case 1:if((u=O.sent())<s)return[2];d=[],h=this._groupChannelCache.channels,p={},C=0,O.label=2;case 2:return C<h.length?[4,this.getMessagesFromCache(h[C].url,0,"prev",new Uo)]:[3,5];case 3:g=O.sent(),p[h[C].url]=JSON.stringify(g).length,E=new y5({channel:h[C],cachedMessageCount:g.length}),d.push(E),O.label=4;case 4:return C++,[3,2];case 5:y=d.sort(i.clearOrderComparator),C=0,O.label=6;case 6:return C<y.length?[4,e.removeMessagesOfChannel(y[C].channel.url)]:[3,10];case 7:return O.sent(),[4,e._getGroupChannelPreferenceSize(y[C].channel.url)];case 8:if(T=O.sent(),A=p[y[C].channel.url]+T,(u-=A)<s)return[3,10];O.label=9;case 9:return C++,[3,6];case 10:return[2]}})})},t.prototype._isSuperGroupMackDisabled=function(e){var r=X.of(this._iid).appInfo;return!(!e.isSuper||e.isBroadcast||!(r!=null&&r.disableSuperGroupMack))},t.prototype._handleEvent=function(e){var r,i;return M(this,void 0,void 0,function(){var a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z,Y,Q,$,Z,ne,ue,pe,he,le,we,ve,Ue,be,Qe,Ne,$e,gn,En,Yn,Gn,Tn,kn,Vn,Hn,Jn,jn,On,Ln,An,wn,We,ln,Pe,Ke,yn,tn,st,Cn,Ve,Ut,mt,ut,In,Qn,Ct,Et,ct,Qt,Ot,ft,rt,xn,Oe,Ee,nn,Sn,Pn,lt,qn,Fn,At,Pt,zn,qt,cr,Fe,un,Ae,Dn,pn,it,yt,zt,Ht,Je,oe,ke,fn,bt,dt,nr,rr,Vr,Ir,bn,ot,Tt,ht,Oi,di,Ji,Ds,Ls,fu,ps,hu,pu,ea,jo,fd,Ku,_u,Mc,hd,Oc,mu,qo,pd,zo,Kh,_d,gu,kc,Wh,md,Ko,Wo,$o,Ft=this;return R(this,function(St){switch(St.label){case 0:switch(St.trys.push([0,80,,81]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"READ":return[3,10];case"DLVR":return[3,13];case"MRCT":return[3,15];case"MTHD":return[3,19];case"MCNT":return[3,23];case"PEDI":return[3,32];case"VOTE":return[3,35];case"SYEV":return[3,38];case"USEV":return[3,78]}return[3,79];case 1:return E=null,e.code==="MESG"?E=e.as(cC):e.code==="FILE"?E=e.as(sC):e.code!=="ADMM"&&e.code!="BRDM"||(E=e.as(KM)),E?(a=E.message,s=E.isMentioned,u=E.forceUpdateLastMessage,a.channelType!==vt.GROUP?[3,3]:(ue=this._groupChannelCache.isCachedInMemory(a.channelUrl),z=a instanceof Lr&&a.sender.userId===this._sdkState.userId,[4,this.getChannel(a.channelUrl,!0)])):[3,3];case 2:if(d=St.sent(),h=X.of(this._iid).useMemberInfoInMessage,this._forceDisableMack||this._isSuperGroupMackDisabled(d)||a instanceof Xl||z||Pr(function(){return M(Ft,void 0,void 0,function(){var Ce;return R(this,function(de){switch(de.label){case 0:return Ce=new YG(a),[4,this._requestQueue.send(Ce)];case 1:return de.sent(),[2]}})})}),a instanceof Lr){try{for(p=Le(d.members),g=p.next();!g.done;g=p.next())if((it=g.value).userId===a.sender.userId){h||(a.sender.nickname=it.nickname,a.sender.plainProfileUrl=it.plainProfileUrl,a.sender.metaData=it.metaData,a.sender.isBlockedByMe=it.isBlockedByMe);break}}catch(Ce){zo={error:Ce}}finally{try{g&&!g.done&&(Kh=p.return)&&Kh.call(p)}finally{if(zo)throw zo.error}}!h&&s&&((r=a.mentionedUsers)===null||r===void 0||r.forEach(function(Ce){var de,$n;try{for(var Rn=Le(d.members),Wn=Rn.next();!Wn.done;Wn=Rn.next()){var Tr=Wn.value;if(Ce.userId===Tr.userId){Ce.nickname=Tr.nickname,Ce.plainProfileUrl=Tr.plainProfileUrl,Ce.metaData=Tr.metaData;break}}}catch(Zt){de={error:Zt}}finally{try{Wn&&!Wn.done&&($n=Rn.return)&&$n.call(Rn)}finally{if(de)throw de.error}}})),z&&(N=this._sessionManager.currentUser)&&(N.nickname=a.sender.nickname,N.plainProfileUrl=a.sender.plainProfileUrl,N.metaData=a.sender.metaData)}a.silent&&!z||(d.isEphemeral||ue)&&(d._updateLastMessage(a),z||d._shouldUpdateUnreadCountWith(a)&&d._updateUnreadCount(d.unreadMessageCount+1,d.unreadMentionCount+(s?1:0))),u&&d._updateLastMessage(a),this._dispatcher.dispatch(new pt({channels:[d],context:{source:ge.EVENT_MESSAGE_RECEIVED}})),a.silent&&!z||an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onChannelChanged&&$n.onChannelChanged(d)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),this._dispatcher.dispatch(new mr({messages:[a],source:ge.EVENT_MESSAGE_RECEIVED})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onMessageReceived&&$n.onMessageReceived(d,a),s&&$n.onMentionReceived&&$n.onMentionReceived(d,a)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),St.label=3;case 3:return[3,79];case 4:return E=null,e.code==="MEDI"?E=e.as(nm):e.code==="FEDI"?E=e.as(tm):e.code==="AEDI"&&(E=e.as(WM)),E?(y=E.message,C=E.mentionCountChange,y.threadInfo&&(y.threadInfo.unreadReplyCount=void 0),y.channelType!==vt.GROUP?[3,6]:(ue=this._groupChannelCache.isCachedInMemory(y.channelUrl),[4,this.getChannel(y.channelUrl,!0)])):[3,6];case 5:T=St.sent(),z=y instanceof Lr&&y.sender.userId===this._sdkState.userId,A=!1,z?(O=y.sender,(N=this._sessionManager.currentUser)&&(N.nickname=O.nickname,N.plainProfileUrl=O.plainProfileUrl,N.metaData=O.metaData)):T.isReadMessage(y)||C!==0&&!y.silent&&ue&&(T._updateUnreadCount(T.unreadMessageCount,T.unreadMentionCount+C),A=!0),T._updateLastMessage(y)?A=!0:!((i=T.lastMessage)===null||i===void 0)&&i.isIdentical(y)&&(ue?T._updateLastMessage(y)&&(A=!0):A=!0),k=!1,T.lastPinnedMessage&&T.lastPinnedMessage.messageId===y.messageId&&(T.lastPinnedMessage=y,A=!0,k=!0),A&&(this._dispatcher.dispatch(new pt({channels:[T],context:{source:k?ge.EVENT_PINNED_MESSAGE_UPDATED:ge.EVENT_MESSAGE_UPDATED}})),y.silent&&!z||an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onChannelChanged&&$n.onChannelChanged(T)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),k&&an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onPinnedMessageUpdated&&$n.onPinnedMessageUpdated(T)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})})),this._dispatcher.dispatch(new mr({messages:[y],source:ge.EVENT_MESSAGE_UPDATED})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onMessageUpdated&&$n.onMessageUpdated(T,y),C>0&&$n.onMentionReceived&&$n.onMentionReceived(T,y)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),St.label=6;case 6:return[3,79];case 7:return D=e.as(v2),Ln=D.channelUrl,An=D.channelType,P=D.messageId,U=D.silent,L=D.messageCreatedAt,B=D.senderId,An!==vt.GROUP?[3,9]:[4,this.getChannel(Ln,!0)];case 8:q=St.sent(),z=B===this._sdkState.userId,U||z||L>0&&q.myLastRead<L&&q.unreadMessageCount>0&&q._updateUnreadCount(q.unreadMessageCount-1,0),this._dispatcher.dispatch(new rC({messageIds:[P],source:ge.EVENT_MESSAGE_DELETED})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onMessageDeleted&&$n.onMessageDeleted(q,P)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),St.label=9;case 9:return[3,79];case 10:return(Y=e.as(dM).readStatus).channelType!==vt.GROUP?[3,12]:(ue=this._groupChannelCache.isCachedInMemory(Y.channelUrl),[4,this.getChannel(Y.channelUrl,!0)]);case 11:Q=St.sent(),ue&&Q._updateUnreadMemberState(Y.reader.userId,Y.readAt),Y.reader.userId===this._sdkState.userId?ue?(Q.unreadMessageCount>0||Q.unreadMentionCount>0)&&(Q._updateUnreadCount(0,0),this._dispatcher.dispatch(new pt({channels:[Q],context:{source:ge.EVENT_CHANNEL_READ}})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onChannelChanged&&$n.onChannelChanged(Q)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})})):Q.unreadMessageCount!==0&&Q.unreadMentionCount!==0||(this._dispatcher.dispatch(new pt({channels:[Q],context:{source:ge.EVENT_CHANNEL_READ}})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onChannelChanged&&$n.onChannelChanged(Q)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})})):(this._dispatcher.dispatch(new pt({channels:[Q],context:{source:ge.EVENT_CHANNEL_READ}})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onUnreadMemberStatusUpdated&&$n.onUnreadMemberStatusUpdated(Q)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})})),St.label=12;case 12:return[3,79];case 13:return $=e.as(ZG),Ln=$.channelUrl,Z=$.deliveredStateUpdate,ne=Z===void 0?{}:Z,ue=this._groupChannelCache.isCachedInMemory(Ln),[4,this.getChannel(Ln,!0)];case 14:return pe=St.sent(),ue&&Object.keys(ne).forEach(function(Ce){pe._updateUndeliveredMemberState(Ce,ne[Ce])}),Object.keys(ne).some(function(Ce){return Ce!==Ft._sdkState.userId})&&(this._dispatcher.dispatch(new pt({channels:[pe],context:{source:ge.EVENT_CHANNEL_DELIVERED}})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onUndeliveredMemberStatusUpdated&&$n.onUndeliveredMemberStatusUpdated(pe)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})})),[3,79];case 15:return he=e.as($M),Ln=he.channelUrl,An=he.channelType,le=he.event,An!==vt.GROUP?[3,18]:[4,this.getChannel(Ln,!0)];case 16:return we=St.sent(),[4,this.getMessageFromCache(le.messageId)];case 17:(be=St.sent())?be instanceof Hi&&(be.applyReactionEvent(le),this._dispatcher.dispatch(new mr({messages:[be],source:ge.EVENT_MESSAGE_REACTION_UPDATED}))):this._dispatcher.dispatch(new Q2({event:le,source:ge.EVENT_MESSAGE_REACTION_UPDATED})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onReactionUpdated&&$n.onReactionUpdated(we,le)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),St.label=18;case 18:return[3,79];case 19:return(ve=e.as(YM).event).channelType!==vt.GROUP?[3,22]:[4,this.getChannel(ve.channelUrl,!0)];case 20:return Ue=St.sent(),[4,this.getMessageFromCache(ve.targetMessageId)];case 21:(be=St.sent())?be instanceof Hi&&(be.applyThreadInfoUpdateEvent(ve),this._dispatcher.dispatch(new mr({messages:[be],source:ge.EVENT_MESSAGE_THREADINFO_UPDATED}))):this._dispatcher.dispatch(new Z2({event:ve,source:ge.EVENT_MESSAGE_THREADINFO_UPDATED})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onThreadInfoUpdated&&$n.onThreadInfoUpdated(Ue,ve)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),St.label=22;case 22:return[3,79];case 23:Qe=e.as(QM).groupChannelMemberCounts,Ne=[],St.label=24;case 24:St.trys.push([24,29,30,31]),$e=Le(Qe),gn=$e.next(),St.label=25;case 25:return gn.done?[3,28]:(En=gn.value,Ln=En.channelUrl,qn=En.memberCount,Fn=En.joinedMemberCount,Yn=En.updatedAt,[4,this.getChannelFromCache(Ln)]);case 26:(Gn=St.sent())&&Gn._setLatestMemberCount(qn,Fn,Yn)&&Ne.push(Gn),St.label=27;case 27:return gn=$e.next(),[3,25];case 28:return[3,31];case 29:return Tn=St.sent(),_d={error:Tn},[3,31];case 30:try{gn&&!gn.done&&(gu=$e.return)&&gu.call($e)}finally{if(_d)throw _d.error}return[7];case 31:return Ne.length>0&&(this._dispatcher.dispatch(new pt({channels:Ne,context:{source:ge.EVENT_CHANNEL_MEMBER_COUNT_UPDATED}})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onChannelMemberCountChanged&&$n.onChannelMemberCountChanged(Ne)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})})),[3,79];case 32:return kn=e.as(ZM),Vn=kn.event,Hn=kn.status,Ln=kn.channelUrl,An=kn.channelType,Ln&&An===vt.GROUP?[4,this.getChannel(Ln,!0)]:[3,34];case 33:Jn=St.sent(),this._dispatcher.dispatch(new iC({event:Vn,source:ge.EVENT_POLL_UPDATED})),an(Hn===eM?function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onPollDeleted&&$n.onPollDeleted(Jn,Vn.pollId)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}:function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onPollUpdated&&$n.onPollUpdated(Jn,Vn)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),St.label=34;case 34:return[3,79];case 35:return jn=e.as(fC),On=jn.event,Ln=jn.channelUrl,An=jn.channelType,Ln&&An===vt.GROUP?[4,this.getChannel(Ln,!0)]:[3,37];case 36:wn=St.sent(),this._dispatcher.dispatch(new km({event:On,source:ge.EVENT_POLL_VOTED})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onPollVoted&&$n.onPollVoted(wn,On)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),St.label=37;case 37:return[3,79];case 38:if(!(We=e.as(qu).event).isGroupChannelEvent)return[3,77];switch(We.category){case Wt.CHANNEL_JOIN:return[3,39];case Wt.CHANNEL_LEAVE:return[3,41];case Wt.CHANNEL_OPERATOR_UPDATE:return[3,45];case Wt.CHANNEL_INVITE:return[3,47];case Wt.CHANNEL_DECLINE_INVITE:return[3,49];case Wt.TYPING_START:case Wt.TYPING_END:return[3,51];case Wt.USER_CHANNEL_MUTE:case Wt.USER_CHANNEL_UNMUTE:return[3,53];case Wt.USER_CHANNEL_BAN:return[3,55];case Wt.USER_CHANNEL_UNBAN:return[3,59];case Wt.CHANNEL_FREEZE:case Wt.CHANNEL_UNFREEZE:return[3,61];case Wt.CHANNEL_HIDE:return[3,63];case Wt.CHANNEL_UNHIDE:return[3,65];case Wt.CHANNEL_DELETED:return[3,67];case Wt.CHANNEL_PROP_CHANGED:return[3,69];case Wt.CHANNEL_META_DATA_CHANGED:return[3,71];case Wt.CHANNEL_META_COUNTERS_CHANGED:return[3,73];case Wt.PINNED_MESSAGE_CHANGED:return[3,75]}return[3,77];case 39:return[4,this.getChannel(We.channelUrl,!0)];case 40:return ln=St.sent(),Pe=e.as(LG),Ke=Pe.memberCount,yn=Pe.joinedMemberCount,tn=Pe.members,st=!1,tn.forEach(function(Ce){ln.isExclusive||ln.isSuper||ln.isBroadcast?st=st||ln._setLatestMemberCount(Ke,yn,We.ts):(Ce.state=Dr.JOINED,ln.addMember(Ce,We.ts),Ft._updateJoinedMemberCount(ln)),Ce.userId===Ft._sdkState.userId&&(ln.myMemberState=Dr.JOINED)}),this._dispatcher.dispatch(new pt({channels:[ln],context:{source:ge.EVENT_CHANNEL_JOINED,users:tn}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){var $n,Rn;try{for(var Wn=Le(tn),Tr=Wn.next();!Tr.done;Tr=Wn.next()){var Zt=Tr.value;de.onUserJoined&&de.onUserJoined(ln,Zt)}}catch(Yo){$n={error:Yo}}finally{try{Tr&&!Tr.done&&(Rn=Wn.return)&&Rn.call(Wn)}finally{if($n)throw $n.error}}ln.isBroadcast&&st&&de.onChannelMemberCountChanged&&de.onChannelMemberCountChanged([ln])}),[2]})})}),[3,77];case 41:return(yt=this._leftChannels.get(We.channelUrl))?(Ve=yt.channel,[3,44]):[3,42];case 42:return[4,this.getChannel(We.channelUrl,!0)];case 43:Ve=St.sent(),St.label=44;case 44:return Cn=Ve,Ut=e.as(UG),qn=Ut.memberCount,Fn=Ut.joinedMemberCount,mt=Ut.member,ut=!1,In=X.of(this._iid).appInfo,Cn.isExclusive||Cn.isSuper||Cn.isBroadcast?ut=Cn._setLatestMemberCount(qn,Fn,We.ts):(In!=null&&In.enabledChannelMemberShipHistory?((Qn=Cn.members.find(function(Ce){return Ce.userId===mt.userId}))&&(Qn.state=Dr.LEFT),Cn.memberCount=qn):Cn.removeMember(mt),this._updateJoinedMemberCount(Cn)),mt.userId===this._sdkState.userId?(Cn.myMemberState=Dr.NONE,Cn.invitedAt=0,Cn.joinedAt=0,Cn._updateUnreadCount(0,0),Cn.isPublic?this._dispatcher.dispatch(new pt({channels:[Cn],context:{source:ge.EVENT_CHANNEL_LEFT,user:mt}})):(this._markAsLeave(Cn),this._dispatcher.dispatch(new Su({channelUrls:[Cn.url],context:{source:ge.EVENT_CHANNEL_LEFT,user:mt}})))):this._dispatcher.dispatch(new pt({channels:[Cn],context:{source:ge.EVENT_CHANNEL_LEFT,user:mt}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onUserLeft&&de.onUserLeft(Cn,mt),Cn.isBroadcast&&ut&&de.onChannelMemberCountChanged&&de.onChannelMemberCountChanged([Cn])}),[2]})})}),[3,77];case 45:return[4,this.getChannel(We.channelUrl,!0)];case 46:Ct=St.sent(),Et=e.as(jM).operators,ct=Et.map(function(Ce){return Ce.userId});try{for(Qt=Le(Ct.members),Ot=Qt.next();!Ot.done;Ot=Qt.next())(it=Ot.value).role=ct.includes(it.userId)?Ka.OPERATOR:Ka.NONE}catch(Ce){kc={error:Ce}}finally{try{Ot&&!Ot.done&&(Wh=Qt.return)&&Wh.call(Qt)}finally{if(kc)throw kc.error}}return Ct.myRole=ct.includes(this._sdkState.userId)?Ka.OPERATOR:Ka.NONE,this._dispatcher.dispatch(new pt({channels:[Ct],context:{source:ge.EVENT_CHANNEL_OPERATOR_UPDATED,operators:Et}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onOperatorUpdated&&de.onOperatorUpdated(Ct,Et)}),[2]})})}),[3,77];case 47:return[4,this.getChannel(We.channelUrl,!0)];case 48:ft=St.sent(),rt=e.as(HG),qn=rt.memberCount,Fn=rt.joinedMemberCount,xn=rt.inviter,(Oe=rt.invitees).forEach(function(Ce){return Ce.state=Dr.INVITED});try{for(Ee=Le(Oe),nn=Ee.next();!nn.done;nn=Ee.next())Sn=nn.value,ft.isExclusive||ft.isSuper||ft.isBroadcast?ft._setLatestMemberCount(qn,Fn,We.ts):ft.addMember(Sn,We.ts),this._sdkState.userId===Sn.userId&&(ft.hiddenState=Ba.UNHIDDEN,ft.myMemberState!==Dr.JOINED&&(ft.myMemberState=Dr.INVITED),ft.invitedAt=We.ts)}catch(Ce){md={error:Ce}}finally{try{nn&&!nn.done&&(Ko=Ee.return)&&Ko.call(Ee)}finally{if(md)throw md.error}}return this._dispatcher.dispatch(new pt({channels:[ft],context:{source:ge.EVENT_CHANNEL_INVITED,inviter:xn,invitees:Oe}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onUserReceivedInvitation&&de.onUserReceivedInvitation(ft,xn,Oe)}),[2]})})}),[3,77];case 49:return[4,this.getChannel(We.channelUrl,!0)];case 50:return Pn=St.sent(),lt=e.as(GG),qn=lt.memberCount,Fn=lt.joinedMemberCount,At=lt.inviter,Pt=lt.invitee,Pn.isExclusive||Pn.isSuper||Pn.isBroadcast?Pn._setLatestMemberCount(qn,Fn,We.ts):Pn.removeMember(Pt),this._sdkState.userId===Pt.userId?(Pn.invitedAt=0,Pn.myMemberState=Dr.NONE,Pn.isPublic?this._dispatcher.dispatch(new pt({channels:[Pn],context:{source:ge.EVENT_CHANNEL_DECLINED_INVITE,inviter:At,invitee:Pt}})):this._dispatcher.dispatch(new Su({channelUrls:[Pn.url],context:{source:ge.EVENT_CHANNEL_DECLINED_INVITE,inviter:At,invitee:Pt}}))):this._dispatcher.dispatch(new pt({channels:[Pn],context:{source:ge.EVENT_CHANNEL_DECLINED_INVITE,inviter:At,invitee:Pt}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onUserDeclinedInvitation&&de.onUserDeclinedInvitation(Pn,At,Pt)}),[2]})})}),[3,77];case 51:return[4,this.getChannel(We.channelUrl,!0)];case 52:return zn=St.sent(),qt=We.category===Wt.TYPING_START,cr=e.as(qt?KG:$G).user,zn._updateTypingStatus(cr,qt?We.ts:0),this._dispatcher.dispatch(new pt({channels:[zn],context:{source:ge.EVENT_CHANNEL_TYPING_STATUS_UPDATE}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onTypingStatusUpdated&&de.onTypingStatusUpdated(zn)}),[2]})})}),[3,77];case 53:return[4,this.getChannel(We.channelUrl,!0)];case 54:Fe=St.sent(),un=We.category===Wt.USER_CHANNEL_MUTE,(Ae=e.as(un?bM:CM).user).userId===this._sdkState.userId&&(Fe.myMutedState=un?Ts.MUTED:Ts.UNMUTED,Fe._myMutedRemainingTime=Ae.restrictionInfo.remainingDuration);try{for(Dn=Le(Fe.members),pn=Dn.next();!pn.done;pn=Dn.next())if((it=pn.value).userId===Ae.userId){it.isMuted=un;break}}catch(Ce){Wo={error:Ce}}finally{try{pn&&!pn.done&&($o=Dn.return)&&$o.call(Dn)}finally{if(Wo)throw Wo.error}}return this._dispatcher.dispatch(new pt({channels:[Fe],context:{source:un?ge.EVENT_CHANNEL_MUTED:ge.EVENT_CHANNEL_UNMUTED,user:Ae}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){un?de.onUserMuted&&de.onUserMuted(Fe,Ae):de.onUserUnmuted&&de.onUserUnmuted(Fe,Ae)}),[2]})})}),[3,77];case 55:return(yt=this._leftChannels.get(We.channelUrl))?(Ht=yt.channel,[3,58]):[3,56];case 56:return[4,this.getChannel(We.channelUrl,!0)];case 57:Ht=St.sent(),St.label=58;case 58:return zt=Ht,this._markAsLeave(zt),Je=e.as(IM).user,Je.userId===this._sdkState.userId&&this._dispatcher.dispatch(new Su({channelUrls:[zt.url],context:{source:ge.EVENT_CHANNEL_BANNED,user:Je}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onUserBanned&&de.onUserBanned(zt,Je)}),[2]})})}),[3,77];case 59:return[4,this.getChannel(We.channelUrl,!0)];case 60:return oe=St.sent(),ke=e.as(TM).user,ke.userId===this._sdkState.userId&&this._dispatcher.dispatch(new Su({channelUrls:[oe.url],context:{source:ge.EVENT_CHANNEL_UNBANNED,user:ke}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onUserUnbanned&&de.onUserUnbanned(oe,ke)}),[2]})})}),[3,77];case 61:return[4,this.getChannel(We.channelUrl,!0)];case 62:return fn=St.sent(),bt=e.as(SM).freeze,fn.isFrozen=bt,this._dispatcher.dispatch(new pt({channels:[fn],context:{source:bt?ge.EVENT_CHANNEL_FROZEN:ge.EVENT_CHANNEL_UNFROZEN}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){bt?de.onChannelFrozen&&de.onChannelFrozen(fn):de.onChannelUnfrozen&&de.onChannelUnfrozen(fn)}),[2]})})}),[3,77];case 63:return[4,this.getChannel(We.channelUrl,!0)];case 64:return dt=St.sent(),nr=e.as(qG),rr=nr.allowAutoUnhide,Vr=nr.hidePreviousMessages,Ir=nr.messageOffsetTimestamp,rr!==null&&(dt.hiddenState=rr?Ba.HIDDEN_ALLOW_AUTO_UNHIDE:Ba.HIDDEN_PREVENT_AUTO_UNHIDE),Vr!==null&&Vr&&dt._updateUnreadCount(0,0),Ir!==null&&(dt.messageOffsetTimestamp=Ir),this._dispatcher.dispatch(new pt({channels:[dt],context:{source:ge.EVENT_CHANNEL_HIDDEN}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onChannelHidden&&de.onChannelHidden(dt)}),[2]})})}),[3,77];case 65:return[4,this.getChannel(We.channelUrl,!0)];case 66:return(bn=St.sent()).hiddenState=Ba.UNHIDDEN,this._dispatcher.dispatch(new pt({channels:[bn],context:{source:ge.EVENT_CHANNEL_UNHIDDEN}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onChannelChanged&&de.onChannelChanged(bn)}),[2]})})}),[3,77];case 67:return[4,this.getChannel(We.channelUrl,!0)];case 68:return ot=St.sent(),this._dispatcher.dispatch(new Su({channelUrls:[We.channelUrl],context:{source:ge.EVENT_CHANNEL_DELETED}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onChannelDeleted&&de.onChannelDeleted(ot.url,ot.channelType)}),[2]})})}),[3,77];case 69:return[4,this.getChannelWithoutCache(We.channelUrl,!0)];case 70:return Tt=St.sent(),this._dispatcher.dispatch(new pt({channels:[Tt],context:{source:ge.EVENT_CHANNEL_UPDATED}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onChannelChanged&&de.onChannelChanged(Tt)}),[2]})})}),[3,77];case 71:return[4,this.getChannel(We.channelUrl,!0)];case 72:return ht=St.sent(),Oi=e.as(EM),di=Oi.created,Ji=Oi.updated,Ds=Oi.deleted,di&&(ht._upsertCachedMetaData(di,We.ts),this._dispatcher.dispatch(new pt({channels:[ht],context:{source:ge.EVENT_CHANNEL_METADATA_CREATED,metaData:di},ts:We.ts}))),Ji&&(ht._upsertCachedMetaData(Ji,We.ts),this._dispatcher.dispatch(new pt({channels:[ht],context:{source:ge.EVENT_CHANNEL_METADATA_UPDATED,metaData:Ji},ts:We.ts}))),Ds&&(ht._removeFromCachedMetaData(Ds,We.ts),this._dispatcher.dispatch(new pt({channels:[ht],context:{source:ge.EVENT_CHANNEL_METADATA_DELETED,metaDataKeys:Ds},ts:We.ts}))),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){di&&de.onMetaDataCreated&&de.onMetaDataCreated(ht,di),Ji&&de.onMetaDataUpdated&&de.onMetaDataUpdated(ht,Ji),Ds&&de.onMetaDataDeleted&&de.onMetaDataDeleted(ht,Ds)}),[2]})})}),[3,77];case 73:return[4,this.getChannel(We.channelUrl,!0)];case 74:return Ls=St.sent(),fu=e.as(yM),ps=fu.created,hu=fu.updated,pu=fu.deleted,ps&&this._dispatcher.dispatch(new pt({channels:[Ls],context:{source:ge.EVENT_CHANNEL_METACOUNTER_CREATED,metaCounters:ps}})),hu&&this._dispatcher.dispatch(new pt({channels:[Ls],context:{source:ge.EVENT_CHANNEL_METACOUNTER_UPDATED,metaCounters:hu}})),pu&&this._dispatcher.dispatch(new pt({channels:[Ls],context:{source:ge.EVENT_CHANNEL_METACOUNTER_DELETED,metaCounterKeys:pu}})),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){ps&&de.onMetaCounterCreated&&de.onMetaCounterCreated(Ls,ps),hu&&de.onMetaCounterUpdated&&de.onMetaCounterUpdated(Ls,hu),pu&&de.onMetaCounterDeleted&&de.onMetaCounterDeleted(Ls,pu)}),[2]})})}),[3,77];case 75:return[4,this.getChannel(We.channelUrl,!0)];case 76:return ea=St.sent(),jo=e.as(qM),fd=jo.pinnedMessageIds,Ku=jo.latestPinnedMessage,(_u=jo.ts)>ea._pinnedMessagesUpdatedAt&&(ea.pinnedMessageIds=fd??[],ea.lastPinnedMessage=Ku,ea._pinnedMessagesUpdatedAt=_u,this._dispatcher.dispatch(new pt({channels:[ea],context:{source:ge.EVENT_PINNED_MESSAGE_UPDATED}})),an(function(){return M(Ft,void 0,void 0,function(){var Ce,de,$n,Rn,Wn;return R(this,function(Tr){try{for(Ce=Le(this._groupChannelHandlers.values()),de=Ce.next();!de.done;de=Ce.next())($n=de.value).onChannelChanged&&$n.onChannelChanged(ea)}catch(Zt){Rn={error:Zt}}finally{try{de&&!de.done&&(Wn=Ce.return)&&Wn.call(Ce)}finally{if(Rn)throw Rn.error}}return[2]})})}),an(function(){return M(Ft,void 0,void 0,function(){return R(this,function(Ce){return this._groupChannelHandlers.forEach(function(de){de.onPinnedMessageUpdated&&de.onPinnedMessageUpdated(ea)}),[2]})})})),[3,77];case 77:return[3,79];case 78:switch((Mc=e.as(FM).event).category){case Ch.USER_BLOCK:hd=am.getDataAsUserBlockEvent(this._iid,Mc),mu=hd.blocker,qo=hd.blockee,this._groupChannelCache.block(mu.userId,qo.userId);break;case Ch.USER_UNBLOCK:Oc=am.getDataAsUserBlockEvent(this._iid,Mc),mu=Oc.blocker,qo=Oc.blockee,this._groupChannelCache.unblock(mu.userId,qo.userId)}return[3,79];case 79:return[3,81];case 80:if(pd=St.sent(),Gi(pd))throw pd;return[3,81];case 81:return[2]}})})},t.prototype._markAsLeave=function(e){var r,i=this,a=(r=this._leftChannels.get(e.url))!==null&&r!==void 0?r:{channel:e,ref:0};a.ref++,this._leftChannels.set(e.url,a),setTimeout(function(){a.ref--,a.ref===0&&i._leftChannels.delete(e.url)},1e4)},t.prototype.addHandler=function(e,r){this._groupChannelHandlers.set(e,r)},t.prototype.removeHandler=function(e){this._groupChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._groupChannelHandlers.clear()},t.prototype.subscribeChannelEvent=function(e,r){this._groupChannelBroadcast.subscribe(e,r)},t.prototype.unsubscribeChannelEvent=function(e){this._groupChannelBroadcast.unsubscribe(e)},t.prototype._updateJoinedMemberCount=function(e){e.joinedMemberCount=e.members.filter(function(r){return r.state===Dr.JOINED}).length},t.prototype.getChannel=function(e,r){return r===void 0&&(r=!1),M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:Se(J("string",e)).throw(ee.invalidParameters),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(i=a.sent())?[2,i]:[3,4];case 3:return a.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,r)];case 5:return[2,a.sent()]}})})},t.prototype.getChannelWithoutCache=function(e,r){return r===void 0&&(r=!1),M(this,void 0,void 0,function(){var i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return Se(J("string",e)).throw(ee.invalidParameters),i=new my({channelUrl:e,isInternalCall:r}),[4,this._requestQueue.send(i)];case 1:switch(a=h.sent(),s=a.as(gy).channel,u=s.unreadMessageCount,d=s.unreadMentionCount,s.myCountPreference){case Ha.UNREAD_MESSAGE_COUNT_ONLY:d=0;break;case Ha.UNREAD_MENTION_COUNT_ONLY:u=0;break;case Ha.OFF:u=0,d=0}return s._updateUnreadCount(u,d),[4,this.upsertChannelsToCache([s])];case 2:return[2,h.sent()[0]]}})})},t.prototype.refreshChannel=function(e,r,i,a){return r===void 0&&(r=!0),i===void 0&&(i=ge.REFRESH_CHANNEL),a===void 0&&(a=!1),M(this,void 0,void 0,function(){var s,u,d,h,p;return R(this,function(g){switch(g.label){case 0:return g.trys.push([0,5,,6]),s=new my({channelUrl:e,isInternalCall:r,showLatestMessage:a}),[4,this._requestQueue.send(s)];case 1:return u=g.sent(),(d=u.as(gy).channel).myMemberState!==Dr.NONE?[3,2]:(this._dispatcher.dispatch(new Su({channelUrls:[d.url],context:{source:i}})),[3,4]);case 2:return[4,this.upsertChannelsToCache([d])];case 3:h=g.sent(),this._dispatcher.dispatch(new pt({channels:h,context:{source:i}})),g.label=4;case 4:return[3,6];case 5:return(p=g.sent()).code!==rn.NON_AUTHORIZED&&p.code!==rn.NOT_FOUND_IN_DATABASE||this._dispatcher.dispatch(new Su({channelUrls:[e],context:{source:i}})),[3,6];case 6:return[2]}})})},t.prototype.getMyGroupChannels=function(e,r,i,a,s){return a===void 0&&(a=ge.REQUEST_CHANNEL),s===void 0&&(s=!1),M(this,void 0,void 0,function(){var u,d,h,p,g,E,y,C,T;return R(this,function(A){switch(A.label){case 0:return r.createdAfter&&(r.createdAfter=Math.floor(r.createdAfter/1e3)),r.createdBefore&&(r.createdBefore=Math.floor(r.createdBefore/1e3)),u=!1,s&&(d=X.of(this._iid),h=d.appInfo,(p=d.cacheContext)&&!p.localCacheEnabled&&(h!=null&&h.enabledChannelMemberShipHistory)&&(h!=null&&h.applicationAttributes.includes("left_user_view_support"))&&(u=!0)),g=new gG(W(W({},r),{userId:this._sdkState.userId,token:e,limit:i,includeLeftChannel:s&&u})),[4,this._requestQueue.send(g)];case 1:return E=A.sent(),y=E.as(vG),C=y.channels,T=y.token,this._dispatcher.dispatch(new pt({channels:C,context:{source:a}})),[2,{channels:C,token:T}]}})})},t.prototype.getMyGroupChannelChangeLogs=function(e,r,i){return i===void 0&&(i=ge.REQUEST_CHANNEL_CHANGELOGS),M(this,void 0,void 0,function(){var a,s,u,d,h,p,g,E;return R(this,function(y){switch(y.label){case 0:return a=W(W({},om),r),Se((J("string",e)||J("number",e))&&_y(a)).throw(ee.invalidParameters),s=new _G(_n({userId:this._sdkState.userId,ts:typeof e=="number"?e:null,token:typeof e=="string"?e:null,filter:a})),[4,this._requestQueue.send(s)];case 1:return u=y.sent(),d=u.as(mG),h=d.updatedChannels,p=d.deletedChannelUrls,g=d.hasMore,E=d.ts,h.length>0&&this._dispatcher.dispatch(new pt({channels:h,context:{source:i},ts:E})),p.length>0&&this._dispatcher.dispatch(new Su({channelUrls:p,context:{source:i}})),[2,{updatedChannels:h,deletedChannelUrls:p,hasMore:g,token:d.token}]}})})},t.prototype.getGroupChannelCount=function(e){return M(this,void 0,void 0,function(){var r,i,a;return R(this,function(s){switch(s.label){case 0:return r=W(W({},JM),e),Se(eO(r)).throw(ee.invalidParameters),i=new EG({userId:this._sdkState.userId,filter:r}),[4,this._requestQueue.send(i)];case 1:return a=s.sent(),[2,a.as(yG).groupChannelCount]}})})},t.prototype.getUnreadItemCount=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N;return R(this,function(k){switch(k.label){case 0:return r=W(W({},dG),e),Se(function(D){return tt(br,D.keys)&&tt("string",D.customTypeFilters,!0)&&tt("string",D.customTypesFilter,!0)}(r)).throw(ee.invalidParameters),i=X.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new bG({userId:a.userId,filter:r}),[4,s.send(u)];case 1:return d=k.sent(),h=d.as(CG),p=h.groupChannelUnreadMentionCount,g=h.groupChannelUnreadMessageCount,E=h.groupChannelInvitationCount,y=h.superGroupChannelUnreadMentionCount,C=h.superGroupChannelUnreadMessageCount,T=h.superGroupChannelInvitationCount,A=h.nonSuperGroupChannelUnreadMentionCount,O=h.nonSuperGroupChannelUnreadMessageCount,N=h.nonSuperGroupChannelInvitationCount,[2,ze({groupChannelUnreadMentionCount:p,groupChannelUnreadMessageCount:g,groupChannelInvitationCount:E,superGroupChannelUnreadMentionCount:y,superGroupChannelUnreadMessageCount:C,superGroupChannelInvitationCount:T,nonSuperGroupChannelUnreadMentionCount:A,nonSuperGroupChannelUnreadMessageCount:O,nonSuperGroupChannelInvitationCount:N})]}})})},t.prototype.getTotalUnreadChannelCount=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new IG({userId:r.userId}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(TG).unreadCount]}})})},t.prototype.getTotalUnreadMessageCount=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return r=W(W({},cG),e),Se(fG(r)).throw(ee.invalidParameters),i=X.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new SG({userId:a.userId,filter:r}),[4,s.send(u)];case 1:return d=h.sent(),[2,d.as(NG).unreadCount]}})})},t.prototype.getTotalScheduledMessageCount=function(e){return e===void 0&&(e={}),M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return r=W(W({},hG),e),Se(function(d){return J("string",d.channelUrl,!0)&&tt(To,d.scheduledStatus,!0)&&nt(Ni,d.messageTypeFilter)}(r)).throw(ee.invalidParameters),i=X.of(this._iid).requestQueue,a=new AG(r),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(wG).count]}})})},t.prototype.getSubscribedTotalUnreadMessageCount=function(){var e=X.of(this._iid).subscribedUnreadMessageCount;return e.all>=0?e.all:0},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){var e=0,r=X.of(this._iid).subscribedUnreadMessageCount;return Object.keys(r.customTypes).forEach(function(i){e+=r.customTypes[i]}),e},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){var r;return(r=X.of(this._iid).subscribedUnreadMessageCount.customTypes[e])!==null&&r!==void 0?r:0},t.prototype.createChannel=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return r=W(W({},w_),e),Se(py(r)).throw(ee.invalidParameters),r.isPublic||(r.accessCode=void 0),i=new MG(W({userId:this._sdkState.userId},r)),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),s=a.as(OG).channel,[4,this.upsertChannelsToCache([s])];case 2:return u.sent(),[2,s]}})})},t.prototype.markAsReadAll=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return e=Date.now(),Se(e-this._markAsReadAllLastSentAt>=1e3).throw(ee.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=e,r=new $1({userId:this._sdkState.userId}),[4,this._requestQueue.send(r)];case 1:p.sent(),i=this._groupChannelCache.channels;try{for(a=Le(i),s=a.next();!s.done;s=a.next())(u=s.value)._updateUnreadMemberState(this._sdkState.userId,e),u._updateUnreadCount(0,0)}catch(g){d={error:g}}finally{try{s&&!s.done&&(h=a.return)&&h.call(a)}finally{if(d)throw d.error}}return i.length>0?[4,this.upsertChannelsToCache(i)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[2]}})})},t.prototype.markAsReadWithChannelUrls=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g;return R(this,function(E){switch(E.label){case 0:return r=Date.now(),Se(tt("string",e)&&r-this._markAsReadAllLastSentAt>=1e3).throw(ee.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=r,i=new $1({userId:this._sdkState.userId,channelUrls:e}),[4,this._requestQueue.send(i)];case 1:E.sent(),a=this._groupChannelCache.channels,s=[];try{for(u=Le(a),d=u.next();!d.done;d=u.next())h=d.value,e.includes(h.url)&&(h._updateUnreadMemberState(this._sdkState.userId,r),h._updateUnreadCount(0,0),s.push(h))}catch(y){p={error:y}}finally{try{d&&!d.done&&(g=u.return)&&g.call(u)}finally{if(p)throw p.error}}return s.length>0?[4,this.upsertChannelsToCache(s)]:[3,3];case 2:E.sent(),E.label=3;case 3:return[2]}})})},t.prototype.markAsDelivered=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this.getChannel(e)];case 1:return[4,r.sent().markAsDelivered()];case 2:return r.sent(),[2]}})})},t.prototype.getMessageFromCache=function(e){var r;return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return[4,this._messageCache.get(e)];case 1:return[2,(r=i.sent())!==null&&r!==void 0?r:null]}})})},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,r,i){return M(this,void 0,void 0,function(){return R(this,function(a){switch(a.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:r,filter:i,exactMatch:!0})];case 1:return[2,a.sent()]}})})},t.prototype.getMessagesFromCache=function(e,r,i,a,s,u){return s===void 0&&(s=RM),u===void 0&&(u=!0),M(this,void 0,void 0,function(){return R(this,function(d){switch(d.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:r,limit:s,filter:a,backward:i==="next",inclusive:u})];case 1:return[2,d.sent()]}})})},t.prototype.getPollMessagesFromCache=function(e,r,i,a){return M(this,void 0,void 0,function(){return R(this,function(s){switch(s.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:r,limit:a,filter:i,backward:!1,isPollOnly:!0})];case 1:return[2,s.sent()]}})})},t.prototype.getCachedMessageCountBetween=function(e,r,i,a){return M(this,void 0,void 0,function(){return R(this,function(s){switch(s.label){case 0:return[4,this._messageCache.countBetween(e,r,new Js({top:i,bottom:a}))];case 1:return[2,s.sent()]}})})},t.prototype.getUnsentMessagesFromCache=function(e,r){return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return[4,this._unsentMessageCache.fetch({channelUrl:e,filter:r})];case 1:return[2,i.sent()]}})})},t.prototype.removeFailedMessageFromCache=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._unsentMessageCache.remove([e])];case 1:return r.sent(),[2]}})})},t}(zM),xa=function(n,t){return t instanceof Lr?n.findIndex(function(e){return e instanceof Lr&&t.isIdentical(e)}):n.findIndex(function(e){return e.isIdentical(t)})},wf=function(n,t){return n.findIndex(function(e){return e instanceof Hi?e.messageId===t:e instanceof Jl?e.notificationId===t:void 0})},bE=function(n,t){if(n.length>0){for(var e=0,r=n.length-1,i=Math.floor((e+r)/2);e<r;){var a=n[i].createdAt-t.createdAt;if(a>0)r=i,i=Math.floor((e+r)/2);else{if(!(a<0))return i;e=i+1,i=Math.floor((e+r)/2)}}return n[i].createdAt>t.createdAt?i:i+1}return n.length};(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.END=2]="END"})(Ru||(Ru={}));var Ey,Po=function(n){function t(e,r,i,a){var s=n.call(this)||this;return s._state=Ru.IDLE,s._retryCount=0,s._retryLimit=3,s.priority=0,s._worker=r,s}return j(t,n),Object.defineProperty(t.prototype,"isIdle",{get:function(){return this._state===Ru.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._state===Ru.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDone",{get:function(){return this._state===Ru.END},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),t.prototype._run=function(e){return M(this,void 0,void 0,function(){var r,i;return R(this,function(a){switch(a.label){case 0:if(!this.isRunning)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._worker(e)];case 2:return r=a.sent(),this._retryCount=0,this.dispatch("progress",r),r.hasNext?this._run(r.nextToken):this.end(),[3,4];case 3:return i=a.sent(),this.dispatch("error",i),this._retryCount<this._retryLimit?(this._retryCount++,this._run(e)):this.stop(),[3,4];case 4:return[2]}})})},t.prototype.start=function(e){this.isIdle&&(this._state=Ru.RUNNING,this._run(e))},t.prototype.stop=function(){this._state=Ru.IDLE,this.dispatch("stop")},t.prototype.end=function(){this._state=Ru.END,this.dispatch("end")},t}(rd),vs={},XG=function(){function n(t){var e=t._iid,r=t.channel,i=t.limit,a=i===void 0?100:i,s=this;this.ref=0,this._iid=e,this._channel=r,this._limit=a,this._prevSyncLoopCount=0;var u,d,h=X.of(this._iid),p=h.sdkState,g=h.cacheContext,E=h.dispatcher,y=h.logger,C=h.statManager,T=h.messageBackgroundSyncThrottleController;this._metadataKey=(u=p.userId,d=r.url,"sendbird:".concat(u,"@groupchannel/").concat(d,"/message/sync.meta"));var A=function(O,N){return"sendbird:".concat(O,"@groupchannel/").concat(N,"/message/sync")}(p.userId,r.url);this._prevSync=new Po(A,function(O){return M(s,void 0,void 0,function(){var N=this;return R(this,function(k){switch(k.label){case 0:return[4,T.run("message-background-sync-".concat(r.url,"-prev"),function(){return M(N,void 0,void 0,function(){var D,P,U,L,B,q,z,Y,Q,$,Z,ne;return R(this,function(ue){switch(ue.label){case 0:return D={hasNext:!0,nextToken:0},this._prevSyncLoopCount++,[4,this.loadMetadata()];case 1:if(ue.sent(),y.debug("message background prev sync from",(q=this._metadata)===null||q===void 0?void 0:q.range.top),(z=this._metadata)===null||z===void 0?void 0:z.previousComplete)return[3,10];ue.label=2;case 2:return ue.trys.push([2,5,8,9]),[4,ni.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,!((Q=(Y=this._metadata)===null||Y===void 0?void 0:Y.range)===null||Q===void 0)&&Q.top?this._metadata.range.top:O,{prevResultSize:this._limit,nextResultSize:0,replyType:ti.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0,isInclusive:!0},ge.SYNC_MESSAGE_BACKGROUND)];case 3:return(P=ue.sent()).length>0&&(U=P.map(function(pe){return pe.createdAt}),!(($=this._metadata)===null||$===void 0)&&(B=$.range).intersect.apply(B,Nn([],cn(U),!1))?this.extendRange(P):this._metadata={range:new Js({top:Math.min.apply(Math,Nn([],cn(U),!1)),bottom:Math.max.apply(Math,Nn([],cn(U),!1))}),previousComplete:!1}),D.hasNext=P.length>=this._limit&&this._prevSyncLoopCount<1,this._metadata&&(D.nextToken=this._metadata.range.top,this._metadata.previousComplete=P.length<this._limit),y.debug("message background prev sync progress",D),[4,this.saveMetadata()];case 4:return ue.sent(),[3,9];case 5:return L=ue.sent(),y.debug("message background prev sync error",L),L instanceof ee&&L.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:ue.sent(),ue.label=7;case 7:throw L;case 8:return C.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:r.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:(ne=(Z=g.localCacheConfig)===null||Z===void 0?void 0:Z.maxSize)!==null&&ne!==void 0?ne:0,use_local_cache:g.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 9:return[3,11];case 10:D.hasNext=!1,ue.label=11;case 11:return[2,D]}})})})];case 1:return[2,k.sent()]}})})}),this._nextSync=new Po(A,function(O){return M(s,void 0,void 0,function(){var N=this;return R(this,function(k){switch(k.label){case 0:return[4,T.run("message-background-sync-".concat(r.url,"-next"),function(){return M(N,void 0,void 0,function(){var D,P,U,L,B,q,z,Y,Q,$,Z;return R(this,function(ne){switch(ne.label){case 0:return D={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:ne.sent(),y.debug("message background next sync from",(q=this._metadata)===null||q===void 0?void 0:q.range.bottom),ne.label=2;case 2:return ne.trys.push([2,5,6,7]),[4,ni.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,!((Y=(z=this._metadata)===null||z===void 0?void 0:z.range)===null||Y===void 0)&&Y.bottom?this._metadata.range.bottom:O,{prevResultSize:0,nextResultSize:this._limit,replyType:ti.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0,isInclusive:!0},ge.SYNC_MESSAGE_BACKGROUND)];case 3:return(P=ne.sent()).length>0&&(U=P.map(function(ue){return ue.createdAt}),!((Q=this._metadata)===null||Q===void 0)&&(B=Q.range).intersect.apply(B,Nn([],cn(U),!1))?this.extendRange(P):this._metadata={range:new Js({top:Math.min.apply(Math,Nn([],cn(U),!1)),bottom:Math.max.apply(Math,Nn([],cn(U),!1))}),previousComplete:!1}),D.hasNext=P.length>=this._limit,this._metadata&&(D.nextToken=this._metadata.range.bottom),y.debug("message background next sync progress",D),[4,this.saveMetadata()];case 4:return ne.sent(),[3,7];case 5:throw L=ne.sent(),y.debug("message background next sync error",L),L;case 6:return C.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:r.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:(Z=($=g.localCacheConfig)===null||$===void 0?void 0:$.maxSize)!==null&&Z!==void 0?Z:0,use_local_cache:g.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[2,D]}})})})];case 1:return[2,k.sent()]}})})}),this._connectionEventContext=E.on(function(O){O instanceof Aa&&(O.stateType===Gt.CONNECTED?s.resume():s.pause())})}return n.of=function(t,e){return vs[t]||(vs[t]={}),vs[t][e.url]||(vs[t][e.url]=new n({_iid:t,channel:e})),vs[t][e.url].ref++,vs[t][e.url]},n.clear=function(t,e){vs[t]&&vs[t][e]&&(vs[t][e].close(),delete vs[t])},Object.defineProperty(n.prototype,"range",{get:function(){var t,e;return(e=(t=this._metadata)===null||t===void 0?void 0:t.range)!==null&&e!==void 0?e:new Js({})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"previousComplete",{get:function(){var t;return!!(!((t=this._metadata)===null||t===void 0)&&t.previousComplete)},enumerable:!1,configurable:!0}),n.prototype.isWrappingMessages=function(t){var e;return(e=this.range)===null||e===void 0?void 0:e.includes.apply(e,Nn([],cn(t.map(function(r){return r.createdAt})),!1))},n.prototype.extendRange=function(t){var e;this._metadata&&(e=this._metadata.range).extends.apply(e,Nn([],cn(t.map(function(r){return r.createdAt})),!1))},n.prototype.loadMetadata=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return this._metadata?[3,2]:[4,X.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:t=e.sent(),this._metadata=t?{range:new Js(t.range),previousComplete:t.previousComplete}:{range:new Js({}),previousComplete:!1},e.label=2;case 2:return[2,this._metadata]}})})},n.prototype.saveMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return this._metadata?[4,X.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype.clearMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,X.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.resume=function(t){var e,r,i,a;t===void 0&&(t=Date.now());var s=X.of(this._iid),u=s.logger,d=s.sessionManager;s.cacheContext.localCacheEnabled&&d.session.hasSession&&(u.debug("message background sync resume()"),this._prevSyncLoopCount=0,this._metadata&&this._metadata.previousComplete||this._prevSync.start((r=(e=this._metadata)===null||e===void 0?void 0:e.range.top)!==null&&r!==void 0?r:t),this._nextSync.start((a=(i=this._metadata)===null||i===void 0?void 0:i.range.bottom)!==null&&a!==void 0?a:t))},n.prototype.pause=function(){X.of(this._iid).logger.debug("message background sync stop()"),this._prevSync.stop(),this._nextSync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete vs[this._iid][this._channel.url])},n}(),Es={},JG=function(){function n(t){var e=t._iid,r=t.channel,i=t.includeParams,a=this;this.ref=0,this._iid=e,this._channel=r,this._includeParams=i;var s,u,d=X.of(this._iid),h=d.logger,p=d.sdkState,g=d.dispatcher;this._metadataKey=(s=p.userId,u=r.url,"sendbird:".concat(s,"@groupchannel/").concat(u,"/message/changelogs.meta"));var E=function(y,C){return"sendbird:".concat(y,"@groupchannel/").concat(C,"/message/changelogs")}(p.userId,this._channel.url);this._sync=new Po(E,function(){return M(a,void 0,void 0,function(){var y,C,T,A,O,N,k,D,P;return R(this,function(U){switch(U.label){case 0:return y={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:U.sent(),h.debug("message changelog sync from",(P=this._metadata)===null||P===void 0?void 0:P.token),U.label=2;case 2:return U.trys.push([2,5,,8]),[4,ni.of(this._iid).getMessageChangelogs(this._channel.url,this._channel.channelType,this._metadata.token,W({replyType:ti.ALL},this._includeParams),ge.SYNC_MESSAGE_CHANGELOGS)];case 3:return C=U.sent(),T=C.updatedMessages,A=C.deletedMessageIds,O=C.hasMore,N=C.token,k=C.forceUseNextToken,y.hasNext=O,y.nextToken=N,T.length>0||A.length>0?this._metadata&&(this._metadata.token=N):k&&this._metadata&&(this._metadata.token=N),h.debug("message changelog sync progress",y),[4,this.saveMetadata()];case 4:return U.sent(),[3,8];case 5:return D=U.sent(),h.debug("message changelog sync error",D),D instanceof ee&&D.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:U.sent(),U.label=7;case 7:throw D;case 8:return[2,y]}})})}),this._connectionEventContext=g.on(function(y){y instanceof Aa&&(y.stateType===Gt.CONNECTED?a.resume():a.pause())})}return n.of=function(t,e,r){return Es[t]||(Es[t]={}),Es[t][e.url]||(Es[t][e.url]=new n({_iid:t,channel:e,includeParams:r})),Es[t][e.url].ref++,Es[t][e.url]},n.clear=function(t,e){Es[t]&&Es[t][e]&&(Es[t][e].close(),delete Es[t])},n.prototype.loadMetadata=function(){return M(this,void 0,void 0,function(){var t,e,r,i;return R(this,function(a){switch(a.label){case 0:return this._metadata?[3,2]:(t=X.of(this._iid),e=t.cacheContext,r=t.firstConnectedAt,[4,e.preference.get(this._metadataKey)]);case 1:i=a.sent(),this._metadata={token:i?i.token:r},a.label=2;case 2:return[2,this._metadata]}})})},n.prototype.saveMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return this._metadata?[4,X.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype.clearMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,X.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.resume=function(){var t=X.of(this._iid),e=t.logger;t.sessionManager.session.hasSession&&(e.debug("message changelog sync resume()"),this._sync.start(0))},n.prototype.pause=function(){X.of(this._iid).logger.debug("message changelog sync pause()"),this._sync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Es[this._iid][this._channel.url])},n}(),Tl={},eV=function(){function n(t){var e=t._iid,r=t.channel,i=t.hasPollMessage,a=this;this.ref=0,this._iid=e,this._channel=r;var s,u,d=X.of(this._iid),h=d.logger,p=d.sdkState,g=d.dispatcher;this._metadataKey=(s=p.userId,u=r.url,"sendbird:".concat(s,"@groupchannel/").concat(u,"/poll/changelogs.meta"));var E=function(y,C){return"sendbird:".concat(y,"@groupchannel/").concat(C,"/poll/changelogs")}(p.userId,this._channel.url);this._sync=new Po(E,function(){return M(a,void 0,void 0,function(){var y,C,T,A,O,N,k,D;return R(this,function(P){switch(P.label){case 0:return y={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:return P.sent(),h.debug("poll changelog sync from",(D=this._metadata)===null||D===void 0?void 0:D.token),(C=!this._metadata||!this._metadata.token)?[4,i()]:[3,3];case 2:C=!P.sent(),P.label=3;case 3:if(C)return[2,{hasNext:!1,nextToken:0}];this._metadata||(T=X.of(this._iid).firstConnectedAt,this._metadata={token:T}),P.label=4;case 4:return P.trys.push([4,7,,10]),[4,Q_.of(this._iid).getPollChangeLogs(this._channel.url,this._channel.channelType,this._metadata.token)];case 5:return A=P.sent(),O=A.hasMore,N=A.token,y.hasNext=O,y.nextToken=N,this._metadata.token=N,h.debug("poll changelog sync progress",y),[4,this.saveMetadata()];case 6:return P.sent(),[3,10];case 7:return k=P.sent(),h.debug("poll changelog sync error",k),k instanceof ee&&k.isInvalidTokenError?[4,this.clearMetadata()]:[3,9];case 8:P.sent(),P.label=9;case 9:throw k;case 10:return[2,y]}})})}),this._connectionEventContext=g.on(function(y){y instanceof Aa&&(y.stateType===Gt.CONNECTED?a.resume():a.pause())})}return n.of=function(t,e,r){return Tl[t]||(Tl[t]={}),Tl[t][e.url]||(Tl[t][e.url]=new n({_iid:t,channel:e,hasPollMessage:r})),Tl[t][e.url].ref++,Tl[t][e.url]},n.prototype.loadMetadata=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return this._metadata?[3,2]:[4,X.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:t=e.sent(),this._metadata=t?{token:t.token}:void 0,e.label=2;case 2:return[2]}})})},n.prototype.saveMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return this._metadata?[4,X.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},n.prototype.clearMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,X.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.resume=function(){X.of(this._iid).logger.debug("poll changelog sync resume()"),this._sync.start(0)},n.prototype.pause=function(){X.of(this._iid).logger.debug("poll changelog sync pause()"),this._sync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Tl[this._iid][this._channel.url])},n}(),nV=function(n){function t(e){var r,i,a,s,u,d,h,p,g,E,y=this;return(y=n.call(this)||this).method=Ie.GET,y.path="".concat(Lt(e.channelType),"/").concat(e.channelUrl,"/messages_gap"),y.params=ze({prev_start_ts:e.prevStart,prev_end_ts:e.prevEnd,prev_cache_count:e.prevCount,next_start_ts:e.nextStart,next_end_ts:e.nextEnd,next_cache_count:e.nextCount,huge_gap_threshold:(r=e.threshold)!==null&&r!==void 0?r:null,reverse:!0,custom_types:(i=e.customTypes)!==null&&i!==void 0?i:["*"],message_type:(a=e.messageType)!==null&&a!==void 0?a:null,include_reply_type:(s=e.replyType)!==null&&s!==void 0?s:ti.NONE,include_reactions_summary:(u=e.includeReactions)===null||u===void 0||u,include_meta_array:(d=e.includeMetaArray)===null||d===void 0||d,include_thread_info:(h=e.includeThreadInfo)===null||h===void 0||h,include_parent_message_info:(p=e.includeParentMessageInfo)===null||p===void 0||p,with_sorted_meta_array:(g=e.includeMetaArray)===null||g===void 0||g,show_subchannel_messages_only:(E=e.showSubchannelMessagesOnly)!==null&&E!==void 0&&E,include_poll_details:!0,checking_continuous_messages:e.checkingContinuousMessages}),y}return j(t,n),t}(Te),tV=function(n){function t(e,r){var i,a,s,u,d,h,p=this;return(p=n.call(this,e,r)||this).isHugeGap=r.is_huge_gap,p.prevMessages=((i=r.prev_messages)!==null&&i!==void 0?i:[]).map(function(g){return Ri(e,g)}),p.prevHasMore=(a=r.prev_hasmore)!==null&&a!==void 0&&a,p.isContinuousPrevMessages=(s=r.is_continuous_prev_messages)!==null&&s!==void 0&&s,p.nextMessages=((u=r.next_messages)!==null&&u!==void 0?u:[]).map(function(g){return Ri(e,g)}),p.nextHasmore=(d=r.next_hasmore)!==null&&d!==void 0&&d,p.isContinuousNextMessages=(h=r.is_continuous_next_messages)!==null&&h!==void 0&&h,p}return j(t,n),t}(Me),Y1={includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeParentMessageInfo:!0};(function(n){n.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api"})(Ey||(Ey={}));var fh,hh,ph,rV=function(){function n(){this._onCacheResult=Kn,this._onApiResult=Kn}return n.prototype._invokeResponse=function(t,e,r){var i=this;an(function(){return M(i,void 0,void 0,function(){return R(this,function(a){switch(t){case"local":this._onCacheResult(e,r);break;case"remote":this._onApiResult(e,r)}return[2]})})})},n.prototype.onCacheResult=function(t){return this._onCacheResult=t,this},n.prototype.onApiResult=function(t){return this._onApiResult=t,this},n}(),iV=function(){function n(t,e){var r=e.filter,i=e.startingPoint,a=e.limit,s=e.prevResultLimit,u=e.nextResultLimit,d=e.channel,h=e.channelManager,p=e.disableBackgroundSync,g=p!==void 0&&p,E=this;this._messages=[],this._unsentMessages=[],this._isLoadingPrevious=!1,this._isLoadingNext=!1,this._iid=t,this._key="mc-".concat(Bu()),this._isDisposed=!1,this.filter=r??new Uo,this._channel=d,this._syncRange=new Js({}),this._hasPrevious=!0,this._hasNext=!0,this._startingPoint=typeof i=="number"&&Number.isFinite(i)?i:Number.MAX_SAFE_INTEGER,this._limit=a||RM,this._prevResultLimit=s??Math.floor(this._limit/2),this._nextResultLimit=u??Math.floor(this._limit/2),this._channelManager=h;var y=X.of(this._iid).statManager;this._channelManager.subscribeChannelEvent(this._key,{onUpdate:function(N,k){var D=k.source,P=N.findIndex(function(U){return U.isIdentical(E.channel)});P>=0&&(E._replaceChannelOfCollection(N[P]),E.channel._runIfHandleableWithGroupChannel(function(U){switch(D){case ge.EVENT_CHANNEL_UPDATED:for(var L=!1,B=0;B<E._messages.length;B++)if(E._messages[B].createdAt>=U.messageOffsetTimestamp){L=!0;var q=B;if(q>0){var z=E._messages.splice(0,q);E._removeMessagesFromView(z.map(function($){return E.keyOf($)}),ge.EVENT_MESSAGE_OFFSET_UPDATED)}break}!L&&E._messages.length>0&&E._removeMessagesFromView(E._messages.map(function($){return E.keyOf($)}),ge.EVENT_MESSAGE_OFFSET_UPDATED);break;case ge.EVENT_CHANNEL_UNMUTED:var Y=X.of(E._iid).sdkState,Q=k.user;Y.userId===Q.userId&&E._clearCheckMyMutedTimer();break;case ge.EVENT_CHANNEL_MUTED:Y=X.of(E._iid).sdkState,Q=k.user,Y.userId===Q.userId&&U._myMutedRemainingTime!==-1&&E._startCheckMyMutedTimer(U._myMutedRemainingTime);break;case ge.EVENT_CHANNEL_LEFT:U.isPublic&&E._clearCheckMyMutedTimer()}an(function(){return M(E,void 0,void 0,function(){var $;return R(this,function(Z){return R_(D)&&(!(($=this._handler)===null||$===void 0)&&$.onChannelUpdated)&&this._handler.onChannelUpdated(k,this.channel),[2]})})})}),E._postprocessChannelUpdateEvent(N[P],D))},onRemove:function(N,k){var D=N.indexOf(E.channel.url);D>=0&&E._channel._runIfHandleableWithGroupChannel(function(P){P.myMemberState=Dr.NONE,E._clearCheckMyMutedTimer(),an(function(){return M(E,void 0,void 0,function(){var U;return R(this,function(L){return!((U=this._handler)===null||U===void 0)&&U.onChannelDeleted&&this._handler.onChannelDeleted(k,this.channel.url),[2]})})}),E._postprocessChannelRemoveEvent(N[D])})}}),this._channelManager.subscribeMessageEvent(this._key,{onUpdate:function(N,k){var D,P,U=[],L=[];try{for(var B=Le(N),q=B.next();!q.done;q=B.next()){var z=q.value;z.channelUrl===E._channel.url&&(E.filter.match(z)?U.push(z):L.push(E.keyOf(z)))}}catch(Y){D={error:Y}}finally{try{q&&!q.done&&(P=B.return)&&P.call(B)}finally{if(D)throw D.error}}if(wu(k)){if(U.length>0)switch(k){case ge.LOCAL_MESSAGE_CANCELED:case ge.LOCAL_MESSAGE_RESEND_STARTED:case ge.EVENT_MESSAGE_SENT_FAILED:case ge.EVENT_MESSAGE_SENT_SUCCESS:case ge.EVENT_MESSAGE_UPDATED:case ge.EVENT_MESSAGE_THREADINFO_UPDATED:case ge.EVENT_MESSAGE_REACTION_UPDATED:case ge.EVENT_MESSAGE_FEEDBACK_ADDED:case ge.EVENT_MESSAGE_FEEDBACK_UPDATED:case ge.EVENT_MESSAGE_FEEDBACK_DELETED:case ge.SYNC_MESSAGE_CHANGELOGS:E._updateMessagesToView(U,k);break;case ge.EVENT_MESSAGE_SENT_PENDING:E._addMessagesToView(U,k);break;case ge.EVENT_MESSAGE_RECEIVED:E.hasNext||E._addMessagesToView(U,k);break;case ge.SYNC_MESSAGE_FILL:E._addMessagesToView(U,k)}L.length>0&&E._removeMessagesFromView(L,k)}E._postprocessMessageUpdateEvent(N,k)},onRemove:function(N,k){E._removeMessagesFromView(N,k),E._postprocessMessageRemoveEvent(N)},onRemoveUnsent:function(N,k){E._removeUnsentMessageFromView(N,k)},onPollChangeLogUpdate:function(N,k){E._updatePollsToView(N,k)},onPollUpdate:function(N,k){E._applyPollUpdateEventToView(N,k)},onPollVote:function(N,k){E._applyPollVoteEventToView(N,k)},onReactionUpdate:function(N,k){E._applyReactionEventToView(N,k)},onThreadInfoUpdate:function(N,k){E._applyThreadInfoEventToView(N,k)}});var C=X.of(this._iid),T=C.cacheContext,A=C.dispatcher,O=C.messageBackgroundSyncThrottleController;this._channel._updateMessageCollectionLastAccessedAt(),A.dispatch(new pt({channels:[this._channel],context:{source:ge.CHANNEL_LASTACCESSEDAT_UPDATED}})),this._backgroundSync=XG.of(this._iid,this._channel),!g&&this._shouldStartBackgroundSync()&&this._backgroundSync.resume(this._startingPoint),this._changelogSync=JG.of(this._iid,this._channel,this.changelogIncludeParams),this._changelogSync.resume(),this._pollChangelogSync=eV.of(this._iid,this._channel,this._hasPollMessage.bind(this)),this._pollChangelogSync.resume(),this._prevFill=new Po(this._key,function(N){return M(E,void 0,void 0,function(){var k=this;return R(this,function(D){switch(D.label){case 0:return[4,O.run("message-fill-sync-".concat(d.url,"-prev"),function(){return M(k,void 0,void 0,function(){var P,U,L,B,q,z,Y;return R(this,function(Q){switch(Q.label){case 0:return[4,this._getRemoteMessages(N,{prevLimit:this._prevResultLimit,source:ge.SYNC_MESSAGE_FILL,checkingContinuousMessages:T.localCacheEnabled})];case 1:return P=Q.sent(),U=P.messages,L=P.isContinuousMessages,U.length>0?(B=Math.min.apply(Math,Nn([],cn(U.map(function($){return $.createdAt})),!1)),this._syncRange.extends(B),L&&((q=this._backgroundSync)===null||q===void 0||q.range.extends(B)),[2,{hasNext:U.length>=this._prevResultLimit&&this.viewTop<B,nextToken:this._syncRange.top}]):(T.localCacheEnabled&&y.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(Y=(z=T.localCacheConfig)===null||z===void 0?void 0:z.maxSize)!==null&&Y!==void 0?Y:0,use_local_cache:T.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}})})})];case 1:return[2,D.sent()]}})})}),this._nextFill=new Po(this._key,function(N){return M(E,void 0,void 0,function(){var k=this;return R(this,function(D){switch(D.label){case 0:return[4,O.run("message-fill-sync-".concat(d.url,"-next"),function(){return M(k,void 0,void 0,function(){var P,U,L,B,q,z,Y,Q;return R(this,function($){switch($.label){case 0:return[4,this._getRemoteMessages(N,{nextLimit:this._nextResultLimit,source:ge.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:T.localCacheEnabled})];case 1:return P=$.sent(),U=P.messages,L=P.isContinuousMessages,B=P.hasNext,U.length>0?(q=Math.max.apply(Math,Nn([],cn(U.map(function(Z){return Z.createdAt})),!1)),this._syncRange.extends(q),L&&((z=this._backgroundSync)===null||z===void 0||z.range.extends(q)),[2,{hasNext:B,nextToken:this._syncRange.bottom}]):(T.localCacheEnabled&&y.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(Q=(Y=T.localCacheConfig)===null||Y===void 0?void 0:Y.maxSize)!==null&&Q!==void 0?Q:0,use_local_cache:T.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}})})})];case 1:return[2,D.sent()]}})})}),this._connectionEventContext=A.on(function(N){if(N instanceof Aa)switch(N.stateType){case Gt.CONNECTED:Pr(function(){return M(E,void 0,void 0,function(){return R(this,function(k){return this._activate(),[2]})})});break;case Gt.LOGOUT:E.dispose();break;default:E._clearCheckMyMutedTimer(),E._prevFill.stop(),E._nextFill.stop()}})}return n.prototype.keyOf=function(t){return 0},Object.defineProperty(n.prototype,"changelogIncludeParams",{get:function(){return{includeReactions:!0,includeThreadInfo:!0,includeMetaArray:!0,includeParentMessageInfo:!0}},enumerable:!1,configurable:!0}),n.prototype._postprocessChannelUpdateEvent=function(t,e){},n.prototype._postprocessChannelRemoveEvent=function(t){},n.prototype._postprocessMessageUpdateEvent=function(t,e){},n.prototype._postprocessMessageRemoveEvent=function(t){},Object.defineProperty(n.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"succeededMessages",{get:function(){return Nn([],cn(this._messages),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"failedMessages",{get:function(){return this._unsentMessages.filter(function(t){return t.sendingStatus===jt.FAILED})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pendingMessages",{get:function(){return this._unsentMessages.filter(function(t){return t.sendingStatus===jt.PENDING})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewTop",{get:function(){return Math.min.apply(Math,Nn(Nn([],cn(this._messages.map(function(t){return t.createdAt})),!1),[Number.MAX_SAFE_INTEGER],!1))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewBottom",{get:function(){return Math.max.apply(Math,Nn(Nn([],cn(this._messages.map(function(t){return t.createdAt})),!1),[0],!1))},enumerable:!1,configurable:!0}),n.prototype._activate=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return X.of(this._iid).logger.debug("check huge gap"),this._checkHugeGap(),[4,this._refreshChannel(ge.SYNC_CHANNEL_CHANGELOGS)];case 1:return t.sent(),[2]}})})},n.prototype._replaceChannelOfCollection=function(t){this._channel.isGroupChannel()?this._channel=t:this._channel.isFeedChannel()&&(this._channel._groupChannel=t._groupChannel)},n.prototype._shouldStartBackgroundSync=function(){var t=X.of(this._iid).cacheContext;return this.channel.isGroupChannel()?t.localCacheEnabled&&!this.channel.isSuper:t.localCacheEnabled},n.prototype._setBaseMessageCollectionHandler=function(t){this._handler=t},n.prototype._filterUnderOffsetMessage=function(t){return t},n.prototype._updateChildMessagesInView=function(t){var e=[];return this._messages.forEach(function(r){r instanceof Hi&&r.parentMessageId===t.messageId&&r.applyParentMessage(t)&&e.push(r)}),e},n.prototype._updatePollsToView=function(t,e){var r,i,a=this,s=[];try{for(var u=Le(t),d=u.next();!d.done;d=u.next()){var h=d.value,p=wf(this._messages,h.messageId);if(p>=0){var g=this._messages[p];g.isUserMessage()&&g.applyPoll(h),s.push(g)}}}catch(E){r={error:E}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return s.length>0&&wu(e)&&an(function(){return M(a,void 0,void 0,function(){var E,y,C;return R(this,function(T){return E={source:e},s.length>0&&((C=(y=this._handler).onMessagesUpdated)===null||C===void 0||C.call(y,E,this.channel,s)),[2]})})}),s},n.prototype._applyPollUpdateEventToView=function(t,e){var r=this,i=wf(this._messages,t.messageId);if(i>=0){var a=this._messages[i];a&&a.isUserMessage()&&a.poll&&a.poll.applyPollUpdateEvent(t)&&wu(e)&&an(function(){return M(r,void 0,void 0,function(){var s,u,d;return R(this,function(h){return s={source:e},(d=(u=this._handler)===null||u===void 0?void 0:u.onMessagesUpdated)===null||d===void 0||d.call(u,s,this.channel,[a]),[2]})})})}},n.prototype._applyPollVoteEventToView=function(t,e){var r=this,i=wf(this._messages,t.messageId);if(i>=0){var a=this._messages[i];a&&a.isUserMessage()&&a.poll&&a.poll.applyPollVoteEvent(t)&&wu(e)&&an(function(){return M(r,void 0,void 0,function(){var s,u,d;return R(this,function(h){return s={source:e},(d=(u=this._handler)===null||u===void 0?void 0:u.onMessagesUpdated)===null||d===void 0||d.call(u,s,this.channel,[a]),[2]})})})}},n.prototype._applyReactionEventToView=function(t,e){var r=this,i=wf(this._messages,t.messageId);if(i>=0){var a=this._messages[i];a&&(a.isUserMessage()||a.isFileMessage()||a.isMultipleFilesMessage())&&wu(e)&&(a.applyReactionEvent(t),an(function(){return M(r,void 0,void 0,function(){var s,u,d;return R(this,function(h){return s={source:e},(d=(u=this._handler)===null||u===void 0?void 0:u.onMessagesUpdated)===null||d===void 0||d.call(u,s,this.channel,[a]),[2]})})}))}},n.prototype._applyThreadInfoEventToView=function(t,e){var r=this,i=wf(this._messages,t.targetMessageId);if(i>=0){var a=this._messages[i];a&&(a.isUserMessage()||a.isFileMessage()||a.isMultipleFilesMessage())&&wu(e)&&(a.applyThreadInfoUpdateEvent(t),an(function(){return M(r,void 0,void 0,function(){var s,u,d;return R(this,function(h){return s={source:e},(d=(u=this._handler)===null||u===void 0?void 0:u.onMessagesUpdated)===null||d===void 0||d.call(u,s,this.channel,[a]),[2]})})}))}},n.prototype._removeMessagesFromView=function(t,e){var r,i,a=this,s=[],u=[],d=function(E){var y=h._messages.findIndex(function(T){return a.keyOf(T)===E});if(y>=0){var C=h._messages[y];s.push(h.keyOf(C)),u.push(C),h._messages.splice(y,1)}},h=this;try{for(var p=Le(t),g=p.next();!g.done;g=p.next())d(g.value)}catch(E){r={error:E}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}return wu(e)&&u.length>0&&an(function(){return M(a,void 0,void 0,function(){var E,y,C;return R(this,function(T){return E={source:e},(C=(y=this._handler)===null||y===void 0?void 0:y.onMessagesDeleted)===null||C===void 0||C.call(y,E,this.channel,s,u),[2]})})}),s},n.prototype._removeUnsentMessageFromView=function(t,e){var r=this._unsentMessages.findIndex(function(i){return i.reqId===t});r>=0&&this._unsentMessages.splice(r,1)},n.prototype._getLocalMessages=function(t,e){var r=e.prevLimit,i=r===void 0?0:r,a=e.nextLimit,s=a===void 0?0:a,u=e.inclusive,d=u===void 0||u;return M(this,void 0,void 0,function(){var h,p,g,E,y;return R(this,function(C){switch(C.label){case 0:return h=[],d?[4,this._channelManager.getExactlyMatchingMessagesForTokenFromCache(this._channel.url,t,this.filter)]:[3,2];case 1:h=C.sent(),C.label=2;case 2:return i>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,t,"prev",this.filter,i,!1)]:[3,4];case 3:return g=C.sent(),[3,5];case 4:g=[],C.label=5;case 5:return p=g,s>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,t,"next",this.filter,s,!1)]:[3,7];case 6:return y=C.sent(),[3,8];case 7:y=[],C.label=8;case 8:return E=y,[2,{messages:Nn(Nn(Nn([],cn(h),!1),cn(p),!1),cn(E),!1).sort(function(T,A){return A.createdAt-T.createdAt}),prevMessagesCount:p.length,nextMessagesCount:E.length}]}})})},n.prototype._getRemoteMessages=function(t,e){var r=e.prevLimit,i=r===void 0?0:r,a=e.nextLimit,s=a===void 0?0:a,u=e.source,d=u===void 0?ge.REQUEST_MESSAGE:u,h=e.reverse,p=h!==void 0&&h,g=e.checkingHasNext,E=g!==void 0&&g,y=e.checkingContinuousMessages,C=y!==void 0&&y;return M(this,void 0,void 0,function(){var T,A;return R(this,function(O){switch(O.label){case 0:return T=ni.of(this._iid),i>0||s>0?[4,T._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,t,_n(W(W(W({},this.filter),Y1),{isInclusive:!0,reverse:p,prevResultSize:i,nextResultSize:s})),d,E,C)]:[3,2];case 1:return A=O.sent(),[3,3];case 2:A={messages:[],isContinuousMessages:!1},O.label=3;case 3:return[2,A]}})})},n.prototype._checkHugeGap=function(){var t,e,r,i,a;return M(this,void 0,void 0,function(){var s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z,Y,Q,$,Z,ne=this;return R(this,function(ue){switch(ue.label){case 0:return s=X.of(this._iid),u=s.dispatcher,d=s.requestQueue,h=s.cacheContext,p=s.statManager,g=s.logger,this._messages.length>0?(E=this._syncRange.top,y=this.viewTop,C=this._syncRange.bottom,T=this.hasNext?this.viewBottom:Number.MAX_SAFE_INTEGER,[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,y,E)]):[3,8];case 1:return A=ue.sent(),[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,C,T)];case 2:O=ue.sent(),ue.label=3;case 3:return ue.trys.push([3,5,6,7]),[4,wm(function(){return M(ne,void 0,void 0,function(){var pe,he,le,we,ve,Ue,be,Qe,Ne,$e,gn,En,Yn,Gn,Tn,kn,Vn,Hn=this;return R(this,function(Jn){switch(Jn.label){case 0:return pe=new nV(W(W({channelUrl:this._channel.url,channelType:this._channel.channelType,prevStart:y,prevEnd:E,prevCount:A,nextStart:C,nextEnd:T,nextCount:O,checkingContinuousMessages:h.localCacheEnabled},this.filter),Y1)),[4,d.send(pe)];case 1:return he=Jn.sent(),le=he.as(tV),we=le.isHugeGap,ve=le.prevMessages,Ue=ve===void 0?[]:ve,be=le.prevHasMore,Qe=le.isContinuousPrevMessages,Ne=le.nextMessages,$e=Ne===void 0?[]:Ne,gn=le.nextHasmore,En=le.isContinuousNextMessages,we?an(function(){return M(Hn,void 0,void 0,function(){var jn;return R(this,function(On){return!((jn=this._handler)===null||jn===void 0)&&jn.onHugeGapDetected&&this._handler.onHugeGapDetected(),[2]})})}):(Yn=this.viewTop,Gn=this.viewBottom,Tn=Math.min.apply(Math,Nn([Number.MAX_SAFE_INTEGER,Yn],cn(Ue.map(function(jn){return jn.createdAt})),!1)),kn=Math.max.apply(Math,Nn([0,Gn],cn($e.map(function(jn){return jn.createdAt})),!1)),u.dispatch(new mr({messages:Ue,source:ge.SYNC_MESSAGE_FILL})),u.dispatch(new mr({messages:$e,source:ge.SYNC_MESSAGE_FILL})),this._syncRange.extends(Tn,kn),(Qe||En)&&((Vn=this._backgroundSync)===null||Vn===void 0||Vn.range.extends(Tn,kn)),be&&this._prevFill.start(Tn),gn&&this._nextFill.start(kn)),[2]}})})},1)];case 4:return ue.sent(),[3,7];case 5:return N=ue.sent(),g.debug("Failed HugeGap Check ",N),[3,7];case 6:return h.localCacheEnabled&&p.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(e=(t=h.localCacheConfig)===null||t===void 0?void 0:t.maxSize)!==null&&e!==void 0?e:0,use_local_cache:h.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[3,13];case 8:k=Date.now(),ue.label=9;case 9:return ue.trys.push([9,11,12,13]),[4,this._getRemoteMessages(k,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,source:ge.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:h.localCacheEnabled})];case 10:if(D=ue.sent(),P=D.messages,U=D.isContinuousMessages,L=D.hasNext,P.length>0){for(B=P.map(function(pe){return pe.createdAt}),q=0,z=0,Y=0;Y<B.length;Y++)(Q=B[Y])<=k?q++:Q>=k&&z++;this._hasPrevious=q>=this._prevResultLimit,this._hasNext=L??z>=this._nextResultLimit,(Z=this._syncRange).extends.apply(Z,Nn([],cn(B),!1)),U&&((r=this._backgroundSync)===null||r===void 0||r.range.extends(this._syncRange.top,this._syncRange.bottom)),this._addMessagesToView(P,ge.SYNC_MESSAGE_FILL)}else this._hasPrevious=!1,this._hasNext=!1;return[3,13];case 11:return($=ue.sent())instanceof ee&&$.code===rn.NOT_FOUND_IN_DATABASE&&(this._hasPrevious=!1,this._hasNext=!1),[3,13];case 12:return h.localCacheEnabled&&p.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(a=(i=h.localCacheConfig)===null||i===void 0?void 0:i.maxSize)!==null&&a!==void 0?a:0,use_local_cache:h.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 13:return[2]}})})},n.prototype._loadUnsentMessages=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return t=this,[4,this._channelManager.getUnsentMessagesFromCache(this._channel.url,this.filter)];case 1:return t._unsentMessages=e.sent(),[2]}})})},n.prototype._hasPollMessage=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,this._channelManager.getPollMessagesFromCache(this._channel.url,Date.now()+6e5,this.filter,1)];case 1:return t.sent().length>0?[2,!0]:[2,!1]}})})},n.prototype._refreshChannel=function(t,e){return e===void 0&&(e=!1),M(this,void 0,void 0,function(){var r,i,a=this;return R(this,function(s){switch(s.label){case 0:r=X.of(this._iid).logger,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._channelManager.refreshChannel(this.channel.url,!0,t,e)];case 2:return s.sent(),this.channel._runIfHandleableWithGroupChannel(function(u){u.myMutedState===Ts.MUTED&&Pr(function(){return M(a,void 0,void 0,function(){var d;return R(this,function(h){switch(h.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(d=h.sent()).isMuted&&d.remainingDuration!==-1&&this._startCheckMyMutedTimer(d.remainingDuration),[2]}})})})}),[3,4];case 3:return i=s.sent(),r.warn("Failed to refresh channel",i),[3,4];case 4:return[2]}})})},n.prototype._startCheckMyMutedTimer=function(t){var e=this;this._clearCheckMyMutedTimer(),this._checkMyMutedStateTimer=setTimeout(function(){return M(e,void 0,void 0,function(){var r,i,a,s=this;return R(this,function(u){switch(u.label){case 0:this._checkMyMutedStateTimer=void 0,r=!0,u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,this._channel.getMyMutedInfo()];case 2:return i=u.sent(),r=!i.isMuted,[3,5];case 3:return u.sent(),r=!0,[3,5];case 4:return r&&(a=X.of(this._iid).sessionManager,this.channel._runIfHandleableWithGroupChannel(function(d){var h,p;d.myMutedState=Ts.UNMUTED;var g={source:ge.EVENT_CHANNEL_UNMUTED,user:a.currentUser};(p=(h=s._handler)===null||h===void 0?void 0:h.onChannelUpdated)===null||p===void 0||p.call(h,g,s.channel)})),[7];case 5:return[2]}})})},t+1e3)},n.prototype._clearCheckMyMutedTimer=function(){this._checkMyMutedStateTimer&&(clearTimeout(this._checkMyMutedStateTimer),this._checkMyMutedStateTimer=void 0)},n.prototype._setHasNextAndHasPrevious=function(t,e){for(var r=t.map(function(d){return d.createdAt}),i=0,a=0,s=0;s<r.length;s++){var u=r[s];u<this._startingPoint?i++:u>this._startingPoint&&a++}this._hasPrevious=i>=this._prevResultLimit,this._hasNext=e??a>=this._nextResultLimit},n.prototype.initialize=function(t){var e=this,r=new rV;this._messages=[],this._unsentMessages=[],this._syncRange=new Js({}),this._hasNext=!0,this._hasPrevious=!0;var i=[],a={messages:[],prevMessagesCount:0,nextMessagesCount:0};return an(function(){return M(e,void 0,void 0,function(){var s,u,d,h,p,g=this;return R(this,function(E){switch(E.label){case 0:return[4,(p=this._backgroundSync)===null||p===void 0?void 0:p.loadMetadata()];case 1:return s=E.sent(),u=X.of(this._iid),d=u.cacheContext,h=u.statManager,t===Ey.CACHE_AND_REPLACE_BY_API&&this._getLocalMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit}).then(function(y){return M(g,void 0,void 0,function(){return R(this,function(C){switch(C.label){case 0:return a=y,i=this._filterUnderOffsetMessage(a.messages),this._addMessagesToView(i,ge.REQUEST_MESSAGE),[4,this._loadUnsentMessages()];case 1:return C.sent(),r._invokeResponse("local",null,i),[2]}})})}).catch(function(y){if(Gi(y))throw y;r._invokeResponse("local",y,null)}).finally(function(){return M(g,void 0,void 0,function(){var y,C,T,A,O,N,k,D=this;return R(this,function(P){switch(P.label){case 0:return y=X.of(this._iid).cacheContext,C=!0,T=!0,A=!1,y.localCacheEnabled&&i.length>0&&(O=s.range).includes.apply(O,Nn([],cn(i.map(function(U){return U.createdAt})),!1))&&(!s.previousComplete&&a.prevMessagesCount<this._prevResultLimit?T=!0:this._startingPoint>s.range.bottom||a.nextMessagesCount<this._nextResultLimit?A=!0:T=!1),[4,this._refreshChannel(ge.REFRESH_CHANNEL,A)];case 1:return P.sent(),A&&this._channel._runIfHandleableWithGroupChannel(function(U){var L=Math.max.apply(Math,Nn([],cn(i.map(function(B){return B.createdAt})),!1));U._latestMessageInfo&&L>=U._latestMessageInfo.createdAt&&(T=!1)}),T?(C=!1,this._getRemoteMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:y.localCacheEnabled}).then(function(U){var L,B,q,z=U.messages,Y=U.isContinuousMessages,Q=U.hasNext,$=D._filterUnderOffsetMessage(z);D._messages=[],$.length>0?(D._setHasNextAndHasPrevious($,Q),(L=D._syncRange).extends.apply(L,Nn([],cn($.map(function(Z){return Z.createdAt})),!1)),Y&&(!((B=D._backgroundSync)===null||B===void 0)&&B.range.overlap(D._syncRange))&&((q=D._backgroundSync)===null||q===void 0||q.range.extends(D._syncRange.top,D._syncRange.bottom)),D._addMessagesToView($,ge.REQUEST_MESSAGE)):(D._hasPrevious=!1,D._hasNext=!1),r._invokeResponse("remote",null,$)}).catch(function(U){if(Gi(U))throw U;r._invokeResponse("remote",U,null)})):(this._setHasNextAndHasPrevious(i),r._invokeResponse("remote",null,i)),y.localCacheEnabled&&h.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"initial_load",event:C?"cache_hit":"cache_miss",max_db_size:(k=(N=y.localCacheConfig)===null||N===void 0?void 0:N.maxSize)!==null&&k!==void 0?k:0,message_init_policy:t,use_local_cache:y.localCacheEnabled,collection_id:this._key}})),[2]}})})}),h.put(new bh({type:gr.FEATURE_LOCALCACHE,data:{use_local_cache:d.localCacheEnabled,collection_interface:{message_init_policy:t,message:!0}}})),[2]}})})}),r},n.prototype.loadPrevious=function(){var t,e,r;return M(this,void 0,void 0,function(){var i,a,s,u,d,h,p,g,E=this;return R(this,function(y){switch(y.label){case 0:if(this._isDisposed)throw new ee({code:rn.COLLECTION_DISPOSED,message:"Collection has been disposed."});return i=X.of(this._iid),a=i.cacheContext,s=i.statManager,u=i.logger,this._hasPrevious?this._isLoadingPrevious?(u.warn("Messages are already fetching."),[2,[]]):(this._isLoadingPrevious=!0,d=this.viewTop,h=[],[4,Pr(function(){return M(E,void 0,void 0,function(){var C;return R(this,function(T){switch(T.label){case 0:return[4,this._getLocalMessages(d,{prevLimit:this._prevResultLimit,inclusive:!1})];case 1:return C=T.sent(),h=this._filterUnderOffsetMessage(C.messages),[2]}})})})]):[2,[]];case 1:return y.sent(),p=h.length>=this._prevResultLimit,a.localCacheEnabled&&s.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:p?"cache_hit":"cache_miss",max_db_size:(e=(t=a.localCacheConfig)===null||t===void 0?void 0:t.maxSize)!==null&&e!==void 0?e:0,use_local_cache:a.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),p&&(!((r=this._backgroundSync)===null||r===void 0)&&r.isWrappingMessages(h))?[3,3]:(g=!1,[4,Pr(function(){return M(E,void 0,void 0,function(){var C,T,A,O,N,k,D,P=this;return R(this,function(U){switch(U.label){case 0:return C=X.of(this._iid).cacheContext,[4,this._getRemoteMessages(d,{prevLimit:this._prevResultLimit,reverse:!0,checkingContinuousMessages:C.localCacheEnabled})];case 1:return T=U.sent(),(h=this._filterUnderOffsetMessage(T.messages)).length>0&&((A=this._syncRange).extends.apply(A,Nn([],cn(h.map(function(L){return L.createdAt})),!1)),!((O=this._backgroundSync)===null||O===void 0)&&O.range.overlap(this._syncRange)&&T.isContinuousMessages&&(g=!0,(N=this._backgroundSync)===null||N===void 0||N.range.extends(this._syncRange.top))),h=h.filter(function(L){return xa(P._messages,L)<0}),this._hasPrevious=h.length>=this._prevResultLimit,g&&s.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:"cache_fetch",max_db_size:(D=(k=C.localCacheConfig)===null||k===void 0?void 0:k.maxSize)!==null&&D!==void 0?D:0,use_local_cache:C.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}})})})]);case 2:return y.sent(),this._addMessagesToView(h,ge.REQUEST_MESSAGE),[3,4];case 3:this._hasPrevious=h.length>=this._prevResultLimit,h.length>0&&this._addMessagesToView(h,ge.REQUEST_MESSAGE),y.label=4;case 4:return this._isLoadingPrevious=!1,[2,h]}})})},n.prototype.loadNext=function(){var t,e,r;return M(this,void 0,void 0,function(){var i,a,s,u,d,h,p,g,E=this;return R(this,function(y){switch(y.label){case 0:if(this._isDisposed)throw new ee({code:rn.COLLECTION_DISPOSED,message:"Collection has been disposed."});return i=X.of(this._iid),a=i.cacheContext,s=i.statManager,u=i.logger,this._hasNext?this._isLoadingNext?(u.warn("Messages are already fetching."),[2,[]]):(this._isLoadingNext=!0,d=this.viewBottom,h=[],[4,Pr(function(){return M(E,void 0,void 0,function(){var C;return R(this,function(T){switch(T.label){case 0:return[4,this._getLocalMessages(d,{nextLimit:this._nextResultLimit,inclusive:!1})];case 1:return C=T.sent(),h=this._filterUnderOffsetMessage(C.messages),[2]}})})})]):[2,[]];case 1:return y.sent(),p=h.length>=this._nextResultLimit,a.localCacheEnabled&&s.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:p?"cache_hit":"cache_miss",max_db_size:(e=(t=a.localCacheConfig)===null||t===void 0?void 0:t.maxSize)!==null&&e!==void 0?e:0,use_local_cache:a.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),p&&(!((r=this._backgroundSync)===null||r===void 0)&&r.isWrappingMessages(h))?[3,3]:(g=!1,[4,Pr(function(){return M(E,void 0,void 0,function(){var C,T,A,O,N,k,D,P,U=this;return R(this,function(L){switch(L.label){case 0:return C=X.of(this._iid).cacheContext,[4,this._getRemoteMessages(d,{nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:C.localCacheEnabled})];case 1:return T=L.sent(),(h=this._filterUnderOffsetMessage(T.messages)).length>0&&((A=this._syncRange).extends.apply(A,Nn([],cn(h.map(function(B){return B.createdAt})),!1)),!((O=this._backgroundSync)===null||O===void 0)&&O.range.overlap(this._syncRange)&&T.isContinuousMessages&&(g=!0,(N=this._backgroundSync)===null||N===void 0||N.range.extends(this._syncRange.bottom))),h=h.filter(function(B){return xa(U._messages,B)<0}),this._hasNext=(k=T.hasNext)!==null&&k!==void 0?k:h.length>=this._nextResultLimit,g&&s.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:"cache_fetch",max_db_size:(P=(D=C.localCacheConfig)===null||D===void 0?void 0:D.maxSize)!==null&&P!==void 0?P:0,use_local_cache:C.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}})})})]);case 2:return y.sent(),this._addMessagesToView(h,ge.REQUEST_MESSAGE),[3,4];case 3:this._hasNext=h.length>=this._nextResultLimit,h.length>0&&this._addMessagesToView(h,ge.REQUEST_MESSAGE),y.label=4;case 4:return this._isLoadingNext=!1,[2,h]}})})},n.prototype.removeFailedMessage=function(t){return M(this,void 0,void 0,function(){var e;return R(this,function(r){switch(r.label){case 0:if(this._isDisposed)throw new ee({code:rn.COLLECTION_DISPOSED,message:"Collection has been disposed."});return[4,this._channelManager.removeFailedMessageFromCache(t)];case 1:return r.sent(),(e=this._unsentMessages.findIndex(function(i){return i.reqId===t}))>-1&&this._unsentMessages.splice(e,1),[2]}})})},n.prototype.dispose=function(){var t,e,r,i=this;if(!this._isDisposed){this._isDisposed=!0;var a=X.of(this._iid),s=a.cacheContext,u=a.dispatcher;this._messages=[],this._clearCheckMyMutedTimer(),this._channel._runIfHandleableWithGroupChannel(function(d){d.myMemberState!==Dr.NONE&&(i._channel._updateMessageCollectionLastAccessedAt(),u.dispatch(new pt({channels:[i._channel],context:{source:ge.CHANNEL_LASTACCESSEDAT_UPDATED}})))}),s.localCacheEnabled&&(this._prevFill.stop(),this._nextFill.stop()),(t=this._backgroundSync)===null||t===void 0||t.close(),(e=this._changelogSync)===null||e===void 0||e.close(),(r=this._pollChangelogSync)===null||r===void 0||r.close(),this._channelManager.unsubscribeChannelEvent(this._key),this._channelManager.unsubscribeMessageEvent(this._key),this._connectionEventContext&&this._connectionEventContext.close()}},n}(),aV=function(n){function t(e,r){return n.call(this,e,W(W({},r),{channelManager:ai.of(e)}))||this}return j(t,n),t.prototype.keyOf=function(e){return e.messageId},t.prototype.initialize=function(e){return n.prototype.initialize.call(this,e)},t.prototype.setMessageCollectionHandler=function(e){this._setBaseMessageCollectionHandler(e)},t.prototype._addMessagesToView=function(e,r){var i,a,s=this,u=this._filterUnderOffsetMessage(e),d=[],h=[];try{for(var p=Le(u),g=p.next();!g.done;g=p.next()){var E=g.value;if(r===ge.SYNC_MESSAGE_FILL)if(E.messageId>0){if((A=xa(this._messages,E))<0){xa(this._unsentMessages,E)<0&&d.push(E);var y=bE(this._messages,E);this._messages.splice(y,0,E)}}else E instanceof Lr&&(A=xa(this._unsentMessages,E))<0&&xa(this._messages,E)<0&&(this._unsentMessages.push(E),d.push(E));else if(E.messageId>0){if((A=xa(this._messages,E))<0){var C=xa(this._unsentMessages,E);C<0?d.push(E):(this._unsentMessages.splice(C,1),h.push(E)),y=bE(this._messages,E),this._messages.splice(y,0,E)}else h.push(E),this._messages[A]=E;if(E.updatedAt>0){var T=this._updateChildMessagesInView(E);h.push.apply(h,Nn([],cn(T),!1))}}else if(E instanceof Lr){var A;(A=xa(this._unsentMessages,E))<0?xa(this._messages,E)<0&&(this._unsentMessages.push(E),d.push(E)):(h.push(E),this._unsentMessages[A]=E)}}}catch(O){i={error:O}}finally{try{g&&!g.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}wu(r)&&an(function(){return M(s,void 0,void 0,function(){var O,N,k,D,P;return R(this,function(U){return O={source:r},d.length>0&&((k=(N=this._handler)===null||N===void 0?void 0:N.onMessagesAdded)===null||k===void 0||k.call(N,O,this.channel,d)),h.length>0&&((P=(D=this._handler)===null||D===void 0?void 0:D.onMessagesUpdated)===null||P===void 0||P.call(D,O,this.channel,h)),[2]})})})},t.prototype._updateMessagesToView=function(e,r){var i,a,s=this,u=[],d=[],h=[];try{for(var p=Le(e),g=p.next();!g.done;g=p.next()){var E,y=g.value;if(y.messageId>0)if((E=xa(this._messages,y))>=0)d.push(y),this._messages[E]=y;else{var C=xa(this._unsentMessages,y);if(C>=0){var T=cn(this._unsentMessages.splice(C,1),1)[0];if(this.hasNext&&T)h.push(T);else{d.push(y);var A=bE(this._messages,y);this._messages.splice(A,0,y)}}else{var O=this._messages.map(function(N){return N.createdAt});(y.createdAt<Math.min.apply(Math,Nn([],cn(O),!1))&&!this._hasPrevious||y.createdAt>Math.max.apply(Math,Nn([],cn(O),!1))&&!this._hasNext)&&u.push(y)}}else y instanceof Lr&&(E=xa(this._unsentMessages,y))>=0&&(d.push(y),this._unsentMessages[E]=y)}}catch(N){i={error:N}}finally{try{g&&!g.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}return wu(r)&&an(function(){return M(s,void 0,void 0,function(){var N,k,D,P,U;return R(this,function(L){return N={source:r},d.length>0?(D=(k=this._handler)===null||k===void 0?void 0:k.onMessagesUpdated)===null||D===void 0||D.call(k,N,this.channel,d):h.length>0?(U=(P=this._handler)===null||P===void 0?void 0:P.onMessagesDeleted)===null||U===void 0||U.call(P,N,this.channel,[],h):u.length>0&&this._addMessagesToView(u,r),[2]})})}),d},t}(iV),sV={coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isPublic:void 0,isDiscoverable:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},uV=function(n){function t(e){var r=this,i=e.channelUrl,a=e.token,s=e.limit,u=e.order,d=e.mutedMemberFilter,h=e.memberStateFilter,p=e.nicknameStartsWithFilter,g=e.operatorFilter;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/members"),r.params={token:a,limit:s,order:u,muted_member_filter:d,member_state_filter:h,nickname_startswith:p,operator_filter:g,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0},r}return j(t,n),t}(Te),oV=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.members=[];var a=r.next,s=r.members;return i.token=a,s&&s.length>0&&(i.members=s.map(function(u){return new qa(e,u)})),i}return j(t,n),t}(Me);(function(n){n.ALL="all",n.MUTED="muted",n.UNMUTED="unmuted"})(fh||(fh={})),function(n){n.MEMBER_NICKNAME_ALPHABETICAL="member_nickname_alphabetical",n.OPERATOR_THEN_MEMBER_ALPHABETICAL="operator_then_member_alphabetical"}(hh||(hh={})),function(n){n.ALL="all",n.JOINED="joined_only",n.INVITED="invited_only",n.INVITED_BY_FRIEND="invited_by_friend",n.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(ph||(ph={}));var lV=function(n){function t(e,r,i){var a,s,u,d,h=this;return(h=n.call(this,e,r,vt.GROUP,i)||this).mutedMemberFilter=fh.ALL,h.memberStateFilter=ph.ALL,h.nicknameStartsWithFilter=null,h.operatorFilter=um.ALL,h.order=hh.MEMBER_NICKNAME_ALPHABETICAL,h.mutedMemberFilter=(a=i.mutedMemberFilter)!==null&&a!==void 0?a:fh.ALL,h.memberStateFilter=(s=i.memberStateFilter)!==null&&s!==void 0?s:ph.ALL,h.nicknameStartsWithFilter=(u=i.nicknameStartsWithFilter)!==null&&u!==void 0?u:null,h.order=(d=i.order)!==null&&d!==void 0?d:hh.MEMBER_NICKNAME_ALPHABETICAL,h}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&nt(fh,this.mutedMemberFilter)&&nt(ph,this.memberStateFilter)&&(J("string",this.nicknameStartsWithFilter)||this.nicknameStartsWithFilter===null)&&nt(um,this.operatorFilter)&&nt(hh,this.order)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new uV(_n(W(W({},this),{token:this._token}))),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(oV),s=a.members,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),dV=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId,s=e.accessCode;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/accept"),r.params={user_id:a,access_code:s},r}return j(t,n),t}(Te),cV=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Qa(e,r),i.channel.myMemberState=Dr.JOINED,i}return j(t,n),t}(Me),fV=function(n){function t(e){var r=this,i=e.channelUrl,a=e.isDistinct,s=e.isPublic,u=e.isDiscoverable,d=e.coverUrl,h=e.coverImage,p=e.accessCode,g=e.name,E=e.data,y=e.customType,C=e.operatorUserIds,T=e.messageSurvivalSeconds;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(qi,"/").concat(encodeURIComponent(i)),r.params=ze({is_distinct:a,is_public:s,is_discoverable:u,name:g,data:E,custom_type:y,cover_url:d,cover_file:h,access_code:p,operator_ids:C,message_survival_seconds:T}),r}return j(t,n),t}(Te),hV=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Qa(e,r),i}return j(t,n),t}(Me),pV=function(n){function t(e){var r=this,i=e.channelUrl;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(qi,"/").concat(encodeURIComponent(i)),r}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var _V=function(n){function t(e){var r=this,i=e.channelUrl;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/hide"),r}return j(t,n),t}(Te);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}j(t,n)})(Me);var mV=function(n){function t(e){var r=e.userId,i=e.channelUrl,a=e.countPreference,s=n.call(this)||this;return s.method=Ie.PUT,s.path="".concat(xt,"/").concat(encodeURIComponent(r),"/count_preference/").concat(encodeURIComponent(i)),s.params={count_preference:a},s}return j(t,n),t}(Te),gV=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.countPreference=r.count_preference,i}return j(t,n),t}(Me),vV=function(n){function t(e){var r=this,i=e.channelUrl,a=e.locale;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(qi,"/").concat(encodeURIComponent(i),"/reset_user_history"),r.params=ze({locale:a}),r}return j(t,n),t}(Te),EV=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.ts_message_offset;return i.messageOffsetTimestamp=a,i}return j(t,n),t}(Me),yV=W(W({},uC),{scheduledAt:void 0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),bV=W(W({},gM),{scheduledAt:void 0}),CV=function(n){function t(e){var r,i,a=this;a=n.call(this)||this;var s=[];e.mentionType===wi.USERS&&(e.mentionedUserIds?s=e.mentionedUserIds:e.mentionedUsers&&(s=e.mentionedUsers.map(function(p){return p.userId})));var u=e.channelType,d=e.channelUrl,h=e.scheduledMessageId;return a.method=Ie.PUT,a.path="".concat(Lt(u),"/").concat(encodeURIComponent(d),"/scheduled_messages/").concat(encodeURIComponent(h)),a.params=ze(_n({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:pc.FILE,url:e.fileUrl,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,thumbnails:(r=e._thumbnails)===null||r===void 0?void 0:r.map(function(p){return ju.payloadify(p)}),custom_type:e.customType,data:e.data,require_auth:e.requireAuth,mention_type:e.mentionType,mentioned_user_ids:s,sorted_metaarray:(i=e.metaArrays)===null||i===void 0?void 0:i.map(function(p){return Vi.payloadify(p)}),apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,push_option:e.pushNotificationDeliveryOption})),a}return j(t,n),t}(Te),IV=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new Wr(e,r),i}return j(t,n),t}(Me),TV=function(n){function t(e){var r,i=this;i=n.call(this)||this;var a=[];e.mentionType===wi.USERS&&(e.mentionedUserIds?a=e.mentionedUserIds:e.mentionedUsers&&(a=e.mentionedUsers.map(function(h){return h.userId})));var s=e.channelType,u=e.channelUrl,d=e.scheduledMessageId;return i.method=Ie.PUT,i.path="".concat(Lt(s),"/").concat(encodeURIComponent(u),"/scheduled_messages/").concat(encodeURIComponent(d)),i.params=ze(_n({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:pc.USER,message:e.message,custom_type:e.customType,data:e.data,mention_type:e.mentionType,mentioned_user_ids:a,sorted_metaarray:(r=e.metaArrays)===null||r===void 0?void 0:r.map(function(h){return Vi.payloadify(h)}),apple_critical_alert_options:e.appleCriticalAlertOptions?cs.payloadify(e.appleCriticalAlertOptions):null,target_langs:e.translationTargetLanguages,push_option:e.pushNotificationDeliveryOption})),i}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new Si(e,r),i}j(t,n)})(Me);var Ha,Ba,SV=function(n){function t(e){var r=n.call(this)||this,i=e.channelType,a=e.channelUrl,s=e.scheduledMessageId;return r.method=Ie.DELETE,r.path="".concat(Lt(i),"/").concat(encodeURIComponent(a),"/scheduled_messages/").concat(encodeURIComponent(s)),r}return j(t,n),t}(Te),NV=function(n){function t(e){var r=n.call(this)||this,i=e.channelType,a=e.channelUrl,s=e.scheduledMessageId;return r.method=Ie.POST,r.path="".concat(Lt(i),"/").concat(encodeURIComponent(a),"/scheduled_messages/").concat(encodeURIComponent(s),"/send_now"),r}return j(t,n),t}(Te),AV=function(n){function t(e){var r=e.userId,i=e.channelUrl,a=e.pushTriggerOption,s=n.call(this)||this;return s.method=Ie.PUT,s.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push_preference/").concat(encodeURIComponent(i)),s.params={push_trigger_option:a},s}return j(t,n),t}(Te),wV=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTriggerOption=r.push_trigger_option,i.enabled=r.enable,i}return j(t,n),t}(Me),RV=function(n){function t(e){var r=e.userId,i=e.channelUrl,a=n.call(this)||this;return a.method=Ie.GET,a.path="".concat(xt,"/").concat(encodeURIComponent(r),"/push_preference/").concat(encodeURIComponent(i)),a}return j(t,n),t}(Te),MV=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTriggerOption=r.push_trigger_option,i.enabled=r.enable,i}return j(t,n),t}(Me);(function(n){n.ALL="all",n.UNREAD_MESSAGE_COUNT_ONLY="unread_message_count_only",n.UNREAD_MENTION_COUNT_ONLY="unread_mention_count_only",n.OFF="off"})(Ha||(Ha={})),function(n){n.UNHIDDEN="unhidden",n.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",n.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Ba||(Ba={}));var Qa=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B=this;return(B=n.call(this,e,r)||this)._unreadMemberStateMap=new Map,B._undeliveredMemberStateMap=new Map,B._typingStatus=new Map,B._lastMemberCountUpdated=0,B._typingStarted=0,B._typingEnded=0,B._hasBotInfo={general:!1,ai:!1},B.isDistinct=!1,B.isSuper=!1,B.isBroadcast=!1,B.isExclusive=!1,B.isPublic=!1,B.isDiscoverable=!0,B.isChatNotification=!1,B.isAccessCodeRequired=!1,B.isPushEnabled=!1,B.unreadMessageCount=0,B.unreadMentionCount=0,B.totalUnreadReplyCount=0,B.members=[],B.memberCount=0,B.joinedMemberCount=0,B.hiddenState=Ba.UNHIDDEN,B.lastMessage=null,B.messageOffsetTimestamp=0,B.messageSurvivalSeconds=-1,B.myMemberState=Dr.NONE,B.myRole=Ka.NONE,B.myMutedState=Ts.UNMUTED,B.myLastRead=0,B.myCountPreference=Ha.ALL,B.myPushTriggerOption=Pl.DEFAULT,B.inviter=null,B.invitedAt=0,B.joinedAt=0,B.lastPinnedMessage=null,B._latestMessageInfo=null,B._pinnedMessagesUpdatedAt=0,B._myMutedRemainingTime=-1,B.channelType=vt.GROUP,B.isDistinct=(a=r.is_distinct)!==null&&a!==void 0&&a,B.isSuper=(s=r.is_super)!==null&&s!==void 0&&s,B.isBroadcast=(u=r.is_broadcast)!==null&&u!==void 0&&u,B.isExclusive=(d=r.is_exclusive)!==null&&d!==void 0&&d,B.isPublic=(h=r.is_public)!==null&&h!==void 0&&h,B.isDiscoverable=(p=r.is_discoverable)!==null&&p!==void 0?p:B.isPublic,B.isChatNotification=(g=r.is_chat_notification)!==null&&g!==void 0&&g,B.isAccessCodeRequired=(E=r.is_access_code_required)!==null&&E!==void 0&&E,B.isPushEnabled=(y=r.is_push_enabled)!==null&&y!==void 0&&y,Array.isArray(r.members)&&(i=B.members).push.apply(i,Nn([],cn(r.members.map(function(q){return new qa(B._iid,q)})),!1)),B.memberCount=(C=r.member_count)!==null&&C!==void 0?C:0,B.joinedMemberCount=(T=r.joined_member_count)!==null&&T!==void 0?T:0,B.hiddenState=nt(Ba,r.hidden_state)?r.hidden_state:Ba.UNHIDDEN,B.messageOffsetTimestamp=(A=r.ts_message_offset)!==null&&A!==void 0?A:0,B.messageSurvivalSeconds=(O=r.message_survival_seconds)!==null&&O!==void 0?O:-1,B.lastMessage=r.last_message?Ri(B._iid,W({channel_type:B.channelType},r.last_message)):null,r.read_receipt&&Object.keys(r.read_receipt).forEach(function(q){J("number",r.read_receipt[q])&&B._updateUnreadMemberState(q,r.read_receipt[q])}),r.delivery_receipt&&Object.keys(r.delivery_receipt).forEach(function(q){J("number",r.delivery_receipt[q])&&B._updateUndeliveredMemberState(q,r.delivery_receipt[q])}),B.myMemberState=nt(Dr,r.member_state)?r.member_state:Dr.NONE,B.myRole=nt(Ka,r.my_role)?r.my_role:Ka.NONE,nt(Ts,r.is_muted)?B.myMutedState=r.is_muted:J("boolean",r.is_muted)?B.myMutedState=r.is_muted?Ts.MUTED:Ts.UNMUTED:B.myMutedState=Ts.UNMUTED,B.myCountPreference=nt(Ha,r.count_preference)?r.count_preference:Ha.ALL,B.myPushTriggerOption=nt(Pl,r.push_trigger_option)?r.push_trigger_option:Pl.ALL,B.myLastRead=(N=r.user_last_read)!==null&&N!==void 0?N:0,B.inviter=r.inviter?new _t(B._iid,r.inviter):null,B.invitedAt=(k=r.invited_at)!==null&&k!==void 0?k:0,B.joinedAt=(D=r.joined_ts)!==null&&D!==void 0?D:0,B._updateUnreadCount((P=r.unread_message_count)!==null&&P!==void 0?P:0,(U=r.unread_mention_count)!==null&&U!==void 0?U:0),B.totalUnreadReplyCount=(L=r.total_unread_thread_message_count)!==null&&L!==void 0?L:0,B.lastPinnedMessage=r.latest_pinned_message?Ri(B._iid,W({channel_type:B.channelType},r.latest_pinned_message)):null,r.latest_message&&(B._latestMessageInfo={messageId:r.latest_message.message_id,createdAt:r.latest_message.created_at}),B._hasBotInfo={general:!!r.has_bot,ai:!!r.has_ai_bot},B}return j(t,n),Object.defineProperty(t.prototype,"isHidden",{get:function(){return this.hiddenState!==Ba.UNHIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTyping",{get:function(){return this._typingStatus.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUnreadMemberState",{get:function(){var e,r,i={};try{for(var a=Le(this._unreadMemberStateMap),s=a.next();!s.done;s=a.next()){var u=cn(s.value,2),d=u[0],h=u[1];i[d]=h}}catch(p){e={error:p}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUndeliveredMemberState",{get:function(){var e,r,i={};try{for(var a=Le(this._undeliveredMemberStateMap),s=a.next();!s.done;s=a.next()){var u=cn(s.value,2),d=u[0],h=u[1];i[d]=h}}catch(p){e={error:p}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBot",{get:function(){return this._hasBotInfo.general},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasAiBot",{get:function(){return this._hasBotInfo.ai},enumerable:!1,configurable:!0}),t.payloadify=function(e){return ze(_n(W(W({},n.payloadify.call(this,e)),{is_access_code_required:e.isAccessCodeRequired,is_distinct:e.isDistinct,is_super:e.isSuper,is_broadcast:e.isBroadcast,is_exclusive:e.isExclusive,is_public:e.isPublic,is_discoverable:e.isDiscoverable,is_muted:e.myMutedState,is_push_enabled:e.isPushEnabled,unread_message_count:e.unreadMessageCount,unread_mention_count:e.unreadMentionCount,total_unread_thread_message_count:e.totalUnreadReplyCount,push_trigger_option:e.myPushTriggerOption,count_preference:e.myCountPreference,hidden_state:e.hiddenState,member_count:e.memberCount,joined_member_count:e.joinedMemberCount,member_state:e.myMemberState,my_role:e.myRole,user_last_read:e.myLastRead,ts_message_offset:e.messageOffsetTimestamp,message_survival_seconds:e.messageSurvivalSeconds,read_receipt:e.cachedUnreadMemberState,delivery_receipt:e.cachedUndeliveredMemberState,members:e.members.map(function(r){return qa.payloadify(r)}),last_message:e.lastMessage?ay(e.lastMessage):null,inviter:e.inviter?_t.payloadify(e.inviter):null,invited_at:e.invitedAt,joined_ts:e.joinedAt,latest_pinned_message:e.lastPinnedMessage?ay(e.lastPinnedMessage):null,latest_message:e._latestMessageInfo?{message_id:e._latestMessageInfo.messageId,created_at:e._latestMessageInfo.createdAt}:null,has_bot:e.hasBot,has_ai_bot:e.hasAiBot})))},t.prototype._shouldUpdateLastMessageWith=function(e){if(e.silent)return!1;var r=X.of(this._iid).appInfo;switch(r==null?void 0:r.lastMessageThreadingPolicy){case Gl.NONE:case Gl.INCLUDE_REPLY:break;case Gl.EXCLUDE_REPLY:if(e.parentMessageId>0)return!1;break;case Gl.INCLUDE_REPLY_TO_CHANNEL:if(e instanceof Lr&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!this.lastMessage||this.lastMessage.createdAt<e.createdAt||this.lastMessage.createdAt===e.createdAt&&this.lastMessage.messageId===e.messageId&&this.lastMessage.updatedAt<e.updatedAt},t.prototype._tryUpdateLastMessageAndCallEvents=function(e,r){var i=X.of(this._iid).dispatcher,a=ai.of(this._iid);this._updateLastMessage(r),a.handlers.map(function(s){s.onChannelChanged&&s.onChannelChanged(e)}),i.dispatch(new pt({channels:[e],context:{source:ge.EVENT_MESSAGE_SENT}}))},t.prototype._shouldUpdateUnreadCountWith=function(e){var r=X.of(this._iid).appInfo;switch(r==null?void 0:r.unreadCountThreadingPolicy){case Bl.NONE:case Bl.INCLUDE_REPLY:break;case Bl.EXCLUDE_REPLY:if(e.parentMessageId>0)return!1;break;case Bl.INCLUDE_REPLY_TO_CHANNEL:if(e instanceof Lr&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!0},t.prototype._updateLastMessage=function(e){return!!this._shouldUpdateLastMessageWith(e)&&(this.lastMessage=e,!0)},t.prototype._updateUnreadCount=function(e,r){if(typeof e=="number"&&e>=0)if(this.myCountPreference===Ha.ALL||this.myCountPreference===Ha.UNREAD_MESSAGE_COUNT_ONLY)if(this.isExclusive||this.isSuper||this.isBroadcast){var i=X.of(this._iid).maxSuperGroupChannelUnreadCount;this.unreadMessageCount=i&&e>=i?i:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;else this.unreadMessageCount=0;typeof r=="number"&&r>=0&&(this.myCountPreference===Ha.ALL||this.myCountPreference===Ha.UNREAD_MENTION_COUNT_ONLY)?this.unreadMentionCount=r:this.unreadMentionCount=0},t.prototype._updateUnreadMemberState=function(e,r){var i=this._unreadMemberStateMap.get(e);return(!i||i<r)&&(this._unreadMemberStateMap.set(e,r),X.of(this._iid).sdkState.userId===e&&(this.myLastRead=r),!0)},t.prototype._updateUndeliveredMemberState=function(e,r){var i=this._undeliveredMemberStateMap.get(e);return(!i||i<r)&&(this._undeliveredMemberStateMap.set(e,r),!0)},t.prototype._updateTypingStatus=function(e,r){r===void 0&&(r=new Date().getTime()),r>0?this._typingStatus.set(e.userId,{user:e,ts:r}):this._typingStatus.delete(e.userId)},t.prototype._clearTypingStatus=function(){this._typingStatus.clear(),this._typingStarted=0,this._typingEnded=0},t.prototype._setLatestMemberCount=function(e,r,i){var a=!1;return i>=this._lastMemberCountUpdated&&(this._lastMemberCountUpdated=i,a=e!==this.memberCount||r!==this.joinedMemberCount,this.memberCount=e,this.joinedMemberCount=r),a},t.prototype.isReadMessage=function(e){var r=X.of(this._iid).sdkState,i=this._unreadMemberStateMap.get(r.userId);return!!i&&i>=e.createdAt},t.prototype.serialize=function(){var e=this;return Nc(this,function(r){r.cachedUnreadMemberState=e.cachedUnreadMemberState,r.cachedUndeliveredMemberState=e.cachedUndeliveredMemberState,Object.assign(r,e._serializeCachedMetaData())})},t.prototype.createMessageCollection=function(e){return e===void 0&&(e={}),new aV(this._iid,W(W({},e),{channel:this}))},t.prototype.createMemberListQuery=function(e){return e===void 0&&(e={}),new lV(this._iid,this.url,e)},t.prototype.createThreadedParentMessageListQuery=function(e){return e===void 0&&(e={}),new nB(this._iid,this.url,this.channelType,e)},t.prototype.addMember=function(e,r){if(r===void 0&&(r=0),!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var i=this.members.findIndex(function(s){return s.userId===e.userId});if(i>-1){var a=this.members[i];a.state===Dr.JOINED&&(e.state=a.state),this.members.splice(i,1),this.memberCount--}this.members.push(e),this.memberCount++,this._updateUnreadMemberState(e.userId,r),this._updateUndeliveredMemberState(e.userId,r)}},t.prototype.removeMember=function(e){if(!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=e instanceof qa?e.userId:e,i=this.members.findIndex(function(a){return a.userId===r});if(i>-1)return this.members.splice(i,1),this.memberCount--,!0}return!1},t.prototype.getUnreadMemberCount=function(e){var r,i;if(e instanceof Lr&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var a=X.of(this._iid).sdkState,s=e.createdAt,u=0;try{for(var d=Le(this.members),h=d.next();!h.done;h=d.next()){var p=h.value;a.userId!==p.userId&&p.state===Dr.JOINED&&e.sender.userId!==p.userId&&(this.cachedUnreadMemberState[p.userId]||0)<s&&u++}}catch(g){r={error:g}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}return u}return 0},t.prototype.getUndeliveredMemberCount=function(e){var r,i;if(e instanceof Lr&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var a=X.of(this._iid).sdkState,s=e.createdAt,u=0;try{for(var d=Le(this.members),h=d.next();!h.done;h=d.next()){var p=h.value;a.userId!==p.userId&&p.state===Dr.JOINED&&e.sender.userId!==p.userId&&(this.cachedUndeliveredMemberState[p.userId]||0)<s&&u++}}catch(g){r={error:g}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}return u}return 0},t.prototype.getReadMembers=function(e,r){var i=this;r===void 0&&(r=!1);var a=X.of(this._iid).sdkState;if(!a.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var s=e instanceof Lr?e.sender:null,u=[];return this.members.forEach(function(d){if(r||d.userId!==a.userId&&d.userId!==(s==null?void 0:s.userId)){var h=i._unreadMemberStateMap.get(d.userId);h&&h>=e.createdAt&&u.push(d)}}),u},t.prototype.getUnreadMembers=function(e,r){var i=this;r===void 0&&(r=!1);var a=X.of(this._iid).sdkState;if(!a.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var s=e instanceof Lr?e.sender:null,u=[];return this.members.forEach(function(d){if(r||d.userId!==a.userId&&d.userId!==(s==null?void 0:s.userId)){var h=i._unreadMemberStateMap.get(d.userId);h&&h<e.createdAt&&u.push(d)}}),u},t.prototype.getReadStatus=function(e){var r=this;e===void 0&&(e=!1);var i=X.of(this._iid).sdkState;if(!i.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var a={};return this.members.forEach(function(s){if(e||s.userId!==i.userId){var u=r._unreadMemberStateMap.get(s.userId);a[s.userId]=new lM(r._iid,{channel_url:r.url,channel_type:r.channelType,user:qa.payloadify(s),ts:u??0})}}),a},t.prototype.getDeliveryStatus=function(e){var r=this;e===void 0&&(e=!0);var i=X.of(this._iid).sdkState;if(!i.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var a={};return this.members.forEach(function(s){if(e||s.userId!==i.userId){var u=r._undeliveredMemberStateMap.get(s.userId);a[s.userId]=new oG(r._iid,{channel_url:r.url,channel_type:r.channelType,user:qa.payloadify(s),ts:u??0})}}),a},t.prototype.getTypingUsers=function(){var e=[];return this._typingStatus.forEach(function(r){var i=r.user;e.push(i)}),e},t.prototype.invalidateTypingStatus=function(){var e=this,r=X.of(this._iid).typingIndicatorInvalidateTime,i=Date.now(),a=!1;return this._typingStatus.forEach(function(s,u){var d=s.ts;i-d>=r&&(e._typingStatus.delete(u),a=!0)}),a},t.prototype.refresh=function(){return M(this,void 0,void 0,function(){return R(this,function(e){return[2,this._refresh()]})})},t.prototype._refresh=function(e){return e===void 0&&(e=!1),M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return r=X.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new my({channelUrl:this.url}),[4,i.send(s)];case 1:return u=h.sent(),d=u.as(gy).channel,this._update(d),e||a.dispatch(new pt({channels:[d],context:{source:ge.REFRESH_CHANNEL}})),[2,this]}})})},t.prototype.freeze=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,n.prototype.freeze.call(this)];case 1:return e.sent(),X.of(this._iid).dispatcher.dispatch(new pt({channels:[this],context:{source:ge.EVENT_CHANNEL_FROZEN},isWebSocketEventComing:!0})),[2]}})})},t.prototype.unfreeze=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,n.prototype.unfreeze.call(this)];case 1:return e.sent(),X.of(this._iid).dispatcher.dispatch(new pt({channels:[this],context:{source:ge.EVENT_CHANNEL_UNFROZEN},isWebSocketEventComing:!0})),[2]}})})},t.prototype.updateChannel=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return r=W(W({},sV),e),Se(function(g){return J("string",g.coverUrl,!0)&&(oi(g.coverImage)||J("string",g.coverImage,!0))&&J("boolean",g.isDistinct,!0)&&J("boolean",g.isPublic,!0)&&J("boolean",g.isDiscoverable,!0)&&J("string",g.accessCode,!0)&&J("string",g.name,!0)&&J("string",g.data,!0)&&J("string",g.customType,!0)&&tt("string",g.operatorUserIds,!0)&&J("number",g.messageSurvivalSeconds,!0)}(r)).throw(ee.invalidParameters),i=X.of(this._iid),a=i.dispatcher,s=i.requestQueue,u=new fV(W({channelUrl:this.url},r)),[4,s.send(u)];case 1:return d=p.sent(),h=d.as(hV).channel,this._update(h),a.dispatch(new pt({channels:[h],context:{source:ge.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.invite=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return Se(e.every(function(i){return i instanceof _t})).throw(ee.invalidParameters),[2,this.inviteWithUserIds(e.map(function(i){return i.userId}))]})})},t.prototype.inviteWithUserIds=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return Se(tt("string",e)).throw(ee.invalidParameters),r=X.of(this._iid),i=r.dispatcher,a=r.requestQueue,s=r.sessionManager,u=new PG({channelUrl:this.url,userIds:e}),[4,a.send(u)];case 1:return d=p.sent(),h=d.as(FG).channel,this._update(h),i.dispatch(new pt({channels:[h],context:{source:ge.EVENT_CHANNEL_INVITED,inviter:s.currentUser,invitees:[]},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.join=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return Se(J("string",e,!0)).throw(ee.invalidParameters),r=X.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,u=new kG({channelUrl:this.url,userId:a.userId,accessCode:e}),[4,s.send(u)];case 1:return d=p.sent(),(h=d.as(DG).channel).myMemberState=this.myMemberState=Dr.JOINED,this._update(h),i.dispatch(new pt({channels:[h],context:{source:ge.EVENT_CHANNEL_JOINED,users:[]},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.leave=function(e){return e===void 0&&(e=!1),M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return r=X.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new xG({channelUrl:this.url,userId:i.userId,shouldRemoveOperatorStatus:e}),[4,a.send(s)];case 1:return u.sent(),this.myMemberState=Dr.NONE,[2]}})})},t.prototype.acceptInvitation=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return Se(J("string",e,!0)).throw(ee.invalidParameters),r=X.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,u=new dV({channelUrl:this.url,userId:a.userId,accessCode:e}),[4,s.send(u)];case 1:return d=p.sent(),(h=d.as(cV).channel).myMemberState=this.myMemberState=Dr.JOINED,this._update(h),i.dispatch(new pt({channels:[h],context:{source:ge.EVENT_CHANNEL_ACCEPTED_INVITE},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.declineInvitation=function(){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new BG({channelUrl:this.url,userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),this.myMemberState=Dr.NONE,[2,this]}})})},t.prototype.sendUserMessage=function(e){var r=this,i=new Ia,a=X.of(this._iid).dispatcher,s=Wf.of(this._iid);return n.prototype.sendUserMessage.call(this,e).onPending(function(u){s.completeCurrentAndProcessNextAutoResend(u),i._trigger(u)}).onFailed(function(u,d){d&&s.completeCurrentAndProcessNextAutoResend(d),i._triggerFailed(u,d)}).onSucceeded(function(u){s.completeCurrentAndProcessNextAutoResend(u),r._updateLastMessage(u),ai.of(r._iid).handlers.map(function(d){d.onChannelChanged&&d.onChannelChanged(r)}),a.dispatch(new pt({channels:[r],context:{source:ge.EVENT_MESSAGE_SENT}})),i._trigger(u)}),i},t.prototype.updateUserMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u,d=this;return R(this,function(h){switch(h.label){case 0:return i=X.of(this._iid).dispatcher,[4,n.prototype.updateUserMessage.call(this,e,r)];case 1:return a=h.sent(),s=this._updateLastMessage(a),u=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===a.messageId&&(this.lastPinnedMessage=a,s=!0,u=!0),s&&(ai.of(this._iid).handlers.map(function(p){p.onChannelChanged&&p.onChannelChanged(d)}),i.dispatch(new pt({channels:[this],context:{source:u?ge.EVENT_PINNED_MESSAGE_UPDATED:ge.EVENT_MESSAGE_UPDATED}}))),u&&ai.of(this._iid).handlers.map(function(p){p.onPinnedMessageUpdated&&p.onPinnedMessageUpdated(d)}),i.dispatch(new mr({messages:[a],source:ge.EVENT_MESSAGE_UPDATED})),[2,a]}})})},t.prototype._autoResendUserMessage=function(e){var r=this,i=new Ia,a=X.of(this._iid).dispatcher,s=Wf.of(this._iid);return n.prototype._autoResendUserMessage.call(this,e).onPending(function(u){s.completeCurrentAndProcessNextAutoResend(u),i._trigger(u)}).onFailed(function(u,d){s.completeCurrentAndProcessNextAutoResend(d),i._triggerFailed(u,d)}).onSucceeded(function(u){var d=ai.of(r._iid);s.completeCurrentAndProcessNextAutoResend(u),r._updateLastMessage(u),d.handlers.map(function(h){h.onChannelChanged&&h.onChannelChanged(r)}),a.dispatch(new pt({channels:[r],context:{source:ge.EVENT_MESSAGE_SENT}})),i._trigger(u)}),i},t.prototype.sendFileMessage=function(e){var r=this,i=new Ia,a=X.of(this._iid).dispatcher,s=Wf.of(this._iid);return n.prototype.sendFileMessage.call(this,e).onPending(function(u){s.completeCurrentAndProcessNextAutoResend(u),i._trigger(u)}).onFailed(function(u,d){d&&s.completeCurrentAndProcessNextAutoResend(d),i._triggerFailed(u,d)}).onSucceeded(function(u){var d=ai.of(r._iid);s.completeCurrentAndProcessNextAutoResend(u),r._updateLastMessage(u),d.handlers.map(function(h){h.onChannelChanged&&h.onChannelChanged(r)}),a.dispatch(new pt({channels:[r],context:{source:ge.EVENT_MESSAGE_SENT}})),i._trigger(u)}),i},t.prototype.sendMultipleFilesMessage=function(e){var r=this,i=new S_,a=X.of(this._iid).dispatcher;return n.prototype.sendMultipleFilesMessage.call(this,e).onPending(function(s){i._trigger(s)}).onFailed(function(s,u){i._triggerFailed(s,u)}).onSucceeded(function(s){var u=ai.of(r._iid);r._updateLastMessage(s),u.handlers.map(function(d){d.onChannelChanged&&d.onChannelChanged(r)}),a.dispatch(new pt({channels:[r],context:{source:ge.EVENT_MESSAGE_SENT}})),i._trigger(s)}).onFileUploaded(function(s,u,d,h){i._triggerOnFileUploaded(s,u,d,h)}),i},t.prototype.updateFileMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u,d=this;return R(this,function(h){switch(h.label){case 0:return i=X.of(this._iid).dispatcher,[4,n.prototype.updateFileMessage.call(this,e,r)];case 1:return a=h.sent(),s=this._updateLastMessage(a),u=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===a.messageId&&(this.lastPinnedMessage=a,s=!0,u=!0),s&&(ai.of(this._iid).handlers.map(function(p){p.onChannelChanged&&p.onChannelChanged(d)}),i.dispatch(new pt({channels:[this],context:{source:u?ge.EVENT_PINNED_MESSAGE_UPDATED:ge.EVENT_MESSAGE_UPDATED}}))),u&&ai.of(this._iid).handlers.map(function(p){p.onPinnedMessageUpdated&&p.onPinnedMessageUpdated(d)}),i.dispatch(new mr({messages:[a],source:ge.EVENT_MESSAGE_UPDATED})),[2,a]}})})},t.prototype._autoResendFileMessage=function(e){var r=this,i=new Ia,a=X.of(this._iid).dispatcher,s=Wf.of(this._iid);return n.prototype._autoResendFileMessage.call(this,e).onPending(function(u){s.completeCurrentAndProcessNextAutoResend(u),i._trigger(u)}).onFailed(function(u,d){s.completeCurrentAndProcessNextAutoResend(d),i._triggerFailed(u,d)}).onSucceeded(function(u){var d=ai.of(r._iid);s.completeCurrentAndProcessNextAutoResend(u),r._updateLastMessage(u),d.handlers.map(function(h){h.onChannelChanged&&h.onChannelChanged(r)}),a.dispatch(new pt({channels:[r],context:{source:ge.EVENT_MESSAGE_SENT}})),i._trigger(u)}),i},t.prototype.deleteMessage=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,n.prototype.deleteMessage.call(this,e)];case 1:return r.sent(),e.messageId===0&&e instanceof Lr&&X.of(this._iid).dispatcher.dispatch(new X2({reqId:e.reqId,source:ge.EVENT_MESSAGE_DELETED})),[2]}})})},t.prototype.hide=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p;return R(this,function(g){switch(g.label){case 0:return r=W(W({},vy),e),Se(function(E){return J("boolean",E.hidePreviousMessages,!0)&&J("boolean",E.allowAutoUnhide,!0)}(r)).throw(ee.invalidParameters),i=X.of(this._iid),a=i.dispatcher,s=i.sdkState,u=i.requestQueue,d=new VG(W({channelUrl:this.url,userId:s.userId},r)),[4,u.send(d)];case 1:return h=g.sent(),p=h.as(jG).messageOffsetTimestamp,this.hiddenState=r.allowAutoUnhide?Ba.HIDDEN_ALLOW_AUTO_UNHIDE:Ba.HIDDEN_PREVENT_AUTO_UNHIDE,r.hidePreviousMessages&&this._updateUnreadCount(0,0),p&&(this.messageOffsetTimestamp=p),a.dispatch(new pt({channels:[this],context:{source:ge.EVENT_CHANNEL_HIDDEN},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.unhide=function(){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return e=X.of(this._iid),r=e.dispatcher,i=e.requestQueue,a=new _V({channelUrl:this.url}),[4,i.send(a)];case 1:return s.sent(),this.hiddenState=Ba.UNHIDDEN,r.dispatch(new pt({channels:[this],context:{source:ge.EVENT_CHANNEL_UNHIDDEN},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.delete=function(){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=X.of(this._iid).requestQueue,r=new pV({channelUrl:this.url}),[4,e.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.markAsRead=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h=this;return R(this,function(p){switch(p.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.dispatcher,a=e.requestQueue,s=new k7({channelUrl:this.url}),[4,a.send(s)];case 1:return u=p.sent(),d=u.as(dM).readStatus,this._updateUnreadMemberState(r.userId,d.readAt),(this.unreadMessageCount>0||this.unreadMentionCount>0)&&(this._updateUnreadCount(0,0),ai.of(this._iid).handlers.map(function(g){g.onChannelChanged&&g.onChannelChanged(h)})),i.dispatch(new pt({channels:[this],context:{source:ge.EVENT_CHANNEL_READ}})),[2]}})})},t.prototype.markAsDelivered=function(){return M(this,void 0,void 0,function(){var e,r,i,a;return R(this,function(s){switch(s.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new QG({channelUrl:this.url,userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},t.prototype.startTyping=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return e=X.of(this._iid),r=e.requestQueue,i=e.typingIndicatorThrottle,(a=new Date().getTime())-this._typingStarted>=i?(this._typingStarted=a,this._typingEnded=0,s=new zG({channelUrl:this.url,time:this._typingStarted}),[4,r.send(s)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}})})},t.prototype.endTyping=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s;return R(this,function(u){switch(u.label){case 0:return e=X.of(this._iid),r=e.requestQueue,i=e.typingIndicatorThrottle,(a=new Date().getTime())-this._typingEnded>=i?(this._typingStarted=0,this._typingEnded=a,s=new WG({channelUrl:this.url,time:this._typingStarted}),[4,r.send(s)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}})})},t.prototype.createScheduledUserMessage=function(e){e=W(W({},HH),e),Se(BH(e)).throw(ee.invalidParameters);var r=new Ia;return this._createScheduledUserMessage(e,r),r},t.prototype.updateScheduledUserMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u;return R(this,function(d){switch(d.label){case 0:return i=W(W({},bV),r),Se(function(h){return vM(h)&&J("number",h.scheduledAt,!0)}(i)).throw(ee.invalidParameters),a=X.of(this._iid).requestQueue,s=new TV(W({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},i)),[4,a.send(s)];case 1:return u=d.sent(),[2,u.as(NM).message]}})})},t.prototype.createScheduledFileMessage=function(e){var r=this;e=W(W({},GH),e),Se(VH(e)).throw(ee.invalidParameters);var i=Date.now(),a=this._generateRequestId(),s=new Ia;return sa(_H).then(function(){var u=r._createPendingScheduledFileMessage(e,a,i);an(function(){return M(r,void 0,void 0,function(){return R(this,function(d){return[2,s._trigger(u)]})})})}),oi(e.file)?this._uploadFileAndUpdateParams(e).then(function(){return r._createScheduledFileMessage(e,s,a,i)}):this._createScheduledFileMessage(e,s,a,i),s},t.prototype.updateScheduledFileMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return i=W(W({},yV),r),Se(function(d){return oC(d)&&J("number",d.scheduledAt,!0)&&(oi(d.file)||J("string",d.fileUrl))&&J("string",d.fileName,!0)&&J("string",d.mimeType,!0)&&J("number",d.fileSize,!0)&&(d.thumbnailSizes===null||d.thumbnailSizes===void 0||d.thumbnailSizes.every(function(h){return J("object",h)&&h.maxWidth>0&&h.maxHeight>0}))}(i)).throw(ee.invalidParameters),oi(i.file)?[4,this._uploadFileAndUpdateParams(i)]:[3,2];case 1:u.sent(),u.label=2;case 2:return a=new CV(W({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},i)),[4,X.of(this._iid).requestQueue.send(a)];case 3:return s=u.sent(),[2,s.as(IV).message]}})})},t.prototype.cancelScheduledMessage=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=new SV({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,X.of(this._iid).requestQueue.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.sendScheduledMessageNow=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){switch(i.label){case 0:return r=new NV({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,X.of(this._iid).requestQueue.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.getMyPushTriggerOption=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return e=X.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new RV({userId:r.userId,channelUrl:this.url}),[4,i.send(a)];case 1:return s=d.sent(),u=s.as(MV).pushTriggerOption,this.myPushTriggerOption=u,[2,u]}})})},t.prototype.setMyPushTriggerOption=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return Se(nt(Pl,e)).throw(ee.invalidParameters),r=X.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,u=new AV({userId:a.userId,channelUrl:this.url,pushTriggerOption:e}),[4,s.send(u)];case 1:return d=p.sent(),h=d.as(wV).pushTriggerOption,this.myPushTriggerOption=h,i.dispatch(new pt({channels:[this],context:{source:ge.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,h]}})})},t.prototype.setMyCountPreference=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h;return R(this,function(p){switch(p.label){case 0:return Se(nt(Ha,e)).throw(ee.invalidParameters),r=X.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,u=new mV({channelUrl:this.url,userId:a.userId,countPreference:e}),[4,s.send(u)];case 1:return d=p.sent(),h=d.as(gV).countPreference,this.myCountPreference=h,this._updateUnreadCount(this.unreadMessageCount,this.unreadMentionCount),i.dispatch(new pt({channels:[this],context:{source:ge.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,h]}})})},t.prototype.resetMyHistory=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return e=X.of(this._iid),r=e.dispatcher,i=e.requestQueue,a=e.sdkState,s=new vV({channelUrl:this.url,locale:a.localeForChatbot}),[4,i.send(s)];case 1:return u=h.sent(),d=u.as(EV).messageOffsetTimestamp,this.messageOffsetTimestamp=d,this.lastMessage&&this.lastMessage.createdAt<d&&(this.lastMessage=null),this._updateUnreadCount(0,0),this.totalUnreadReplyCount=0,r.dispatch(new pt({channels:[this],context:{source:ge.EVENT_CHANNEL_RESET_HISTORY},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype._uploadFileAndUpdateParams=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g,E;return R(this,function(y){switch(y.label){case 0:return oi(e.file)?(r=X.of(this._iid).requestQueue,i=new Z_({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:this._generateRequestId()}),[4,r.send(i)]):[3,2];case 1:a=y.sent(),s=a.as(X_),u=s.url,d=s.fileSize,h=d===void 0?e.fileSize:d,p=s.thumbnails,g=s.requireAuth,E=g!==void 0&&g,e.fileUrl=u,e.fileSize=h,e.requireAuth=E,e._thumbnails=p,y.label=2;case 2:return[2]}})})},t.prototype.resendMessage=function(e,r){var i,a=this;if(Se(e instanceof Lr&&!e.scheduledInfo&&e.isResendable).throw(ee.invalidParameters),e.isUserMessage()){var s=(i=e.messageParams)!==null&&i!==void 0?i:oy(e),u=new Ia;return this._sendUserMessage(s,Ii.RESEND,e.reqId).onPending(function(g){u._trigger(g)}).onFailed(function(g,E){u._triggerFailed(g,E)}).onSucceeded(function(g){a._tryUpdateLastMessageAndCallEvents(a,g),u._trigger(g)}),u}if(e.isFileMessage()){var d=this._validateFailedFileMessageHasFile(e,r);Se(d).throw(ee.invalidParameters),s=ly(e,r);var h=new Ia;return this._sendFileMessage(s,Ii.RESEND,e.reqId).onPending(function(g){h._trigger(g)}).onFailed(function(g,E){h._triggerFailed(g,E)}).onSucceeded(function(g){a._tryUpdateLastMessageAndCallEvents(a,g),h._trigger(g)}),h}if(e.isMultipleFilesMessage()){s=e.messageParams;var p=new S_;return this._sendMultipleFilesMessage(s,Ii.RESEND,e.reqId).onPending(function(g){p._trigger(g)}).onFailed(function(g,E){p._triggerFailed(g,E)}).onSucceeded(function(g){a._tryUpdateLastMessageAndCallEvents(a,g),p._trigger(g)}).onFileUploaded(function(g,E,y,C){p._triggerOnFileUploaded(g,E,y,C)}),p}},t.prototype.copyMessage=function(e,r){var i=this;if(Se(e instanceof rm&&r instanceof Lr&&r.sendingStatus===jt.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(ee.invalidParameters),r.isUserMessage()){Se(!r.poll).throw(ee.notSupportedError);var a=pM(r),s=new Ia;return e._sendUserMessage(a).onPending(function(h){s._trigger(h)}).onFailed(function(h,p){s._triggerFailed(h,p)}).onSucceeded(function(h){e.isGroupChannel()&&i._tryUpdateLastMessageAndCallEvents(e,h),s._trigger(h)}),s}if(r.isFileMessage()){a=mM(r);var u=new Ia;return e._sendFileMessage(a).onPending(function(h){u._trigger(h)}).onFailed(function(h,p){u._triggerFailed(h,p)}).onSucceeded(function(h){e.isGroupChannel()&&i._tryUpdateLastMessageAndCallEvents(e,h),u._trigger(h)}),u}if(r.isMultipleFilesMessage()){if(e.isGroupChannel()){a=sH(r);var d=new S_;return e._sendMultipleFilesMessage(a,Ii.COPY).onPending(function(h){d._trigger(h)}).onFailed(function(h,p){d._triggerFailed(h,p)}).onSucceeded(function(h){i._tryUpdateLastMessageAndCallEvents(e,h),d._trigger(h)}).onFileUploaded(function(h,p,g,E){d._triggerOnFileUploaded(h,p,g,E)}),d}throw ee.channelTypeNotSupportedError}},t}(rm),tO=function(){this.onUserMuted=Kn,this.onUserUnmuted=Kn,this.onUserBanned=Kn,this.onUserUnbanned=Kn,this.onChannelChanged=Kn,this.onChannelDeleted=Kn,this.onChannelFrozen=Kn,this.onChannelUnfrozen=Kn,this.onOperatorUpdated=Kn,this.onChannelMemberCountChanged=Kn,this.onMetaDataCreated=Kn,this.onMetaDataUpdated=Kn,this.onMetaDataDeleted=Kn,this.onMetaCounterCreated=Kn,this.onMetaCounterUpdated=Kn,this.onMetaCounterDeleted=Kn,this.onMessageReceived=Kn,this.onMessageUpdated=Kn,this.onMessageDeleted=Kn,this.onMentionReceived=Kn,this.onReactionUpdated=Kn,this.onThreadInfoUpdated=Kn},_h,po={},OV=function(){function n(t){var e=t._iid,r=t.limit,i=r===void 0?100:r,a=this;this.ref=0,this._iid=e,this._limit=i;var s,u=X.of(this._iid),d=u.sdkState,h=u.dispatcher,p=u.logger,g=u.cacheContext,E=u.statManager;this._metadataKey=(s=d.userId,"sendbird:".concat(s,"@groupchannel/sync.meta"));var y=function(C){return"sendbird:".concat(C,"@groupchannel/sync")}(d.userId);this._sync=new Po(y,function(){return M(a,void 0,void 0,function(){var C,T,A,O,N,k,D,P,U,L,B,q,z,Y,Q,$;return R(this,function(Z){switch(Z.label){case 0:return C={hasNext:!0,nextToken:""},[4,this.loadMetadata()];case 1:if(Z.sent(),p.debug("channel background sync from",(U=this._metadata)===null||U===void 0?void 0:U.token),(L=this._metadata)===null||L===void 0?void 0:L.completed)return[3,14];T={includeEmpty:!0,includeMetaData:!0,order:Er.CHRONOLOGICAL},Z.label=2;case 2:if(Z.trys.push([2,9,12,13]),T.order!==Er.LATEST_LAST_MESSAGE)return[3,6];Z.label=3;case 3:return Z.trys.push([3,5,,6]),[4,g.preference.get(eC(d.appId))];case 4:return A=Z.sent(),T.includeChatNotification=!!A,[3,6];case 5:return Z.sent(),T.includeChatNotification=!1,[3,6];case 6:return[4,ai.of(this._iid).getMyGroupChannels((q=(B=this._metadata)===null||B===void 0?void 0:B.token)!==null&&q!==void 0?q:"",T,this._limit,ge.SYNC_CHANNEL_BACKGROUND)];case 7:return O=Z.sent(),N=O.channels,k=O.token,C.hasNext=N.length>=this._limit&&!!k,C.nextToken=k,this._metadata&&(this._metadata.token=k,(P=this._metadata.range).extends.apply(P,Nn([],cn(N.map(function(ne){return ne.createdAt})),!1)),this._metadata.completed=!C.hasNext),p.debug("channel background sync progress",C),[4,this.saveMetadata()];case 8:return Z.sent(),[3,13];case 9:return D=Z.sent(),p.debug("channel background sync error",D),D instanceof ee&&D.isInvalidTokenError?[4,this.clearMetaData()]:[3,11];case 10:Z.sent(),Z.label=11;case 11:throw D;case 12:return E.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:"",measured_on:"channel_back_sync",event:"cache_fetch",max_db_size:(Y=(z=g.localCacheConfig)===null||z===void 0?void 0:z.maxSize)!==null&&Y!==void 0?Y:0,use_local_cache:g.localCacheEnabled,starting_point:0,message_init_policy:($=(Q=T.order)===null||Q===void 0?void 0:Q.toString())!==null&&$!==void 0?$:"",collection_id:d.userId}})),[7];case 13:return[3,15];case 14:C.hasNext=!1,C.nextToken="",Z.label=15;case 15:return[2,C]}})})}),this._connectionEventContext=h.on(function(C){C instanceof Aa&&(C.stateType===Gt.CONNECTED?a.resume():a.pause())})}return n.of=function(t){return po[t]||(po[t]=new n({_iid:t})),po[t].ref++,po[t]},n.clear=function(t){po[t]&&(po[t].close(),delete po[t])},Object.defineProperty(n.prototype,"range",{get:function(){var t,e;return(e=(t=this._metadata)===null||t===void 0?void 0:t.range)!==null&&e!==void 0?e:new Js({})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"completed",{get:function(){var t;return!!(!((t=this._metadata)===null||t===void 0)&&t.completed)},enumerable:!1,configurable:!0}),n.prototype.loadMetadata=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:return this._metadata?[3,2]:[4,X.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:t=e.sent(),this._metadata={token:t?t.token:"",range:new Js(t?t.range:{top:Number.MAX_SAFE_INTEGER,bottom:0}),completed:!!t&&t.completed},e.label=2;case 2:return[2,this._metadata]}})})},n.prototype.saveMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return this._metadata?[4,X.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype.clearMetaData=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,X.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.resume=function(){var t,e,r=X.of(this._iid),i=r.logger;r.sessionManager.session.hasSession&&(i.debug("channel background sync resume()"),this._sync.start((e=(t=this._metadata)===null||t===void 0?void 0:t.token)!==null&&e!==void 0?e:""))},n.prototype.pause=function(){X.of(this._iid).logger.debug("channel background sync stop()"),this._sync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete po[this._iid])},n}(),_o={},kV=function(){function n(t){var e=t._iid,r=this;this.ref=0,this._iid=e;var i,a=X.of(this._iid),s=a.logger,u=a.sdkState,d=a.dispatcher,h=a.cacheContext,p=a.statManager;this._metadataKey=(i=u.userId,"sendbird:".concat(i,"@groupchannel/changelogs.meta")),this._subscribers=new rd;var g=function(E){return"sendbird:".concat(E,"@groupchannel/changelogs")}(u.userId);this._sync=new Po(g,function(){return M(r,void 0,void 0,function(){var E,y,C,T,A,O,N,k,D,P,U,L;return R(this,function(B){switch(B.label){case 0:return E={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:B.sent(),s.debug("channel changelog sync from",(P=this._metadata)===null||P===void 0?void 0:P.token),B.label=2;case 2:B.trys.push([2,9,,12]),y={includeEmpty:!0,includeMetaData:!0},B.label=3;case 3:return B.trys.push([3,5,,6]),[4,h.preference.get(eC(u.appId))];case 4:return C=B.sent(),y.includeChatNotification=!!C,[3,6];case 5:return B.sent(),y.includeChatNotification=!1,[3,6];case 6:return[4,ai.of(this._iid).getMyGroupChannelChangeLogs((L=(U=this._metadata)===null||U===void 0?void 0:U.token)!==null&&L!==void 0?L:"",y,ge.SYNC_CHANNEL_CHANGELOGS)];case 7:return T=B.sent(),A=T.updatedChannels,O=T.deletedChannelUrls,N=T.hasMore,k=T.token,this._subscribers.dispatch("progress",{updatedChannels:A,deletedChannelUrls:O,hasMore:N,token:k}),E.hasNext=N,E.nextToken=k,this._metadata&&(this._metadata.token=k),s.debug("channel changelog sync progress",E),[4,this.saveMetadata()];case 8:return B.sent(),h.localCacheEnabled&&p.put(new Or({type:gr.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:"",measured_on:"channel_change_log_sync",event:A.length>0||O.length>0?"cache_miss":"cache_hit",max_db_size:A.length,use_local_cache:h.localCacheEnabled,starting_point:0,message_init_policy:O.length.toString(),collection_id:u.userId}})),[3,12];case 9:return D=B.sent(),s.debug("channel changelog sync error",D),D instanceof ee&&D.isInvalidTokenError?[4,this.clearMetadata()]:[3,11];case 10:B.sent(),B.label=11;case 11:throw D;case 12:return[2,E]}})})}),this._sync.on("stop",function(){r._subscribers.dispatch("pause")}),this._connectionEventContext=d.on(function(E){E instanceof Aa&&(E.stateType===Gt.CONNECTED?r.resume():r.pause())})}return n.of=function(t){return _o[t]||(_o[t]=new n({_iid:t})),_o[t].ref++,_o[t]},n.clear=function(t){_o[t]&&(_o[t].close(),delete _o[t])},Object.defineProperty(n.prototype,"isRunning",{get:function(){return this._sync.isRunning},enumerable:!1,configurable:!0}),n.prototype.loadMetadata=function(){return M(this,void 0,void 0,function(){var t,e,r,i;return R(this,function(a){switch(a.label){case 0:return this._metadata?[3,2]:(t=X.of(this._iid),e=t.cacheContext,r=t.firstConnectedAt,[4,e.preference.get(this._metadataKey)]);case 1:i=a.sent(),this._metadata={token:i?i.token:r},a.label=2;case 2:return[2,this._metadata]}})})},n.prototype.saveMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return this._metadata?[4,X.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype.clearMetadata=function(){return M(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return[4,X.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.on=function(t,e){return this._subscribers.on(t,e)},n.prototype.resume=function(){X.of(this._iid).sessionManager.session.hasSession&&this._sync.start(0)},n.prototype.pause=function(){this._sync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete _o[this._iid])},n}(),M_=function(n,t){return n.findIndex(function(e){return e.isIdentical(t)})},Q1=function(n,t,e){if(n.length>0){for(var r=M_(n,t),i=0,a=n.length-1,s=Math.floor((i+a)/2);i<a;){var u=Z1(n[s],t,e);if(u>0)a=s,s=Math.floor((i+a)/2);else{if(!(u<0))return{place:s,oldPosition:r};i=s+1,s=Math.floor((i+a)/2)}}return{place:Z1(n[s],t,e)>=0?s:s+1,oldPosition:r}}return{place:n.length,oldPosition:-1}},Z1=function(n,t,e){switch(e){case Er.LATEST_LAST_MESSAGE:return n.lastMessage&&t.lastMessage?(r=t.lastMessage.createdAt-n.lastMessage.createdAt)===0?t.createdAt-n.createdAt:r:n.lastMessage?-1:t.lastMessage?1:t.createdAt-n.createdAt;case Er.CHRONOLOGICAL:return t.createdAt-n.createdAt;case Er.CHANNEL_NAME_ALPHABETICAL:var r;return(r=n.name.localeCompare(t.name))===0?n.createdAt-t.createdAt:r;default:return 0}},DV=function(){function n(t,e){var r=e.filter,i=r===void 0?new XM:r,a=e.order,s=a===void 0?Er.LATEST_LAST_MESSAGE:a,u=e.limit,d=u===void 0?AM:u,h=e.includeChangesOnInitialLoad,p=h!==void 0&&h,g=this;this.channels=[],this._isInitialized=!1,this._iid=t,this._key="gcc-".concat(Bu()),this._isDisposed=!1,this._isGetRemoteChannelsSucceeded=!0,this._includeChangesOnInitialLoad=p,this.filter=i,this.order=s,this._hasMore=!0,this._token="",this._limit=d;var E=X.of(this._iid),y=E.sdkState,C=E.cacheContext,T=E.dispatcher;C.localCacheEnabled&&(this._backgroundSync=OV.of(t),this._backgroundSync.resume()),this._changelogSync=kV.of(t),this._changelogSync.resume(),ai.of(this._iid).subscribeChannelEvent(this._key,{onUpdate:function(A,O){var N=O.source;if(R_(N)){var k=A.filter(function(P){return g.filter.match(P,y.userId)}),D=A.filter(function(P){return!g.filter.match(P,y.userId)}).map(function(P){return P.url});k.length>0&&g._addChannelsToView(k,O),D.length>0&&g._removeChannelsFromView(D,O)}},onRemove:function(A,O){g._removeChannelsFromView(A,O)}}),T.on(function(A){A instanceof Aa&&(A.stateType===Gt.CONNECTED?g._isGetRemoteChannelsSucceeded||M(g,void 0,void 0,function(){return R(this,function(O){switch(O.label){case 0:return[4,this._revokeLoadMore()];case 1:return O.sent(),[2]}})}):A.stateType===Gt.LOGOUT&&g.dispose())})}return Object.defineProperty(n.prototype,"hasMore",{get:function(){return!this._isDisposed&&this._hasMore},enumerable:!1,configurable:!0}),n.prototype.setGroupChannelCollectionHandler=function(t){this._handler=t},n.prototype._addChannelsToView=function(t,e,r){var i,a,s,u,d=this;r===void 0&&(r=!1);var h=[],p=[],g=[];try{for(var E=Le(t),y=E.next();!y.done;y=E.next()){var C=y.value,T=M_(this.channels,C);T>=0&&this.channels.splice(T,1);var A=Q1(this.channels,C,this.order).place;if(T<0)A===this.channels.length?!r&&this._hasMore||(h.push(C),this.channels.push(C)):(h.push(C),this.channels.splice(A,0,C));else switch(e.source){case ge.EVENT_CHANNEL_UPDATED:case ge.EVENT_MESSAGE_RECEIVED:case ge.SYNC_CHANNEL_CHANGELOGS:case ge.EVENT_MESSAGE_SENT:this.order===Er.CHANNEL_NAME_ALPHABETICAL&&this._hasMore&&A===this.channels.length?g.push(C):(this.channels.splice(A,0,C),p.push(C));break;default:this.channels.splice(A,0,C),p.push(C)}}}catch(D){i={error:D}}finally{try{y&&!y.done&&(a=E.return)&&a.call(E)}finally{if(i)throw i.error}}if(g.length>0)try{for(var O=Le(g),N=O.next();!N.done;N=O.next()){C=N.value;var k=M_(this.channels,C);k!==-1&&this.channels.splice(k,1)}}catch(D){s={error:D}}finally{try{N&&!N.done&&(u=O.return)&&u.call(O)}finally{if(s)throw s.error}}R_(e.source)&&an(function(){return M(d,void 0,void 0,function(){var D,P,U;return R(this,function(L){return h.length>0&&(!((D=this._handler)===null||D===void 0)&&D.onChannelsAdded)&&this._handler.onChannelsAdded(e,h),p.length>0&&(!((P=this._handler)===null||P===void 0)&&P.onChannelsUpdated)&&this._handler.onChannelsUpdated(e,p),g.length>0&&(!((U=this._handler)===null||U===void 0)&&U.onChannelsDeleted)&&this._handler.onChannelsDeleted(e,g.map(function(B){return B.url})),[2]})})})},n.prototype._removeChannelsFromView=function(t,e){var r,i,a=this,s=[],u=function(g){var E=d.channels.findIndex(function(y){return y.url===g});E>=0&&(s.push(d.channels[E].url),d.channels.splice(E,1))},d=this;try{for(var h=Le(t),p=h.next();!p.done;p=h.next())u(p.value)}catch(g){r={error:g}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return R_(e.source)&&s.length>0&&an(function(){return M(a,void 0,void 0,function(){var g;return R(this,function(E){return!((g=this._handler)===null||g===void 0)&&g.onChannelsDeleted&&this._handler.onChannelsDeleted(e,s),[2]})})}),s},n.prototype._getLocalChannels=function(){return M(this,void 0,void 0,function(){var t,e;return R(this,function(r){switch(r.label){case 0:return t=ai.of(this._iid),e=this.channels.length>0?function(i,a){var s,u,d,h;switch(a){case Er.LATEST_LAST_MESSAGE:return(u=(s=i.lastMessage)===null||s===void 0?void 0:s.createdAt)!==null&&u!==void 0?u:i.createdAt;case Er.CHRONOLOGICAL:return i.createdAt;case Er.CHANNEL_NAME_ALPHABETICAL:return i.name;default:return(h=(d=i.lastMessage)===null||d===void 0?void 0:d.createdAt)!==null&&h!==void 0?h:i.createdAt}}(this.channels[this.channels.length-1],this.order):null,[4,t.getChannelsFromCache(e,this.filter,this.order,this._limit,e?this.channels[this.channels.length-1].url:void 0)];case 1:return[2,r.sent()]}})})},n.prototype._getRemoteChannels=function(){return M(this,void 0,void 0,function(){var t,e,r;return R(this,function(i){switch(i.label){case 0:return[4,ai.of(this._iid).getMyGroupChannels(this._token,_n(W(W({},this.filter),{userIdsFilter:this.filter.userIdsFilter,searchFilter:this.filter.searchFilter,order:this.order})),this._limit)];case 1:return t=i.sent(),e=t.channels,r=t.token,this._token=r,this._hasMore=!!r,[2,e]}})})},n.prototype._revokeLoadMore=function(){return M(this,void 0,void 0,function(){var t;return R(this,function(e){switch(e.label){case 0:if(this._isDisposed)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._getRemoteChannels()];case 2:return t=e.sent(),this._isGetRemoteChannelsSucceeded=!0,this._addChannelsToView(t,{source:ge.REQUEST_CHANNEL},!0),[3,4];case 3:return e.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,4];case 4:return[2]}})})},n.prototype.loadMore=function(){var t;return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P=this;return R(this,function(U){switch(U.label){case 0:if(this._isDisposed)throw new ee({code:rn.COLLECTION_DISPOSED,message:"Collection has been disposed."});return e=null,this._includeChangesOnInitialLoad&&this.channels.length===0&&this._changelogSync.isRunning?[4,new Promise(function(L){P._changelogSyncSubscriberContext=P._changelogSync.on("progress",function(B){return L(B)}).on("pause",function(){return L(null)})})]:[3,2];case 1:e=U.sent(),(t=this._changelogSyncSubscriberContext)===null||t===void 0||t.close(),U.label=2;case 2:return r=X.of(this._iid),i=r.cacheContext,a=r.connectionManager,s=r.statManager,this._isInitialized?[3,5]:(this._isInitialized=!0,i.localCacheEnabled?[4,this._backgroundSync.loadMetadata()]:[3,4]);case 3:U.sent(),U.label=4;case 4:s.put(new bh({type:gr.FEATURE_LOCALCACHE,data:{use_local_cache:i.localCacheEnabled,collection_interface:{group_channel:!0}}})),U.label=5;case 5:return u=[],this._hasMore?!i.localCacheEnabled||a.isConnected&&!this._backgroundSync.completed?[3,7]:[4,Pr(function(){return M(P,void 0,void 0,function(){return R(this,function(L){switch(L.label){case 0:return[4,this._getLocalChannels()];case 1:return u=L.sent(),[2]}})})})]:[3,11];case 6:return U.sent(),this._hasMore=u.length>=this._limit,[3,10];case 7:return U.trys.push([7,9,,10]),[4,this._getRemoteChannels()];case 8:return u=U.sent(),this._isGetRemoteChannelsSucceeded=!0,[3,10];case 9:return U.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,10];case 10:this._addChannelsToView(u,{source:ge.REQUEST_CHANNEL},!0),U.label=11;case 11:if(e){try{for(d=Le(e.updatedChannels),h=d.next();!h.done;h=d.next())p=h.value,(A=M_(u,p))>=0?u[A]=p:(g=Q1(u,p,this.order).place,u.splice(g,0,p))}catch(L){O={error:L}}finally{try{h&&!h.done&&(N=d.return)&&N.call(d)}finally{if(O)throw O.error}}E=u.map(function(L){return L.url});try{for(y=Le(e.deletedChannelUrls),C=y.next();!C.done;C=y.next())T=C.value,(A=E.indexOf(T))>=0&&(u.splice(A,1),E.splice(A,1))}catch(L){k={error:L}}finally{try{C&&!C.done&&(D=y.return)&&D.call(y)}finally{if(k)throw k.error}}}return[2,u]}})})},n.prototype.dispose=function(){var t,e,r;this._isDisposed||(this._isDisposed=!0,this.channels.length>0&&this.channels.splice(0,this.channels.length),(t=this._backgroundSync)===null||t===void 0||t.close(),(e=this._changelogSync)===null||e===void 0||e.close(),(r=this._changelogSyncSubscriberContext)===null||r===void 0||r.close(),ai.of(this._iid).unsubscribeChannelEvent(this._key))},n}(),LV=function(n){function t(e){var r=this,i=e.token,a=e.limit,s=e.order,u=e.includeEmpty,d=e.membershipFilter,h=e.channelNameContainsFilter,p=e.channelUrlsFilter,g=e.customTypesFilter,E=e.customTypeStartsWithFilter,y=e.superChannelFilter,C=e.metadataOrderKeyFilter,T=e.metadataKey,A=e.metadataValues,O=e.metadataValueStartsWith,N=e.includeFrozen,k=e.includeMetaData;return(r=n.call(this)||this).method=Ie.GET,r.path=qi,r.params=ze(_n({token:i,limit:a,order:s,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:u,public_mode:iu.PUBLIC,public_membership_mode:d,name_contains:h,channel_urls:p,custom_types:g,custom_type_startswith:E,super_mode:y,metadata_order_key:C,metadata_key:T,metadata_values:A,metadata_value_startswith:O,show_frozen:N,show_metadata:k})),r}return j(t,n),t}(Te),xV=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.channels=[];var a=r.next,s=r.channels,u=r.ts;return i.token=a,s&&s.length>0&&(i.channels=s.map(function(d){return d.ts=u,new Qa(e,d)})),i.ts=typeof u=="number"?u:0,i}return j(t,n),t}(Me);(function(n){n.ALL="all",n.JOINED="joined"})(_h||(_h={}));var UV=function(n){function t(e,r){var i,a,s,u,d,h,p,g,E,y,C,T,A,O,N=this;return(N=n.call(this,e,r)||this).includeEmpty=!1,N.includeFrozen=!0,N.includeMetaData=!0,N.channelUrlsFilter=null,N.customTypesFilter=null,N.customTypeStartsWithFilter=null,N.channelNameContainsFilter=null,N.membershipFilter=_h.ALL,N.superChannelFilter=da.ALL,N.metadataKey=null,N.metadataValues=null,N.metadataOrderKeyFilter=null,N.metadataValueStartsWith=null,N.order=ch.CHRONOLOGICAL,N.includeEmpty=(i=r.includeEmpty)!==null&&i!==void 0&&i,N.includeFrozen=(a=r.includeFrozen)===null||a===void 0||a,N.includeMetaData=(s=r.includeMetaData)===null||s===void 0||s,N.channelUrlsFilter=(u=r.channelUrlsFilter)!==null&&u!==void 0?u:null,N.customTypesFilter=(d=r.customTypesFilter)!==null&&d!==void 0?d:null,N.customTypeStartsWithFilter=(h=r.customTypeStartsWithFilter)!==null&&h!==void 0?h:null,N.channelNameContainsFilter=(p=r.channelNameContainsFilter)!==null&&p!==void 0?p:null,N.membershipFilter=(g=r.membershipFilter)!==null&&g!==void 0?g:_h.ALL,N.superChannelFilter=(E=r.superChannelFilter)!==null&&E!==void 0?E:da.ALL,N.metadataKey=(y=r.metadataKey)!==null&&y!==void 0?y:null,N.metadataValues=(C=r.metadataValues)!==null&&C!==void 0?C:null,N.metadataOrderKeyFilter=(T=r.metadataOrderKeyFilter)!==null&&T!==void 0?T:null,N.metadataValueStartsWith=(A=r.metadataValueStartsWith)!==null&&A!==void 0?A:null,N.order=(O=r.order)!==null&&O!==void 0?O:ch.CHRONOLOGICAL,N}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("boolean",this.includeEmpty)&&J("boolean",this.includeFrozen)&&J("boolean",this.includeMetaData)&&J("string",this.channelNameContainsFilter,!0)&&tt("string",this.channelUrlsFilter,!0)&&tt("string",this.customTypesFilter,!0)&&J("string",this.customTypeStartsWithFilter,!0)&&nt(_h,this.membershipFilter)&&nt(da,this.superChannelFilter)&&nt(ch,this.order)&&J("string",this.metadataOrderKeyFilter,!0)&&J("string",this.metadataKey,!0)&&tt("string",this.metadataValues,!0)&&J("string",this.metadataValueStartsWith,!0)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,r=X.of(this._iid).requestQueue,i=new LV(_n(W(W({},this),{token:this._token}))),[4,r.send(i)]):[3,2]):[3,5];case 1:return a=h.sent(),s=a.as(xV),u=s.channels,d=s.token,this._token=d,this._hasNext=!!d,this._isLoading=!1,[2,u];case 2:return[2,e];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(Vu),Uh=function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return j(t,n),t}(function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.onUserJoined=Kn,e.onUserLeft=Kn,e.onUserReceivedInvitation=Kn,e.onUserDeclinedInvitation=Kn,e.onChannelHidden=Kn,e.onUnreadMemberStatusUpdated=Kn,e.onUndeliveredMemberStatusUpdated=Kn,e.onTypingStatusUpdated=Kn,e.onPollUpdated=Kn,e.onPollVoted=Kn,e.onPollDeleted=Kn,e.onPinnedMessageUpdated=Kn,e}return j(t,n),t}(tO)),PV=function(n){function t(e){var r=this,i=e.token,a=e.limit,s=e.order,u=e.reverse,d=e.channelUrl,h=e.messageTypeFilter,p=e.scheduledStatus;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(f2),r.params=ze(_n({token:i,limit:a,reverse:u,channel_url:d,order:s,message_type:h,status:p})),r}return j(t,n),t}(Te),FV=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.scheduledMessages=[];var a=r.next,s=r.scheduled_messages;return i.token=a,i.scheduledMessages=s.map(function(u){return Ri(e,u)}),i}return j(t,n),t}(Me),HV=function(n){function t(e,r){var i,a,s,u,d,h=this;return(h=n.call(this,e,r)||this).channelUrl=null,h.order=null,h.reverse=!1,h.scheduledStatus=null,h.messageTypeFilter=Ni.ALL,h.channelUrl=(i=r.channelUrl)!==null&&i!==void 0?i:null,h.order=(a=r.order)!==null&&a!==void 0?a:null,h.reverse=(s=r.reverse)!==null&&s!==void 0&&s,h.scheduledStatus=(u=r.scheduledStatus)!==null&&u!==void 0?u:null,h.messageTypeFilter=(d=r.messageTypeFilter)!==null&&d!==void 0?d:Ni.ALL,h}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("string",this.channelUrl,!0)&&(nt(hy,this.order)||this.order===null)&&J("boolean",this.reverse)&&(tt(To,this.scheduledStatus)||this.scheduledStatus===null)&&nt(Ni,this.messageTypeFilter)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new PV(_n(W(W({},this),{token:this._token}))),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(FV),s=a.scheduledMessages,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(Vu),rO=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.name="groupChannel",e}return j(t,n),t.prototype.init=function(e,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,u=r.requestQueue,d=r.logger,h=r.onlineDetector,p=r.cacheContext;n.prototype.init.call(this,e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:d,onlineDetector:h,cacheContext:p}),this._manager=new ai(e,{sdkState:i,cacheContext:p,dispatcher:a,sessionManager:s,requestQueue:u,logger:d})},t.prototype.createGroupChannelCollection=function(e){return e===void 0&&(e={}),new DV(this._iid,e)},t.prototype.createMyGroupChannelListQuery=function(e){return e===void 0&&(e={}),new nO(this._iid,e)},t.prototype.createPublicGroupChannelListQuery=function(e){return e===void 0&&(e={}),new UV(this._iid,e)},t.prototype.createScheduledMessageListQuery=function(e){return e===void 0&&(e={}),new HV(this._iid,e)},t.prototype.addGroupChannelHandler=function(e,r){Se(J("string",e)&&r instanceof Uh).throw(ee.invalidParameters),this._manager.addHandler(e,r)},t.prototype.removeGroupChannelHandler=function(e){Se(J("string",e)).throw(ee.invalidParameters),this._manager.removeHandler(e)},t.prototype.removeAllGroupChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildGroupChannelFromSerializedData=function(e){return this._manager.buildGroupChannelFromSerializedData(e)},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){return this._manager.buildGroupChannelListQueryFromSerializedData(e)},t.prototype.buildMemberFromSerializedData=function(e){return this._manager.buildMemberFromSerializedData(e)},t.prototype.getChannel=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return Se(J("string",e)).throw(ee.invalidParameters),[2,this._manager.getChannel(e)]})})},t.prototype.getChannelWithoutCache=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return Se(J("string",e)).throw(ee.invalidParameters),[2,this._manager.getChannelWithoutCache(e)]})})},t.prototype.getMyGroupChannelChangeLogsByToken=function(e,r){return r===void 0&&(r={}),M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},om),r),Se(J("string",e)&&_y(i)).throw(ee.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getMyGroupChannelChangeLogsByTimestamp=function(e,r){return r===void 0&&(r={}),M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:return i=W(W({},om),r),Se(J("number",e)&&_y(i)).throw(ee.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getGroupChannelCount=function(e){return M(this,void 0,void 0,function(){var r;return R(this,function(i){return r=W(W({},JM),e),Se(eO(r)).throw(ee.invalidParameters),[2,this._manager.getGroupChannelCount(r)]})})},t.prototype.getUnreadItemCount=function(e){return e===void 0&&(e={}),M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._manager.getUnreadItemCount(e)];case 1:return[2,r.sent()]}})})},t.prototype.getTotalUnreadChannelCount=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,this._manager.getTotalUnreadChannelCount()];case 1:return[2,e.sent()]}})})},t.prototype.getTotalUnreadMessageCount=function(e){return e===void 0&&(e={}),M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._manager.getTotalUnreadMessageCount(e)];case 1:return[2,r.sent()]}})})},t.prototype.getTotalScheduledMessageCount=function(e){return e===void 0&&(e={}),M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._manager.getTotalScheduledMessageCount(e)];case 1:return[2,r.sent()]}})})},t.prototype.getSubscribedTotalUnreadMessageCount=function(){return this._manager.getSubscribedTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){return this._manager.getSubscribedCustomTypeUnreadMessageCount(e)},t.prototype.createChannel=function(e){return e===void 0&&(e={}),M(this,void 0,void 0,function(){var r;return R(this,function(i){return r=W(W({},w_),e),Se(py(r)).throw(ee.invalidParameters),[2,this._manager.createChannel(r)]})})},t.prototype.createDistinctChannelIfNotExist=function(e){return e===void 0&&(e={}),M(this,void 0,void 0,function(){var r;return R(this,function(i){return r=W(W({},w_),e),Se(py(r)).throw(ee.invalidParameters),r&&(r.isDistinct=!0),[2,this.createChannel(r)]})})},t.prototype.createChannelWithUserIds=function(e,r,i,a,s,u){return r===void 0&&(r=!1),s===void 0&&(s=""),u===void 0&&(u=""),M(this,void 0,void 0,function(){var d;return R(this,function(h){return d=W(W({},w_),{invitedUserIds:e,isDistinct:r,name:i,data:s,customType:u}),typeof a=="string"?d.coverUrl=a:d.coverImage=a,[2,this.createChannel(d)]})})},t.prototype.markAsReadAll=function(){return M(this,void 0,void 0,function(){return R(this,function(e){return this._manager.markAsReadAll(),[2]})})},t.prototype.markAsReadWithChannelUrls=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return Se(tt("string",e)).throw(ee.invalidParameters),this._manager.markAsReadWithChannelUrls(e),[2]})})},t.prototype.markAsDelivered=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return Se(J("string",e)).throw(ee.invalidParameters),[4,this.getChannel(e)];case 1:return[4,r.sent().markAsDelivered()];case 2:return r.sent(),[2]}})})},t}(Om),yy=function(n,t){return yy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},yy(n,t)};function iO(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");yy(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var re=function(){return re=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},re.apply(this,arguments)};function BV(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e}function Ar(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function u(p){try{h(r.next(p))}catch(g){s(g)}}function d(p){try{h(r.throw(p))}catch(g){s(g)}}function h(p){p.done?a(p.value):i(p.value).then(u,d)}h((r=r.apply(n,t||[])).next())})}function wr(n,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=u(0),s.throw=u(1),s.return=u(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(h){return function(p){return d([h,p])}}function d(h){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,h[0]&&(e=0)),e;)try{if(r=1,i&&(a=h[0]&2?i.return:h[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,h[1])).done)return a;switch(i=0,a&&(h=[h[0]&2,a.value]),h[0]){case 0:case 1:a=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,i=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!a||h[1]>a[0]&&h[1]<a[3])){e.label=h[1];break}if(h[0]===6&&e.label<a[1]){e.label=a[1],a=h;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(h);break}a[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(n,e)}catch(p){h=[6,p],i=0}finally{r=a=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function en(n,t,e){if(e||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return n.concat(a||Array.prototype.slice.call(t))}const Rf={reactions:"reactions",message_search_v3:"message_search_v3",enable_og_tag:"enable_og_tag",enable_message_threading:"enable_message_threading",allow_broadcast_channel:"allow_broadcast_channel",allow_super_group_channel:"allow_super_group_channel"};Er.LATEST_LAST_MESSAGE;function Ph(n){const t=F.useRef(n);return t.current=n,F.useCallback((...e)=>t.current(...e),[t])}function Dt(n){return typeof n=="boolean"}function Zd(n,t){return t.includes(n)}function GV(n){return n instanceof Set}function VV(n,t){return Object.prototype.toString.call(n)===Object.prototype.toString.call(t)}function by(n){if(typeof n!="object"||n===null)return n;if(Array.isArray(n))return n.map(e=>by(e));const t={};return Object.keys(n).forEach(e=>{const r=e.replace(/_\w/g,i=>i[1].toUpperCase());t[r]=by(n[e])}),t}function aO(n,t){const e=Object.assign({},n);return Object.keys(t).forEach(r=>{Object.prototype.hasOwnProperty.call(e,r)&&VV(e[r],t[r])&&(typeof t[r]=="object"&&!Array.isArray(t[r])?e[r]=aO(e[r],t[r]):e[r]=t[r])}),e}const _C=()=>({common:{enableUsingDefaultUserProfile:!1},groupChannel:{channel:{enableMention:!1,enableOgtag:!0,enableReactions:!0,enableReactionsSupergroup:!1,enableTypingIndicator:!0,enableVoiceMessage:!1,input:{camera:{enablePhoto:!0,enableVideo:!0},enableDocument:!0,gallery:{enablePhoto:!0,enableVideo:!0}},replyType:"quote_reply",threadReplySelectType:"thread",typingIndicatorTypes:new Set(["text"]),enableFeedback:!1,enableSuggestedReplies:!1,showSuggestedRepliesFor:"last_message_only",suggestedRepliesDirection:"vertical",enableMarkdownForUserMessage:!1,enableFormTypeMessage:!1},channelList:{enableMessageReceiptStatus:!1,enableTypingIndicator:!1},setting:{enableMessageSearch:!1}},openChannel:{channel:{enableOgtag:!0,input:{camera:{enablePhoto:!0,enableVideo:!0},enableDocument:!0,gallery:{enablePhoto:!0,enableVideo:!0}}}}});function jV(n){return delete n.groupChannel.channel.typingIndicatorTypes,delete n.groupChannel.channel.enableFeedback,delete n.groupChannel.channel.enableSuggestedReplies,delete n.groupChannel.channel.showSuggestedRepliesFor,delete n.groupChannel.channel.suggestedRepliesDirection,delete n.groupChannel.channel.enableMarkdownForUserMessage,delete n.groupChannel.channel.enableFormTypeMessage,n}const sO=()=>{const n=_C();return jV(n)},X1=_C(),qV=sO();var lm=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function u(p){try{h(r.next(p))}catch(g){s(g)}}function d(p){try{h(r.throw(p))}catch(g){s(g)}}function h(p){p.done?a(p.value):i(p.value).then(u,d)}h((r=r.apply(n,t||[])).next())})};const Cy={items:{},getItem(n){var t;return lm(this,void 0,void 0,function*(){return(t=Cy.items[n])!==null&&t!==void 0?t:null})},setItem(n,t){return lm(this,void 0,void 0,function*(){Cy.items[n]=t})}};class zV{constructor(t){this.storage=t??Cy}init(t){return this.key=`sbu@${t}.uikitConfiguration`,this.get()}get safeKey(){if(!this.key)throw new Error("Please UIKitConfigManager.init() first");return this.key}update(t){return lm(this,void 0,void 0,function*(){const e=yield this.get(),r={updatedAt:t.updatedAt,configuration:aO(e.configuration,t.configuration)};return yield this.storage.setItem(this.safeKey,JSON.stringify(r)),r})}get(){return lm(this,void 0,void 0,function*(){const t={updatedAt:0,configuration:qV};try{const e=yield this.storage.getItem(this.safeKey);return e?JSON.parse(e):t}catch{return t}})}}function KV(n,t,e){var r,i;e.common&&Dt((r=e.common)===null||r===void 0?void 0:r.enableUsingDefaultUserProfile)&&(n.enableUsingDefaultUserProfile=e.common.enableUsingDefaultUserProfile),t.common&&Dt((i=t.common)===null||i===void 0?void 0:i.enableUsingDefaultUserProfile)&&(n.enableUsingDefaultUserProfile=t.common.enableUsingDefaultUserProfile)}function WV(n,t,e){$V(n,t,e),YV(n,t,e),QV(n,t,e),ZV(n,t,e)}function $V(n,t,e){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z,Y,Q,$,Z,ne,ue,pe,he,le,we,ve,Ue,be,Qe,Ne,$e,gn,En,Yn,Gn,Tn,kn,Vn,Hn,Jn,jn,On,Ln,An,wn,We,ln,Pe,Ke,yn,tn,st,Cn,Ve,Ut,mt,ut,In,Qn,Ct,Et,ct,Qt,Ot,ft,rt,xn,Oe,Ee,nn,Sn,Pn,lt,qn,Fn,At,Pt,zn,qt,cr,Fe,un,Ae,Dn,pn,it,yt,zt,Ht,Je,oe,ke,fn,bt,dt,nr,rr,Vr,Ir,bn,ot,Tt;!((r=e.groupChannel)===null||r===void 0)&&r.channel&&Dt((a=(i=e.groupChannel)===null||i===void 0?void 0:i.channel)===null||a===void 0?void 0:a.enableOgtag)&&(n.channel.enableOgtag=e.groupChannel.channel.enableOgtag),!((s=t.groupChannel)===null||s===void 0)&&s.channel&&Dt((d=(u=t.groupChannel)===null||u===void 0?void 0:u.channel)===null||d===void 0?void 0:d.enableOgtag)&&(n.channel.enableOgtag=(p=(h=t.groupChannel)===null||h===void 0?void 0:h.channel)===null||p===void 0?void 0:p.enableOgtag),!((g=e.groupChannel)===null||g===void 0)&&g.channel&&Dt((y=(E=e.groupChannel)===null||E===void 0?void 0:E.channel)===null||y===void 0?void 0:y.enableTypingIndicator)&&(n.channel.enableTypingIndicator=(T=(C=e.groupChannel)===null||C===void 0?void 0:C.channel)===null||T===void 0?void 0:T.enableTypingIndicator),!((A=t.groupChannel)===null||A===void 0)&&A.channel&&Dt((N=(O=t.groupChannel)===null||O===void 0?void 0:O.channel)===null||N===void 0?void 0:N.enableTypingIndicator)&&(n.channel.enableTypingIndicator=(D=(k=t.groupChannel)===null||k===void 0?void 0:k.channel)===null||D===void 0?void 0:D.enableTypingIndicator),!((P=e.groupChannel)===null||P===void 0)&&P.channel&&Dt((L=(U=e.groupChannel)===null||U===void 0?void 0:U.channel)===null||L===void 0?void 0:L.enableReactions)&&(n.channel.enableReactions=(q=(B=e.groupChannel)===null||B===void 0?void 0:B.channel)===null||q===void 0?void 0:q.enableReactions),!((z=t.groupChannel)===null||z===void 0)&&z.channel&&Dt((Q=(Y=t.groupChannel)===null||Y===void 0?void 0:Y.channel)===null||Q===void 0?void 0:Q.enableReactions)&&(n.channel.enableReactions=(Z=($=t.groupChannel)===null||$===void 0?void 0:$.channel)===null||Z===void 0?void 0:Z.enableReactions),!((ne=e.groupChannel)===null||ne===void 0)&&ne.channel&&Dt((pe=(ue=e.groupChannel)===null||ue===void 0?void 0:ue.channel)===null||pe===void 0?void 0:pe.enableReactionsSupergroup)&&(n.channel.enableReactionsSupergroup=(le=(he=e.groupChannel)===null||he===void 0?void 0:he.channel)===null||le===void 0?void 0:le.enableReactionsSupergroup),!((we=t.groupChannel)===null||we===void 0)&&we.channel&&Dt((Ue=(ve=t.groupChannel)===null||ve===void 0?void 0:ve.channel)===null||Ue===void 0?void 0:Ue.enableReactionsSupergroup)&&console.warn("Currently, EnableReactionsSupergroup feature is turned off by default. If you wish to use this feature, contact us: https://dashboard.sendbird.com/settings/contact_us?category=feedback_and_feature_requests&product=UIKit"),!((be=e.groupChannel)===null||be===void 0)&&be.channel&&Dt((Ne=(Qe=e.groupChannel)===null||Qe===void 0?void 0:Qe.channel)===null||Ne===void 0?void 0:Ne.enableMention)&&(n.channel.enableMention=(gn=($e=e.groupChannel)===null||$e===void 0?void 0:$e.channel)===null||gn===void 0?void 0:gn.enableMention),!((En=t.groupChannel)===null||En===void 0)&&En.channel&&Dt((Gn=(Yn=t.groupChannel)===null||Yn===void 0?void 0:Yn.channel)===null||Gn===void 0?void 0:Gn.enableMention)&&(n.channel.enableMention=(kn=(Tn=t.groupChannel)===null||Tn===void 0?void 0:Tn.channel)===null||kn===void 0?void 0:kn.enableMention),!((Vn=e.groupChannel)===null||Vn===void 0)&&Vn.channel&&Zd((Jn=(Hn=e.groupChannel)===null||Hn===void 0?void 0:Hn.channel)===null||Jn===void 0?void 0:Jn.replyType,["none","quote_reply","thread"])&&(n.channel.replyType=(On=(jn=e.groupChannel)===null||jn===void 0?void 0:jn.channel)===null||On===void 0?void 0:On.replyType),!((Ln=t.groupChannel)===null||Ln===void 0)&&Ln.channel&&Zd((wn=(An=t.groupChannel)===null||An===void 0?void 0:An.channel)===null||wn===void 0?void 0:wn.replyType,["none","quote_reply","thread"])&&(n.channel.replyType=(ln=(We=t.groupChannel)===null||We===void 0?void 0:We.channel)===null||ln===void 0?void 0:ln.replyType),!((Pe=e.groupChannel)===null||Pe===void 0)&&Pe.channel&&Zd((yn=(Ke=e.groupChannel)===null||Ke===void 0?void 0:Ke.channel)===null||yn===void 0?void 0:yn.threadReplySelectType,["thread","parent"])&&(n.channel.threadReplySelectType=(st=(tn=e.groupChannel)===null||tn===void 0?void 0:tn.channel)===null||st===void 0?void 0:st.threadReplySelectType),!((Cn=t.groupChannel)===null||Cn===void 0)&&Cn.channel&&Zd((Ut=(Ve=t.groupChannel)===null||Ve===void 0?void 0:Ve.channel)===null||Ut===void 0?void 0:Ut.threadReplySelectType,["thread","parent"])&&(n.channel.threadReplySelectType=(ut=(mt=t.groupChannel)===null||mt===void 0?void 0:mt.channel)===null||ut===void 0?void 0:ut.threadReplySelectType),!((In=e.groupChannel)===null||In===void 0)&&In.channel&&Dt((Ct=(Qn=e.groupChannel)===null||Qn===void 0?void 0:Qn.channel)===null||Ct===void 0?void 0:Ct.enableVoiceMessage)&&(n.channel.enableVoiceMessage=(ct=(Et=e.groupChannel)===null||Et===void 0?void 0:Et.channel)===null||ct===void 0?void 0:ct.enableVoiceMessage),!((Qt=t.groupChannel)===null||Qt===void 0)&&Qt.channel&&Dt((ft=(Ot=t.groupChannel)===null||Ot===void 0?void 0:Ot.channel)===null||ft===void 0?void 0:ft.enableVoiceMessage)&&(n.channel.enableVoiceMessage=(xn=(rt=t.groupChannel)===null||rt===void 0?void 0:rt.channel)===null||xn===void 0?void 0:xn.enableVoiceMessage),!((Oe=t.groupChannel)===null||Oe===void 0)&&Oe.channel&&GV((nn=(Ee=t.groupChannel)===null||Ee===void 0?void 0:Ee.channel)===null||nn===void 0?void 0:nn.typingIndicatorTypes)&&(n.channel.typingIndicatorTypes=(Pn=(Sn=t.groupChannel)===null||Sn===void 0?void 0:Sn.channel)===null||Pn===void 0?void 0:Pn.typingIndicatorTypes),!((lt=t.groupChannel)===null||lt===void 0)&&lt.channel&&Dt((Fn=(qn=t.groupChannel)===null||qn===void 0?void 0:qn.channel)===null||Fn===void 0?void 0:Fn.enableFeedback)&&(n.channel.enableFeedback=(Pt=(At=t.groupChannel)===null||At===void 0?void 0:At.channel)===null||Pt===void 0?void 0:Pt.enableFeedback),!((zn=t.groupChannel)===null||zn===void 0)&&zn.channel&&Dt((cr=(qt=t.groupChannel)===null||qt===void 0?void 0:qt.channel)===null||cr===void 0?void 0:cr.enableSuggestedReplies)&&(n.channel.enableSuggestedReplies=(un=(Fe=t.groupChannel)===null||Fe===void 0?void 0:Fe.channel)===null||un===void 0?void 0:un.enableSuggestedReplies),!((Ae=t.groupChannel)===null||Ae===void 0)&&Ae.channel&&Zd((pn=(Dn=t.groupChannel)===null||Dn===void 0?void 0:Dn.channel)===null||pn===void 0?void 0:pn.showSuggestedRepliesFor,["all_messages","last_message_only"])&&(n.channel.showSuggestedRepliesFor=(yt=(it=t.groupChannel)===null||it===void 0?void 0:it.channel)===null||yt===void 0?void 0:yt.showSuggestedRepliesFor),!((zt=t.groupChannel)===null||zt===void 0)&&zt.channel&&Zd((Je=(Ht=t.groupChannel)===null||Ht===void 0?void 0:Ht.channel)===null||Je===void 0?void 0:Je.suggestedRepliesDirection,["vertical","horizontal"])&&(n.channel.suggestedRepliesDirection=(ke=(oe=t.groupChannel)===null||oe===void 0?void 0:oe.channel)===null||ke===void 0?void 0:ke.suggestedRepliesDirection),!((fn=t.groupChannel)===null||fn===void 0)&&fn.channel&&Dt((dt=(bt=t.groupChannel)===null||bt===void 0?void 0:bt.channel)===null||dt===void 0?void 0:dt.enableMarkdownForUserMessage)&&(n.channel.enableMarkdownForUserMessage=(rr=(nr=t.groupChannel)===null||nr===void 0?void 0:nr.channel)===null||rr===void 0?void 0:rr.enableMarkdownForUserMessage),!((Vr=t.groupChannel)===null||Vr===void 0)&&Vr.channel&&Dt((bn=(Ir=t.groupChannel)===null||Ir===void 0?void 0:Ir.channel)===null||bn===void 0?void 0:bn.enableFormTypeMessage)&&(n.channel.enableFormTypeMessage=(Tt=(ot=t.groupChannel)===null||ot===void 0?void 0:ot.channel)===null||Tt===void 0?void 0:Tt.enableFormTypeMessage)}function YV(n,t,e){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z,Y,Q,$,Z,ne,ue,pe,he,le,we,ve,Ue,be,Qe,Ne,$e,gn,En,Yn,Gn,Tn,kn,Vn,Hn,Jn,jn,On,Ln,An,wn,We,ln,Pe,Ke,yn,tn,st,Cn,Ve,Ut,mt,ut,In,Qn,Ct,Et,ct,Qt,Ot,ft,rt,xn,Oe,Ee,nn,Sn,Pn,lt,qn,Fn,At,Pt,zn,qt,cr,Fe,un,Ae,Dn,pn,it,yt,zt,Ht,Je,oe,ke,fn,bt,dt;!((i=(r=e.groupChannel)===null||r===void 0?void 0:r.channel)===null||i===void 0)&&i.input&&Dt((u=(s=(a=e.groupChannel)===null||a===void 0?void 0:a.channel)===null||s===void 0?void 0:s.input)===null||u===void 0?void 0:u.enableDocument)&&(n.channel.input.enableDocument=(p=(h=(d=e.groupChannel)===null||d===void 0?void 0:d.channel)===null||h===void 0?void 0:h.input)===null||p===void 0?void 0:p.enableDocument),!((E=(g=t.groupChannel)===null||g===void 0?void 0:g.channel)===null||E===void 0)&&E.input&&Dt((T=(C=(y=t.groupChannel)===null||y===void 0?void 0:y.channel)===null||C===void 0?void 0:C.input)===null||T===void 0?void 0:T.enableDocument)&&(n.channel.input.enableDocument=(N=(O=(A=t.groupChannel)===null||A===void 0?void 0:A.channel)===null||O===void 0?void 0:O.input)===null||N===void 0?void 0:N.enableDocument),!((P=(D=(k=e.groupChannel)===null||k===void 0?void 0:k.channel)===null||D===void 0?void 0:D.input)===null||P===void 0)&&P.camera&&Dt((q=(B=(L=(U=e.groupChannel)===null||U===void 0?void 0:U.channel)===null||L===void 0?void 0:L.input)===null||B===void 0?void 0:B.camera)===null||q===void 0?void 0:q.enablePhoto)&&(n.channel.input.camera.enablePhoto=($=(Q=(Y=(z=e.groupChannel)===null||z===void 0?void 0:z.channel)===null||Y===void 0?void 0:Y.input)===null||Q===void 0?void 0:Q.camera)===null||$===void 0?void 0:$.enablePhoto),!((ue=(ne=(Z=t.groupChannel)===null||Z===void 0?void 0:Z.channel)===null||ne===void 0?void 0:ne.input)===null||ue===void 0)&&ue.camera&&Dt((we=(le=(he=(pe=t.groupChannel)===null||pe===void 0?void 0:pe.channel)===null||he===void 0?void 0:he.input)===null||le===void 0?void 0:le.camera)===null||we===void 0?void 0:we.enablePhoto)&&(n.channel.input.camera.enablePhoto=(Qe=(be=(Ue=(ve=t.groupChannel)===null||ve===void 0?void 0:ve.channel)===null||Ue===void 0?void 0:Ue.input)===null||be===void 0?void 0:be.camera)===null||Qe===void 0?void 0:Qe.enablePhoto),!((gn=($e=(Ne=e.groupChannel)===null||Ne===void 0?void 0:Ne.channel)===null||$e===void 0?void 0:$e.input)===null||gn===void 0)&&gn.camera&&Dt((Tn=(Gn=(Yn=(En=e.groupChannel)===null||En===void 0?void 0:En.channel)===null||Yn===void 0?void 0:Yn.input)===null||Gn===void 0?void 0:Gn.camera)===null||Tn===void 0?void 0:Tn.enableVideo)&&(n.channel.input.camera.enableVideo=(Jn=(Hn=(Vn=(kn=e.groupChannel)===null||kn===void 0?void 0:kn.channel)===null||Vn===void 0?void 0:Vn.input)===null||Hn===void 0?void 0:Hn.camera)===null||Jn===void 0?void 0:Jn.enableVideo),!((Ln=(On=(jn=t.groupChannel)===null||jn===void 0?void 0:jn.channel)===null||On===void 0?void 0:On.input)===null||Ln===void 0)&&Ln.camera&&Dt((ln=(We=(wn=(An=t.groupChannel)===null||An===void 0?void 0:An.channel)===null||wn===void 0?void 0:wn.input)===null||We===void 0?void 0:We.camera)===null||ln===void 0?void 0:ln.enableVideo)&&(n.channel.input.camera.enableVideo=(tn=(yn=(Ke=(Pe=t.groupChannel)===null||Pe===void 0?void 0:Pe.channel)===null||Ke===void 0?void 0:Ke.input)===null||yn===void 0?void 0:yn.camera)===null||tn===void 0?void 0:tn.enableVideo),!((Ve=(Cn=(st=e.groupChannel)===null||st===void 0?void 0:st.channel)===null||Cn===void 0?void 0:Cn.input)===null||Ve===void 0)&&Ve.gallery&&Dt((In=(ut=(mt=(Ut=e.groupChannel)===null||Ut===void 0?void 0:Ut.channel)===null||mt===void 0?void 0:mt.input)===null||ut===void 0?void 0:ut.gallery)===null||In===void 0?void 0:In.enablePhoto)&&(n.channel.input.gallery.enablePhoto=(ct=(Et=(Ct=(Qn=e.groupChannel)===null||Qn===void 0?void 0:Qn.channel)===null||Ct===void 0?void 0:Ct.input)===null||Et===void 0?void 0:Et.gallery)===null||ct===void 0?void 0:ct.enablePhoto),!((ft=(Ot=(Qt=t.groupChannel)===null||Qt===void 0?void 0:Qt.channel)===null||Ot===void 0?void 0:Ot.input)===null||ft===void 0)&&ft.gallery&&Dt((Ee=(Oe=(xn=(rt=t.groupChannel)===null||rt===void 0?void 0:rt.channel)===null||xn===void 0?void 0:xn.input)===null||Oe===void 0?void 0:Oe.gallery)===null||Ee===void 0?void 0:Ee.enablePhoto)&&(n.channel.input.gallery.enablePhoto=(lt=(Pn=(Sn=(nn=t.groupChannel)===null||nn===void 0?void 0:nn.channel)===null||Sn===void 0?void 0:Sn.input)===null||Pn===void 0?void 0:Pn.gallery)===null||lt===void 0?void 0:lt.enablePhoto),!((At=(Fn=(qn=e.groupChannel)===null||qn===void 0?void 0:qn.channel)===null||Fn===void 0?void 0:Fn.input)===null||At===void 0)&&At.gallery&&Dt((cr=(qt=(zn=(Pt=e.groupChannel)===null||Pt===void 0?void 0:Pt.channel)===null||zn===void 0?void 0:zn.input)===null||qt===void 0?void 0:qt.gallery)===null||cr===void 0?void 0:cr.enableVideo)&&(n.channel.input.gallery.enableVideo=(Dn=(Ae=(un=(Fe=e.groupChannel)===null||Fe===void 0?void 0:Fe.channel)===null||un===void 0?void 0:un.input)===null||Ae===void 0?void 0:Ae.gallery)===null||Dn===void 0?void 0:Dn.enableVideo),!((yt=(it=(pn=t.groupChannel)===null||pn===void 0?void 0:pn.channel)===null||it===void 0?void 0:it.input)===null||yt===void 0)&&yt.gallery&&Dt((oe=(Je=(Ht=(zt=t.groupChannel)===null||zt===void 0?void 0:zt.channel)===null||Ht===void 0?void 0:Ht.input)===null||Je===void 0?void 0:Je.gallery)===null||oe===void 0?void 0:oe.enableVideo)&&(n.channel.input.gallery.enableVideo=(dt=(bt=(fn=(ke=t.groupChannel)===null||ke===void 0?void 0:ke.channel)===null||fn===void 0?void 0:fn.input)===null||bt===void 0?void 0:bt.gallery)===null||dt===void 0?void 0:dt.enableVideo)}function QV(n,t,e){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D;!((r=e.groupChannel)===null||r===void 0)&&r.channelList&&Dt((a=(i=e.groupChannel)===null||i===void 0?void 0:i.channelList)===null||a===void 0?void 0:a.enableTypingIndicator)&&(n.channelList.enableTypingIndicator=e.groupChannel.channelList.enableTypingIndicator),!((s=t.groupChannel)===null||s===void 0)&&s.channelList&&Dt((d=(u=t.groupChannel)===null||u===void 0?void 0:u.channelList)===null||d===void 0?void 0:d.enableTypingIndicator)&&(n.channelList.enableTypingIndicator=(p=(h=t.groupChannel)===null||h===void 0?void 0:h.channelList)===null||p===void 0?void 0:p.enableTypingIndicator),!((g=e.groupChannel)===null||g===void 0)&&g.channelList&&Dt((y=(E=e.groupChannel)===null||E===void 0?void 0:E.channelList)===null||y===void 0?void 0:y.enableMessageReceiptStatus)&&(n.channelList.enableMessageReceiptStatus=(T=(C=e.groupChannel)===null||C===void 0?void 0:C.channelList)===null||T===void 0?void 0:T.enableMessageReceiptStatus),!((A=t.groupChannel)===null||A===void 0)&&A.channelList&&Dt((N=(O=t.groupChannel)===null||O===void 0?void 0:O.channelList)===null||N===void 0?void 0:N.enableMessageReceiptStatus)&&(n.channelList.enableMessageReceiptStatus=(D=(k=t.groupChannel)===null||k===void 0?void 0:k.channelList)===null||D===void 0?void 0:D.enableMessageReceiptStatus)}function ZV(n,t,e){var r,i,a,s,u,d,h,p;!((r=e.groupChannel)===null||r===void 0)&&r.setting&&Dt((a=(i=e.groupChannel)===null||i===void 0?void 0:i.setting)===null||a===void 0?void 0:a.enableMessageSearch)&&(n.setting.enableMessageSearch=e.groupChannel.setting.enableMessageSearch),!((s=t.groupChannel)===null||s===void 0)&&s.setting&&Dt((d=(u=t.groupChannel)===null||u===void 0?void 0:u.setting)===null||d===void 0?void 0:d.enableMessageSearch)&&(n.setting.enableMessageSearch=(p=(h=t.groupChannel)===null||h===void 0?void 0:h.setting)===null||p===void 0?void 0:p.enableMessageSearch)}function XV(n,t,e){JV(n,t,e),ej(n,t,e)}function JV(n,t,e){var r,i,a,s,u,d,h,p;!((r=e.openChannel)===null||r===void 0)&&r.channel&&Dt((a=(i=e.openChannel)===null||i===void 0?void 0:i.channel)===null||a===void 0?void 0:a.enableOgtag)&&(n.channel.enableOgtag=e.openChannel.channel.enableOgtag),!((s=t.openChannel)===null||s===void 0)&&s.channel&&Dt((d=(u=t.openChannel)===null||u===void 0?void 0:u.channel)===null||d===void 0?void 0:d.enableOgtag)&&(n.channel.enableOgtag=(p=(h=t.openChannel)===null||h===void 0?void 0:h.channel)===null||p===void 0?void 0:p.enableOgtag)}function ej(n,t,e){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z,Y,Q,$,Z,ne,ue,pe,he,le,we,ve,Ue,be,Qe,Ne,$e,gn,En,Yn,Gn,Tn,kn,Vn,Hn,Jn,jn,On,Ln,An,wn,We,ln,Pe,Ke,yn,tn,st,Cn,Ve,Ut,mt,ut,In,Qn,Ct,Et,ct,Qt,Ot,ft,rt,xn,Oe,Ee,nn,Sn,Pn,lt,qn,Fn,At,Pt,zn,qt,cr,Fe,un,Ae,Dn,pn,it,yt,zt,Ht,Je,oe,ke,fn,bt,dt;!((i=(r=e.openChannel)===null||r===void 0?void 0:r.channel)===null||i===void 0)&&i.input&&Dt((u=(s=(a=e.openChannel)===null||a===void 0?void 0:a.channel)===null||s===void 0?void 0:s.input)===null||u===void 0?void 0:u.enableDocument)&&(n.channel.input.enableDocument=(p=(h=(d=e.openChannel)===null||d===void 0?void 0:d.channel)===null||h===void 0?void 0:h.input)===null||p===void 0?void 0:p.enableDocument),!((E=(g=t.openChannel)===null||g===void 0?void 0:g.channel)===null||E===void 0)&&E.input&&Dt((T=(C=(y=t.openChannel)===null||y===void 0?void 0:y.channel)===null||C===void 0?void 0:C.input)===null||T===void 0?void 0:T.enableDocument)&&(n.channel.input.enableDocument=(N=(O=(A=t.openChannel)===null||A===void 0?void 0:A.channel)===null||O===void 0?void 0:O.input)===null||N===void 0?void 0:N.enableDocument),!((P=(D=(k=e.openChannel)===null||k===void 0?void 0:k.channel)===null||D===void 0?void 0:D.input)===null||P===void 0)&&P.camera&&Dt((q=(B=(L=(U=e.openChannel)===null||U===void 0?void 0:U.channel)===null||L===void 0?void 0:L.input)===null||B===void 0?void 0:B.camera)===null||q===void 0?void 0:q.enablePhoto)&&(n.channel.input.camera.enablePhoto=($=(Q=(Y=(z=e.openChannel)===null||z===void 0?void 0:z.channel)===null||Y===void 0?void 0:Y.input)===null||Q===void 0?void 0:Q.camera)===null||$===void 0?void 0:$.enablePhoto),!((ue=(ne=(Z=t.openChannel)===null||Z===void 0?void 0:Z.channel)===null||ne===void 0?void 0:ne.input)===null||ue===void 0)&&ue.camera&&Dt((we=(le=(he=(pe=t.openChannel)===null||pe===void 0?void 0:pe.channel)===null||he===void 0?void 0:he.input)===null||le===void 0?void 0:le.camera)===null||we===void 0?void 0:we.enablePhoto)&&(n.channel.input.camera.enablePhoto=(Qe=(be=(Ue=(ve=t.openChannel)===null||ve===void 0?void 0:ve.channel)===null||Ue===void 0?void 0:Ue.input)===null||be===void 0?void 0:be.camera)===null||Qe===void 0?void 0:Qe.enablePhoto),!((gn=($e=(Ne=e.openChannel)===null||Ne===void 0?void 0:Ne.channel)===null||$e===void 0?void 0:$e.input)===null||gn===void 0)&&gn.camera&&Dt((Tn=(Gn=(Yn=(En=e.openChannel)===null||En===void 0?void 0:En.channel)===null||Yn===void 0?void 0:Yn.input)===null||Gn===void 0?void 0:Gn.camera)===null||Tn===void 0?void 0:Tn.enableVideo)&&(n.channel.input.camera.enableVideo=(Jn=(Hn=(Vn=(kn=e.openChannel)===null||kn===void 0?void 0:kn.channel)===null||Vn===void 0?void 0:Vn.input)===null||Hn===void 0?void 0:Hn.camera)===null||Jn===void 0?void 0:Jn.enableVideo),!((Ln=(On=(jn=t.openChannel)===null||jn===void 0?void 0:jn.channel)===null||On===void 0?void 0:On.input)===null||Ln===void 0)&&Ln.camera&&Dt((ln=(We=(wn=(An=t.openChannel)===null||An===void 0?void 0:An.channel)===null||wn===void 0?void 0:wn.input)===null||We===void 0?void 0:We.camera)===null||ln===void 0?void 0:ln.enableVideo)&&(n.channel.input.camera.enableVideo=(tn=(yn=(Ke=(Pe=t.openChannel)===null||Pe===void 0?void 0:Pe.channel)===null||Ke===void 0?void 0:Ke.input)===null||yn===void 0?void 0:yn.camera)===null||tn===void 0?void 0:tn.enableVideo),!((Ve=(Cn=(st=e.openChannel)===null||st===void 0?void 0:st.channel)===null||Cn===void 0?void 0:Cn.input)===null||Ve===void 0)&&Ve.gallery&&Dt((In=(ut=(mt=(Ut=e.openChannel)===null||Ut===void 0?void 0:Ut.channel)===null||mt===void 0?void 0:mt.input)===null||ut===void 0?void 0:ut.gallery)===null||In===void 0?void 0:In.enablePhoto)&&(n.channel.input.gallery.enablePhoto=(ct=(Et=(Ct=(Qn=e.openChannel)===null||Qn===void 0?void 0:Qn.channel)===null||Ct===void 0?void 0:Ct.input)===null||Et===void 0?void 0:Et.gallery)===null||ct===void 0?void 0:ct.enablePhoto),!((ft=(Ot=(Qt=t.openChannel)===null||Qt===void 0?void 0:Qt.channel)===null||Ot===void 0?void 0:Ot.input)===null||ft===void 0)&&ft.gallery&&Dt((Ee=(Oe=(xn=(rt=t.openChannel)===null||rt===void 0?void 0:rt.channel)===null||xn===void 0?void 0:xn.input)===null||Oe===void 0?void 0:Oe.gallery)===null||Ee===void 0?void 0:Ee.enablePhoto)&&(n.channel.input.gallery.enablePhoto=(lt=(Pn=(Sn=(nn=t.openChannel)===null||nn===void 0?void 0:nn.channel)===null||Sn===void 0?void 0:Sn.input)===null||Pn===void 0?void 0:Pn.gallery)===null||lt===void 0?void 0:lt.enablePhoto),!((At=(Fn=(qn=e.openChannel)===null||qn===void 0?void 0:qn.channel)===null||Fn===void 0?void 0:Fn.input)===null||At===void 0)&&At.gallery&&Dt((cr=(qt=(zn=(Pt=e.openChannel)===null||Pt===void 0?void 0:Pt.channel)===null||zn===void 0?void 0:zn.input)===null||qt===void 0?void 0:qt.gallery)===null||cr===void 0?void 0:cr.enableVideo)&&(n.channel.input.gallery.enableVideo=(Dn=(Ae=(un=(Fe=e.openChannel)===null||Fe===void 0?void 0:Fe.channel)===null||un===void 0?void 0:un.input)===null||Ae===void 0?void 0:Ae.gallery)===null||Dn===void 0?void 0:Dn.enableVideo),!((yt=(it=(pn=t.openChannel)===null||pn===void 0?void 0:pn.channel)===null||it===void 0?void 0:it.input)===null||yt===void 0)&&yt.gallery&&Dt((oe=(Je=(Ht=(zt=t.openChannel)===null||zt===void 0?void 0:zt.channel)===null||Ht===void 0?void 0:Ht.input)===null||Je===void 0?void 0:Je.gallery)===null||oe===void 0?void 0:oe.enableVideo)&&(n.channel.input.gallery.enableVideo=(dt=(bt=(fn=(ke=t.openChannel)===null||ke===void 0?void 0:ke.channel)===null||fn===void 0?void 0:fn.input)===null||bt===void 0?void 0:bt.gallery)===null||dt===void 0?void 0:dt.enableVideo)}function nj(n,t){const e=_C();return KV(e.common,n,t),WV(e.groupChannel,n,t),XV(e.openChannel,n,t),e}function tj(n){return typeof n=="object"&&"configuration"in n&&"updated_at"in n}var rj=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function u(p){try{h(r.next(p))}catch(g){s(g)}}function d(p){try{h(r.throw(p))}catch(g){s(g)}}function h(p){p.done?a(p.value):i(p.value).then(u,d)}h((r=r.apply(n,t||[])).next())})};function Mf(n){var t,e;return(e=(t=n.appInfo)===null||t===void 0?void 0:t.applicationAttributes)!==null&&e!==void 0?e:[]}const uO=F.createContext({initDashboardConfigs:()=>Promise.resolve(),configs:X1,configsWithAppAttr:()=>X1}),ij=({storage:n,children:t,localConfigs:e={}})=>{const[r,i]=F.useState(sO),[a]=F.useState(()=>new zV(n)),s=F.useCallback(h=>rj(void 0,void 0,void 0,function*(){const p=yield a.init(h.appId);if(h.appInfo&&h.appInfo.uikitConfigInfo.lastUpdatedAt===p.updatedAt)i(p.configuration);else try{const g=yield h.getUIKitConfiguration();if(tj(g.json)){const E=by(g.json),y=yield a.update(E);i(y.configuration)}}catch{i(p.configuration)}}),[a]),u=nj(e,r),d=Ph(h=>({groupChannel:{channel:{get enableReactions(){return u.groupChannel.channel.enableReactions&&Mf(h).includes(Rf.reactions)},get enableReactionsSupergroup(){return u.groupChannel.channel.enableReactionsSupergroup&&Mf(h).includes(Rf.reactions)},get enableOgtag(){return u.groupChannel.channel.enableOgtag&&Mf(h).includes(Rf.enable_og_tag)}},setting:{get enableMessageSearch(){return u.groupChannel.setting.enableMessageSearch&&Mf(h).includes(Rf.message_search_v3)}}},openChannel:{channel:{get enableOgtag(){return u.openChannel.channel.enableOgtag&&Mf(h).includes(Rf.enable_og_tag)}}}}));return b.createElement(uO.Provider,{value:{initDashboardConfigs:s,configs:u,configsWithAppAttr:d}},t)},aj=()=>F.useContext(uO);var oO=b.createContext(null),Nr;(function(n){n.NONE="NONE",n.PENDING="PENDING",n.SENT="SENT",n.FAILED="FAILED",n.DELIVERED="DELIVERED",n.READ="READ"})(Nr||(Nr={}));var lO=function(n,t){var e,r,i,a,s;if(!t||!("sendingStatus"in t))return Nr.NONE;if(t.sendingStatus==="pending")return Nr.PENDING;if(t.sendingStatus==="failed")return Nr.FAILED;if(!((e=n==null?void 0:n.isGroupChannel)===null||e===void 0)&&e.call(n)){if(((i=(r=n).getUnreadMemberCount)===null||i===void 0?void 0:i.call(r,t))===0)return Nr.READ;if(((s=(a=n).getUndeliveredMemberCount)===null||s===void 0?void 0:s.call(a,t))===0)return Nr.DELIVERED}return t.sendingStatus==="succeeded"?Nr.SENT:Nr.NONE},sj=function(n){return/iPhone|iPad|iPod/i.test(n)},uj=function(n){return/WebKit/i.test(n)},oj=function(n){return/Chrome/i.test(n)},mC=function(n){return!oj(n)&&/Safari/i.test(n)},J1=function(n){return sj(n)&&(uj(n)||mC(n))};function dm(n){"@babel/helpers - typeof";return dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dm(n)}function Gr(n,t){if(t.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+t.length+" present")}function fa(n){Gr(1,arguments);var t=Object.prototype.toString.call(n);return n instanceof Date||dm(n)==="object"&&t==="[object Date]"?new Date(n.getTime()):typeof n=="number"||t==="[object Number]"?new Date(n):((typeof n=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var So=10,yc=100,dO=100,CE=250,cO=1e3,lj=6e5,dj=12e3,oJ=11025,eA=["audio/webm","audio/mp4","audio/mpeg","audio/ogg"],O_="sendbird-voice-player-provider-root",Iy="sendbird-global-audio-player-id",cm="Voice_message.mp3",cj="Voice_message.m4a",$l="audio/mp3;sbu_type=voice",fj="audio/x-m4a;sbu_type=voice",hj="KEY_VOICE_MESSAGE_DURATION",pj="KEY_INTERNAL_MESSAGE_TYPE",_j="voice/mp3",fO="delivery_receipt",o_="32px",mj=10,gj=25*1024*1024,IE="sendbird_message_templates_token_key",Xd="sendbird_message_templates_key",Fh="message_template",Os=Symbol("@ts-pattern/matcher"),fm="@ts-pattern/anonymous-select-key",Ty=function(n){return!!(n&&typeof n=="object")},k_=function(n){return n&&!!n[Os]},od=function n(t,e,r){if(Ty(t)){if(k_(t)){var i=t[Os]().match(e),a=i.matched,s=i.selections;return a&&s&&Object.keys(s).forEach(function(d){return r(d,s[d])}),a}if(!Ty(e))return!1;if(Array.isArray(t))return!!Array.isArray(e)&&t.length===e.length&&t.every(function(d,h){return n(d,e[h],r)});if(t instanceof Map)return e instanceof Map&&Array.from(t.keys()).every(function(d){return n(t.get(d),e.get(d),r)});if(t instanceof Set){if(!(e instanceof Set))return!1;if(t.size===0)return e.size===0;if(t.size===1){var u=Array.from(t.values())[0];return k_(u)?Array.from(e.values()).every(function(d){return n(u,d,r)}):e.has(u)}return Array.from(t.values()).every(function(d){return e.has(d)})}return Object.keys(t).every(function(d){var h,p=t[d];return(d in e||k_(h=p)&&h[Os]().matcherType==="optional")&&n(p,e[d],r)})}return Object.is(e,t)},Fo=function n(t){var e,r,i;return Ty(t)?k_(t)?(e=(r=(i=t[Os]()).getSelectionKeys)==null?void 0:r.call(i))!=null?e:[]:Array.isArray(t)?Th(t,n):Th(Object.values(t),n):[]},Th=function(n,t){return n.reduce(function(e,r){return e.concat(t(r))},[])};function nA(n){var t;return(t={})[Os]=function(){return{match:function(e){var r={},i=function(a,s){r[a]=s};return e===void 0?(Fo(n).forEach(function(a){return i(a,void 0)}),{matched:!0,selections:r}):{matched:od(n,e,i),selections:r}},getSelectionKeys:function(){return Fo(n)},matcherType:"optional"}},t}function tA(n){var t;return(t={})[Os]=function(){return{match:function(e){if(!Array.isArray(e))return{matched:!1};var r={};if(e.length===0)return Fo(n).forEach(function(a){r[a]=[]}),{matched:!0,selections:r};var i=function(a,s){r[a]=(r[a]||[]).concat([s])};return{matched:e.every(function(a){return od(n,a,i)}),selections:r}},getSelectionKeys:function(){return Fo(n)}}},t}function rA(){var n,t=[].slice.call(arguments);return(n={})[Os]=function(){return{match:function(e){var r={},i=function(a,s){r[a]=s};return{matched:t.every(function(a){return od(a,e,i)}),selections:r}},getSelectionKeys:function(){return Th(t,Fo)},matcherType:"and"}},n}function iA(){var n,t=[].slice.call(arguments);return(n={})[Os]=function(){return{match:function(e){var r={},i=function(a,s){r[a]=s};return Th(t,Fo).forEach(function(a){return i(a,void 0)}),{matched:t.some(function(a){return od(a,e,i)}),selections:r}},getSelectionKeys:function(){return Th(t,Fo)},matcherType:"or"}},n}function aA(n){var t;return(t={})[Os]=function(){return{match:function(e){return{matched:!od(n,e,function(){})}},getSelectionKeys:function(){return[]},matcherType:"not"}},t}function au(n){var t;return(t={})[Os]=function(){return{match:function(e){return{matched:!!n(e)}}}},t}function sA(){var n,t=[].slice.call(arguments),e=typeof t[0]=="string"?t[0]:void 0,r=t.length===2?t[1]:typeof t[0]=="string"?void 0:t[0];return(n={})[Os]=function(){return{match:function(i){var a,s=((a={})[e??fm]=i,a);return{matched:r===void 0||od(r,i,function(u,d){s[u]=d}),selections:s}},getSelectionKeys:function(){return[e??fm].concat(r===void 0?[]:Fo(r))}}},n}var hO=au(function(n){return!0}),vj=hO,Ej=au(function(n){return typeof n=="string"}),yj=au(function(n){return typeof n=="number"}),bj=au(function(n){return typeof n=="boolean"}),Cj=au(function(n){return typeof n=="bigint"}),Ij=au(function(n){return typeof n=="symbol"}),Tj=au(function(n){return n==null}),Sy={__proto__:null,optional:nA,array:tA,intersection:rA,union:iA,not:aA,when:au,select:sA,any:hO,_:vj,string:Ej,number:yj,boolean:bj,bigint:Cj,symbol:Ij,nullish:Tj,instanceOf:function(n){return au(function(t){return function(e){return e instanceof t}}(n))},typed:function(){return{array:tA,optional:nA,intersection:rA,union:iA,not:aA,select:sA,when:au}}};function Mi(n){return new Sj(n,[])}var Sj=function(){function n(e,r){this.value=void 0,this.cases=void 0,this.value=e,this.cases=r}var t=n.prototype;return t.with=function(){var e=[].slice.call(arguments),r=e[e.length-1],i=[e[0]],a=[];return e.length===3&&typeof e[1]=="function"?(i.push(e[0]),a.push(e[1])):e.length>2&&i.push.apply(i,e.slice(1,e.length-1)),new n(this.value,this.cases.concat([{match:function(s){var u={},d=!!(i.some(function(h){return od(h,s,function(p,g){u[p]=g})})&&a.every(function(h){return h(s)}));return{matched:d,value:d&&Object.keys(u).length?fm in u?u[fm]:u:s}},handler:r}]))},t.when=function(e,r){return new n(this.value,this.cases.concat([{match:function(i){return{matched:!!e(i),value:i}},handler:r}]))},t.otherwise=function(e){return new n(this.value,this.cases.concat([{match:function(r){return{matched:!0,value:r}},handler:e}])).run()},t.exhaustive=function(){return this.run()},t.run=function(){for(var e=this.value,r=void 0,i=0;i<this.cases.length;i++){var a=this.cases[i],s=a.match(this.value);if(s.matched){e=s.value,r=a.handler;break}}if(!r){var u;try{u=JSON.stringify(this.value)}catch{u=this.value}throw new Error("Pattern matching error: no pattern matches value "+u)}return r(e,this.value)},n}();function uA(n){Gr(1,arguments);var t=fa(n);return t.setMilliseconds(0),t}function Nj(n,t){Gr(2,arguments);var e=uA(n),r=uA(t);return e.getTime()===r.getTime()}var TE,Co={IMAGE:["image/jpeg","image/jpg","image/png","image/gif","image/svg+xml","image/webp","image/bmp"],VIDEO:["video/mpeg","video/ogg","video/webm","video/mp4"],AUDIO:["audio/aac","audio/midi","audio/x-midi","audio/mpeg","audio/ogg","audio/opus","audio/wav","audio/webm","audio/3gpp","audio/3gpp2","audio/mp3"],DOCUMENT:["text/plain","text/css","text/csv","text/html","text/calendar","text/javascript","text/xml","text/x-log","video/quicktime"],APPLICATION:["application/x-abiword","application/x-freearc","application/vnd.amazon.ebook","application/octet-stream","application/x-bzip","application/x-bzip2","application/x-cdf","application/x-csh","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-fontobject","application/epub+zip","application/gzip","application/java-archive","application/json","application/ld+json","application/vnd.apple.installer+xml","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.text","application/ogg","application/pdf","application/x-httpd-php","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.rar","application/rtf","application/x-sh","application/x-tar","application/vnd.visio","application/xhtml+xml","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/xml","application/vnd.mozilla.xul+xml","application/zip","application/x-7z-compressed"],ARCHIVE:["application/zip","application/x-rar-compressed","application/x-7z-compressed","application/x-tar","application/gzip","application/x-bzip","application/x-bzip2","application/x-xz","application/x-iso9660-image"]},Of={IMAGE:[".apng",".avif",".gif",".jpg",".jpeg",".jfif",".pjpeg",".pjp",".png",".svg",".webp",".bmp",".ico",".cur",".tif",".tiff",".heic",".heif"],VIDEO:[".mp4",".webm",".ogv",".3gp",".3g2",".avi",".mov",".wmv",".mpg",".mpeg",".m4v",".mkv"],AUDIO:[".aac",".midi",".mp3",".oga",".opus",".wav",".weba",".3gp",".3g2"],DOCUMENT:[".txt",".log",".csv",".rtf",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx"],ARCHIVE:[".zip",".rar",".7z",".tar",".gz",".bz2",".xz",".iso"]},Aj=function(n){if(Array.isArray(n)&&n.length>0){var t=n.reduce(function(e,r){var i=r.toLowerCase();switch(i){case"image":{e.push.apply(e,en(en([],Co.IMAGE,!1),Of.IMAGE,!1));break}case"video":{e.push.apply(e,en(en([],Co.VIDEO,!1),Of.VIDEO,!1));break}case"audio":{e.push.apply(e,en(en([],Co.AUDIO,!1),Of.AUDIO,!1));break}case"archive":{e.push.apply(e,en(en([],Co.ARCHIVE,!1),Of.ARCHIVE,!1));break}default:{e.push(r);break}}return e},[]);return Array.from(new Set(t)).join(",")}return en(en([],Object.values(Co).flat(),!0),Object.values(Of).flat(),!0).join(",")},Ws={ADMIN:"ADMIN",TEXT:"TEXT",FILE:"FILE",MULTIPLE_FILES:"MULTIPLE_FILES",THUMBNAIL:"THUMBNAIL",OG:"OG",UNKNOWN:"UNKNOWN"},Dl={IMAGE:"IMAGE",AUDIO:"AUDIO",VIDEO:"VIDEO",GIF:"GIF",VOICE:"VOICE",OTHERS:"OTHERS"},oA=function(n){return n===""||n===null},wj=function(n){return n==="video/quicktime"},Rj=function(n){return mC(navigator.userAgent)&&wj(n)},zu=function(n){return Co.IMAGE.indexOf(n)>=0},Ho=function(n){return Co.VIDEO.indexOf(n)>=0||Rj(n)},ld=function(n){return n==="image/gif"},Sh=function(n){return zu(n)||Ho(n)},gC=function(n){return Co.AUDIO.indexOf(n)>=0},Mj=function(){return re({},Dl)},pO=function(n){return ld(n)?Dl.GIF:zu(n)?Dl.IMAGE:Ho(n)?Dl.VIDEO:gC(n)?Dl.AUDIO:Dl.OTHERS},Nh=function(n){return n.sendingStatus==="succeeded"},lA=function(n,t){return lO(n,t)===Nr.READ},$a=function(n){return(n==null?void 0:n.sendingStatus)==="failed"},As=function(n){return(n==null?void 0:n.sendingStatus)==="pending"},Oj=function(n){return n===Nr.SENT||n===Nr.DELIVERED||n===Nr.READ},_O=function(n){return n&&(n.isAdminMessage&&typeof n.isAdminMessage=="function"?n.isAdminMessage():(n==null?void 0:n.messageType)==="admin")},ha=function(n){return n&&(n.isUserMessage&&typeof n.isUserMessage=="function"?n.isUserMessage():(n==null?void 0:n.messageType)==="user")},Xi=function(n){return!!n&&(n.isFileMessage&&typeof n.isFileMessage=="function"?n.isFileMessage():(n==null?void 0:n.messageType)==="file")},ca=function(n){return n&&(n.isMultipleFilesMessage&&typeof n.isMultipleFilesMessage=="function"?n.isMultipleFilesMessage():n.messageType==="file"&&Object.prototype.hasOwnProperty.call(n,"fileInfoList"))},mO=function(n){return!!n.parentMessageId&&!!n.parentMessage},gO=function(n){return!!n.messageForm},hm=function(n){var t;return!!(n&&(!((t=n.extendedMessagePayload)===null||t===void 0)&&t[Fh]))},vO=function(n){var t=n.type;return!(t&&!EO[t])},EO={default:"default"},kj=(TE={},TE[EO.default]="ui_container_type__default",TE),vC=function(n){return!n||!ha(n)?!1:!!n.ogMetaData&&!!(n.ogMetaData.url||n.ogMetaData.title||n.ogMetaData.description||n.ogMetaData.defaultImage)},Dj=function(n){return ha(n)},Go=function(n){return!n||!Xi(n)?!1:Sh(n.type)},yO=function(n){return!n||!Xi(n)?!1:Go(n)&&zu(n.type)},hc=function(n){return!n||!Xi(n)?!1:Go(n)&&Ho(n.type)},Ny=function(n){return!n||!Xi(n)?!1:Go(n)&&ld(n.type)},Lj=function(n){return!n||!Xi(n)?!1:gC(n.type)},xj=function(n){return n?!!n.mimeType&&(zu(n.mimeType)||ld(n.mimeType)):!1},Uj=function(n){return/^audio\//.test(n)},bO=function(n){return/^voice\//.test(n)},ou=function(n){var t,e,r,i;if(!n||!Xi(n)||!n.type)return!1;var a=n.type.split(";"),s=a[0],u=a[1];if(!Uj(s))return!1;if(u){var d=u.split("="),h=d[0],p=d[1];return h==="sbu_type"&&p==="voice"}return bO((i=(r=(e=(t=n==null?void 0:n.metaArrays)===null||t===void 0?void 0:t.find(function(g){return g.key==="KEY_INTERNAL_MESSAGE_TYPE"}))===null||e===void 0?void 0:e.value)===null||r===void 0?void 0:r[0])!==null&&i!==void 0?i:"")},CO=function(n){return ha(n)&&(n==null?void 0:n.updatedAt)>0},Pj=function(){return re({},Ws)},EC=function(n){return _O(n)?Ws.ADMIN:ha(n)?vC(n)?Ws.OG:Ws.TEXT:ca(n)?Ws.MULTIPLE_FILES:Xi(n)?Go(n)?Ws.THUMBNAIL:ou(n)?Dl.VOICE:Ws.FILE:Ws.UNKNOWN},Fj=function(n,t){return Array.isArray(t)?en(en([],n,!0),t,!0):(n.push(t),n)},ma=function(n){return Array.isArray(n)?n.reduce(Fj,[]).join(" "):n},IO=function(n,t){return t.userIds.some(function(e){return e===n})},Hj=function(n,t,e,r){var i="";return IO(t,n)&&(i=n.userIds.length===1?r.TOOLTIP__YOU:r.TOOLTIP__AND_YOU),"".concat(n.userIds.filter(function(a){return a!==t}).map(function(a){return e.get(a)||r.TOOLTIP__UNKNOWN_USER}).join(", ")).concat(i)};function TO(n){var t;return n!=null&&n.extendedMessagePayload&&Array.isArray((t=n==null?void 0:n.extendedMessagePayload)===null||t===void 0?void 0:t.suggested_replies)?n.extendedMessagePayload.suggested_replies:[]}var SO=function(n,t){if(t||(t=40),n==null)return"";if(n.length<=t)return n;var e="...",r=e.length,i=t-r,a=Math.ceil(i/2),s=Math.floor(i/2);return n.substr(0,a)+e+n.substr(n.length-s)},yC=function(n){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",n);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=n,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch{return!1}finally{document.body.removeChild(t)}}return!1},bC=function(n){var t;return(t=n==null?void 0:n.emojiCategories)===null||t===void 0?void 0:t.map(function(e){return e.emojis}).reduce(function(e,r){return e.concat(r)},[])},Bj=function(n){var t,e=new Map;return(t=n==null?void 0:n.emojiCategories)===null||t===void 0||t.forEach(function(r){var i;(i=r==null?void 0:r.emojis)===null||i===void 0||i.forEach(function(a){a&&a.key&&e.set(a.key,a)})}),e},D_=function(n,t){var e;return t?((e=n==null?void 0:n.emojiCategories)===null||e===void 0?void 0:e.filter(function(r){return t.includes(r.id)}).flatMap(function(r){return r.emojis}))||[]:bC(n)},Gj=function(n){return function(t){var e=t.key;return e===n}},Vj=function(n,t){var e,r,i=Gj(t??"");return((r=(e=n==null?void 0:n.emojiCategories.find(function(a){return a.emojis.some(i)}))===null||e===void 0?void 0:e.emojis.find(i))===null||r===void 0?void 0:r.url)||""},jj=function(n){return(n==null?void 0:n.friendName)||(n==null?void 0:n.nickname)||(n==null?void 0:n.userId)},qj=function(n){return(n==null?void 0:n.sender)&&jj(n==null?void 0:n.sender)},zj=function(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(var e=en([],n,!0).sort(),r=en([],t,!0).sort(),i=0;i<e.length;++i)if(e[i]!==r[i])return!1;return!0},dA=function(n){return n?!!(n.friendDiscoveryKey||n.friendName):!1},cA=function(n,t){var e,r,i,a,s=n.customTypesFilter,u=s===void 0?[]:s;if(n!=null&&n.messageTypeFilter&&n.messageTypeFilter!==t.messageType)return!1;if((u==null?void 0:u.length)>0){var d=u.filter(function(p){return p!=="*"});if(d.length>0&&!d.includes(t.customType))return!1}if(n!=null&&n.senderUserIdsFilter&&((e=n==null?void 0:n.senderUserIdsFilter)===null||e===void 0?void 0:e.length)>0)if(!((r=t==null?void 0:t.isUserMessage)===null||r===void 0)&&r.call(t)||!((i=t==null?void 0:t.isFileMessage)===null||i===void 0)&&i.call(t)){var h=t.sender||t._sender;if(!(!((a=n==null?void 0:n.senderUserIdsFilter)===null||a===void 0)&&a.includes(h==null?void 0:h.userId)))return!1}else return!1;return!(!(n!=null&&n.includeParentMessageInfo)&&(t!=null&&t.parentMessageId||t!=null&&t.parentMessage))},Jd=function(n,t,e){var r,i,a,s,u,d,h,p=n.includeEmpty,g=n.includeFrozen,E=n.searchFilter,y=n.userIdsFilter,C=n.customTypesFilter,T=n.channelUrlsFilter,A=n.customTypeStartsWithFilter,O=n.channelNameContainsFilter,N=n.nicknameContainsFilter,k=n.myMemberStateFilter,D=n.hiddenChannelFilter,P=n.unreadChannelFilter,U=n.publicChannelFilter,L=n.superChannelFilter,B=n.metadataKey,q=B===void 0?"":B,z=n.metadataValues,Y=z===void 0?["a","b"]:z,Q=n.metadataValueStartsWith;if(!p&&(t==null?void 0:t.lastMessage)===null)return!1;if(E!=null&&E.query&&((i=(r=E==null?void 0:E.fields)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0){var $=E.query,Z=E.fields;if($&&Z&&Z.length>0&&!Z.some(function(be){var Qe,Ne;switch(be){case"channel_name":return(Qe=t==null?void 0:t.name)===null||Qe===void 0?void 0:Qe.toLowerCase().includes($.toLowerCase());case"member_nickname":return(Ne=t==null?void 0:t.members)===null||Ne===void 0?void 0:Ne.some(function($e){return $e.nickname.toLowerCase().includes($.toLowerCase())});default:return!0}}))return!1}if(((a=y==null?void 0:y.userIds)===null||a===void 0?void 0:a.length)>0){var ne=y.includeMode,ue=y.queryType,pe=y.userIds,he=(s=t==null?void 0:t.members)===null||s===void 0?void 0:s.map(function(be){return be.userId});if(ne){if(pe.length>0)switch(ue){case"AND":{if(pe.some(function(be){return!he.includes(be)}))return!1;break}case"OR":{if(pe.every(function(be){return!he.includes(be)}))return!1;break}}}else if(pe.includes(e)||pe.push(e),((u=t==null?void 0:t.members)===null||u===void 0?void 0:u.length)>pe.length||!zj(pe,he))return!1}if(p===!1&&(t==null?void 0:t.lastMessage)===null||g===!1&&(t==null?void 0:t.isFrozen)===!0||C&&!C.includes(t==null?void 0:t.customType)||A&&!new RegExp("^".concat(A)).test(t==null?void 0:t.customType)||O&&!(!((d=t==null?void 0:t.name)===null||d===void 0)&&d.toLowerCase().includes(O.toLowerCase())))return!1;if(N){var le=N.toLowerCase();if(!((h=t==null?void 0:t.members)===null||h===void 0)&&h.every(function(be){return!be.nickname.toLowerCase().includes(le)}))return!1}if(T&&!T.includes(t==null?void 0:t.url))return!1;if(k)switch(k){case"joined_only":if((t==null?void 0:t.myMemberState)!=="joined")return!1;break;case"invited_only":if((t==null?void 0:t.myMemberState)!=="invited")return!1;break;case"invited_by_friend":if((t==null?void 0:t.myMemberState)!=="invited"||!dA(t==null?void 0:t.inviter))return!1;break;case"invited_by_non_friend":if((t==null?void 0:t.myMemberState)!=="invited"||dA(t==null?void 0:t.inviter))return!1;break}if(D)switch(D){case"unhidden_only":if(t!=null&&t.isHidden||(t==null?void 0:t.hiddenState)!=="unhidden")return!1;break;case"hidden_only":if(!(t!=null&&t.isHidden))return!1;break;case"hidden_allow_auto_unhide":if(!(t!=null&&t.isHidden)||(t==null?void 0:t.hiddenState)!=="hidden_allow_auto_unhide")return!1;break;case"hidden_prevent_auto_unhide":if(!(t!=null&&t.isHidden)||(t==null?void 0:t.hiddenState)!=="hidden_prevent_auto_unhide")return!1;break}if(P)switch(P){case"unread_message":if((t==null?void 0:t.unreadMessageCount)===0)return!1;break}if(U)switch(U){case"public":if(!(t!=null&&t.isPublic))return!1;break;case"private":if(t!=null&&t.isPublic)return!1;break}if(L)switch(L){case"super":if(!(t!=null&&t.isSuper))return!1;break;case"nonsuper":if(t!=null&&t.isSuper)return!1;break}var we=t.cachedMetaData,ve=we===void 0?{}:we;if(q&&(Y||Q)){var Ue=ve[q];if(!Ue||Y&&!Y.every(function(be){return Ue.includes(be)})||Q&&!Ue.startsWith(Q))return!1}return!0},Kj=function(n,t){var e=Mi(t).with(Er.CHANNEL_NAME_ALPHABETICAL,function(){return function(r,i){return r.name.localeCompare(i.name)}}).with(Er.CHRONOLOGICAL,function(){return function(r,i){return i.createdAt-r.createdAt}}).otherwise(function(){return function(r,i){var a,s,u,d;return((s=(a=i.lastMessage)===null||a===void 0?void 0:a.createdAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER)-((d=(u=r.lastMessage)===null||u===void 0?void 0:u.createdAt)!==null&&d!==void 0?d:Number.MIN_SAFE_INTEGER)}});return n.sort(e)},ec=function(n,t,e){var r=en([],n,!0),i=r.findIndex(function(a){return a.url===t.url});return i!==-1?r[i]=t:r.push(t),Kj(r,e??Er.LATEST_LAST_MESSAGE)},fA;(function(n){n.normal="normal",n.mention="mention",n.url="url"})(fA||(fA={}));var Wj=function(n,t){if(Array.isArray(n)&&Array.isArray(t)&&n.length===t.length){for(var e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}return!1},Hh=function(n){return!!n&&"sender"in n},$j=function(n){return Nj(n.createdAt,n.invitedAt)&&!n.lastMessage},Yj=function(n,t){return t?"ltr":n},Qj="Group Channel",Zj="AI Chatbot Widget Channel",NO=function(n){return!(n!=null&&n.name)||n.name===Qj||n.name===Zj},ur=function(){},Bh=function(n){var t={};return Object.entries(n).forEach(function(e){var r=e[0],i=e[1];i!=null&&(t[r]=i)}),t};function CC(n){var t=n;t&&(!t.startsWith("http://")&&!t.startsWith("https://")&&(t="https://"+t),window.open(t,"_blank","noopener,noreferrer"))}function Rt(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return n.filter(Boolean).join(" ")}var Xj={en:{MESSAGE_STATUS__YESTERDAY:"Yesterday",CHANNEL__MESSAGE_LIST__NOTIFICATION__NEW_MESSAGE:"new message(s) since",CHANNEL__MESSAGE_LIST__NOTIFICATION__ON:"on",CHANNEL_PREVIEW_MOBILE_LEAVE:"Leave channel",CHANNEL_SETTING__HEADER__TITLE:"Channel information",CHANNEL_SETTING__PROFILE__EDIT:"Edit",CHANNEL_SETTING__MEMBERS__TITLE:"Members",CHANNEL_SETTING__MEMBERS__SEE_ALL_MEMBERS:"All members",CHANNEL_SETTING__MEMBERS__INVITE_MEMBER:"Invite users",CHANNEL_SETTING__MEMBERS__YOU:" (You)",CHANNEL_SETTING__MEMBERS__SELECT_TITLE:"Select members",CHANNEL_SETTING__MEMBERS__OPERATOR:"Operator",CHANNEL_SETTING__LEAVE_CHANNEL__TITLE:"Leave channel",CHANNEL_SETTING__OPERATORS__TITLE:"Operators",CHANNEL_SETTING__OPERATORS__TITLE_ALL:"All operators",CHANNEL_SETTING__OPERATORS__TITLE_ADD:"Add operator",CHANNEL_SETTING__OPERATORS__ADD_BUTTON:"Add",CHANNEL_SETTING__MUTED_MEMBERS__TITLE:"Muted members",CHANNEL_SETTING__MUTED_MEMBERS__TITLE_ALL:"All muted members",CHANNEL_SETTING__NO_UNMUTED:"No muted members yet",CHANNEL_SETTING__BANNED_MEMBERS__TITLE:"Banned users",CHANNEL_SETTING__FREEZE_CHANNEL:"Freeze Channel",CHANNEL_SETTING__MODERATION__REGISTER_AS_OPERATOR:"Register as operator",CHANNEL_SETTING__MODERATION__UNREGISTER_OPERATOR:"Unregister operator",CHANNEL_SETTING__MODERATION__MUTE:"Mute",CHANNEL_SETTING__MODERATION__UNMUTE:"Unmute",CHANNEL_SETTING__MODERATION__BAN:"Ban",CHANNEL_SETTING__MODERATION__UNBAN:"Unban",CHANNEL_SETTING__MODERATION__EMPTY_BAN:"No banned members yet",CHANNEL_SETTING__MODERATION__ALL_BAN:"All banned members",OPEN_CHANNEL_CONVERSATION__TITLE_PARTICIPANTS:"participants",OPEN_CHANNEL_CONVERSATION__SELECT_PARTICIPANTS:"Select participants",OPEN_CHANNEL_LIST__TITLE:"Channels",CREATE_OPEN_CHANNEL_LIST__TITLE:"New channel profile",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__IMG_SECTION:"Channel image",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__IMG_UPLOAD:"Upload",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__TEXT_SECTION:"Channel name",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__TEXT_PLACE_HOLDER:"Enter channel name",CREATE_OPEN_CHANNEL_LIST__SUBMIT:"Create",OPEN_CHANNEL_SETTINGS__OPERATOR_TITLE:"Channel Information",OPEN_CHANNEL_SETTINGS__OPERATOR_URL:"URL",OPEN_CHANNEL_SETTINGS__PARTICIPANTS_ACCORDION_TITLE:"Participants",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_PANEL:"Delete channel",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_TITLE:"Delete channel?",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_CONTEXT:"Once deleted, this channel can't be restored.",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_SUBMIT:"Delete",OPEN_CHANNEL_SETTINGS__OPERATORS_TITLE:"Operators",OPEN_CHANNEL_SETTINGS__OPERATORS__TITLE_ADD:"Add operator",OPEN_CHANNEL_SETTINGS__OPERATORS__TITLE_ALL:"All operators",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__TITLE:"Muted participants",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__TITLE_ALL:"All muted participants",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__NO_ONE:"No muted participants yet",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__TITLE:"Banned users",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__TITLE_ALL:"All banned users",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__NO_ONE:"No banned users yet",OPEN_CHANNEL_SETTINGS__MEMBERS__YOU:" (You)",OPEN_CHANNEL_SETTINGS__MEMBERS__OPERATOR:"Operator",OPEN_CHANNEL_SETTINGS__PARTICIPANTS_TITLE:"Participants",OPEN_CHANNEL_SETTINGS__EMPTY_LIST:"No participants yet",OPEN_CHANNEL_SETTINGS__SEE_ALL:"See all participants",OPEN_CHANNEL_SETTINGS__ALL_PARTICIPANTS_TITLE:"All participants",OPEN_CHANNEL_SETTINGS__NO_TITLE:"(No title)",OPEN_CHANNEL_SETTING__MODERATION__REGISTER_AS_OPERATOR:"Register as operator",OPEN_CHANNEL_SETTING__MODERATION__UNREGISTER_OPERATOR:"Unregister operator",OPEN_CHANNEL_SETTING__MODERATION__MUTE:"Mute",OPEN_CHANNEL_SETTING__MODERATION__UNMUTE:"Unmute",OPEN_CHANNEL_SETTING__MODERATION__BAN:"Ban",OPEN_CHANNEL_SETTING__MODERATION__UNBAN:"Unban",TRYING_TO_CONNECT:"Trying to connect…",TYPING_INDICATOR__IS_TYPING:"is typing...",TYPING_INDICATOR__AND:"and",TYPING_INDICATOR__ARE_TYPING:"are typing...",TYPING_INDICATOR__MULTIPLE_TYPING:"Several people are typing...",CHANNEL_FROZEN:"Channel frozen",PLACE_HOLDER__NO_CHANNEL:"No channels",PLACE_HOLDER__WRONG:"Something went wrong",PLACE_HOLDER__RETRY_TO_CONNECT:"Retry",PLACE_HOLDER__NO_MESSAGES:"No messages",TOOLTIP__AND_YOU:", and you",TOOLTIP__YOU:"you",TOOLTIP__UNKNOWN_USER:"(no name)",UNKNOWN__UNKNOWN_MESSAGE_TYPE:"(Unknown message type)",UNKNOWN__CANNOT_READ_MESSAGE:"Cannot read this message.",UNKNOWN__TEMPLATE_ERROR:"(Template error)",FORM_VERSION_ERROR:"Form type messages are not available in this version.",UNKNOWN__CANNOT_READ_TEMPLATE:"Cannot read this template.",MESSAGE_EDITED:"(edited)",MODAL__DELETE_MESSAGE__TITLE:"Delete this message?",MODAL__CHANNEL_INFORMATION__TITLE:"Edit channel information",MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE:"Channel image",MODAL__CHANNEL_INFORMATION__UPLOAD:"Upload",MODAL__CHANNEL_INFORMATION__CHANNEL_NAME:"Channel name",MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER:"Enter name",MODAL__INVITE_MEMBER__TITLE:"Invite member",MODAL__INVITE_MEMBER__SELECTED:"selected",MODAL__CHOOSE_CHANNEL_TYPE__TITLE:"New channel",MODAL__CHOOSE_CHANNEL_TYPE__GROUP:"Group",MODAL__CHOOSE_CHANNEL_TYPE__SUPER_GROUP:"Super group",MODAL__CHOOSE_CHANNEL_TYPE__BROADCAST:"Broadcast",MODAL__CREATE_CHANNEL__TITLE:"New channel",MODAL__CREATE_CHANNEL__GROUP:"Group",MODAL__CREATE_CHANNEL__SUPER:"Super group",MODAL__CREATE_CHANNEL__BROADCAST:"Broadcast",MODAL__CREATE_CHANNEL__SELECTED:"selected",MODAL__LEAVE_CHANNEL__TITLE:"Leave this channel?",MODAL__LEAVE_CHANNEL__FOOTER:"Leave",MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED:"You're muted by the operator.",MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN:"Channel is frozen.",USER_PROFILE__MESSAGE:"Message",USER_PROFILE__USER_ID:"User ID",EDIT_PROFILE__TITLE:"My profile",EDIT_PROFILE__IMAGE_LABEL:"Profile image",EDIT_PROFILE__IMAGE_UPLOAD:"Upload",EDIT_PROFILE__NICKNAME_LABEL:"Nickname",EDIT_PROFILE__NICKNAME_PLACEHOLDER:"Enter your nickname",EDIT_PROFILE__USERID_LABEL:"User ID",EDIT_PROFILE__THEME_LABEL:"Dark theme",MESSAGE_INPUT__PLACE_HOLDER:"Enter message",MESSAGE_INPUT__PLACE_HOLDER__DISABLED:"Chat is unavailable in this channel",MESSAGE_INPUT__PLACE_HOLDER__SUGGESTED_REPLIES:"Please choose one from above",MESSAGE_INPUT__PLACE_HOLDER__MESSAGE_FORM:"Please fill out the message form.",MESSAGE_INPUT__PLACE_HOLDER__FROZEN:"Chat is unavailable in this channel",MESSAGE_INPUT__PLACE_HOLDER__MUTED:"Chat is unavailable because you're muted",MESSAGE_INPUT__PLACE_HOLDER__MUTED_SHORT:"You're muted",MESSAGE_INPUT__QUOTE_REPLY__PLACE_HOLDER:"Reply to message",BUTTON__SUBMIT:"Submit",BUTTON__CANCEL:"Cancel",BUTTON__DELETE:"Delete",BUTTON__SAVE:"Save",BUTTON__CREATE:"Create",BUTTON__INVITE:"Invite",BUTTON__OK:"OK",BADGE__OVER:"+",NO_TITLE:"No title",NO_NAME:"(No name)",NO_MEMBERS:"(No members)",LABEL__OPERATOR:"Operator",MESSAGE_MENU__COPY:"Copy",MESSAGE_MENU__REPLY:"Reply",MESSAGE_MENU__THREAD:"Reply in thread",MESSAGE_MENU__OPEN_IN_CHANNEL:"Open in channel",MESSAGE_MENU__EDIT:"Edit",MESSAGE_MENU__RESEND:"Resend",MESSAGE_MENU__DELETE:"Delete",MESSAGE_MENU__SAVE:"Save",CONTEXT_MENU_DROPDOWN__COPY:"Copy",CONTEXT_MENU_DROPDOWN__EDIT:"Edit",CONTEXT_MENU_DROPDOWN__RESEND:"Resend",CONTEXT_MENU_DROPDOWN__DELETE:"Delete",CONTEXT_MENU_DROPDOWN__SAVE:"Save",SEARCH:"Search",SEARCH_IN_CHANNEL:"Search in channel",SEARCH_IN:"Search in",SEARCHING:"Searching for messages...",NO_SEARCHED_MESSAGE:"No results found.",QUOTE_MESSAGE_INPUT__REPLY_TO:"Reply to",QUOTE_MESSAGE_INPUT__FILE_TYPE_IMAGE:"Photo",QUOTE_MESSAGE_INPUT__FILE_TYPE_GIF:"GIF",QUOTE_MESSAGE_INPUT__FILE_TYPE__VIDEO:"Video",QUOTED_MESSAGE__REPLIED_TO:"replied to",QUOTED_MESSAGE__CURRENT_USER:"You",QUOTED_MESSAGE__UNAVAILABLE:"Message unavailable",THREAD__HEADER_TITLE:"Thread",CHANNEL__THREAD_REPLY:"reply",CHANNEL__THREAD_REPLIES:"replies",CHANNEL__THREAD_OVER_MAX:"99+",THREAD__THREAD_REPLY:"reply",THREAD__THREAD_REPLIES:"replies",THREAD__INPUT__REPLY_TO_THREAD:"Reply to thread",THREAD__INPUT__REPLY_IN_THREAD:"Reply in thread",MENTION_NAME__NO_NAME:"(No name)",MENTION_COUNT__OVER_LIMIT:"You can mention up to %d times at a time.",UI__FILE_VIEWER__UNSUPPORT:"Unsupported message",VOICE_RECORDING_PERMISSION_DENIED:`You cannot record the voice since
        voice recording is not permitted in your device system setting`,VOICE_MESSAGE:"Voice Message",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GIF:"GIF",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO:"Photo",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VIDEO:"Video",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_AUDIO:"Audio",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VOICE_MESSAGE:"Voice message",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GENERAL:"File",CHANNEL_PREVIEW_LAST_MESSAGE_TEMPLATE_MESSAGE:"Message",DATE_FORMAT__MESSAGE_LIST__NOTIFICATION__UNREAD_SINCE:"p 'on' MMM dd",DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR:"MMMM dd, yyyy",DATE_FORMAT__THREAD_LIST__DATE_SEPARATOR:"MMM dd, yyyy",DATE_FORMAT__MESSAGE_CREATED_AT:"p",DATE_FORMAT__UNREAD_SINCE:"p MMM dd",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__TODAY:"p",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__THIS_YEAR:"MMM d",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__PREVIOUS_YEAR:"yyyy/M/d",FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT:"Up to %d files can be attached.",FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT:"The maximum size per file is %d MB.",FEEDBACK_LIKE:"Like",FEEDBACK_DISLIKE:"Dislike",EDIT_COMMENT:"Edit comment",REMOVE_FEEDBACK:"Remove Feedback",FEEDBACK_MODAL_TITLE:"Provide additional feedback (optional)",FEEDBACK_CONTENT_PLACEHOLDER:"Leave a comment",BUTTON__REMOVE_FEEDBACK:"Remove feedback",FEEDBACK_FAILED_SUBMIT:"Couldn’t submit. Try again.",FEEDBACK_FAILED_SAVE:"Couldn’t save. Try again.",FEEDBACK_FAILED_DELETE:"Couldn’t delete. Try again.",FORM_ITEM_REQUIRED:"This field is required",FORM_ITEM_INVALID:"Please check the value",FORM_ITEM_OPTIONAL_EMPTY:"No Response"}},IC=function(n){return Xj[n]},Jj={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},e9=function(t,e,r){var i,a=Jj[t];return typeof a=="string"?i=a:e===1?i=a.one:i=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function SE(n){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.width?String(t.width):n.defaultWidth,r=n.formats[e]||n.formats[n.defaultWidth];return r}}var n9={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},t9={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},r9={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},i9={date:SE({formats:n9,defaultWidth:"full"}),time:SE({formats:t9,defaultWidth:"full"}),dateTime:SE({formats:r9,defaultWidth:"full"})},a9={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},s9=function(t,e,r,i){return a9[t]};function kf(n){return function(t,e){var r=e!=null&&e.context?String(e.context):"standalone",i;if(r==="formatting"&&n.formattingValues){var a=n.defaultFormattingWidth||n.defaultWidth,s=e!=null&&e.width?String(e.width):a;i=n.formattingValues[s]||n.formattingValues[a]}else{var u=n.defaultWidth,d=e!=null&&e.width?String(e.width):n.defaultWidth;i=n.values[d]||n.values[u]}var h=n.argumentCallback?n.argumentCallback(t):t;return i[h]}}var u9={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},o9={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},l9={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},d9={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},c9={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},f9={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},h9=function(t,e){var r=Number(t),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},p9={ordinalNumber:h9,era:kf({values:u9,defaultWidth:"wide"}),quarter:kf({values:o9,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:kf({values:l9,defaultWidth:"wide"}),day:kf({values:d9,defaultWidth:"wide"}),dayPeriod:kf({values:c9,defaultWidth:"wide",formattingValues:f9,defaultFormattingWidth:"wide"})};function Df(n){return function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.width,i=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],a=t.match(i);if(!a)return null;var s=a[0],u=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],d=Array.isArray(u)?m9(u,function(g){return g.test(s)}):_9(u,function(g){return g.test(s)}),h;h=n.valueCallback?n.valueCallback(d):d,h=e.valueCallback?e.valueCallback(h):h;var p=t.slice(s.length);return{value:h,rest:p}}}function _9(n,t){for(var e in n)if(n.hasOwnProperty(e)&&t(n[e]))return e}function m9(n,t){for(var e=0;e<n.length;e++)if(t(n[e]))return e}function g9(n){return function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.match(n.matchPattern);if(!r)return null;var i=r[0],a=t.match(n.parsePattern);if(!a)return null;var s=n.valueCallback?n.valueCallback(a[0]):a[0];s=e.valueCallback?e.valueCallback(s):s;var u=t.slice(i.length);return{value:s,rest:u}}}var v9=/^(\d+)(th|st|nd|rd)?/i,E9=/\d+/i,y9={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},b9={any:[/^b/i,/^(a|c)/i]},C9={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},I9={any:[/1/i,/2/i,/3/i,/4/i]},T9={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},S9={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},N9={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},A9={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},w9={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},R9={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},M9={ordinalNumber:g9({matchPattern:v9,parsePattern:E9,valueCallback:function(t){return parseInt(t,10)}}),era:Df({matchPatterns:y9,defaultMatchWidth:"wide",parsePatterns:b9,defaultParseWidth:"any"}),quarter:Df({matchPatterns:C9,defaultMatchWidth:"wide",parsePatterns:I9,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Df({matchPatterns:T9,defaultMatchWidth:"wide",parsePatterns:S9,defaultParseWidth:"any"}),day:Df({matchPatterns:N9,defaultMatchWidth:"wide",parsePatterns:A9,defaultParseWidth:"any"}),dayPeriod:Df({matchPatterns:w9,defaultMatchWidth:"any",parsePatterns:R9,defaultParseWidth:"any"})},AO={code:"en-US",formatDistance:e9,formatLong:i9,formatRelative:s9,localize:p9,match:M9,options:{weekStartsOn:0,firstWeekContainsDate:1}},wO={stringSet:IC("en"),dateLocale:AO},kr=b.createContext(wO),O9=function(n){var t=n.children;return b.createElement(kr.Provider,{value:re(re({},wO),n)},t)},Bt=function(){var n=b.useContext(kr);if(!n)throw new Error("`useLocalization` hook must be used within `SendbirdProvider` that includes `LocalizationProvider`.");return n},k9=!1,RO="sendbird--mobile-mode",MO=b.createContext({breakpoint:k9,isMobile:!1}),hA=function(){try{var n=document.querySelector("body");n==null||n.classList.add(RO)}catch{}},pA=function(){try{var n=document.querySelector("body");n==null||n.classList.remove(RO)}catch{}},D9=function(n){var t=n.children,e=n.logger,r=(n==null?void 0:n.breakpoint)||!1,i=F.useState(!1),a=i[0],s=i[1];return F.useEffect(function(){var u,d=function(){var h;if(typeof r=="boolean")s(r),r?hA():pA();else{var p=window.matchMedia("(max-width: ".concat(r,")"));(h=e==null?void 0:e.info)===null||h===void 0||h.call(e,"MediaQueryProvider: Screensize updated to ".concat(r)),p.matches?(s(!0),hA()):(s(!1),pA())}};return d(),window.addEventListener("resize",d),(u=e==null?void 0:e.info)===null||u===void 0||u.call(e,"MediaQueryProvider: addEventListener",{updateSize:d}),function(){var h;window.removeEventListener("resize",d),(h=e==null?void 0:e.info)===null||h===void 0||h.call(e,"MediaQueryProvider: removeEventListener",{updateSize:d})}},[r]),b.createElement(MO.Provider,{value:{breakpoint:r,isMobile:a}},t)},Zi=function(){return b.useContext(MO)},Fu=b.forwardRef(function(n,t){var e=n.className,r=e===void 0?"":e,i=n.children,a=n.disabled,s=a===void 0?!1:a,u=n.width,d=u===void 0?"56px":u,h=n.height,p=h===void 0?"56px":h,g=n.type,E=g===void 0?"button":g,y=n.style,C=y===void 0?{}:y,T=n.onBlur,A=T===void 0?function(){}:T,O=n.onClick,N=O===void 0?function(){}:O,k=n.testID,D=F.useState(!1),P=D[0],U=D[1];return b.createElement("button",{"data-testid":k,className:en(en([],Array.isArray(r)?r:[r],!0),["sendbird-iconbutton",P?"sendbird-iconbutton--pressed":""],!1).join(" "),disabled:s,ref:t,type:E,style:re(re({},C),{height:p,width:d}),onClick:function(L){s||(U(!0),N==null||N(L))},onBlur:function(L){U(!1),A==null||A(L)}},b.createElement("span",{className:"sendbird-iconbutton__inner"},i))}),Da={H_1:"H_1",H_2:"H_2",SUBTITLE_1:"SUBTITLE_1",SUBTITLE_2:"SUBTITLE_2",BODY_1:"BODY_1",BODY_2:"BODY_2",BUTTON_1:"BUTTON_1",BUTTON_2:"BUTTON_2",BUTTON_3:"BUTTON_3",CAPTION_1:"CAPTION_1",CAPTION_2:"CAPTION_2",CAPTION_3:"CAPTION_3"},La={ONBACKGROUND_1:"ONBACKGROUND_1",ONBACKGROUND_2:"ONBACKGROUND_2",ONBACKGROUND_3:"ONBACKGROUND_3",ONBACKGROUND_4:"ONBACKGROUND_4",ONCONTENT_1:"ONCONTENT_1",ONCONTENT_2:"ONCONTENT_2",ONCONTENT_3:"ONCONTENT_3",ONCONTENT_INVERSE_1:"ONCONTENT_INVERSE_1",ONCONTENT_INVERSE_3:"ONCONTENT_INVERSE_3",PRIMARY:"PRIMARY",ERROR:"ERROR",SECONDARY_3:"SECONDARY_3"};function L9(n){switch(n){case Da.H_1:return"sendbird-label--h-1";case Da.H_2:return"sendbird-label--h-2";case Da.SUBTITLE_1:return"sendbird-label--subtitle-1";case Da.SUBTITLE_2:return"sendbird-label--subtitle-2";case Da.BODY_1:return"sendbird-label--body-1";case Da.BODY_2:return"sendbird-label--body-2";case Da.BUTTON_1:return"sendbird-label--button-1";case Da.BUTTON_2:return"sendbird-label--button-2";case Da.BUTTON_3:return"sendbird-label--button-3";case Da.CAPTION_1:return"sendbird-label--caption-1";case Da.CAPTION_2:return"sendbird-label--caption-2";case Da.CAPTION_3:return"sendbird-label--caption-3";default:return""}}function OO(n){switch(n){case La.ONBACKGROUND_1:return"sendbird-label--color-onbackground-1";case La.ONBACKGROUND_2:return"sendbird-label--color-onbackground-2";case La.ONBACKGROUND_3:return"sendbird-label--color-onbackground-3";case La.ONBACKGROUND_4:return"sendbird-label--color-onbackground-4";case La.ONCONTENT_1:return"sendbird-label--color-oncontent-1";case La.ONCONTENT_2:return"sendbird-label--color-oncontent-2";case La.ONCONTENT_3:return"sendbird-label--color-oncontent-3";case La.ONCONTENT_INVERSE_1:return"sendbird-label--color-oncontent-inverse-1";case La.ONCONTENT_INVERSE_3:return"sendbird-label--color-oncontent-inverse-3";case La.PRIMARY:return"sendbird-label--color-primary";case La.ERROR:return"sendbird-label--color-error";case La.SECONDARY_3:return"sendbird-label--color-secondary-3";default:return""}}var Ge=F.forwardRef(function(n,t){var e=n.className,r=e===void 0?[]:e,i=n.type,a=n.color,s=n.children,u=s===void 0?null:s,d=n.testID;return b.createElement("span",{className:en(en([],Array.isArray(r)?r:[r],!0),["sendbird-label",L9(i),OO(a)],!1).join(" "),ref:t,"data-testid":d},u)}),Be=Da,Re=La,dd=IC("en"),Br;(function(n){n.PRIMARY="PRIMARY",n.SECONDARY="SECONDARY",n.DANGER="DANGER",n.DISABLED="DISABLED",n.WARNING="WARNING"})(Br||(Br={}));var Bo;(function(n){n.BIG="BIG",n.SMALL="SMALL"})(Bo||(Bo={}));function x9(n){switch(n){case Br.PRIMARY:return"sendbird-button--primary";case Br.SECONDARY:return"sendbird-button--secondary";case Br.DANGER:return"sendbird-button--danger";case Br.DISABLED:return"sendbird-button--disabled";case Br.WARNING:return"sendbird-button--warning";default:return""}}function U9(n){switch(n){case Bo.BIG:return"sendbird-button--big";case Bo.SMALL:return"sendbird-button--small";default:return""}}function ws(n){var t=n.className,e=n.type,r=e===void 0?Br.PRIMARY:e,i=n.size,a=i===void 0?Bo.BIG:i,s=n.children,u=s===void 0?"Button":s,d=n.disabled,h=d===void 0?!1:d,p=n.onClick,g=p===void 0?function(){}:p,E=n.labelType,y=E===void 0?Be.BUTTON_1:E,C=n.labelColor,T=C===void 0?Re.ONCONTENT_1:C,A=en(en([],Array.isArray(t)?t:[t],!0),["sendbird-button",h?"sendbird-button__disabled":"",x9(r),U9(a)],!1).join(" ");return b.createElement("button",{className:A,type:"button",onClick:g,disabled:h},b.createElement(Ge,{className:"sendbird-button__text",type:y,color:T},u))}var xe={ADD:"ADD",ARROW_LEFT:"ARROW_LEFT",ATTACH:"ATTACH",AUDIO_ON_LINED:"AUDIO_ON_LINED",BAN:"BAN",BROADCAST:"BROADCAST",CAMERA:"CAMERA",CHANNELS:"CHANNELS",CHAT:"CHAT",CHAT_FILLED:"CHAT_FILLED",CHEVRON_DOWN:"CHEVRON_DOWN",CHEVRON_RIGHT:"CHEVRON_RIGHT",CLOSE:"CLOSE",COLLAPSE:"COLLAPSE",COPY:"COPY",CREATE:"CREATE",DELETE:"DELETE",DISCONNECTED:"DISCONNECTED",DOCUMENT:"DOCUMENT",DONE:"DONE",DONE_ALL:"DONE_ALL",DOWNLOAD:"DOWNLOAD",EDIT:"EDIT",EMOJI_MORE:"EMOJI_MORE",ERROR:"ERROR",EXPAND:"EXPAND",FILE_AUDIO:"FILE_AUDIO",FILE_DOCUMENT:"FILE_DOCUMENT",FREEZE:"FREEZE",GIF:"GIF",INFO:"INFO",LEAVE:"LEAVE",MEMBERS:"MEMBERS",MESSAGE:"MESSAGE",MODERATIONS:"MODERATIONS",MORE:"MORE",MUTE:"MUTE",NOTIFICATIONS:"NOTIFICATIONS",NOTIFICATIONS_OFF_FILLED:"NOTIFICATIONS_OFF_FILLED",OPERATOR:"OPERATOR",PHOTO:"PHOTO",PLAY:"PLAY",PLUS:"PLUS",QUESTION:"QUESTION",REFRESH:"REFRESH",REPLY:"REPLY",REMOVE:"REMOVE",SEARCH:"SEARCH",SEND:"SEND",SETTINGS_FILLED:"SETTINGS_FILLED",SLIDE_LEFT:"SLIDE_LEFT",SPINNER:"SPINNER",SUPERGROUP:"SUPERGROUP",THREAD:"THREAD",THUMBNAIL_NONE:"THUMBNAIL_NONE",TOGGLE_OFF:"TOGGLE_OFF",TOGGLE_ON:"TOGGLE_ON",USER:"USER",FEEDBACK_LIKE:"FEEDBACK_LIKE",FEEDBACK_DISLIKE:"FEEDBACK_DISLIKE"},fi={DEFAULT:"DEFAULT",PRIMARY:"PRIMARY",PRIMARY_2:"PRIMARY_2",SECONDARY:"SECONDARY",SECONDARY_2:"SECONDARY_2",CONTENT:"CONTENT",CONTENT_INVERSE:"CONTENT_INVERSE",CONTENT_INVERSE_3:"CONTENT_INVERSE_3",WHITE:"WHITE",GRAY:"GRAY",THUMBNAIL_ICON:"THUMBNAIL_ICON",SENT:"SENT",READ:"READ",ON_BACKGROUND_1:"ON_BACKGROUND_1",ON_BACKGROUND_2:"ON_BACKGROUND_2",ON_BACKGROUND_3:"ON_BACKGROUND_3",ON_BACKGROUND_4:"ON_BACKGROUND_4",BACKGROUND_3:"BACKGROUND_3",ERROR:"ERROR"};function P9(n){switch(n){case fi.PRIMARY:return"sendbird-icon-color--primary";case fi.PRIMARY_2:return"sendbird-icon-color--primary-2";case fi.SECONDARY:return"sendbird-icon-color--secondary";case fi.SECONDARY_2:return"sendbird-icon-color--secondary-2";case fi.CONTENT:return"sendbird-icon-color--content";case fi.CONTENT_INVERSE:return"sendbird-icon-color--content-inverse";case fi.CONTENT_INVERSE_3:return"sendbird-icon-color--content-inverse-3";case fi.WHITE:return"sendbird-icon-color--white";case fi.GRAY:return"sendbird-icon-color--gray";case fi.THUMBNAIL_ICON:return"sendbird-icon-color--thumbnail-icon";case fi.SENT:return"sendbird-icon-color--sent";case fi.READ:return"sendbird-icon-color--read";case fi.ON_BACKGROUND_1:return"sendbird-icon-color--on-background-1";case fi.ON_BACKGROUND_2:return"sendbird-icon-color--on-background-2";case fi.ON_BACKGROUND_3:return"sendbird-icon-color--on-background-3";case fi.ON_BACKGROUND_4:return"sendbird-icon-color--on-background-4";case fi.BACKGROUND_3:return"sendbird-icon-color--background-3";case fi.ERROR:return"sendbird-icon-color--error";default:return""}}function F9(n){switch(n){case xe.ADD:return"sendbird-icon-add";case xe.ARROW_LEFT:return"sendbird-icon-arrow-left";case xe.ATTACH:return"sendbird-icon-attach";case xe.AUDIO_ON_LINED:return"sendbird-icon-audio-on-lined";case xe.BAN:return"sendbird-icon-ban";case xe.BROADCAST:return"sendbird-icon-broadcast";case xe.CAMERA:return"sendbird-icon-camera";case xe.CHANNELS:return"sendbird-icon-channels";case xe.CHAT:return"sendbird-icon-chat";case xe.CHAT_FILLED:return"sendbird-icon-chat-filled";case xe.CHEVRON_DOWN:return"sendbird-icon-chevron-down";case xe.CHEVRON_RIGHT:return"sendbird-icon-chevron-right";case xe.CLOSE:return"sendbird-icon-close";case xe.COLLAPSE:return"sendbird-icon-collapse";case xe.COPY:return"sendbird-icon-copy";case xe.CREATE:return"sendbird-icon-create";case xe.DELETE:return"sendbird-icon-delete";case xe.DISCONNECTED:return"sendbird-icon-disconnected";case xe.DOCUMENT:return"sendbird-icon-document";case xe.DONE:return"sendbird-icon-done";case xe.DONE_ALL:return"sendbird-icon-done-all";case xe.DOWNLOAD:return"sendbird-icon-down-load";case xe.EDIT:return"sendbird-icon-edit";case xe.EMOJI_MORE:return"sendbird-icon-emoji-more";case xe.ERROR:return"sendbird-icon-error";case xe.EXPAND:return"sendbird-icon-expand";case xe.FILE_AUDIO:return"sendbird-icon-file-audio";case xe.FILE_DOCUMENT:return"sendbird-icon-file-document";case xe.FREEZE:return"sendbird-icon-freeze";case xe.GIF:return"sendbird-icon-gif";case xe.INFO:return"sendbird-icon-info";case xe.LEAVE:return"sendbird-icon-leave";case xe.MEMBERS:return"sendbird-icon-members";case xe.MESSAGE:return"sendbird-icon-message";case xe.MODERATIONS:return"sendbird-icon-moderations";case xe.MORE:return"sendbird-icon-more";case xe.MUTE:return"sendbird-icon-mute";case xe.NOTIFICATIONS:return"sendbird-icon-notifications";case xe.NOTIFICATIONS_OFF_FILLED:return"sendbird-icon-notifications-off-filled";case xe.OPERATOR:return"sendbird-icon-operator";case xe.PHOTO:return"sendbird-icon-photo";case xe.PLAY:return"sendbird-icon-play";case xe.PLUS:return"sendbird-iconn-plus";case xe.QUESTION:return"sendbird-icon-question";case xe.REFRESH:return"sendbird-icon-refresh";case xe.REMOVE:return"sendbird-icon-remove";case xe.REPLY:return"sendbird-icon-reply";case xe.SEARCH:return"sendbird-icon-search";case xe.SEND:return"sendbird-icon-send";case xe.SETTINGS_FILLED:return"sendbird-icon-settings-filled";case xe.SPINNER:return"sendbird-icon-spinner";case xe.SUPERGROUP:return"sendbird-icon-supergroup";case xe.THREAD:return"sendbird-icon-thread";case xe.THUMBNAIL_NONE:return"sendbird-icon-thumbnail-none";case xe.TOGGLE_OFF:return"sendbird-icon-toggle-off";case xe.TOGGLE_ON:return"sendbird-icon-toggle-on";case xe.USER:return"sendbird-icon-user";case xe.FEEDBACK_LIKE:return"sendbird-icon-feedback-like";case xe.FEEDBACK_DISLIKE:return"sendbird-icon-feedback-dislike";default:return"sendbird-icon-unknown"}}var _A;function Ay(){return Ay=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ay.apply(null,arguments)}const H9=n=>F.createElement("svg",Ay({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),_A||(_A=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M50.667 5.333a8 8 0 0 1 8 8v37.334a8 8 0 0 1-8 8H13.333a8 8 0 0 1-8-8V13.333a8 8 0 0 1 8-8zm0 5.334H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334a2.667 2.667 0 0 0 2.666 2.666h37.334a2.667 2.667 0 0 0 2.666-2.666V13.333a2.667 2.667 0 0 0-2.666-2.666m-18.667 8a2.667 2.667 0 0 1 2.649 2.355l.018.311v8h8a2.667 2.667 0 0 1 .311 5.316l-.311.018h-8v8a2.667 2.667 0 0 1-5.316.311l-.018-.311v-8h-8a2.667 2.667 0 0 1-.311-5.316l.311-.018h8v-8A2.667 2.667 0 0 1 32 18.667",className:"icon-add_svg__fill"})));var mA;function wy(){return wy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},wy.apply(null,arguments)}const B9=n=>F.createElement("svg",wy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),mA||(mA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M33.886 8.781a2.67 2.67 0 0 1 .221 3.52l-.221.251-16.78 16.781H56a2.667 2.667 0 0 1 .311 5.316l-.311.018-38.895-.001 16.78 16.782a2.666 2.666 0 0 1 .222 3.52l-.221.251a2.67 2.67 0 0 1-3.52.222l-.252-.222L8.781 33.886a2.67 2.67 0 0 1-.222-3.52l.222-.252L30.114 8.781a2.67 2.67 0 0 1 3.772 0",className:"icon-arrow-left_svg__fill"})));var gA;function Ry(){return Ry=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ry.apply(null,arguments)}const G9=n=>F.createElement("svg",Ry({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),gA||(gA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m55.334 28.926-24.506 23.34c-5.222 4.973-13.74 4.973-18.962 0-5.149-4.903-5.149-12.797 0-17.7l24.506-23.34c3.138-2.988 8.278-2.988 11.416 0 3.064 2.919 3.064 7.594 0 10.513L23.255 45.077c-1.055 1.005-2.815 1.005-3.87.001-.98-.933-.98-2.39 0-3.325l22.64-21.535a2.667 2.667 0 0 0-3.676-3.864L15.709 37.89a7.58 7.58 0 0 0-.001 11.05c3.113 2.966 8.11 2.966 11.224 0l24.533-23.338c5.272-5.021 5.272-13.217 0-18.238-5.197-4.95-13.573-4.95-18.77 0L8.187 30.704c-7.356 7.005-7.356 18.419 0 25.424 7.281 6.935 19.036 6.935 26.318 0l24.506-23.34a2.666 2.666 0 1 0-3.678-3.862z",className:"icon-attach_svg__fill"})));var vA,EA;function My(){return My=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},My.apply(null,arguments)}const V9=n=>F.createElement("svg",My({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 64 64"},n),vA||(vA=F.createElement("g",{clipPath:"url(#icon-audio-on-lined_svg__a)"},F.createElement("path",{d:"M32 0C26.11 0 21.333 4.776 21.333 10.667V32c0 5.891 4.776 10.667 10.667 10.667S42.667 37.89 42.667 32V10.667C42.667 4.776 37.89 0 32 0m-5.333 10.667a5.333 5.333 0 0 1 10.666 0V32a5.333 5.333 0 0 1-10.666 0z",className:"icon-audio-on-lined_svg__fill",clipRule:"evenodd"}),F.createElement("path",{d:"M16 26.667a2.667 2.667 0 1 0-5.333 0V32c0 10.879 8.143 19.856 18.666 21.168v5.499h-8a2.667 2.667 0 0 0 0 5.333h21.334a2.667 2.667 0 1 0 0-5.333h-8v-5.499C45.19 51.856 53.333 42.88 53.333 32v-5.333a2.667 2.667 0 1 0-5.333 0V32c0 8.837-7.163 16-16 16s-16-7.163-16-16z",className:"icon-audio-on-lined_svg__fill"}))),EA||(EA=F.createElement("defs",null,F.createElement("clipPath",{id:"icon-audio-on-lined_svg__a"},F.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"})))));var yA;function Oy(){return Oy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Oy.apply(null,arguments)}const j9=n=>F.createElement("svg",Oy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),yA||(yA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8m12.333 21.333a1 1 0 0 1 1 1v3.334a1 1 0 0 1-1 1H19.667a1 1 0 0 1-1-1v-3.334a1 1 0 0 1 1-1z",className:"icon-ban_svg__fill"})));var bA;function ky(){return ky=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ky.apply(null,arguments)}const q9=n=>F.createElement("svg",ky({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),bA||(bA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M58.545 5.498q.121.389.122.796v46.079a2.666 2.666 0 0 1-3.462 2.546l-17.951-5.61c-.645 5.273-5.14 9.358-10.587 9.358C20.776 58.667 16 53.89 16 48v-5.334h-5.333a8 8 0 0 1-7.997-7.75l-.003-.25V24a8 8 0 0 1 8-8H16L55.205 3.749a2.665 2.665 0 0 1 3.34 1.75zM21.333 44.587V48a5.333 5.333 0 0 0 10.652.398L32 47.92zm32-34.667-32 9.997v18.83l32 9.997zM16 21.333h-5.333a2.67 2.67 0 0 0-2.65 2.356L8 24v10.667a2.667 2.667 0 0 0 2.667 2.666H16z",className:"icon-broadcast_svg__fill"})));var CA;function Dy(){return Dy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Dy.apply(null,arguments)}const z9=n=>F.createElement("svg",Dy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),CA||(CA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M40 5.333c.892 0 1.724.446 2.219 1.188l4.541 6.812H56a8 8 0 0 1 7.986 7.53l.014.47v29.334a8 8 0 0 1-8 8H8a8 8 0 0 1-8-8V21.333a8 8 0 0 1 8-8h9.237l4.544-6.812a2.67 2.67 0 0 1 1.888-1.167l.331-.02zm-1.43 5.334H25.428l-4.542 6.812a2.66 2.66 0 0 1-1.887 1.167l-.331.02H8a2.67 2.67 0 0 0-2.667 2.667v29.334A2.667 2.667 0 0 0 8 53.333h48a2.667 2.667 0 0 0 2.667-2.666V21.333A2.667 2.667 0 0 0 56 18.667H45.333a2.67 2.67 0 0 1-2.218-1.188zM32 21.333c7.364 0 13.333 5.97 13.333 13.334S39.363 48 32 48s-13.333-5.97-13.333-13.333S24.637 21.333 32 21.333m0 5.334a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-camera_svg__fill"})));var IA;function Ly(){return Ly=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ly.apply(null,arguments)}const K9=n=>F.createElement("svg",Ly({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),IA||(IA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m42.65 5.333.311.017a2.666 2.666 0 0 1 2.373 2.633l-.017.311-1.45 13.04h9.466a2.667 2.667 0 0 1 .311 5.315l-.31.018H43.271l-1.184 10.666h11.245a2.667 2.667 0 0 1 .312 5.316l-.31.018H41.495l-1.512 13.627a2.667 2.667 0 0 1-5.318-.277l.017-.311 1.448-13.04H25.496l-1.512 13.628a2.667 2.667 0 0 1-5.318-.277l.017-.311 1.448-13.04h-9.464a2.667 2.667 0 0 1-.311-5.315l.31-.018h10.057l1.186-10.667H10.667a2.667 2.667 0 0 1-.311-5.315l.31-.018h11.835l1.515-13.627a2.67 2.67 0 0 1 2.634-2.373l.311.017a2.666 2.666 0 0 1 2.373 2.633l-.017.311-1.45 13.04H38.5l1.515-13.628a2.67 2.67 0 0 1 2.634-2.373zm-5.927 32 1.186-10.667H27.272l-1.184 10.667z",className:"icon-channels_svg__fill"})));var TA;function xy(){return xy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},xy.apply(null,arguments)}const W9=n=>F.createElement("svg",xy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),TA||(TA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8",className:"icon-chat_svg__fill"})));var SA;function Uy(){return Uy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Uy.apply(null,arguments)}const $9=n=>F.createElement("svg",Uy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),SA||(SA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667",className:"icon-chat-filled_svg__fill"})));var NA;function Py(){return Py=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Py.apply(null,arguments)}const Y9=n=>F.createElement("svg",Py({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),NA||(NA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16.121 21.879a3 3 0 0 0-4.242 0 3 3 0 0 0 0 4.242l18 18a3 3 0 0 0 4.242 0l18-18a3 3 0 0 0 0-4.242 3 3 0 0 0-4.242 0L32 37.757z",className:"icon-chevron-down_svg__fill"})));var AA;function Fy(){return Fy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Fy.apply(null,arguments)}const Q9=n=>F.createElement("svg",Fy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),AA||(AA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M22.114 46.114a2.668 2.668 0 0 0 3.772 3.772l16-16a2.67 2.67 0 0 0 0-3.772l-16-16a2.668 2.668 0 0 0-3.772 3.772L36.23 32z",className:"icon-chevron-right_svg__fill"})));var wA;function Hy(){return Hy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Hy.apply(null,arguments)}const Z9=n=>F.createElement("svg",Hy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),wA||(wA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M52.552 11.448a2.666 2.666 0 0 1 .222 3.52l-.222.251-16.781 16.78 16.781 16.782a2.665 2.665 0 0 1 0 3.771 2.666 2.666 0 0 1-3.52.222l-.251-.222L32 35.771 15.219 52.552a2.665 2.665 0 0 1-3.771 0 2.666 2.666 0 0 1-.222-3.52l.222-.251L28.228 32l-16.78-16.781a2.665 2.665 0 0 1 0-3.771 2.666 2.666 0 0 1 3.52-.222l.251.222 16.78 16.78 16.782-16.78a2.665 2.665 0 0 1 3.771 0",className:"icon-close_svg__fill"})));var RA;function By(){return By=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},By.apply(null,arguments)}const X9=n=>F.createElement("svg",By({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),RA||(RA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16 8a2.667 2.667 0 0 0-2.649 2.356l-.018.31v42.667a2.667 2.667 0 0 0 5.316.311l.018-.31V34.666h25.56l-6.113 6.114a2.67 2.67 0 0 0-.221 3.52l.221.251a2.666 2.666 0 0 0 3.52.222l.252-.222 10.666-10.666a2.666 2.666 0 0 0 .222-3.52l-.222-.252-10.666-10.666a2.666 2.666 0 0 0-3.993 3.52l.221.251 6.113 6.114h-25.56V10.667A2.667 2.667 0 0 0 16 8",className:"icon-collapse_svg__fill"})));var MA;function Gy(){return Gy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Gy.apply(null,arguments)}const J9=n=>F.createElement("svg",Gy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),MA||(MA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M53.333 21.333a8 8 0 0 1 8 8v24a8 8 0 0 1-8 8h-24a8 8 0 0 1-8-8v-24a8 8 0 0 1 8-8zm0 5.334h-24a2.667 2.667 0 0 0-2.666 2.666v24A2.667 2.667 0 0 0 29.333 56h24A2.667 2.667 0 0 0 56 53.333v-24a2.667 2.667 0 0 0-2.667-2.666m-18.666-24a8 8 0 0 1 7.986 7.53l.014.47v2.666a2.667 2.667 0 0 1-5.316.311l-.018-.31v-2.667a2.67 2.67 0 0 0-2.355-2.65L34.667 8h-24a2.67 2.67 0 0 0-2.65 2.356l-.017.31v24a2.67 2.67 0 0 0 2.356 2.65l.31.017h2.667a2.667 2.667 0 0 1 .311 5.316l-.31.018h-2.667a8 8 0 0 1-7.987-7.53l-.013-.47v-24c0-4.26 3.33-7.743 7.53-7.987l.47-.013z",className:"icon-copy_svg__fill"})));var OA;function Vy(){return Vy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Vy.apply(null,arguments)}const eq=n=>F.createElement("svg",Vy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),OA||(OA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8m2.667 16v5.333H40c3.556 0 3.556 5.334 0 5.334h-5.333V40c0 3.556-5.334 3.556-5.334 0v-5.333H24c-3.556 0-3.556-5.334 0-5.334h5.333V24c0-3.556 5.334-3.556 5.334 0",className:"icon-create_svg__fill"})));var kA;function jy(){return jy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},jy.apply(null,arguments)}const nq=n=>F.createElement("svg",jy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),kA||(kA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M37.333 2.667c4.26 0 7.743 3.33 7.987 7.53l.013.47v2.666H56a2.667 2.667 0 0 1 .311 5.316l-.311.018h-2.668l.001 34.666c0 4.26-3.33 7.743-7.53 7.987l-.47.013H18.667a8 8 0 0 1-7.987-7.53l-.013-.47V18.667H8a2.667 2.667 0 0 1-.311-5.316L8 13.333h10.666v-2.666a8 8 0 0 1 7.53-7.987l.47-.013zm10.666 16H16v34.666a2.67 2.67 0 0 0 2.356 2.65l.31.017h26.667a2.67 2.67 0 0 0 2.65-2.356l.017-.31zm-21.332 8a2.667 2.667 0 0 1 2.648 2.355l.018.311v16a2.667 2.667 0 0 1-5.316.311l-.017-.31v-16a2.667 2.667 0 0 1 2.667-2.667m10.666 0a2.67 2.67 0 0 1 2.65 2.355l.017.311v16a2.667 2.667 0 0 1-5.315.311l-.018-.31v-16a2.667 2.667 0 0 1 2.666-2.667m0-18.667H26.667a2.67 2.67 0 0 0-2.65 2.356l-.017.31v2.667h16v-2.666a2.67 2.67 0 0 0-2.356-2.65L37.334 8z",className:"icon-delete_svg__fill"})));var DA;function qy(){return qy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},qy.apply(null,arguments)}const tq=n=>F.createElement("svg",qy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),DA||(DA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m54.534 6.069-.248.217-9.736 9.735-.04.04-9.573 9.573q-.226.178-.405.404L6.286 54.286a2.423 2.423 0 0 0 3.18 3.645l.248-.217 13.374-13.373a2.42 2.42 0 0 0 1.88-.401 12.12 12.12 0 0 1 14.04 0 2.424 2.424 0 1 0 2.808-3.952 16.95 16.95 0 0 0-11.303-3.072l6.743-6.744a24.1 24.1 0 0 1 10.159 5.021 2.424 2.424 0 0 0 3.11-3.719 29 29 0 0 0-9.34-5.23l5.633-5.634a36.2 36.2 0 0 1 9.225 5.934 2.425 2.425 0 0 0 3.211-3.633 41 41 0 0 0-8.796-5.941l7.256-7.256a2.423 2.423 0 0 0-3.18-3.645m-35.04 21.474a29 29 0 0 0-6.032 3.942 2.424 2.424 0 0 0 3.137 3.697 24 24 0 0 1 5.022-3.282 2.425 2.425 0 0 0-2.127-4.357M4.748 22.909a2.424 2.424 0 0 0 3.207 3.636 36.36 36.36 0 0 1 26.978-8.977 2.424 2.424 0 0 0 .389-4.832A41.2 41.2 0 0 0 4.748 22.909",className:"icon-disconnected_svg__fill"})));var LA;function zy(){return zy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},zy.apply(null,arguments)}const rq=n=>F.createElement("svg",zy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),LA||(LA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M37.333 2.667a3 3 0 0 1 .274.014l.085.01.058.008q.07.01.141.026l.029.007q.075.016.146.037l.034.01q.357.107.663.303l.034.022q.053.034.104.072l.057.043q.045.033.085.068.091.075.176.16l-.126-.117q.075.065.143.135L55.21 19.438q.07.07.134.143l.035.04q.04.047.076.096l.04.054.07.1.024.038c.16.253.279.535.347.836l.01.048q.014.064.024.13l.006.048.007.051.004.041q.014.135.014.27v32a8 8 0 0 1-8 8H16a8 8 0 0 1-8-8V10.667a8 8 0 0 1 8-8zM34.666 8H16a2.667 2.667 0 0 0-2.667 2.667v42.666A2.667 2.667 0 0 0 16 56h32a2.667 2.667 0 0 0 2.667-2.667L50.666 24H37.333a2.667 2.667 0 0 1-2.648-2.356l-.018-.31zm12.227 10.667-6.894-6.894.001 6.894z",className:"icon-document_svg__fill"})));var xA;function Ky(){return Ky=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ky.apply(null,arguments)}const iq=n=>F.createElement("svg",Ky({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),xA||(xA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M12.552 31.448a2.665 2.665 0 1 0-3.771 3.771l13.333 13.333a2.666 2.666 0 0 0 3.772 0L55.219 19.22a2.667 2.667 0 0 0-3.771-3.771L24 42.895z",className:"icon-done_svg__fill"})));var UA;function Wy(){return Wy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Wy.apply(null,arguments)}const aq=n=>F.createElement("svg",Wy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),UA||(UA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M5.886 31.448 19.219 44.78a2.667 2.667 0 0 1-3.771 3.771L2.114 35.22a2.667 2.667 0 0 1 3.772-3.771zm52.228-16a2.666 2.666 0 1 1 3.772 3.771L32.552 48.552a2.665 2.665 0 0 1-3.771 0L15.448 35.22a2.665 2.665 0 0 1 0-3.771 2.665 2.665 0 0 1 3.771 0l11.448 11.447zm-9.562 0a2.665 2.665 0 0 1 0 3.771L32.556 35.215a2.665 2.665 0 0 1-3.771 0 2.664 2.664 0 0 1 0-3.77L44.78 15.447a2.665 2.665 0 0 1 3.771 0z",className:"icon-done-all_svg__fill"})));var PA;function $y(){return $y=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},$y.apply(null,arguments)}const sq=n=>F.createElement("svg",$y({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),PA||(PA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M56 42.667a2.667 2.667 0 0 1 2.649 2.355l.018.311v8c0 4.26-3.33 7.743-7.53 7.987l-.47.013H13.333a8 8 0 0 1-7.986-7.53l-.014-.47v-8a2.667 2.667 0 0 1 5.316-.311l.018.311v8a2.67 2.67 0 0 0 2.355 2.65l.311.017h37.334a2.667 2.667 0 0 0 2.648-2.356l.018-.31v-8A2.667 2.667 0 0 1 56 42.667m-36.552-8.781a2.666 2.666 0 0 1 3.52-3.993l.251.221 6.114 6.114V5.333a2.667 2.667 0 0 1 5.316-.311l.018.311v30.894l6.114-6.113a2.67 2.67 0 0 1 3.52-.221l.251.221a2.666 2.666 0 0 1 .222 3.52l-.222.252-10.658 10.657a2 2 0 0 1-.135.128l.127-.119a3 3 0 0 1-.195.176l-.056.045-.086.064-.056.04-.086.056-.06.036-.081.046-.079.04a3 3 0 0 1-.14.065l-.09.036q-.034.014-.067.025l-.09.03-.063.019q-.064.018-.13.034l-.013.003-.144.028-.064.01q-.045.008-.092.012l-.084.008-.103.006-.069.002h-.095q-.042 0-.082-.003l.139.003q-.126 0-.249-.011l-.061-.007-.092-.012-.09-.015-.118-.025-.04-.01a3 3 0 0 1-.34-.11l-.015-.006q-.074-.03-.145-.063l-.042-.02L30.71 45l-.067-.039q-.045-.026-.087-.054l-.062-.041q-.045-.03-.088-.063l-.04-.03-.008-.007a3 3 0 0 1-.251-.223z",className:"icon-download_svg__fill"})));var FA;function Yy(){return Yy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Yy.apply(null,arguments)}const uq=n=>F.createElement("svg",Yy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 65 65"},n),FA||(FA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M56 56a2.667 2.667 0 0 1 .311 5.315l-.311.018H8a2.667 2.667 0 0 1-.311-5.316L8 56zM35.448 3.448a2.665 2.665 0 0 1 3.771 0l10.667 10.666a2.67 2.67 0 0 1 0 3.772L20.552 47.219c-.5.5-1.178.781-1.885.781H8a2.667 2.667 0 0 1-2.667-2.667V34.667c0-.708.281-1.386.781-1.886zm1.885 5.659L10.667 35.77v6.896h6.89L44.227 16z",className:"icon-edit_svg__fill"})));var HA;function Qy(){return Qy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Qy.apply(null,arguments)}const oq=n=>F.createElement("svg",Qy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),HA||(HA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32.097 3.22c2.65 0 5.255.357 7.763 1.054a2.134 2.134 0 0 1-1.144 4.111 24.7 24.7 0 0 0-6.619-.899c-13.603 0-24.63 11.027-24.63 24.63s11.027 24.63 24.63 24.63 24.63-11.027 24.63-24.63c0-2.227-.295-4.413-.87-6.518a2.13 2.13 0 0 1 1.494-2.62 2.13 2.13 0 0 1 2.62 1.494 29 29 0 0 1 1.023 7.644c0 15.96-12.938 28.897-28.897 28.897-15.96 0-28.897-12.937-28.897-28.897S16.138 3.22 32.097 3.22m10.705 34.792a2.133 2.133 0 0 1 2.024 2.808c-1.873 5.623-6.937 9.488-12.729 9.488s-10.856-3.865-12.73-9.488a2.134 2.134 0 0 1 1.875-2.803l.15-.005zm-3.477 4.266H24.867l.294.382c1.539 1.887 3.718 3.113 6.115 3.342l.314.024.507.015c2.617 0 5.037-1.188 6.743-3.151l.193-.23zM21.392 21.954c1.087 0 1.985.814 2.116 1.866l.017.267v5.353a2.133 2.133 0 0 1-4.25.268l-.017-.268v-5.353c0-1.178.955-2.133 2.134-2.133m21.41 0c1.088 0 1.985.814 2.117 1.866l.017.267v5.353a2.133 2.133 0 0 1-4.25.268l-.017-.268v-5.353c0-1.178.955-2.133 2.133-2.133M54.853 0a.8.8 0 0 1 .8.8v7.786h7.76a.8.8 0 0 1 .8.8v2.667a.8.8 0 0 1-.8.8h-7.76v7.758a.8.8 0 0 1-.8.8h-2.666a.8.8 0 0 1-.8-.8v-7.758h-7.785a.8.8 0 0 1-.8-.8V9.387a.8.8 0 0 1 .8-.8l7.784-.001V.8a.8.8 0 0 1 .8-.8z",className:"icon-emoji-more_svg__fill"})));var BA;function Zy(){return Zy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Zy.apply(null,arguments)}const lq=n=>F.createElement("svg",Zy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),BA||(BA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 5.06a8 8 0 0 1 6.561 3.424l.287.439 22.608 37.744a8 8 0 0 1 .022 7.962 8 8 0 0 1-6.356 4.014l-.535.024H9.384a8 8 0 0 1-6.862-4.038 8.01 8.01 0 0 1-.226-7.493l.27-.506L25.16 8.91A8 8 0 0 1 32 5.06m0 5.333c-.816 0-1.58.372-2.076.99l-.196.28-22.565 37.67a2.67 2.67 0 0 0 1.909 3.973l.341.027h45.144a2.67 2.67 0 0 0 2.45-3.659l-.148-.304L34.28 11.676A2.67 2.67 0 0 0 32 10.393m0 32.274A2.667 2.667 0 1 1 32 48a2.667 2.667 0 0 1 0-5.333m0-21.334a2.667 2.667 0 0 1 2.649 2.356l.018.311v10.667a2.667 2.667 0 0 1-5.316.311l-.018-.311V24A2.667 2.667 0 0 1 32 21.333",className:"icon-error_svg__fill"})));var GA;function Xy(){return Xy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Xy.apply(null,arguments)}const dq=n=>F.createElement("svg",Xy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),GA||(GA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M48 8a2.667 2.667 0 0 1 2.649 2.356l.018.31V32l-.001.027v21.306a2.667 2.667 0 0 1-5.315.311l-.018-.31V34.665H19.772l6.114 6.115a2.67 2.67 0 0 1 .221 3.52l-.221.251a2.666 2.666 0 0 1-3.52.222l-.252-.222-10.666-10.666a2.666 2.666 0 0 1-.222-3.52l.222-.252 10.666-10.666a2.666 2.666 0 0 1 3.993 3.52l-.221.251-6.113 6.114h25.56V10.667A2.667 2.667 0 0 1 48 8",className:"icon-expand_svg__fill"})));var VA;function Jy(){return Jy=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Jy.apply(null,arguments)}const cq=n=>F.createElement("svg",Jy({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),VA||(VA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M30.52 12.51c1.685-1.226 4.139-.103 4.139 1.893v35.194c0 1.996-2.454 3.119-4.138 1.893l-12.45-9.909H7.898c-1.416 0-2.564-1.074-2.564-2.399V24.818c0-1.325 1.148-2.4 2.564-2.4h10.175zm20.427.163c10.293 10.667 10.293 27.987 0 38.654a2.137 2.137 0 0 1-3.156-.047c-.86-.942-.84-2.448.044-3.364 8.49-8.799 8.49-23.033 0-31.832-.884-.916-.904-2.422-.044-3.364a2.137 2.137 0 0 1 3.156-.047m-8.492 8.799c5.597 5.8 5.597 15.231 0 21.031a2.136 2.136 0 0 1-3.156-.046c-.86-.942-.84-2.448.044-3.364 3.794-3.932 3.794-10.279 0-14.211-.884-.916-.904-2.422-.044-3.363a2.136 2.136 0 0 1 3.156-.047",className:"icon-file-audio_svg__fill"})));var jA;function eb(){return eb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},eb.apply(null,arguments)}const fq=n=>F.createElement("svg",eb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),jA||(jA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M39.414 6.4a2.4 2.4 0 0 1 1.71.701l12.642 12.75c.407.41.634.953.634 1.516v29.765c0 3.542-4.342 6.468-8 6.468H16.16c-3.658 0-6.4-2.926-6.4-6.468L9.6 12.868c0-3.542 2.902-6.468 6.56-6.468zm3.331 35.173-21.49.027-.147.005c-1.066.08-1.908 1.014-1.908 2.155 0 1.193.92 2.16 2.055 2.16l21.49-.027.147-.005c1.066-.08 1.908-1.014 1.908-2.155 0-1.193-.92-2.16-2.055-2.16m0-8.533-21.49.027-.147.005c-1.066.08-1.908 1.014-1.908 2.155 0 1.193.92 2.16 2.055 2.16l21.49-.027.147-.005c1.066-.08 1.908-1.014 1.908-2.155 0-1.193-.92-2.16-2.055-2.16m-11.807-8.507h-9.6l-.153.006a2.15 2.15 0 0 0-1.985 2.154c0 1.193.957 2.16 2.138 2.16h9.6l.152-.005a2.15 2.15 0 0 0 1.985-2.155c0-1.193-.957-2.16-2.137-2.16",className:"icon-file-document_svg__fill"})));var qA;function nb(){return nb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},nb.apply(null,arguments)}const hq=n=>F.createElement("svg",nb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),qA||(qA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m41.636 3.226.251.222a2.67 2.67 0 0 1 .222 3.52l-.222.251-7.219 7.218V27.38l11.209-6.472 2.643-9.86a2.667 2.667 0 0 1 5.218 1.051l-.067.329-2.237 8.35 8.352 2.24a2.67 2.67 0 0 1 1.952 2.938l-.067.328a2.67 2.67 0 0 1-2.937 1.952l-.329-.066-9.861-2.643L37.334 32l11.209 6.47 9.862-2.64.329-.067a2.67 2.67 0 0 1 2.937 1.952l.067.328a2.67 2.67 0 0 1-1.952 2.938l-8.353 2.237 2.238 8.353.067.329a2.666 2.666 0 0 1-5.218 1.052l-2.643-9.861-11.209-6.472v12.944l7.219 7.218a2.667 2.667 0 0 1-3.52 3.993l-.251-.222L32 54.437l-6.114 6.115a2.666 2.666 0 0 1-3.52.222l-.251-.222a2.666 2.666 0 0 1-.222-3.52l.222-.251 7.218-7.22V36.62l-11.209 6.47-2.642 9.863a2.666 2.666 0 0 1-5.218-1.052l.067-.329 2.236-8.351-8.35-2.24a2.665 2.665 0 0 1-1.953-2.937l.067-.328a2.665 2.665 0 0 1 2.937-1.952l.329.066 9.861 2.642L26.667 32l-11.209-6.472-9.86 2.643-.329.066a2.665 2.665 0 0 1-2.937-1.952l-.067-.328a2.67 2.67 0 0 1 1.952-2.938l8.35-2.239-2.235-8.351-.067-.329a2.667 2.667 0 0 1 5.218-1.052l2.642 9.862 11.209 6.47V14.439L22.116 7.22a2.665 2.665 0 0 1 0-3.771 2.666 2.666 0 0 1 3.52-.222l.251.222 6.114 6.112 6.115-6.112a2.666 2.666 0 0 1 3.52-.222z",className:"icon-freeze_svg__fill"})));var zA;function tb(){return tb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},tb.apply(null,arguments)}const pq=n=>F.createElement("svg",tb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),zA||(zA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16.664 45.333q3.233 0 5.89-.953 2.658-.954 4.113-2.683V31.34h-10.29v3.94h4.902v4.474q-1.292 1.284-4.327 1.283-3.017 0-4.58-2.085-1.561-2.085-1.562-6.168v-1.657q.018-4.047 1.455-6.097t4.184-2.05q2.155 0 3.385 1.034t1.59 3.262h5.243q-.486-4.206-3.107-6.408t-7.273-2.201q-3.34 0-5.827 1.506t-3.807 4.35q-1.32 2.843-1.32 6.728v1.765q.036 3.78 1.428 6.578 1.392 2.797 3.95 4.269 2.56 1.47 5.953 1.47m20.67 0V18.667H32v26.666h5.333zm10.396 0V34.436h9.721v-4.432H47.73v-6.887h10.937v-4.45h-16v26.666z",className:"icon-gif_svg__fill"})));var KA;function rb(){return rb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},rb.apply(null,arguments)}const _q=n=>F.createElement("svg",rb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),KA||(KA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8m1.667 21.333a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1h-3.334a1 1 0 0 1-1-1v-14a1 1 0 0 1 1-1zm-1.667-8a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334",className:"icon-info_svg__fill"})));var WA;function ib(){return ib=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ib.apply(null,arguments)}const mq=n=>F.createElement("svg",ib({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),WA||(WA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 5.333a2.667 2.667 0 0 1 .311 5.316l-.311.018H10.667a2.67 2.67 0 0 0-2.65 2.355L8 13.333v37.334a2.667 2.667 0 0 0 2.356 2.648l.31.018H32a2.667 2.667 0 0 1 .311 5.316l-.311.018H10.667a8 8 0 0 1-7.987-7.53l-.013-.47V13.333a8 8 0 0 1 7.53-7.986l.47-.014zm17.634 13.893.252.222 10.666 10.666a2.666 2.666 0 0 1 .222 3.52l-.222.252-10.666 10.666a2.666 2.666 0 0 1-3.993-3.52l.221-.251 4.78-4.782L20 36a2.667 2.667 0 0 1-.311-5.315l.311-.018h33.56l-7.446-7.448a2.67 2.67 0 0 1-.221-3.52l.221-.251a2.666 2.666 0 0 1 3.52-.222",className:"icon-leave_svg__fill"})));var $A;function ab(){return ab=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ab.apply(null,arguments)}const gq=n=>F.createElement("svg",ab({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),$A||($A=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 0 1-5.315.311L42.667 56v-5.333c0-4.26-3.33-7.743-7.53-7.987l-.47-.013H13.333a8 8 0 0 0-7.986 7.53l-.014.47V56a2.667 2.667 0 0 1-5.316.311L0 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013zM54 37.765a13.33 13.33 0 0 1 9.986 12.297l.014.605V56a2.667 2.667 0 0 1-5.315.311L58.667 56v-5.331a8 8 0 0 0-6-7.74A2.667 2.667 0 1 1 54 37.765M24 5.333c7.364 0 13.333 5.97 13.333 13.334S31.363 32 24 32s-13.333-5.97-13.333-13.333S16.637 5.333 24 5.333m19.328.43a13.333 13.333 0 0 1 0 25.834 2.667 2.667 0 1 1-1.323-5.167 8 8 0 0 0 0-15.5 2.667 2.667 0 1 1 1.323-5.167M24 10.667a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-members_svg__fill"})));var YA;function sb(){return sb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},sb.apply(null,arguments)}const vq=n=>F.createElement("svg",sb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),YA||(YA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8M18.667 29.333a2.667 2.667 0 1 1-.001 5.333 2.667 2.667 0 0 1 .001-5.333m13.333 0a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334m13.333 0a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334",className:"icon-message_svg__fill"})));var QA;function ub(){return ub=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ub.apply(null,arguments)}const Eq=n=>F.createElement("svg",ub({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),QA||(QA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M18.667 34.667a2.667 2.667 0 0 1 .311 5.316l-.311.017h-5.334v16a2.667 2.667 0 0 1-5.316.311L8 56V40H2.667a2.667 2.667 0 0 1-.311-5.315l.31-.018h16zM32 29.333a2.667 2.667 0 0 1 2.649 2.356l.018.311v24a2.667 2.667 0 0 1-5.316.311L29.333 56V32A2.667 2.667 0 0 1 32 29.333M61.333 40a2.667 2.667 0 0 1 .311 5.315l-.31.018h-5.335L56 56a2.667 2.667 0 0 1-5.315.311L50.667 56l-.001-10.668-5.333.001a2.667 2.667 0 0 1-.311-5.316l.311-.017zm-8-34.667a2.67 2.67 0 0 1 2.65 2.356L56 8v24a2.667 2.667 0 0 1-5.315.311L50.667 32V8a2.667 2.667 0 0 1 2.666-2.667m-42.666 0a2.667 2.667 0 0 1 2.648 2.356l.018.311v18.667a2.667 2.667 0 0 1-5.316.311L8 26.667V8a2.667 2.667 0 0 1 2.667-2.667m21.333 0a2.667 2.667 0 0 1 2.649 2.356l.018.311-.001 10.666H40a2.668 2.668 0 0 1 .311 5.317L40 24H24a2.667 2.667 0 0 1-.311-5.315l.311-.018h5.333V8A2.667 2.667 0 0 1 32 5.333",className:"icon-moderations_svg__fill"})));var ZA;function ob(){return ob=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ob.apply(null,arguments)}const yq=n=>F.createElement("svg",ob({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),ZA||(ZA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 45.333a5.333 5.333 0 1 1 0 10.666 5.333 5.333 0 0 1 0-10.666M32 28a5.333 5.333 0 1 1 0 10.668A5.333 5.333 0 0 1 32 28m0-17.333c2.946 0 5.333 2.387 5.333 5.333S34.946 21.333 32 21.333 26.667 18.946 26.667 16s2.387-5.333 5.333-5.333",className:"icon-more_svg__fill"})));var XA;function lb(){return lb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},lb.apply(null,arguments)}const bq=n=>F.createElement("svg",lb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),XA||(XA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m55.62 19.616.067.123A26.55 26.55 0 0 1 58.667 32c0 4.326-1.03 8.41-2.864 12.025q-1.518 4.089-.67 6.363 1.066 2.855 2.662 4.758 2.31 2.379-1.506 3.33-3.135.782-10.879-1.646l-.488-.155-1.594-.527A26.6 26.6 0 0 1 32 58.667a26.55 26.55 0 0 1-12.326-3.014l-.059-.03 4-4A21.2 21.2 0 0 0 32 53.333c2.993 0 5.89-.614 8.562-1.786l.498-.226 1.925-.905 3.613 1.196.695.219q1.093.337 2.054.595l.472.125.485.121-.167-.42-.2-.594c-.814-2.685-.484-5.681.713-9.065l.154-.425.106-.284.528-1.084a21.2 21.2 0 0 0 1.895-8.8 21.2 21.2 0 0 0-1.71-8.385zm2.266-13.502a2.67 2.67 0 0 1 .221 3.52l-.221.252-48 48a2.668 2.668 0 0 1-3.993-3.52l.221-.252 5.238-5.237a26.56 26.56 0 0 1-6.015-16.412L5.333 32C5.333 17.272 17.273 5.333 32 5.333a26.55 26.55 0 0 1 16.877 6.02l5.237-5.239a2.67 2.67 0 0 1 3.772 0M32 10.667c-11.782 0-21.333 9.55-21.333 21.333 0 4.836 1.614 9.401 4.48 13.084l29.936-29.938A21.25 21.25 0 0 0 32 10.666z",className:"icon-mute_svg__fill"})));var JA;function db(){return db=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},db.apply(null,arguments)}const Cq=n=>F.createElement("svg",db({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),JA||(JA=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.613 53.333c2.056 0 3.338 2.227 2.307 4.005a8 8 0 0 1-13.84 0c-.98-1.689.129-3.783 2.004-3.988l.303-.017zM32 2.667c11.56 0 20.972 9.194 21.323 20.669l.01.664v13.333a5.334 5.334 0 0 0 4.936 5.319l.753.033c2.963.318 3.077 4.616.342 5.24l-.342.056-.355.019H5.333l-.355-.019c-3.082-.33-3.082-4.965 0-5.296l.753-.033a5.335 5.335 0 0 0 4.92-4.9l.016-.419V24c0-11.782 9.55-21.333 21.333-21.333M32 8c-8.636 0-15.674 6.842-15.989 15.4L16 24v13.333c0 1.562-.336 3.046-.939 4.383l-.275.564-.218.387h34.861l-.215-.387a10.6 10.6 0 0 1-1.146-3.74l-.055-.674-.013-.533V24c0-8.837-7.163-16-16-16",className:"icon-notifications_svg__fill"})));var ew;function cb(){return cb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},cb.apply(null,arguments)}const Iq=n=>F.createElement("svg",cb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),ew||(ew=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.613 53.333c2.056 0 3.338 2.227 2.307 4.005a8 8 0 0 1-13.84 0c-.98-1.689.129-3.783 2.004-3.988l.303-.017zM32 2.667c7.173 0 13.52 3.54 17.387 8.97l5.686-5.687a2.105 2.105 0 0 1 2.85-.117l.127.117a2.105 2.105 0 0 1 0 2.977L8.927 58.05c-.78.781-2.023.82-2.85.117l-.127-.117a2.105 2.105 0 0 1 0-2.977L13.023 48h-7.69l-.355-.019c-3.082-.33-3.082-4.965 0-5.296l.753-.033a5.335 5.335 0 0 0 4.92-4.9l.016-.419V24c0-11.782 9.55-21.333 21.333-21.333m20.85 16.795c.271 1.253.433 2.548.473 3.874l.01.664v13.333a5.334 5.334 0 0 0 4.936 5.319l.753.033c2.963.318 3.077 4.616.342 5.24l-.342.056-.355.019H24.31z",className:"icon-notifications-off-filled_svg__fill"})));var nw;function fb(){return fb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},fb.apply(null,arguments)}const Tq=n=>F.createElement("svg",fb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),nw||(nw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M29.83 6.45a2.667 2.667 0 0 1 4.34 0l11.697 16.374L57 13.918c1.88-1.504 4.573.054 4.32 2.35l-.047.29-8 37.334A2.666 2.666 0 0 1 50.666 56H13.333a2.666 2.666 0 0 1-2.607-2.108l-8-37.333c-.525-2.452 2.315-4.207 4.273-2.641l11.132 8.906zM32 12.587l-11.163 15.63a2.667 2.667 0 0 1-3.836.532l-7.497-5.997 5.984 27.915h33.021l5.984-27.915L47 28.749a2.667 2.667 0 0 1-3.632-.281l-.204-.251zM32 32a5.333 5.333 0 1 1 0 10.668A5.333 5.333 0 0 1 32 32",className:"icon-operator_svg__fill"})));var tw;function hb(){return hb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},hb.apply(null,arguments)}const Sq=n=>F.createElement("svg",hb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),tw||(tw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M50.667 5.333a8 8 0 0 1 8 8v37.334a8 8 0 0 1-8 8H13.333a8 8 0 0 1-8-8V13.333a8 8 0 0 1 8-8zm-8 25.107L19.77 53.332l30.896.001a2.667 2.667 0 0 0 2.661-2.498l.005-.168v-9.564L42.666 30.44zm8-19.773H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334c0 1.143.72 2.119 1.731 2.498L40.781 24.78a2.67 2.67 0 0 1 3.52-.222l.251.222 8.78 8.78.001-20.228a2.667 2.667 0 0 0-2.498-2.661zm-28 5.333a6.666 6.666 0 1 1 0 13.333 6.666 6.666 0 0 1 0-13.333m0 5.333a1.334 1.334 0 1 0 0 2.667 1.334 1.334 0 0 0 0-2.667",className:"icon-photo_svg__fill"})));var rw;function pb(){return pb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},pb.apply(null,arguments)}const Nq=n=>F.createElement("svg",pb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),rw||(rw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M51.908 34.75c1.9-1.233 1.896-3.26.013-4.514L19.376 8.577c-1.893-1.26-3.404-.391-3.376 1.968l.522 42.888c.028 2.347 1.596 3.247 3.493 2.016z",className:"icon-play_svg__fill"})));var iw;function _b(){return _b=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},_b.apply(null,arguments)}const Aq=n=>F.createElement("svg",_b({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),iw||(iw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 29.333h18.666c3.556 0 3.556 5.334 0 5.334H34.667v18.666c0 3.556-5.334 3.556-5.334 0V34.667H10.667c-3.556 0-3.556-5.334 0-5.334h18.666V10.667c0-3.556 5.334-3.556 5.334 0z",className:"icon-plus_svg__fill"})));var aw;function mb(){return mb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},mb.apply(null,arguments)}const wq=n=>F.createElement("svg",mb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),aw||(aw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 61.333C15.8 61.333 2.667 48.2 2.667 32S15.8 2.667 32 2.667 61.333 15.8 61.333 32 48.2 61.333 32 61.333M32 56c13.255 0 24-10.745 24-24S45.255 8 32 8 8 18.745 8 32s10.745 24 24 24m2.213-18.63a2.667 2.667 0 1 1-5.333 0v-2.69c0-1.148.734-2.168 1.823-2.53.173-.058.532-.195 1.01-.407.809-.36 1.616-.79 2.354-1.282 1.835-1.223 2.813-2.528 2.813-3.786a5.333 5.333 0 0 0-10.364-1.777 2.667 2.667 0 0 1-5.032-1.77 10.668 10.668 0 0 1 20.729 3.551c0 3.413-2.022 6.109-5.187 8.22a21 21 0 0 1-2.813 1.578zm-5.333 7.523a2.667 2.667 0 1 1 5.333 0v.44a2.667 2.667 0 1 1-5.333 0v-.44",className:"icon-question_svg__fill"})));var sw;function gb(){return gb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},gb.apply(null,arguments)}const Rq=n=>F.createElement("svg",gb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),sw||(sw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m46.14 14.43.562.537 6.631 6.167v-7.8a2.67 2.67 0 0 1 2.356-2.65l.311-.017a2.667 2.667 0 0 1 2.649 2.355l.018.311v16a2.67 2.67 0 0 1-2.356 2.65L56 32H40a2.667 2.667 0 0 1-.311-5.315l.311-.018h11.452l-8.44-7.85c-5.964-5.893-15.168-7.182-22.563-3.156-7.38 4.018-11.172 12.357-9.314 20.455 1.859 8.107 8.935 14.032 17.362 14.518 8.43.487 16.162-4.585 18.967-12.426a2.667 2.667 0 0 1 5.022 1.797C48.88 50.082 38.973 56.582 28.19 55.959c-10.785-.623-19.862-8.222-22.254-18.65C3.542 26.872 8.426 16.135 17.9 10.977c9.227-5.024 20.65-3.579 28.241 3.453z",className:"icon-refresh_svg__fill"})));var uw;function vb(){return vb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},vb.apply(null,arguments)}const Mq=n=>F.createElement("svg",vb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),uw||(uw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667m9.886 19.447a2.67 2.67 0 0 0-3.772 0L32 28.23l-6.114-6.115-.134-.124a2.667 2.667 0 0 0-3.638.124l-.124.134a2.667 2.667 0 0 0 .124 3.638L28.23 32l-6.115 6.114-.124.134a2.667 2.667 0 0 0 .124 3.638l.134.124a2.667 2.667 0 0 0 3.638-.124L32 35.77l6.114 6.115.134.124a2.667 2.667 0 0 0 3.638-.124l.124-.134a2.667 2.667 0 0 0-.124-3.638L35.77 32l6.115-6.114.124-.134a2.667 2.667 0 0 0-.124-3.638z",className:"icon-remove_svg__fill"})));var ow;function Eb(){return Eb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Eb.apply(null,arguments)}const Oq=n=>F.createElement("svg",Eb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 12"},n),ow||(ow=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M11.774 10.5c.062 0 .12-.025.164-.07a.22.22 0 0 0 .062-.164c-.069-1.447-.495-2.678-1.268-3.66-.618-.785-1.455-1.409-2.49-1.855a9.3 9.3 0 0 0-2.406-.655 10 10 0 0 0-.862-.078V2.225a.23.23 0 0 0-.128-.203.23.23 0 0 0-.24.028L.084 5.692A.22.22 0 0 0 0 5.865c0 .068.03.132.082.175l4.523 3.737c.067.056.16.068.24.03a.22.22 0 0 0 .13-.202v-1.95c1.134-.08 2.178.003 3.107.25a6.4 6.4 0 0 1 2.087.96c1.018.724 1.398 1.5 1.401 1.507a.23.23 0 0 0 .204.128",className:"icon-reply-filled_svg__fill"})));var lw;function yb(){return yb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},yb.apply(null,arguments)}const kq=n=>F.createElement("svg",yb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),lw||(lw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M26.667 48C14.885 48 5.333 38.449 5.333 26.667S14.885 5.333 26.667 5.333 48 14.885 48 26.667c0 4.93-1.672 9.469-4.48 13.081l13.67 13.67a2.668 2.668 0 0 1-3.772 3.772l-13.67-13.67A21.24 21.24 0 0 1 26.667 48m0-5.333c8.836 0 16-7.164 16-16s-7.164-16-16-16-16 7.163-16 16 7.163 16 16 16",className:"icon-search_svg__fill"})));var dw;function bb(){return bb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},bb.apply(null,arguments)}const Dq=n=>F.createElement("svg",bb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),dw||(dw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M59.795 29.43 7.329 2.979C4.691 1.802 1.76 4.153 2.932 6.798l6.925 18.609a2 2 0 0 0 1.544 1.275l32.273 5.394L11.4 37.47a2 2 0 0 0-1.544 1.275L2.932 57.353c-.879 2.645 1.76 4.997 4.397 3.527l52.466-26.453c2.051-.882 2.051-3.82 0-4.996z",className:"icon-send_svg__fill"})));var cw;function Cb(){return Cb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Cb.apply(null,arguments)}const Lq=n=>F.createElement("svg",Cb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),cw||(cw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667A5.33 5.33 0 0 1 37.333 8v.24A4.4 4.4 0 0 0 40 12.267a4.4 4.4 0 0 0 4.853-.88l.16-.16a5.33 5.33 0 0 1 7.547 0 5.333 5.333 0 0 1 0 7.546l-.16.16a4.4 4.4 0 0 0-.88 4.854V24a4.4 4.4 0 0 0 4.027 2.667H56c2.946 0 5.333 2.387 5.333 5.333S58.946 37.333 56 37.333h-.24A4.4 4.4 0 0 0 51.733 40a4.4 4.4 0 0 0 .88 4.853l.16.16a5.33 5.33 0 0 1 0 7.547 5.333 5.333 0 0 1-7.546 0l-.16-.16a4.4 4.4 0 0 0-4.854-.88 4.4 4.4 0 0 0-2.666 4.027V56a5.333 5.333 0 0 1-10.667 0v-.24A4.4 4.4 0 0 0 24 51.733a4.4 4.4 0 0 0-4.853.88l-.16.16a5.33 5.33 0 0 1-7.547 0 5.333 5.333 0 0 1 0-7.546l.16-.16a4.4 4.4 0 0 0 .88-4.854 4.4 4.4 0 0 0-4.027-2.666H8A5.333 5.333 0 0 1 8 26.88h.24A4.4 4.4 0 0 0 12.267 24a4.4 4.4 0 0 0-.88-4.853l-.16-.16a5.33 5.33 0 0 1 0-7.547 5.333 5.333 0 0 1 7.546 0l.16.16a4.4 4.4 0 0 0 4.854.88H24a4.4 4.4 0 0 0 2.667-4.027V8A5.33 5.33 0 0 1 32 2.667M32 24a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-settings-filled_svg__fill"})));var fw;function Ib(){return Ib=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ib.apply(null,arguments)}const xq=n=>F.createElement("svg",Ib({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 32 32"},n),fw||(fw=F.createElement("path",{d:"M21.943 24.39a1.333 1.333 0 0 1-1.886 1.886l-9.333-9.333a1.333 1.333 0 0 1 0-1.886l9.333-9.333a1.333 1.333 0 1 1 1.886 1.885L13.553 16z",className:"icon-slide-left_svg__fill",clipRule:"evenodd"})));var hw;function Tb(){return Tb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Tb.apply(null,arguments)}const Uq=n=>F.createElement("svg",Tb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),hw||(hw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 61.333C48.2 61.333 61.333 48.2 61.333 32S48.2 2.667 32 2.667 2.667 15.8 2.667 32a2.838 2.838 0 1 0 5.678 0C8.344 18.935 18.934 8.344 32 8.344c13.065 0 23.656 10.591 23.656 23.656S45.065 55.656 32 55.656a2.838 2.838 0 1 0 0 5.677",className:"icon-spinner_svg__fill"})));var pw;function Sb(){return Sb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Sb.apply(null,arguments)}const Pq=n=>F.createElement("svg",Sb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),pw||(pw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.889 43.013c6.608 0 12.121 4.685 12.43 10.734l.014.537V58a2.667 2.667 0 0 1-5.316.311L44 58v-3.716c0-3.07-2.87-5.718-6.636-5.925l-.475-.013H27.11c-3.838 0-6.86 2.525-7.096 5.557l-.015.381V58a2.667 2.667 0 0 1-5.315.311L14.667 58v-3.716c0-6.126 5.324-10.986 11.864-11.26l.58-.011zm18.578-17.291q.401 0 .784.118c4.632 1.426 7.518 4.801 7.736 9.688l.013.594v12.8a2.667 2.667 0 0 1-5.315.311l-.018-.311V36.124c-.002-2.595-1.163-4.171-3.528-5.034l-.104-.037-2.502.002a2.667 2.667 0 0 1-2.648-2.356l-.018-.31a2.67 2.67 0 0 1 2.355-2.65l.311-.017zm-44 0 .31.018a2.666 2.666 0 0 1 2.356 2.648l-.018.311a2.666 2.666 0 0 1-2.648 2.356l-2.51-.002-.119.042c-2.246.85-3.503 2.574-3.505 5.147v12.68l-.018.31A2.666 2.666 0 0 1 0 48.922V36.24l.014-.591c.225-4.874 3.203-8.415 7.712-9.809q.384-.117.788-.118zM32 19.958c5.512 0 10 4.409 10 9.871s-4.488 9.872-10 9.872-10-4.41-10-9.872 4.488-9.871 10-9.871m0 5.333c-2.588 0-4.667 2.043-4.667 4.538s2.08 4.538 4.667 4.538c2.588 0 4.667-2.042 4.667-4.538 0-2.495-2.08-4.538-4.667-4.538M17.333 2.667c5.513 0 10 4.409 10 9.871s-4.487 9.871-10 9.871c-5.512 0-10-4.409-10-9.871s4.488-9.871 10-9.871m29.334 0c5.512 0 10 4.409 10 9.871s-4.488 9.871-10 9.871c-5.513 0-10-4.409-10-9.871s4.487-9.871 10-9.871M17.333 8c-2.587 0-4.666 2.042-4.666 4.538s2.079 4.538 4.666 4.538S22 15.034 22 12.538 19.921 8 17.333 8m29.334 0C44.079 8 42 10.042 42 12.538s2.079 4.538 4.667 4.538 4.666-2.042 4.666-4.538S49.254 8 46.667 8",className:"icon-supergroup_svg__fill"})));var _w,mw;function Nb(){return Nb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Nb.apply(null,arguments)}const Fq=n=>F.createElement("svg",Nb({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 64 64"},n),_w||(_w=F.createElement("path",{d:"M38.824 25.895a2.95 2.95 0 0 1 4.16-.074L57.1 39.378a2.92 2.92 0 0 1 .002 4.213L42.985 57.177a2.95 2.95 0 0 1-4.158-.07 2.92 2.92 0 0 1 .07-4.14l11.928-11.48-11.926-11.451a2.92 2.92 0 0 1-.075-4.14",className:"icon-thread_svg__fill",clipRule:"evenodd"})),mw||(mw=F.createElement("path",{d:"M8.866 6c1.583 0 2.866 1.216 2.866 2.716V25.5c0 7.672 6.846 14.068 15.475 14.068h22.927c1.583 0 2.866 1.216 2.866 2.716S51.717 45 50.134 45H27.207C15.604 45 6 36.35 6 25.5V8.716C6 7.216 7.283 6 8.866 6",className:"icon-thread_svg__fill",clipRule:"evenodd"})));var gw;function Ab(){return Ab=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ab.apply(null,arguments)}const Hq=n=>F.createElement("svg",Ab({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),gw||(gw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 5.333a2.667 2.667 0 0 1 0 5.334H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334c0 1.143.72 2.118 1.73 2.497l28.384-28.383a2.667 2.667 0 0 1 3.771 0l8.781 8.78v-4.228a2.667 2.667 0 0 1 2.498-2.661l.169-.005a2.667 2.667 0 0 1 2.667 2.666v21.334a8 8 0 0 1-8 8H13.33a8 8 0 0 1-7.998-8V13.333a8 8 0 0 1 8-8zm8 25.105L19.77 53.333h30.897a2.667 2.667 0 0 0 2.661-2.498l.005-.168v-9.563zM22.667 16a6.666 6.666 0 1 1 0 13.333 6.666 6.666 0 0 1 0-13.333m0 5.333a1.334 1.334 0 1 0 0 2.667 1.334 1.334 0 0 0 0-2.667M56.78 3.448a2.665 2.665 0 0 1 3.771 0 2.665 2.665 0 0 1 0 3.771l-4.782 4.78 4.782 4.782c.998.998 1.04 2.59.125 3.638l-.125.133a2.665 2.665 0 0 1-3.771 0l-4.782-4.781-4.78 4.781a2.667 2.667 0 0 1-3.638.125l-.133-.125a2.665 2.665 0 0 1 0-3.771L48.228 12l-4.78-4.781a2.667 2.667 0 0 1-.125-3.638l.125-.133a2.665 2.665 0 0 1 3.771 0l4.78 4.78z",className:"icon-thumbnail-none_svg__fill"})));var vw;function wb(){return wb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},wb.apply(null,arguments)}const Bq=n=>F.createElement("svg",wb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 88 48"},n),vw||(vw=F.createElement("g",{fill:"none",fillRule:"evenodd"},F.createElement("rect",{width:80,height:40,x:4,y:4,fill:"#000",className:"icon-toggleoff_svg__fill",rx:20}),F.createElement("circle",{cx:24,cy:24,r:12,fill:"#FFF"}),F.createElement("path",{fill:"#FFF",d:"M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992z"}),F.createElement("path",{fill:"#000",d:"M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0m0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4z",className:"icon-toggleoff_svg__fill"}))));var Ew;function Rb(){return Rb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Rb.apply(null,arguments)}const Gq=n=>F.createElement("svg",Rb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 88 48"},n),Ew||(Ew=F.createElement("g",{fill:"none",fillRule:"evenodd"},F.createElement("rect",{width:80,height:40,x:4,y:4,fill:"#000",className:"icon-toggleon_svg__fill",rx:20}),F.createElement("circle",{cx:64,cy:24,r:12,fill:"#FFF"}),F.createElement("path",{fill:"#FFF",d:"M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992z"}),F.createElement("path",{fill:"#000",d:"M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0m0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4z",className:"icon-toggleon_svg__fill"}))));var yw;function Mb(){return Mb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Mb.apply(null,arguments)}const Vq=n=>F.createElement("svg",Mb({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),yw||(yw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M42.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 0 1-5.315.311L50.667 56v-5.333c0-4.26-3.33-7.743-7.53-7.987l-.47-.013H21.333a8 8 0 0 0-7.986 7.53l-.014.47V56a2.667 2.667 0 0 1-5.316.311L8 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013zM32 5.333c7.364 0 13.333 5.97 13.333 13.334S39.363 32 32 32s-13.333-5.97-13.333-13.333S24.637 5.333 32 5.333m0 5.334a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-user_svg__fill"})));var bw;function Ob(){return Ob=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ob.apply(null,arguments)}const jq=n=>F.createElement("svg",Ob({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},n),bw||(bw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M12.346 5.336v-.001c.405-.523 1.182-.524 1.58-.037.162.2.25.443.25.69v3.678c0 .518.42.938.938.938H18.6c.359 0 .7.179.911.488l.001.001.369.548.003.004c.174.256.226.583.134.895l-1.532 5.316c-.131.459-.559.782-1.044.782h-7.075c-.3 0-.593-.127-.8-.345l-1.13-1.222v-6.647zm-4.73 3.078 3.245-4.223.002-.002c1.125-1.456 3.339-1.521 4.517-.075.421.52.671 1.177.671 1.874v2.74h2.55c.99 0 1.908.496 2.462 1.31l.002.004.368.547.002.002a2.93 2.93 0 0 1 .382 2.475v.003l-1.528 5.302a2.96 2.96 0 0 1-2.847 2.142h-7.075a2.99 2.99 0 0 1-2.166-.935l-.007-.007-.066-.072a2.13 2.13 0 0 1-1.821 1.025H4.192a2.13 2.13 0 0 1-2.13-2.13v-8.3a2.13 2.13 0 0 1 2.13-2.13h2.115c.493 0 .948.168 1.31.45m-3.678 1.68c0-.141.114-.255.254-.255h2.115c.14 0 .254.114.254.255v8.3c0 .14-.114.255-.254.255H4.192a.255.255 0 0 1-.255-.255z",clipRule:"evenodd"})));var Cw;function kb(){return kb=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},kb.apply(null,arguments)}const qq=n=>F.createElement("svg",kb({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},n),Cw||(Cw=F.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M11.654 18.664v.001c-.405.523-1.182.524-1.58.037-.162-.2-.25-.444-.25-.69v-3.678a.94.94 0 0 0-.938-.938H5.4c-.359 0-.7-.179-.911-.488l-.001-.001-.369-.548-.003-.004a1.05 1.05 0 0 1-.134-.895l1.532-5.316c.131-.459.559-.782 1.044-.782h7.075c.3 0 .593.127.8.345l1.13 1.222v6.647zm4.73-3.078-3.245 4.223-.002.002c-1.125 1.456-3.339 1.521-4.517.075a2.98 2.98 0 0 1-.671-1.874v-2.74h-2.55c-.99 0-1.908-.496-2.462-1.31l-.002-.004-.368-.547-.002-.002a2.93 2.93 0 0 1-.382-2.475v-.003L3.711 5.63a2.96 2.96 0 0 1 2.847-2.142h7.075c.823 0 1.608.345 2.166.935l.007.007.066.072a2.13 2.13 0 0 1 1.821-1.025h2.115a2.13 2.13 0 0 1 2.13 2.13v8.3a2.13 2.13 0 0 1-2.13 2.13h-2.115a2.12 2.12 0 0 1-1.31-.45m3.678-1.68c0 .141-.114.255-.254.255h-2.115a.255.255 0 0 1-.255-.255v-8.3c0-.14.115-.255.255-.255h2.115c.14 0 .255.114.255.255z",clipRule:"evenodd"})));function zq(n){switch(n){case xe.ADD:return b.createElement(H9,null);case xe.ARROW_LEFT:return b.createElement(B9,null);case xe.ATTACH:return b.createElement(G9,null);case xe.AUDIO_ON_LINED:return b.createElement(V9,null);case xe.BAN:return b.createElement(j9,null);case xe.BROADCAST:return b.createElement(q9,null);case xe.CAMERA:return b.createElement(z9,null);case xe.CHANNELS:return b.createElement(K9,null);case xe.CHAT:return b.createElement(W9,null);case xe.CHAT_FILLED:return b.createElement($9,null);case xe.CHEVRON_DOWN:return b.createElement(Y9,null);case xe.CHEVRON_RIGHT:return b.createElement(Q9,null);case xe.CLOSE:return b.createElement(Z9,null);case xe.COLLAPSE:return b.createElement(X9,null);case xe.COPY:return b.createElement(J9,null);case xe.CREATE:return b.createElement(eq,null);case xe.DELETE:return b.createElement(nq,null);case xe.DISCONNECTED:return b.createElement(tq,null);case xe.DOCUMENT:return b.createElement(rq,null);case xe.DONE:return b.createElement(iq,null);case xe.DONE_ALL:return b.createElement(aq,null);case xe.DOWNLOAD:return b.createElement(sq,null);case xe.EDIT:return b.createElement(uq,null);case xe.EMOJI_MORE:return b.createElement(oq,null);case xe.ERROR:return b.createElement(lq,null);case xe.EXPAND:return b.createElement(dq,null);case xe.FILE_AUDIO:return b.createElement(cq,null);case xe.FILE_DOCUMENT:return b.createElement(fq,null);case xe.FREEZE:return b.createElement(hq,null);case xe.GIF:return b.createElement(pq,null);case xe.INFO:return b.createElement(_q,null);case xe.LEAVE:return b.createElement(mq,null);case xe.MEMBERS:return b.createElement(gq,null);case xe.MESSAGE:return b.createElement(vq,null);case xe.MODERATIONS:return b.createElement(Eq,null);case xe.MORE:return b.createElement(yq,null);case xe.MUTE:return b.createElement(bq,null);case xe.NOTIFICATIONS:return b.createElement(Cq,null);case xe.NOTIFICATIONS_OFF_FILLED:return b.createElement(Iq,null);case xe.OPERATOR:return b.createElement(Tq,null);case xe.PHOTO:return b.createElement(Sq,null);case xe.PLAY:return b.createElement(Nq,null);case xe.PLUS:return b.createElement(Aq,null);case xe.QUESTION:return b.createElement(wq,null);case xe.REFRESH:return b.createElement(Rq,null);case xe.REMOVE:return b.createElement(Mq,null);case xe.REPLY:return b.createElement(Oq,null);case xe.SEARCH:return b.createElement(kq,null);case xe.SEND:return b.createElement(Dq,null);case xe.SETTINGS_FILLED:return b.createElement(Lq,null);case xe.SLIDE_LEFT:return b.createElement(xq,null);case xe.SPINNER:return b.createElement(Uq,null);case xe.SUPERGROUP:return b.createElement(Pq,null);case xe.THREAD:return b.createElement(Fq,null);case xe.THUMBNAIL_NONE:return b.createElement(Hq,null);case xe.TOGGLE_OFF:return b.createElement(Bq,null);case xe.TOGGLE_ON:return b.createElement(Gq,null);case xe.USER:return b.createElement(Vq,null);case xe.FEEDBACK_LIKE:return b.createElement(jq,null);case xe.FEEDBACK_DISLIKE:return b.createElement(qq,null);default:return"icon"}}function mn(n){var t=n.className,e=t===void 0?"":t,r=n.type,i=n.fillColor,a=i===void 0?fi.DEFAULT:i,s=n.width,u=s===void 0?26:s,d=n.height,h=d===void 0?26:d,p=n.onClick,g=p===void 0?ur:p,E=n.children,y=E===void 0?null:E,C=n.testID,T={width:typeof u=="string"?u:"".concat(u,"px"),minWidth:typeof u=="string"?u:"".concat(u,"px"),height:typeof h=="string"?h:"".concat(h,"px"),minHeight:typeof h=="string"?h:"".concat(h,"px")};return b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-icon",F9(r),P9(a)],!1).join(" "),"data-testid":C,role:"button",onClick:g,onKeyDown:g,tabIndex:0,style:T},y||zq(r))}var Ye=xe,sn=fi;/*!
 * css-vars-ponyfill
 * v2.4.9
 * https://jhildenbiddle.github.io/css-vars-ponyfill/
 * (c) 2018-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Ta(){return Ta=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ta.apply(this,arguments)}/*!
 * get-css-data
 * v2.1.0
 * https://github.com/jhildenbiddle/get-css-data
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Iw(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={mimeType:t.mimeType||null,onBeforeSend:t.onBeforeSend||Function.prototype,onSuccess:t.onSuccess||Function.prototype,onError:t.onError||Function.prototype,onComplete:t.onComplete||Function.prototype},r=Array.isArray(n)?n:[n],i=Array.apply(null,Array(r.length)).map(function(h){return null});function a(h){var p=typeof h=="string",g=p&&h.trim().charAt(0)==="<";return p&&!g}function s(h,p){e.onError(h,r[p],p)}function u(h,p){var g=e.onSuccess(h,r[p],p);h=g===!1?"":g||h,i[p]=h,i.indexOf(null)===-1&&e.onComplete(i)}var d=document.createElement("a");r.forEach(function(h,p){d.setAttribute("href",h),d.href=String(d.href);var g=!!(document.all&&!window.atob),E=g&&d.host.split(":")[0]!==location.host.split(":")[0];if(E){var y=d.protocol===location.protocol;if(y){var C=new XDomainRequest;C.open("GET",h),C.timeout=0,C.onprogress=Function.prototype,C.ontimeout=Function.prototype,C.onload=function(){var A=C.responseText;a(A)?u(A,p):s(C,p)},C.onerror=function(A){s(C,p)},setTimeout(function(){C.send()},0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(h,")")),s(null,p)}else{var T=new XMLHttpRequest;T.open("GET",h),e.mimeType&&T.overrideMimeType&&T.overrideMimeType(e.mimeType),e.onBeforeSend(T,h,p),T.onreadystatechange=function(){if(T.readyState===4){var A=T.responseText;T.status<400&&a(A)||T.status===0&&a(A)?u(A,p):s(T,p)}},T.send()}})}/**
 * Gets CSS data from <style> and <link> nodes (including @imports), then
 * returns data in order processed by DOM. Allows specifying nodes to
 * include/exclude and filtering CSS data using RegEx.
 *
 * @preserve
 * @param {object}   [options] The options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes.
 * @param {string}   [options.include] CSS selector matching <link> and <style>
 *                   nodes to include
 * @param {string}   [options.exclude] CSS selector matching <link> and <style>
 *                   nodes to exclude
 * @param {object}   [options.filter] Regular expression used to filter node CSS
 *                   data. Each block of CSS data is tested against the filter,
 *                   and only matching data is included.
 * @param {boolean}  [options.skipDisabled=true] Determines if disabled
 *                   stylesheets will be skipped while collecting CSS data.
 * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
 *                   collected from a stylesheet's runtime values instead of its
 *                   text content. This is required to get accurate CSS data
 *                   when a stylesheet has been modified using the deleteRule()
 *                   or insertRule() methods because these modifications will
 *                   not be reflected in the stylesheet's text content.
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments.
 * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
 *                   1) CSS text, 2) source node reference, and 3) the source
 *                   URL as arguments.
 * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
 *                   object for inspection, 2) soure node reference, and 3) the
 *                   source URL that failed (either a <link> href or an @import)
 *                   as arguments
 * @param {function} [options.onComplete] Callback after all nodes have been
 *                   processed. Passes 1) concatenated CSS text, 2) an array of
 *                   CSS text in DOM order, and 3) an array of nodes in DOM
 *                   order as arguments.
 *
 * @example
 *
 *   getCssData({
 *     rootElement : document,
 *     include     : 'style,link[rel="stylesheet"]',
 *     exclude     : '[href="skip.css"]',
 *     filter      : /red/,
 *     skipDisabled: true,
 *     useCSSOM    : false,
 *     onBeforeSend(xhr, node, url) {
 *       // ...
 *     }
 *     onSuccess(cssText, node, url) {
 *       // ...
 *     }
 *     onError(xhr, node, url) {
 *       // ...
 *     },
 *     onComplete(cssText, cssArray, nodeArray) {
 *       // ...
 *     }
 *   });
 */function Tw(n){var t={cssComments:/\/\*[\s\S]+?\*\//g,cssImports:/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g},e={rootElement:n.rootElement||document,include:n.include||'style,link[rel="stylesheet"]',exclude:n.exclude||null,filter:n.filter||null,skipDisabled:n.skipDisabled!==!1,useCSSOM:n.useCSSOM||!1,onBeforeSend:n.onBeforeSend||Function.prototype,onSuccess:n.onSuccess||Function.prototype,onError:n.onError||Function.prototype,onComplete:n.onComplete||Function.prototype},r=Array.apply(null,e.rootElement.querySelectorAll(e.include)).filter(function(h){return!Kq(h,e.exclude)}),i=Array.apply(null,Array(r.length)).map(function(h){return null});function a(){var h=i.indexOf(null)===-1;if(h){i.reduce(function(g,E,y){return E===""&&g.push(y),g},[]).reverse().forEach(function(g){return[r,i].forEach(function(E){return E.splice(g,1)})});var p=i.join("");e.onComplete(p,i,r)}}function s(h,p,g,E){var y=e.onSuccess(h,g,E);h=y!==void 0&&!y?"":y||h,d(h,g,E,function(C,T){i[p]===null&&(T.forEach(function(A){return e.onError(A.xhr,g,A.url)}),!e.filter||e.filter.test(C)?i[p]=C:i[p]="",a())})}function u(h,p){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],E={};return E.rules=(h.replace(t.cssComments,"").match(t.cssImports)||[]).filter(function(y){return g.indexOf(y)===-1}),E.urls=E.rules.map(function(y){return y.replace(t.cssImports,"$1")}),E.absoluteUrls=E.urls.map(function(y){return NE(y,p)}),E.absoluteRules=E.rules.map(function(y,C){var T=E.urls[C],A=NE(E.absoluteUrls[C],p);return y.replace(T,A)}),E}function d(h,p,g,E){var y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],C=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[],T=u(h,g,C);T.rules.length?Iw(T.absoluteUrls,{onBeforeSend:function(O,N,k){e.onBeforeSend(O,p,N)},onSuccess:function(O,N,k){var D=e.onSuccess(O,p,N);O=D===!1?"":D||O;var P=u(O,N,C);return P.rules.forEach(function(U,L){O=O.replace(U,P.absoluteRules[L])}),O},onError:function(O,N,k){y.push({xhr:O,url:N}),C.push(T.rules[k]),d(h,p,g,E,y,C)},onComplete:function(O){O.forEach(function(N,k){h=h.replace(T.rules[k],N)}),d(h,p,g,E,y,C)}}):E(h,y)}r.length?r.forEach(function(h,p){var g=h.getAttribute("href"),E=h.getAttribute("rel"),y=h.nodeName.toLowerCase()==="link"&&g&&E&&E.toLowerCase().indexOf("stylesheet")!==-1,C=e.skipDisabled===!1?!1:h.disabled,T=h.nodeName.toLowerCase()==="style";if(y&&!C){var A=g.indexOf("data:text/css")!==-1;if(A){var O=decodeURIComponent(g.substring(g.indexOf(",")+1));e.useCSSOM&&(O=Array.apply(null,h.sheet.cssRules).map(function(k){return k.cssText}).join("")),s(O,p,h,location.href)}else Iw(g,{mimeType:"text/css",onBeforeSend:function(D,P,U){e.onBeforeSend(D,h,P)},onSuccess:function(D,P,U){var L=NE(g);s(D,p,h,L)},onError:function(D,P,U){i[p]="",e.onError(D,h,P),a()}})}else if(T&&!C){var N=h.textContent;e.useCSSOM&&(N=Array.apply(null,h.sheet.cssRules).map(function(k){return k.cssText}).join("")),s(N,p,h,location.href)}else i[p]="",a()}):e.onComplete("",[])}function NE(n,t){var e=document.implementation.createHTMLDocument(""),r=e.createElement("base"),i=e.createElement("a");return e.head.appendChild(r),e.body.appendChild(i),r.href=t||document.baseURI||(document.querySelector("base")||{}).href||location.href,i.href=n,i.href}function Kq(n,t){var e=n.matches||n.matchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return e.call(n,t)}var kO=DO;function DO(n,t,e){n instanceof RegExp&&(n=Sw(n,e)),t instanceof RegExp&&(t=Sw(t,e));var r=LO(n,t,e);return r&&{start:r[0],end:r[1],pre:e.slice(0,r[0]),body:e.slice(r[0]+n.length,r[1]),post:e.slice(r[1]+t.length)}}function Sw(n,t){var e=t.match(n);return e?e[0]:null}DO.range=LO;function LO(n,t,e){var r,i,a,s,u,d=e.indexOf(n),h=e.indexOf(t,d+1),p=d;if(d>=0&&h>0){if(n===t)return[d,h];for(r=[],a=e.length;p>=0&&!u;)p==d?(r.push(p),d=e.indexOf(n,p+1)):r.length==1?u=[r.pop(),h]:(i=r.pop(),i<a&&(a=i,s=h),h=e.indexOf(t,p+1)),p=d<h&&d>=0?d:h;r.length&&(u=[a,s])}return u}function TC(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={preserveStatic:!0,removeComments:!1},r=Ta({},e,t),i=[];function a($){throw new Error("CSS parse error: ".concat($))}function s($){var Z=$.exec(n);if(Z)return n=n.slice(Z[0].length),Z}function u(){return s(/^{\s*/)}function d(){return s(/^}/)}function h(){s(/^\s*/)}function p(){if(h(),!(n[0]!=="/"||n[1]!=="*")){for(var $=2;n[$]&&(n[$]!=="*"||n[$+1]!=="/");)$++;if(!n[$])return a("end of comment is missing");var Z=n.slice(2,$);return n=n.slice($+2),{type:"comment",comment:Z}}}function g(){for(var $=[],Z;Z=p();)$.push(Z);return r.removeComments?[]:$}function E(){for(h();n[0]==="}";)a("extra closing bracket");var $=s(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if($){var Z=$[0].trim(),ne,ue=/\/\*/.test(Z);ue&&(Z=Z.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var pe=/["']\w*,\w*["']/.test(Z);pe&&(Z=Z.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(le){return le.replace(/,/g,"‌")}));var he=/,/.test(Z);return he?ne=Z.split(/\s*(?![^(]*\)),\s*/):ne=[Z],pe&&(ne=ne.map(function(le){return le.replace(/\u200C/g,",")})),ne}}function y(){if(n[0]==="@")return z();s(/^([;\s]*)+/);var $=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,Z=s(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(Z){if(Z=Z[0].trim(),!s(/^:\s*/))return a("property missing ':'");var ne=s(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),ue={type:"declaration",property:Z.replace($,""),value:ne?ne[0].replace($,"").trim():""};return s(/^[;\s]*/),ue}}function C(){if(!u())return a("missing '{'");for(var $,Z=g();$=y();)Z.push($),Z=Z.concat(g());return d()?Z:a("missing '}'")}function T(){h();for(var $=[],Z;Z=s(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)$.push(Z[1]),s(/^,\s*/);if($.length)return{type:"keyframe",values:$,declarations:C()}}function A(){var $=s(/^@([-\w]+)?keyframes\s*/);if($){var Z=$[1];if($=s(/^([-\w]+)\s*/),!$)return a("@keyframes missing name");var ne=$[1];if(!u())return a("@keyframes missing '{'");for(var ue,pe=g();ue=T();)pe.push(ue),pe=pe.concat(g());return d()?{type:"keyframes",name:ne,vendor:Z,keyframes:pe}:a("@keyframes missing '}'")}}function O(){var $=s(/^@page */);if($){var Z=E()||[];return{type:"page",selectors:Z,declarations:C()}}}function N(){var $=s(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if($){var Z="".concat($[1],"-").concat($[2])+($[3]?"-".concat($[3]):"");return{type:"page-margin-box",name:Z,declarations:C()}}}function k(){var $=s(/^@font-face\s*/);if($)return{type:"font-face",declarations:C()}}function D(){var $=s(/^@supports *([^{]+)/);if($)return{type:"supports",supports:$[1].trim(),rules:Q()}}function P(){var $=s(/^@host\s*/);if($)return{type:"host",rules:Q()}}function U(){var $=s(/^@media([^{]+)*/);if($)return{type:"media",media:($[1]||"").trim(),rules:Q()}}function L(){var $=s(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if($)return{type:"custom-media",name:$[1].trim(),media:$[2].trim()}}function B(){var $=s(/^@([-\w]+)?document *([^{]+)/);if($)return{type:"document",document:$[2].trim(),vendor:$[1]?$[1].trim():null,rules:Q()}}function q(){var $=s(/^@(import|charset|namespace)\s*([^;]+);/);if($)return{type:$[1],name:$[2].trim()}}function z(){if(h(),n[0]==="@"){var $=q()||k()||U()||A()||D()||B()||L()||P()||O()||N();if($&&!r.preserveStatic){var Z=!1;if($.declarations)Z=$.declarations.some(function(ue){return/var\(/.test(ue.value)});else{var ne=$.keyframes||$.rules||[];Z=ne.some(function(ue){return(ue.declarations||[]).some(function(pe){return/var\(/.test(pe.value)})})}return Z?$:{}}return $}}function Y(){if(!r.preserveStatic){var $=kO("{","}",n);if($){var Z=/:(?:root|host)(?![.:#(])/.test($.pre)&&/--\S*\s*:/.test($.body),ne=/var\(/.test($.body);if(!Z&&!ne)return n=n.slice($.end+1),{}}}var ue=E()||[],pe=r.preserveStatic?C():C().filter(function(he){var le=ue.some(function(ve){return/:(?:root|host)(?![.:#(])/.test(ve)})&&/^--\S/.test(he.property),we=/var\(/.test(he.value);return le||we});return ue.length||a("selector missing"),{type:"rule",selectors:ue,declarations:pe}}function Q($){if(!$&&!u())return a("missing '{'");for(var Z,ne=g();n.length&&($||n[0]!=="}")&&(Z=z()||Y());)Z.type&&ne.push(Z),ne=ne.concat(g());return!$&&!d()?a("missing '}'"):ne}return{type:"stylesheet",stylesheet:{rules:Q(!0),errors:i}}}function Nw(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={parseHost:!1,store:{},onWarning:function(){}},r=Ta({},e,t),i=new RegExp(":".concat(r.parseHost?"host":"root","$"));return typeof n=="string"&&(n=TC(n,r)),n.stylesheet.rules.forEach(function(a){a.type!=="rule"||!a.selectors.some(function(s){return i.test(s)})||a.declarations.forEach(function(s,u){var d=s.property,h=s.value;d&&d.indexOf("--")===0&&(r.store[d]=h)})}),r.store}function xO(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",e=arguments.length>2?arguments[2]:void 0,r={charset:function(s){return"@charset "+s.name+";"},comment:function(s){return s.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+s.comment+"*/":""},"custom-media":function(s){return"@custom-media "+s.name+" "+s.media+";"},declaration:function(s){return s.property+":"+s.value+";"},document:function(s){return"@"+(s.vendor||"")+"document "+s.document+"{"+i(s.rules)+"}"},"font-face":function(s){return"@font-face{"+i(s.declarations)+"}"},host:function(s){return"@host{"+i(s.rules)+"}"},import:function(s){return"@import "+s.name+";"},keyframe:function(s){return s.values.join(",")+"{"+i(s.declarations)+"}"},keyframes:function(s){return"@"+(s.vendor||"")+"keyframes "+s.name+"{"+i(s.keyframes)+"}"},media:function(s){return"@media "+s.media+"{"+i(s.rules)+"}"},namespace:function(s){return"@namespace "+s.name+";"},page:function(s){return"@page "+(s.selectors.length?s.selectors.join(", "):"")+"{"+i(s.declarations)+"}"},"page-margin-box":function(s){return"@"+s.name+"{"+i(s.declarations)+"}"},rule:function(s){var u=s.declarations;if(u.length)return s.selectors.join(",")+"{"+i(u)+"}"},supports:function(s){return"@supports "+s.supports+"{"+i(s.rules)+"}"}};function i(a){for(var s="",u=0;u<a.length;u++){var d=a[u];e&&e(d);var h=r[d.type](d);h&&(s+=h,h.length&&d.selectors&&(s+=t))}return s}return i(n.stylesheet.rules)}function UO(n,t){n.rules.forEach(function(e){if(e.rules){UO(e,t);return}if(e.keyframes){e.keyframes.forEach(function(r){r.type==="keyframe"&&t(r.declarations,e)});return}e.declarations&&t(e.declarations,n)})}var Wq="--",$q="var";function Yq(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},r=Ta({},e,t);return typeof n=="string"&&(n=TC(n,r)),UO(n.stylesheet,function(i,a){for(var s=0;s<i.length;s++){var u=i[s],d=u.type,h=u.property,p=u.value;if(d==="declaration"){if(!r.preserveVars&&h&&h.indexOf(Wq)===0){i.splice(s,1),s--;continue}if(p.indexOf($q+"(")!==-1){var g=$f(p,r);g!==u.value&&(g=Qq(g),r.preserveVars?(i.splice(s,0,{type:d,property:h,value:g}),s++):u.value=g)}}}}),xO(n)}function Qq(n){var t=/calc\(([^)]+)\)/g;return(n.match(t)||[]).forEach(function(e){var r="calc".concat(e.split("calc").join(""));n=n.replace(e,r)}),n}function $f(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;if(n.indexOf("var(")===-1)return n;var r=kO("(",")",n);function i(s){var u=s.split(",")[0].replace(/[\s\n\t]/g,""),d=(s.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],h=Object.prototype.hasOwnProperty.call(t.variables,u)?String(t.variables[u]):void 0,p=h||(d?String(d):void 0),g=e||s;return h||t.onWarning('variable "'.concat(u,'" is undefined')),p&&p!=="undefined"&&p.length>0?$f(p,t,g):"var(".concat(g,")")}if(r)if(r.pre.slice(-3)==="var"){var a=r.body.trim().length===0;return a?(t.onWarning("var() must contain a non-whitespace string"),n):r.pre.slice(0,-3)+i(r.body)+$f(r.post,t)}else return r.pre+"(".concat($f(r.body,t),")")+$f(r.post,t);else return n.indexOf("var(")!==-1&&t.onWarning('missing closing ")" in the value "'.concat(n,'"')),n}var Pm=typeof window<"u",Aw=Pm&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),Ll={group:0,job:0},l_={rootElement:Pm?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},Qs={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},ii={dom:{},job:{},user:{}},L_=!1,za=null,Yf=0,Db=null,Lb=!1;/**
 * Fetches, parses, and transforms CSS custom properties from specified
 * <style> and <link> elements into static values, then appends a new <style>
 * element with static values to the DOM to provide CSS custom property
 * compatibility for legacy browsers. Also provides a single interface for
 * live updates of runtime values in both modern and legacy browsers.
 *
 * @preserve
 * @param {object}   [options] Options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes
 * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
 *                   and <style> nodes will be processed.
 * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
 *                   matching <link re="stylesheet"> and <style> nodes to
 *                   process
 * @param {string}   [options.exclude] CSS selector matching <link
 *                   rel="stylehseet"> and <style> nodes to exclude from those
 *                   matches by options.include
 * @param {object}   [options.variables] A map of custom property name/value
 *                   pairs. Property names can omit or include the leading
 *                   double-hyphen (—), and values specified will override
 *                   previous values
 * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
 *                   only generate legacy-compatible CSS in browsers that lack
 *                   native support (i.e., legacy browsers)
 * @param {boolean}  [options.preserveStatic=true] Determines if CSS
 *                   declarations that do not reference a custom property will
 *                   be preserved in the transformed CSS
 * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
 *                   property declarations will be preserved in the transformed
 *                   CSS
 * @param {boolean}  [options.silent=false] Determines if warning and error
 *                   messages will be displayed on the console
 * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
 *                   update the DOM after processing CSS custom properties
 * @param {boolean}  [options.updateURLs=true] Determines if relative url()
 *                   paths will be converted to absolute urls in external CSS
 * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
 *                   be created that will execute the ponyfill when a <link> or
 *                   <style> DOM mutation is observed
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments
 * @param {function} [options.onError] Callback after a CSS parsing error has
 *                   occurred or an XHR request has failed. Passes 1) an error
 *                   message, and 2) source node reference, 3) xhr, and 4 url as
 *                   arguments.
 * @param {function} [options.onWarning] Callback after each CSS parsing warning
 *                   has occurred. Passes 1) a warning message as an argument.
 * @param {function} [options.onSuccess] Callback after CSS data has been
 *                   collected from each node and before CSS custom properties
 *                   have been transformed. Allows modifying the CSS data before
 *                   it is transformed by returning any string value (or false
 *                   to skip). Passes 1) CSS text, 2) source node reference, and
 *                   3) the source URL as arguments.
 * @param {function} [options.onComplete] Callback after all CSS has been
 *                   processed, legacy-compatible CSS has been generated, and
 *                   (optionally) the DOM has been updated. Passes 1) a CSS
 *                   string with CSS variable values resolved, 2) an array of
 *                   output <style> node references that have been appended to
 *                   the DOM, 3) an object containing all custom properies names
 *                   and values, and 4) the ponyfill execution time in
 *                   milliseconds.
 * @param {function} [options.onFinally] Callback in modern and legacy browsers
 *                   after the ponyfill has finished all tasks. Passes 1) a
 *                   boolean indicating if the last ponyfill call resulted in a
 *                   style change, 2) a boolean indicating if the current
 *                   browser provides native support for CSS custom properties,
 *                   and 3) the ponyfill execution time in milliseconds.
 * @example
 *
 *   cssVars({
 *     rootElement   : document,
 *     shadowDOM     : false,
 *     include       : 'style,link[rel="stylesheet"]',
 *     exclude       : '',
 *     variables     : {},
 *     onlyLegacy    : true,
 *     preserveStatic: true,
 *     preserveVars  : false,
 *     silent        : false,
 *     updateDOM     : true,
 *     updateURLs    : true,
 *     watch         : false,
 *     onBeforeSend(xhr, node, url) {},
 *     onError(message, node, xhr, url) {},
 *     onWarning(message) {},
 *     onSuccess(cssText, node, url) {},
 *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
 *     onFinally(hasChanged, hasNativeSupport, benchmark)
 *   });
 */function xu(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t="cssVars(): ",e=Ta({},l_,n);function r(p,g,E,y){!e.silent&&window.console&&console.error("".concat(t).concat(p,`
`),g),e.onError(p,g,E,y)}function i(p){!e.silent&&window.console&&console.warn("".concat(t).concat(p)),e.onWarning(p)}function a(p){e.onFinally(!!p,Aw,AE()-e.__benchmark)}if(Pm){if(e.watch){e.watch=l_.watch,Zq(e),xu(e);return}else e.watch===!1&&za&&(za.disconnect(),za=null);if(!e.__benchmark){if(L_===e.rootElement){Xq(n);return}var s=[].slice.call(e.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(e.__benchmark=AE(),e.exclude=[za?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",e.exclude].filter(function(p){return p}).join(","),e.variables=nz(e.variables),s.forEach(function(p){var g=p.nodeName.toLowerCase()==="style"&&p.__cssVars.text,E=g&&p.textContent!==p.__cssVars.text;g&&E&&(p.sheet&&(p.sheet.disabled=!1),p.setAttribute("data-cssvars",""))}),!za){var u=[].slice.call(e.rootElement.querySelectorAll('[data-cssvars="out"]'));u.forEach(function(p){var g=p.getAttribute("data-cssvars-group"),E=g?e.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(g,'"]')):null;E||p.parentNode.removeChild(p)}),Yf&&s.length<Yf&&(Yf=s.length,ii.dom={})}}if(document.readyState!=="loading")if(Aw&&e.onlyLegacy){var d=!1;if(e.updateDOM){var h=e.rootElement.host||(e.rootElement===document?document.documentElement:e.rootElement);Object.keys(e.variables).forEach(function(p){var g=e.variables[p];d=d||g!==getComputedStyle(h).getPropertyValue(p),h.style.setProperty(p,g)})}a(d)}else!Lb&&(e.shadowDOM||e.rootElement.shadowRoot||e.rootElement.host)?Tw({rootElement:l_.rootElement,include:l_.include,exclude:e.exclude,skipDisabled:!1,onSuccess:function(g,E,y){var C=(E.sheet||{}).disabled&&!E.__cssVars;return C?!1:(g=g.replace(Qs.cssComments,"").replace(Qs.cssMediaQueries,""),g=(g.match(Qs.cssVarDeclRules)||[]).join(""),g||!1)},onComplete:function(g,E,y){Nw(g,{store:ii.dom,onWarning:i}),Lb=!0,xu(e)}}):(L_=e.rootElement,Tw({rootElement:e.rootElement,include:e.include,exclude:e.exclude,skipDisabled:!1,onBeforeSend:e.onBeforeSend,onError:function(g,E,y){var C=g.responseURL||PO(y,location.href),T=g.statusText?"(".concat(g.statusText,")"):"Unspecified Error"+(g.status===0?" (possibly CORS related)":""),A="CSS XHR Error: ".concat(C," ").concat(g.status," ").concat(T);r(A,E,g,C)},onSuccess:function(g,E,y){var C=(E.sheet||{}).disabled&&!E.__cssVars;if(C)return!1;var T=E.nodeName.toLowerCase()==="link",A=E.nodeName.toLowerCase()==="style"&&g!==E.textContent,O=e.onSuccess(g,E,y);return g=O!==void 0&&!O?"":O||g,e.updateURLs&&(T||A)&&(g=ez(g,y)),g},onComplete:function(g,E){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],C=Ta({},ii.dom,ii.user),T=!1;if(ii.job={},y.forEach(function(L,B){var q=E[B];if(L.__cssVars=L.__cssVars||{},L.__cssVars.text=q,Qs.cssVars.test(q))try{var z=TC(q,{preserveStatic:e.preserveStatic,removeComments:!0});Nw(z,{parseHost:!!e.rootElement.host,store:ii.dom,onWarning:i}),L.__cssVars.tree=z}catch(Y){r(Y.message,L)}}),Ta(ii.job,ii.dom),e.updateDOM?(Ta(ii.user,e.variables),Ta(ii.job,ii.user)):(Ta(ii.job,ii.user,e.variables),Ta(C,e.variables)),T=Ll.job>0&&!!(Object.keys(ii.job).length>Object.keys(C).length||Object.keys(C).length&&Object.keys(ii.job).some(function(L){return ii.job[L]!==C[L]})),T)xb(e.rootElement),xu(e);else{var A=[],O=[],N=!1;if(e.updateDOM&&Ll.job++,y.forEach(function(L,B){var q=!L.__cssVars.tree;if(L.__cssVars.tree)try{Yq(L.__cssVars.tree,Ta({},e,{variables:ii.job,onWarning:i}));var z=xO(L.__cssVars.tree);if(e.updateDOM){var Y=E[B],Q=Qs.cssVarFunc.test(Y);if(L.getAttribute("data-cssvars")||L.setAttribute("data-cssvars","src"),z.length&&Q){var $=L.getAttribute("data-cssvars-group")||++Ll.group,Z=z.replace(/\s/g,""),ne=e.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat($,'"]'))||document.createElement("style");N=N||Qs.cssKeyframes.test(z),e.preserveStatic&&L.sheet&&(L.sheet.disabled=!0),ne.hasAttribute("data-cssvars")||ne.setAttribute("data-cssvars","out"),Z===L.textContent.replace(/\s/g,"")?(q=!0,ne&&ne.parentNode&&(L.removeAttribute("data-cssvars-group"),ne.parentNode.removeChild(ne))):Z!==ne.textContent.replace(/\s/g,"")&&([L,ne].forEach(function(ue){ue.setAttribute("data-cssvars-job",Ll.job),ue.setAttribute("data-cssvars-group",$)}),ne.textContent=z,A.push(z),O.push(ne),ne.parentNode||L.parentNode.insertBefore(ne,L.nextSibling))}}else L.textContent.replace(/\s/g,"")!==z&&A.push(z)}catch(ue){r(ue.message,L)}q&&L.setAttribute("data-cssvars","skip"),L.hasAttribute("data-cssvars-job")||L.setAttribute("data-cssvars-job",Ll.job)}),Yf=e.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,e.shadowDOM){for(var k=[].concat(e.rootElement).concat([].slice.call(e.rootElement.querySelectorAll("*"))),D=0,P;P=k[D];++D)if(P.shadowRoot&&P.shadowRoot.querySelector("style")){var U=Ta({},e,{rootElement:P.shadowRoot});xu(U)}}e.updateDOM&&N&&Jq(e.rootElement),L_=!1,e.onComplete(A.join(""),O,JSON.parse(JSON.stringify(ii.job)),AE()-e.__benchmark),a(O.length)}}}));else document.addEventListener("DOMContentLoaded",function p(g){xu(n),document.removeEventListener("DOMContentLoaded",p)})}}xu.reset=function(){Ll.job=0,Ll.group=0,L_=!1,za&&(za.disconnect(),za=null),Yf=0,Db=null,Lb=!1;for(var n in ii)ii[n]={}};function Zq(n){function t(d){var h=e(d)&&d.hasAttribute("disabled"),p=(d.sheet||{}).disabled;return h||p}function e(d){var h=d.nodeName.toLowerCase()==="link"&&(d.getAttribute("rel")||"").indexOf("stylesheet")!==-1;return h}function r(d){return d.nodeName.toLowerCase()==="style"}function i(d){var h=!1;if(d.type==="attributes"&&e(d.target)&&!t(d.target)){var p=d.attributeName==="disabled",g=d.attributeName==="href",E=d.target.getAttribute("data-cssvars")==="skip",y=d.target.getAttribute("data-cssvars")==="src";p?h=!E&&!y:g&&(E?d.target.setAttribute("data-cssvars",""):y&&xb(n.rootElement,!0),h=!0)}return h}function a(d){var h=!1;if(d.type==="childList"){var p=r(d.target),g=d.target.getAttribute("data-cssvars")==="out";h=p&&!g}return h}function s(d){var h=!1;return d.type==="childList"&&(h=[].slice.call(d.addedNodes).some(function(p){var g=p.nodeType===1,E=g&&p.hasAttribute("data-cssvars"),y=r(p)&&Qs.cssVars.test(p.textContent),C=!E&&(e(p)||y);return C&&!t(p)})),h}function u(d){var h=!1;return d.type==="childList"&&(h=[].slice.call(d.removedNodes).some(function(p){var g=p.nodeType===1,E=g&&p.getAttribute("data-cssvars")==="out",y=g&&p.getAttribute("data-cssvars")==="src",C=y;if(y||E){var T=p.getAttribute("data-cssvars-group"),A=n.rootElement.querySelector('[data-cssvars-group="'.concat(T,'"]'));y&&xb(n.rootElement,!0),A&&A.parentNode.removeChild(A)}return C})),h}window.MutationObserver&&(za&&(za.disconnect(),za=null),za=new MutationObserver(function(d){var h=d.some(function(p){return i(p)||a(p)||s(p)||u(p)});h&&xu(n)}),za.observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function Xq(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;clearTimeout(Db),Db=setTimeout(function(){n.__benchmark=null,xu(n)},t)}function Jq(n){var t=["animation-name","-moz-animation-name","-webkit-animation-name"].filter(function(E){return getComputedStyle(document.body)[E]})[0];if(t){for(var e=[].slice.call(n.querySelectorAll("*")),r=[],i="__CSSVARSPONYFILL-KEYFRAMES__",a=0,s=e.length;a<s;a++){var u=e[a],d=getComputedStyle(u)[t];d!=="none"&&(u.style[t]+=i,r.push(u))}document.body.offsetHeight;for(var h=0,p=r.length;h<p;h++){var g=r[h].style;g[t]=g[t].replace(i,"")}}}function ez(n,t){var e=n.replace(Qs.cssComments,"").match(Qs.cssUrls)||[];return e.forEach(function(r){var i=r.replace(Qs.cssUrls,"$1"),a=PO(i,t);n=n.replace(r,r.replace(i,a))}),n}function nz(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=/^-{2}/;return Object.keys(n).reduce(function(e,r){var i=t.test(r)?r:"--".concat(r.replace(/^-+/,""));return e[i]=n[r],e},{})}function PO(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:location.href,e=document.implementation.createHTMLDocument(""),r=e.createElement("base"),i=e.createElement("a");return e.head.appendChild(r),e.body.appendChild(i),r.href=t,i.href=n,i.href}function AE(){return Pm&&(window.performance||{}).now?window.performance.now():new Date().getTime()}function xb(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=[].slice.call(n.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));e.forEach(function(r){return r.setAttribute("data-cssvars","")}),t&&(ii.dom={})}var fs=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,e=n==="x"?t:t&3|8;return e.toString(16)})},tz=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._channels=new Map,e._enteredChannelUrls=[],e}return j(t,n),Object.defineProperty(t.prototype,"enteredChannels",{get:function(){var e=this;return this._enteredChannelUrls.map(function(r){return e._channels.get(r)}).filter(function(r){return!!r})},enumerable:!1,configurable:!0}),t.prototype.isEnteredChannel=function(e){return this._enteredChannelUrls.includes(e)},t.prototype.enter=function(e){this._enteredChannelUrls.indexOf(e)<0&&this._enteredChannelUrls.push(e)},t.prototype.exit=function(e){var r=this._enteredChannelUrls.indexOf(e);r>=0&&this._enteredChannelUrls.splice(r,1)},t.prototype.exitAll=function(){this._enteredChannelUrls=[]},t.prototype.get=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2,this._channels.get(e)]})})},t.prototype.upsert=function(e){return M(this,void 0,void 0,function(){var r,i=this;return R(this,function(a){return r=[],e.forEach(function(s){if(i._channels.has(s.url)){var u=i._channels.get(s.url);Object.assign(u,s),r.push(u)}else i._channels.set(s.url,s),r.push(s)}),[2,r]})})},t.prototype.remove=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return this._channels.delete(e),this.exit(e),[2]})})},t.prototype.clear=function(){return M(this,void 0,void 0,function(){return R(this,function(e){return this._channels.clear(),this._enteredChannelUrls=[],[2]})})},t}(Zr),FO={channelUrl:void 0,name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,isEphemeral:void 0},rz=function(n){function t(e){var r=e.channelUrl,i=e.isInternalCall,a=n.call(this)||this;return a.method=Ie.GET,a.path="".concat(i?N5:id,"/").concat(encodeURIComponent(r)),a.params={show_pinned_messages:!0},a}return j(t,n),t}(Te),ww=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new bc(e,r),i}return j(t,n),t}(Me),iz=function(n){function t(e){var r=this,i=e.channelUrl,a=e.coverUrlOrImage,s=e.name,u=e.data,d=e.customType,h=e.operatorUserIds,p=e.isEphemeral;return(r=n.call(this)||this).method=Ie.POST,r.path=id,r.params=ze(_n({channel_url:i,cover_url:J("string",a)?a:null,cover_file:oi(a)?a:null,name:s,data:u,custom_type:d,operators:h,is_ephemeral:p})),r}return j(t,n),t}(Te);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new bc(e,r),i}j(t,n)})(Me);var az=function(n){function t(e){var r=e.channelUrl;return n.call(this,{code:"ENTR",payload:{channel_url:r},ackRequired:!0})||this}return j(t,n),t}(Ai),HO=function(n){function t(e,r,i){var a,s,u=this;return u=n.call(this,e,"SYEV",i)||this,i.data&&(u.participantCount=(a=i.data.participant_count)!==null&&a!==void 0?a:0,u.user=new _t(e,i.data),u.ts=(s=i.data.edge_ts)!==null&&s!==void 0?s:0),u}return j(t,n),t}(qu),sz=function(n){function t(e){var r=e.channelUrl;return n.call(this,{code:"EXIT",payload:{channel_url:r},ackRequired:!0})||this}return j(t,n),t}(Ai),BO=function(n){function t(e,r,i){var a,s,u=this;return u=n.call(this,e,"EXIT",i)||this,i.data&&(u.participantCount=(a=i.data.participant_count)!==null&&a!==void 0?a:0,u.user=new _t(e,i.data),u.ts=(s=i.data.edge_ts)!==null&&s!==void 0?s:0),u}return j(t,n),t}(qu),wE={},bs=function(n){function t(e,r){var i=n.call(this,e,W(W({},r),{channelType:vt.OPEN}))||this;return i.subscribeChannelEvent=Kn,i.unsubscribeChannelEvent=Kn,i.refreshChannel=function(){return M(i,void 0,void 0,function(){return R(this,function(a){return[2,Kn()]})})},i._openChannelCache=new tz(e),i._openChannelHandlers=new Map,i._dispatcher.on(function(a){var s,u;if(a instanceof dr)i._handleEvent(a).catch(function(g){if(Gi(g)&&i._sdkState.appState==="foreground")throw g});else if(a instanceof Aa&&a.stateType===Gt.CONNECTED){var d=i._openChannelCache.enteredChannels;try{for(var h=Le(d),p=h.next();!p.done;p=h.next())p.value.enter()}catch(g){s={error:g}}finally{try{p&&!p.done&&(u=h.return)&&u.call(h)}finally{if(s)throw s.error}}}}),wE[e]||(wE[e]=i),i}return j(t,n),t.of=function(e){return wE[e]},t.prototype.buildOpenChannelFromSerializedData=function(e){var r=ko(e);return new bc(this._iid,bc.payloadify(r))},t.prototype.getChannelFromCache=function(e){var r;return M(this,void 0,void 0,function(){return R(this,function(i){switch(i.label){case 0:return[4,this._openChannelCache.get(e)];case 1:return[2,(r=i.sent())!==null&&r!==void 0?r:null]}})})},t.prototype.upsertChannelsToCache=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){switch(r.label){case 0:return[4,this._openChannelCache.upsert(e)];case 1:return[2,r.sent()]}})})},t.prototype.removeChannelsFromCache=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d;return R(this,function(h){switch(h.label){case 0:h.trys.push([0,5,6,7]),r=Le(e),i=r.next(),h.label=1;case 1:return i.done?[3,4]:(a=i.value,[4,this._openChannelCache.remove(a)]);case 2:h.sent(),h.label=3;case 3:return i=r.next(),[3,1];case 4:return[3,7];case 5:return s=h.sent(),u={error:s},[3,7];case 6:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(u)throw u.error}return[7];case 7:return[2]}})})},t.prototype.setEnteredToCache=function(e){this._openChannelCache.enter(e.url)},t.prototype.setExitedToCache=function(e){this._openChannelCache.exit(e.url)},Object.defineProperty(t.prototype,"handlers",{get:function(){return Nn([],cn(this._openChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),t.prototype._handleEvent=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z,Y,Q,$,Z,ne,ue,pe,he,le,we,ve,Ue,be,Qe,Ne,$e,gn,En,Yn,Gn,Tn,kn,Vn,Hn,Jn,jn,On,Ln,An,wn,We,ln,Pe,Ke,yn,tn,st,Cn,Ve,Ut,mt,ut,In,Qn,Ct,Et,ct,Qt,Ot,ft,rt=this;return R(this,function(xn){switch(xn.label){case 0:switch(xn.trys.push([0,59,,60]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"MRCT":return[3,10];case"MTHD":return[3,13];case"MCNT":return[3,16];case"PEDI":return[3,27];case"VOTE":return[3,30];case"SYEV":return[3,33]}return[3,58];case 1:return s=null,e.code==="MESG"?s=e.as(cC):e.code==="FILE"?s=e.as(sC):e.code!=="ADMM"&&e.code!="BRDM"||(s=e.as(KM)),s?(r=s.message,i=s.isMentioned,r.channelType!==vt.OPEN?[3,3]:[4,this.getChannel(r.channelUrl,!0)]):[3,3];case 2:a=xn.sent(),an(function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())nn=Ee.value,this._openChannelCache.isEnteredChannel(a.url)&&(nn.onMessageReceived&&nn.onMessageReceived(a,r),i&&nn.onMentionReceived&&nn.onMentionReceived(a,r))}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),xn.label=3;case 3:return[3,58];case 4:return s=null,e.code==="MEDI"?s=e.as(nm):e.code==="FEDI"?s=e.as(tm):e.code==="AEDI"&&(s=e.as(WM)),s?(u=s.message,d=s.mentionCountChange,u.channelType!==vt.OPEN?[3,6]:[4,this.getChannel(u.channelUrl,!0)]):[3,6];case 5:h=xn.sent(),p=!1,h.lastPinnedMessage&&h.lastPinnedMessage.messageId===u.messageId&&h.lastPinnedMessage.updatedAt<u.updatedAt&&(h.lastPinnedMessage=u,p=!0),an(function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn,lt,qn;return R(this,function(Fn){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())nn=Ee.value,this._openChannelCache.isEnteredChannel(h.url)&&(p&&((lt=nn.onPinnedMessageUpdated)===null||lt===void 0||lt.call(nn,h),(qn=nn.onChannelChanged)===null||qn===void 0||qn.call(nn,h)),nn.onMessageUpdated&&nn.onMessageUpdated(h,u),d>0&&nn.onMentionReceived&&nn.onMentionReceived(h,u))}catch(At){Sn={error:At}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),xn.label=6;case 6:return[3,58];case 7:return g=e.as(v2),he=g.channelUrl,le=g.channelType,E=g.messageId,le!==vt.OPEN?[3,9]:[4,this.getChannel(he,!0)];case 8:y=xn.sent(),an(function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())nn=Ee.value,this._openChannelCache.isEnteredChannel(y.url)&&nn.onMessageDeleted&&nn.onMessageDeleted(y,E)}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),xn.label=9;case 9:return[3,58];case 10:return C=e.as($M),he=C.channelUrl,le=C.channelType,T=C.event,le!==vt.OPEN?[3,12]:[4,this.getChannel(he,!0)];case 11:A=xn.sent(),an(function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())nn=Ee.value,this._openChannelCache.isEnteredChannel(A.url)&&nn.onReactionUpdated&&nn.onReactionUpdated(A,T)}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),xn.label=12;case 12:return[3,58];case 13:return(O=e.as(YM).event).channelType!==vt.OPEN?[3,15]:[4,this.getChannel(O.channelUrl,!0)];case 14:N=xn.sent(),an(function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())nn=Ee.value,this._openChannelCache.isEnteredChannel(N.url)&&nn.onThreadInfoUpdated&&nn.onThreadInfoUpdated(N,O)}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),xn.label=15;case 15:return[3,58];case 16:k=e.as(QM).openChannelMemberCounts,D=[],xn.label=17;case 17:xn.trys.push([17,22,23,24]),P=Le(k),U=P.next(),xn.label=18;case 18:return U.done?[3,21]:(L=U.value,he=L.channelUrl,En=L.participantCount,B=L.updatedAt,[4,this.getChannelFromCache(he)]);case 19:(q=xn.sent())&&q._updateParticipantCount(En,B)&&D.push(q),xn.label=20;case 20:return U=P.next(),[3,18];case 21:return[3,24];case 22:return z=xn.sent(),Ot={error:z},[3,24];case 23:try{U&&!U.done&&(ft=P.return)&&ft.call(P)}finally{if(Ot)throw Ot.error}return[7];case 24:return D.length>0?[4,this.upsertChannelsToCache(D)]:[3,26];case 25:Y=xn.sent(),an(function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())(nn=Ee.value).onChannelMemberCountChanged&&nn.onChannelMemberCountChanged(Y)}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),xn.label=26;case 26:return[3,58];case 27:return Q=e.as(ZM),$=Q.event,Z=Q.status,he=Q.channelUrl,le=Q.channelType,he&&le===vt.OPEN?[4,this.getChannel(he,!0)]:[3,29];case 28:ne=xn.sent(),this._dispatcher.dispatch(new iC({event:$,source:ge.EVENT_POLL_UPDATED})),an(Z===eM?function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())(nn=Ee.value).onPollDeleted&&nn.onPollDeleted(ne,$.pollId)}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}:function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())(nn=Ee.value).onPollUpdated&&nn.onPollUpdated(ne,$)}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),xn.label=29;case 29:return[3,58];case 30:return ue=e.as(fC),pe=ue.event,he=ue.channelUrl,le=ue.channelType,he&&le===vt.OPEN?[4,this.getChannel(he,!0)]:[3,32];case 31:we=xn.sent(),this._dispatcher.dispatch(new km({event:pe,source:ge.EVENT_POLL_VOTED})),an(function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())(nn=Ee.value).onPollVoted&&nn.onPollVoted(we,pe)}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),xn.label=32;case 32:return[3,58];case 33:if(!(ve=e.as(qu).event).isOpenChannelEvent)return[3,57];switch(ve.category){case Wt.CHANNEL_ENTER:return[3,34];case Wt.CHANNEL_EXIT:return[3,36];case Wt.CHANNEL_OPERATOR_UPDATE:return[3,38];case Wt.USER_CHANNEL_MUTE:case Wt.USER_CHANNEL_UNMUTE:return[3,40];case Wt.USER_CHANNEL_BAN:case Wt.USER_CHANNEL_UNBAN:return[3,42];case Wt.CHANNEL_FREEZE:case Wt.CHANNEL_UNFREEZE:return[3,44];case Wt.CHANNEL_DELETED:return[3,46];case Wt.CHANNEL_PROP_CHANGED:return[3,49];case Wt.CHANNEL_META_DATA_CHANGED:return[3,51];case Wt.CHANNEL_META_COUNTERS_CHANGED:return[3,53];case Wt.PINNED_MESSAGE_CHANGED:return[3,55]}return[3,57];case 34:return[4,this.getChannel(ve.channelUrl,!0)];case 35:return Ue=xn.sent(),be=e.as(HO),En=be.participantCount,Qe=be.user,Ne=Ue._updateParticipantCount(En,ve.ts),an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){Ee.onUserEntered&&Ee.onUserEntered(Ue,Qe),Ne&&Ee.onChannelParticipantCountChanged&&Ee.onChannelParticipantCountChanged(Ue)}),[2]})})}),[3,57];case 36:return[4,this.getChannel(ve.channelUrl,!0)];case 37:return $e=xn.sent(),gn=e.as(BO),En=gn.participantCount,Yn=gn.user,Gn=$e._updateParticipantCount(En,ve.ts),an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){Ee.onUserExited&&Ee.onUserExited($e,Yn),Gn&&Ee.onChannelParticipantCountChanged&&Ee.onChannelParticipantCountChanged($e)}),[2]})})}),[3,57];case 38:return[4,this.getChannel(ve.channelUrl,!0)];case 39:return Tn=xn.sent(),kn=e.as(jM).operators,Tn.operators=kn,this.upsertChannelsToCache([Tn]),an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){Ee.onOperatorUpdated&&Ee.onOperatorUpdated(Tn,kn)}),[2]})})}),[3,57];case 40:return[4,this.getChannel(ve.channelUrl,!0)];case 41:return Vn=xn.sent(),Hn=ve.category===Wt.USER_CHANNEL_MUTE,Jn=e.as(Hn?bM:CM).user,an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){Hn?Ee.onUserMuted&&Ee.onUserMuted(Vn,Jn):Ee.onUserUnmuted&&Ee.onUserUnmuted(Vn,Jn)}),[2]})})}),[3,57];case 42:return[4,this.getChannel(ve.channelUrl,!0)];case 43:return jn=xn.sent(),On=ve.category===Wt.USER_CHANNEL_BAN,Ln=e.as(On?IM:TM).user,an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){On?Ee.onUserBanned&&Ee.onUserBanned(jn,Ln):Ee.onUserUnbanned&&Ee.onUserUnbanned(jn,Ln)}),[2]})})}),[3,57];case 44:return[4,this.getChannel(ve.channelUrl,!0)];case 45:return An=xn.sent(),wn=e.as(SM).freeze,An.isFrozen=wn,this.upsertChannelsToCache([An]),an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){wn?Ee.onChannelFrozen&&Ee.onChannelFrozen(An):Ee.onChannelUnfrozen&&Ee.onChannelUnfrozen(An)}),[2]})})}),[3,57];case 46:return[4,this.getChannel(ve.channelUrl,!0)];case 47:return We=xn.sent(),[4,this.removeChannelsFromCache([We.url])];case 48:return xn.sent(),an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){Ee.onChannelDeleted&&Ee.onChannelDeleted(We.url,We.channelType)}),[2]})})}),[3,57];case 49:return[4,this.getChannelWithoutCache(ve.channelUrl,!0)];case 50:return ln=xn.sent(),an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){Ee.onChannelChanged&&Ee.onChannelChanged(ln)}),[2]})})}),[3,57];case 51:return[4,this.getChannel(ve.channelUrl,!0)];case 52:return Pe=xn.sent(),Ke=e.as(EM),yn=Ke.created,tn=Ke.updated,st=Ke.deleted,yn&&Pe._upsertCachedMetaData(yn,ve.ts),tn&&Pe._upsertCachedMetaData(tn,ve.ts),st&&Pe._removeFromCachedMetaData(st,ve.ts),an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){yn&&Ee.onMetaDataCreated&&Ee.onMetaDataCreated(Pe,yn),tn&&Ee.onMetaDataUpdated&&Ee.onMetaDataUpdated(Pe,tn),st&&Ee.onMetaDataDeleted&&Ee.onMetaDataDeleted(Pe,st)}),[2]})})}),[3,57];case 53:return[4,this.getChannel(ve.channelUrl,!0)];case 54:return Cn=xn.sent(),Ve=e.as(yM),Ut=Ve.created,mt=Ve.updated,ut=Ve.deleted,an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){Ut&&Ee.onMetaCounterCreated&&Ee.onMetaCounterCreated(Cn,Ut),mt&&Ee.onMetaCounterUpdated&&Ee.onMetaCounterUpdated(Cn,mt),ut&&Ee.onMetaCounterDeleted&&Ee.onMetaCounterDeleted(Cn,ut)}),[2]})})}),[3,57];case 55:return[4,this.getChannel(ve.channelUrl,!0)];case 56:return In=xn.sent(),Qn=e.as(qM),Ct=Qn.pinnedMessageIds,Et=Qn.latestPinnedMessage,(ct=Qn.ts)>In._pinnedMessagesUpdatedAt&&(In.pinnedMessageIds=Ct,In.lastPinnedMessage=Et,In._pinnedMessagesUpdatedAt=ct,this.upsertChannelsToCache([In]),an(function(){return M(rt,void 0,void 0,function(){var Oe,Ee,nn,Sn,Pn;return R(this,function(lt){try{for(Oe=Le(this._openChannelHandlers.values()),Ee=Oe.next();!Ee.done;Ee=Oe.next())(nn=Ee.value).onChannelChanged&&nn.onChannelChanged(In)}catch(qn){Sn={error:qn}}finally{try{Ee&&!Ee.done&&(Pn=Oe.return)&&Pn.call(Oe)}finally{if(Sn)throw Sn.error}}return[2]})})}),an(function(){return M(rt,void 0,void 0,function(){return R(this,function(Oe){return this._openChannelHandlers.forEach(function(Ee){Ee.onPinnedMessageUpdated&&Ee.onPinnedMessageUpdated(In)}),[2]})})})),[3,57];case 57:return[3,58];case 58:return[3,60];case 59:if(Qt=xn.sent(),Gi(Qt))throw Qt;return[3,60];case 60:return[2]}})})},t.prototype.addHandler=function(e,r){this._openChannelHandlers.set(e,r)},t.prototype.removeHandler=function(e){this._openChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._openChannelHandlers.clear()},t.prototype.getChannel=function(e,r){return r===void 0&&(r=!1),M(this,void 0,void 0,function(){var i;return R(this,function(a){switch(a.label){case 0:Se(J("string",e)).throw(ee.invalidParameters),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(i=a.sent())?[2,i]:[3,4];case 3:return a.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,r)];case 5:return[2,a.sent()]}})})},t.prototype.getChannelWithoutCache=function(e,r){return r===void 0&&(r=!1),M(this,void 0,void 0,function(){var i,a,s;return R(this,function(u){switch(u.label){case 0:return Se(J("string",e)).throw(ee.invalidParameters),i=new rz({channelUrl:e,isInternalCall:r}),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),s=a.as(ww).channel,[4,this.upsertChannelsToCache([s])];case 2:return[2,u.sent()[0]]}})})},t.prototype.createChannel=function(e){return M(this,void 0,void 0,function(){var r,i,a,s;return R(this,function(u){switch(u.label){case 0:return r=W(W({},FO),e),Se(function(d){return tt("string",d.operatorUserIds,!0)&&(J("string",d.coverUrlOrImage,!0)||oi(d.coverUrlOrImage,!0))&&J("string",d.name,!0)&&J("string",d.data,!0)&&J("string",d.customType,!0)&&(J("string",d.channelUrl)&&/^\w+$/.test(d.channelUrl)||d.channelUrl===null||d.channelUrl===void 0)&&J("boolean",d.isEphemeral,!0)}(r)).throw(ee.invalidParameters),i=new iz(r),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),s=a.as(ww).channel,this.upsertChannelsToCache([s]),[2,s]}})})},t}(zM),Rw={name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0},uz=function(n){function t(e){var r=this,i=e.channelUrl,a=e.token,s=e.limit;return(r=n.call(this)||this).method=Ie.GET,r.path="".concat(id,"/").concat(encodeURIComponent(i),"/participants"),r.params={token:a,limit:s},r}return j(t,n),t}(Te),oz=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.participants=[];var a=r.next,s=r.participants;return i.token=a,i.participants=s.map(function(u){return new Z7(e,u)}),i}return j(t,n),t}(Me),lz=function(n){function t(e,r,i){return n.call(this,e,r,vt.OPEN,i)||this}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new uz(W(W({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(oz),s=a.participants,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw ee.queryInProgress;case 4:return[3,6];case 5:throw ee.invalidParameters;case 6:return[2]}})})},t}(cu),dz=function(n){function t(e){var r=this,i=e.channelUrl,a=e.coverUrlOrImage,s=e.name,u=e.data,d=e.customType,h=e.operatorUserIds;return(r=n.call(this)||this).method=Ie.PUT,r.path="".concat(id,"/").concat(encodeURIComponent(i)),r.params=ze(_n({cover_url:J("string",a)?a:null,cover_file:oi(a)?a:null,name:s,data:u,custom_type:d,operators:h})),r}return j(t,n),t}(Te),cz=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new bc(e,r),i}return j(t,n),t}(Me),fz=function(n){function t(e){var r=this,i=e.channelUrl;return(r=n.call(this)||this).method=Ie.DELETE,r.path="".concat(id,"/").concat(encodeURIComponent(i)),r}return j(t,n),t}(Te);(function(n){function t(e,r){return n.call(this,e,r)||this}j(t,n)})(Me);var bc=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this)._lastParticipantCountUpdated=0,a.participantCount=0,a.operators=[],a.lastPinnedMessage=null,a._pinnedMessagesUpdatedAt=0,a.channelType=vt.OPEN,a.participantCount=(i=r.participant_count)!==null&&i!==void 0?i:0,a.operators=Array.isArray(r.operators)?r.operators.map(function(s){return new _t(e,s)}):[],a.lastPinnedMessage=r.latest_pinned_message?Ri(a._iid,W({channel_type:a.channelType},r.latest_pinned_message)):null,a}return j(t,n),t.payloadify=function(e){return ze(_n(W(W({},rm.payloadify(e)),{participant_count:e.participantCount,operators:e.operators.map(function(r){return _t.payloadify(r)}),latest_pinned_message:e.lastPinnedMessage?ay(e.lastPinnedMessage):null})))},t.prototype.serialize=function(){return Nc(this)},t.prototype.isOperator=function(e){return e instanceof _t?this.isOperator(e.userId):this.operators.some(function(r){return r.userId===e})},t.prototype._updateParticipantCount=function(e,r){return r>this._lastParticipantCountUpdated&&(this.participantCount=e,this._lastParticipantCountUpdated=r,!0)},t.prototype.createParticipantListQuery=function(e){return new lz(this._iid,this.url,e)},t.prototype.refresh=function(){return M(this,void 0,void 0,function(){return R(this,function(e){switch(e.label){case 0:return[4,bs.of(this._iid).getChannelWithoutCache(this.url)];case 1:return[2,e.sent()]}})})},t.prototype.enter=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return e=X.of(this._iid).requestQueue,r=new az({channelUrl:this.url}),[4,e.send(r)];case 1:return i=d.sent(),a=i.as(HO),s=a.participantCount,u=a.ts,this._updateParticipantCount(s,u),bs.of(this._iid).setEnteredToCache(this),[2]}})})},t.prototype.exit=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return e=X.of(this._iid).requestQueue,r=new sz({channelUrl:this.url}),[4,e.send(r)];case 1:return i=d.sent(),a=i.as(BO),s=a.participantCount,u=a.ts,this._updateParticipantCount(s,u),bs.of(this._iid).setExitedToCache(this),ni.of(this._iid).fileMessageQueue.cancel(this),[2]}})})},t.prototype.updateChannel=function(e){return M(this,void 0,void 0,function(){var r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return r=W(W({},Rw),e),Se(function(h){return tt("string",h.operatorUserIds,!0)&&(J("string",h.coverUrlOrImage,!0)||oi(h.coverUrlOrImage,!0))&&J("string",h.name,!0)&&J("string",h.data,!0)&&J("string",h.customType,!0)}(r)).throw(ee.invalidParameters),i=X.of(this._iid).requestQueue,a=new dz(W({channelUrl:this.url},r)),[4,i.send(a)];case 1:return s=d.sent(),u=s.as(cz).channel,this._update(u),[4,bs.of(this._iid).upsertChannelsToCache([u])];case 2:return d.sent(),[2,this]}})})},t.prototype.updateChannelWithOperatorUserIds=function(e,r,i,a,s){return M(this,void 0,void 0,function(){var u;return R(this,function(d){return u=W(W({},Rw),{name:e,coverUrlOrImage:r,data:i,operatorUserIds:a,customType:s}),[2,this.updateChannel(u)]})})},t.prototype.delete=function(){return M(this,void 0,void 0,function(){var e,r;return R(this,function(i){switch(i.label){case 0:return e=X.of(this._iid).requestQueue,r=new fz({channelUrl:this.url}),[4,e.send(r)];case 1:return i.sent(),[4,bs.of(this._iid).removeChannelsFromCache([this.url])];case 2:return i.sent(),[2]}})})},t.prototype.updateUserMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u=this;return R(this,function(d){switch(d.label){case 0:return[4,n.prototype.updateUserMessage.call(this,e,r)];case 1:return i=d.sent(),a=!1,s=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,a=!0,s=!0),a&&bs.of(this._iid).handlers.map(function(h){h.onChannelChanged&&h.onChannelChanged(u)}),s&&bs.of(this._iid).handlers.map(function(h){h.onPinnedMessageUpdated&&h.onPinnedMessageUpdated(u)}),[2,i]}})})},t.prototype.updateFileMessage=function(e,r){return M(this,void 0,void 0,function(){var i,a,s,u=this;return R(this,function(d){switch(d.label){case 0:return[4,n.prototype.updateFileMessage.call(this,e,r)];case 1:return i=d.sent(),a=!1,s=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,a=!0,s=!0),a&&bs.of(this._iid).handlers.map(function(h){h.onChannelChanged&&h.onChannelChanged(u)}),s&&bs.of(this._iid).handlers.map(function(h){h.onPinnedMessageUpdated&&h.onPinnedMessageUpdated(u)}),[2,i]}})})},t}(rm);(function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return j(t,n),t})(function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.onUserEntered=Kn,e.onUserExited=Kn,e.onChannelParticipantCountChanged=Kn,e.onPollUpdated=Kn,e.onPollVoted=Kn,e.onPollDeleted=Kn,e.onPinnedMessageUpdated=Kn,e}return j(t,n),t}(tO));var hz=function(n){function t(e){var r=this,i=e.token,a=e.limit,s=e.nameKeyword,u=e.urlKeyword,d=e.customTypes,h=e.includeFrozen,p=e.includeMetaData;return(r=n.call(this)||this).method=Ie.GET,r.path=id,r.params=ze({token:i,limit:a,name_contains:s,url_contains:u,custom_types:d,show_frozen:h,show_metadata:p,show_pinned_messages:!0}),r}return j(t,n),t}(Te),pz=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.channels=[];var a=r.next,s=r.channels,u=r.ts;return i.token=a,s&&s.length>0&&(i.channels=s.map(function(d){return new bc(e,d)})),i.ts=typeof u=="number"?u:null,i}return j(t,n),t}(Me),_z=function(n){function t(e,r){var i,a,s,u,d,h=this;return(h=n.call(this,e,r)||this).includeFrozen=!0,h.includeMetaData=!0,h.nameKeyword=null,h.urlKeyword=null,h.customTypes=null,h.includeFrozen=(i=r.includeFrozen)===null||i===void 0||i,h.includeMetaData=(a=r.includeMetaData)===null||a===void 0||a,h.nameKeyword=(s=r.nameKeyword)!==null&&s!==void 0?s:null,h.urlKeyword=(u=r.urlKeyword)!==null&&u!==void 0?u:null,h.customTypes=(d=r.customTypes)!==null&&d!==void 0?d:null,h}return j(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&J("boolean",this.includeFrozen)&&J("boolean",this.includeMetaData)&&J("string",this.nameKeyword,!0)&&J("string",this.urlKeyword,!0)&&tt("string",this.customTypes,!0)},t.prototype.next=function(){return M(this,void 0,void 0,function(){var e,r,i,a,s,u;return R(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,4]:this._hasNext?(this._isLoading=!0,e=X.of(this._iid).requestQueue,r=new hz(_n(W(W({},this),{token:this._token}))),[4,e.send(r)]):[3,3]:[3,6];case 1:return i=d.sent(),a=i.as(pz),s=a.channels,u=a.token,this._token=u,this._hasNext=!!u,[4,bs.of(this._iid).upsertChannelsToCache(s)];case 2:return d.sent(),this._isLoading=!1,[2,s];case 3:return[2,[]];case 4:throw ee.queryInProgress;case 5:return[3,7];case 6:throw ee.invalidParameters;case 7:return[2]}})})},t}(Vu),mz=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.name="openChannel",e}return j(t,n),t.prototype.init=function(e,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,u=r.requestQueue,d=r.logger,h=r.onlineDetector,p=r.cacheContext;n.prototype.init.call(this,e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:d,onlineDetector:h,cacheContext:p}),this._manager=new bs(e,{sdkState:i,dispatcher:a,requestQueue:u,logger:d,cacheContext:p,sessionManager:s})},t.prototype.createOpenChannelListQuery=function(e){return e===void 0&&(e={}),new _z(this._iid,e)},t.prototype.addOpenChannelHandler=function(e,r){this._manager.addHandler(e,r)},t.prototype.removeOpenChannelHandler=function(e){this._manager.removeHandler(e)},t.prototype.removeAllOpenChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildOpenChannelFromSerializedData=function(e){return this._manager.buildOpenChannelFromSerializedData(e)},t.prototype.getChannel=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2,this._manager.getChannel(e)]})})},t.prototype.getChannelWithoutCache=function(e){return M(this,void 0,void 0,function(){return R(this,function(r){return[2,this._manager.getChannelWithoutCache(e)]})})},t.prototype.createChannel=function(e){return e===void 0&&(e={}),M(this,void 0,void 0,function(){return R(this,function(r){return[2,this._manager.createChannel(e)]})})},t.prototype.createChannelWithOperatorUserIds=function(e,r,i,a,s){return M(this,void 0,void 0,function(){var u;return R(this,function(d){return(u=W({},FO)).name=e,u.coverUrlOrImage=r,u.data=i,u.operatorUserIds=a,u.customType=s,[2,this._manager.createChannel(u)]})})},t}(Om),gz="No sendbird state value available. Make sure you are rendering `<SendbirdProvider>` at the top of your app.";function Mt(){var n=F.useContext(oO);if(!n)throw new Error(gz);return n}var GO="INITIALIZE_AUDIO_UNIT",Ub="RESET_AUDIO_UNIT",VO="SET_CURRENT_PLAYER",jO="ON_VOICE_PLAYER_PLAY",qO="ON_VOICE_PLAYER_PAUSE",zO="ON_CURRENT_TIME_UPDATE",Ns={IDLE:"IDLE",PREPARING:"PREPARING",PLAYING:"PLAYING",PAUSED:"PAUSED",COMPLETED:"COMPLETED"},xl=function(){return{audioFile:null,playbackTime:0,duration:1e3,playingStatus:Ns.IDLE}},vz={currentPlayer:null,currentGroupKey:"",audioStorage:{}};function Ez(n,t){var e,r,i,a,s,u,d,h,p;switch(t.type){case GO:{var g=t.payload.groupKey,E=!((u=n.audioStorage)===null||u===void 0)&&u[g]?n.audioStorage[g]:xl();return E.playingStatus=Ns.PREPARING,re(re({},n),{audioStorage:re(re({},n.audioStorage),(e={},e[g]=E,e))})}case Ub:{var g=t.payload.groupKey;return re(re({},n),{audioStorage:re(re({},n.audioStorage),(r={},r[g]=xl(),r))})}case VO:{var y=t.payload,C=y.audioPlayer,g=y.groupKey;return re(re({},n),{currentPlayer:C,currentGroupKey:g})}case jO:{var T=t.payload,g=T.groupKey,A=T.audioFile,E=!((d=n.audioStorage)===null||d===void 0)&&d[g]?n.audioStorage[g]:xl();return E.audioFile=A,E.playingStatus=Ns.PLAYING,re(re({},n),{audioStorage:re(re({},n.audioStorage),(i={},i[g]=E,i))})}case qO:{var O=t.payload,g=O.groupKey,N=O.duration,k=O.currentTime,E=!((h=n.audioStorage)===null||h===void 0)&&h[g]?n.audioStorage[g]:xl();return E.playingStatus=Ns.PAUSED,N===k&&(E.playbackTime=0),re(re({},n),{audioStorage:re(re({},n.audioStorage),(a={},a[g]=E,a))})}case zO:{var g=t.payload.groupKey,D=n.currentPlayer,k=D.currentTime,N=D.duration,E=!((p=n.audioStorage)===null||p===void 0)&&p[g]?n.audioStorage[g]:xl();return E.playbackTime===E.duration&&E.playingStatus===Ns.PAUSED?E.playbackTime=0:k>0&&N>0&&(E.playbackTime=k,E.duration=N),re(re({},n),{audioStorage:re(re({},n.audioStorage),(s={},s[g]=E,s))})}default:return n}}var yz=function(n,t){return n===void 0&&(n=""),t===void 0&&(t=""),"".concat(n,"-").concat(t)},Mw=function(n){return mC(navigator.userAgent)&&n.includes("m4a")?{name:cj,mimeType:fj}:{name:cm,mimeType:$l}},bz="ALL",RE=function(){},Cz={currentGroupKey:"",currentPlayer:null,audioStorage:{}},KO=F.createContext({play:RE,pause:RE,stop:RE,voicePlayerStore:Cz}),Iz=function(n){var t=n.children,e=F.useReducer(Ez,vz),r=e[0],i=e[1],a=r.currentGroupKey,s=r.currentPlayer,u=r.audioStorage,d=Mt().config,h=d.logger,p=function(y){y===void 0&&(y=""),a.includes(y)&&(h.info("VoicePlayer: Pause playing(by text)."),g(a))},g=function(y){s?y===a?(h.info("VoicePlayer: Pause playing(by group key)."),s.pause()):y===bz&&(h.info("VoicePlayer: Pause playing(all)."),s.pause()):h.warning("VoicePlayer: No currentPlayer to pause.")},E=function(y){var C=y.groupKey,T=y.audioFile,A=y.audioFileUrl,O=A===void 0?"":A,N=y.audioFileMimeType,k=N===void 0?$l:N;C!==a&&g(a);var D=document.getElementById(O_),P=document.getElementById(Iy);D&&P&&D.removeChild(P),h.info("VoicePlayer: Start getting audio file."),new Promise(function(U,L){var B;if(i({type:GO,payload:{groupKey:C}}),T){h.info("VoicePlayer: Use the audioFile instance."),U(T);return}var q=(B=u==null?void 0:u[C])===null||B===void 0?void 0:B.audioFile;if(q){h.info("VoicePlayer: Get from the audioStorage."),U(q);return}fetch(O).then(function(z){return z.blob()}).then(function(z){var Y=new File([z],Mw(k).name,{lastModified:new Date().getTime(),type:Mw(k).mimeType});U(Y),h.info("VoicePlayer: Get the audioFile from URL.")}).catch(L)}).then(function(U){var L,B=document.getElementById(O_);h.info("VoicePlayer: Succeeded getting audio file.",{audioFile:U});var q=u[C]||xl(),z=new Audio((L=URL==null?void 0:URL.createObjectURL)===null||L===void 0?void 0:L.call(URL,U));z.id=Iy,z.currentTime=q.playbackTime,z.volume=1,z.loop=!1,z.onplaying=function(){h.info("VoicePlayer: OnPlaying event is called from audioPlayer",{groupKey:C,audioPlayer:z}),i({type:jO,payload:{groupKey:C,audioFile:U}})},z.onpause=function(){h.info("VoicePlayer: OnPause event is called from audioPlayer",{groupKey:C,audioPlayer:z}),i({type:qO,payload:{groupKey:C,duration:z.duration,currentTime:z.currentTime}})},z.ontimeupdate=function(){i({type:zO,payload:{groupKey:C}})},z.onerror=function(Y){h.error("VoicePlayer: Failed to load the audioFile on the audio player.",Y),i({type:Ub,payload:{groupKey:C}})},z.dataset.sbGroupId=C;try{B==null||B.childNodes.forEach(function(Y){var Q,$,Z=Y,ne=(Q=Z.dataset)===null||Q===void 0?void 0:Q.sbGroupKey;ne!==C&&(($=Z==null?void 0:Z.pause)===null||$===void 0||$.call(Z),B.removeChild(Z),h.info("VoicePlayer: Removed other player.",{element:Z}))})}finally{z==null||z.play(),B==null||B.appendChild(z),i({type:VO,payload:{groupKey:C,audioPlayer:z}}),h.info("VoicePlayer: Succeeded playing audio player.",{groupKey:C,audioPlayer:z})}}).catch(function(U){h.warning("VoicePlayer: Failed loading audio file with URL.",U),i({type:Ub,payload:{groupKey:C}})})};return b.createElement(KO.Provider,{value:{play:E,pause:g,stop:p,voicePlayerStore:r}},b.createElement("div",{id:O_,style:{display:"none"}}),t)},Tz=function(){return F.useContext(KO)},Ow="sendbird-sort-by-row";function Sz(n){var t=n.className,e=t===void 0?"":t,r=n.maxItemCount,i=n.itemWidth,a=n.itemHeight,s=n.children;if(Array.isArray(s)&&s.length>r){for(var u=[],d=0;d<s.length;d+=r)u.push(b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),[Ow],!1).join(" "),key:fs(),style:{width:i*r,height:a}},s.slice(d,d+r)));return b.createElement(b.Fragment,null,u)}return b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),[Ow],!1).join(" "),style:{width:i*(Array.isArray(s)?s.length:1),height:a}},s)}var WO="sendbird-app__layout",Nz=60,Az=function(n){iO(t,n);function t(e){var r=n.call(this,e)||this;return r.menuRef=b.createRef(),r.setupEvents=function(){var i=r.props.closeDropdown,a=r.menuRef,s=function(u){var d,h;a!=null&&a.current&&!(!((h=(d=a==null?void 0:a.current)===null||d===void 0?void 0:d.contains)===null||h===void 0)&&h.call(d,u.target))&&(i==null||i())};r.setState({handleClickOutside:s}),document.addEventListener("mousedown",s)},r.cleanUpEvents=function(){var i=r.state.handleClickOutside;document.removeEventListener("mousedown",i)},r.getMenuPosition=function(){var i,a,s,u=r.props,d=u.parentRef,h=u.openLeft,p=document.getElementById(WO),g=((i=p==null?void 0:p.getBoundingClientRect)===null||i===void 0?void 0:i.call(p))||{top:0,left:0,width:window.innerWidth,height:window.innerHeight},E=(s=(a=d==null?void 0:d.current)===null||a===void 0?void 0:a.getBoundingClientRect)===null||s===void 0?void 0:s.call(a),y=((E==null?void 0:E.x)||(E==null?void 0:E.left)||0)-g.left,C=((E==null?void 0:E.y)||(E==null?void 0:E.top)||0)-g.top,T={top:C,left:y};if(!r.menuRef.current)return T;var A=r.menuRef.current.getBoundingClientRect();if(C+A.height+Nz>g.height&&(T.top-=A.height),y+A.width>g.width&&!h&&(T.left-=A.width),T.top<0&&(T.top=A.height<g.height?(g.height-A.height)/2:0),T.top+=32,h){var O=Number.isNaN(A.width-30)?108:A.width-30;T.left-=O}return T.left<0&&(T.left=A.width<g.width?(g.width-A.width)/2:0),r.setState({menuStyle:T}),T},r.state={menuStyle:{top:0,left:0},handleClickOutside:function(){}},r}return t.prototype.componentDidMount=function(){this.setupEvents(),this.getMenuPosition()},t.prototype.componentWillUnmount=function(){this.cleanUpEvents()},t.prototype.render=function(){var e=document.getElementById(pm);if(!e)return b.createElement(b.Fragment,null);var r=this.state.menuStyle,i=this.props,a=i.children,s=i.style,u=i.className,d=u===void 0?"":u,h=i.testID,p=i.id;return Tc.createPortal(b.createElement("div",{className:Rt(NC,d),"data-testid":h,id:p},b.createElement("div",{className:"sendbird-dropdown__menu-backdrop"}),b.createElement("ul",{className:"".concat(d," sendbird-dropdown__menu"),ref:this.menuRef,style:re({display:"inline-block",position:"fixed",left:"".concat(Math.round(r.left),"px"),top:"".concat(Math.round(r.top),"px")},s),"data-testid":"sendbird-dropdown-menu"},a)),e)},t}(b.Component),wz={x:0,y:0,left:0,top:0,height:0},Rz=function(n){var t=n.id,e=n.children,r=n.parentRef,i=n.parentContainRef,a=n.spaceFromTrigger,s=a===void 0?{x:0,y:0}:a,u=n.closeDropdown,d=F.useState({left:0,top:0}),h=d[0],p=d[1],g=F.useRef(null);F.useEffect(function(){return i&&(i!=null&&i.current)&&i.current.classList.add("sendbird-reactions--pressed"),function(){i&&(i!=null&&i.current)&&i.current.classList.remove("sendbird-reactions--pressed")}},[]),F.useEffect(function(){var y=function(C){var T,A;g!=null&&g.current&&!(!((A=(T=g==null?void 0:g.current)===null||T===void 0?void 0:T.contains)===null||A===void 0)&&A.call(T,C.target))&&u()};return document.addEventListener("mousedown",y),function(){document.removeEventListener("mousedown",y)}},[]),F.useEffect(function(){var y,C,T,A,O=(s==null?void 0:s.x)||0,N=(s==null?void 0:s.y)||0,k=document.getElementById(WO),D=((y=k==null?void 0:k.getBoundingClientRect)===null||y===void 0?void 0:y.call(k))||{top:0,left:0,width:window.innerWidth,height:window.innerHeight},P=(T=(C=r==null?void 0:r.current)===null||C===void 0?void 0:C.getBoundingClientRect())!==null&&T!==void 0?T:wz,U=((P==null?void 0:P.x)||(P==null?void 0:P.left)||0)-D.left,L=((P==null?void 0:P.y)||(P==null?void 0:P.top)||0)-D.top,B={top:L,left:U};if(!(g!=null&&g.current))p(B);else{var q=(A=g==null?void 0:g.current)===null||A===void 0?void 0:A.getBoundingClientRect();B.top<q.height?(B.top+=P.height,B.top+=N):(B.top-=q.height,B.top-=N),B.left-=q.width/2,B.left+=P.height/2-2,B.left+=O;var z=D.width-q.width;z<B.left&&(B.left=z),B.left<0&&(B.left=0),p(B)}},[]);var E=document.getElementById(wC);return E?Tc.createPortal(b.createElement("div",{className:NC,id:t},b.createElement("div",{className:"sendbird-dropdown__menu-backdrop"}),b.createElement("ul",{className:"sendbird-dropdown__reaction-bar","data-testid":"sendbird-dropdown__reaction-bar",ref:g,style:{display:"inline-block",position:"fixed",left:"".concat(Math.round(h.left),"px"),top:"".concat(Math.round(h.top),"px")}},b.createElement(Sz,{className:"sendbird-dropdown__reaction-bar__row",maxItemCount:8,itemWidth:44,itemHeight:40},e))),E):null},$O=F.createContext(void 0),SC=function(n){var t=n.children,e=n.value;return b.createElement($O.Provider,{value:e},t)},li=function(){var n=F.useContext($O);if(!n)throw new Error("useMessageMenuContext must be used within a MessageMenuProvider.");return n},ga=function(n){var t=n.className,e=n.disabled,r=n.tabIndex,i=r===void 0?0:r,a=n.testID,s=n.onClick,u=n.children,d=function(h){!e&&s&&s(h)};return b.createElement("li",{className:Rt("sendbird-menu-item",t),role:"menuitem","aria-disabled":e,"data-testid":a,tabIndex:i,onClick:d,onKeyDown:function(h){h.code==="Enter"&&d(h)}},b.createElement(Ge,{className:"sendbird-menu-item__text",type:Be.SUBTITLE_2,color:e?Re.ONBACKGROUND_4:Re.ONBACKGROUND_1},u))},cd=function(n){var t=n.className,e=n.disabled,r=e===void 0?!1:e,i=n.tabIndex,a=i===void 0?0:i,s=n.testID,u=n.onClick,d=n.children;return b.createElement("div",{className:Rt("sendbird-message__bottomsheet--action",t),role:"menuitem",tabIndex:a,"aria-disabled":r,onClick:u,"data-testid":s},d)},NC="sendbird-observing-message-menu",AC=function(n){return"m_".concat(n)},Ac=Az,YO=Rz,Mz=function(n){var t=n.className,e=t===void 0?"":t,r=n.children,i=n.onClick,a=n.disable,s=a===void 0?!1:a,u=n.dataSbId,d=u===void 0?"":u,h=n.testID;return b.createElement(ga,{className:Rt.apply(void 0,en(en([],Array.isArray(e)?e:[e],!1),["sendbird-dropdown__menu-item",s?"disable":""],!1)),disabled:s,testID:h??d,onClick:i},r)},pm="sendbird-dropdown-portal",Oz=function(){return b.createElement("div",{id:pm,className:pm})},wC="sendbird-emoji-list-portal",kz=function(){return b.createElement("div",{id:wC})};function wc(n){var t=n.menuTrigger,e=n.menuItems,r=n.isOpen,i=n.onClick,a=F.useState(!1),s=a[0],u=a[1];return b.createElement("div",{className:"sendbird-context-menu",onClick:i},t==null?void 0:t(function(){return u(!s)}),(s||r)&&e(function(){return u(!1)}))}var QO={100:"extra-light",200:"light",300:"main",400:"dark",500:"extra-dark","overlay-01":"overlay-dark","overlay-02":"overlay-light","onlight-01":"onlight-text-high-emphasis","onlight-02":"onlight-text-mid-emphasis","onlight-03":"onlight-text-low-emphasis","onlight-04":"onlight-text-disabled","ondark-01":"ondark-text-high-emphasis","ondark-02":"ondark-text-mid-emphasis","ondark-03":"ondark-text-low-emphasis","ondark-04":"ondark-text-disabled"},Dz=Object.values(QO).sort(function(n,t){return t.length-n.length}),Lz=new Map(Object.entries(QO).map(function(n){var t=n[0],e=n[1];return[e,t]})),xz=function(n){var t={};return Object.entries(n).forEach(function(e){for(var r=e[0],i=e[1],a=r,s=0,u=Dz;s<u.length;s++){var d=u[s],h=new RegExp("-".concat(d,"$"));if(h.test(r)){var p=Lz.get(d);if(p){a=r.replace(h,"-".concat(p));break}}}t[a]=i}),t},td="sendbird-modal-root",Uz=function(){return b.createElement("div",{id:td,className:td})},Pz=function(n){var t=n.titleText,e=n.onCloseClick;return b.createElement("div",{className:"sendbird-modal__header"},b.createElement(Ge,{type:Be.H_1,color:Re.ONBACKGROUND_1},t),b.createElement("div",{className:"sendbird-modal__close"},b.createElement(Fu,{width:"32px",height:"32px",onClick:e},b.createElement(mn,{type:Ye.CLOSE,fillColor:sn.DEFAULT,width:"24px",height:"24px"}))))},Fz=function(n){var t=n.children;return b.createElement("div",{className:"sendbird-modal__body"},b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_2},t))},_m=function(n){var t=n.submitText,e=n.disabled,r=e===void 0?!1:e,i=n.hideCancelButton,a=i===void 0?!1:i,s=n.type,u=s===void 0?Br.DANGER:s,d=n.onSubmit,h=n.onCancel,p=F.useContext(kr).stringSet;return b.createElement("div",{className:"sendbird-modal__footer"},!a&&b.createElement(ws,{type:Br.SECONDARY,onClick:h},b.createElement(Ge,{type:Be.BUTTON_1,color:Re.ONBACKGROUND_1},p.BUTTON__CANCEL)),b.createElement(ws,{type:u,disabled:r,onClick:d},t))};function Za(n){var t,e=n.children,r=e===void 0?null:e,i=n.className,a=i===void 0?"":i,s=n.contentClassName,u=s===void 0?"":s,d=n.isCloseOnClickOutside,h=d===void 0?!1:d,p=n.isFullScreenOnMobile,g=p===void 0?!1:p,E=n.titleText,y=n.submitText,C=n.disabled,T=C===void 0?!1:C,A=n.hideFooter,O=A===void 0?!1:A,N=n.type,k=N===void 0?Br.DANGER:N,D=n.renderHeader,P=n.onSubmit,U=P===void 0?ur:P,L=n.onClose,B=n.onCancel,q=n.customFooter,z=(t=L??B)!==null&&t!==void 0?t:ur,Y=Mt().eventHandlers,Q=F.useState(function(){return"sbu-modal-".concat(fs())})[0];F.useEffect(function(){var Z,ne;return(ne=(Z=Y==null?void 0:Y.modal)===null||Z===void 0?void 0:Z.onMounted)===null||ne===void 0?void 0:ne.call(Z,{close:z,id:Q})},[]);var $=Zi().isMobile;return Tc.createPortal(b.createElement("div",{className:Rt("sendbird-modal",a,g&&$&&"sendbird-modal--full-mobile")},b.createElement("div",{className:Rt.apply(void 0,en(["sendbird-modal__content"],Array.isArray(u)?u:[u],!1))},(D==null?void 0:D())||b.createElement(Pz,{titleText:E??"",onCloseClick:z}),b.createElement(Fz,null,r),!O&&(q??b.createElement(_m,{disabled:T,onCancel:z,onSubmit:U,submitText:y??"",type:k}))),b.createElement("div",{className:Rt("sendbird-modal__backdrop",h&&"sendbird-modal__backdrop--clickoutside"),onClick:function(Z){Z==null||Z.stopPropagation(),h&&z()}})),document.getElementById(td))}var ZO=F.createContext({start:ur,stop:ur,isRecordable:!1}),Hz=function(n){var t,e=n.children,r=Mt().config,i=r.logger,a=r.groupChannel,s=F.useState(null),u=s[0],d=s[1],h=F.useState(!1),p=h[0],g=h[1],E=F.useState(!1),y=E[0],C=E[1],T=Bt().stringSet,A=a.enableVoiceMessage,O=F.useState(null),N=O[0],k=O[1],D=(t=eA.find(function(L){return MediaRecorder.isTypeSupported(L)}))!==null&&t!==void 0?t:"";A&&!D&&i.error("VoiceRecorder: Browser does not support mimeType",{mimmeTypes:eA}),F.useEffect(function(){A&&!N&&y_(()=>import("./bundle-CZsW3iP9-CZbQtL1c.js"),__vite__mapDeps([5,1,2,3])).then(function(L){return k(L)})},[A,N]);var P=F.useCallback(function(L){var B,q;if(A&&!N){i.error("VoiceRecorder: Recording audio processor is being loaded.");return}var z=function(){try{navigator.permissions.query({name:"microphone"}).then(function(Y){Y.state==="denied"&&(i.warning("VoiceRecorder: Permission denied."),C(!0))})}catch(Y){i.warning("VoiceRecorder: Failed to check permission.",Y)}};i.info("VoiceRecorder: Start recording."),u&&(U(),i.info("VoiceRecorder: Previous mediaRecorder is stopped.")),z(),(q=(B=navigator==null?void 0:navigator.mediaDevices)===null||B===void 0?void 0:B.getUserMedia)===null||q===void 0||q.call(B,{audio:!0}).then(function(Y){var Q;i.info("VoiceRecorder: Succeeded getting media stream.",Y),g(!0);var $=new MediaRecorder(Y,{mimeType:D,audioBitsPerSecond:dj});$.ondataavailable=function(Z){i.info("VoiceRecorder: Succeeded getting an available data.",Z.data);var ne=new File([Z.data],cm,{lastModified:new Date().getTime(),type:$l});N==null||N.downsampleToWav(ne,function(pe){var he,le=N==null?void 0:N.encodeMp3(pe),we=new Blob(le,{type:$l}),ve=new File([we],cm,{lastModified:new Date().getTime(),type:$l});(he=L==null?void 0:L.onRecordingEnded)===null||he===void 0||he.call(L,ve),i.info("VoiceRecorder: Succeeded converting audio file.",ve)});var ue=Y.getAudioTracks();ue.forEach(function(pe){return pe.stop()}),g(!1)},$.onstart=(Q=L==null?void 0:L.onRecordingStarted)!==null&&Q!==void 0?Q:ur,$==null||$.start(),d($)}).catch(function(Y){i.error("VoiceRecorder: Failed getting media stream.",Y),d(null)})},[u,N]),U=F.useCallback(function(){u==null||u.stop(),d(null),g(!1),i.info("VoiceRecorder: Stop recording.")},[u]);return b.createElement(ZO.Provider,{value:{start:P,stop:U,isRecordable:p}},e,y&&b.createElement(Za,{hideFooter:!0,onClose:function(){return C(!1)}},b.createElement(b.Fragment,null,T.VOICE_RECORDING_PERMISSION_DENIED)))},XO=function(){return F.useContext(ZO)},JO=F.createContext({openModal:ur}),Bz=function(n){var t=n.children,e=F.useState([]),r=e[0],i=e[1],a=F.useCallback(function(d){i(function(h){return en(en([],h,!0),[d],!1)})},[]),s=F.useCallback(function(){i(function(d){return d.slice(1)})},[]),u=F.useMemo(function(){return function(){return Mi(r).when(function(d){return d.length===0},function(){return b.createElement(b.Fragment,null)}).otherwise(function(){var d=r[0],h=d.modalProps,p=d.childElement;return b.createElement(Za,re({},h,{className:Rt("sendbird-global-modal",h==null?void 0:h.className),onClose:function(){var g;(g=h==null?void 0:h.onClose)===null||g===void 0||g.call(h),s()}}),p({closeModal:s}))})}},[r]);return b.createElement(JO.Provider,{value:{openModal:a}},b.createElement(u,null),t)},ek=function(){return F.useContext(JO)},Gz=function(){function n(t){var e=this,r,i=t.sdk,a=t.logger;(r=i==null?void 0:i.getAllEmoji)===null||r===void 0||r.call(i).then(function(s){e._emojiContainer=s,a==null||a.info("EmojiManager | Succeeded getting all emojis. ",s)}).catch(function(){a==null||a.warning("EmojiManager | Failed getting all emojis.")})}return Object.defineProperty(n.prototype,"AllEmojisAsArray",{get:function(){return this._emojiContainer.emojiCategories.flatMap(function(t){return t.emojis})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"AllEmojisAsMap",{get:function(){return this._emojiContainer.emojiCategories.flatMap(function(t){return t.emojis}).reduce(function(t,e){return t.set(e.key,e.url),t},new Map)},enumerable:!1,configurable:!0}),n.prototype.getAllEmojis=function(t){var e=this;return Mi(t).when(function(r){return["array","arr"].includes(r)},function(){return e.AllEmojisAsArray}).when(function(r){return["map"].includes(r)},function(){return e.AllEmojisAsMap}).otherwise(function(){return e.AllEmojisAsArray})},n.prototype.getEmojiUrl=function(t){var e,r;return(r=(e=this.AllEmojisAsArray.find(function(i){return i.key===t}))===null||e===void 0?void 0:e.url)!==null&&r!==void 0?r:""},Object.defineProperty(n.prototype,"emojiContainer",{get:function(){return this._emojiContainer},enumerable:!1,configurable:!0}),n}(),nk=b.createContext({disableUserProfile:!0,isOpenChannel:!1}),RC=function(){return F.useContext(nk)},tk=function(n){var t,e=n.isOpenChannel,r=e===void 0?!1:e,i=n.disableUserProfile,a=i===void 0?!1:i,s=n.renderUserProfile,u=n.onUserProfileMessage,d=n.onStartDirectMessage,h=n.children,p=Mt().config,g=(t=d??u)!==null&&t!==void 0?t:p.onStartDirectMessage;return b.createElement(nk.Provider,{value:{isOpenChannel:r,disableUserProfile:a??!p.common.enableUsingDefaultUserProfile,renderUserProfile:s??p.renderUserProfile,onStartDirectMessage:g,onUserProfileMessage:g}},h)},rk=10,ik=15,mh="@",Vz=1,Is;(function(n){n.PARENT="PARENT",n.THREAD="THREAD"})(Is||(Is={}));var ak=function(n,t,e){var r;try{var i=n.current,a=(r=i==null?void 0:i.querySelectorAll('[data-sb-created-at="'.concat(t,'"]')))===null||r===void 0?void 0:r[0];i&&a instanceof HTMLElement&&(i.scrollTop=a.offsetTop)}catch{}finally{e==null||e(!0)}},lu=function(n,t,e){n===void 0&&(n=0);var r=10,i=n;if(i>r){e==null||e(!0);return}try{var a=(t==null?void 0:t.current)||document.querySelector(".sendbird-conversation__messages-padding");a&&(a.scrollTop=a.scrollHeight),e==null||e(!0)}catch{setTimeout(function(){lu(i+1,t,e)},500*i)}},jz=function(n){var t=n==null?void 0:n.myRole;return t==="operator"},qz=function(n){var t=n==null?void 0:n.isFrozen;return t&&!jz(n)},zz=function(n){var t=n==null?void 0:n.myMutedState;return t==="muted"},Kz=function(n){for(var t=n.emojiCategories,e=t===void 0?[]:t,r=new Map,i=0;i<e.length;i+=1)for(var a=e[i].emojis,s=0;s<a.length;s+=1){var u=a[s],d=u.key,h=u.url;r.set(d,h)}return r},Wz=function(n){n===void 0&&(n=[]);for(var t=new Map,e=0;e<n.length;e+=1){var r=n[e],i=r.userId,a=r.nickname;t.set(i,a)}return t},$z=function(n,t){var e=n.map(function(r){return[r[t],r]});return Array.from(new Map(e).values())},Yz=function(n){return $z(n,"messageId")},Qz=function(n){return n.sort(function(t,e){return t.createdAt-e.createdAt})},Zz=function(n,t){var e=n[n.length-1],r=t[0];if((e==null?void 0:e.createdAt)<(r==null?void 0:r.createdAt))return en(en([],n,!0),t,!0);var i=en(en([],n,!0),t,!0),a=Yz(i);return Qz(a)},kw=function(n,t){if("sendingStatus"in t&&(t.sendingStatus===jt.SUCCEEDED||t.sendingStatus===jt.PENDING)){var e=n.map(function(i){return"sendingStatus"in i&&i.sendingStatus?i.sendingStatus:i.isAdminMessage()?jt.SUCCEEDED:null}).lastIndexOf(jt.SUCCEEDED);if(e+1<n.length){var r=en([],n,!0);return r.splice(e+1,0,t),r}}return en(en([],n,!0),[t],!1)},Yl=function(n,t,e){return Math.abs(n-t)<=e};function sk(n){var t=n.channel,e=n.config,r=n.moduleLevel;return!t||t.isBroadcast||t.isEphemeral?!1:t.isSuper?r??e.groupChannel.enableReactionsSupergroup:r??e.groupChannel.enableReactions}function Xz(n){return Gr(1,arguments),n instanceof Date||dm(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function Jz(n){if(Gr(1,arguments),!Xz(n)&&typeof n!="number")return!1;var t=fa(n);return!isNaN(Number(t))}function Gu(n){if(n===null||n===!0||n===!1)return NaN;var t=Number(n);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function eK(n,t){Gr(2,arguments);var e=fa(n).getTime(),r=Gu(t);return new Date(e+r)}function nK(n,t){Gr(2,arguments);var e=Gu(t);return eK(n,-e)}var tK=864e5;function rK(n){Gr(1,arguments);var t=fa(n),e=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=t.getTime(),i=e-r;return Math.floor(i/tK)+1}function mm(n){Gr(1,arguments);var t=1,e=fa(n),r=e.getUTCDay(),i=(r<t?7:0)+r-t;return e.setUTCDate(e.getUTCDate()-i),e.setUTCHours(0,0,0,0),e}function uk(n){Gr(1,arguments);var t=fa(n),e=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(e+1,0,4),r.setUTCHours(0,0,0,0);var i=mm(r),a=new Date(0);a.setUTCFullYear(e,0,4),a.setUTCHours(0,0,0,0);var s=mm(a);return t.getTime()>=i.getTime()?e+1:t.getTime()>=s.getTime()?e:e-1}function iK(n){Gr(1,arguments);var t=uk(n),e=new Date(0);e.setUTCFullYear(t,0,4),e.setUTCHours(0,0,0,0);var r=mm(e);return r}var aK=6048e5;function sK(n){Gr(1,arguments);var t=fa(n),e=mm(t).getTime()-iK(t).getTime();return Math.round(e/aK)+1}var uK={};function Fm(){return uK}function gm(n,t){var e,r,i,a,s,u,d,h;Gr(1,arguments);var p=Fm(),g=Gu((e=(r=(i=(a=t==null?void 0:t.weekStartsOn)!==null&&a!==void 0?a:t==null||(s=t.locale)===null||s===void 0||(u=s.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:p.weekStartsOn)!==null&&r!==void 0?r:(d=p.locale)===null||d===void 0||(h=d.options)===null||h===void 0?void 0:h.weekStartsOn)!==null&&e!==void 0?e:0);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var E=fa(n),y=E.getUTCDay(),C=(y<g?7:0)+y-g;return E.setUTCDate(E.getUTCDate()-C),E.setUTCHours(0,0,0,0),E}function ok(n,t){var e,r,i,a,s,u,d,h;Gr(1,arguments);var p=fa(n),g=p.getUTCFullYear(),E=Fm(),y=Gu((e=(r=(i=(a=t==null?void 0:t.firstWeekContainsDate)!==null&&a!==void 0?a:t==null||(s=t.locale)===null||s===void 0||(u=s.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&i!==void 0?i:E.firstWeekContainsDate)!==null&&r!==void 0?r:(d=E.locale)===null||d===void 0||(h=d.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&e!==void 0?e:1);if(!(y>=1&&y<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var C=new Date(0);C.setUTCFullYear(g+1,0,y),C.setUTCHours(0,0,0,0);var T=gm(C,t),A=new Date(0);A.setUTCFullYear(g,0,y),A.setUTCHours(0,0,0,0);var O=gm(A,t);return p.getTime()>=T.getTime()?g+1:p.getTime()>=O.getTime()?g:g-1}function oK(n,t){var e,r,i,a,s,u,d,h;Gr(1,arguments);var p=Fm(),g=Gu((e=(r=(i=(a=t==null?void 0:t.firstWeekContainsDate)!==null&&a!==void 0?a:t==null||(s=t.locale)===null||s===void 0||(u=s.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&i!==void 0?i:p.firstWeekContainsDate)!==null&&r!==void 0?r:(d=p.locale)===null||d===void 0||(h=d.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&e!==void 0?e:1),E=ok(n,t),y=new Date(0);y.setUTCFullYear(E,0,g),y.setUTCHours(0,0,0,0);var C=gm(y,t);return C}var lK=6048e5;function dK(n,t){Gr(1,arguments);var e=fa(n),r=gm(e,t).getTime()-oK(e,t).getTime();return Math.round(r/lK)+1}function Sr(n,t){for(var e=n<0?"-":"",r=Math.abs(n).toString();r.length<t;)r="0"+r;return e+r}var mo={y:function(t,e){var r=t.getUTCFullYear(),i=r>0?r:1-r;return Sr(e==="yy"?i%100:i,e.length)},M:function(t,e){var r=t.getUTCMonth();return e==="M"?String(r+1):Sr(r+1,2)},d:function(t,e){return Sr(t.getUTCDate(),e.length)},a:function(t,e){var r=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(t,e){return Sr(t.getUTCHours()%12||12,e.length)},H:function(t,e){return Sr(t.getUTCHours(),e.length)},m:function(t,e){return Sr(t.getUTCMinutes(),e.length)},s:function(t,e){return Sr(t.getUTCSeconds(),e.length)},S:function(t,e){var r=e.length,i=t.getUTCMilliseconds(),a=Math.floor(i*Math.pow(10,r-3));return Sr(a,e.length)}},nc={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},cK={G:function(t,e,r){var i=t.getUTCFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){var i=t.getUTCFullYear(),a=i>0?i:1-i;return r.ordinalNumber(a,{unit:"year"})}return mo.y(t,e)},Y:function(t,e,r,i){var a=ok(t,i),s=a>0?a:1-a;if(e==="YY"){var u=s%100;return Sr(u,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):Sr(s,e.length)},R:function(t,e){var r=uk(t);return Sr(r,e.length)},u:function(t,e){var r=t.getUTCFullYear();return Sr(r,e.length)},Q:function(t,e,r){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return Sr(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,r){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return Sr(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,r){var i=t.getUTCMonth();switch(e){case"M":case"MM":return mo.M(t,e);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,r){var i=t.getUTCMonth();switch(e){case"L":return String(i+1);case"LL":return Sr(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,r,i){var a=dK(t,i);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):Sr(a,e.length)},I:function(t,e,r){var i=sK(t);return e==="Io"?r.ordinalNumber(i,{unit:"week"}):Sr(i,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getUTCDate(),{unit:"date"}):mo.d(t,e)},D:function(t,e,r){var i=rK(t);return e==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Sr(i,e.length)},E:function(t,e,r){var i=t.getUTCDay();switch(e){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,r,i){var a=t.getUTCDay(),s=(a-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Sr(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,i){var a=t.getUTCDay(),s=(a-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Sr(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){var i=t.getUTCDay(),a=i===0?7:i;switch(e){case"i":return String(a);case"ii":return Sr(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,r){var i=t.getUTCHours(),a=i/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){var i=t.getUTCHours(),a;switch(i===12?a=nc.noon:i===0?a=nc.midnight:a=i/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){var i=t.getUTCHours(),a;switch(i>=17?a=nc.evening:i>=12?a=nc.afternoon:i>=4?a=nc.morning:a=nc.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){var i=t.getUTCHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return mo.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getUTCHours(),{unit:"hour"}):mo.H(t,e)},K:function(t,e,r){var i=t.getUTCHours()%12;return e==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Sr(i,e.length)},k:function(t,e,r){var i=t.getUTCHours();return i===0&&(i=24),e==="ko"?r.ordinalNumber(i,{unit:"hour"}):Sr(i,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):mo.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):mo.s(t,e)},S:function(t,e){return mo.S(t,e)},X:function(t,e,r,i){var a=i._originalDate||t,s=a.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return Lw(s);case"XXXX":case"XX":return Nl(s);case"XXXXX":case"XXX":default:return Nl(s,":")}},x:function(t,e,r,i){var a=i._originalDate||t,s=a.getTimezoneOffset();switch(e){case"x":return Lw(s);case"xxxx":case"xx":return Nl(s);case"xxxxx":case"xxx":default:return Nl(s,":")}},O:function(t,e,r,i){var a=i._originalDate||t,s=a.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Dw(s,":");case"OOOO":default:return"GMT"+Nl(s,":")}},z:function(t,e,r,i){var a=i._originalDate||t,s=a.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Dw(s,":");case"zzzz":default:return"GMT"+Nl(s,":")}},t:function(t,e,r,i){var a=i._originalDate||t,s=Math.floor(a.getTime()/1e3);return Sr(s,e.length)},T:function(t,e,r,i){var a=i._originalDate||t,s=a.getTime();return Sr(s,e.length)}};function Dw(n,t){var e=n>0?"-":"+",r=Math.abs(n),i=Math.floor(r/60),a=r%60;if(a===0)return e+String(i);var s=t;return e+String(i)+s+Sr(a,2)}function Lw(n,t){if(n%60===0){var e=n>0?"-":"+";return e+Sr(Math.abs(n)/60,2)}return Nl(n,t)}function Nl(n,t){var e=t||"",r=n>0?"-":"+",i=Math.abs(n),a=Sr(Math.floor(i/60),2),s=Sr(i%60,2);return r+a+e+s}var xw=function(t,e){switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},lk=function(t,e){switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},fK=function(t,e){var r=t.match(/(P+)(p+)?/)||[],i=r[1],a=r[2];if(!a)return xw(t,e);var s;switch(i){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",xw(i,e)).replace("{{time}}",lk(a,e))},hK={p:lk,P:fK};function pK(n){var t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),n.getTime()-t.getTime()}var _K=["D","DD"],mK=["YY","YYYY"];function gK(n){return _K.indexOf(n)!==-1}function vK(n){return mK.indexOf(n)!==-1}function Uw(n,t,e){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(e,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(e,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(e,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(e,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var EK=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,yK=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,bK=/^'([^]*?)'?$/,CK=/''/g,IK=/[a-zA-Z]/;function su(n,t,e){var r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D;Gr(2,arguments);var P=String(t),U=Fm(),L=(r=(i=e==null?void 0:e.locale)!==null&&i!==void 0?i:U.locale)!==null&&r!==void 0?r:AO,B=Gu((a=(s=(u=(d=e==null?void 0:e.firstWeekContainsDate)!==null&&d!==void 0?d:e==null||(h=e.locale)===null||h===void 0||(p=h.options)===null||p===void 0?void 0:p.firstWeekContainsDate)!==null&&u!==void 0?u:U.firstWeekContainsDate)!==null&&s!==void 0?s:(g=U.locale)===null||g===void 0||(E=g.options)===null||E===void 0?void 0:E.firstWeekContainsDate)!==null&&a!==void 0?a:1);if(!(B>=1&&B<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var q=Gu((y=(C=(T=(A=e==null?void 0:e.weekStartsOn)!==null&&A!==void 0?A:e==null||(O=e.locale)===null||O===void 0||(N=O.options)===null||N===void 0?void 0:N.weekStartsOn)!==null&&T!==void 0?T:U.weekStartsOn)!==null&&C!==void 0?C:(k=U.locale)===null||k===void 0||(D=k.options)===null||D===void 0?void 0:D.weekStartsOn)!==null&&y!==void 0?y:0);if(!(q>=0&&q<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!L.localize)throw new RangeError("locale must contain localize property");if(!L.formatLong)throw new RangeError("locale must contain formatLong property");var z=fa(n);if(!Jz(z))throw new RangeError("Invalid time value");var Y=pK(z),Q=nK(z,Y),$={firstWeekContainsDate:B,weekStartsOn:q,locale:L,_originalDate:z},Z=P.match(yK).map(function(ne){var ue=ne[0];if(ue==="p"||ue==="P"){var pe=hK[ue];return pe(ne,L.formatLong)}return ne}).join("").match(EK).map(function(ne){if(ne==="''")return"'";var ue=ne[0];if(ue==="'")return TK(ne);var pe=cK[ue];if(pe)return!(e!=null&&e.useAdditionalWeekYearTokens)&&vK(ne)&&Uw(ne,t,String(n)),!(e!=null&&e.useAdditionalDayOfYearTokens)&&gK(ne)&&Uw(ne,t,String(n)),pe(Q,ne,L.localize,$);if(ue.match(IK))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ue+"`");return ne}).join("");return Z}function TK(n){var t=n.match(bK);return t?t[1].replace(CK,"'"):n}var MC="RESET_MESSAGES",Hm="FETCH_INITIAL_MESSAGES_START",Bm="FETCH_INITIAL_MESSAGES_SUCCESS",Ah="FETCH_INITIAL_MESSAGES_FAILURE",OC="FETCH_PREV_MESSAGES_SUCCESS",kC="FETCH_PREV_MESSAGES_FAILURE",DC="FETCH_NEXT_MESSAGES_SUCCESS",LC="FETCH_NEXT_MESSAGES_FAILURE",xC="SEND_MESSAGE_START",uu="SEND_MESSAGE_SUCCESS",Hu="SEND_MESSAGE_FAILURE",gh="RESEND_MESSAGE_START",UC="ON_MESSAGE_RECEIVED",Gh="ON_MESSAGE_UPDATED",PC="ON_MESSAGE_THREAD_INFO_UPDATED",Vh="ON_MESSAGE_DELETED",FC="ON_MESSAGE_DELETED_BY_REQ_ID",Fa="SET_CURRENT_CHANNEL",HC="SET_CHANNEL_INVALID",dk="MARK_AS_READ",BC="ON_REACTION_UPDATED",GC="SET_EMOJI_CONTAINER",VC="MESSAGE_LIST_PARAMS_CHANGED",jC="ON_FILE_INFO_UPLOADED",qC="ON_TYPING_STATUS_UPDATED",SK=Object.freeze({__proto__:null,FETCH_INITIAL_MESSAGES_FAILURE:Ah,FETCH_INITIAL_MESSAGES_START:Hm,FETCH_INITIAL_MESSAGES_SUCCESS:Bm,FETCH_NEXT_MESSAGES_FAILURE:LC,FETCH_NEXT_MESSAGES_SUCCESS:DC,FETCH_PREV_MESSAGES_FAILURE:kC,FETCH_PREV_MESSAGES_SUCCESS:OC,MARK_AS_READ:dk,MESSAGE_LIST_PARAMS_CHANGED:VC,ON_FILE_INFO_UPLOADED:jC,ON_MESSAGE_DELETED:Vh,ON_MESSAGE_DELETED_BY_REQ_ID:FC,ON_MESSAGE_RECEIVED:UC,ON_MESSAGE_THREAD_INFO_UPDATED:PC,ON_MESSAGE_UPDATED:Gh,ON_REACTION_UPDATED:BC,ON_TYPING_STATUS_UPDATED:qC,RESEND_MESSAGE_START:gh,RESET_MESSAGES:MC,SEND_MESSAGE_FAILURE:Hu,SEND_MESSAGE_START:xC,SEND_MESSAGE_SUCCESS:uu,SET_CHANNEL_INVALID:HC,SET_CURRENT_CHANNEL:Fa,SET_EMOJI_CONTAINER:GC}),Pw=function(n){return n==null};function pr(n,t){if(Pw(n)||Pw(t))return!1;var e=n.toString(),r=t.toString();return e===r}var Gm=30,Vm=15;function NK(n,t){var e=n.currentGroupChannel,r=n.initialTimeStamp,i=n.userFilledMessageListQuery,a=n.replyType,s=n.setIsScrolled,u=t.logger,d=t.scrollRef,h=t.messagesDispatcher,p=e==null?void 0:e.url,g=F.useCallback(function(){if(u.info("Channel useInitialMessagesFetch: Setup started",e),s(!1),h({type:MC,payload:null}),e&&(e!=null&&e.getMessagesByTimestamp)){var E={prevResultSize:Gm,isInclusive:!0,includeReactions:!0,includeMetaArray:!0};r&&(E.nextResultSize=Vm),(a==="QUOTE_REPLY"||a==="THREAD")&&(E.includeThreadInfo=!0,E.includeParentMessageInfo=!0,E.replyType=ti.ONLY_REPLY_TO_CHANNEL),i&&Object.keys(i).forEach(function(y){E[y]=i[y]}),(a&&(a==="QUOTE_REPLY"||a==="THREAD")||i)&&(u.info("Channel useInitialMessagesFetch: Setup messageListParams",E),h({type:VC,payload:E})),u.info("Channel: Fetching messages",{currentGroupChannel:e,userFilledMessageListQuery:i}),h({type:Hm,payload:null}),e.getMessagesByTimestamp(r||new Date().getTime(),E).then(function(y){h({type:Bm,payload:{currentGroupChannel:e,messages:y}})}).catch(function(y){u.error("Channel: Fetching messages failed",y),h({type:Ah,payload:{currentGroupChannel:e}})}).finally(function(){r?setTimeout(function(){ak(d,r,s)},500):setTimeout(function(){return lu(0,d,s)},dO)})}},[p,i,r]);return F.useEffect(function(){g()},[g]),g}function ck(n,t,e){e===void 0&&(e=!0);var r=F.useState(!1),i=r[0],a=r[1],s=!n;F.useEffect(function(){var d=function(){e&&a(document.hidden)};return document.addEventListener("visibilitychange",d),function(){document.removeEventListener("visibilitychange",d)}},[e,document.hidden]);var u=s&&!!t&&!i;return{shouldReconnect:u}}var du;(function(n){n.CHANNEL="CHANNEL",n.THREAD="THREAD"})(du||(du={}));var fk=function(n,t){return!t||t.length===0?!0:t.includes(n)};function x_(n){return fk(du.CHANNEL,n)}function AK(n){return fk(du.THREAD,n)}var Fi;(function(n){n.USER_UPDATED="USER_UPDATED",n.SEND_MESSAGE_START="SEND_MESSAGE_START",n.SEND_MESSAGE_FAILED="SEND_MESSAGE_FAILED",n.SEND_USER_MESSAGE="SEND_USER_MESSAGE",n.SEND_FILE_MESSAGE="SEND_FILE_MESSAGE",n.ON_FILE_INFO_UPLOADED="ON_FILE_INFO_UPLOADED",n.UPDATE_USER_MESSAGE="UPDATE_USER_MESSAGE",n.DELETE_MESSAGE="DELETE_MESSAGE",n.LEAVE_CHANNEL="LEAVE_CHANNEL",n.CREATE_CHANNEL="CREATE_CHANNEL",n.UPDATE_OPEN_CHANNEL="UPDATE_OPEN_CHANNEL"})(Fi||(Fi={}));var Yi=Fi,Lf="useToggleReactionCallback:";function wK(n,t){return F.useCallback(function(e,r,i){if(!n){t==null||t.warning("".concat(Lf," currentChannel doesn't exist"),n);return}i?n.deleteReaction(e,r).then(function(a){t==null||t.info("".concat(Lf," Delete reaction success"),a)}).catch(function(a){t==null||t.warning("".concat(Lf," Delete reaction failed"),a)}):n.addReaction(e,r).then(function(a){t==null||t.info("".concat(Lf," Add reaction success"),a)}).catch(function(a){t==null||t.warning("".concat(Lf," Add reaction failed"),a)})},[n])}function zC(n){return{lowerCase:n.toLowerCase(),upperCase:n.toUpperCase()}}function RK(n){return{lowerCase:n.toLowerCase(),upperCase:n.toUpperCase()}}var hk=function(n){n===void 0&&(n=0);var t=10,e=n;if(!(e>t))try{var r=document.querySelector(".sendbird-thread-ui--scroll");r&&(r.scrollTop=r.scrollHeight)}catch{setTimeout(function(){hk(e+1)},500*e)}},MK=function(n,t){var e=n.currentChannel,r=n.onBeforeSendMultipleFilesMessage,i=n.publishingModules,a=t.logger,s=t.pubSub,u=t.scrollRef,d=F.useCallback(function(h,p){return new Promise(function(g,E){e||(a.warning("Channel: Sending MFm failed, because currentChannel is null.",{currentChannel:e}),E()),h.length<=1&&(a.warning("Channel: Sending MFM failed, because there are no multiple files.",{files:h}),E());var y={fileInfoList:h.map(function(C){return{file:C,fileName:C.name,fileSize:C.size,mimeType:C.type}})};p&&(y.isReplyToChannel=!0,y.parentMessageId=p.messageId),typeof r=="function"&&(y=r(h,p)),a.info("Channel: Start sending MFM",{messageParams:y});try{e==null||e.sendMultipleFilesMessage(y).onFileUploaded(function(C,T,A,O){a.info("Channel: onFileUploaded during sending MFM",{requestId:C,index:T,error:O,uploadableFileInfo:A}),s.publish(Yi.ON_FILE_INFO_UPLOADED,{response:{channelUrl:e.url,requestId:C,index:T,uploadableFileInfo:A,error:O},publishingModules:i})}).onPending(function(C){a.info("Channel: in progress of sending MFM",{pendingMessage:C,fileInfoList:y.fileInfoList}),s.publish(Yi.SEND_MESSAGE_START,{message:C,channel:e,publishingModules:i}),setTimeout(function(){u&&x_(i)&&lu(0,u),AK(i)&&hk(0)},yc)}).onFailed(function(C,T){a.error("Channel: Sending MFM failed.",{error:C,failedMessage:T}),s.publish(Yi.SEND_MESSAGE_FAILED,{channel:e,message:T,publishingModules:i}),E(C)}).onSucceeded(function(C){a.info("Channel: Sending voice message success!",{succeededMessage:C}),s.publish(Yi.SEND_FILE_MESSAGE,{channel:e,message:C,publishingModules:i}),g(C)})}catch(C){a.error("Channel: Sending MFM failed.",{error:C}),E(C)}})},[e,r,i]);return[d]},OK={initialized:!1,loading:!0,allMessages:[],localMessages:[],currentGroupChannel:null,hasMorePrev:!1,oldestMessageTimeStamp:0,hasMoreNext:!1,latestMessageTimeStamp:0,emojiContainer:{emojiCategories:[],emojiHash:""},unreadSince:null,unreadSinceDate:null,isInvalid:!1,readStatus:null,messageListParams:null,typingMembers:[]},Fw=function(n){n===void 0&&(n=[]);var t=n[0];return t&&t.createdAt||null},Hw=function(n){n===void 0&&(n=[]);var t=n[n.length-1];return t&&t.createdAt||null};function tc(n){return"reqId"in n}function kK(n,t){var e=Bt().stringSet;return Mi(t).with({type:MC},function(){return re(re({},n),{hasMorePrev:!1,hasMoreNext:!1,allMessages:[],localMessages:[]})}).with({type:Hm},function(){return re(re({},n),{loading:!0,allMessages:n.allMessages.filter(function(r){return Hh(r)?r.sendingStatus!==jt.SUCCEEDED:!0}),localMessages:[]})}).with({type:Bm},function(r){var i,a=r.payload,s=a.currentGroupChannel,u=a.messages;if((s==null?void 0:s.url)!==((i=n.currentGroupChannel)===null||i===void 0?void 0:i.url))return n;var d=Fw(u),h=Hw(u);return re(re({},n),{loading:!1,initialized:!0,hasMorePrev:!0,hasMoreNext:!0,oldestMessageTimeStamp:d,latestMessageTimeStamp:h,allMessages:en([],u,!0)})}).with({type:OC},function(r){var i,a,s,u,d=r.payload,h=d.currentGroupChannel,p=d.messages;if((h==null?void 0:h.url)!==((i=n.currentGroupChannel)===null||i===void 0?void 0:i.url))return n;var g=((a=p==null?void 0:p.length)!==null&&a!==void 0?a:0)>=((u=(s=n==null?void 0:n.messageListParams)===null||s===void 0?void 0:s.prevResultSize)!==null&&u!==void 0?u:Gm)+1,E=Fw(p),y=[],C=n.allMessages.map(function(A){var O=p.find(function(N){var k=N.messageId;return pr(k,A.messageId)});return O?(y.push(O.messageId),O.updatedAt>A.updatedAt?O:A):A}),T=y.length>0?p.filter(function(A){return!y.find(function(O){return pr(O,A.messageId)})}):p;return re(re({},n),{hasMorePrev:g,oldestMessageTimeStamp:E,allMessages:en(en([],T,!0),C,!0)})}).with({type:DC},function(r){var i,a,s,u,d=r.payload,h=d.currentGroupChannel,p=d.messages;if((h==null?void 0:h.url)!==((i=n.currentGroupChannel)===null||i===void 0?void 0:i.url))return n;var g=((a=p==null?void 0:p.length)!==null&&a!==void 0?a:0)===((u=(s=n==null?void 0:n.messageListParams)===null||s===void 0?void 0:s.nextResultSize)!==null&&u!==void 0?u:Vm)+1,E=Hw(p),y=Zz(n.allMessages,p);return re(re({},n),{hasMoreNext:g,latestMessageTimeStamp:E,allMessages:y})}).with({type:Sy.union(Ah,kC,LC)},function(r){var i,a=r.payload.currentGroupChannel;if((a==null?void 0:a.url)!==((i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url))return n;var s=[Ah].includes(r.type);return re(re({},n),{loading:!1,isInvalid:s,initialized:!1,allMessages:[],hasMorePrev:!1,hasMoreNext:!1,oldestMessageTimeStamp:null,latestMessageTimeStamp:null})}).with({type:xC},function(r){return re(re({},n),{localMessages:en(en([],n.localMessages,!0),[r.payload],!1)})}).with({type:uu},function(r){var i=r.payload,a=n.allMessages.filter(function(s){return!tc(s)||(s==null?void 0:s.reqId)!==(i==null?void 0:i.reqId)});return re(re({},n),{allMessages:en(en([],a,!0),[i],!1),localMessages:n.localMessages.filter(function(s){return tc(s)&&(s==null?void 0:s.reqId)!==(i==null?void 0:i.reqId)})})}).with({type:Hu},function(r){return r.payload.failed=!0,re(re({},n),{localMessages:n.localMessages.map(function(i){return pr(tc(i)&&i.reqId,r.payload.reqId)?r.payload:i})})}).with({type:Fa},function(r){return re(re({},n),{currentGroupChannel:r.payload,isInvalid:!1})}).with({type:HC},function(){return re(re({},n),{currentGroupChannel:null,allMessages:[],localMessages:[],isInvalid:!0})}).with({type:UC},function(r){var i,a,s=r.payload,u=s.channel,d=s.message,h=u.members,p=d.sender,g=n.currentGroupChannel,E=g==null?void 0:g.url;if(!pr(u==null?void 0:u.url,E)||n.allMessages.some(function(C){return C.messageId===d.messageId})||n.messageListParams&&!cA(n.messageListParams,d))return n;if(d.isAdminMessage&&d.isAdminMessage())return re(re({},n),{allMessages:kw(n.allMessages,d)});var y=h==null?void 0:h.find(function(C){return(C==null?void 0:C.userId)===(p==null?void 0:p.userId)});return((y==null?void 0:y.profileUrl)!==(p==null?void 0:p.profileUrl)||(y==null?void 0:y.friendName)!==(p==null?void 0:p.friendName)||(y==null?void 0:y.nickname)!==(p==null?void 0:p.nickname))&&(u.members=h.map(function(C){return C.userId===p.userId?p:C})),re(re({},n),{currentGroupChannel:u,unreadSince:(i=n.unreadSince)!==null&&i!==void 0?i:su(new Date,e.DATE_FORMAT__UNREAD_SINCE),unreadSinceDate:(a=n.unreadSinceDate)!==null&&a!==void 0?a:new Date,allMessages:kw(n.allMessages,d)})}).with({type:Gh},function(r){var i,a=r.payload,s=a.channel,u=a.message,d=((i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url)||"";return pr(s==null?void 0:s.url,d)?n.messageListParams&&!cA(n.messageListParams,u)?re(re({},n),{allMessages:n.allMessages.filter(function(h){return!pr(h.messageId,u==null?void 0:u.messageId)})}):re(re({},n),{allMessages:n.allMessages.map(function(h){return pr(h.messageId,u.messageId)?u:(pr(h.parentMessageId,u.messageId)&&(h.parentMessage=u),h)})}):n}).with({type:PC},function(r){var i,a=r.payload,s=a.channel,u=a.event,d=u.channelUrl,h=u.threadInfo,p=u.targetMessageId,g=((i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url)||"";return!pr(s==null?void 0:s.url,g)||!pr(s==null?void 0:s.url,d)?n:re(re({},n),{allMessages:n.allMessages.map(function(E){return pr(E.messageId,p)&&(E.threadInfo=h),E})})}).with({type:gh},function(r){return re(re({},n),{localMessages:n.localMessages.map(function(i){return pr(tc(i)&&i.reqId,r.payload.reqId)?r.payload:i})})}).with({type:dk},function(r){var i,a,s;return((i=n.currentGroupChannel)===null||i===void 0?void 0:i.url)!==((s=(a=r.payload)===null||a===void 0?void 0:a.channel)===null||s===void 0?void 0:s.url)?n:re(re({},n),{unreadSince:null,unreadSinceDate:null})}).with({type:Vh},function(r){return re(re({},n),{allMessages:n.allMessages.filter(function(i){return!pr(i.messageId,r.payload)})})}).with({type:FC},function(r){return re(re({},n),{localMessages:n.localMessages.filter(function(i){return!pr(tc(i)&&i.reqId,r.payload)})})}).with({type:GC},function(r){return re(re({},n),{emojiContainer:r.payload})}).with({type:BC},function(r){return re(re({},n),{allMessages:n.allMessages.map(function(i){return pr(i.messageId,r.payload.messageId)&&i.applyReactionEvent&&typeof i.applyReactionEvent=="function"&&i.applyReactionEvent(r.payload),i})})}).with({type:VC},function(r){return re(re({},n),{messageListParams:r.payload})}).with({type:jC},function(r){var i,a,s=r.payload,u=s.channelUrl,d=s.requestId,h=s.index,p=s.uploadableFileInfo,g=s.error;if(!pr(u,(i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url)||g)return n;var E=n.localMessages,y=E.find(function(T){return pr(tc(T)&&T.reqId,d)}),C=(a=y.messageParams)===null||a===void 0?void 0:a.fileInfoList;return Array.isArray(C)&&(C[h]=p),re(re({},n),{localMessages:E})}).with({type:qC},function(r){var i,a=r.payload,s=a.channel,u=a.typingMembers;return pr(s.url,(i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url)?re(re({},n),{typingMembers:u}):n}).otherwise(function(){return n})}var DK="delivery_receipt";function LK(n,t){var e,r,i,a=n.sdkInit,s=n.currentGroupChannel,u=n.disableMarkAsRead,d=t.sdk,h=t.logger,p=t.scrollRef,g=t.setQuoteMessage,E=t.messagesDispatcher,y=Mt(),C=y.config,T=C.markAsReadScheduler,A=C.markAsDeliveredScheduler,O=C.disableMarkAsDelivered,N=(i=(r=(e=y.stores.sdkStore.sdk)===null||e===void 0?void 0:e.appInfo)===null||r===void 0?void 0:r.premiumFeatureList)===null||i===void 0?void 0:i.find(function(k){return k===DK});F.useEffect(function(){var k,D=s==null?void 0:s.url,P=fs();if(D&&a){var U={onMessageReceived:function(L,B){var q,z;if(L.isGroupChannel()&&pr(L==null?void 0:L.url,D)){var Y=!1;try{var Q=p.current;Q&&(Y=Q.offsetHeight+Q.scrollTop>=Q.scrollHeight-10)}catch{}if(h.info("Channel | useHandleChannelEvents: onMessageReceived",B),E({type:UC,payload:{channel:L,message:B}}),Y&&((q=document.getElementById("sendbird-dropdown-portal"))===null||q===void 0?void 0:q.childElementCount)===0&&((z=document.getElementById("sendbird-emoji-list-portal"))===null||z===void 0?void 0:z.childElementCount)===0)try{setTimeout(function(){return lu(0,p)}),u||T.push(s),N&&!O&&A.push(s)}catch{h.warning("Channel | onMessageReceived | scroll to end failed")}}},onUnreadMemberStatusUpdated:function(L){h.info("Channel | useHandleChannelEvents: onUnreadMemberStatusUpdated",L),pr(L==null?void 0:L.url,D)&&E({type:Fa,payload:L})},onUndeliveredMemberStatusUpdated:function(L){pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onDeliveryReceiptUpdated",L),E({type:Fa,payload:L}))},onMessageUpdated:function(L,B){L.isGroupChannel()&&pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onMessageUpdated",B),E({type:Gh,payload:{channel:L,message:B}}))},onThreadInfoUpdated:function(L,B){L.isGroupChannel()&&pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onThreadInfoUpdated",{channel:L,threadInfoUpdateEvent:B}),E({type:PC,payload:{channel:L,event:B}}))},onMessageDeleted:function(L,B){h.info("Channel | useHandleChannelEvents: onMessageDeleted",{channel:L,messageId:B}),g(null),E({type:Vh,payload:B})},onReactionUpdated:function(L,B){h.info("Channel | useHandleChannelEvents: onReactionUpdated",{channel:L,reactionEvent:B}),E({type:BC,payload:B})},onChannelChanged:function(L){L.isGroupChannel()&&pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onChannelChanged",L),E({type:Fa,payload:L}))},onChannelFrozen:function(L){L.isGroupChannel()&&pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onChannelFrozen",L),E({type:Fa,payload:L}))},onChannelUnfrozen:function(L){L.isGroupChannel()&&pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onChannelUnFrozen",L),E({type:Fa,payload:L}))},onUserMuted:function(L,B){L.isGroupChannel()&&pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onUserMuted",{channel:L,user:B}),E({type:Fa,payload:L}))},onUserUnmuted:function(L,B){L.isGroupChannel()&&pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onUserUnmuted",{channel:L,user:B}),E({type:Fa,payload:L}))},onUserBanned:function(L,B){var q;if(pr(L==null?void 0:L.url,D)&&L.isGroupChannel()){h.info("Channel | useHandleChannelEvents: onUserBanned",{channel:L,user:B});var z=(B==null?void 0:B.userId)===((q=d==null?void 0:d.currentUser)===null||q===void 0?void 0:q.userId);E({type:Fa,payload:z?null:L})}},onOperatorUpdated:function(L,B){L.isGroupChannel()&&pr(L==null?void 0:L.url,D)&&(h.info("Channel | useHandleChannelEvents: onOperatorUpdated",{channel:L,users:B}),E({type:Fa,payload:L}))},onUserLeft:function(L,B){var q;if(pr(L==null?void 0:L.url,D)){h.info("Channel | useHandleChannelEvents: onUserLeft",{channel:L,user:B});var z=(B==null?void 0:B.userId)===((q=d==null?void 0:d.currentUser)===null||q===void 0?void 0:q.userId);E({type:Fa,payload:z?null:L})}},onTypingStatusUpdated:function(L){if(pr(L==null?void 0:L.url,D)){h.info("Channel | onTypingStatusUpdated",{channel:L});var B=L.getTypingUsers();E({type:qC,payload:{channel:L,typingMembers:B}})}}};h.info("Channel | useHandleChannelEvents: Setup event handler",{channelHandlerId:P,channelHandler:U}),(k=d.groupChannel)===null||k===void 0||k.addGroupChannelHandler(P,new Uh(U))}return function(){var L;!((L=d==null?void 0:d.groupChannel)===null||L===void 0)&&L.removeGroupChannelHandler?(h.info("Channel | useHandleChannelEvents: Removing message reciver handler",P),d.groupChannel.removeGroupChannelHandler(P)):d!=null&&d.groupChannel&&h.error("Channel | useHandleChannelEvents: Not found the removeGroupChannelHandler")}},[s==null?void 0:s.url,a])}function xK(n,t){var e=n.channelUrl,r=n.sdkInit,i=n.disableMarkAsRead,a=t.messagesDispatcher,s=t.sdk,u=t.logger,d=t.markAsReadScheduler;F.useEffect(function(){e&&r&&s&&s.groupChannel&&(u.info("Channel | useSetChannel fetching channel",e),s.groupChannel.getChannel(e).then(function(h){u.info("Channel | useSetChannel fetched channel",h),a({type:Fa,payload:h}),u.info("Channel: Mark as read",h),i||d.push(h)}).catch(function(h){u.warning("Channel | useSetChannel fetch channel failed",{channelUrl:e,e:h}),a({type:HC})}),s.getAllEmoji().then(function(h){u.info("Channel: Getting emojis success",h),a({type:GC,payload:h})}).catch(function(h){u.error("Channel: Getting emojis failed",h)}))},[e,r])}function UK(n,t){var e=n.isOnline,r=n.replyType,i=n.disableMarkAsRead,a=n.reconnectOnIdle,s=t.logger,u=t.sdk,d=t.scrollRef,h=t.currentGroupChannel,p=t.messagesDispatcher,g=t.markAsReadScheduler,E=t.userFilledMessageListQuery,y=ck(e,h,a).shouldReconnect;F.useEffect(function(){return function(){var C,T,A;if(y){s.info("Refreshing conversation state");var O=((C=u==null?void 0:u.appInfo)===null||C===void 0?void 0:C.useReaction)||!1,N={prevResultSize:Gm,isInclusive:!0,includeReactions:O,includeMetaArray:!0,nextResultSize:Vm};r&&r==="QUOTE_REPLY"&&(N.includeThreadInfo=!0,N.includeParentMessageInfo=!0,N.replyType=ti.ONLY_REPLY_TO_CHANNEL),E&&Object.keys(E).forEach(function(k){N[k]=E[k]}),s.info("Channel: Fetching messages",{currentGroupChannel:h,userFilledMessageListQuery:E}),p({type:Hm,payload:null}),(T=u==null?void 0:u.groupChannel)===null||T===void 0||T.getChannel((A=h==null?void 0:h.url)!==null&&A!==void 0?A:"").then(function(k){var D=new Date().getTime();k.getMessagesByTimestamp(D,N).then(function(P){p({type:Bm,payload:{currentGroupChannel:k,messages:P}}),setTimeout(function(){return lu(0,d)},dO)}).catch(function(P){s.error("Channel: Fetching messages failed",P),p({type:Ah,payload:{currentGroupChannel:k}})}),i||g.push(k)})}}},[y,r])}function PK(n,t){var e=n.currentGroupChannel,r=n.oldestMessageTimeStamp,i=n.userFilledMessageListQuery,a=n.replyType,s=t.hasMorePrev,u=t.logger,d=t.messagesDispatcher,h=t.sdk;return F.useCallback(function(p){var g,E;if(s){var y={prevResultSize:Gm,isInclusive:!0,includeMetaArray:!0,includeReactions:(E=(g=h==null?void 0:h.appInfo)===null||g===void 0?void 0:g.useReaction)!==null&&E!==void 0?E:!1};(a==="QUOTE_REPLY"||a==="THREAD")&&(y.includeThreadInfo=!0,y.includeParentMessageInfo=!0,y.replyType=ti.ONLY_REPLY_TO_CHANNEL),i&&Object.keys(i).forEach(function(C){y[C]=i[C]}),u.info("Channel: Fetching messages",{currentGroupChannel:e,userFilledMessageListQuery:i}),e==null||e.getMessagesByTimestamp(r||new Date().getTime(),y).then(function(C){d({type:OC,payload:{currentGroupChannel:e,messages:C}}),p&&setTimeout(function(){return p()})}).catch(function(){d({type:kC,payload:{currentGroupChannel:e}})})}},[e,r,a])}function FK(n,t){var e=n.currentGroupChannel,r=n.latestMessageTimeStamp,i=n.userFilledMessageListQuery,a=n.hasMoreNext,s=n.replyType,u=t.logger,d=t.messagesDispatcher,h=t.sdk;return F.useCallback(function(p){var g,E;if(a){var y=(E=(g=h==null?void 0:h.appInfo)===null||g===void 0?void 0:g.useReaction)!==null&&E!==void 0?E:!1,C={nextResultSize:Vm,isInclusive:!0,includeReactions:y,includeMetaArray:!0};s&&(s==="QUOTE_REPLY"||s==="THREAD")&&(C.includeThreadInfo=!0,C.includeParentMessageInfo=!0,C.replyType=ti.ONLY_REPLY_TO_CHANNEL),i&&Object.keys(i).forEach(function(T){C[T]=i[T]}),u.info("Channel: Fetching later messages",{currentGroupChannel:e,userFilledMessageListQuery:i}),e==null||e.getMessagesByTimestamp(r||new Date().getTime(),C).then(function(T){d({type:DC,payload:{currentGroupChannel:e,messages:T}}),setTimeout(function(){return p([T,null])})}).catch(function(T){u.error("Channel: Fetching later messages failed",T),d({type:LC,payload:{currentGroupChannel:e}}),setTimeout(function(){return p([null,T])})})}},[e,r,a,s])}function HK(n,t){var e=n.currentGroupChannel,r=n.messagesDispatcher,i=t.logger;return F.useCallback(function(a){i.info("Channel | useDeleteMessageCallback: Deleting message",a);var s=Hh(a)?a.sendingStatus:void 0;return new Promise(function(u,d){i.info("Channel | useDeleteMessageCallback: Deleting message requestState:",s),(s===jt.FAILED||s===jt.PENDING)&&"reqId"in a?(i.info("Channel | useDeleteMessageCallback: Deleted message from local:",a),r({type:FC,payload:a.reqId}),u()):(i.info("Channel | useDeleteMessageCallback: Deleting message from remote:",s),e==null||e.deleteMessage(a).then(function(){i.info("Channel | useDeleteMessageCallback: Deleting message success!",a),r({type:Vh,payload:a.messageId}),u()}).catch(function(h){i.warning("Channel | useDeleteMessageCallback: Deleting message failed!",h),d(h)}))})},[e,r])}function BK(n,t){var e=n.currentGroupChannel,r=n.messagesDispatcher,i=n.onBeforeUpdateUserMessage,a=n.isMentionEnabled,s=t.logger,u=t.pubSub;return F.useCallback(function(d,h){var p=d.messageId,g=d.message,E=d.mentionedUsers,y=d.mentionTemplate,C=function(O){var N={message:O};return a&&E&&E.length>0&&(N.mentionedUsers=E),a&&y?N.mentionedMessageTemplate=y:N.mentionedMessageTemplate=O,N},T=i&&typeof i=="function";T&&s.info("Channel: creating params using onBeforeUpdateUserMessage",i);var A=T?i(g):C(g);s.info("Channel: Updating message!",A),e==null||e.updateUserMessage(p,A).then(function(O){h&&h(null,O),s.info("Channel: Updating message success!",O),r({type:Gh,payload:{channel:e,message:O}}),u.publish(Yi.UPDATE_USER_MESSAGE,{message:O,channel:e,publishingModules:[du.CHANNEL]})}).catch(function(O){h&&h(O,null)})},[e==null?void 0:e.url,r,i])}function GK(n,t){var e=n.currentGroupChannel,r=n.messagesDispatcher,i=t.logger,a=t.pubSub;return F.useCallback(function(s){i.info("Channel: Resending message has started",s),s!=null&&s.isResendable?s.isUserMessage()?e==null||e.resendMessage(s).onPending(function(u){i.info("Channel: Resending message start!",u),r({type:gh,payload:u})}).onSucceeded(function(u){i.info("Channel: Resending message success!",u),r({type:uu,payload:u})}).onFailed(function(u,d){i.warning("Channel: Resending message failed!",u),r({type:Hu,payload:d})}):s.isFileMessage()?e==null||e.resendMessage(s).onPending(function(u){i.info("Channel: Resending file message start!",u),r({type:gh,payload:u})}).onSucceeded(function(u){i.info("Channel: Resending file message success!",u),r({type:uu,payload:u})}).onFailed(function(u,d){i.warning("Channel: Resending file message failed!",u),r({type:Hu,payload:d})}):s.isMultipleFilesMessage()&&(e==null||e.resendMessage(s).onPending(function(u){i.info("Channel: Resending multiple files message start!",u),r({type:gh,payload:u})}).onFileUploaded(function(u,d,h,p){var g;i.info("Channel: Resending multiple files message file uploaded!",{requestId:u,index:d,error:p,uploadableFileInfo:h}),a.publish(Yi.ON_FILE_INFO_UPLOADED,{response:{channelUrl:(g=e==null?void 0:e.url)!==null&&g!==void 0?g:"",requestId:u,index:d,uploadableFileInfo:h,error:p},publishingModules:[du.CHANNEL]})}).onSucceeded(function(u){i.info("Channel: Resending multiple files message success!",u),r({type:uu,payload:u})}).onFailed(function(u,d){i.warning("Channel: Resending multiple files message failed!",u),r({type:Hu,payload:d})})):i.error("Message is not resendable",s)},[e,r])}function VK(n,t){var e=n.isMentionEnabled,r=n.currentGroupChannel,i=n.onBeforeSendUserMessage,a=t.logger,s=t.pubSub,u=t.scrollRef,d=t.messagesDispatcher,h=F.useRef(null),p=F.useCallback(function(g){var E=g.quoteMessage,y=g.message,C=g.mentionTemplate,T=g.mentionedUsers,A=function(){var k={message:y};return e&&T&&T.length>0&&(k.mentionedUsers=T),e&&C&&T&&T.length>0&&(k.mentionedMessageTemplate=C),E&&(k.isReplyToChannel=!0,k.parentMessageId=E.messageId),k},O=i&&typeof i=="function";O&&a.info("Channel: creating params using onBeforeSendUserMessage",i);var N=O?i(y,E):A();a.info("Channel: Sending message has started",N),r==null||r.sendUserMessage(N).onPending(function(k){s.publish(Yi.SEND_MESSAGE_START,{message:k,channel:r,publishingModules:[du.CHANNEL]}),setTimeout(function(){return lu(0,u)},yc)}).onFailed(function(k,D){a.warning("Channel: Sending message failed!",{message:D,error:k}),d({type:Hu,payload:D})}).onSucceeded(function(k){a.info("Channel: Sending message success!",k),d({type:uu,payload:k})})},[r,i]);return[h,p]}function jK(n,t){var e=n.currentGroupChannel,r=n.onBeforeSendFileMessage,i=n.imageCompression,a=t.logger,s=t.pubSub,u=t.scrollRef,d=t.messagesDispatcher,h=F.useCallback(function(p,g){return new Promise(function(E,y){var C=r==null?void 0:r(p,g);C||(C={file:p},g&&(C.isReplyToChannel=!0,C.parentMessageId=g.messageId)),a.info("Channel: Uploading file message start!",C),e==null||e.sendFileMessage(C).onPending(function(T){s.publish(Yi.SEND_MESSAGE_START,{message:re(re({},T),{url:URL.createObjectURL(p),requestState:"pending",isUserMessage:T.isUserMessage,isFileMessage:T.isFileMessage,isAdminMessage:T.isAdminMessage,isMultipleFilesMessage:T.isMultipleFilesMessage}),channel:e,publishingModules:[du.CHANNEL]}),setTimeout(function(){return lu(0,u)},yc)}).onFailed(function(T,A){a.error("Channel: Sending file message failed!",{failedMessage:A,err:T}),A.localUrl=URL.createObjectURL(p),A.file=p,d({type:Hu,payload:A}),y(T)}).onSucceeded(function(T){a.info("Channel: Sending file message success!",T),d({type:uu,payload:T}),E(T)})})},[e,r,i]);return[h]}function qK(n){var t=n.current,e=t==null?void 0:t.parentNode;t&&e&&(t.style.pointerEvents="none",e.style.cursor="wait")}function zK(n){var t=n.current,e=t==null?void 0:t.parentNode;t&&e&&(t.style.pointerEvents="auto",e.style.cursor="auto")}function KK(n,t){var e=n.setInitialTimeStamp,r=n.setAnimatedMessageId,i=n.allMessages,a=n.scrollRef,s=t.logger;return F.useCallback(function(u,d){var h=i.find(function(p){return p.messageId===d});r(null),setTimeout(function(){try{s.info("Channel: scroll to message - disabling mouse events"),qK(a),h?(s.info("Channel: scroll to message - message is present"),r(d),ak(a,u)):(s.info("Channel: scroll to message - fetching older messages"),e(null),e(u),r(d))}finally{s.info("Channel: scroll to message - enabled mouse events"),zK(a)}})},[e,r,i])}var WK=function(n,t){var e=n.currentGroupChannel,r=n.onBeforeSendVoiceMessage,i=t.logger,a=t.pubSub,s=t.scrollRef,u=t.messagesDispatcher,d=F.useCallback(function(h,p,g){return new Promise(function(E,y){if(e){var C=r&&typeof r=="function"?r(h,g):{file:h,fileName:cm,mimeType:$l,metaArrays:[new Vi({key:hj,value:["".concat(p)]}),new Vi({key:pj,value:[_j]})]};g&&(C.isReplyToChannel=!0,C.parentMessageId=g.messageId),i.info("Channel: Start sending voice message",C),e.sendFileMessage(C).onPending(function(T){a.publish(Yi.SEND_MESSAGE_START,{message:T,channel:e,publishingModules:[du.CHANNEL]}),setTimeout(function(){return lu(0,s)},yc)}).onFailed(function(T,A){i.error("Channel: Sending voice message failed!",{failedMessage:A,err:T}),u({type:Hu,payload:A}),y(T)}).onSucceeded(function(T){i.info("Channel: Sending voice message success!",T),u({type:uu,payload:T}),E(T)})}})},[e,r]);return[d]},$K=function(n){var t=n.channelUrl,e=n.sdkInit,r=n.pubSub,i=n.dispatcher,a=n.scrollRef;F.useEffect(function(){var s=new Map;return r!=null&&r.subscribe&&(s.set(Fi.SEND_USER_MESSAGE,r.subscribe(Fi.SEND_USER_MESSAGE,function(u){var d=u.channel,h=u.message;t===(d==null?void 0:d.url)&&(i({type:uu,payload:h}),setTimeout(function(){return lu(0,a)},yc))})),s.set(Fi.SEND_MESSAGE_START,r.subscribe(Fi.SEND_MESSAGE_START,function(u){var d=u.channel,h=u.message,p=u.publishingModules;t===(d==null?void 0:d.url)&&x_(p)&&i({type:xC,payload:h})})),s.set(Fi.ON_FILE_INFO_UPLOADED,r.subscribe(Fi.ON_FILE_INFO_UPLOADED,function(u){var d=u.response,h=u.publishingModules;t===d.channelUrl&&x_(h)&&i({type:jC,payload:d})})),s.set(Fi.SEND_MESSAGE_FAILED,r.subscribe(Fi.SEND_MESSAGE_FAILED,function(u){var d=u.channel,h=u.message,p=u.publishingModules;t===(d==null?void 0:d.url)&&x_(p)&&i({type:Hu,payload:h})})),s.set(Fi.SEND_FILE_MESSAGE,r.subscribe(Fi.SEND_FILE_MESSAGE,function(u){var d=u.channel,h=u.message;t===(d==null?void 0:d.url)&&(i({type:uu,payload:h}),setTimeout(function(){return lu(0,a)},yc))})),s.set(Fi.UPDATE_USER_MESSAGE,r.subscribe(Fi.UPDATE_USER_MESSAGE,function(u){var d=u.channel,h=u.message,p=u.fromSelector;p&&t===(d==null?void 0:d.url)&&d.isGroupChannel()&&i({type:Gh,payload:{channel:d,message:h}})})),s.set(Fi.DELETE_MESSAGE,r.subscribe(Fi.DELETE_MESSAGE,function(u){var d=u.channel,h=u.messageId;t===(d==null?void 0:d.url)&&i({type:Vh,payload:h})}))),function(){s.forEach(function(u){try{u.remove()}catch{}})}},[t,e])},pk=b.createContext(null),YK=function(n){var t,e,r,i,a,s,u=n.channelUrl,d=n.children,h=n.isReactionEnabled,p=n.isMessageGroupingEnabled,g=p===void 0?!0:p,E=n.isMultipleFilesMessageEnabled,y=n.showSearchIcon,C=n.animatedMessage,T=n.highlightedMessage,A=n.startingPoint,O=n.onBeforeSendUserMessage,N=n.onBeforeSendFileMessage,k=n.onBeforeUpdateUserMessage,D=n.onBeforeSendVoiceMessage,P=n.onBeforeSendMultipleFilesMessage,U=n.onChatHeaderActionClick,L=n.onSearchClick,B=n.onBackClick,q=n.threadReplySelectType,z=n.queries,Y=n.filterMessageList,Q=n.disableMarkAsRead,$=Q===void 0?!1:Q,Z=n.onReplyInThread,ne=n.onQuoteMessageClick,ue=n.onMessageAnimated,pe=n.onMessageHighlighted,he=n.scrollBehavior,le=he===void 0?"auto":he,we=n.reconnectOnIdle,ve=we===void 0?!0:we,Ue=Mt(),be=Ue.config,Qe=(t=n.replyType)!==null&&t!==void 0?t:zC(be.groupChannel.replyType).upperCase,Ne=be.pubSub,$e=be.logger,gn=be.userId,En=be.isOnline,Yn=be.imageCompression,Gn=be.markAsReadScheduler,Tn=be.groupChannel,kn=(r=(e=Ue==null?void 0:Ue.stores)===null||e===void 0?void 0:e.sdkStore)===null||r===void 0?void 0:r.sdk,Vn=(a=(i=Ue==null?void 0:Ue.stores)===null||i===void 0?void 0:i.sdkStore)===null||a===void 0?void 0:a.initialized,Hn=Ue==null?void 0:Ue.config,Jn=F.useState(A),jn=Jn[0],On=Jn[1];F.useEffect(function(){On(A)},[A,u]);var Ln=F.useState(null),An=Ln[0],wn=Ln[1],We=F.useState(T),ln=We[0],Pe=We[1];F.useEffect(function(){Pe(T)},[T]);var Ke=z==null?void 0:z.messageListParams,yn=F.useState(null),tn=yn[0],st=yn[1],Cn=F.useState(!1),Ve=Cn[0],Ut=Cn[1],mt=F.useReducer(kK,OK),ut=mt[0],In=mt[1],Qn=F.useRef(null),Ct=Tn.enableMention,Et=ut.allMessages,ct=ut.localMessages,Qt=ut.loading,Ot=ut.initialized,ft=ut.unreadSince,rt=ut.unreadSinceDate,xn=ut.isInvalid,Oe=ut.currentGroupChannel,Ee=ut.hasMorePrev,nn=ut.oldestMessageTimeStamp,Sn=ut.hasMoreNext,Pn=ut.latestMessageTimeStamp,lt=ut.emojiContainer,qn=ut.readStatus,Fn=ut.typingMembers,At=sk({channel:Oe,config:be,moduleLevel:h}),Pt=F.useMemo(function(){return At?Kz(lt):new Map},[lt]),zn=F.useMemo(function(){return At&&Oe?Wz(Oe==null?void 0:Oe.members):new Map},[Oe==null?void 0:Oe.members]);F.useEffect(function(){C&&wn(C)},[C]);var qt=PK({currentGroupChannel:Oe,oldestMessageTimeStamp:nn,userFilledMessageListQuery:Ke,replyType:Qe},{hasMorePrev:Ee,logger:$e,messagesDispatcher:In,sdk:kn}),cr=KK({setInitialTimeStamp:On,setAnimatedMessageId:wn,allMessages:Et,scrollRef:Qn},{logger:$e}),Fe=FK({currentGroupChannel:Oe,latestMessageTimeStamp:Pn,userFilledMessageListQuery:Ke,hasMoreNext:Sn,replyType:Qe},{logger:$e,messagesDispatcher:In,sdk:kn}),un=wK(Oe,$e);xK({channelUrl:u,sdkInit:Vn,disableMarkAsRead:$},{messagesDispatcher:In,sdk:kn,logger:$e,markAsReadScheduler:Gn}),F.useEffect(function(){st(null)},[u]),LK({currentGroupChannel:Oe,sdkInit:Vn,currentUserId:gn,disableMarkAsRead:$},{messagesDispatcher:In,sdk:kn,logger:$e,scrollRef:Qn,setQuoteMessage:st}),NK({currentGroupChannel:Oe,userFilledMessageListQuery:Ke,initialTimeStamp:jn,replyType:Qe,setIsScrolled:Ut},{logger:$e,scrollRef:Qn,messagesDispatcher:In}),$K({channelUrl:u,sdkInit:Vn,pubSub:Ne,dispatcher:In,scrollRef:Qn}),UK({isOnline:En,replyType:Qe,disableMarkAsRead:$,reconnectOnIdle:ve},{logger:$e,sdk:kn,scrollRef:Qn,currentGroupChannel:Oe,messagesDispatcher:In,userFilledMessageListQuery:Ke,markAsReadScheduler:Gn});var Ae=HK({currentGroupChannel:Oe,messagesDispatcher:In},{logger:$e}),Dn=BK({currentGroupChannel:Oe,messagesDispatcher:In,onBeforeUpdateUserMessage:k,isMentionEnabled:Ct},{logger:$e,pubSub:Ne}),pn=GK({currentGroupChannel:Oe,messagesDispatcher:In},{logger:$e,pubSub:Ne}),it=VK({currentGroupChannel:Oe,isMentionEnabled:Ct,onBeforeSendUserMessage:O},{logger:$e,pubSub:Ne,scrollRef:Qn,messagesDispatcher:In}),yt=it[0],zt=it[1],Ht=jK({currentGroupChannel:Oe,imageCompression:Yn,onBeforeSendFileMessage:N},{logger:$e,pubSub:Ne,scrollRef:Qn,messagesDispatcher:In})[0],Je=WK({currentGroupChannel:Oe,onBeforeSendVoiceMessage:D},{logger:$e,pubSub:Ne,scrollRef:Qn,messagesDispatcher:In})[0],oe=MK({currentChannel:Oe,onBeforeSendMultipleFilesMessage:P,publishingModules:[du.CHANNEL]},{logger:$e,pubSub:Ne,scrollRef:Qn})[0];return b.createElement(pk.Provider,{value:{channelUrl:u,isReactionEnabled:At,isMessageGroupingEnabled:g,isMultipleFilesMessageEnabled:E,showSearchIcon:y??Hn.groupChannelSettings.enableMessageSearch,highlightedMessage:T,startingPoint:A,onBeforeSendUserMessage:O,onBeforeSendFileMessage:N,onBeforeUpdateUserMessage:k,onChatHeaderActionClick:U,onSearchClick:L,onBackClick:B,replyType:Qe,threadReplySelectType:(s=q??RK(Tn.threadReplySelectType).upperCase)!==null&&s!==void 0?s:Is.THREAD,queries:z,filterMessageList:Y,disableMarkAsRead:$,onReplyInThread:Z,onQuoteMessageClick:ne,onMessageAnimated:ue,onMessageHighlighted:pe,allMessages:Et,localMessages:ct,loading:Qt,initialized:Ot,unreadSince:ft,unreadSinceDate:rt,isInvalid:xn,currentGroupChannel:Oe,hasMorePrev:Ee,hasMoreNext:Sn,oldestMessageTimeStamp:nn,latestMessageTimeStamp:Pn,emojiContainer:lt,readStatus:qn,typingMembers:Fn,scrollToMessage:cr,quoteMessage:tn,setQuoteMessage:st,deleteMessage:Ae,updateMessage:Dn,resendMessage:pn,messageInputRef:yt,sendMessage:zt,sendFileMessage:Ht,sendVoiceMessage:Je,sendMultipleFilesMessage:oe,initialTimeStamp:jn,messageActionTypes:SK,messagesDispatcher:In,setInitialTimeStamp:On,setAnimatedMessageId:wn,setHighLightedMessageId:Pe,animatedMessageId:An,highLightedMessageId:ln,nicknamesMap:zn,emojiAllMap:Pt,onScrollCallback:qt,onScrollDownCallback:Fe,scrollRef:Qn,scrollBehavior:le,toggleReaction:un,isScrolled:Ve,setIsScrolled:Ut}},b.createElement(tk,re({},n),d))},Vo=function(){var n=b.useContext(pk);if(!n)throw new Error("ChannelContext not found. Use within the Channel module.");return n},_k=function(n){var t=n.members;function e(){var r=F.useContext(kr).stringSet;return!t||t.length===0?"":t&&t.length===1?"".concat(t[0].nickname," ").concat(r.TYPING_INDICATOR__IS_TYPING):t&&t.length===2?"".concat(t[0].nickname," ").concat(r.TYPING_INDICATOR__AND," ").concat(t[1].nickname," ").concat(r.TYPING_INDICATOR__ARE_TYPING):r.TYPING_INDICATOR__MULTIPLE_TYPING}return b.createElement(b.Fragment,null,e())},QK=function(n){var t,e,r,i=n.channelUrl,a=Mt(),s=(e=(t=a==null?void 0:a.stores)===null||t===void 0?void 0:t.sdkStore)===null||e===void 0?void 0:e.sdk,u=(r=a==null?void 0:a.config)===null||r===void 0?void 0:r.logger,d=F.useState(fs()),h=d[0],p=d[1],g=F.useState([]),E=g[0],y=g[1];return F.useEffect(function(){var C;if(!((C=s==null?void 0:s.groupChannel)===null||C===void 0)&&C.addGroupChannelHandler){s.groupChannel.removeGroupChannelHandler(h);var T=fs(),A=new Uh({onTypingStatusUpdated:function(O){if(u.info("Channel > Typing Indicator: onTypingStatusUpdated",O),O.url===i){var N=O.getTypingUsers();y(N)}}});s.groupChannel.addGroupChannelHandler(T,A),p(T)}return function(){var O;y([]),!((O=s==null?void 0:s.groupChannel)===null||O===void 0)&&O.removeGroupChannelHandler&&s.groupChannel.removeGroupChannelHandler(h)}},[i]),b.createElement(Ge,{className:"sendbird-conversation__footer__typing-indicator__text",type:Be.CAPTION_2,color:Re.ONBACKGROUND_2},b.createElement(_k,{members:E}))},vm;(function(n){n.Text="text",n.Bubble="bubble"})(vm||(vm={}));function ZK(){var n=F.useContext(kr).stringSet;return b.createElement("div",{className:"sendbird-connection-status"},b.createElement(Ge,{type:Be.BODY_2,color:Re.ONBACKGROUND_2},n.TRYING_TO_CONNECT),b.createElement(mn,{type:Ye.DISCONNECTED,fillColor:sn.SENT,width:"14px",height:"14px"}))}function jm(n){var t=n.className,e=t===void 0?"":t,r=n.width,i=r===void 0?"26px":r,a=n.height,s=a===void 0?"26px":a,u=n.children,d=n.testID;return b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-loader"],!1).join(" "),"data-testid":d,style:{width:typeof i=="string"?i:"".concat(i,"px"),height:typeof s=="string"?s:"".concat(s,"px")}},u||b.createElement(mn,{type:Ye.SPINNER,width:"26px",height:"26px"}))}var Ur={LOADING:"LOADING",NO_CHANNELS:"NO_CHANNELS",NO_MESSAGES:"NO_MESSAGES",WRONG:"WRONG",SEARCH_IN:"SEARCH_IN",SEARCHING:"SEARCHING",NO_RESULTS:"NO_RESULTS"};function nu(n){var t=n.className,e=t===void 0?"":t,r=n.type,i=n.iconSize,a=n.searchInString,s=a===void 0?"":a,u=n.retryToConnect,d=F.useContext(kr).stringSet;return b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-place-holder"],!1).join(" ")},r===Ur.LOADING&&b.createElement(jm,{width:i||"48px",height:i||"48px"},b.createElement(mn,{type:Ye.SPINNER,fillColor:sn.PRIMARY,width:i||"48px",height:i||"48px"})),(r===Ur.NO_CHANNELS||r===Ur.NO_MESSAGES||r===Ur.WRONG)&&b.createElement("div",{className:"sendbird-place-holder__body"},r===Ur.NO_CHANNELS&&b.createElement(mn,{className:"sendbird-place-holder__body__icon",type:Ye.CHAT,fillColor:sn.ON_BACKGROUND_3,width:i||"64px",height:i||"64px"}),r===Ur.WRONG&&b.createElement(mn,{className:"sendbird-place-holder__body__icon",type:Ye.ERROR,fillColor:sn.ON_BACKGROUND_3,width:i||"64px",height:i||"64px"}),r===Ur.NO_MESSAGES&&b.createElement(mn,{className:"sendbird-place-holder__body__icon",type:Ye.MESSAGE,fillColor:sn.ON_BACKGROUND_3,width:i||"64px",height:i||"64px"}),b.createElement(Ge,{className:"sendbird-place-holder__body__text",type:Be.BODY_1,color:Re.ONBACKGROUND_2},r===Ur.NO_CHANNELS&&d.PLACE_HOLDER__NO_CHANNEL,r===Ur.WRONG&&d.PLACE_HOLDER__WRONG,r===Ur.NO_MESSAGES&&d.PLACE_HOLDER__NO_MESSAGES),u&&b.createElement("div",{className:"sendbird-place-holder__body__reconnect",role:"button",onClick:u,onKeyPress:u,tabIndex:0},b.createElement(mn,{className:"sendbird-place-holder__body__reconnect__icon",type:Ye.REFRESH,fillColor:sn.PRIMARY,width:"20px",height:"20px"}),b.createElement(Ge,{className:"sendbird-place-holder__body__reconnect__text",type:Be.BUTTON_1,color:Re.PRIMARY},d.PLACE_HOLDER__RETRY_TO_CONNECT))),(r===Ur.NO_RESULTS||r===Ur.SEARCH_IN||r===Ur.SEARCHING)&&b.createElement("div",{className:"sendbird-place-holder__body--align-top"},r===Ur.SEARCH_IN&&b.createElement("div",{className:"sendbird-place-holder__body--align-top__text"},b.createElement(Ge,{className:"sendbird-place-holder__body--align-top__text__search-in",type:Be.BUTTON_2,color:Re.ONBACKGROUND_2},d.SEARCH_IN),b.createElement(Ge,{className:"sendbird-place-holder__body--align-top__text__channel-name",type:Be.BUTTON_2,color:Re.PRIMARY},"'".concat(s)),b.createElement(Ge,{className:"sendbird-place-holder__body--align-top__text__quote",type:Be.BUTTON_2,color:Re.PRIMARY},"'")),r===Ur.SEARCHING&&b.createElement(Ge,{className:"sendbird-place-hlder__body--align-top__searching",type:Be.BODY_1,color:Re.ONBACKGROUND_2},d.SEARCHING),r===Ur.NO_RESULTS&&b.createElement(Ge,{className:"sendbird-place-hlder__body--align-top__no-result",type:Be.BODY_1,color:Re.ONBACKGROUND_2},d.NO_SEARCHED_MESSAGE)))}var XK=function(n){var t,e,r,i,a=n.isLoading,s=n.isInvalid,u=n.channelUrl,d=Bh(n),h=d.renderChannelHeader,p=d.renderMessageList,g=d.renderMessageInput,E=d.renderTypingIndicator,y=d.renderPlaceholderLoader,C=d.renderPlaceholderInvalid,T=Mt(),A=T.stores,O=T.config,N=(t=A==null?void 0:A.sdkStore)===null||t===void 0?void 0:t.error,k=O.logger,D=O.isOnline;return a?b.createElement("div",{className:"sendbird-conversation"},(y==null?void 0:y())||b.createElement(nu,{type:Ur.LOADING})):u?s?b.createElement("div",{className:"sendbird-conversation"},(C==null?void 0:C())||b.createElement(nu,{type:Ur.WRONG})):N?b.createElement("div",{className:"sendbird-conversation"},(C==null?void 0:C())||b.createElement(nu,{type:Ur.WRONG,retryToConnect:function(){k.info("Channel: reconnecting")}})):b.createElement("div",{className:"sendbird-conversation"},h==null?void 0:h({className:"sendbird-conversation__channel-header"}),p==null?void 0:p(n),b.createElement("div",{className:"sendbird-conversation__footer"},g==null?void 0:g(),b.createElement("div",{className:"sendbird-conversation__footer__typing-indicator"},(E==null?void 0:E())||((e=O==null?void 0:O.groupChannel)===null||e===void 0?void 0:e.enableTypingIndicator)&&((i=(r=O==null?void 0:O.groupChannel)===null||r===void 0?void 0:r.typingIndicatorTypes)===null||i===void 0?void 0:i.has(vm.Text))&&b.createElement(QK,{channelUrl:u}),!D&&b.createElement(ZK,null)))):b.createElement("div",{className:"sendbird-conversation"},(C==null?void 0:C())||b.createElement(nu,{type:Ur.NO_CHANNELS}))},mk=function(n){if(n!==null)return typeof n=="number"?"".concat(n,"px"):n};function Bw(n,t,e){var r;return"min(".concat(t??e,", ").concat((r=mk(n))!==null&&r!==void 0?r:e,")")}function JK(n){var t=n.width,e=n.height,r=n.maxSideLength,i=n.defaultMinLength,a=F.useMemo(function(){return Bw(t,r,i)},[t]),s=F.useMemo(function(){return Bw(e,r,i)},[e]);return[a,s]}var eW=function(){var n=F.useState(!1),t=n[0],e=n[1],r=F.useState(null),i=r[0],a=r[1],s=F.useCallback(function(u){u!==null&&a(u)},[]);return F.useEffect(function(){if(i){var u=new IntersectionObserver(function(d){var h=d[0];e(h.isIntersecting)});return u.observe(i),function(){u.disconnect()}}},[i]),[s,t]},nW=function(){var n=F.useRef(!1),t=eW(),e=t[0],r=t[1];return r&&(n.current=!0),[e,n.current]};function Gw(n,t){return n===void 0&&(n=!1),t===void 0&&(t=null),n?"50%":mk(t)}function tW(n,t,e){var r=typeof n=="string"?parseInt(n,10):n,i=e-1,a=t===0?r*2:r,s=t===1?r*2:r,u=t===i?r*2:r,d=t===i-1?r*2:r;return"".concat(a,"px ").concat(s,"px ").concat(u,"px ").concat(d,"px")}var ui=function(n){var t=n.className,e=t===void 0?"":t,r=n.url,i=n.alt,a=i===void 0?"":i,s=n.width,u=s===void 0?null:s,d=n.maxSideLength,h=d===void 0?null:d,p=n.height,g=p===void 0?null:p,E=n.circle,y=E===void 0?!1:E,C=n.fixedSize,T=C===void 0?!1:C,A=n.placeHolder,O=A===void 0?null:A,N=n.defaultComponent,k=N===void 0?null:N,D=n.borderRadius,P=D===void 0?null:D,U=n.onLoad,L=U===void 0?ur:U,B=n.onError,q=B===void 0?ur:B,z=n.shadeOnHover,Y=n.isUploaded,Q=Y===void 0?!0:Y,$=nW(),Z=$[0],ne=$[1],ue=ne?r:null,pe=F.useState(!1),he=pe[0],le=pe[1],we=F.useState(!0),ve=we[0],Ue=we[1],be=JK({width:u,height:g,maxSideLength:h,defaultMinLength:"400px"}),Qe=be[0],Ne=be[1],$e=function(){return typeof O=="function"?O({style:{width:"100%",minWidth:Qe,maxWidth:T?Qe:"400px",height:Ne,position:"absolute",display:"flex",justifyContent:"center",alignItems:"center"}}):O},gn=function(){return typeof k=="function"?k():k},En=function(){var Yn=ue?{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover",backgroundImage:"url(".concat(ue,")")}:{};return b.createElement("div",{className:"sendbird-image-renderer__image",style:re({width:"100%",minWidth:Qe,maxWidth:T?Qe:"400px",height:Ne,position:"absolute",borderRadius:Gw(y,P)},Yn)})};return Qe&&Ne&&b.createElement("div",{ref:Z,className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-image-renderer"],!1).join(" "),style:{width:"100%",minWidth:Qe,maxWidth:T?Qe:"400px",height:Ne}},ve&&$e(),!ue||he?gn():En(),z&&b.createElement("div",{className:"sendbird-multiple-files-image-renderer__image-cover",style:re({borderRadius:Gw(y,P)},Q?{}:{display:"inline-flex"})}),ue&&b.createElement(rW,{src:ue,alt:a,onLoadStart:function(){Ue(!0),le(!1)},onLoad:function(){Ue(!1),le(!1),L()},onError:function(){Ue(!1),le(!0),q()}}))},rW=function(n){var t=n.src,e=n.alt,r=n.onLoadStart,i=r===void 0?ur:r,a=n.onLoad,s=a===void 0?ur:a,u=n.onError,d=u===void 0?ur:u,h=F.useRef({currSrc:t,prevSrc:t,loadFailure:!1});return h.current.currSrc!==t&&(h.current.prevSrc=h.current.currSrc,h.current.currSrc=t),F.useLayoutEffect(function(){if(t){var p=h.current.prevSrc!==h.current.currSrc,g=h.current.loadFailure;(p||g)&&i()}},[t,navigator.onLine]),b.createElement("img",{className:"sendbird-image-renderer__hidden-image-loader",src:t,alt:e,onLoad:function(){h.current.loadFailure=!1,s()},onError:function(){h.current.loadFailure=!0,d()}})},Cc=function(n){if(typeof n=="number")return n;if(typeof n=="string"){var t=Number.parseFloat(n);if(!Number.isNaN(t))return t}return NaN},gk=function(n){var t=n.width,e=n.height,r=n.text,i=Cc(t),a=Cc(e);return typeof i=="number"&&!Number.isNaN(i)&&(i*=.575),typeof a=="number"&&!Number.isNaN(a)&&(a*=.575),b.createElement("div",{className:Rt("sendbird-avatar-img--default",r&&"text"),style:{width:t,height:e}},r?b.createElement("div",{className:"sendbird-avatar-text"},r):b.createElement(mn,{type:Ye.USER,fillColor:sn.CONTENT,width:i,height:a}))},Tu="sendbird-avatar-img",iW=function(n){var t=n.src,e=t===void 0?"":t,r=n.alt,i=r===void 0?"":r,a=n.height,s=n.width,u=n.customDefaultComponent,d=function(){return u?u({width:s,height:a}):b.createElement(gk,{width:s,height:a})};return typeof e=="string"?b.createElement(ui,{className:Tu,url:e,height:a,width:s,alt:i,defaultComponent:d}):e&&e.length?e.length===1?b.createElement(ui,{className:Tu,url:e[0],height:a,width:s,alt:i,defaultComponent:d}):e.length===2?b.createElement("div",{className:"sendbird-avatar--inner__two-child"},b.createElement(ui,{className:Tu,url:e[0],height:a,width:s,alt:i,defaultComponent:d}),b.createElement(ui,{className:Tu,url:e[1],height:a,width:s,alt:i,defaultComponent:d})):e.length===3?b.createElement(b.Fragment,null,b.createElement("div",{className:"sendbird-avatar--inner__three-child--upper"},b.createElement(ui,{className:Tu,url:e[0],height:a,width:s,alt:i,defaultComponent:d})),b.createElement("div",{className:"sendbird-avatar--inner__three-child--lower"},b.createElement(ui,{className:Tu,url:e[1],height:a,width:s,alt:i,defaultComponent:d}),b.createElement(ui,{className:Tu,url:e[2],height:a,width:s,alt:i,defaultComponent:d}))):b.createElement("div",{className:"sendbird-avatar--inner__four-child"},e.slice(0,4).map(function(h,p){return b.createElement(ui,{className:Tu,url:h,height:a,width:s,alt:i,key:"".concat(h,"-").concat(p),defaultComponent:d})})):b.createElement(ui,{className:Tu,url:"",height:a,width:s,alt:i,defaultComponent:d})};function aW(n,t){var e=n.className,r=e===void 0?"":e,i=n.src,a=i===void 0?"":i,s=n.alt,u=s===void 0?"":s,d=n.width,h=d===void 0?"56px":d,p=n.height,g=p===void 0?"56px":p,E=n.zIndex,y=E===void 0?0:E,C=n.left,T=C===void 0?"":C,A=n.bottom,O=A===void 0?"":A,N=n.onClick,k=n.customDefaultComponent;return b.createElement("div",{className:en(en([],Array.isArray(r)?r:[r],!0),["sendbird-avatar"],!1).join(" "),role:"button",ref:t,style:{height:g,width:h,zIndex:y,left:T,bottom:O},onClick:N,onKeyDown:N,tabIndex:0},b.createElement(iW,{src:a,width:h,height:g,alt:u,customDefaultComponent:k}))}var Na=b.forwardRef(aW),vk="https://static.sendbird.com/sample/cover/cover_",ME=function(n,t){return n!=null&&n.coverUrl&&!new RegExp("^".concat(vk)).test(n.coverUrl)?n.coverUrl:((n==null?void 0:n.members)||[]).filter(function(e){return e.userId!==t}).map(function(e){var r=e.profileUrl;return r})},sW=function(n){return n!=null&&n.coverUrl?!!new RegExp("^".concat(vk)).test(n.coverUrl):!0};function Ek(n){var t=n.channel,e=n.userId,r=n.theme,i=n.width,a=i===void 0?56:i,s=n.height,u=s===void 0?56:s,d=t==null?void 0:t.isBroadcast,h=F.useMemo(function(){return d?sW(t)?b.createElement("div",{className:"sendbird-chat-header--default-avatar",style:{width:a,height:u,display:"flex",justifyContent:"center",alignItems:"center"}},b.createElement(mn,{type:Ye.BROADCAST,fillColor:sn.CONTENT,width:a*.575,height:u*.575})):b.createElement(Na,{className:"sendbird-chat-header--avatar--broadcast-channel",src:ME(t,e),width:a,height:u,alt:t==null?void 0:t.name}):b.createElement(Na,{className:"sendbird-chat-header--avatar--group-channel",src:ME(t,e),width:"".concat(a,"px"),height:"".concat(u,"px"),alt:t==null?void 0:t.name})},[ME(t,e),r]);return b.createElement(b.Fragment,null,h)}var uW=function(n,t,e){var r,i=e||dd;return!(n!=null&&n.name)&&!(n!=null&&n.members)?i.NO_TITLE:NO(n)?((r=n==null?void 0:n.members)===null||r===void 0?void 0:r.length)===1?i.NO_MEMBERS:n==null?void 0:n.members.filter(function(a){var s=a.userId;return s!==t}).map(function(a){var s=a.nickname;return s||i.NO_NAME}).join(", "):n.name},Ga;(function(n){n.ONBACKGROUND_1="ONBACKGROUND_1",n.ONBACKGROUND_2="ONBACKGROUND_2",n.ONBACKGROUND_3="ONBACKGROUND_3",n.ONBACKGROUND_4="ONBACKGROUND_4",n.ONCONTENT_1="ONCONTENT_1",n.ONCONTENT_2="ONCONTENT_2",n.PRIMARY="PRIMARY",n.ERROR="ERROR"})(Ga||(Ga={}));var Pb=function(n){switch(n){case Ga.ONBACKGROUND_1:return"sendbird-color--onbackground-1";case Ga.ONBACKGROUND_2:return"sendbird-color--onbackground-2";case Ga.ONBACKGROUND_3:return"sendbird-color--onbackground-3";case Ga.ONBACKGROUND_4:return"sendbird-color--onbackground-4";case Ga.ONCONTENT_1:return"sendbird-color--oncontent-1";case Ga.PRIMARY:return"sendbird-color--primary";case Ga.ERROR:return"sendbird-color--error";default:return""}},jh=function(n){var t=n.className,e=t===void 0?"":t,r=n.color,i=r===void 0?Ga.ONBACKGROUND_1:r,a=n.disabled,s=a===void 0?!1:a,u=n.disableUnderline,d=u===void 0?!1:u,h=n.onClick,p=h===void 0?function(){}:h,g=n.children;return b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),[Pb(i),d?"sendbird-textbutton--not-underline":"sendbird-textbutton",s?"sendbird-textbutton--disabled":""],!1).join(" "),role:"button",tabIndex:0,onClick:function(E){return p(E)},onKeyPress:function(E){return p(E)}},g)},oW=function(n){var t,e=n.className,r=n.renderLeft,i=n.renderRight,a=n.renderMiddle,s=!1;try{s=(t=Zi==null?void 0:Zi())===null||t===void 0?void 0:t.isMobile}catch{}return b.createElement("div",{className:Rt("sendbird-ui-header",e),"data-testid":"sendbird-ui-header"},r?b.createElement("div",{className:Rt("sendbird-ui-header__left",s?"sendbird-ui-header--is-mobile":"sendbird-ui-header--is-desktop")},r==null?void 0:r()):null,b.createElement("div",{className:"sendbird-ui-header__middle"},a==null?void 0:a()),i?b.createElement("div",{className:Rt("sendbird-ui-header__right",s?"sendbird-ui-header--is-mobile":"sendbird-ui-header--is-desktop")},i==null?void 0:i()):null)},lW=function(n){var t=n.title,e=n.subtitle,r=n.onClickSubtitle;return b.createElement("div",{className:"sendbird-ui-header__middle"},t&&b.createElement(Ge,{className:"sendbird-ui-header__middle__title",type:Be.H_2,color:Re.ONBACKGROUND_1},t),e&&(r?b.createElement(jh,{className:"sendbird-ui-header__middle__subtitle__container",onClick:r,disableUnderline:!0},b.createElement(Ge,{className:"sendbird-ui-header__middle__subtitle",type:Be.CAPTION_3,color:Re.ONBACKGROUND_2},e)):b.createElement(Ge,{className:"sendbird-ui-header__middle__subtitle",type:Be.BODY_1,color:Re.ONBACKGROUND_2},e)))},dW=function(n){var t=n.className,e=n.onClick,r=n.type,i=n.color,a=n.width,s=a===void 0?"32px":a,u=n.height,d=u===void 0?"32px":u,h=n.renderIcon,p=h===void 0?function(g){return b.createElement(yk,re({},g))}:h;return b.createElement(Fu,{className:t,width:s,height:d,onClick:e},p({type:r,color:i}))},yk=function(n){var t=n.className,e=n.type,r=n.color,i=n.width,a=i===void 0?"22px":i,s=n.height,u=s===void 0?"22px":s,d=n.onClick,h=d===void 0?ur:d;return b.createElement(mn,{className:t,type:e,fillColor:r,width:a,height:u,onClick:function(p){return h==null?void 0:h(p)}})},Nu=Object.assign(oW,{Title:lW,IconButton:dW,Icon:yk}),cW=function(n){var t=n.className,e=n.currentChannel,r=n.showSearchIcon,i=n.onBackClick,a=n.onSearchClick,s=n.onChatHeaderActionClick,u=n.renderLeft,d=n.renderMiddle,h=n.renderRight,p=Mt().config,g=p.userId,E=p.theme,y=Zi().isMobile,C=Bt().stringSet,T=(e==null?void 0:e.myMutedState)==="muted",A=uW(e,g,C);return b.createElement(Nu,{className:Rt("sendbird-chat-header",t),renderLeft:u??function(){return b.createElement(b.Fragment,null,y&&b.createElement(Nu.Icon,{className:"sendbird-chat-header__icon_back",onClick:i,type:Ye.ARROW_LEFT,color:sn.PRIMARY,width:"24px",height:"24px"}),b.createElement(Ek,{theme:E,channel:e,userId:g,height:32,width:32}))},renderMiddle:d??function(){return b.createElement(Nu.Title,{title:A})},renderRight:h??function(){return b.createElement(b.Fragment,null,T&&b.createElement(Nu.Icon,{className:"sendbird-chat-header__right__mute",type:Ye.NOTIFICATIONS_OFF_FILLED,color:sn.ON_BACKGROUND_2,width:"24px",height:"24px"}),r&&!(e!=null&&e.isEphemeral)&&b.createElement(Nu.IconButton,{className:"sendbird-chat-header__right__search",onClick:a,type:Ye.SEARCH,color:sn.PRIMARY,renderIcon:function(O){return b.createElement(Nu.Icon,re({},O,{width:"24px",height:"24px"}))}}),b.createElement(Nu.IconButton,{className:"sendbird-chat-header__right__info",onClick:s,type:Ye.INFO,color:sn.PRIMARY,renderIcon:function(O){return b.createElement(Nu.Icon,re({},O,{width:"24px",height:"24px"}))}}))}})},fW=function(n){var t=n.className,e=Vo();return b.createElement(cW,re({},e,{className:t,currentChannel:e.currentGroupChannel}))},Em=function(n){return n?n.isFrozen&&n.myRole!=="operator":!1},wh=function(n){return n?n.myMutedState==="muted":!1},Vw=function(n,t){var e,r,i,a;return t&&Array.isArray((r=(e=n==null?void 0:n.lastMessage)===null||e===void 0?void 0:e.extendedMessagePayload)===null||r===void 0?void 0:r.suggested_replies)&&!!(!((a=(i=n==null?void 0:n.lastMessage)===null||i===void 0?void 0:i.extendedMessagePayload)===null||a===void 0)&&a.disable_chat_input)},bk=function(n){return n<=Vz},jw=function(n,t){return t&&n.some(function(e){var r;return!!e.messageForm&&!e.messageForm.isSubmitted&&!!(!((r=e.extendedMessagePayload)===null||r===void 0)&&r.disable_chat_input)&&bk(e.messageForm.version)})};function qw(n){if(n){var t=n.querySelectorAll("[data-sb-mention='true']"),e=Array.from(t);return e}return[]}function Ck(n,t){var e=n.ref,r=t.logger,i=e.current,a=F.useState([]),s=a[0],u=a[1];return F.useLayoutEffect(function(){if(i){var d=qw(i);u(d)}},[i]),F.useEffect(function(){var d={childList:!0,subtree:!0},h=function(g){var E=g.length>0;E&&u(qw(i))},p=new MutationObserver(h);return i&&p.observe(i,d),function(){try{p.disconnect()}catch{r.error("useDirtyGetMentions: observer disconnect failed",{observer:p})}}},[i]),s}var hW=function(n){var t=n.children,e=t===void 0?void 0:t,r=n.className,i=r===void 0?"":r,a=n.separatorColor,s=a===void 0?Ga.ONBACKGROUND_4:a;return b.createElement("div",{className:en(en([],Array.isArray(i)?i:[i],!0),["sendbird-separator"],!1).join(" ")},b.createElement("div",{className:["sendbird-separator__left","".concat(Pb(s),"--background-color")].join(" ")}),b.createElement("div",{className:"sendbird-separator__text"},e||b.createElement(Ge,{type:Be.CAPTION_2,color:Re.ONBACKGROUND_2},"Date Separator")),b.createElement("div",{className:["sendbird-separator__right","".concat(Pb(s),"--background-color")].join(" ")}))},Rs={Enter:"Enter",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",Backspace:"Backspace"},Fb={ElementNode:1,TextNode:3},OE={Span:"SPAN",Br:"BR",Div:"DIV"};/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:Ik,setPrototypeOf:zw,isFrozen:pW,getPrototypeOf:_W,getOwnPropertyDescriptor:mW}=Object;let{freeze:pa,seal:hs,create:Tk}=Object,{apply:Hb,construct:Bb}=typeof Reflect<"u"&&Reflect;pa||(pa=function(t){return t});hs||(hs=function(t){return t});Hb||(Hb=function(t,e,r){return t.apply(e,r)});Bb||(Bb=function(t,e){return new t(...e)});const d_=_a(Array.prototype.forEach),gW=_a(Array.prototype.lastIndexOf),Kw=_a(Array.prototype.pop),xf=_a(Array.prototype.push),vW=_a(Array.prototype.splice),U_=_a(String.prototype.toLowerCase),kE=_a(String.prototype.toString),Ww=_a(String.prototype.match),Uf=_a(String.prototype.replace),EW=_a(String.prototype.indexOf),yW=_a(String.prototype.trim),Cs=_a(Object.prototype.hasOwnProperty),ia=_a(RegExp.prototype.test),Pf=bW(TypeError);function _a(n){return function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return Hb(n,t,r)}}function bW(n){return function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Bb(n,e)}}function tr(n,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:U_;zw&&zw(n,null);let r=t.length;for(;r--;){let i=t[r];if(typeof i=="string"){const a=e(i);a!==i&&(pW(t)||(t[r]=a),i=a)}n[i]=!0}return n}function CW(n){for(let t=0;t<n.length;t++)Cs(n,t)||(n[t]=null);return n}function Al(n){const t=Tk(null);for(const[e,r]of Ik(n))Cs(n,e)&&(Array.isArray(r)?t[e]=CW(r):r&&typeof r=="object"&&r.constructor===Object?t[e]=Al(r):t[e]=r);return t}function Ff(n,t){for(;n!==null;){const r=mW(n,t);if(r){if(r.get)return _a(r.get);if(typeof r.value=="function")return _a(r.value)}n=_W(n)}function e(){return null}return e}const $w=pa(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),DE=pa(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),LE=pa(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),IW=pa(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),xE=pa(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),TW=pa(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Yw=pa(["#text"]),Qw=pa(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),UE=pa(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Zw=pa(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),c_=pa(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),SW=hs(/\{\{[\w\W]*|[\w\W]*\}\}/gm),NW=hs(/<%[\w\W]*|[\w\W]*%>/gm),AW=hs(/\$\{[\w\W]*/gm),wW=hs(/^data-[\-\w.\u00B7-\uFFFF]+$/),RW=hs(/^aria-[\-\w]+$/),Sk=hs(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),MW=hs(/^(?:\w+script|data):/i),OW=hs(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Nk=hs(/^html$/i),kW=hs(/^[a-z][.\w]*(-[.\w]+)+$/i);var Xw=Object.freeze({__proto__:null,ARIA_ATTR:RW,ATTR_WHITESPACE:OW,CUSTOM_ELEMENT:kW,DATA_ATTR:wW,DOCTYPE_NAME:Nk,ERB_EXPR:NW,IS_ALLOWED_URI:Sk,IS_SCRIPT_OR_DATA:MW,MUSTACHE_EXPR:SW,TMPLIT_EXPR:AW});const Hf={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},DW=function(){return typeof window>"u"?null:window},LW=function(t,e){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";e&&e.hasAttribute(i)&&(r=e.getAttribute(i));const a="dompurify"+(r?"#"+r:"");try{return t.createPolicy(a,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},Jw=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ak(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DW();const t=Je=>Ak(Je);if(t.version="3.2.4",t.removed=[],!n||!n.document||n.document.nodeType!==Hf.document||!n.Element)return t.isSupported=!1,t;let{document:e}=n;const r=e,i=r.currentScript,{DocumentFragment:a,HTMLTemplateElement:s,Node:u,Element:d,NodeFilter:h,NamedNodeMap:p=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:g,DOMParser:E,trustedTypes:y}=n,C=d.prototype,T=Ff(C,"cloneNode"),A=Ff(C,"remove"),O=Ff(C,"nextSibling"),N=Ff(C,"childNodes"),k=Ff(C,"parentNode");if(typeof s=="function"){const Je=e.createElement("template");Je.content&&Je.content.ownerDocument&&(e=Je.content.ownerDocument)}let D,P="";const{implementation:U,createNodeIterator:L,createDocumentFragment:B,getElementsByTagName:q}=e,{importNode:z}=r;let Y=Jw();t.isSupported=typeof Ik=="function"&&typeof k=="function"&&U&&U.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Q,ERB_EXPR:$,TMPLIT_EXPR:Z,DATA_ATTR:ne,ARIA_ATTR:ue,IS_SCRIPT_OR_DATA:pe,ATTR_WHITESPACE:he,CUSTOM_ELEMENT:le}=Xw;let{IS_ALLOWED_URI:we}=Xw,ve=null;const Ue=tr({},[...$w,...DE,...LE,...xE,...Yw]);let be=null;const Qe=tr({},[...Qw,...UE,...Zw,...c_]);let Ne=Object.seal(Tk(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),$e=null,gn=null,En=!0,Yn=!0,Gn=!1,Tn=!0,kn=!1,Vn=!0,Hn=!1,Jn=!1,jn=!1,On=!1,Ln=!1,An=!1,wn=!0,We=!1;const ln="user-content-";let Pe=!0,Ke=!1,yn={},tn=null;const st=tr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Cn=null;const Ve=tr({},["audio","video","img","source","image","track"]);let Ut=null;const mt=tr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ut="http://www.w3.org/1998/Math/MathML",In="http://www.w3.org/2000/svg",Qn="http://www.w3.org/1999/xhtml";let Ct=Qn,Et=!1,ct=null;const Qt=tr({},[ut,In,Qn],kE);let Ot=tr({},["mi","mo","mn","ms","mtext"]),ft=tr({},["annotation-xml"]);const rt=tr({},["title","style","font","a","script"]);let xn=null;const Oe=["application/xhtml+xml","text/html"],Ee="text/html";let nn=null,Sn=null;const Pn=e.createElement("form"),lt=function(oe){return oe instanceof RegExp||oe instanceof Function},qn=function(){let oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Sn&&Sn===oe)){if((!oe||typeof oe!="object")&&(oe={}),oe=Al(oe),xn=Oe.indexOf(oe.PARSER_MEDIA_TYPE)===-1?Ee:oe.PARSER_MEDIA_TYPE,nn=xn==="application/xhtml+xml"?kE:U_,ve=Cs(oe,"ALLOWED_TAGS")?tr({},oe.ALLOWED_TAGS,nn):Ue,be=Cs(oe,"ALLOWED_ATTR")?tr({},oe.ALLOWED_ATTR,nn):Qe,ct=Cs(oe,"ALLOWED_NAMESPACES")?tr({},oe.ALLOWED_NAMESPACES,kE):Qt,Ut=Cs(oe,"ADD_URI_SAFE_ATTR")?tr(Al(mt),oe.ADD_URI_SAFE_ATTR,nn):mt,Cn=Cs(oe,"ADD_DATA_URI_TAGS")?tr(Al(Ve),oe.ADD_DATA_URI_TAGS,nn):Ve,tn=Cs(oe,"FORBID_CONTENTS")?tr({},oe.FORBID_CONTENTS,nn):st,$e=Cs(oe,"FORBID_TAGS")?tr({},oe.FORBID_TAGS,nn):{},gn=Cs(oe,"FORBID_ATTR")?tr({},oe.FORBID_ATTR,nn):{},yn=Cs(oe,"USE_PROFILES")?oe.USE_PROFILES:!1,En=oe.ALLOW_ARIA_ATTR!==!1,Yn=oe.ALLOW_DATA_ATTR!==!1,Gn=oe.ALLOW_UNKNOWN_PROTOCOLS||!1,Tn=oe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,kn=oe.SAFE_FOR_TEMPLATES||!1,Vn=oe.SAFE_FOR_XML!==!1,Hn=oe.WHOLE_DOCUMENT||!1,On=oe.RETURN_DOM||!1,Ln=oe.RETURN_DOM_FRAGMENT||!1,An=oe.RETURN_TRUSTED_TYPE||!1,jn=oe.FORCE_BODY||!1,wn=oe.SANITIZE_DOM!==!1,We=oe.SANITIZE_NAMED_PROPS||!1,Pe=oe.KEEP_CONTENT!==!1,Ke=oe.IN_PLACE||!1,we=oe.ALLOWED_URI_REGEXP||Sk,Ct=oe.NAMESPACE||Qn,Ot=oe.MATHML_TEXT_INTEGRATION_POINTS||Ot,ft=oe.HTML_INTEGRATION_POINTS||ft,Ne=oe.CUSTOM_ELEMENT_HANDLING||{},oe.CUSTOM_ELEMENT_HANDLING&&lt(oe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ne.tagNameCheck=oe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),oe.CUSTOM_ELEMENT_HANDLING&&lt(oe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ne.attributeNameCheck=oe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),oe.CUSTOM_ELEMENT_HANDLING&&typeof oe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ne.allowCustomizedBuiltInElements=oe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),kn&&(Yn=!1),Ln&&(On=!0),yn&&(ve=tr({},Yw),be=[],yn.html===!0&&(tr(ve,$w),tr(be,Qw)),yn.svg===!0&&(tr(ve,DE),tr(be,UE),tr(be,c_)),yn.svgFilters===!0&&(tr(ve,LE),tr(be,UE),tr(be,c_)),yn.mathMl===!0&&(tr(ve,xE),tr(be,Zw),tr(be,c_))),oe.ADD_TAGS&&(ve===Ue&&(ve=Al(ve)),tr(ve,oe.ADD_TAGS,nn)),oe.ADD_ATTR&&(be===Qe&&(be=Al(be)),tr(be,oe.ADD_ATTR,nn)),oe.ADD_URI_SAFE_ATTR&&tr(Ut,oe.ADD_URI_SAFE_ATTR,nn),oe.FORBID_CONTENTS&&(tn===st&&(tn=Al(tn)),tr(tn,oe.FORBID_CONTENTS,nn)),Pe&&(ve["#text"]=!0),Hn&&tr(ve,["html","head","body"]),ve.table&&(tr(ve,["tbody"]),delete $e.tbody),oe.TRUSTED_TYPES_POLICY){if(typeof oe.TRUSTED_TYPES_POLICY.createHTML!="function")throw Pf('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof oe.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Pf('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');D=oe.TRUSTED_TYPES_POLICY,P=D.createHTML("")}else D===void 0&&(D=LW(y,i)),D!==null&&typeof P=="string"&&(P=D.createHTML(""));pa&&pa(oe),Sn=oe}},Fn=tr({},[...DE,...LE,...IW]),At=tr({},[...xE,...TW]),Pt=function(oe){let ke=k(oe);(!ke||!ke.tagName)&&(ke={namespaceURI:Ct,tagName:"template"});const fn=U_(oe.tagName),bt=U_(ke.tagName);return ct[oe.namespaceURI]?oe.namespaceURI===In?ke.namespaceURI===Qn?fn==="svg":ke.namespaceURI===ut?fn==="svg"&&(bt==="annotation-xml"||Ot[bt]):!!Fn[fn]:oe.namespaceURI===ut?ke.namespaceURI===Qn?fn==="math":ke.namespaceURI===In?fn==="math"&&ft[bt]:!!At[fn]:oe.namespaceURI===Qn?ke.namespaceURI===In&&!ft[bt]||ke.namespaceURI===ut&&!Ot[bt]?!1:!At[fn]&&(rt[fn]||!Fn[fn]):!!(xn==="application/xhtml+xml"&&ct[oe.namespaceURI]):!1},zn=function(oe){xf(t.removed,{element:oe});try{k(oe).removeChild(oe)}catch{A(oe)}},qt=function(oe,ke){try{xf(t.removed,{attribute:ke.getAttributeNode(oe),from:ke})}catch{xf(t.removed,{attribute:null,from:ke})}if(ke.removeAttribute(oe),oe==="is")if(On||Ln)try{zn(ke)}catch{}else try{ke.setAttribute(oe,"")}catch{}},cr=function(oe){let ke=null,fn=null;if(jn)oe="<remove></remove>"+oe;else{const nr=Ww(oe,/^[\r\n\t ]+/);fn=nr&&nr[0]}xn==="application/xhtml+xml"&&Ct===Qn&&(oe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+oe+"</body></html>");const bt=D?D.createHTML(oe):oe;if(Ct===Qn)try{ke=new E().parseFromString(bt,xn)}catch{}if(!ke||!ke.documentElement){ke=U.createDocument(Ct,"template",null);try{ke.documentElement.innerHTML=Et?P:bt}catch{}}const dt=ke.body||ke.documentElement;return oe&&fn&&dt.insertBefore(e.createTextNode(fn),dt.childNodes[0]||null),Ct===Qn?q.call(ke,Hn?"html":"body")[0]:Hn?ke.documentElement:dt},Fe=function(oe){return L.call(oe.ownerDocument||oe,oe,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},un=function(oe){return oe instanceof g&&(typeof oe.nodeName!="string"||typeof oe.textContent!="string"||typeof oe.removeChild!="function"||!(oe.attributes instanceof p)||typeof oe.removeAttribute!="function"||typeof oe.setAttribute!="function"||typeof oe.namespaceURI!="string"||typeof oe.insertBefore!="function"||typeof oe.hasChildNodes!="function")},Ae=function(oe){return typeof u=="function"&&oe instanceof u};function Dn(Je,oe,ke){d_(Je,fn=>{fn.call(t,oe,ke,Sn)})}const pn=function(oe){let ke=null;if(Dn(Y.beforeSanitizeElements,oe,null),un(oe))return zn(oe),!0;const fn=nn(oe.nodeName);if(Dn(Y.uponSanitizeElement,oe,{tagName:fn,allowedTags:ve}),oe.hasChildNodes()&&!Ae(oe.firstElementChild)&&ia(/<[/\w]/g,oe.innerHTML)&&ia(/<[/\w]/g,oe.textContent)||oe.nodeType===Hf.progressingInstruction||Vn&&oe.nodeType===Hf.comment&&ia(/<[/\w]/g,oe.data))return zn(oe),!0;if(!ve[fn]||$e[fn]){if(!$e[fn]&&yt(fn)&&(Ne.tagNameCheck instanceof RegExp&&ia(Ne.tagNameCheck,fn)||Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(fn)))return!1;if(Pe&&!tn[fn]){const bt=k(oe)||oe.parentNode,dt=N(oe)||oe.childNodes;if(dt&&bt){const nr=dt.length;for(let rr=nr-1;rr>=0;--rr){const Vr=T(dt[rr],!0);Vr.__removalCount=(oe.__removalCount||0)+1,bt.insertBefore(Vr,O(oe))}}}return zn(oe),!0}return oe instanceof d&&!Pt(oe)||(fn==="noscript"||fn==="noembed"||fn==="noframes")&&ia(/<\/no(script|embed|frames)/i,oe.innerHTML)?(zn(oe),!0):(kn&&oe.nodeType===Hf.text&&(ke=oe.textContent,d_([Q,$,Z],bt=>{ke=Uf(ke,bt," ")}),oe.textContent!==ke&&(xf(t.removed,{element:oe.cloneNode()}),oe.textContent=ke)),Dn(Y.afterSanitizeElements,oe,null),!1)},it=function(oe,ke,fn){if(wn&&(ke==="id"||ke==="name")&&(fn in e||fn in Pn))return!1;if(!(Yn&&!gn[ke]&&ia(ne,ke))){if(!(En&&ia(ue,ke))){if(!be[ke]||gn[ke]){if(!(yt(oe)&&(Ne.tagNameCheck instanceof RegExp&&ia(Ne.tagNameCheck,oe)||Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(oe))&&(Ne.attributeNameCheck instanceof RegExp&&ia(Ne.attributeNameCheck,ke)||Ne.attributeNameCheck instanceof Function&&Ne.attributeNameCheck(ke))||ke==="is"&&Ne.allowCustomizedBuiltInElements&&(Ne.tagNameCheck instanceof RegExp&&ia(Ne.tagNameCheck,fn)||Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(fn))))return!1}else if(!Ut[ke]){if(!ia(we,Uf(fn,he,""))){if(!((ke==="src"||ke==="xlink:href"||ke==="href")&&oe!=="script"&&EW(fn,"data:")===0&&Cn[oe])){if(!(Gn&&!ia(pe,Uf(fn,he,"")))){if(fn)return!1}}}}}}return!0},yt=function(oe){return oe!=="annotation-xml"&&Ww(oe,le)},zt=function(oe){Dn(Y.beforeSanitizeAttributes,oe,null);const{attributes:ke}=oe;if(!ke||un(oe))return;const fn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:be,forceKeepAttr:void 0};let bt=ke.length;for(;bt--;){const dt=ke[bt],{name:nr,namespaceURI:rr,value:Vr}=dt,Ir=nn(nr);let bn=nr==="value"?Vr:yW(Vr);if(fn.attrName=Ir,fn.attrValue=bn,fn.keepAttr=!0,fn.forceKeepAttr=void 0,Dn(Y.uponSanitizeAttribute,oe,fn),bn=fn.attrValue,We&&(Ir==="id"||Ir==="name")&&(qt(nr,oe),bn=ln+bn),Vn&&ia(/((--!?|])>)|<\/(style|title)/i,bn)){qt(nr,oe);continue}if(fn.forceKeepAttr||(qt(nr,oe),!fn.keepAttr))continue;if(!Tn&&ia(/\/>/i,bn)){qt(nr,oe);continue}kn&&d_([Q,$,Z],Tt=>{bn=Uf(bn,Tt," ")});const ot=nn(oe.nodeName);if(it(ot,Ir,bn)){if(D&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!rr)switch(y.getAttributeType(ot,Ir)){case"TrustedHTML":{bn=D.createHTML(bn);break}case"TrustedScriptURL":{bn=D.createScriptURL(bn);break}}try{rr?oe.setAttributeNS(rr,nr,bn):oe.setAttribute(nr,bn),un(oe)?zn(oe):Kw(t.removed)}catch{}}}Dn(Y.afterSanitizeAttributes,oe,null)},Ht=function Je(oe){let ke=null;const fn=Fe(oe);for(Dn(Y.beforeSanitizeShadowDOM,oe,null);ke=fn.nextNode();)Dn(Y.uponSanitizeShadowNode,ke,null),pn(ke),zt(ke),ke.content instanceof a&&Je(ke.content);Dn(Y.afterSanitizeShadowDOM,oe,null)};return t.sanitize=function(Je){let oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ke=null,fn=null,bt=null,dt=null;if(Et=!Je,Et&&(Je="<!-->"),typeof Je!="string"&&!Ae(Je))if(typeof Je.toString=="function"){if(Je=Je.toString(),typeof Je!="string")throw Pf("dirty is not a string, aborting")}else throw Pf("toString is not a function");if(!t.isSupported)return Je;if(Jn||qn(oe),t.removed=[],typeof Je=="string"&&(Ke=!1),Ke){if(Je.nodeName){const Vr=nn(Je.nodeName);if(!ve[Vr]||$e[Vr])throw Pf("root node is forbidden and cannot be sanitized in-place")}}else if(Je instanceof u)ke=cr("<!---->"),fn=ke.ownerDocument.importNode(Je,!0),fn.nodeType===Hf.element&&fn.nodeName==="BODY"||fn.nodeName==="HTML"?ke=fn:ke.appendChild(fn);else{if(!On&&!kn&&!Hn&&Je.indexOf("<")===-1)return D&&An?D.createHTML(Je):Je;if(ke=cr(Je),!ke)return On?null:An?P:""}ke&&jn&&zn(ke.firstChild);const nr=Fe(Ke?Je:ke);for(;bt=nr.nextNode();)pn(bt),zt(bt),bt.content instanceof a&&Ht(bt.content);if(Ke)return Je;if(On){if(Ln)for(dt=B.call(ke.ownerDocument);ke.firstChild;)dt.appendChild(ke.firstChild);else dt=ke;return(be.shadowroot||be.shadowrootmode)&&(dt=z.call(r,dt,!0)),dt}let rr=Hn?ke.outerHTML:ke.innerHTML;return Hn&&ve["!doctype"]&&ke.ownerDocument&&ke.ownerDocument.doctype&&ke.ownerDocument.doctype.name&&ia(Nk,ke.ownerDocument.doctype.name)&&(rr="<!DOCTYPE "+ke.ownerDocument.doctype.name+`>
`+rr),kn&&d_([Q,$,Z],Vr=>{rr=Uf(rr,Vr," ")}),D&&An?D.createHTML(rr):rr},t.setConfig=function(){let Je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};qn(Je),Jn=!0},t.clearConfig=function(){Sn=null,Jn=!1},t.isValidAttribute=function(Je,oe,ke){Sn||qn({});const fn=nn(Je),bt=nn(oe);return it(fn,bt,ke)},t.addHook=function(Je,oe){typeof oe=="function"&&xf(Y[Je],oe)},t.removeHook=function(Je,oe){if(oe!==void 0){const ke=gW(Y[Je],oe);return ke===-1?void 0:vW(Y[Je],ke,1)[0]}return Kw(Y[Je])},t.removeHooks=function(Je){Y[Je]=[]},t.removeAllHooks=function(){Y=Jw()},t}var wk=Ak(),Rk="sendbird-mention-user-label",KC="sendbird-text-message-item-body",Mk="sendbird-og-message-item-body__text-bubble";function Gb(n){var t=n.userId,e=n.nickname,r='<span data-userid="'.concat(t,'" data-sb-mention="true" class="').concat(Rk,'">').concat(e,"</span>"),i=wk(window),a=i.sanitize(r),s=a.split(" "),u=s[0],d=s.slice(1),h=en([u,'contenteditable="false"'],d,!0).join(" ");return h}var Rh=function(n){return n===void 0&&(n=""),n?n.replace(/[<>]/g,function(t){return t==="<"?"&#60;":"&#62;"}):""},P_=function(n){return n?Array.from(n):[]};function xW(n){var t;return n&&((t=n.isGroupChannel)===null||t===void 0?void 0:t.call(n))&&!n.isBroadcast&&!n.isSuper}function PE(n){return n.nodeType===Fb.ElementNode}function eR(n){var t="",e="";return n.forEach(function(r){if(PE(r)&&r.nodeName===OE.Span){var i=r.innerText,a=r.dataset,s=a===void 0?{}:a,u=s.userid,d=u===void 0?"":u;t+=i,e+="".concat(mh,"{").concat(d,"}")}else if(PE(r)&&r.nodeName===OE.Br)t+=`
`,e+=`
`;else if(PE(r)&&r.nodeName===OE.Div){var h=r.textContent,p=h===void 0?"":h;t+=`
`.concat(p),e+=`
`.concat(p)}else{var g=r.textContent,p=g===void 0?"":g;t+=p,e+=p}}),{messageText:t,mentionTemplate:e}}function UW(n){var t=n.map(function(e){var r=e.text,i=e.userId;return i?Gb({userId:i,nickname:r}):Rh(r)}).join(" ").concat(" ");document.execCommand("insertHTML",!1,t)}var PW="sendbird-word",Ok="sendbird-word__mention",kk="sendbird-mention-user-label",Dk=".".concat(Ok,", .").concat(kk);function nR(n,t){var e=en([n],Array.from(n.querySelectorAll(t)),!0).find(function(r){return r.matches(t)});return e}function FW(n){var t=nR(n,".".concat(Mk));if(t)return P_(t.childNodes);var e=nR(n,".".concat(KC));return P_(e?e.childNodes:n.childNodes)}function HW(n){return!!(n!=null&&n.querySelector(Dk))}var Lk=function(n){var t="";return n.forEach(function(e){var r=e.querySelectorAll(".".concat(PW));r.length>0&&(t+=Lk(Array.from(r))+" "),t+=e.innerText+" "}),t};function BW(n){var t=n==null?void 0:n.reduce(function(e,r){var i,a,s,u=r==null?void 0:r.innerText;if(r instanceof Text&&(s=!1,u=(i=r.textContent)!==null&&i!==void 0?i:""),r instanceof HTMLElement&&(s=r.classList.contains(Ok)||r.classList.contains(kk)?r:r.querySelector(Dk)),s){var d=r==null?void 0:r.innerText,h=(a=s.dataset)===null||a===void 0?void 0:a.userid;return en(en([],e,!0),[{text:d,userId:h}],!1)}return en(en([],e,!0),[{text:u}],!1)},[]);return t}function GW(n,t){var e={},r=t.members;return n.forEach(function(i){if(i.userId){var a=r.find(function(s){return s.userId===i.userId});a&&(e[i.userId]=a)}}),Object.values(e)}function tR(n){var t=window.getSelection();if(t&&t.rangeCount>0){var e=t.getRangeAt(t.rangeCount-1);e.deleteContents();var r=document.createTextNode(n+"​");e.insertNode(r),e.setStart(r,r.length),e.collapse(!0),t.removeAllRanges(),t.addRange(e)}}function VW(n){var t=document.createElement("div");return t.innerHTML=n,t}function jW(n){var t=n.ref,e=n.setIsInput,r=n.channel,i=n.setMentionedUsers;return F.useCallback(function(a){a.preventDefault();var s=a.clipboardData.getData("text/html"),u=a.clipboardData.getData("text")||qW(a);if(!s){tR(Rh(u)),e(!0);return}var d=wk(window),h=d.sanitize(s),p=VW(h);if(!HW(p)){var g=Lk(Array.from(p.children));tR(Rh(g)),p.remove(),e(!0);return}var E=FW(p),y=BW(E),C=r.isGroupChannel()?GW(y,r):[];i(C),UW(y),p.remove(),e(!0)},[t,e,r,i])}function qW(n){var t=n.clipboardData.getData("text/uri-list");return t.length===0?"":t.split(`
`).reduce(function(e,r){var i=r.trim();return i!==""&&!i.startsWith("#")&&(e+=i+`
`),e},"")}var qh="@",Qr={string:"string",mention:"mention",url:"url",undetermined:"undetermined",markdown:"markdown"},zW=/\[(.*?)\]\((.*?)\)|\*\*(.*?)\*\*/g;function KW(n,t){var e=t||qh;return RegExp("(".concat(n.map(function(r){var i=r.userId.replace(/([.*+?^${}()|[\]\\])/g,"\\$1");return"".concat(e,"\\{").concat(i,"\\}")}).join("|"),")"),"g")}function WW(n){var t=n.tokens,e=n.mentionedUsers,r=e===void 0?[]:e,i=n.templatePrefix,a=i===void 0?qh:i;if(!(r!=null&&r.length))return t;var s=KW(r,a),u=t.map(function(d){if(d.type!==Qr.undetermined)return d;var h=d.value,p=h.split(s),g=p.map(function(E){if(E.match(s)){var y=r.find(function(T){return"@{".concat(T==null?void 0:T.userId,"}")===E}),C=(y==null?void 0:y.nickname)||"(No name)";return{value:C,type:Qr.mention,userId:y==null?void 0:y.userId}}else return{value:E,type:Qr.undetermined}});return g}).flat();return u}function $W(n){var t=/(?:https?:\/\/|www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.(xn--)?[a-z]{2,20}\b([-a-zA-Z0-9@:%_+[\],.~#?&/=]*[-a-zA-Z0-9@:%_+~#?&/=])*/g,e=n.map(function(r){if(r.type!==Qr.undetermined)return r;var i=r.value,a=i===void 0?"":i,s=Array.from(a.matchAll(t)),u=s.map(function(p){var g,E=p[0],y=(g=p.index)!==null&&g!==void 0?g:0,C=y+E.length;return{text:E,start:y,end:C}}),d=[{value:a,type:Qr.string}],h=0;return u.forEach(function(p){var g=p.text,E=p.start,y=p.end,C=d.pop().value,T=C.slice(0,E-h),A=g,O=C.slice(y-h);T.length>0&&d.push({value:T,type:Qr.string}),d.push({value:A,type:Qr.url}),O.length>0&&d.push({value:O,type:Qr.string}),h=y}),d}).flat();return e}function WC(n){var t=n,e=[];return t.forEach(function(r){if(r.type===Qr.mention||r.type===Qr.markdown){e.push(r);return}var i=r.value,a=Array.from(i.matchAll(zW)),s=a.map(function(p){var g,E=p[0],y=(g=p.index)!==null&&g!==void 0?g:0,C=y+E.length;return{text:E,start:y,end:C,groups:p.filter(function(T){return typeof T=="string"})}}),u=i,d=0;if(s.forEach(function(p){var g=p.text,E=p.start,y=p.end,C=p.groups,T={type:Qr.undetermined,value:u.slice(0,E-d)};e.push(T);var A;g.startsWith("[")?A="url":g.startsWith("**")&&(A="bold");var O={type:Qr.markdown,markdownType:A,value:g,groups:C};e.push(O),u=i.slice(y),d=y}),u){var h={type:Qr.undetermined,value:u};e.push(h)}}),e}function xk(n){var t=n.reduce(function(e,r){var i=e[e.length-1];return(i==null?void 0:i.type)===Qr.string&&r.type===Qr.string?(i.value="".concat(i.value).concat(r.value),e):en(en([],e,!0),[r],!1)},[]);return t}function Mh(n){var t=n.messageText,e=n.mentionedUsers,r=e===void 0?[]:e,i=n.templatePrefix,a=i===void 0?qh:i,s=n.includeMarkdown,u=s===void 0?!1:s,d=[{type:Qr.undetermined,value:t}],h=WW({tokens:d,mentionedUsers:r,templatePrefix:a}),p=$W(u?WC(h):h),g=xk(p);return g}function YW(n){var t=[{type:Qr.undetermined,value:n}],e=WC(t);return Uk(e)}function Uk(n){var t=n.map(function(e){return e.type===Qr.markdown?Uk(Vb({messageText:e.groups[1]})):e.value});return t.join("")}function Vb(n){var t=n.messageText,e=[{type:Qr.undetermined,value:t}],r=xk(WC(e));return r}function QW(n){var t=" ",e=n.split(`
`),r=e.map(function(a){var s,u,d=((s=a.match(/^\s*/))===null||s===void 0?void 0:s[0])||"",h=((u=a.match(/\s*$/))===null||u===void 0?void 0:u[0])||"",p=d.replace(/ /g,t),g=h.replace(/ /g,t);return p+a.trim()+g}),i=r.join(`
`);return i}var ym;(function(n){n.BASE="base",n.GROUP="group",n.OPEN="open"})(ym||(ym={}));var ZW=function(n){var t=n.channel,e=n.config,r=Mi(t==null?void 0:t.channelType).with(ym.GROUP,function(){var i;return(i=e==null?void 0:e.groupChannel)===null||i===void 0?void 0:i.enableDocument}).with(ym.OPEN,function(){var i;return(i=e==null?void 0:e.openChannel)===null||i===void 0?void 0:i.enableDocument}).otherwise(function(){return!0});return r},XW="sendbird-message-input-text-field",aa=function(){return null},FE=function(n){n&&n.current&&(n.current.innerHTML="")},rR={targetString:"",startNodeIndex:null,startOffsetIndex:null,endNodeIndex:null,endOffsetIndex:null},Pk=b.forwardRef(function(n,t){var e,r,i,a,s,u=n.channel,d=n.className,h=d===void 0?"":d,p=n.messageFieldId,g=p===void 0?"":p,E=n.isEdit,y=E===void 0?!1:E,C=n.isMobile,T=C===void 0?!1:C,A=n.isMentionEnabled,O=A===void 0?!1:A,N=n.isVoiceMessageEnabled,k=N===void 0?!0:N,D=n.isSelectingMultipleFilesEnabled,P=D===void 0?!1:D,U=n.disabled,L=U===void 0?!1:U,B=n.message,q=B===void 0?null:B,z=n.placeholder,Y=z===void 0?"":z,Q=n.maxLength,$=Q===void 0?5e3:Q,Z=n.onFileUpload,ne=Z===void 0?aa:Z,ue=n.onSendMessage,pe=ue===void 0?aa:ue,he=n.onUpdateMessage,le=he===void 0?aa:he,we=n.onCancelEdit,ve=we===void 0?aa:we,Ue=n.onStartTyping,be=Ue===void 0?aa:Ue,Qe=n.channelUrl,Ne=Qe===void 0?"":Qe,$e=n.mentionSelectedUser,gn=$e===void 0?null:$e,En=n.onUserMentioned,Yn=En===void 0?aa:En,Gn=n.onMentionStringChange,Tn=Gn===void 0?aa:Gn,kn=n.onMentionedUserIdsUpdated,Vn=kn===void 0?aa:kn,Hn=n.onVoiceMessageIconClick,Jn=Hn===void 0?aa:Hn,jn=n.onKeyUp,On=jn===void 0?aa:jn,Ln=n.onKeyDown,An=Ln===void 0?aa:Ln,wn=n.renderFileUploadIcon,We=wn===void 0?aa:wn,ln=n.renderVoiceMessageIcon,Pe=ln===void 0?aa:ln,Ke=n.renderSendMessageIcon,yn=Ke===void 0?aa:Ke,tn=n.setMentionedUsers,st=tn===void 0?aa:tn,Cn=n.acceptableMimeTypes,Ve=t&&"current"in t?t:F.useRef(null),Ut=F.useRef(null),mt=g||XW,ut=Bt().stringSet,In=Mt(),Qn=In.config,Ct=In.eventHandlers,Et=ZW({channel:u,config:Qn}),ct=F.useRef(),Qt=F.useState(!1),Ot=Qt[0],ft=Qt[1],rt=F.useState([]),xn=rt[0],Oe=rt[1],Ee=F.useState(re({},rR)),nn=Ee[0],Sn=Ee[1],Pn=n==null?void 0:n.value;F.useEffect(function(){var Fe=Ve==null?void 0:Ve.current;Oe([]),ft(Fe!=null&&Fe.textContent?Fe.textContent.trim().length>0:!1)},[Pn]),F.useEffect(function(){y||(ft(!1),FE(Ve))},[Ne]),F.useEffect(function(){var Fe,un;if(y&&(q!=null&&q.messageId)){var Ae=Ve==null?void 0:Ve.current;if(O&&(q!=null&&q.mentionedUsers)&&q.mentionedUsers.length>0&&(q!=null&&q.mentionedMessageTemplate)&&q.mentionedMessageTemplate.length>0){var Dn=q.mentionedUsers,pn=Dn===void 0?[]:Dn,it=Mh({messageText:q==null?void 0:q.mentionedMessageTemplate,mentionedUsers:pn,includeMarkdown:u.isGroupChannel()&&Qn.groupChannel.enableMarkdownForUserMessage});Ae&&(Ae.innerHTML=it.map(function(yt){if(yt.type===Qr.mention){var zt=pn.find(function(Je){return Je.userId===yt.userId}),Ht="".concat(qh).concat((zt==null?void 0:zt.nickname)||yt.value||ut.MENTION_NAME__NO_NAME);return Gb({userId:yt.userId,nickname:Ht})}return Rh(yt.value)}).join(""))}else{try{Ae&&(Ae.innerHTML=(Fe=Rh(q==null?void 0:q.message))!==null&&Fe!==void 0?Fe:"")}catch{}Oe([])}ft(Ae!=null&&Ae.textContent?((un=Ae==null?void 0:Ae.textContent)===null||un===void 0?void 0:un.trim().length)>0:!1)}},[y,q]);var lt=F.useCallback(function(){var Fe,un=Ve==null?void 0:Ve.current;if(O&&un){var Ae=Array.from(un.getElementsByClassName("sendbird-mention-user-label")).map(function(Dn){var pn;return(pn=Dn==null?void 0:Dn.dataset)===null||pn===void 0?void 0:pn.userid});(!Wj(xn,Ae)||Ae.length===0)&&(Vn(Ae),Oe(Ae))}ft(un!=null&&un.textContent?((Fe=un.textContent)===null||Fe===void 0?void 0:Fe.trim().length)>0:!1)},[nn,O]);F.useEffect(function(){var Fe,un,Ae,Dn;if(O&&gn){var pn=nn.targetString,it=nn.startNodeIndex,yt=nn.startOffsetIndex,zt=nn.endNodeIndex,Ht=nn.endOffsetIndex,Je=Ve==null?void 0:Ve.current;if(pn&&it!==null&&yt!==null&&Ht!==null&&zt!==null&&Je){var oe=P_(Je==null?void 0:Je.childNodes),ke=(un=(Fe=oe[it])===null||Fe===void 0?void 0:Fe.textContent)!==null&&un!==void 0?un:"",fn=document.createTextNode(ke.slice(0,yt)),bt=(Dn=(Ae=oe[zt])===null||Ae===void 0?void 0:Ae.textContent)!==null&&Dn!==void 0?Dn:"",dt=Ht&&document.createTextNode(" ".concat(bt.slice(Ht))),nr=Gb({userId:gn==null?void 0:gn.userId,nickname:"".concat(mh).concat((gn==null?void 0:gn.nickname)||ut.MENTION_NAME__NO_NAME)}),rr=document.createElement("div");rr.innerHTML=nr;var Vr=en(en(en([],oe.slice(0,it),!0),[fn,rr.childNodes[0],dt],!1),oe.slice(zt+1),!0);if(Je&&(Je.innerHTML="",Vr.forEach(function(ot){ot&&Je.appendChild(ot)})),Yn(gn),window.getSelection||document.getSelection){var Ir=window.getSelection()||document.getSelection();Ir==null||Ir.removeAllRanges();var bn=new Range;bn.selectNodeContents(Je),bn.setStart(Je.childNodes[it+2],1),bn.setEnd(Je.childNodes[it+2],1),bn.collapse(!1),Ir==null||Ir.addRange(bn),Je.focus()}Sn(re({},rR)),lt()}}},[gn,O]);var qn=F.useCallback(function(){var Fe,un,Ae=((Fe=window==null?void 0:window.getSelection)===null||Fe===void 0?void 0:Fe.call(window))||((un=document==null?void 0:document.getSelection)===null||un===void 0?void 0:un.call(document)),Dn=Ve==null?void 0:Ve.current;if((Ae==null?void 0:Ae.anchorNode)===Dn&&Tn(""),O&&Dn&&Ae&&Ae.anchorNode===Ae.focusNode&&Ae.anchorOffset===Ae.focusOffset)for(var pn="",it=null,yt=null,zt=function(oe){var ke=Dn.childNodes[oe];if(ke.nodeType===Fb.TextNode){var fn=function(){var rr;return ke===Ae.anchorNode?ke!=null&&ke.textContent?ke==null?void 0:ke.textContent.slice(0,Ae.anchorOffset):"":(rr=ke==null?void 0:ke.textContent)!==null&&rr!==void 0?rr:""}();if(pn.length>0)pn+=fn;else{for(var bt=fn.lastIndexOf(mh),dt=bt-1;dt>-1&&fn[dt]===mh;dt-=1)bt=dt;bt>-1&&(pn=fn,it=oe,yt=bt)}}else pn="",it=null,yt=null;if(ke===Ae.anchorNode){var nr=pn&&yt!==null?pn.slice(yt):"";return Sn({targetString:nr,startNodeIndex:it,startOffsetIndex:yt,endNodeIndex:oe,endOffsetIndex:Ae.anchorOffset}),Tn(nr),{value:void 0}}},Ht=0;Ht<Dn.childNodes.length;Ht+=1){var Je=zt(Ht);if(typeof Je=="object")return Je.value}},[O]),Fn=function(){var Fe,un;try{var Ae=Ve==null?void 0:Ve.current;if(!y&&(Ae!=null&&Ae.textContent)){var Dn=eR(Ae.childNodes),pn=Dn.messageText,it=Dn.mentionTemplate,yt={message:pn,mentionTemplate:it};pe(yt),FE(Ve),J1(navigator.userAgent)?(Ut.current&&Ut.current.focus(),requestAnimationFrame(function(){return Ae.focus()})):Ae.focus(),ft(!1)}}catch(zt){(un=(Fe=Ct==null?void 0:Ct.message)===null||Fe===void 0?void 0:Fe.onSendMessageFailed)===null||un===void 0||un.call(Fe,q,zt)}},At=!(!((r=(e=Ve==null?void 0:Ve.current)===null||e===void 0?void 0:e.textContent)===null||r===void 0)&&r.trim()),Pt=function(){var Fe,un;try{var Ae=Ve==null?void 0:Ve.current,Dn=q==null?void 0:q.messageId;if(y&&Dn&&Ae){var pn=eR(Ae.childNodes),it=pn.messageText,yt=pn.mentionTemplate,zt={messageId:Dn,message:it,mentionTemplate:yt};le(zt),FE(Ve)}}catch(Ht){(un=(Fe=Ct==null?void 0:Ct.message)===null||Fe===void 0?void 0:Fe.onUpdateMessageFailed)===null||un===void 0||un.call(Fe,q,Ht)}},zn=jW({ref:Ve,setMentionedUsers:st,channel:u,setIsInput:ft}),qt=function(Fe){var un,Ae,Dn=Fe.currentTarget.files;try{Dn&&ne(Array.from(Dn))}catch(pn){(Ae=(un=Ct==null?void 0:Ct.message)===null||un===void 0?void 0:un.onFileUploadFailed)===null||Ae===void 0||Ae.call(un,pn)}finally{Fe.target.value=""}},cr=function(){var Fe,un=Ve,Ae=window.getSelection();if(!(!Ae||Ae.rangeCount===0)){var Dn=Ae.getRangeAt(Ae.rangeCount-1),pn=Dn.getBoundingClientRect(),it=(Fe=un.current)===null||Fe===void 0?void 0:Fe.getBoundingClientRect();if(!(!it||!un.current)){if(pn.bottom>it.bottom){var yt=Math.min(pn.bottom-it.bottom,un.current.scrollHeight-un.current.clientHeight);un.current.scrollTop+=yt}else if(pn.top<it.top){var yt=Math.min(it.top-pn.top,un.current.scrollTop);un.current.scrollTop-=yt}}}};return b.createElement("form",{className:Rt.apply(void 0,en(en([],Array.isArray(h)?h:[h],!1),[y&&"sendbird-message-input__edit",L&&"sendbird-message-input-form__disabled"],!1))},b.createElement("div",{className:Rt("sendbird-message-input",L&&"sendbird-message-input__disabled"),"data-testid":"sendbird-message-input"},J1(navigator.userAgent)&&b.createElement("input",{id:"ghost-input-reset-ime-cjk",ref:Ut,style:{opacity:0,padding:0,margin:0,height:0,border:"none",position:"absolute",top:-9999},defaultValue:"_"}),b.createElement("div",{id:"".concat(mt).concat(y?q==null?void 0:q.messageId:""),className:"sendbird-message-input--textarea ".concat(mt),contentEditable:!L,role:"textbox","aria-label":"Text Input",ref:Ve,disabled:L,maxLength:$,onKeyDown:function(Fe){var un,Ae,Dn,pn,it=An(Fe);it?Fe.preventDefault():(!Fe.shiftKey&&Fe.key===Rs.Enter&&!T&&(!((un=Ve==null?void 0:Ve.current)===null||un===void 0)&&un.textContent)&&Ve.current.textContent.trim().length>0&&((Ae=Fe==null?void 0:Fe.nativeEvent)===null||Ae===void 0?void 0:Ae.isComposing)!==!0&&(Fe.preventDefault(),Fn()),Fe.key===Rs.Backspace&&((pn=(Dn=Ve==null?void 0:Ve.current)===null||Dn===void 0?void 0:Dn.childNodes)===null||pn===void 0?void 0:pn.length)===2&&!Ve.current.childNodes[0].textContent&&Ve.current.childNodes[1].nodeType===Fb.ElementNode&&Ve.current.removeChild(Ve.current.childNodes[1]))},onKeyUp:function(Fe){var un=On(Fe);un?Fe.preventDefault():qn()},onClick:function(){qn()},onInput:function(){var Fe;be(),ft(!((Fe=Ve==null?void 0:Ve.current)===null||Fe===void 0)&&Fe.textContent?Ve.current.textContent.trim().length>0:!1),lt()},onPaste:function(Fe){zn(Fe),setTimeout(cr)}}),((s=(a=(i=Ve==null?void 0:Ve.current)===null||i===void 0?void 0:i.textContent)===null||a===void 0?void 0:a.length)!==null&&s!==void 0?s:0)===0&&b.createElement(Ge,{className:"sendbird-message-input--placeholder",type:Be.BODY_1,color:L?Re.ONBACKGROUND_4:Re.ONBACKGROUND_3},Y||ut.MESSAGE_INPUT__PLACE_HOLDER),!y&&Ot&&b.createElement(Fu,{className:"sendbird-message-input--send",height:"32px",width:"32px",onClick:function(){return Fn()},testID:"sendbird-message-input-send-button"},(yn==null?void 0:yn())||b.createElement(mn,{type:Ye.SEND,fillColor:L?sn.ON_BACKGROUND_4:sn.PRIMARY,width:"20px",height:"20px"})),!y&&!Ot&&((We==null?void 0:We())||Et&&b.createElement(Fu,{className:Rt("sendbird-message-input--attach",k&&"is-voice-message-enabled"),height:"32px",width:"32px",onClick:function(){var Fe,un;(un=(Fe=ct==null?void 0:ct.current)===null||Fe===void 0?void 0:Fe.click)===null||un===void 0||un.call(Fe)}},b.createElement(mn,{type:Ye.ATTACH,fillColor:L?sn.ON_BACKGROUND_4:sn.CONTENT_INVERSE,width:"20px",height:"20px"}),b.createElement("input",{className:"sendbird-message-input--attach-input",type:"file",ref:ct,onChange:function(Fe){return qt(Fe)},accept:Aj(Cn),multiple:P&&xW(u)}))),k&&!y&&!Ot&&b.createElement(Fu,{className:"sendbird-message-input--voice-message",width:"32px",height:"32px",onClick:Jn},(Pe==null?void 0:Pe())||b.createElement(mn,{type:Ye.AUDIO_ON_LINED,fillColor:L?sn.ON_BACKGROUND_4:sn.CONTENT_INVERSE,width:"20px",height:"20px"}))),y&&b.createElement("div",{className:"sendbird-message-input--edit-action","data-testid":"sendbird-message-input--edit-action"},b.createElement(ws,{className:"sendbird-message-input--edit-action__cancel",type:Br.SECONDARY,size:Bo.SMALL,onClick:ve},ut.BUTTON__CANCEL),b.createElement(ws,{className:"sendbird-message-input--edit-action__save",type:Br.PRIMARY,size:Bo.SMALL,disabled:At,onClick:function(){return Pt()}},ut.BUTTON__SAVE)))});function iR(n){Gr(1,arguments);var t=fa(n);return t.setHours(0,0,0,0),t}function $C(n,t){Gr(2,arguments);var e=iR(n),r=iR(t);return e.getTime()===r.getTime()}function JW(n){return Gr(1,arguments),$C(n,Date.now())}function e$(n,t){Gr(2,arguments);var e=fa(n),r=fa(t);return e.getFullYear()===r.getFullYear()}function n$(n){return Gr(1,arguments),e$(n,Date.now())}function t$(n,t){Gr(2,arguments);var e=fa(n),r=Gu(t);return isNaN(r)?new Date(NaN):(r&&e.setDate(e.getDate()+r),e)}function r$(n,t){Gr(2,arguments);var e=Gu(t);return t$(n,-e)}function i$(n){return Gr(1,arguments),$C(n,r$(Date.now(),1))}var a$=function(n,t,e){var r;return e===void 0&&(e=dd),!(n!=null&&n.name)&&!(n!=null&&n.members)?e.NO_TITLE:NO(n)?((r=n==null?void 0:n.members)===null||r===void 0?void 0:r.length)===1?e.NO_MEMBERS:((n==null?void 0:n.members)||[]).filter(function(i){var a=i.userId;return a!==t}).map(function(i){var a=i.nickname;return a||e.NO_NAME}).join(", "):n.name},Fk=function(n){var t,e=n.channel,r=n.locale,i=n.stringSet,a=i===void 0?dd:i,s=(t=e==null?void 0:e.lastMessage)===null||t===void 0?void 0:t.createdAt,u=r?{locale:r}:null;return s?JW(s)?su(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__TODAY,u):i$(s)?a.MESSAGE_STATUS__YESTERDAY||"Yesterday":n$(s)?su(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__THIS_YEAR,u):su(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__PREVIOUS_YEAR,u):""},s$=function(n){return n!=null&&n.memberCount?n.memberCount:0},aR=function(n,t){var e,r,i,a,s,u;return t===void 0&&(t=dd),ld(n)?(e=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GIF)!==null&&e!==void 0?e:"":zu(n)?(r=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO)!==null&&r!==void 0?r:"":Ho(n)?(i=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VIDEO)!==null&&i!==void 0?i:"":gC(n)?(a=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_AUDIO)!==null&&a!==void 0?a:"":bO(n)?(s=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VOICE_MESSAGE)!==null&&s!==void 0?s:"":(u=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GENERAL)!==null&&u!==void 0?u:""},u$=function(n,t){var e,r,i,a;if(n===void 0&&(n=null),t===void 0&&(t=dd),!n)return"";if(hm(n))return t.CHANNEL_PREVIEW_LAST_MESSAGE_TEMPLATE_MESSAGE;if(n.isFileMessage())return aR(n.type,t);if(n.isMultipleFilesMessage()){var s=(r=(e=n.fileInfoList)===null||e===void 0?void 0:e[0])===null||r===void 0?void 0:r.mimeType;return zu(s)||ld(s)?(i=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO)!==null&&i!==void 0?i:"":aR(s,t)}return(a=n.message)!==null&&a!==void 0?a:""},o$=function(n,t){return t===void 0&&(t=dd),n!=null&&n.lastMessage?u$(n==null?void 0:n.lastMessage,t):""},sR=function(n){return n!=null&&n.unreadMessageCount?n.unreadMessageCount:0},go,vo,l$=(go={},go[Nr.SENT]=Ye.DONE,go[Nr.DELIVERED]=Ye.DONE_ALL,go[Nr.READ]=Ye.DONE_ALL,go[Nr.FAILED]=Ye.ERROR,go[Nr.PENDING]=void 0,go[Nr.NONE]=void 0,go),d$=(vo={},vo[Nr.SENT]=sn.SENT,vo[Nr.DELIVERED]=sn.SENT,vo[Nr.READ]=sn.READ,vo[Nr.FAILED]=sn.ERROR,vo[Nr.PENDING]=void 0,vo[Nr.NONE]=void 0,vo);function Hk(n){var t,e=n.className,r=n.message,i=n.channel,a=n.isDateSeparatorConsidered,s=a===void 0?!0:a,u=Bt(),d=u.stringSet,h=u.dateLocale,p=lO(i,r),g=((t=i==null?void 0:i.isGroupChannel)===null||t===void 0?void 0:t.call(i))&&(i.isSuper||i.isPublic||i.isBroadcast)&&!(p===Nr.PENDING||p===Nr.FAILED);return b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-message-status"],!1).join(" ")},p===Nr.PENDING?b.createElement(jm,{className:"sendbird-message-status__icon",testID:"sendbird-message-status-icon",width:"16px",height:"16px"},b.createElement(mn,{type:Ye.SPINNER,fillColor:sn.PRIMARY,width:"16px",height:"16px"})):b.createElement(mn,{className:Rt("sendbird-message-status__icon",g&&"hide-icon",p!==Nr.FAILED&&"sendbird-message-status--sent"),testID:"sendbird-message-status-icon",type:l$[p]||Ye.ERROR,fillColor:d$[p],width:"16px",height:"16px"}),Oj(p)&&b.createElement(Ge,{className:"sendbird-message-status__text",testID:"sendbird-message-status-text",type:Be.CAPTION_3,color:Re.ONBACKGROUND_2},s?su((r==null?void 0:r.createdAt)||0,d.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:h}):Fk({channel:i,locale:h,stringSet:d})))}var c$=function(n){var t=n.ref,e=n.onClick,r=e===void 0?ur:e,i=n.onBlur,a=i===void 0?ur:i,s=n.renderIcon,u=s===void 0?function(d){return b.createElement(mn,re({},d))}:s;return b.createElement(Fu,{ref:t,width:"32px",height:"32px",onClick:r,onBlur:a},u({type:Ye.MORE,fillColor:sn.CONTENT_INVERSE,width:"24px",height:"24px"}))},uR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu;return b.createElement(ga,re({},n,{onClick:function(s){var u;ha(i)&&yC(i.message),a(),(u=n.onClick)===null||u===void 0||u.call(n,s)}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__COPY)},oR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu,s=r.setQuoteMessage;return b.createElement(ga,re({},n,{disabled:i.parentMessageId>0,onClick:function(u){var d;s(i),a(),(d=n.onClick)===null||d===void 0||d.call(n,u)}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__REPLY)},lR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu,s=r.onReplyInThread;return b.createElement(ga,re({},n,{onClick:function(u){var d;s({message:i}),a(),(d=n.onClick)===null||d===void 0||d.call(n,u)}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__THREAD)},dR=function(n){var t,e=Bt().stringSet,r=li(),i=r.hideMenu,a=r.onMoveToParentMessage;return b.createElement(ga,re({},n,{onClick:function(s){var u;a(),i(),(u=n.onClick)===null||u===void 0||u.call(n,s)}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__OPEN_IN_CHANNEL)},cR=function(n){var t,e=Bt().stringSet,r=li(),i=r.hideMenu,a=r.showEdit,s=r.isOnline;return b.createElement(ga,re({},n,{onClick:function(u){var d;s&&(a(!0),i(),(d=n.onClick)===null||d===void 0||d.call(n,u))}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__EDIT)},fR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu,s=r.resendMessage,u=r.isOnline;return b.createElement(ga,re({},n,{onClick:function(d){var h;u&&(s(i),a(),(h=n.onClick)===null||h===void 0||h.call(n,d))}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__RESEND)},hR=function(n){var t,e,r,i=Bt().stringSet,a=li(),s=a.message,u=a.hideMenu,d=a.deleteMessage,h=a.showRemove,p=a.isOnline,g=a.disableDeleteMessage;return b.createElement(ga,re({},n,{disabled:typeof g=="boolean"?g:((e=(t=s.threadInfo)===null||t===void 0?void 0:t.replyCount)!==null&&e!==void 0?e:0)>0,onClick:function(E){var y;$a(s)?d(s):p&&(h(!0),u(),(y=n.onClick)===null||y===void 0||y.call(n,E))}}),(r=n.children)!==null&&r!==void 0?r:i.MESSAGE_MENU__DELETE)},Bk=function(n){var t,e=n.channel,r=n.message;if($a(r)||As(r)||!(!((t=e==null?void 0:e.isGroupChannel)===null||t===void 0)&&t.call(e))||e!=null&&e.isEphemeral)return!1;var i=e==null?void 0:e.isBroadcast,a=(e==null?void 0:e.myRole)===Ka.OPERATOR;return i?a:!0},f$=function(n){var t=n.message;return ha(t)},h$=function(n){var t=n.message,e=n.channel,r=n.isByMe;return!(e!=null&&e.isEphemeral)&&ha(t)&&Nh(t)&&r},p$=function(n){var t=n.message,e=n.isByMe;return $a(t)&&(t==null?void 0:t.isResendable)&&e},_$=function(n){var t=n.message,e=n.channel,r=n.isByMe;return!(e!=null&&e.isEphemeral)&&!As(t)&&r},m$=function(n){var t=n.onMoveToParentMessage,e=t===void 0?void 0:t;return!!e},g$=function(n){var t=n.channel,e=n.message,r=n.replyType;return Bk({channel:t,message:e})&&r==="QUOTE_REPLY"},v$=function(n){var t=n.channel,e=n.message,r=n.replyType,i=n.onReplyInThread;return Bk({channel:t,message:e})&&r==="THREAD"&&!(e!=null&&e.parentMessageId)&&typeof i=="function"},E$=function(n){var t,e=n.className,r=n.message,i=n.channel,a=n.isByMe,s=n.replyType,u=n.renderTrigger,d=u===void 0?c$:u,h=n.renderMenuItems,p=n.disableDeleteMessage,g=p===void 0?null:p,E=n.showEdit,y=E===void 0?ur:E,C=n.showRemove,T=C===void 0?ur:C,A=n.deleteMessage,O=n.resendMessage,N=n.setQuoteMessage,k=n.onReplyInThread,D=n.onMoveToParentMessage,P=Mt().config,U=P.isOnline,L=F.useRef(null),B=F.useRef(null),q=F.useState(!1),z=q[0],Y=q[1],Q=function(){return Y(!1)},$=function(){return Y(!0)},Z=function(){return Y(function(ue){return!ue})},ne={message:r,channel:i,isByMe:a,replyType:s,onReplyInThread:k,onMoveToParentMessage:D};return b.createElement("div",{className:Rt("sendbird-message-menu",e),ref:B},b.createElement(SC,{value:{message:r,hideMenu:Q,showMenu:$,toggleMenu:Z,setQuoteMessage:N,onReplyInThread:k,onMoveToParentMessage:D,showEdit:y,showRemove:T,deleteMessage:A,resendMessage:O,isOnline:U,disableDeleteMessage:g,triggerRef:L,containerRef:B}},d({ref:L,onClick:Z}),z&&b.createElement(Ac,{id:AC(r.messageId),parentRef:L,parentContainRef:B,closeDropdown:Q,openLeft:a},(t=h==null?void 0:h({items:{CopyMenuItem:uR,ReplyMenuItem:oR,ThreadMenuItem:lR,OpenInChannelMenuItem:dR,EditMenuItem:cR,ResendMenuItem:fR,DeleteMenuItem:hR}}))!==null&&t!==void 0?t:b.createElement(b.Fragment,null,f$(ne)&&b.createElement(uR,null),g$(ne)&&b.createElement(oR,null),v$(ne)&&b.createElement(lR,null),m$(ne)&&b.createElement(dR,null),h$(ne)&&b.createElement(cR,null),p$(ne)&&b.createElement(fR,null),_$(ne)&&b.createElement(hR,null)))))},y$=300;function pR(n){b$(n)&&n.touches.length<2&&n.preventDefault&&n.preventDefault()}function b$(n){return n&&"touches"in n}function Rc(n,t){var e=n.onLongPress,r=n.onClick,i=t===void 0?{}:t,a=i.delay,s=a===void 0?y$:a,u=i.shouldPreventDefault,d=u===void 0?!0:u,h=i.shouldStopPropagation,p=h===void 0?!1:h,g=Zi().isMobile,E=F.useState(!1),y=E[0],C=E[1],T=F.useState(!1),A=T[0],O=T[1],N=F.useRef(),k=F.useRef(),D=F.useCallback(function(U){U.persist();var L=re({},U);O(!1),p&&U.stopPropagation(),d&&U.target&&(U.target.addEventListener("touchend",pR,{passive:!1}),k.current=U.target),N.current=setTimeout(function(){e(L),C(!0)},s)},[e,s,d,p,g]),P=F.useCallback(function(U,L,B){L===void 0&&(L=!0),B===void 0&&(B=!1),O(!!B),N!=null&&N.current&&clearTimeout(N.current),L&&!y&&!A&&(r==null||r(U)),C(!1),d&&k.current&&k.current.removeEventListener("touchend",pR)},[d,r,y,A]);return{onMouseDown:function(U){return D(U)},onMouseUp:function(U){return P(U)},onMouseLeave:function(U){return P(U,!1)},onTouchStart:function(U){return D(U)},onTouchMove:function(U){return P(U,!1,!0)},onTouchEnd:function(U){return P(U)}}}var Oh=b.forwardRef(function(n,t){var e=n.className,r=n.width,i=n.height,a=n.selected,s=n.dataSbId,u=s===void 0?"":s,d=n.testID,h=n.onClick,p=n.children,g=Rc({onLongPress:ur,onClick:h},{shouldPreventDefault:!0,shouldStopPropagation:!0});return b.createElement("div",re({className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-reaction-button".concat(a?"--selected":"")],!1).join(" "),ref:t,role:"button",style:{width:r,height:i}},g,{tabIndex:0,"data-sb-id":d??u,"data-testid":d??u}),b.createElement("div",{className:"sendbird-reaction-button__inner"},p))});function C$(n){var t=n.className,e=n.message,r=n.userId,i=n.spaceFromTrigger,a=i===void 0?{x:0,y:0}:i,s=n.emojiContainer,u=n.filterEmojiCategoryIds,d=n.toggleReaction,h=F.useRef(null),p=F.useRef(null),g=F.useMemo(function(){return D_(s,u==null?void 0:u(e))},[s,u]);return As(e)||$a(e)?null:b.createElement("div",{className:ma([t??"","sendbird-message-item-reaction-menu"]),ref:p},b.createElement(wc,{menuTrigger:function(E){return b.createElement(Fu,{className:"sendbird-message-item-reaction-menu__trigger",ref:h,width:"32px",height:"32px",onClick:function(){E()}},b.createElement(mn,{className:"sendbird-message-item-reaction-menu__trigger__icon",testID:"sendbird-message-item-reaction-menu__trigger__icon",type:Ye.EMOJI_MORE,fillColor:sn.CONTENT_INVERSE,width:"24px",height:"24px"}))},menuItems:function(E){return g.length===0?null:b.createElement(YO,{id:AC(e.messageId),parentRef:h,parentContainRef:p,closeDropdown:E,spaceFromTrigger:a},g.map(function(y){var C,T,A,O=((A=(T=(C=e==null?void 0:e.reactions)===null||C===void 0?void 0:C.find(function(N){return N.key===y.key}))===null||T===void 0?void 0:T.userIds)===null||A===void 0?void 0:A.some(function(N){return N===r}))||!1;return b.createElement(Oh,{key:y.key,width:"36px",height:"36px",selected:O,onClick:function(){E(),d==null||d(e,y.key,O)},testID:"ui_emoji_reactions_menu_".concat(y.key)},b.createElement(ui,{url:y.url,width:"28px",height:"28px",placeHolder:function(N){var k=N.style;return b.createElement("div",{style:k},b.createElement(mn,{type:Ye.QUESTION,fillColor:sn.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))}))}}))}var YC=b.forwardRef(function(n,t){var e=n.className,r=e===void 0?"":e,i=n.testID,a=n.children,s=n.count,u=s===void 0?"":s,d=n.isAdd,h=d===void 0?!1:d,p=n.selected,g=p===void 0?!1:p,E=n.onClick,y=E===void 0?function(){}:E,C=function(){return g&&!h?"--selected":h?"--is-add":""};return b.createElement("div",{className:en(en([],Array.isArray(r)?r:[r],!0),["sendbird-reaction-badge".concat(C())],!1).join(" "),"data-testid":i,role:"button",ref:t,onClick:y,onKeyDown:y,onTouchEnd:y,tabIndex:0},b.createElement("div",{className:"sendbird-reaction-badge__inner"},b.createElement("div",{className:"sendbird-reaction-badge__inner__icon"},a),b.createElement(Ge,{className:a&&u?"sendbird-reaction-badge__inner__count":"",type:Be.CAPTION_3,color:Re.ONBACKGROUND_1},u)))}),qm=function(n){var t,e,r,i=n.className,a=i===void 0?"":i,s=n.children,u=n.onBackdropClick,d=(e=(t=Mt())===null||t===void 0?void 0:t.config)===null||e===void 0?void 0:e.logger,h=F.useRef();return h.current=document.getElementById(td),h.current||(h.current=document.createElement("div"),h.current.setAttribute("id",td),document.body.appendChild(h.current),(r=d==null?void 0:d.warning)===null||r===void 0||r.call(d,"@sendbird/uikit-react/ui/BottomSheet | Should put a ModalRoot to use the BottomSheet.")),Tc.createPortal(b.createElement("div",{className:"".concat(a," sendbird-bottomsheet")},b.createElement("div",{className:"sendbird-bottomsheet__content",role:"dialog","aria-modal":"true","aria-expanded":"true"},s),b.createElement("div",{className:"sendbird-bottomsheet__backdrop",onClick:function(p){p==null||p.stopPropagation(),u==null||u()}})),h.current)};function I$(n){var t=n.height,e=t===void 0?24:t,r=n.width,i=r===void 0?24:r;return b.createElement("div",{className:"sendbird-muted-avatar",style:{height:"".concat(e,"px"),width:"".concat(i,"px")}},b.createElement("div",{className:"sendbird-muted-avatar__icon"},b.createElement("div",{className:"sendbird-muted-avatar__bg",style:{height:"".concat(e,"px"),width:"".concat(i,"px")}}),b.createElement(mn,{type:Ye.MUTE,fillColor:sn.WHITE,width:"".concat(e-8,"px"),height:"".concat(i-8,"px")})))}function T$(n){var t=n.id,e=n.checked,r=e===void 0?!1:e,i=n.disabled,a=n.onChange,s=F.useState(r),u=s[0],d=s[1];return b.createElement("label",{className:["sendbird-checkbox",i?"disabled":""].join(" "),htmlFor:t},b.createElement("input",{disabled:i,id:t,type:"checkbox",checked:u,onClick:function(){i||d(!u)},onChange:a}),b.createElement("span",{className:["sendbird-checkbox--checkmark",i?"disabled":""].join(" ")}))}var Gk=function(n){var t=n.stores,e=t===void 0?{}:t,r=e.sdkStore,i=r===void 0?{}:r,a=i.sdk;return a},S$=function(n){var t=n.config,e=t===void 0?{}:t,r=e.pubSub;return r},Vk=function(n){return function(t){return new Promise(function(e,r){var i=Gk(n),a=S$(n);i||r(new Error("Sdk not found")),i.groupChannel||r(new Error("Not found GroupChannelModule")),i.groupChannel.createChannel&&typeof i.groupChannel.createChannel=="function"||r(new Error('Not found the function "createChannel"')),i.groupChannel.createChannel(t).then(function(s){e(s),a.publish(Yi.CREATE_CHANNEL,{channel:s})}).catch(r)})}};function QC(n){var t,e,r=n.user,i=n.currentUserId,a=n.disableMessaging,s=a===void 0?!1:a,u=n.onSuccess,d=Mt(),h=Vk(d),p=(t=d==null?void 0:d.config)===null||t===void 0?void 0:t.logger,g=F.useContext(kr).stringSet,E=i||((e=d==null?void 0:d.config)===null||e===void 0?void 0:e.userId),y=RC().onStartDirectMessage;return b.createElement("div",{className:"sendbird__user-profile"},b.createElement("section",{className:"sendbird__user-profile-avatar"},b.createElement(Na,{height:"80px",width:"80px",src:r==null?void 0:r.profileUrl})),b.createElement("section",{className:"sendbird__user-profile-name"},b.createElement(Ge,{type:Be.H_2,color:Re.ONBACKGROUND_1},(r==null?void 0:r.nickname)||g.NO_NAME)),(r==null?void 0:r.userId)!==E&&!s&&b.createElement("section",{className:"sendbird__user-profile-message"},b.createElement(ws,{type:Br.SECONDARY,onClick:function(){var C={isDistinct:!1,invitedUserIds:r!=null&&r.userId?[r==null?void 0:r.userId]:[],operatorUserIds:[E]};u==null||u(),h(C).then(function(T){p.info("UserProfile, channel create",T),y==null||y(T)})}},g.USER_PROFILE__MESSAGE)),b.createElement("div",{className:"sendbird__user-profile-separator"}),b.createElement("section",{className:"sendbird__user-profile-userId"},b.createElement(Ge,{className:"sendbird__user-profile-userId--label",type:Be.CAPTION_2,color:Re.ONBACKGROUND_2},g.USER_PROFILE__USER_ID),b.createElement(Ge,{className:"sendbird__user-profile-userId--value",type:Be.BODY_1,color:Re.ONBACKGROUND_1},r==null?void 0:r.userId)))}function jk(n){var t=n.user,e=n.channel,r=n.className,i=r===void 0?void 0:r,a=n.checked,s=n.checkBox,u=n.isOperator,d=n.disabled,h=n.disableMessaging,p=n.action,g=n.onChange,E=n.avatarSize,y=E===void 0?"40px":E,C=n.onClick,T=n.onUserAvatarClick,A=n.renderListItemMenu,O=n.size,N=O===void 0?"normal":O,k=u??(t==null?void 0:t.role)==="operator",D=t.userId,P=F.useRef(null),U=F.useRef(null),L=F.useRef(null),B=RC(),q=B.disableUserProfile,z=B.renderUserProfile,Y=Bt().stringSet,Q=Mt().config,$=Q.userId,Z=N==="small"?"sendbird-user-list-item--small":"sendbird-user-list-item",ne=N==="small"?"sendbird-user-list-item--small__avatar":"sendbird-user-list-item__avatar",ue=N==="small"?"sendbird-user-list-item--small__title":"sendbird-user-list-item__title",pe=N==="small"?"sendbird-user-list-item--small__subtitle":"sendbird-user-list-item__subtitle",he=N==="small"?"sendbird-user-list-item--small__checkbox":"sendbird-user-list-item__checkbox",le=N==="small"?"sendbird-user-list-item--small__action":"sendbird-user-list-item__action",we=N==="small"?"sendbird-user-list-item--small__operator":"sendbird-user-list-item__operator";return b.createElement("div",{className:Rt.apply(void 0,en([Z],Array.isArray(i)?i:[i],!1)),ref:U},b.createElement(wc,{menuTrigger:function(ve){return b.createElement(b.Fragment,null,b.createElement(Na,{className:ne,ref:L,src:(t==null?void 0:t.profileUrl)||(t==null?void 0:t.plainProfileUrl)||"",width:y,height:y,onClick:function(){var Ue;q||(ve(),(Ue=T??C)===null||Ue===void 0||Ue())}}),(t==null?void 0:t.isMuted)&&b.createElement(I$,{height:Cc(y),width:Cc(y)}))},menuItems:function(ve){return z?z({user:t,currentUserId:$??"",close:ve,avatarRef:L}):b.createElement(Ac,{openLeft:!0,parentRef:L,parentContainRef:L,closeDropdown:ve,style:{paddingTop:"0px",paddingBottom:"0px"}},b.createElement(QC,{disableMessaging:h,user:t,currentUserId:$,onSuccess:ve}))}}),b.createElement(Ge,{className:ue,type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},t.nickname||Y.NO_NAME,$===t.userId&&Y.CHANNEL_SETTING__MEMBERS__YOU),!t.nickname&&b.createElement(Ge,{className:pe,type:Be.CAPTION_3,color:Re.ONBACKGROUND_2},t.userId),s&&b.createElement("label",{className:he,htmlFor:D},b.createElement(T$,{id:D,checked:a,disabled:d,onChange:function(ve){return g==null?void 0:g(ve)}})),k&&b.createElement(Ge,{className:Rt(we,s&&"checkbox"),type:Be.SUBTITLE_2,color:Re.ONBACKGROUND_2},Y.LABEL__OPERATOR),!s&&!A&&p&&b.createElement("div",{className:le,ref:P},p({actionRef:P,parentRef:U})),!s&&A&&b.createElement("div",{className:le,ref:P},A({channel:e,user:t})))}function N$(n){var t=n.className,e=t===void 0?"":t,r=n.children,i=r===void 0?"":r;return b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-tooltip"],!1).join(" ")},b.createElement(Ge,{className:"sendbird-tooltip__text",type:Be.CAPTION_2,color:Re.ONCONTENT_1},i))}var A$=8;function w$(n){var t=n.className,e=t===void 0?"":t,r=n.children,i=n.hoverTooltip,a=F.useState(!1),s=a[0],u=a[1],d=F.useRef();return b.createElement("div",{className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-tooltip-wrapper"],!1).join(" "),onMouseOver:function(){u(!0)},onFocus:function(){u(!0)},onMouseOut:function(){u(!1)},onBlur:function(){u(!1)}},b.createElement("div",{className:"sendbird-tooltip-wrapper__children",ref:d},r),s&&b.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip",style:{bottom:"calc(100% + ".concat(A$,"px)")}},b.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip__inner"},b.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip__inner__tooltip-container",style:{left:d.current?"calc(".concat(d.current.offsetWidth/2,"px - 50%)"):void 0}},i))))}var R$={message:{},isByMe:!1},qk=b.createContext(R$),_R=function(n){var t=n.children,e=n.message,r=n.isByMe,i=r===void 0?!1:r;return b.createElement(qk.Provider,{value:{message:e,isByMe:i}},t)},zk=function(){var n=b.useContext(qk);if(n===void 0)throw new Error("useMessageContext must be used within a MessageProvider");return n},M$=function(n){var t,e,r,i=n.message,a=n.channel,s=n.emojiKey,u=s===void 0?"":s,d=n.hideMenu,h=n.emojiContainer,p=n.onPressUserProfileHandler,g=a.members,E=g===void 0?[]:g,y=F.useState(u),C=y[0],T=y[1];function A(){if(p&&i){var O=i==null?void 0:i.sender;p(O)}}return b.createElement(qm,{onBackdropClick:d},b.createElement("div",{className:"sendbird-message__bottomsheet"},b.createElement("div",{className:"sendbird-message__bottomsheet__reacted-members"},(t=i.reactions)===null||t===void 0?void 0:t.map(function(O){var N=Vj(h,O.key);return b.createElement("div",{key:O.key,className:Rt("sendbird-message__bottomsheet__reacted-members__item",C===O.key&&"sendbird-message__bottomsheet__reacted-members__item__selected"),onClick:function(){T(O.key)}},b.createElement(ui,{url:N,width:"28px",height:"28px",placeHolder:function(k){var D=k.style;return b.createElement("div",{style:D},b.createElement(mn,{type:Ye.QUESTION,fillColor:sn.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}),b.createElement(Ge,{type:Be.BUTTON_2,color:C===O.key?Re.PRIMARY:Re.ONBACKGROUND_3},O.userIds.length))})),b.createElement("div",{className:"sendbird-message__bottomsheet__reactor-list"},((r=(e=i.reactions)===null||e===void 0?void 0:e.find(function(O){return O.key===C}))===null||r===void 0?void 0:r.userIds.map(function(O){return E.find(function(N){return N.userId===O})}).filter(function(O){return O!==void 0})).map(function(O){return b.createElement(jk,{key:O.userId,className:"sendbird-message__bottomsheet__reactor-list__item",user:O,avatarSize:"36px",onUserAvatarClick:A})}))))};function O$(n){var t,e=n.reaction,r=n.memberNicknamesMap,i=n.setEmojiKey,a=n.toggleReaction,s=n.emojisMap,u=n.channel,d=n.message,h=n.isFiltered,p=ek().openModal,g=Mt(),E=Zi().isMobile,y=zk(),C=F.useContext(kr).stringSet,T=g.config.userId,A=IO(T,e),O=e.userIds.length>0&&(u==null?void 0:u.isGroupChannel())&&!u.isSuper,N=function(){if(h&&!A){p({modalProps:{titleText:"Add reaction failed",hideFooter:!0,isCloseOnClickOutside:!0},childElement:function(D){var P=D.closeModal;return b.createElement(_m,{type:Br.PRIMARY,submitText:C.BUTTON__OK,hideCancelButton:!0,onCancel:P,onSubmit:P})}});return}i(""),a==null||a(d??(y==null?void 0:y.message),e.key,A)},k=Rc({onLongPress:function(){i(e.key)},onClick:N},{shouldPreventDefault:!0,shouldStopPropagation:!0});return b.createElement(w$,{className:"sendbird-emoji-reactions__reaction-badge",hoverTooltip:O?b.createElement(N$,null,Hj(e,T,r,C)):b.createElement(b.Fragment,null)},b.createElement("div",re({},E?k:{onClick:N}),b.createElement(YC,{count:e.userIds.length,selected:A},b.createElement(ui,{circle:!0,url:((t=s.get(e==null?void 0:e.key))===null||t===void 0?void 0:t.url)||"",width:"20px",height:"20px",defaultComponent:b.createElement(mn,{width:"20px",height:"20px",type:Ye.QUESTION})}))))}var k$=function(n){var t=n.onClick,e=Rc({onLongPress:function(){},onClick:t},{shouldPreventDefault:!0,shouldStopPropagation:!0});return b.createElement("div",re({className:"sendbird-emoji-reactions__add-reaction-badge","data-testid":"sendbird-emoji-reactions__add-reaction-badge"},e),b.createElement(YC,{isAdd:!0},b.createElement(mn,{type:Ye.EMOJI_MORE,fillColor:sn.ON_BACKGROUND_3,width:"20px",height:"20px"})))},D$=function(n){var t=n.userId,e=n.message,r=n.emojiContainer,i=n.hideMenu,a=n.toggleReaction,s=F.useMemo(function(){return bC(r)},[r]);return b.createElement(qm,{onBackdropClick:i},b.createElement("div",{className:"sendbird-message__bottomsheet sendbird-message__emojis-bottomsheet"},s.map(function(u){var d,h,p,g,E=(g=(p=(h=(d=e==null?void 0:e.reactions)===null||d===void 0?void 0:d.find(function(y){return y.key===u.key}))===null||h===void 0?void 0:h.userIds)===null||p===void 0?void 0:p.some(function(y){return y===t}))!==null&&g!==void 0?g:!1;return b.createElement(Oh,{key:u.key,width:"44px",height:"44px",selected:E,onClick:function(y){y==null||y.stopPropagation(),a==null||a(e,u.key,E),i()},testID:"ui_mobile_emoji_reactions_menu_".concat(u.key)},b.createElement(ui,{url:u.url,width:"38px",height:"38px",placeHolder:function(y){var C=y.style;return b.createElement("div",{style:C},b.createElement(mn,{type:Ye.QUESTION,fillColor:sn.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))})))},L$=function(n){var t,e,r,i,a,s=n.className,u=s===void 0?"":s,d=n.userId,h=n.message,p=n.channel,g=n.emojiContainer,E=n.memberNicknamesMap,y=n.spaceFromTrigger,C=y===void 0?{x:0,y:0}:y,T=n.isByMe,A=T===void 0?!1:T,O=n.toggleReaction,N=n.onPressUserProfile,k=n.filterEmojiCategoryIds,D=!1;try{var P=Mt().config;D=p?sk({channel:p,config:P}):!1}catch{}var U=Zi().isMobile,L=F.useRef(null),B=F.useState(!1),q=B[0],z=B[1],Y=F.useState(""),Q=Y[0],$=Y[1],Z=Bj(g),ne=F.useMemo(function(){return D_(g,k==null?void 0:k(h))},[g,k]),ue=((e=(t=h.reactions)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0)<Z.size;return b.createElement("div",{className:ma([u,"sendbird-emoji-reactions",A?"outgoing":"incoming"])},((i=(r=h.reactions)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0&&((a=h.reactions)===null||a===void 0?void 0:a.map(function(pe){return b.createElement(O$,{key:pe==null?void 0:pe.key,reaction:pe,memberNicknamesMap:E,setEmojiKey:$,toggleReaction:O,emojisMap:Z,channel:p,message:h,isFiltered:D_(g,k==null?void 0:k(h)).every(function(he){return he.key!==(pe==null?void 0:pe.key)})})})),!U&&ue&&b.createElement(wc,{menuTrigger:function(pe){return b.createElement(YC,{className:"sendbird-emoji-reactions__add-reaction-badge",testID:"sendbird-emoji-reactions__add-reaction-badge",ref:L,isAdd:!0,onClick:function(he){var le;pe(),(le=he==null?void 0:he.stopPropagation)===null||le===void 0||le.call(he)}},b.createElement(mn,{type:Ye.EMOJI_MORE,fillColor:sn.ON_BACKGROUND_3,width:"20px",height:"20px"}))},menuItems:function(pe){return ne.length===0?null:b.createElement(YO,{parentRef:L,parentContainRef:L,closeDropdown:pe,spaceFromTrigger:C},D_(g,k==null?void 0:k(h)).map(function(he){var le,we,ve,Ue=((ve=(we=(le=h==null?void 0:h.reactions)===null||le===void 0?void 0:le.find(function(be){return be.key===he.key}))===null||we===void 0?void 0:we.userIds)===null||ve===void 0?void 0:ve.some(function(be){return be===d}))||!1;return b.createElement(Oh,{key:he.key,width:"36px",height:"36px",selected:Ue,onClick:function(be){pe(),O==null||O(h,he.key,Ue),be==null||be.stopPropagation()},testID:"ui_emoji_reactions_menu_".concat(he.key)},b.createElement(ui,{url:(he==null?void 0:he.url)||"",width:"28px",height:"28px",placeHolder:function(be){var Qe=be.style;return b.createElement("div",{style:Qe},b.createElement(mn,{type:Ye.QUESTION,fillColor:sn.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))}))}}),U&&ue&&b.createElement(k$,{onClick:function(){z(!0)}}),U&&q&&b.createElement(D$,{userId:d,message:h,emojiContainer:g,hideMenu:function(){z(!1)},toggleReaction:O}),U&&Q&&p!==null&&D&&b.createElement(M$,{message:h,channel:p,emojiKey:Q,hideMenu:function(){$("")},emojiContainer:g,onPressUserProfileHandler:N}))};function x$(n){var t,e=n.className,r=e===void 0?"":e,i=n.message;return!(i!=null&&i.isAdminMessage||i!=null&&i.messageType)||!(!((t=i==null?void 0:i.isAdminMessage)===null||t===void 0)&&t.call(i))||(i==null?void 0:i.messageType)!=="admin"?null:b.createElement("div",{className:en(en([],Array.isArray(r)?r:[r],!0),["sendbird-admin-message"],!1).join(" ")},b.createElement(Ge,{className:"sendbird-admin-message__text",type:Be.CAPTION_2,color:Re.ONBACKGROUND_2},i==null?void 0:i.message))}function bm(n){return Mi(n).when(Xi,function(){var t;return(t=n==null?void 0:n.type)!==null&&t!==void 0?t:""}).when(ca,function(){var t,e;return(e=(t=zm(n))===null||t===void 0?void 0:t.mimeType)!==null&&e!==void 0?e:""}).otherwise(function(){return""})}function zm(n){var t=n.fileInfoList;return t.length>0?t[0]:null}function Kk(n){return Mi(n).when(Xi,function(){var t;return(t=n==null?void 0:n.name)!==null&&t!==void 0?t:""}).when(ca,function(){var t,e;return(e=(t=zm(n))===null||t===void 0?void 0:t.fileName)!==null&&e!==void 0?e:""}).otherwise(function(){return""})}function Cm(n){return Mi(n).when(Xi,function(){var t;return(t=n==null?void 0:n.url)!==null&&t!==void 0?t:""}).when(ca,function(){var t,e;return(e=(t=zm(n))===null||t===void 0?void 0:t.url)!==null&&e!==void 0?e:""}).otherwise(function(){return""})}function U$(n){return Mi(n).when(Xi,function(){return n.thumbnails}).when(ca,function(){var t,e;return(e=(t=zm(n))===null||t===void 0?void 0:t.thumbnails)!==null&&e!==void 0?e:[]}).otherwise(function(){return[]})}function Wk(n){var t=U$(n);return t&&t.length>0?t[0].url:""}function P$(n){var t,e,r,i,a,s,u,d=n.message,h=n.userId,p=h===void 0?"":h,g=n.isByMe,E=g===void 0?!1:g,y=n.className,C=y===void 0?"":y,T=n.isUnavailable,A=T===void 0?!1:T,O=n.onClick,N=F.useContext(kr).stringSet,k=d.parentMessage,D=k==null?void 0:k.sender,P=p===(D==null?void 0:D.userId)?N.QUOTED_MESSAGE__CURRENT_USER:D==null?void 0:D.nickname,U=Cm(k),L=bm(k),B=p===((e=d==null?void 0:d.sender)===null||e===void 0?void 0:e.userId)?N.QUOTED_MESSAGE__CURRENT_USER:(r=d==null?void 0:d.sender)===null||r===void 0?void 0:r.nickname,q=F.useState(!1),z=q[0],Y=q[1],Q=Mj(),$=(a=(i=Kk(k))===null||i===void 0?void 0:i.split("/"))!==null&&a!==void 0?a:U.split("/");return b.createElement("div",{className:ma([C,"sendbird-quote-message",E?"outgoing":"incoming",A?"unavailable":""]),key:k==null?void 0:k.messageId,onClick:function(){!A&&O&&O()},onTouchEnd:function(){!A&&O&&O()}},b.createElement("div",{className:"sendbird-quote-message__replied-to"},b.createElement(mn,{className:"sendbird-quote-message__replied-to__icon",type:Ye.REPLY,fillColor:sn.ON_BACKGROUND_3,width:"12px",height:"12px"}),b.createElement(Ge,{className:"sendbird-quote-message__replied-to__text",testID:"sendbird-quote-message__replied-to__text",type:Be.CAPTION_2,color:Re.ONBACKGROUND_3},b.createElement("span",{className:"sendbird-quote-message__replied-to__text__nickname"},B),b.createElement("span",{className:"sendbird-quote-message__replied-to__text__text"},N.QUOTED_MESSAGE__REPLIED_TO),b.createElement("span",{className:"sendbird-quote-message__replied-to__text__nickname"},P))),b.createElement("div",{className:"sendbird-quote-message__replied-message"},A&&b.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},b.createElement(Ge,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:Be.BODY_2,color:Re.ONBACKGROUND_1},N.QUOTED_MESSAGE__UNAVAILABLE)),ha(k)&&((s=k==null?void 0:k.message)===null||s===void 0?void 0:s.length)>0&&!A&&b.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},b.createElement(Ge,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:Be.BODY_2,color:Re.ONBACKGROUND_1},k==null?void 0:k.message)),ou(k)&&U&&!A&&b.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},b.createElement(Ge,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:Be.BODY_2,color:Re.ONBACKGROUND_1},N.VOICE_MESSAGE)),(Go(k)||ca(k))&&U&&!A&&b.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message"},b.createElement(ui,{className:"sendbird-quote-message__replied-message__thumbnail-message__image",url:U,alt:L,width:"144px",height:"108px",onLoad:function(){return Y(!0)},defaultComponent:b.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__placeholder"},b.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__placeholder__icon"},b.createElement(mn,{type:Ho(L)?Ye.PLAY:Ye.PHOTO,fillColor:sn.ON_BACKGROUND_2,width:"22px",height:"22px"})))}),Ho(L)&&!(((u=k==null?void 0:k.thumbnails)===null||u===void 0?void 0:u.length)>0)&&b.createElement(b.Fragment,null,b.createElement("video",{className:"sendbird-quote-message__replied-message__thumbnail-message__video"},b.createElement("source",{src:U,type:L})),b.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover"},b.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover__icon"},b.createElement(mn,{type:Ye.PLAY,fillColor:sn.ON_BACKGROUND_2,width:"14px",height:"14px"})))),z&&ld(L)&&b.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover"},b.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover__icon"},b.createElement(mn,{type:Ye.GIF,fillColor:sn.THUMBNAIL_ICON,width:"14px",height:"14px"})))),EC(k)===Ws.FILE&&U&&!A&&b.createElement("div",{className:"sendbird-quote-message__replied-message__file-message"},b.createElement(mn,{className:"sendbird-quote-message__replied-message__file-message__type-icon",type:(t={},t[Q.IMAGE]=Ye.PHOTO,t[Q.VIDEO]=Ye.PLAY,t[Q.AUDIO]=Ye.FILE_AUDIO,t[Q.GIF]=Ye.GIF,t[Q.OTHERS]=Ye.FILE_DOCUMENT,t)[pO(L)],fillColor:sn.ON_BACKGROUND_3,width:"16px",height:"16px"}),b.createElement(Ge,{className:"sendbird-quote-message__replied-message__file-message__file-name",type:Be.BODY_2,color:Re.ONBACKGROUND_3},SO($[$.length-1])))))}var mR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu;return b.createElement(ga,re({},n,{onClick:function(s){var u;ha(i)&&yC(i.message),a(),(u=n.onClick)===null||u===void 0||u.call(n,s)}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__COPY),b.createElement(mn,{type:Ye.COPY,fillColor:sn.PRIMARY,width:"24px",height:"24px"})))},gR=function(n){var t,e,r,i=Bt().stringSet,a=li(),s=a.message,u=a.hideMenu,d=a.setQuoteMessage;return b.createElement(ga,re({},n,{disabled:s.parentMessageId>0,onClick:function(h){var p;d(s),u(),(p=n.onClick)===null||p===void 0||p.call(n,h)}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(Ge,{type:Be.SUBTITLE_1,color:((e=s.parentMessageId)!==null&&e!==void 0?e:0)>0?Re.ONBACKGROUND_4:Re.ONBACKGROUND_1},i.MESSAGE_MENU__REPLY),b.createElement(mn,{type:Ye.REPLY,fillColor:((r=s.parentMessageId)!==null&&r!==void 0?r:0)>0?sn.ON_BACKGROUND_4:sn.PRIMARY,width:"24px",height:"24px"})))},vR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu,s=r.onReplyInThread;return b.createElement(ga,re({},n,{onClick:function(u){var d;s({message:i}),a(),(d=n.onClick)===null||d===void 0||d.call(n,u)}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__THREAD),b.createElement(mn,{type:Ye.THREAD,fillColor:sn.PRIMARY,width:"24px",height:"24px"})))},ER=function(n){var t,e=Bt().stringSet,r=li(),i=r.hideMenu,a=r.showEdit,s=r.isOnline;return b.createElement(ga,re({},n,{onClick:function(u){var d;s&&(a(!0),i(),(d=n.onClick)===null||d===void 0||d.call(n,u))}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__EDIT),b.createElement(mn,{type:Ye.EDIT,fillColor:sn.PRIMARY,width:"24px",height:"24px"})))},yR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu,s=r.resendMessage,u=r.isOnline;return b.createElement(ga,re({},n,{onClick:function(d){var h;u&&(s(i),a(),(h=n.onClick)===null||h===void 0||h.call(n,d))}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__RESEND),b.createElement(mn,{type:Ye.REFRESH,fillColor:sn.PRIMARY,width:"24px",height:"24px"})))},bR=function(n){var t,e,r,i=Bt().stringSet,a=li(),s=a.message,u=a.hideMenu,d=a.deleteMessage,h=a.showRemove,p=a.isOnline,g=a.disableDeleteMessage;return b.createElement(ga,re({},n,{disabled:typeof g=="boolean"?g:((e=(t=s.threadInfo)===null||t===void 0?void 0:t.replyCount)!==null&&e!==void 0?e:0)>0,onClick:function(E){var y;$a(s)?d(s):p&&(h(!0),u(),(y=n.onClick)===null||y===void 0||y.call(n,E))}}),(r=n.children)!==null&&r!==void 0?r:b.createElement(b.Fragment,null,b.createElement(Ge,{type:Be.SUBTITLE_1,color:g?Re.ONBACKGROUND_4:Re.ONBACKGROUND_1},i.MESSAGE_MENU__DELETE),b.createElement(mn,{type:Ye.DELETE,fillColor:sn.PRIMARY,width:"24px",height:"24px"})))},F$=function(n){var t,e=Bt().stringSet,r=li(),i=r.hideMenu,a=r.message,s=r.onDownloadClick,u=a.url;return b.createElement(ga,re({},n,{onClick:function(){i()}}),(t=n.children)!==null&&t!==void 0?t:b.createElement("a",{className:"sendbird-message__contextmenu--hyperlink",rel:"noopener noreferrer",href:u,target:"_blank",onClick:s},b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__SAVE),b.createElement(mn,{type:Ye.DOWNLOAD,fillColor:sn.PRIMARY,width:"24px",height:"24px"})))},H$=function(n){var t,e,r,i,a=n.channel,s=n.message,u=n.replyType,d=n.userId,h=n.resendMessage,p=n.showEdit,g=n.showRemove,E=n.deleteMenuState,y=n.deleteMessage,C=n.setQuoteMessage,T=n.parentRef,A=n.onReplyInThread,O=n.isOpenedFromThread,N=O===void 0?!1:O,k=n.onDownloadClick,D=k===void 0?null:k,P=n.renderMenuItems,U=n.hideMenu,L=((t=s==null?void 0:s.sender)===null||t===void 0?void 0:t.userId)===d,B=Mt().config,q=B.isOnline,z=ha(s),Y=ha(s)&&Nh(s)&&L,Q=$a(s)&&(s==null?void 0:s.isResendable)&&L,$=!As(s)&&L,Z=L&&(E===void 0||E!=="HIDE"),ne=Z&&$,ue=!As(s)&&Xi(s)&&!(ou(s)&&(a!=null&&a.isSuper)||a!=null&&a.isBroadcast),pe=u==="QUOTE_REPLY"&&!$a(s)&&!As(s)&&(a==null?void 0:a.isGroupChannel()),he=u==="THREAD"&&!N&&!$a(s)&&!As(s)&&!mO(s)&&(a==null?void 0:a.isGroupChannel()),le=E!==void 0&&E==="DISABLE"||((r=(e=s==null?void 0:s.threadInfo)===null||e===void 0?void 0:e.replyCount)!==null&&r!==void 0?r:0)>0,we={message:s,hideMenu:U,setQuoteMessage:C,onReplyInThread:A,onMoveToParentMessage:ur,showEdit:p,showRemove:g,deleteMessage:y,resendMessage:h,isOnline:q,disableDeleteMessage:le,triggerRef:T,containerRef:T,onDownloadClick:D};return b.createElement(SC,{value:we},b.createElement(Ac,{className:"sendbird-message__mobile-context-menu",parentRef:T,parentContainRef:T,closeDropdown:U},(i=P==null?void 0:P({items:{CopyMenuItem:mR,ReplyMenuItem:gR,ThreadMenuItem:vR,EditMenuItem:ER,ResendMenuItem:yR,DeleteMenuItem:bR}}))!==null&&i!==void 0?i:b.createElement(b.Fragment,null,z&&b.createElement(mR,null),pe&&b.createElement(gR,null),he&&b.createElement(vR,null),Y&&b.createElement(ER,null),Q&&b.createElement(yR,null),ne&&b.createElement(bR,null),ue&&b.createElement(F$,null))))},CR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu;return b.createElement(cd,re({},n,{onClick:function(s){var u;ha(i)&&yC(i.message),a(),(u=n.onClick)===null||u===void 0||u.call(n,s)}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(mn,{type:Ye.COPY,fillColor:sn.PRIMARY,width:"24px",height:"24px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__COPY)))},IR=function(n){var t,e=Bt().stringSet,r=li(),i=r.hideMenu,a=r.showEdit,s=r.isOnline;return b.createElement(cd,re({},n,{onClick:function(u){var d;s&&(a(!0),i(),(d=n.onClick)===null||d===void 0||d.call(n,u))}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(mn,{type:Ye.EDIT,fillColor:sn.PRIMARY,width:"24px",height:"24px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__EDIT)))},TR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu,s=r.resendMessage,u=r.isOnline;return b.createElement(cd,re({},n,{onClick:function(d){var h;u&&(s(i),a(),(h=n.onClick)===null||h===void 0||h.call(n,d))}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(mn,{type:Ye.REFRESH,fillColor:sn.PRIMARY,width:"24px",height:"24px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__RESEND)))},SR=function(n){var t,e,r,i=Bt().stringSet,a=li(),s=a.message,u=a.hideMenu,d=a.setQuoteMessage;return b.createElement(cd,re({},n,{disabled:s.parentMessageId>0,onClick:function(h){var p;d(s),u(),(p=n.onClick)===null||p===void 0||p.call(n,h)}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(mn,{type:Ye.REPLY,fillColor:((e=s.parentMessageId)!==null&&e!==void 0?e:0)>0?sn.ON_BACKGROUND_3:sn.PRIMARY,width:"24px",height:"24px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:((r=s.parentMessageId)!==null&&r!==void 0?r:0)>0?Re.ONBACKGROUND_4:Re.ONBACKGROUND_1},i.MESSAGE_MENU__REPLY)))},NR=function(n){var t,e=Bt().stringSet,r=li(),i=r.message,a=r.hideMenu,s=r.onReplyInThread;return b.createElement(cd,re({},n,{onClick:function(u){var d;s({message:i}),a(),(d=n.onClick)===null||d===void 0||d.call(n,u)}}),(t=n.children)!==null&&t!==void 0?t:b.createElement(b.Fragment,null,b.createElement(mn,{type:Ye.THREAD,fillColor:sn.PRIMARY,width:"24px",height:"24px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__THREAD)))},AR=function(n){var t,e,r,i=Bt().stringSet,a=li(),s=a.message,u=a.hideMenu,d=a.deleteMessage,h=a.showRemove,p=a.isOnline,g=a.disableDeleteMessage;return b.createElement(cd,re({},n,{disabled:typeof g=="boolean"?g:((e=(t=s.threadInfo)===null||t===void 0?void 0:t.replyCount)!==null&&e!==void 0?e:0)>0,onClick:function(E){var y;$a(s)?d(s):p&&(h(!0),u(),(y=n.onClick)===null||y===void 0||y.call(n,E))}}),(r=n.children)!==null&&r!==void 0?r:b.createElement(b.Fragment,null,b.createElement(mn,{type:Ye.DELETE,fillColor:sn.PRIMARY,width:"24px",height:"24px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:g?Re.ONBACKGROUND_4:Re.ONBACKGROUND_1},i.MESSAGE_MENU__DELETE)))},B$=function(n){var t,e=Bt().stringSet,r=li(),i=r.hideMenu,a=r.message,s=r.onDownloadClick,u=a.url;return b.createElement(cd,{onClick:function(){return i()}},(t=n.children)!==null&&t!==void 0?t:b.createElement("a",{className:"sendbird-message__bottomsheet--hyperlink",rel:"noopener noreferrer",href:u,target:"_blank",onClick:s},b.createElement(mn,{type:Ye.DOWNLOAD,fillColor:sn.PRIMARY,width:"24px",height:"24px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},e.MESSAGE_MENU__SAVE)))},HE=38,G$=function(n){var t,e,r,i,a=n.hideMenu,s=n.channel,u=n.emojiContainer,d=n.message,h=n.replyType,p=n.userId,g=n.resendMessage,E=n.deleteMessage,y=n.toggleReaction,C=n.isReactionEnabled,T=C===void 0?!1:C,A=n.showEdit,O=n.showRemove,N=n.deleteMenuState,k=n.setQuoteMessage,D=n.onReplyInThread,P=n.isOpenedFromThread,U=P===void 0?!1:P,L=n.onDownloadClick,B=n.renderMenuItems,q=((t=d==null?void 0:d.sender)===null||t===void 0?void 0:t.userId)===p,z=Mt().config,Y=z.isOnline,Q=ha(d),$=ha(d)&&Nh(d)&&q,Z=Y&&$a(d)&&(d==null?void 0:d.isResendable)&&q,ne=!As(d)&&q,ue=q&&(N===void 0||N!=="HIDE"),pe=ue&&ne,he=N!==void 0&&N==="DISABLE"||((r=(e=d==null?void 0:d.threadInfo)===null||e===void 0?void 0:e.replyCount)!==null&&r!==void 0?r:0)>0,le=Nh(d)&&Xi(d)&&!ou(d),we=!$a(d)&&!As(d)&&T,ve=h==="QUOTE_REPLY"&&!$a(d)&&!As(d)&&(s==null?void 0:s.isGroupChannel())&&!(s!=null&&s.isBroadcast),Ue=h==="THREAD"&&!U&&!$a(d)&&!As(d)&&!mO(d)&&(s==null?void 0:s.isGroupChannel())&&!(s!=null&&s.isBroadcast),be=Math.floor(window.innerWidth/HE)-1,Qe=F.useState(!1),Ne=Qe[0],$e=Qe[1],gn=u&&bC(u),En=Ne?gn:gn==null?void 0:gn.slice(0,be),Yn=gn&&gn.length>be,Gn={message:d,hideMenu:a,setQuoteMessage:k,onReplyInThread:D,onMoveToParentMessage:function(){},showEdit:A,showRemove:O,deleteMessage:E,resendMessage:g,isOnline:Y,disableDeleteMessage:he,triggerRef:null,containerRef:null,onDownloadClick:L};return b.createElement(SC,{value:Gn},b.createElement(qm,{onBackdropClick:a},b.createElement("div",{className:"sendbird-message__bottomsheet"},we&&b.createElement("div",{className:"sendbird-message__bottomsheet-reactions"},b.createElement("ul",{className:"sendbird-message__bottomsheet-reaction-bar"},b.createElement("div",{className:Rt("sendbird-message__bottomsheet-reaction-bar__row",Ne&&"sendbird-message__bottomsheet-reaction-bar__all")},En.map(function(Tn){var kn,Vn,Hn,Jn=(Hn=(Vn=(kn=d==null?void 0:d.reactions)===null||kn===void 0?void 0:kn.filter(function(jn){return jn.key===Tn.key})[0])===null||Vn===void 0?void 0:Vn.userIds)===null||Hn===void 0?void 0:Hn.some(function(jn){return jn===p});return b.createElement(Oh,{key:Tn.key,width:"".concat(HE,"px"),height:"".concat(HE,"px"),selected:Jn,onClick:function(){a(),y==null||y(d,Tn.key,Jn)},testID:"ui_mobile_emoji_reactions_menu_".concat(Tn.key)},b.createElement(ui,{url:(Tn==null?void 0:Tn.url)||"",width:"28px",height:"28px",placeHolder:function(jn){var On=jn.style;return b.createElement("div",{style:On},b.createElement(mn,{type:Ye.QUESTION,fillColor:sn.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))}),Yn&&!Ne&&b.createElement(Oh,{key:"emoji_more",width:"38px",height:"38px",onClick:function(){return $e(!0)},testID:"ui_mobile_emoji_reactions_menu_emojiadd"},b.createElement(ui,{url:"",width:"28px",height:"28px",placeHolder:function(Tn){var kn=Tn.style;return b.createElement("div",{style:kn},b.createElement(mn,{type:Ye.EMOJI_MORE,fillColor:sn.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))))),!Ne&&b.createElement("div",{className:"sendbird-message__bottomsheet--actions"},(i=B==null?void 0:B({items:{CopyMenuItem:CR,EditMenuItem:IR,ResendMenuItem:TR,ReplyMenuItem:SR,ThreadMenuItem:NR,DeleteMenuItem:AR}}))!==null&&i!==void 0?i:b.createElement(b.Fragment,null,Q&&b.createElement(CR,null),$&&b.createElement(IR,null),Z&&b.createElement(TR,null),ve&&b.createElement(SR,null),Ue&&b.createElement(NR,null),pe&&b.createElement(AR,null),le&&b.createElement(B$,null))))))},V$=function(n){return b.createElement(b.Fragment,null,n!=null&&n.isReactionEnabled?b.createElement(G$,re({},n)):b.createElement(H$,re({},n)))};function j$(n,t){var e,r=n.className,i=n.threadInfo,a=n.onClick,s=i.mostRepliedUsers,u=s===void 0?[]:s,d=i.replyCount,h=Bt().stringSet;return b.createElement("div",{className:"sendbird-ui-thread-replies ".concat(r),role:"button",onClick:function(p){a==null||a(p),p==null||p.stopPropagation()},onKeyDown:function(p){a==null||a(p),p==null||p.stopPropagation()},ref:t},b.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles"},u.slice(0,4).map(function(p){return b.createElement(Na,{key:p.userId,className:"sendbird-ui-thread-replies__user-profiles__avatar",src:p==null?void 0:p.profileUrl,alt:"user profile",width:"20px",height:"20px"})}),(u==null?void 0:u.length)>=5&&b.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar"},b.createElement(Na,{className:"sendbird-ui-thread-replies__user-profiles__avatar__image",src:(e=u==null?void 0:u[4])===null||e===void 0?void 0:e.profileUrl,alt:"user profile",width:"20px",height:"20px"}),b.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar__cover"}),b.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar__plus"},b.createElement(mn,{type:Ye.PLUS,fillColor:sn.WHITE,width:"16px",height:"16px"})))),b.createElement(Ge,{className:"sendbird-ui-thread-replies__reply-counts",type:Be.CAPTION_2,color:Re.PRIMARY},d===1?"".concat(d," ").concat(h.CHANNEL__THREAD_REPLY):"".concat(d>99?h.CHANNEL__THREAD_OVER_MAX:d," ").concat(h.CHANNEL__THREAD_REPLIES)),b.createElement(mn,{className:"sendbird-ui-thread-replies__icon",type:Ye.CHEVRON_RIGHT,fillColor:sn.PRIMARY,width:"16px",height:"16px"}))}var q$=b.forwardRef(j$);function z$(n){var t,e,r,i=n.mentionTemplate,a=n.mentionedUserId,s=n.mentionedUserNickname,u=n.isByMe,d=F.useRef(),h=Mt(),p=(t=h==null?void 0:h.config)===null||t===void 0?void 0:t.userId,g=(r=(e=h==null?void 0:h.stores)===null||e===void 0?void 0:e.sdkStore)===null||r===void 0?void 0:r.sdk,E=p===a,y=F.useState(),C=y[0],T=y[1],A=F.useCallback(function(O){if(C||!(g!=null&&g.createApplicationUserListQuery)){O();return}var N=g==null?void 0:g.createApplicationUserListQuery({userIdsFilter:[a]});N.next().then(function(k){(k==null?void 0:k.length)>0&&T(k[0]),O()})},[g,a]);return b.createElement(wc,{menuTrigger:function(O){return b.createElement("a",{className:Rt("sendbird-word__mention",E&&"sendbird-word__mention--me"),onClick:function(){return A(O)},ref:d,"data-userid":a,"data-nickname":s,"data-sb-mention":!0},b.createElement(Ge,{type:Be.CAPTION_1,color:u?Re.ONCONTENT_1:Re.ONBACKGROUND_1},"".concat(i).concat(s)))},menuItems:function(O){return b.createElement(Ac,{parentRef:d,parentContainRef:d,closeDropdown:O,style:{paddingTop:"0px",paddingBottom:"0px"}},b.createElement(QC,{user:C,onSuccess:O,currentUserId:p}))}})}var K$=/https?:\/\//;function W$(n){var t=n.className,e=t===void 0?"":t,r=n.src,i=n.type,a=n.color,s=n.children,u=K$.test(r)?r:"http://".concat(r);return b.createElement("a",{className:en(en([],Array.isArray(e)?e:[e],!0),["sendbird-link-label",OO(a)],!1).join(" "),href:u,target:"_blank",rel:"noopener noreferrer",onTouchEnd:function(d){d.preventDefault(),d.nativeEvent.stopImmediatePropagation(),CC(u)}},b.createElement(Ge,{className:"sendbird-link-label__label",testID:"sendbird-link-label__label",type:i,color:a},s))}function $$(n,t,e){return"sb-msg_".concat(n,"_").concat(t,"_").concat(e)}function Y$(n){var t=decodeURIComponent(n);try{var e=new URL(t).protocol;return["https:","http:"].some(function(r){return r===e.toLowerCase()})?t:"#"}catch{!t.startsWith("http://")&&!t.startsWith("https://")&&(t="https://"+t)}return t}function Im(n){var t=n.tokens,e=zk(),r=e==null?void 0:e.message,i=e==null?void 0:e.isByMe,a=r.updatedAt,s=r.createdAt;return b.createElement(b.Fragment,null,t==null?void 0:t.map(function(u,d){var h=$$(s,a,d);return Mi(u.type).with(Qr.markdown,function(){var p=u,g=p.groups;return b.createElement("span",{className:"sendbird-word",key:h,"data-testid":"sendbird-ui-word"},Mi(p.markdownType).with("bold",function(){return b.createElement("span",{style:{fontWeight:"bold"}},b.createElement(Im,{tokens:Vb({messageText:g[1]})}))}).with("url",function(){return b.createElement("a",{className:i?"sendbird-label--color-oncontent-1":"sendbird-label--color-onbackground-1",href:Y$(g[2])},b.createElement(Im,{tokens:Vb({messageText:g[1]})}))}).otherwise(function(){return b.createElement(b.Fragment,null)}))}).with(Qr.mention,function(){return b.createElement("span",{className:"sendbird-word",key:h,"data-testid":"sendbird-ui-word"},b.createElement(z$,{mentionTemplate:qh,mentionedUserId:u.userId,mentionedUserNickname:u.value,isByMe:i}))}).with(Qr.url,function(){return b.createElement("span",{className:"sendbird-word",key:h,"data-testid":"sendbird-ui-word"},b.createElement(W$,{src:u.value,type:Be.BODY_1,color:i?Re.ONCONTENT_1:Re.ONBACKGROUND_1},u.value))}).otherwise(function(){return b.createElement(b.Fragment,{key:h},QW(u.value))})}))}function Q$(n){var t,e,r,i,a=n.className,s=n.message,u=n.isByMe,d=u===void 0?!1:u,h=n.mouseHover,p=h===void 0?!1:h,g=n.isMentionEnabled,E=g===void 0?!1:g,y=n.isReactionEnabled,C=y===void 0?!1:y,T=n.isMarkdownEnabled,A=T===void 0?!1:T,O=n.onMessageHeightChange,N=O===void 0?function(){}:O,k=F.useContext(kr).stringSet,D=E&&((t=s==null?void 0:s.mentionedMessageTemplate)===null||t===void 0?void 0:t.length)>0&&(s==null?void 0:s.mentionedUsers)&&((e=s==null?void 0:s.mentionedUsers)===null||e===void 0?void 0:e.length)>0,P=F.useMemo(function(){var L;return Mh(D?{mentionedUsers:(L=s==null?void 0:s.mentionedUsers)!==null&&L!==void 0?L:void 0,messageText:s==null?void 0:s.mentionedMessageTemplate,includeMarkdown:A}:{messageText:s==null?void 0:s.message,includeMarkdown:A})},[s==null?void 0:s.updatedAt,s==null?void 0:s.message]),U=function(){var L;return CC((L=s==null?void 0:s.ogMetaData)===null||L===void 0?void 0:L.url)};return b.createElement("div",{className:ma([a??"","sendbird-og-message-item-body",d?"outgoing":"incoming",p?"mouse-hover":"",C&&((r=s==null?void 0:s.reactions)===null||r===void 0?void 0:r.length)>0?"reactions":""])},b.createElement(Ge,{type:Be.BODY_1,color:d?Re.ONCONTENT_1:Re.ONBACKGROUND_1},b.createElement("div",{className:Mk},b.createElement(Im,{tokens:P}),CO(s)&&b.createElement(Ge,{className:"sendbird-og-message-item-body__text-bubble__message",type:Be.BODY_1,color:d?Re.ONCONTENT_2:Re.ONBACKGROUND_2}," ".concat(k.MESSAGE_EDITED," ")))),((i=s.ogMetaData)===null||i===void 0?void 0:i.defaultImage)&&b.createElement(Z$,{onClick:U,ogImage:s.ogMetaData.defaultImage,onMessageHeightChange:N}),s.ogMetaData&&b.createElement(X$,{onClick:U,ogMetaData:s.ogMetaData,onMessageHeightChange:N}),b.createElement("div",{className:"sendbird-og-message-item-body__cover"}))}var Z$=function(n){var t=n.onClick,e=n.ogImage,r=n.onMessageHeightChange,i=F.useRef(null),a=Zi().isMobile;return b.createElement("div",{ref:i,className:Rt("sendbird-og-message-item-body__og-thumbnail",!e.url&&"sendbird-og-message-item-body__og-thumbnail__empty"),onClick:function(){return t()}},b.createElement(ui,{className:"sendbird-og-message-item-body__og-thumbnail__image",url:e.url||"",alt:e.alt||"",width:"100%",height:a?"136px":"240px",onLoad:r,onError:function(){var s,u;try{(u=(s=i==null?void 0:i.current)===null||s===void 0?void 0:s.classList)===null||u===void 0||u.add("sendbird-og-message-item-body__og-thumbnail__empty")}catch{}},defaultComponent:b.createElement("div",{className:"sendbird-og-message-item-body__og-thumbnail__place-holder"},b.createElement(mn,{className:"sendbird-og-message-item-body__og-thumbnail__place-holder__icon",type:Ye.THUMBNAIL_NONE,width:"56px",height:"56px"}))}))},X$=function(n){var t=n.onClick,e=n.ogMetaData,r=n.onMessageHeightChange;return F.useEffect(function(){r()},[e.title,e.description,e.url]),b.createElement("div",{className:"sendbird-og-message-item-body__description",onClick:function(){return t()}},e.title&&b.createElement(Ge,{className:"sendbird-og-message-item-body__description__title",type:Be.SUBTITLE_2,color:Re.ONBACKGROUND_1},e.title),e.description&&b.createElement(Ge,{className:"sendbird-og-message-item-body__description__description",type:Be.BODY_2,color:Re.ONBACKGROUND_1},e.description),e.url&&b.createElement(Ge,{className:"sendbird-og-message-item-body__description__url",type:Be.CAPTION_3,color:Re.ONBACKGROUND_2},e.url))};function J$(n){var t,e=n.className,r=e===void 0?"":e,i=n.message,a=n.isByMe,s=a===void 0?!1:a,u=n.mouseHover,d=u===void 0?!1:u,h=n.isMentionEnabled,p=h===void 0?!1:h,g=n.isReactionEnabled,E=g===void 0?!1:g,y=n.isMarkdownEnabled,C=y===void 0?!1:y,T=F.useContext(kr).stringSet,A=p&&(i==null?void 0:i.mentionedMessageTemplate)&&i.mentionedMessageTemplate.length>0&&(i==null?void 0:i.mentionedUsers)&&i.mentionedUsers.length>0,O=F.useMemo(function(){var N;return Mh(A?{mentionedUsers:(N=i==null?void 0:i.mentionedUsers)!==null&&N!==void 0?N:void 0,messageText:i==null?void 0:i.mentionedMessageTemplate,includeMarkdown:C}:{messageText:i==null?void 0:i.message,includeMarkdown:C})},[i==null?void 0:i.updatedAt,i==null?void 0:i.message]);return b.createElement(Ge,{type:Be.BODY_1,color:s?Re.ONCONTENT_1:Re.ONBACKGROUND_1},b.createElement("div",{className:ma([r,KC,s?"outgoing":"incoming",d?"mouse-hover":"",E&&((t=i==null?void 0:i.reactions)===null||t===void 0?void 0:t.length)>0?"reactions":""])},b.createElement(Im,{tokens:O}),CO(i)&&b.createElement(Ge,{className:"sendbird-text-message-item-body__message edited",type:Be.BODY_1,color:s?Re.ONCONTENT_2:Re.ONBACKGROUND_2}," ".concat(T.MESSAGE_EDITED," "))))}function eY(n){var t=this,e,r,i,a=n.className,s=a===void 0?"":a,u=n.message,d=n.isByMe,h=d===void 0?!1:d,p=n.mouseHover,g=p===void 0?!1:p,E=n.isReactionEnabled,y=E===void 0?!1:E,C=n.truncateLimit,T=n.onBeforeDownloadFileMessage,A=null;try{A=(r=(e=Mt())===null||e===void 0?void 0:e.config)===null||r===void 0?void 0:r.logger}catch{}var O=Zi().isMobile,N=C??(O?20:void 0),k=function(){return CC(u==null?void 0:u.url)},D=T?function(){return Ar(t,void 0,void 0,function(){var P,U,L,B;return wr(this,function(q){switch(q.label){case 0:return q.trys.push([0,2,,3]),[4,T({message:u})];case 1:return P=q.sent(),P?k():(L=A==null?void 0:A.info)===null||L===void 0||L.call(A,"FileMessageItemBody: Not allowed to download."),[3,3];case 2:return U=q.sent(),(B=A==null?void 0:A.error)===null||B===void 0||B.call(A,"FileMessageItemBody: Error occurred while determining download continuation:",U),[3,3];case 3:return[2]}})})}:k;return b.createElement("div",{className:ma([s,"sendbird-file-message-item-body",h?"outgoing":"incoming",g?"mouse-hover":"",y&&((i=u==null?void 0:u.reactions)===null||i===void 0?void 0:i.length)>0?"reactions":""])},b.createElement("div",{className:"sendbird-file-message-item-body__file-icon"},b.createElement(mn,{className:"sendbird-file-message-item-body__file-icon__icon",type:{IMAGE:Ye.PHOTO,VIDEO:Ye.PLAY,AUDIO:Ye.FILE_AUDIO,GIF:Ye.GIF,OTHERS:Ye.FILE_DOCUMENT}[pO(u==null?void 0:u.type)],fillColor:sn.PRIMARY,width:"24px",height:"24px"})),b.createElement(jh,{className:"sendbird-file-message-item-body__file-name",onClick:D,color:h?Ga.ONCONTENT_1:Ga.ONBACKGROUND_1},b.createElement(Ge,{className:"sendbird-file-message-item-body__file-name__text",testID:"sendbird-file-message-item-body__file-name__text",type:Be.BODY_1,color:h?Re.ONCONTENT_1:Re.ONBACKGROUND_1},SO((u==null?void 0:u.name)||(u==null?void 0:u.url),N))))}function ZC(n,t){F.useLayoutEffect(function(){var r;(r=n.current)===null||r===void 0||r.focus()},[n.current]);var e=Ph(function(r){var i=t[r.key];i==null||i(r),r.stopPropagation()});return e}var zh={SINGLE:"SINGLE",MULTI:"MULTI"};function nY(n){var t=n.props;if(t.viewerType===zh.MULTI){var e=t,r=e.fileInfoList,i=e.currentIndex;return r[i]}var a=t;return{name:a.name,type:a.type,url:a.url}}function tY(n){if(n.viewerType!==zh.MULTI){var t=n.onDelete,e=n.isByMe,r=n.disableDelete,i=n.className;return e?b.createElement("div",{className:"sendbird-fileviewer__header__right__actions__delete ".concat(i)},b.createElement(mn,{className:r?"disabled":"",type:Ye.DELETE,fillColor:r?sn.GRAY:sn.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(a){r||t==null||t(a)}})):b.createElement(b.Fragment,null)}return b.createElement(b.Fragment,null)}function rY(n){if(n.viewerType===zh.MULTI){var t=n.onClickLeft,e=n.onClickRight;return b.createElement("div",{className:"sendbird-file-viewer-slider"},b.createElement("div",{className:"sendbird-file-viewer-arrow--left"},b.createElement(mn,{type:Ye.SLIDE_LEFT,fillColor:sn.ON_BACKGROUND_1,height:o_,width:o_,onClick:function(r){t==null||t(),r.stopPropagation()}})),b.createElement("div",{className:"sendbird-file-viewer-arrow--right"},b.createElement(mn,{type:Ye.SLIDE_LEFT,fillColor:sn.ON_BACKGROUND_1,height:o_,width:o_,onClick:function(r){r.stopPropagation(),e==null||e()}})))}return b.createElement(b.Fragment,null)}var wR=function(n){var t=n.profileUrl,e=n.nickname,r=n.onClose,i=n.onDownloadClick,a=n,s=a.onClickLeft,u=a.onClickRight,d=F.useRef(null),h=ZC(d,{Escape:function(T){return r==null?void 0:r(T)},ArrowLeft:function(){return s==null?void 0:s()},ArrowRight:function(){return u==null?void 0:u()}}),p=nY({props:n}),g=p.name,E=p.type,y=p.url,C=F.useContext(kr).stringSet;return b.createElement(Za,{onClose:r},b.createElement("div",{className:"sendbird-fileviewer","data-testid":"sendbird-fileviewer",onKeyDown:h,tabIndex:1,ref:d},b.createElement("div",{className:"sendbird-fileviewer__header"},b.createElement("div",{className:"sendbird-fileviewer__header__left"},b.createElement("div",{className:"sendbird-fileviewer__header__left__avatar"},b.createElement(Na,{height:"32px",width:"32px",src:t})),b.createElement("div",{className:"sendbird-fileviewer__header__left__text-container"},b.createElement(Ge,{className:"sendbird-fileviewer__header__left__filename",type:Be.H_2,color:Re.ONBACKGROUND_1},g),b.createElement(Ge,{className:"sendbird-fileviewer__header__left__sender-name",type:Be.BODY_1,color:Re.ONBACKGROUND_2},e))),b.createElement("div",{className:"sendbird-fileviewer__header__right"},Sh(E)&&b.createElement("div",{className:"sendbird-fileviewer__header__right__actions"},b.createElement("a",{className:"sendbird-fileviewer__header__right__actions__download",rel:"noopener noreferrer",href:y,target:"_blank",onClick:i},b.createElement(mn,{type:Ye.DOWNLOAD,fillColor:sn.ON_BACKGROUND_1,height:"24px",width:"24px"})),b.createElement(tY,re({className:"sendbird-fileviewer__header__right__actions__delete"},n))),b.createElement("div",{className:"sendbird-fileviewer__header__right__actions__close"},b.createElement(mn,{type:Ye.CLOSE,fillColor:sn.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(T){return r==null?void 0:r(T)}})))),b.createElement("div",{className:"sendbird-fileviewer__content"},Ho(E)&&b.createElement("video",{controls:!0,className:"sendbird-fileviewer__content__video"},b.createElement("source",{src:y,type:E})),zu(E)&&b.createElement("img",{src:y,alt:g,className:n.viewerType===zh.MULTI?"sendbird-fileviewer__content__img__multi":"sendbird-fileviewer__content__img"}),!Sh(E)&&b.createElement("div",{className:"sendbird-fileviewer__content__unsupported"},b.createElement(Ge,{type:Be.H_1,color:Re.ONBACKGROUND_1},(C==null?void 0:C.UI__FILE_VIEWER__UNSUPPORT)||"Unsupported message")),b.createElement(rY,re({},n)))))};function iY(n){var t,e,r,i=n.message,a=n.statefulFileInfoList,s=a===void 0?[]:a,u=n.onClose,d=n.isByMe,h=d===void 0?!1:d,p=n.onDelete,g=n.currentIndex,E=n.onClickLeft,y=n.onClickRight,C=n.onDownloadClick;if(ca(i)){var T=i;return b.createElement(wR,{profileUrl:T.sender.profileUrl,nickname:T.sender.nickname,viewerType:zh.MULTI,fileInfoList:s.filter(function(A){return A.url}).map(function(A){return{name:A.fileName||"",type:A.mimeType||"",url:A.url||""}}),currentIndex:g||0,onClickLeft:E||ur,onClickRight:y||ur,onClose:u,onDownloadClick:C})}else if(Xi(i)){var T=i;return Tc.createPortal(b.createElement(wR,{profileUrl:(t=T.sender)===null||t===void 0?void 0:t.profileUrl,nickname:(e=T.sender)===null||e===void 0?void 0:e.nickname,name:T.name,type:T.type,url:T==null?void 0:T.url,isByMe:h,disableDelete:(((r=T.threadInfo)===null||r===void 0?void 0:r.replyCount)||0)>0,onClose:u,onDelete:p||ur,onDownloadClick:C}),document.getElementById(td))}return b.createElement(b.Fragment,null)}function aY(n){var t,e=n.children,r=n.className,i=n.message,a=n.isReactionEnabled;return b.createElement("div",{className:"sendbird-image-grid-wrap"},b.createElement("div",{className:ma([r??"","sendbird-image-grid",a&&((t=i==null?void 0:i.reactions)===null||t===void 0?void 0:t.length)>0?"reactions":""])},e))}var sY=400,BE=8,rc=4,uY=54,f_=40,oY=48,lY=320,RR=28,MR=12,dY=200,cY=8,fY=32,hY=60,GE={CHAT_WEB:"calc(".concat(sY/2,"px - ").concat((BE+rc)/2,"px)"),CHAT_MOBILE:"calc(50vw - ".concat((oY+f_+uY+BE+rc)/2,"px)"),THREAD_PARENT_WEB:"calc(".concat((lY-(RR+f_+MR+rc))/2,"px)"),THREAD_PARENT_MOBILE:"calc(50vw - ".concat((RR+f_+MR+rc)/2,"px)"),THREAD_CHILD_WEB:"calc(".concat((dY-cY-rc)/2,"px)"),THREAD_CHILD_MOBILE:"calc(50vw - ".concat((fY+f_+hY+BE+rc)/2,"px)")},pY={CHAT_WEB:"6px",CHAT_MOBILE:"6px",THREAD_PARENT_WEB:"6px",THREAD_PARENT_MOBILE:"6px",THREAD_CHILD_WEB:"6px",THREAD_CHILD_MOBILE:"6px"},ic="34px",OR={PARENT:"parent",CHILD:"child"};function _Y(n){var t=this,e,r,i=n.className,a=n.message,s=n.isReactionEnabled,u=s===void 0?!1:s,d=n.threadMessageKindKey,h=n.statefulFileInfoList,p=h===void 0?[]:h,g=n.onBeforeDownloadFileMessage,E=g===void 0?null:g,y=(r=(e=Mt==null?void 0:Mt())===null||e===void 0?void 0:e.config)===null||r===void 0?void 0:r.logger,C=F.useState(-1),T=C[0],A=C[1];function O(){A(-1)}function N(){A(T===0?p.length-1:T-1)}function k(){A(T===p.length-1?0:T+1)}return d?b.createElement(b.Fragment,null,T>-1&&b.createElement(iY,{message:a,statefulFileInfoList:p,currentIndex:T,onClickLeft:N,onClickRight:k,onClose:O,onDownloadClick:function(D){return Ar(t,void 0,void 0,function(){var P,U,L,B;return wr(this,function(q){switch(q.label){case 0:if(!E)return[2];q.label=1;case 1:return q.trys.push([1,3,,4]),[4,E({message:a,index:T})];case 2:return P=q.sent(),P||(D.preventDefault(),(L=y==null?void 0:y.info)===null||L===void 0||L.call(y,"MultipleFilesMessageItemBody: Not allowed to download.")),[3,4];case 3:return U=q.sent(),(B=y==null?void 0:y.error)===null||B===void 0||B.call(y,"MultipleFilesMessageItemBody: Error occurred while determining download continuation:",U),[3,4];case 4:return[2]}})})}}),b.createElement(aY,{className:i,message:a,isReactionEnabled:u},p.map(function(D,P){var U,L,B,q;return b.createElement("div",{className:"sendbird-multiple-files-image-renderer-wrapper",onClick:a.sendingStatus===jt.SUCCEEDED?function(){return A(P)}:void 0,key:"sendbird-multiple-files-image-renderer-".concat(P,"-").concat(D.url)},b.createElement(ui,{url:(q=(B=(L=(U=D.thumbnails)===null||U===void 0?void 0:U[0])===null||L===void 0?void 0:L.url)!==null&&B!==void 0?B:D.url)!==null&&q!==void 0?q:"",fixedSize:!1,width:GE[d],maxSideLength:GE.CHAT_WEB,height:GE[d],borderRadius:tW(pY[d],P,p.length),shadeOnHover:!0,isUploaded:!!D.isUploaded,placeHolder:function(z){var Y=z.style;return D.mimeType&&ld(D.mimeType)?b.createElement(VE.GIF,{style:Y}):b.createElement(VE.Default,{style:Y})},defaultComponent:b.createElement(VE.LoadError,null)}))}))):b.createElement(b.Fragment,null)}var VE={Default:function(n){var t=n.style;return b.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder",style:t},b.createElement(mn,{type:Ye.PHOTO,fillColor:sn.ON_BACKGROUND_2,width:ic,height:ic}))},GIF:function(n){var t=n.style;return b.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder",style:t},b.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder__icon"},b.createElement(mn,{type:Ye.GIF,fillColor:sn.THUMBNAIL_ICON,width:ic,height:ic})))},LoadError:function(){return b.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder"},b.createElement(mn,{type:Ye.THUMBNAIL_NONE,fillColor:sn.ON_BACKGROUND_2,width:ic,height:ic}))}};function mY(n){var t=n.threadMessageKind,e=n.isMobile,r=F.useMemo(function(){return Mi(t).with(OR.PARENT,function(){return e?"THREAD_PARENT_MOBILE":"THREAD_PARENT_WEB"}).with(OR.CHILD,function(){return e?"THREAD_CHILD_MOBILE":"THREAD_CHILD_WEB"}).otherwise(function(){return e?"CHAT_MOBILE":"CHAT_WEB"})},[e,t]);return r}var gY=function(n){var t,e,r=F.useRef(new Map),i=function(s,u){return!r.current.has(s)&&u&&r.current.set(s,URL.createObjectURL(u)),r.current.get(s)},a=function(){r.current.size>0&&(r.current.forEach(function(s){return URL.revokeObjectURL(s)}),r.current.clear())};return F.useEffect(function(){return function(){return a()}},[]),!n||!n.isMultipleFilesMessage||!n.isMultipleFilesMessage()?[]:n.sendingStatus===jt.SUCCEEDED?(a(),n.fileInfoList.map(function(s){var u,d;return re(re({},s),{url:s.url,isUploaded:!0,mimeType:(u=s.mimeType)!==null&&u!==void 0?u:void 0,fileName:(d=s.fileName)!==null&&d!==void 0?d:void 0})})):(e=(t=n==null?void 0:n.messageParams)===null||t===void 0?void 0:t.fileInfoList.map(function(s,u){var d,h;return re(re({},s),{url:(h=(d=i(u))!==null&&d!==void 0?d:s.fileUrl)!==null&&h!==void 0?h:s.file instanceof Blob?i(u,s.file):void 0,isUploaded:!s.file&&typeof s.fileUrl=="string"&&s.fileUrl.length>0})}))!==null&&e!==void 0?e:[]},jb={PRIMARY:"progress-bar-color--primary",GRAY:"progress-bar-color--gray"},$k=function(n){var t=n.className,e=t===void 0?"":t,r=n.disabled,i=r===void 0?!1:r,a=n.maxSize,s=n.currentSize,u=s===void 0?0:s,d=n.colorType,h=d===void 0?jb.PRIMARY:d,p=F.useMemo(function(){return"".concat(u/a*100,"%")},[u,a]);return b.createElement("div",{className:Rt("sendbird-progress-bar",e,h,i&&"progress-bar--disabled")},b.createElement("div",{className:"sendbird-progress-bar__fill",style:{width:p}}))},Yk=function(n){var t,e=n.key,r=e===void 0?"":e,i=n.channelUrl,a=i===void 0?"":i,s=n.audioFile,u=n.audioFileUrl,d=u===void 0?"":u,h=n.audioFileMimeType,p=h===void 0?$l:h,g=yz(a,r),E=Tz(),y=E.play,C=E.pause,T=E.stop,A=E.voicePlayerStore,O=XO().isRecordable,N=((t=A==null?void 0:A.audioStorage)===null||t===void 0?void 0:t[g])||xl(),k=function(){O||y==null||y({groupKey:g,audioFile:s,audioFileUrl:d,audioFileMimeType:p})},D=function(){C==null||C(g)},P=function(U){U===void 0&&(U=""),T==null||T(U)};return F.useEffect(function(){return function(){var U;if(s||d){var L=document.getElementById(Iy);(U=L==null?void 0:L.pause)===null||U===void 0||U.call(L)}}},[]),{play:k,pause:D,stop:P,playbackTime:((N==null?void 0:N.playbackTime)||0)*1e3,duration:((N==null?void 0:N.duration)||0)*1e3,playingStatus:N.playingStatus}},Qk=function(n){var t=n.className,e=n.time,r=e===void 0?0:e,i=n.labelType,a=i===void 0?Be.CAPTION_2:i,s=n.labelColor,u=s===void 0?Re.ONCONTENT_1:s,d=r<0?0:r,h=Math.floor(d/36e5),p=Math.floor(d%36e5/6e4),g=Math.floor(d%36e5%6e4/1e3);return b.createElement("div",{className:"sendbird-ui-play-time ".concat(t)},b.createElement(Ge,{type:a,color:u},"".concat(h?h+":":"").concat(p<10?"0":"").concat(p||"0",":").concat(g<10?"0":"").concat(g)))},vY=function(n){var t,e=n.className,r=n.message,i=n.channelUrl,a=n.isByMe,s=a===void 0?!1:a,u=n.isReactionEnabled,d=u===void 0?!1:u,h=F.useState(!1),p=h[0],g=h[1],E=Yk({channelUrl:i,key:"".concat(r==null?void 0:r.messageId),audioFileUrl:r==null?void 0:r.url,audioFileMimeType:r==null?void 0:r.type}),y=E.play,C=E.pause,T=E.playbackTime,A=T===void 0?0:T,O=E.duration,N=E.playingStatus,k=N===void 0?Ns.IDLE:N;F.useEffect(function(){var P;d&&((P=r==null?void 0:r.reactions)===null||P===void 0?void 0:P.length)>0?g(!0):g(!1)},[d,(t=r==null?void 0:r.reactions)===null||t===void 0?void 0:t.length]);var D=F.useMemo(function(){var P,U=1;if(r!=null&&r.metaArrays){var L=(P=r==null?void 0:r.metaArrays.find(function(B){return B.key==="KEY_VOICE_MESSAGE_DURATION"}))===null||P===void 0?void 0:P.value[0];return L?parseInt(L):U}return U},[r==null?void 0:r.metaArrays]);return b.createElement("div",{className:Rt("sendbird-voice-message-item-body",e,p&&"is-reactions-contained")},b.createElement($k,{className:"sendbird-voice-message-item-body__progress-bar",maxSize:O||D,currentSize:A,colorType:s?jb.PRIMARY:jb.GRAY}),b.createElement("div",{className:"sendbird-voice-message-item-body__status-button"},(k===Ns.IDLE||k===Ns.PAUSED)&&b.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button",onClick:y},b.createElement(mn,{width:"18px",height:"18px",type:Ye.PLAY,fillColor:sn.PRIMARY})),k===Ns.PREPARING&&b.createElement(jm,{width:"22.2px",height:"22.2px"},b.createElement(mn,{width:"22.2px",height:"22.2px",type:Ye.SPINNER,fillColor:sn.PRIMARY_2})),k===Ns.PLAYING&&b.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button",onClick:function(){C()}},b.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause"},b.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause__inner"}),b.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause__inner"})))),b.createElement(Qk,{className:"sendbird-voice-message-item-body__playback-time",time:D-A,labelType:Be.BODY_1,labelColor:s?Re.ONCONTENT_1:Re.ONBACKGROUND_1}))};function EY(n){var t,e,r=n.className,i=r===void 0?"":r,a=n.message,s=n.isByMe,u=s===void 0?!1:s,d=n.mouseHover,h=d===void 0?!1:d,p=n.isReactionEnabled,g=p===void 0?!1:p,E=n.showFileViewer,y=E===void 0?ur:E,C=n.style,T=C===void 0?{}:C,A=Wk(a),O=F.useState(!1),N=O[0],k=O[1],D=Rc({onLongPress:ur,onClick:function(){Nh(a)&&(y==null||y(!0))}});return b.createElement("div",re({className:ma([i,"sendbird-thumbnail-message-item-body",u?"outgoing":"incoming",h?"mouse-hover":"",g&&((e=(t=a.reactions)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0)>0?"reactions":""])},D),b.createElement(ui,{className:"sendbird-thumbnail-message-item-body__thumbnail",url:A||Cm(a),alt:bm(a),width:(T==null?void 0:T.width)||"360px",height:(T==null?void 0:T.height)||"270px",onLoad:function(){k(!0)},placeHolder:function(P){var U=P.style;return b.createElement("div",{className:"sendbird-thumbnail-message-item-body__placeholder",style:U})}}),hc(a)&&!A&&!N&&b.createElement("video",{className:"sendbird-thumbnail-message-item-body__video"},b.createElement("source",{src:Cm(a),type:bm(a)})),b.createElement("div",{className:"sendbird-thumbnail-message-item-body__image-cover"}),(hc(a)||Ny(a))&&b.createElement("div",{className:"sendbird-thumbnail-message-item-body__icon-wrapper"},b.createElement("div",{className:"sendbird-thumbnail-message-item-body__icon-wrapper__icon"},b.createElement(mn,{type:hc(a)?Ye.PLAY:Ye.GIF,fillColor:sn.THUMBNAIL_ICON,width:"34px",height:"34px"}))))}function yY(n){var t,e=n.className,r=n.message,i=n.isByMe,a=i===void 0?!1:i,s=n.mouseHover,u=s===void 0?!1:s,d=n.isReactionEnabled,h=d===void 0?!1:d,p=F.useContext(kr).stringSet;return b.createElement("div",{className:ma([e??"","sendbird-unknown-message-item-body",a?"outgoing":"incoming",u?"mouse-hover":"",h&&((t=r==null?void 0:r.reactions)===null||t===void 0?void 0:t.length)>0?"reactions":""])},b.createElement(Ge,{className:"sendbird-unknown-message-item-body__header",type:Be.BODY_1,color:a?Re.ONCONTENT_1:Re.ONBACKGROUND_1},p.UNKNOWN__UNKNOWN_MESSAGE_TYPE),b.createElement(Ge,{className:"sendbird-unknown-message-item-body__description",type:Be.BODY_1,color:a?Re.ONCONTENT_2:Re.ONBACKGROUND_2},p.UNKNOWN__CANNOT_READ_MESSAGE))}var hn;(function(n){n.Box="box",n.Text="text",n.Image="image",n.TextButton="textButton",n.ImageButton="imageButton",n.Carousel="carouselView"})(hn||(hn={}));const Tm=(n,t)=>typeof t[n]!="string"?{}:{[n]:bY(t[n])};function bY(n){return n.startsWith("#")?n.length===9?`#${n.slice(3)}${n[1]}${n[2]}`:n.length===5?`#${n.slice(2)}${n[1]}`:n:n}const jE=n=>n?{viewStyle:Object.assign(Object.assign(Object.assign({},n),Tm("backgroundColor",n)),Tm("borderColor",n))}:{},CY=n=>n?{textStyle:Object.assign(Object.assign({},n),Tm("color",n))}:{},IY=n=>n?{imageStyle:Object.assign(Object.assign({},n),Tm("tintColor",n))}:{},TY={run(n){return n.type===hn.Text||n.type===hn.TextButton?Object.assign(Object.assign(Object.assign({},n),jE(n.viewStyle)),CY(n.textStyle)):n.type===hn.ImageButton||n.type===hn.Image?Object.assign(Object.assign(Object.assign({},n),jE(n.viewStyle)),IY(n.imageStyle)):Object.assign(Object.assign({},n),jE(n.viewStyle))}},No=n=>typeof n=="string"?!Number.isNaN(Number(n)):typeof n=="number"&&!Number.isNaN(n),Ic=(n,t)=>t[n]===void 0||t[n]===null?{}:No(t[n])?{[n]:Number(t[n])}:{},kR=(n,t)=>t?{[n]:{left:No(t.left)?Number(t.left):t.left,right:No(t.right)?Number(t.right):t.right,top:No(t.top)?Number(t.top):t.top,bottom:No(t.bottom)?Number(t.bottom):t.bottom}}:{},DR=(n,t)=>t?{[n]:{type:t.type,value:No(t.value)?Number(t.value):t.value}}:{},SY=n=>n?{metaData:{pixelWidth:No(n.pixelWidth)?Number(n.pixelWidth):n.pixelWidth,pixelHeight:No(n.pixelHeight)?Number(n.pixelHeight):n.pixelHeight}}:{},NY=n=>n?{viewStyle:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),Ic("borderWidth",n)),Ic("radius",n)),kR("margin",n.margin)),kR("padding",n.padding))}:{},AY=n=>n?{textStyle:Object.assign(Object.assign(Object.assign({},n),Ic("size",n)),Ic("weight",n))}:{},wY=n=>n?{carouselStyle:Object.assign(Object.assign({},n),Ic("spacing",n))}:{},Km=n=>Object.assign(Object.assign(Object.assign({},DR("width",n.width)),DR("height",n.height)),NY(n.viewStyle)),RY=n=>Object.assign(Object.assign(Object.assign({},Km(n)),AY(n.textStyle)),Ic("maxTextLines",n)),MY=n=>Object.assign(Object.assign({},Km(n)),SY(n.metaData)),OY=n=>Object.assign(Object.assign(Object.assign({},Km(n)),wY(n.carouselStyle)),{items:n.items.map(t=>Object.assign(Object.assign({},t),{body:Object.assign(Object.assign({},t.body),{items:t.body.items.map(e=>Zk.run(e))})}))}),Zk={run(n){return n.type===hn.Text||n.type===hn.TextButton?Object.assign(Object.assign({},n),RY(n)):n.type===hn.ImageButton||n.type===hn.Image?Object.assign(Object.assign({},n),MY(n)):n.type===hn.Carousel?Object.assign(Object.assign({},n),OY(n)):Object.assign(Object.assign({},n),Km(n))}},kY=()=>{},Xk=n=>{var t;const e=(n==null?void 0:n.defaultMapper)||kY,r={defaultMapper:e,mapBoxProps:(n==null?void 0:n.mapBoxProps)||e,mapTextProps:(n==null?void 0:n.mapTextProps)||e,mapImageProps:(n==null?void 0:n.mapImageProps)||e,mapTextButtonProps:(n==null?void 0:n.mapTextButtonProps)||e,mapImageButtonProps:(n==null?void 0:n.mapImageButtonProps)||e,mapCarouselProps:(n==null?void 0:n.mapCarouselProps)||e},i=[TY,Zk,...(t=n==null?void 0:n.transforms)!==null&&t!==void 0?t:[]],a=new Set;return{setTransforms(s){i.length=0,i.push(...s),a.clear()},addTransforms(s){i.push(...s)},parse(s,u){const d=i.reduce((h,p)=>p.run(h),s);switch(d.type){case hn.Box:return{transformed:d,properties:r.mapBoxProps(d,u)};case hn.Text:return{transformed:d,properties:r.mapTextProps(d,u)};case hn.Image:return{transformed:d,properties:r.mapImageProps(d,u)};case hn.TextButton:return{transformed:d,properties:r.mapTextButtonProps(d,u)};case hn.ImageButton:return{transformed:d,properties:r.mapImageButtonProps(d,u)};case hn.Carousel:return{transformed:d,properties:r.mapCarouselProps(d,u)};default:return{transformed:d,properties:void 0}}}}},ac=({children:n})=>b.createElement(b.Fragment,null,n);function Jk(n){var t,e,r,i,a,s;return{box:((t=n==null?void 0:n.views)===null||t===void 0?void 0:t.box)||ac,text:((e=n==null?void 0:n.views)===null||e===void 0?void 0:e.text)||ac,image:((r=n==null?void 0:n.views)===null||r===void 0?void 0:r.image)||ac,imageButton:((i=n==null?void 0:n.views)===null||i===void 0?void 0:i.imageButton)||ac,textButton:((a=n==null?void 0:n.views)===null||a===void 0?void 0:a.textButton)||ac,carouselView:((s=n==null?void 0:n.views)===null||s===void 0?void 0:s.carouselView)||ac}}var DY=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const eD=F.createContext({sizes:{},updateSize:()=>{}}),LY=({children:n})=>{const[t,e]=F.useState({}),r=F.useCallback(i=>{var{id:a}=i,s=DY(i,["id"]);a&&e(u=>Object.assign(Object.assign({},u),{[a]:s}))},[]);return b.createElement(eD.Provider,{value:{sizes:t,updateSize:r}},n)},xY=()=>F.useContext(eD);var er;(function(n){n.Row="row",n.Column="column"})(er||(er={}));var lr;(function(n){n.Center="center",n.Left="left",n.Right="right",n.Top="top",n.Bottom="bottom"})(lr||(lr={}));var Yt;(function(n){n[n.FillParent=0]="FillParent",n[n.WrapContent=1]="WrapContent"})(Yt||(Yt={}));var vi;(function(n){n.Normal="normal",n.Bold="bold"})(vi||(vi={}));var ji;(function(n){n.AspectFit="aspectFit",n.AspectFill="aspectFill",n.ScalesToFill="scalesToFill"})(ji||(ji={}));const nD=[1,2],h_=n=>{switch(n){case lr.Right:case lr.Bottom:return"flex-end";case lr.Center:return"center";case lr.Left:case lr.Top:default:return"flex-start"}},UY=n=>n?nD.includes(Number(n)):!0,PY=n=>{const t=new Map,e=function(r){return(t.has(r)||t.set(r,n.call(this,r)))&&t.get(r)};return e.cache=t,e},FY=PY(n=>{const t=(e,r)=>{"items"in e&&(e==null?void 0:e.items)!=null&&e.items.forEach((i,a)=>{const s=`${r}-${a}`;i.id=s,t(i,s)})};return n.forEach((e,r)=>{const i=`${r}`;e.id=i,t(e,i)}),n}),ls={rootLayout:er.Column,view:{size:{width:{type:"flex",value:Yt.FillParent},height:{type:"flex",value:Yt.WrapContent}}},box:{layout:er.Row,align:{vertical:lr.Top,horizontal:lr.Left}},textButton:{maxTextLines:1},carousel:{style:{spacing:10,maxChildWidth:240}}},tD=n=>{const t=n.Container||b.Fragment,e=n.UnknownMessage||(()=>null),r=n.parser||Xk(),i=n.renderer||Jk(),a=({templateItems:s,templateVersion:u,parentLayout:d=ls.box.layout,depth:h=0})=>{if(!UY(u))throw new Error(`Cannot parse template item due to unsupported template version: ${u}, ${nD}`);return b.createElement(b.Fragment,null,s.map((p,g,E)=>{const y=r.parse(p,{parentLayout:d,depth:h,elemIdx:g,siblings:E}),C=y.transformed,T={key:g,siblings:E,parentLayout:d,parsedProperties:y.properties};switch(C.type){case hn.Carousel:{if(!Array.isArray(C.items)||C.items.length===0)throw new Error("Cannot parse template item as Carousel if carousel has no items.");return b.createElement(i.carouselView,Object.assign({},C,T),C.items.map((A,O)=>b.createElement(a,{key:O,templateItems:A.body.items||[],depth:h+1,templateVersion:A.version})))}case hn.Box:return b.createElement(i.box,Object.assign({},C,T),b.createElement(a,{templateItems:C.items||[],parentLayout:C.layout,depth:h+1,templateVersion:u}));case hn.Text:return b.createElement(i.text,Object.assign({},C,T));case hn.Image:return b.createElement(i.image,Object.assign({},C,T));case hn.TextButton:return b.createElement(i.textButton,Object.assign({},C,T));case hn.ImageButton:return b.createElement(i.imageButton,Object.assign({},C,T));default:return b.createElement(e,{item:C})}}))};return{MessageTemplate:({templateVersion:s,templateItems:u,parentLayout:d=ls.rootLayout})=>{const h=FY(u);return b.createElement(LY,null,b.createElement(t,null,b.createElement(a,{isRoot:!0,parentLayout:d,templateItems:h,templateVersion:s})))},MessageTemplateBase:a}};var Ya;(function(n){n.Web="web",n.Custom="custom",n.UIKit="uikit"})(Ya||(Ya={}));hn.Image,Ya.Web,ji.AspectFill,hn.Box,er.Column,Yt.FillParent,hn.Box,Yt.FillParent,Yt.FillParent,hn.Box,er.Column,Yt.FillParent,Yt.WrapContent,hn.Text,lr.Center,lr.Center,Yt.FillParent,hn.Image,Ya.Web,Yt.FillParent,ji.AspectFill,hn.Box,Yt.FillParent,hn.Box,Yt.FillParent,Yt.FillParent,hn.Box,er.Column,hn.Box,lr.Left,lr.Center,er.Row,Yt.FillParent,hn.Text,Yt.FillParent,lr.Center,lr.Left,vi.Bold,hn.ImageButton,Ya.UIKit,ji.AspectFit,hn.Text,hn.TextButton,Ya.Web,vi.Bold;hn.Image,Ya.Web,ji.AspectFill,hn.Box,er.Column,Yt.FillParent,hn.Box,Yt.FillParent,er.Row,hn.TextButton,Ya.Web,vi.Bold,hn.TextButton,Ya.Web,Yt.FillParent,vi.Bold,hn.Box,Yt.FillParent,er.Row,hn.Text,Yt.FillParent,vi.Bold,hn.ImageButton,Ya.UIKit,ji.AspectFit,hn.Text;hn.Box,er.Column,hn.Image,ji.AspectFill,hn.Box,er.Column,hn.Text,vi.Bold,hn.Text,hn.Box,lr.Left,lr.Center,er.Row,hn.Image,ji.AspectFill,hn.Box,lr.Left,lr.Center,er.Column,hn.Text,vi.Bold,hn.Text,vi.Bold,hn.Box,lr.Left,lr.Center,er.Row,hn.Image,ji.AspectFill,hn.Box,lr.Left,lr.Center,er.Column,hn.Text,vi.Bold,hn.Text,vi.Bold,hn.Box,lr.Left,lr.Center,er.Row,hn.Image,ji.AspectFill,hn.Box,lr.Left,lr.Center,er.Column,hn.Text,vi.Bold,hn.Text,vi.Bold,hn.Box,lr.Left,lr.Center,er.Row,hn.TextButton,Ya.Web,vi.Bold,hn.TextButton,Ya.Web,vi.Bold;hn.Box,er.Column,hn.Image,hn.Box,er.Column,hn.Box,er.Row,hn.Box,er.Column,hn.Text,vi.Bold,hn.Text,hn.ImageButton,Ya.UIKit,hn.Box,er.Column,hn.Box,lr.Left,lr.Center,er.Row,hn.Image,ji.AspectFill,hn.Box,er.Column,hn.Text,vi.Bold,hn.Text,hn.Box,lr.Left,lr.Center,er.Row,hn.Image,ji.AspectFill,hn.Box,er.Column,hn.Text,vi.Bold,hn.Text;Yt.FillParent,Yt.FillParent,Yt.FillParent,Yt.FillParent,Yt.FillParent,Yt.FillParent;Yt.FillParent,Yt.WrapContent,Yt.FillParent,Yt.FillParent;const HY=24;function BY({spacing:n,childrenLength:t,paddingInlineStart:e,paddingInlineEnd:r}){const i=e,a=r,s=F.useRef(null),u=F.useRef(Array.from({length:t},()=>b.createRef())),d=F.useRef(!1),h=F.useRef(!1),p=F.useRef(null),g=F.useRef({sx:null,sy:null,offset:0,translateX:0,currentIndex:0}),[E,y]=F.useState(()=>u.current.map(()=>0)),C=F.useMemo(()=>{let ne=i;return E.map((ue,pe)=>{const he=ne-(pe>0?n:0),le=he-ue;return ne=le,{start:he,end:le}})},[E,n,i]),T=F.useMemo(()=>{const ne=E.reduce((pe,he)=>pe+he,0),ue=n*(t-1);return ne+ue},[E,n,t]);F.useLayoutEffect(()=>{y(u.current.map(ne=>{var ue,pe;return(pe=(ue=ne.current)===null||ue===void 0?void 0:ue.clientWidth)!==null&&pe!==void 0?pe:0}))},[t]),F.useLayoutEffect(()=>{C.length>0&&(g.current.translateX=C[0].start,P())},[C]);const A=()=>{s.current&&(d.current=!0,s.current.style.cursor="grabbing",s.current.style.transition="none",p.current=requestAnimationFrame(P))},O=()=>{s.current&&(d.current=!1,s.current.style.cursor="grab",s.current.style.transition="transform 0.5s ease",p.current&&(cancelAnimationFrame(p.current),p.current=null))},N=()=>{const{offset:ne,currentIndex:ue}=g.current,pe=Math.abs(ne)>=HY,he=ne<0&&ue<t-1,le=ne>0&&ue>0;let we=ue;pe&&he?we=ue+1:pe&&le&&(we=ue-1);function ve(Ue){var be,Qe;const Ne=(Qe=(be=s.current)===null||be===void 0?void 0:be.clientWidth)!==null&&Qe!==void 0?Qe:0,$e=i,gn=Math.min(0,Ne-T)-a;return Math.min($e,Math.max(gn,Ue))}g.current.currentIndex=we,g.current.translateX=ve(C[we].start),g.current.offset=0},k=()=>{h.current=!0},D=()=>{h.current=!1},P=()=>{s.current&&(s.current.style.transform=`translateX(${g.current.translateX+g.current.offset}px)`),p.current&&(p.current=requestAnimationFrame(P))},U=()=>{s.current&&(s.current.style.touchAction="pan-x")},L=()=>{s.current&&(s.current.style.touchAction="pan-y")};return{carouselRef:s,childrenRefs:u,handlers:{onMouseDown:ne=>{A(),D(),g.current.sx=ne.clientX,g.current.sy=ne.clientY,g.current.offset=0,p.current=requestAnimationFrame(P)},onMouseMove:ne=>{!d.current||g.current.sx===null||(g.current.offset=ne.clientX-g.current.sx)},onMouseUp:()=>{d.current&&(D(),N(),O())},onMouseLeave:()=>{d.current&&(D(),N(),O())},onTouchStart:ne=>{D(),O();const ue=ne.touches[0];g.current.sx=ue.clientX,g.current.sy=ue.clientY,g.current.offset=0,p.current=requestAnimationFrame(P)},onTouchMove:ne=>{if(g.current.sx===null||g.current.sy===null||h.current)return;const{clientX:ue,clientY:pe}=ne.touches[0],{sx:he,sy:le}=g.current;if(d.current){g.current.offset=ue-he;return}Math.abs(pe-le)>Math.abs(ue-he)?k():(g.current.offset=ue-he,U(),A())},onTouchEnd:()=>{L(),D(),N(),O()}}}}var GY=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const VY=({children:n,style:t,spacing:e=ls.carousel.style.spacing,maxChildWidth:r=ls.carousel.style.maxChildWidth})=>{const i=t??{},{paddingInlineStart:a=0,paddingInlineEnd:s=0}=i,u=GY(i,["paddingInlineStart","paddingInlineEnd"]),{carouselRef:d,childrenRefs:h,handlers:p}=BY({spacing:e,childrenLength:n.length,paddingInlineStart:Number(a),paddingInlineEnd:Number(s)});return b.createElement("div",Object.assign({},p,{ref:d,className:"sb-message-template__carousel",style:Object.assign(Object.assign({},u),{gap:e,width:"100%",overflow:"visible"})}),n.map((g,E)=>b.createElement(jY,{ref:h.current[E],key:E,maxChildWidth:r},g)))},jY=b.forwardRef(function({maxChildWidth:t,children:e},r){const i=qY(e.props,t)?t:"fit-content";return b.createElement("div",{ref:r,style:{maxWidth:i,width:"100%",flexShrink:0,overflow:"hidden",userSelect:"none"}},e)});function qY(n,t){return!!n.templateItems.find(e=>{var r,i,a,s;const u=((r=e.width)===null||r===void 0?void 0:r.type)==="flex"&&((i=e.width)===null||i===void 0?void 0:i.value)===Yt.FillParent,d=((a=e.width)===null||a===void 0?void 0:a.type)==="fixed"&&((s=e.width)===null||s===void 0?void 0:s.value)>=t;return u||d})}function zY(n){var t;return n.type===hn.Text&&((t=n.width)===null||t===void 0?void 0:t.value)==Yt.WrapContent}const LR=({size:n,option:t})=>t==="wrap"?n.type==="flex"&&n.value==Yt.WrapContent:t==="fill"?n.type==="flex"&&n.value==Yt.FillParent:n.type==="fixed",KY=n=>{var t;return typeof n!="string"?!1:((t=n.split(".").pop())===null||t===void 0?void 0:t.toLowerCase())==="gif"};var WY=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const $Y=n=>{const{imageSize:t,canvasRef:e,canvasProps:r}=YY(n);return b.createElement("canvas",Object.assign({},r,{ref:e,width:t==null?void 0:t.width,height:t==null?void 0:t.height,onError:n.onError}))},YY=n=>{var{metaData:t,tintColor:e}=n,r=WY(n,["metaData","tintColor"]);const i=F.useRef(null),[a,s]=F.useState(),u=F.useMemo(()=>t!=null&&t.pixelHeight&&(t!=null&&t.pixelWidth)?{width:t.pixelWidth,height:t.pixelHeight}:a,[a,t==null?void 0:t.pixelHeight,t==null?void 0:t.pixelWidth]);return F.useEffect(()=>{if(u==null&&(console.log("Canvas_ReactMessageTemplateImage: no metaData, render fit to container"),i.current)){i.current.style.width="100%",i.current.style.height="100%";const d=i.current.getBoundingClientRect();s(d)}},[u]),F.useEffect(()=>{if(r.src){const d=new Image,h=()=>{if(i.current&&e&&u){const g=i.current.getContext("2d");if(g){const{width:E,height:y}=u;g.clearRect(0,0,E,y),g.beginPath(),g.globalCompositeOperation="source-over",g.fillStyle="#000",g.drawImage(d,0,0,E,y),g.globalCompositeOperation="source-atop",g.fillStyle=e,g.fillRect(0,0,E,y)}}},p=g=>{var E;(E=r.onError)===null||E===void 0||E.call(r,g)};return d.addEventListener("load",h),d.addEventListener("error",p),d.src=r.src,()=>{d.removeEventListener("load",h),d.removeEventListener("error",p)}}},[r.src,u,e]),{canvasRef:i,canvasProps:r,imageSize:u}},QY=n=>b.createElement("img",Object.assign({},n,{onError:n.onError,referrerPolicy:"no-referrer"})),ZY=n=>b.createElement("div",{style:Object.assign(Object.assign({},n.style),{backgroundColor:"transparent"})});var XY=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const xR=n=>{var{tintColor:t,metaData:e}=n,r=XY(n,["tintColor","metaData"]);const{hasError:i,onError:a}=JY(r.src);return r.onError&&console.warn("`onError` is intercepted and not executed in the ReactMessageTemplateImage."),i?b.createElement(ZY,Object.assign({},r)):t&&!KY(r.src)?b.createElement($Y,Object.assign({},r,{onError:a,tintColor:t,metaData:e})):b.createElement(QY,Object.assign({},r,{onError:a}))},JY=n=>{const[t,e]=F.useState(!1);return F.useEffect(()=>e(!1),[n]),{hasError:t,onError:F.useCallback(()=>e(!0),[])}};function sc(n){return Object.assign({display:"flex",overflow:"hidden",boxSizing:"border-box"},n)}function uc(n,t,e){rQ(n,t,e),nQ(n,t)}function eQ(n,t,e,r){t&&(n["--border-width"]=`${t}px`,n["--border-color"]=e||"transparent"),r&&(n.borderRadius=r,n["--border-radius"]=`${r}px`)}function nQ(n,t){var e,r,i,a,s,u,d,h;const{viewStyle:p}=t;n.marginBlockStart=(e=p==null?void 0:p.margin)===null||e===void 0?void 0:e.top,n.marginBlockEnd=(r=p==null?void 0:p.margin)===null||r===void 0?void 0:r.bottom,n.marginInlineStart=(i=p==null?void 0:p.margin)===null||i===void 0?void 0:i.left,n.marginInlineEnd=(a=p==null?void 0:p.margin)===null||a===void 0?void 0:a.right;const g=((u=(s=p==null?void 0:p.margin)===null||s===void 0?void 0:s.left)!==null&&u!==void 0?u:0)+((h=(d=p==null?void 0:p.margin)===null||d===void 0?void 0:d.right)!==null&&h!==void 0?h:0);g>0&&n.width==="100%"&&(n.width=`calc(100% - ${g}px)`),p!=null&&p.backgroundColor&&(n.backgroundColor=p.backgroundColor),p!=null&&p.backgroundImageUrl&&(n.backgroundImage=`url(${JSON.stringify(p.backgroundImageUrl)})`,n.backgroundSize="100% 100%",n.backgroundPosition="center"),eQ(n,p==null?void 0:p.borderWidth,p==null?void 0:p.borderColor,p==null?void 0:p.radius)}function tQ(n,t,e){const r={};return n.type==="flex"&&n.value==Yt.FillParent?(r.width="100%",e===er.Row&&(r.flex=1)):n.type==="fixed"&&n.value>=0&&(r.width=n.value),t.type==="flex"&&t.value==Yt.FillParent?(r.height="100%",e===er.Column&&(r.flex=1)):t.type==="fixed"&&t.value>=0&&(r.height=t.value),r}function rQ(n,t,e){var r,i;const{width:a,height:s}=ls.view.size,{parentLayout:u}=e,d=tQ((r=t.width)!==null&&r!==void 0?r:a,(i=t.height)!==null&&i!==void 0?i:s,u);Object.assign(n,d)}function UR(n,t=ls.box.layout,e=ls.box.align){t===er.Row&&(n.flexDirection="row",n.alignItems=h_(e.vertical),n.justifyContent=h_(e.horizontal)),t===er.Column&&(n.flexDirection="column",n.alignItems=h_(e.horizontal),n.justifyContent=h_(e.vertical))}function iQ(n,t=ls.box.align.horizontal){n.textAlign=t}function PR(n,t){const{contentMode:e=ji.AspectFit}=t||{};if(e)switch(e){case ji.AspectFill:n.objectFit="cover";break;case ji.AspectFit:n.objectFit="contain";break;case ji.ScalesToFill:n.objectFit="fill";break}}function FR(n,t){var e,r,i,a;const s=t==null?void 0:t.metaData;!(s!=null&&s.pixelHeight)||!(s!=null&&s.pixelWidth)||((e=t==null?void 0:t.width)===null||e===void 0?void 0:e.type)==="fixed"||((r=t==null?void 0:t.height)===null||r===void 0?void 0:r.type)==="fixed"||(n.aspectRatio=`${(i=t==null?void 0:t.metaData)===null||i===void 0?void 0:i.pixelWidth} / ${(a=t==null?void 0:t.metaData)===null||a===void 0?void 0:a.pixelHeight}`)}function HR(n){return{WebkitLineClamp:n,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden",overflowWrap:"anywhere",flex:1}}function BR(n,t,e){const{textStyle:r,width:i}=t,{size:a,color:s,weight:u}=r||{};if(a&&(n.fontSize=a),s&&(n.color=s),u&&(n.fontWeight=u),(i==null?void 0:i.type)==="flex"&&(i==null?void 0:i.value)==Yt.WrapContent&&(n.width="fit-content",n.maxWidth="100%"),t.type===hn.Text){const{siblings:d,elemIdx:h}=e;d!=null&&d.length>=2&&d.every(zY)&&(n.flexShrink=d.length-1===h?1:0)}}const rD=b.createContext(null),aQ=n=>{const{message:t,handleWebAction:e,handleCustomAction:r,handlePredefinedAction:i,children:a}=n,s=b.useMemo(()=>({message:t,handleWebAction:e,handleCustomAction:r,handlePredefinedAction:i}),[t==null?void 0:t.updatedAt]);return b.createElement(rD.Provider,{value:s},a)},sQ=()=>{const n=b.useContext(rD);if(!n)throw new Error("useMessageContext must be used within a MessageProvider");return n};function iD(n){const t=F.useRef(n);return F.useEffect(()=>{t.current=n},[n]),F.useCallback((...e)=>t.current(...e),[t])}function uQ(n,t){const e=iD(n),r=F.useRef(GR);return F.useCallback(a=>{if(r.current(),r.current=GR,a!=null){const s=n(a);typeof s=="function"&&(r.current=s)}},[e,...t])}function GR(){}function oQ(n){const t=iD(n);return uQ(r=>{const i=new ResizeObserver(a=>{a[0]!=null&&t(a[0])});return i.observe(r),()=>{i.unobserve(r)}},[t])}function lQ(){const[n,t]=F.useState(-1),[e,r]=F.useState(-1),[i,a]=F.useState(-1),[s,u]=F.useState(-1),[d,h]=F.useState(-1),[p,g]=F.useState(-1);return{ref:oQ(y=>{const{width:C,height:T}=y.contentRect,A=y.target,{width:O,height:N}=A.getBoundingClientRect();t(O),r(N),a(C),u(T),h(O-C),g(N-T)}),width:n,height:e,contentWidth:i,contentHeight:s,paddingWidth:d,paddingHeight:p}}var dQ=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function p_({width:n=ls.view.size.width,height:t=ls.view.size.height,parentLayout:e=ls.box.layout,option:r}){return e===er.Row?LR({size:n,option:r}):LR({size:t,option:r})}function cQ(n){const{style:t,props:e}=n,r=lQ(),{ref:i}=r,a=dQ(r,["ref"]),{updateSize:s,sizes:u}=xY(),{id:d,siblings:h,parentLayout:p}=e,{width:g,height:E,paddingWidth:y,paddingHeight:C,contentWidth:T,contentHeight:A}=a;return F.useEffect(()=>{s({id:e.id,width:g,height:E,paddingWidth:y,paddingHeight:C,contentWidth:T,contentHeight:A})},[e.id,g,E,y,C,T,A,s]),{recalculatedStyle:F.useMemo(()=>{const N=(D=0,P)=>{var U,L,B,q;return p===er.Row?D+((L=(U=u[P.id])===null||U===void 0?void 0:U.contentWidth)!==null&&L!==void 0?L:0):D+((q=(B=u[P.id])===null||B===void 0?void 0:B.contentHeight)!==null&&q!==void 0?q:0)};if(p_({width:e.width,height:e.height,parentLayout:p,option:"fill"})){const D=h.filter(({width:L,height:B})=>!p_({width:L,height:B,parentLayout:p,option:"fill"})).reduce(N,0),P=h.filter(({width:L,height:B})=>p_({width:L,height:B,parentLayout:p,option:"fill"})).length,U=p===er.Row?{maxWidth:`calc((100% - ${D}px) / ${P})`}:{maxHeight:`calc((100% - ${D}px) / ${P})`};return Object.assign(Object.assign(Object.assign({},t),U),g==0&&{height:0})}else{const D=h.findIndex(U=>U.id===d),P=h.slice(0,D).filter(({width:U,height:L})=>p_({width:U,height:L,parentLayout:p,option:"wrap"})).reduce(N,0);return Object.assign(Object.assign(Object.assign({},t),g===0&&{height:0}),p===er.Row?{maxWidth:`calc(100% - ${P}px)`}:{maxHeight:`calc(100% - ${P}px)`})}},[e.width,e.height,p,u,h,t,g,d]),elemRef:i}}var fQ=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const hQ=(n="")=>["http://","https://","ftp://"].some(t=>n.startsWith(t)),VR=(n="")=>hQ(n)?n:`https://${n}`,Bf=({children:n,props:t,className:e,style:r})=>{var i,a,s,u,d,h,p,g,E;const{recalculatedStyle:y,elemRef:C}=cQ({style:r,props:t}),{message:T,handleWebAction:A,handleCustomAction:O,handlePredefinedAction:N}=sQ(),k=!((i=t.viewStyle)===null||i===void 0)&&i.borderWidth?"sb-message-template__border":"",D={paddingBlockStart:(s=(a=t.viewStyle)===null||a===void 0?void 0:a.padding)===null||s===void 0?void 0:s.top,paddingBlockEnd:(d=(u=t.viewStyle)===null||u===void 0?void 0:u.padding)===null||d===void 0?void 0:d.bottom,paddingInlineStart:(p=(h=t.viewStyle)===null||h===void 0?void 0:h.padding)===null||p===void 0?void 0:p.left,paddingInlineEnd:(E=(g=t.viewStyle)===null||g===void 0?void 0:g.padding)===null||E===void 0?void 0:E.right},P=Q=>{var $,Z,ne,ue,pe,he,le;(($=t.action)===null||$===void 0?void 0:$.type)==="web"?A?A(Q,t.action,T):(ne=window==null?void 0:window.open(VR((Z=t==null?void 0:t.action)===null||Z===void 0?void 0:Z.data),"_blank","noopener noreferrer"))===null||ne===void 0||ne.focus():((ue=t.action)===null||ue===void 0?void 0:ue.type)==="custom"?O?O(Q,t.action,T):(he=window==null?void 0:window.open(VR((pe=t==null?void 0:t.action)===null||pe===void 0?void 0:pe.data),"_blank","noopener noreferrer"))===null||he===void 0||he.focus():((le=t.action)===null||le===void 0?void 0:le.type)==="uikit"&&(N==null||N(Q,t.action,T))};if(t.type===hn.TextButton)return b.createElement("button",{className:jR(e,k),"data-sb-template-id":t.elementId,style:Object.assign(Object.assign({},r),D),onClick:P},n);const{display:U,flexDirection:L,justifyContent:B,alignItems:q,objectFit:z}=y,Y=fQ(y,["display","flexDirection","justifyContent","alignItems","objectFit"]);return b.createElement("div",{ref:C,className:jR(e,k,t.action&&"sb-message-template__action"),"data-sb-template-id":t.elementId,style:Y,onClick:P},b.createElement("div",{style:Object.assign({display:U,flexDirection:L,justifyContent:B,alignItems:q,objectFit:z,width:"100%",height:"100%"},D)},n))};function jR(...n){return n.filter(t=>!!t).join(" ")}function pQ(n){var t,e,r,i;const a=(t=n==null?void 0:n.height)===null||t===void 0?void 0:t.type,s=(e=n==null?void 0:n.width)===null||e===void 0?void 0:e.type,u=a==="fixed"||s==="fixed",d=a==="flex"&&((r=n==null?void 0:n.height)===null||r===void 0?void 0:r.value)===Yt.FillParent||s==="flex"&&((i=n==null?void 0:n.width)===null||i===void 0?void 0:i.value)===Yt.FillParent;return u||d}function _Q(n){return n.split(`
`).map((t,e)=>b.createElement(b.Fragment,{key:e},t,b.createElement("br",null)))}function qR(n){const{text:t,maxTextLines:e}=n,r=pQ(n),i=typeof e=="number"&&e>0,a=_Q(t);if(i||r){const s=Object.assign(Object.assign({},(i||r)&&{maxWidth:"100%"}),r&&{maxHeight:"100%",overflow:"hidden"});return b.createElement("div",{style:s},i?b.createElement("div",{style:HR(e)},a):a)}return i?b.createElement("div",{style:HR(e)},a):a}const aD=Jk({views:{box(n){return b.createElement(Bf,{className:"sb-message-template__box",elementId:n.elementId,style:n.parsedProperties,props:n},n.children)},text(n){return b.createElement(Bf,{className:"sb-message-template__text",elementId:n.elementId,style:n.parsedProperties,props:n},qR(n))},image(n){var t;return b.createElement(Bf,{className:"sb-message-template__image-container",elementId:n.elementId,style:n.parsedProperties,props:n},b.createElement(xR,{className:"sb-message-template__image",alt:"image",src:n.imageUrl,style:{width:"100%",height:"100%",aspectRatio:"inherit",objectFit:"inherit"},tintColor:(t=n.imageStyle)===null||t===void 0?void 0:t.tintColor,metaData:n.metaData}))},textButton(n){return b.createElement(Bf,{className:"sb-message-template__text-button",elementId:n.elementId,style:n.parsedProperties,props:n},qR(Object.assign({maxTextLines:ls.textButton.maxTextLines},n)))},imageButton(n){var t;return b.createElement(Bf,{className:"sb-message-template__image-container sb-message-template__image-button",elementId:n.elementId,style:n.parsedProperties,props:n},b.createElement(xR,{className:"sb-message-template__image",alt:"image-button",src:n.imageUrl,style:{width:"100%",height:"100%",aspectRatio:"inherit",objectFit:"inherit"},tintColor:(t=n.imageStyle)===null||t===void 0?void 0:t.tintColor,metaData:n.metaData}))},carouselView(n){var t,e;return b.createElement(VY,{maxChildWidth:(t=n.carouselStyle)===null||t===void 0?void 0:t.maxChildWidth,spacing:(e=n.carouselStyle)===null||e===void 0?void 0:e.spacing,style:n.parsedProperties},n.children)}}}),sD=Xk({mapBoxProps(n,t){const e=sc();return uc(e,n,t),UR(e,n.layout,n.align),e},mapTextProps(n,t){var e;const r=sc({whiteSpace:"pre-line",wordBreak:"break-word"});return uc(r,n,t),BR(r,n,t),UR(r,er.Row,n.align),iQ(r,(e=n.align)===null||e===void 0?void 0:e.horizontal),r},mapImageProps(n,t){const e=sc();return uc(e,n,t),PR(e,n.imageStyle),FR(e,n),e},mapTextButtonProps(n,t){const e=sc({whiteSpace:"pre-line",alignItems:"center",justifyContent:"center"});return uc(e,n,t),BR(e,n,t),e},mapImageButtonProps(n,t){const e=sc();return uc(e,n,t),PR(e,n.imageStyle),FR(e,n),e},mapCarouselProps(n,t){var e,r,i,a,s,u,d,h;const p=sc();return uc(p,n,t),p.paddingBlockStart=(r=(e=n.viewStyle)===null||e===void 0?void 0:e.padding)===null||r===void 0?void 0:r.top,p.paddingBlockEnd=(a=(i=n.viewStyle)===null||i===void 0?void 0:i.padding)===null||a===void 0?void 0:a.bottom,p.paddingInlineStart=(u=(s=n.viewStyle)===null||s===void 0?void 0:s.padding)===null||u===void 0?void 0:u.left,p.paddingInlineEnd=(h=(d=n.viewStyle)===null||d===void 0?void 0:d.padding)===null||h===void 0?void 0:h.right,p}});tD({renderer:aD,parser:sD,Container:({children:n,className:t})=>b.createElement("div",{className:`sb-message-template__parent ${t}`,style:{display:"flex",flexDirection:"column",maxWidth:400,marginBlockEnd:24}},n)});var mQ=tD({parser:sD,renderer:aD,Container:function(n){var t=n.children,e=n.className;return b.createElement("div",{className:["sb-message-template__parent ".concat(e),"sendbird-message-template__root"].join(" ")},t)}}).MessageTemplate;function gQ(n){var t=n.templateItems,e=n.templateVersion;return b.createElement(mQ,{templateItems:t,templateVersion:e})}function zR(n){var t=n.className,e=n.message,r=n.isByMe,i=F.useContext(kr).stringSet,a=e.message;return b.createElement("div",{className:ma([t??"",r?"outgoing":"incoming","sendbird-template-message-item-body__fallback_message"])},a?b.createElement(b.Fragment,null,b.createElement(Ge,{type:Be.BODY_1,color:Re.ONCONTENT_INVERSE_1},a)):b.createElement(b.Fragment,null,b.createElement(Ge,{className:"sendbird-template-message-item-body__fallback_message__header",type:Be.BODY_1,color:Re.ONCONTENT_INVERSE_1},i.UNKNOWN__TEMPLATE_ERROR),b.createElement(Ge,{className:"sendbird-template-message-item-body__fallback_message__description",type:Be.BODY_1,color:Re.ONCONTENT_INVERSE_3},i.UNKNOWN__CANNOT_READ_TEMPLATE)))}var __="40px";function vQ(n){var t=n.className,e=n.isByMe;return b.createElement("div",{className:Rt(t,e?"outgoing":"incoming","sendbird-template-loading-message-item-body")},b.createElement(jm,{className:"sendbird-message-status__icon",testID:"sendbird-message-status-icon",width:__,height:__},b.createElement(mn,{type:Ye.SPINNER,fillColor:sn.CONTENT_INVERSE_3,width:__,height:__})))}var EQ=function(n){var t=n.message,e=n.templateVersion,r=n.templateItems;return b.createElement(aQ,{message:t},b.createElement(gQ,{templateVersion:e,templateItems:r}))},uD=function(n){var t={},e={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var i=n[r];if(typeof i=="object"&&i!==null){var a=uD(i),s=a[0],u=a[1];t[r]=s,e[r]=u}else if(typeof i=="string"){var d=i.split(","),h=d[0],p=d[1];t[r]=h,e[r]=p||h}else t[r]=i,e[r]=i}return[t,e]};function yQ(n){var t=n.colorVariables,e=n.theme,r=uD(t),i=r[0],a=r[1];return e==="light"?i:a}var bQ=function(n){iO(t,n);function t(e){var r=n.call(this,e)||this;return r.state={hasError:!1},r}return t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,r){var i;(i=this.props.logger)===null||i===void 0||i.error("Error caught by ErrorBoundary: ",e,r)},t.prototype.render=function(){return this.state.hasError?this.props.fallbackMessage:this.props.children},t}(F.Component),oD=function(n,t,e){e===void 0&&(e="");for(var r=0,i=Object.entries(n);r<i.length;r++){var a=i[r],s=a[0],u=a[1],d=e?"".concat(e,".").concat(s):s;u&&typeof u=="object"?oD(u,t,d):t[d]=u}};function CQ(n){var t={};return oD(n,t),t}var IQ=500,KR=function(n){var t=n.template,e=n.templateData,r=e===void 0?{}:e,i=n.colorVariables,a=n.theme,s={};i&&a&&(s=yQ({colorVariables:i,theme:a}));var u=re(re({},r),s),d=CQ(u),h=t;return Object.entries(d).forEach(function(p){var g=p[0],E=p[1],y="\\{".concat(g,"\\}"),C=new RegExp(y,"g");h=h.replace(C,E)}),h};function TQ(n){var t,e=n.className,r=e===void 0?"":e,i=n.message,a=n.isByMe,s=a===void 0?!1:a,u=n.theme,d=u===void 0?"light":u,h=(t=i.extendedMessagePayload)===null||t===void 0?void 0:t[Fh],p=function(){return b.createElement(zR,{className:r,message:i,isByMe:s})};if(!(h!=null&&h.key))return p();var g=h.key,E=Mt();if(!E)return p();var y=E.config.logger,C=E.utils,T=C.getCachedTemplate,A=C.updateMessageTemplatesInfo,O=E.stores.appInfoStore.waitingTemplateKeysMap,N=Object.entries(O).map(function(Q){var $=Q[0],Z=Q[1];return[$,Z.requestedAt,Z.erroredMessageIds.join(",")].join("-")}).join("_"),k=F.useState(z()),D=k[0],P=k[1];function U(Q,$){for(var Z=[],ne=0;(ne=Q.indexOf($,ne))!==-1;)Z.push({start:ne,end:ne+$.length}),ne+=$.length;return Z}function L(Q,$,Z){var ne="",ue=0;return $.forEach(function(pe){var he=pe.start,le=pe.end;ne+=Q.slice(ue,he)+Z,ue=le}),ne+=Q.slice(ue),ne}function B(Q,$,Z){var ne=U(Q,$);return L(Q,ne,Z)}function q(Q){var $=KR({template:Q.uiTemplate,templateData:h.variables,colorVariables:Q.colorVariables,theme:d});if(h.view_variables){var Z={};Object.entries(h.view_variables).forEach(function(ne){var ue=ne[0],pe=ne[1],he=[];pe.forEach(function(le){var we=le==null?void 0:le.key;if(we){var ve=T(we);ve||y.error("TemplateMessageItemBody | simple template is expected to be cached: ",we);var Ue=KR({template:ve.uiTemplate,templateData:le.variables,colorVariables:ve.colorVariables,theme:d});he.push({version:ve.version,body:{items:JSON.parse(Ue)}}),Z[ue]=JSON.stringify(he)}})}),Object.entries(Z).forEach(function(ne){var ue=ne[0],pe=ne[1];$=B($,'"@{'.concat(ue,'}"'),pe)})}return JSON.parse($)}function z(){var Q={filledMessageTemplateItemsList:[],isErrored:!1},$=[],Z=T(g);if(Z||$.push(g),h!=null&&h.view_variables)try{Object.entries(h.view_variables).forEach(function(ue){var pe=ue[0],he=ue[1];he.forEach(function(le){var we=le==null?void 0:le.key;we&&!T(we)&&!$.includes(we)&&$.push(we)})})}catch{return y.error("TemplateMessageItemBody | received view_variables is malformed: ",h),Q.isErrored=!0,Q}try{if($.length>0)Y($);else if(Z){var ne=q(Z);Q.filledMessageTemplateItemsList.push({version:Z.version,items:ne})}}catch(ue){y.error("TemplateMessageItemBody | fetching non-cached templates by given template keys failed: ",ue),Q.isErrored=!0}return Q}F.useEffect(function(){if(!D.isErrored&&D.filledMessageTemplateItemsList.length===0){var Q=z();P(Q)}},[h.key,N]);function Y(Q){if(Q.length>0){var $=[];Q.forEach(function(ue){var pe=O[ue];$.push([ue,pe])});var Z=Date.now(),ne=[];$.forEach(function(ue){var pe=ue[0],he=ue[1];if(!he||he.erroredMessageIds.indexOf(i.messageId)===-1&&Z>he.requestedAt+IQ)ne.push(pe);else if(he.erroredMessageIds.indexOf(i.messageId)>-1)throw new Error("TemplateMessageItemBody | fetching template key ".concat(pe," for messageId: ").concat(i.messageId," has failed."))}),ne.length>0&&A(ne,i.messageId,Z)}}return D.isErrored?p():D.filledMessageTemplateItemsList.length===0?b.createElement(vQ,{className:r,isByMe:s}):b.createElement("div",{className:ma([r,s?"outgoing":"incoming","sendbird-template-message-item-body"])},b.createElement(bQ,{fallbackMessage:b.createElement(zR,{className:r,message:i,isByMe:s}),logger:y},D.filledMessageTemplateItemsList.map(function(Q,$){var Z;return b.createElement(EQ,{key:$,message:i,templateVersion:(Z=Q.version)!==null&&Z!==void 0?Z:0,templateItems:Q.items})})))}function lD(n){var t=n.text,e=n.onCancel,r=F.useContext(kr).stringSet,i=F.useRef(null),a=ZC(i,{Enter:function(){return e==null?void 0:e()},Escape:function(){return e==null?void 0:e()}});return b.createElement("div",{onKeyDown:a},b.createElement(Za,{contentClassName:"sendbird-message-feedback-modal-content__mobile",type:Br.PRIMARY,onSubmit:e,onClose:e,submitText:r.BUTTON__OK,renderHeader:function(){return b.createElement("div",{className:"sendbird-modal__header"},b.createElement(Ge,{type:Be.H_1,color:Re.ONBACKGROUND_1,className:"sendbird-message-feedback-modal-header"},t))},customFooter:b.createElement("div",{className:"sendbird-message-feedback-modal-footer__root_failed"},b.createElement(ws,{onClick:e},b.createElement(Ge,{type:Be.BUTTON_3,color:Re.ONCONTENT_1},r.BUTTON__OK)))}))}function SQ(n){var t=n.className,e=t===void 0?"":t,r=n.isByMe,i=n.displayThreadReplies,a=n.bottom,s=n.message,u=n.channel,d=n.userId,h=n.chainBottom,p=h===void 0?!1:h,g=F.useRef(null),E=RC(),y=E.disableUserProfile,C=E.renderUserProfile;return r||p||!Hh(s)?null:b.createElement(wc,{menuTrigger:function(T){var A,O;return b.createElement(Na,{className:Rt(e,i&&"use-thread-replies"),src:((O=(A=u==null?void 0:u.members)===null||A===void 0?void 0:A.find(function(N){return(N==null?void 0:N.userId)===s.sender.userId}))===null||O===void 0?void 0:O.profileUrl)||s.sender.profileUrl||"",ref:g,width:"28px",height:"28px",bottom:a,onClick:function(){y||T()}})},menuItems:function(T){return C?C({user:s.sender,close:T,currentUserId:d,avatarRef:g}):b.createElement(Ac,{parentRef:g,parentContainRef:g,closeDropdown:T,style:{paddingTop:"0px",paddingBottom:"0px"}},b.createElement(QC,{user:s.sender,onSuccess:T}))}})}var NQ=function(n){var t=n.children;return b.createElement(Ge,{className:"sendbird-form-message__input__label",type:Be.CAPTION_2,color:Re.ONBACKGROUND_2},t)},AQ=function(n){var t=n.name,e=n.required,r=n.errorMessage,i=n.isValid,a=n.values,s=n.isInvalidated,u=n.isSubmitTried,d=n.style,h=n.onFocused,p=n.onChange,g=n.placeHolder,E=n.isSubmitted,y=d.layout,C=d.options,T=C===void 0?[]:C,A=d.resultCount,O=A??{},N=O.min,k=N===void 0?1:N,D=O.max,P=D===void 0?1:D,U=z(),L=F.useContext(kr).stringSet,B=function(){h==null||h(!0)},q=function(){h==null||h(!1)};function z(){return E?T.map(function(Q){return{state:a.includes(Q)?"submittedSelected":"submittedDefault",option:Q}}):T.map(function(Q){return{state:a.includes(Q)?"selected":"default",option:Q}})}var Y=function(Q){if(!E){var $;k===1&&P===1?$=U[Q].state==="selected"?[]:[U[Q].option]:$=U.reduce(function(Z,ne,ue){return ue===Q?ne.state==="default"&&a.length<P&&Z.push(ne.option):ne.state==="selected"&&Z.push(ne.option),Z},[]),p($)}};return b.createElement("div",{className:"sendbird-form-message__input__root"},b.createElement(NQ,null,b.createElement("div",{className:"sendbird-form-message__input__title-container"},t," ",!e&&b.createElement("span",{className:"sendbird-form-message__input__title-optional"},"(optional)"))),b.createElement("div",{className:"sendbird-input_for_form"},function(){switch(y){case"chip":return b.createElement("div",{className:"sendbird-form-message__input__chip-container"},U.map(function($,Z){return b.createElement("div",{className:"sendbird-form-message__input__chip ".concat($.state),key:Z,onClick:function(){return Y(Z)}},b.createElement("div",{className:"sendbird-form-message__input__chip-text"},$.option),E&&$.state==="submittedSelected"&&b.createElement(mn,{className:"sendbird-form-message__submitted-check-icon-chip",type:Ye.DONE,fillColor:sn.SECONDARY_2,width:"20px",height:"20px"}))}));case"textarea":{var Q=a.length>0?a[0]:"";return b.createElement("div",{className:"sendbird-form-message__input__container"},E?b.createElement("div",{className:"sendbird-form-message__submitted-input-box textarea"},b.createElement("div",{className:"sendbird-form-message__submitted-input-box-text"},Q),i&&b.createElement("div",{className:"sendbird-form-message__submitted-check-icon-container"},b.createElement(mn,{type:Ye.DONE,fillColor:sn.SECONDARY_2,width:"20px",height:"20px"})),!Q&&b.createElement(Ge,{className:"sendbird-input__placeholder",type:Be.BODY_1,color:Re.ONBACKGROUND_3},L.FORM_ITEM_OPTIONAL_EMPTY)):b.createElement(b.Fragment,null,b.createElement("textarea",{className:Rt("sendbird-input__input",!!r&&"error","sendbird-form-message__input__textarea"),required:e,disabled:E,value:Q,onFocus:B,onBlur:q,onChange:function($){var Z=$.target.value;p(Z?[Z]:[])}}),g&&!Q&&b.createElement(Ge,{className:"sendbird-input__placeholder textarea",type:Be.BODY_1,color:Re.ONBACKGROUND_3},g)))}case"text":case"number":case"phone":case"email":{var Q=a.length>0?a[0]:"";return b.createElement("div",{className:"sendbird-form-message__input__container"},E?b.createElement("div",{className:"sendbird-form-message__submitted-input-box"},b.createElement("div",{className:"sendbird-form-message__submitted-input-box-text"},Q),i&&b.createElement("div",{className:"sendbird-form-message__submitted-check-icon-container"},b.createElement(mn,{type:Ye.DONE,fillColor:sn.SECONDARY_2,width:"20px",height:"20px"})),!Q&&b.createElement(Ge,{className:"sendbird-input__placeholder",type:Be.BODY_1,color:Re.ONBACKGROUND_3},L.FORM_ITEM_OPTIONAL_EMPTY)):b.createElement(b.Fragment,null,b.createElement("input",{type:y==="number"?"text":y,inputMode:y==="number"?"numeric":"text",className:"sendbird-input__input ".concat(r?"error":""),name:t,required:e,disabled:E,value:Q,onFocus:B,onBlur:q,onChange:function(Z){var ne=Z.target.value;p(ne?[ne]:[])}}),g&&!Q&&b.createElement(Ge,{className:"sendbird-input__placeholder",type:Be.BODY_1,color:Re.ONBACKGROUND_3},g)))}default:return b.createElement(b.Fragment,null)}}(),r&&(u||s)&&b.createElement(Ge,{className:"sendbird-form-message__error-label",type:Be.CAPTION_3},r)))},wQ=function(n){var t=n.isByMe,e=n.text;return b.createElement("div",{className:ma(["sendbird-unknown-message-item-body",t?"outgoing":"incoming"])},b.createElement(Ge,{className:"sendbird-unknown-message-item-body__description",type:Be.BODY_1,color:t?Re.ONCONTENT_3:Re.ONBACKGROUND_3},e))};function RQ(n){var t=this,e=n.message,r=n.form,i=n.isByMe,a=n.logger,s=r.items,u=r.id,d=F.useContext(kr).stringSet,h=F.useState(!1),p=h[0],g=h[1],E=F.useState(!1),y=E[0],C=E[1],T=F.useState(function(){var L=[];return s.forEach(function(B){var q=B.required,z=B.style,Y=z===void 0?{}:z,Q=Y.layout,$=Y.defaultOptions,Z=$===void 0?[]:$;L.push({draftValues:Q==="chip"?Z:[],required:q,errorMessage:null,isInvalidated:!1})}),L}),A=T[0],O=T[1],N=r.isSubmitted,k=A.some(function(L){var B=L.errorMessage;return!!B}),D=A.some(function(L){var B=L.isInvalidated;return B}),P=k&&(y||D)||N,U=F.useCallback(function(){return Ar(t,void 0,void 0,function(){var L,B,q;return wr(this,function(z){switch(z.label){case 0:C(!0),z.label=1;case 1:return z.trys.push([1,3,,4]),L=A.some(function(Y){var Q=Y.errorMessage;return Q}),L?[2]:(B=A.some(function(Y){return Y.required&&(!Y.draftValues||Y.draftValues.length===0)}),B?(O(function(Y){return Y.map(function(Q){return Q.required&&Q.draftValues.length===0?re(re({},Q),{errorMessage:d.FORM_ITEM_REQUIRED}):Q})}),[2]):(A.forEach(function(Y,Q){s[Q].draftValues=Y.draftValues}),[4,e.submitMessageForm()]));case 2:return z.sent(),[3,4];case 3:return q=z.sent(),g(!0),a==null||a.error(q),[3,4];case 4:return[2]}})})},[A,e.messageId,e.submitMessageForm,u]);return bk(r.version)?b.createElement("div",{className:ma(["".concat(KC," disable-hover"),"sendbird-form-message__root","incoming"])},s.map(function(L,B){var q,z=L.name,Y=L.placeholder,Q=L.id,$=L.required,Z=L.style,ne=A[B],ue=ne.draftValues,pe=ue===void 0?[]:ue,he=ne.errorMessage;return b.createElement(AQ,{key:Q,style:Z,placeHolder:Y,values:(q=L.submittedValues)!==null&&q!==void 0?q:pe,isInvalidated:A[B].isInvalidated,isSubmitTried:y,errorMessage:he,isValid:N,isSubmitted:N,name:z,required:$,onFocused:function(le){he&&!le&&!A[B].isInvalidated?O(function(we){var ve=we.slice(0);return ve[B]=re(re({},ve[B]),{isInvalidated:!0}),ve}):he||O(function(we){var ve=we.slice(0);return ve[B]=re(re({},ve[B]),{isInvalidated:!1}),ve})},onChange:function(le){O(function(we){var ve=we.slice(0);return ve[B]=re(re({},ve[B]),{draftValues:le,errorMessage:function(){return L.isValid(le)?$&&le.length===0?d.FORM_ITEM_REQUIRED:null:d.FORM_ITEM_INVALID}()}),ve})}})}),b.createElement(ws,{className:"sendbird-form-message__submit-button",onClick:U,disabled:P,labelType:Be.BUTTON_2,labelColor:Re.ONCONTENT_1},N?"Submitted successfully":"Submit"),p&&b.createElement(lD,{text:"Submit failed.",onCancel:function(){g(!1)}})):b.createElement(wQ,{isByMe:i,text:d.FORM_VERSION_ERROR})}var MQ="sendbird-message-content__middle__message-item-body",OQ=function(n){var t,e=n.className,r=e===void 0?MQ:e,i=n.message,a=n.channel,s=n.showFileViewer,u=n.onMessageHeightChange,d=n.onBeforeDownloadFileMessage,h=n.mouseHover,p=n.isMobile,g=n.config,E=n.isReactionEnabledInChannel,y=n.isByMe,C=(t=n.customSubcomponentsProps)!==null&&t!==void 0?t:{},T=mY({isMobile:p}),A=gY(i),O=Pj(),N=(a==null?void 0:a.isGroupChannel())&&g.groupChannel.enableOgtag,k=(a==null?void 0:a.isGroupChannel())&&g.groupChannel.enableFormTypeMessage,D=function(){return b.createElement(yY,{className:r,message:i,isByMe:y,mouseHover:h,isReactionEnabled:E})};return Mi(i).when(function(P){return k&&gO(P)},function(){return b.createElement(RQ,{isByMe:y,message:i,form:i.messageForm,logger:g.logger})}).when(hm,function(){var P,U,L=i.extendedMessagePayload[Fh];return vO(L)?b.createElement(TQ,{className:r,message:i,isByMe:y,theme:g==null?void 0:g.theme}):((U=(P=g.logger)===null||P===void 0?void 0:P.error)===null||U===void 0||U.call(P,"TemplateMessageItemBody: invalid type value in message.extendedMessagePayload.message_template.",L),D())}).when(function(P){return N&&Hh(P)&&vC(P)},function(){var P;return b.createElement(Q$,{className:r,message:i,isByMe:y,mouseHover:h,isMentionEnabled:(P=g.groupChannel.enableMention)!==null&&P!==void 0?P:!1,isReactionEnabled:E,onMessageHeightChange:u,isMarkdownEnabled:g.groupChannel.enableMarkdownForUserMessage})}).when(Dj,function(){var P;return b.createElement(J$,{className:r,message:i,isByMe:y,mouseHover:h,isMentionEnabled:(P=g.groupChannel.enableMention)!==null&&P!==void 0?P:!1,isReactionEnabled:E,isMarkdownEnabled:g.groupChannel.enableMarkdownForUserMessage})}).when(function(P){return EC(P)===O.FILE},function(){return b.createElement(eY,{className:r,message:i,isByMe:y,mouseHover:h,isReactionEnabled:E,onBeforeDownloadFileMessage:d})}).when(ca,function(){var P;return b.createElement(_Y,re({className:r,message:i,isByMe:y,mouseHover:h,isReactionEnabled:E,threadMessageKindKey:T,statefulFileInfoList:A,onBeforeDownloadFileMessage:d},(P=C.MultipleFilesMessageItemBody)!==null&&P!==void 0?P:{}))}).when(ou,function(){var P;return b.createElement(vY,{className:r,message:i,channelUrl:(P=a==null?void 0:a.url)!==null&&P!==void 0?P:"",isByMe:y,isReactionEnabled:E})}).when(Go,function(){var P;return b.createElement(EY,re({className:r,message:i,isByMe:y,mouseHover:h,isReactionEnabled:E,showFileViewer:s,style:p?{width:"100%"}:{}},(P=C.ThumbnailMessageItemBody)!==null&&P!==void 0?P:{}))}).otherwise(function(){return D()})},kQ=function(n){var t,e,r=n.channel,i=n.message;return b.createElement(Ge,{className:"sendbird-message-content__middle__sender-name",type:Be.CAPTION_2,color:Re.ONBACKGROUND_2},((e=(t=r==null?void 0:r.members)===null||t===void 0?void 0:t.find(function(a){var s;return(a==null?void 0:a.userId)===((s=i==null?void 0:i.sender)===null||s===void 0?void 0:s.userId)}))===null||e===void 0?void 0:e.nickname)||qj(i))},WR=b.forwardRef(function(n,t){var e=n.children,r=n.isSelected,i=n.onClick,a=i===void 0?function(){}:i,s=n.disabled,u=s===void 0?!1:s;return b.createElement("button",{className:["sendbird-iconbutton__feedback",r?"sendbird-iconbutton__feedback__pressed":"",u?"sendbird-iconbutton__feedback__disabled":""].join(" "),ref:t,type:"button",onClick:function(d){a==null||a(d)},disabled:u},b.createElement("span",{className:["sendbird-iconbutton__feedback__inner",r?"sendbird-iconbutton__feedback__inner__pressed":"",u?"sendbird-iconbutton__feedback__inner__disabled":""].join(" ")},e))});function DQ(n){var t=n.hideMenu,e=n.onEditFeedback,r=n.onRemoveFeedback,i=Bt().stringSet;return b.createElement(qm,{onBackdropClick:t},b.createElement("div",{className:"sendbird-message__bottomsheet--feedback-options-menu"},b.createElement("div",{className:"sendbird-message__bottomsheet--feedback-option",onClick:function(){t(),e()}},b.createElement(Ge,{type:Be.BODY_1,color:Re.ONBACKGROUND_1},i.EDIT_COMMENT)),b.createElement("div",{className:"sendbird-message__bottomsheet--feedback-option",onClick:function(){t(),r()}},b.createElement(Ge,{type:Be.BODY_1,color:Re.ERROR},i.REMOVE_FEEDBACK))))}var m_=function(n){var t=n.children;return b.createElement(Ge,{className:"sendbird-input-label",type:Be.CAPTION_3,color:Re.ONBACKGROUND_1},t)},qb=b.forwardRef(function(n,t){var e=n.name,r=n.required,i=n.disabled,a=n.value,s=n.placeHolder,u=n.autoFocus,d=u===void 0?!1:u,h=F.useState(a),p=h[0],g=h[1];return b.createElement("div",{className:"sendbird-input"},b.createElement("input",{className:"sendbird-input__input",ref:t,name:e,required:r,disabled:i,value:p,onChange:function(E){g(E.target.value)},autoFocus:d}),s&&!p&&b.createElement(Ge,{className:"sendbird-input__placeholder",type:Be.BODY_1,color:Re.ONBACKGROUND_3},s))});function LQ(n){var t,e,r=n.selectedFeedback,i=n.message,a=n.onClose,s=n.onSubmit,u=n.onUpdate,d=n.onRemove,h=F.useContext(kr).stringSet,p=Zi().isMobile,g=(i==null?void 0:i.myFeedback)&&r===i.myFeedback.rating,E=(t=i==null?void 0:i.myFeedback)===null||t===void 0?void 0:t.comment,y=function(){var O,N,k;if(r){var D=(N=(O=T.current)===null||O===void 0?void 0:O.value)!==null&&N!==void 0?N:"";g?D!==((k=i.myFeedback)===null||k===void 0?void 0:k.comment)?u==null||u(r,D):a==null||a():i.myFeedback||s==null||s(r,D)}},C=F.useRef(),T=F.useRef(),A=ZC(C,{Enter:function(){return y()},Escape:function(){return a==null?void 0:a()}});return b.createElement("div",{onKeyDown:A},b.createElement(Za,{contentClassName:"sendbird-message-feedback-modal-content__mobile",type:Br.PRIMARY,onCancel:a,onSubmit:function(){y()},submitText:h.BUTTON__SUBMIT,renderHeader:function(){return b.createElement("div",{className:"sendbird-modal__header"},b.createElement(Ge,{type:Be.H_1,color:Re.ONBACKGROUND_1,className:"sendbird-message-feedback-modal-header"},h.FEEDBACK_MODAL_TITLE))},customFooter:b.createElement("div",{className:"sendbird-message-feedback-modal-footer__root"},!p&&(i!=null&&i.myFeedback)&&r===i.myFeedback.rating?b.createElement(ws,{type:Br.WARNING,onClick:d,labelType:Be.BUTTON_3},h.BUTTON__REMOVE_FEEDBACK):b.createElement("div",null),b.createElement("div",{className:"sendbird-message-feedback-modal-footer__right-content"},b.createElement(ws,{type:Br.SECONDARY,onClick:a},b.createElement(Ge,{type:Be.BUTTON_3,color:Re.ONBACKGROUND_1},h.BUTTON__CANCEL)),b.createElement(ws,{onClick:function(){return y()}},b.createElement(Ge,{type:Be.BUTTON_3,color:Re.ONCONTENT_1},E?h.BUTTON__SAVE:h.BUTTON__SUBMIT))))},b.createElement("div",{className:"sendbird-message-feedback-modal-body__root"},b.createElement(qb,{name:"sendbird-message-feedback-modal-body__root",ref:T,value:g?(e=i.myFeedback)===null||e===void 0?void 0:e.comment:void 0,placeHolder:h.FEEDBACK_CONTENT_PLACEHOLDER,autoFocus:!0}))))}function xQ(n,t){var e=F.useState(!1),r=e[0],i=e[1];return F.useEffect(function(){var a=Array.isArray(t)?t:[t],s=function(){var p,g=a==null?void 0:a.map(function(E){return E==null?void 0:E.querySelector(n)});i((p=g==null?void 0:g.some(function(E){return!!E}))!==null&&p!==void 0?p:!1)};s();var u=function(p){p.forEach(function(g){(g.addedNodes.length||g.removedNodes.length)&&(Array.from(g.addedNodes).forEach(function(E){E.nodeType===Node.ELEMENT_NODE&&E.matches(n)&&i(!0)}),Array.from(g.removedNodes).forEach(function(E){E.nodeType===Node.ELEMENT_NODE&&E.matches(n)&&i(!1)}))})},d=new MutationObserver(u),h={childList:!0,subtree:!0};return a==null||a.forEach(function(p){p&&d.observe(p,h)}),function(){d.disconnect()}},[n,t]),r}var zb;(function(n){n.NOT_APPLICABLE="NOT_APPLICABLE",n.NO_FEEDBACK="NO_FEEDBACK",n.SUBMITTED="SUBMITTED"})(zb||(zb={}));function UQ(n){var t,e,r,i=n.channel,a=n.message,s=n.showFileViewer,u=n.onMessageHeightChange,d=n.onBeforeDownloadFileMessage,h=n.renderSenderProfile,p=n.renderMessageHeader,g=n.renderMessageBody,E=n.isByMe,y=n.displayThreadReplies,C=n.mouseHover,T=n.isMobile,A=n.isReactionEnabledInChannel,O=n.hoveredMenuClassName,N=n.templateType,k=n.useReplying,D=Mt().config,P=Bt().dateLocale,U=(t=kj[N])!==null&&t!==void 0?t:"",L=h(re(re({},n),{chainBottom:!1,className:"",isByMe:E,displayThreadReplies:y})),B=p(n),q=g({message:a,channel:i,showFileViewer:s,onMessageHeightChange:u,mouseHover:C,isMobile:T,config:D,isReactionEnabledInChannel:A,isByMe:E,onBeforeDownloadFileMessage:d}),z=b.createElement(Ge,{className:Rt("sendbird-message-content__middle__body-container__created-at","right",O,U),type:Be.CAPTION_3,color:Re.ONBACKGROUND_2},su((a==null?void 0:a.createdAt)||0,"p",{locale:P})),Y=(e=a.extendedMessagePayload)===null||e===void 0?void 0:e[Fh],Q=(r=Y==null?void 0:Y.container_options)!==null&&r!==void 0?r:{},$=Q.profile,Z=$===void 0?!0:$,ne=Q.time,ue=ne===void 0?!0:ne,pe=Q.nickname,he=pe===void 0?!0:pe,le=Z||he;return b.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__root"},!E&&le&&!k&&b.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__header-container"},b.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__header-container__left__profile"},Z&&L),he&&B),q,!E&&ue&&b.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__bottom"},z))}function PQ(n){var t=this,e,r,i,a,s,u,d,h,p,g,E,y,C,T=n.className,A=n.userId,O=n.channel,N=n.message,k=n.disabled,D=k===void 0?!1:k,P=n.chainTop,U=P===void 0?!1:P,L=n.chainBottom,B=L===void 0?!1:L,q=n.isReactionEnabled,z=q===void 0?!1:q,Y=n.disableQuoteMessage,Q=Y===void 0?!1:Y,$=n.replyType,Z=n.threadReplySelectType,ne=n.nicknamesMap,ue=n.emojiContainer,pe=n.scrollToMessage,he=n.showEdit,le=n.showRemove,we=n.showFileViewer,ve=n.resendMessage,Ue=n.deleteMessage,be=n.toggleReaction,Qe=n.setQuoteMessage,Ne=n.onReplyInThread,$e=n.onQuoteMessageClick,gn=n.onMessageHeightChange,En=n.onBeforeDownloadFileMessage,Yn=n.filterEmojiCategoryIds,Gn=Bh(n),Tn=Gn.renderSenderProfile,kn=Tn===void 0?function(bn){return b.createElement(SQ,re({},bn))}:Tn,Vn=Gn.renderMessageBody,Hn=Vn===void 0?function(bn){return b.createElement(OQ,re({},bn))}:Vn,Jn=Gn.renderMessageHeader,jn=Jn===void 0?function(bn){return b.createElement(kQ,re({},bn))}:Jn,On=Gn.renderMessageMenu,Ln=On===void 0?function(bn){return b.createElement(E$,re({},bn))}:On,An=Gn.renderEmojiMenu,wn=An===void 0?function(bn){return b.createElement(C$,re({},bn))}:An,We=Gn.renderEmojiReactions,ln=We===void 0?function(bn){return b.createElement(L$,re({},bn))}:We,Pe=Gn.renderMobileMenuOnLongPress,Ke=Pe===void 0?function(bn){return b.createElement(V$,re({},bn))}:Pe,yn=Bt(),tn=yn.dateLocale,st=yn.stringSet,Cn=Mt(),Ve=Cn.config,Ut=Cn.eventHandlers,mt=Ve.logger,ut=(e=Ut==null?void 0:Ut.reaction)===null||e===void 0?void 0:e.onPressUserProfile,In=F.useRef(),Qn=F.useRef(),Ct=F.useRef(),Et=Zi().isMobile,ct=F.useState(!1),Qt=ct[0],Ot=ct[1],ft=F.useState(!1),rt=ft[0],xn=ft[1],Oe=xQ("#".concat(AC(N.messageId),".").concat(NC),[document.getElementById(pm),document.getElementById(wC)]),Ee=F.useState(!1),nn=Ee[0],Sn=Ee[1],Pn=F.useState(!1),lt=Pn[0],qn=Pn[1],Fn=F.useState(""),At=Fn[0],Pt=Fn[1],zn=A===((r=N==null?void 0:N.sender)===null||r===void 0?void 0:r.userId)||(N==null?void 0:N.sendingStatus)==="pending"||(N==null?void 0:N.sendingStatus)==="failed",qt=zn?"outgoing":"incoming",cr=U?"chain-top":"",Fe=z&&!(O!=null&&O.isEphemeral),un=Fe?"use-reactions":"",Ae=Oe?"sendbird-mouse-hover":"",Dn=!!(($==="QUOTE_REPLY"||$==="THREAD")&&(N!=null&&N.parentMessageId)&&(N!=null&&N.parentMessage)&&!Q),pn=Dn?"use-quote":"",it=((i=N==null?void 0:N.threadInfo)===null||i===void 0?void 0:i.replyCount)&&N.threadInfo.replyCount>0&&$==="THREAD",yt=!zn&&!!(N!=null&&N.myFeedbackStatus)&&N.myFeedbackStatus!==zb.NOT_APPLICABLE,zt=!!(!((a=Ve==null?void 0:Ve.groupChannel)===null||a===void 0)&&a.enableFeedback)&&yt,Ht=(s=N==null?void 0:N.myFeedback)===null||s===void 0?void 0:s.rating,Je=!hm(N)&&!gO(N),oe=Je&&Et,ke=Je&&zn&&!Et,fn=Je&&it,bt=Je&&!zn&&!Et,dt=function(){var bn=2;return Qn.current&&(bn+=4+Qn.current.clientHeight),Ct.current&&(bn+=4+Ct.current.clientHeight),bn>0?bn+"px":""},nr=function(){qn(!1)},rr=function(bn){bn===void 0&&(bn=!1),Et&&bn?Sn(!0):qn(!0)},Vr=Rc({onLongPress:function(){oe&&Ot(!0)},onClick:ur},{delay:300,shouldPreventDefault:!1});if(_O(N))return b.createElement(x$,{message:N});if(hm(N)){var Ir=N.extendedMessagePayload[Fh];if(vO(Ir))return b.createElement(UQ,re({},n,{renderSenderProfile:kn,renderMessageHeader:jn,renderMessageBody:Hn,isByMe:zn,displayThreadReplies:it,mouseHover:rt,isMobile:Et,isReactionEnabledInChannel:Fe,hoveredMenuClassName:Ae,templateType:Ir.type,useReplying:Dn}))}return b.createElement("div",{className:ma([T??"","sendbird-message-content",qt]),onMouseOver:function(){return xn(!0)},onMouseLeave:function(){return xn(!1)}},b.createElement("div",{className:Rt("sendbird-message-content__left",un,qt,pn),"data-testid":"sendbird-message-content__left"},kn(re(re({},n),{className:"sendbird-message-content__left__avatar",isByMe:zn,displayThreadReplies:it,bottom:dt()})),ke&&b.createElement("div",{className:Rt("sendbird-message-content-menu",un,Ae,qt)},Ln({channel:O,message:N,isByMe:zn,replyType:$,showEdit:he,showRemove:le,resendMessage:ve,setQuoteMessage:Qe,onReplyInThread:function(bn){var ot,Tt,ht=bn.message;Z===Is.THREAD?Ne==null||Ne({message:ht}):Z===Is.PARENT&&(pe==null||pe((Tt=(ot=ht.parentMessage)===null||ot===void 0?void 0:ot.createdAt)!==null&&Tt!==void 0?Tt:0,ht.parentMessageId))},deleteMessage:Ue}),Fe&&wn({message:N,userId:A,emojiContainer:ue,toggleReaction:be,filterEmojiCategoryIds:Yn}))),b.createElement("div",re({className:Rt("sendbird-message-content__middle"),"data-testid":"sendbird-message-content__middle"},Et?re({},Vr):{},{ref:In}),!zn&&!U&&!Dn&&jn(n),Dn?b.createElement("div",{className:Rt("sendbird-message-content__middle__quote-message",zn?"outgoing":"incoming",pn),"data-testid":"sendbird-message-content__middle__quote-message"},b.createElement(P$,{className:"sendbird-message-content__middle__quote-message__quote",message:N,userId:A,isByMe:zn,isUnavailable:((u=O==null?void 0:O.messageOffsetTimestamp)!==null&&u!==void 0?u:0)>((h=(d=N.parentMessage)===null||d===void 0?void 0:d.createdAt)!==null&&h!==void 0?h:0),onClick:function(){var bn;$==="THREAD"&&Z===Is.THREAD&&($e==null||$e({message:N})),($==="QUOTE_REPLY"||$==="THREAD"&&Z===Is.PARENT)&&(!((bn=N==null?void 0:N.parentMessage)===null||bn===void 0)&&bn.createdAt)&&(N!=null&&N.parentMessageId)&&(pe==null||pe(N.parentMessage.createdAt,N.parentMessageId))}})):null,b.createElement("div",{className:Rt("sendbird-message-content__middle__body-container")},zn&&!B&&b.createElement("div",{className:Rt("sendbird-message-content__middle__body-container__created-at","left",Ae)},b.createElement("div",{className:"sendbird-message-content__middle__body-container__created-at__component-container"},b.createElement(Hk,{message:N,channel:O}))),Hn({message:N,channel:O,showFileViewer:we,onMessageHeightChange:gn,mouseHover:rt,isMobile:Et,config:Ve,isReactionEnabledInChannel:Fe,isByMe:zn,onBeforeDownloadFileMessage:En}),Fe&&((p=N==null?void 0:N.reactions)===null||p===void 0?void 0:p.length)>0&&b.createElement("div",{className:Rt("sendbird-message-content-reactions",ca(N)?"image-grid":zn&&!Go(N)&&!vC(N)&&"primary",rt&&"mouse-hover")},ln({userId:A,message:N,channel:O,isByMe:zn,emojiContainer:ue??new GM({}),memberNicknamesMap:ne??new Map,toggleReaction:be,onPressUserProfile:ut,filterEmojiCategoryIds:Yn})),!zn&&!B&&b.createElement(Ge,{className:Rt("sendbird-message-content__middle__body-container__created-at","right",Ae),type:Be.CAPTION_3,color:Re.ONBACKGROUND_2},su((N==null?void 0:N.createdAt)||0,st.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:tn}))),fn&&(N==null?void 0:N.threadInfo)&&b.createElement(q$,{className:"sendbird-message-content__middle__thread-replies",threadInfo:N==null?void 0:N.threadInfo,onClick:function(){return Ne==null?void 0:Ne({message:N})},ref:Qn}),zt&&b.createElement("div",{className:"sendbird-message-content__middle__body-container__feedback-buttons-container",ref:Ct},b.createElement(WR,{isSelected:((g=N==null?void 0:N.myFeedback)===null||g===void 0?void 0:g.rating)===yo.GOOD,onClick:function(){return Ar(t,void 0,void 0,function(){var bn,ot,Tt;return wr(this,function(ht){switch(ht.label){case 0:if(Ht)return[3,5];ht.label=1;case 1:return ht.trys.push([1,3,,4]),[4,N.submitFeedback({rating:yo.GOOD})];case 2:return ht.sent(),rr(),[3,4];case 3:return bn=ht.sent(),(Tt=(ot=Ve==null?void 0:Ve.logger)===null||ot===void 0?void 0:ot.error)===null||Tt===void 0||Tt.call(ot,"Channel: Submit feedback failed.",bn),Pt(st.FEEDBACK_FAILED_SUBMIT),[3,4];case 4:return[3,6];case 5:rr(!0),ht.label=6;case 6:return[2]}})})},disabled:!!(N!=null&&N.myFeedback)&&N.myFeedback.rating!==yo.GOOD},b.createElement(mn,{type:Ye.FEEDBACK_LIKE,width:"24px",height:"24px"})),b.createElement(WR,{isSelected:((E=N==null?void 0:N.myFeedback)===null||E===void 0?void 0:E.rating)===yo.BAD,onClick:function(){return Ar(t,void 0,void 0,function(){var bn,ot,Tt;return wr(this,function(ht){switch(ht.label){case 0:if(Ht)return[3,5];ht.label=1;case 1:return ht.trys.push([1,3,,4]),[4,N.submitFeedback({rating:yo.BAD})];case 2:return ht.sent(),rr(),[3,4];case 3:return bn=ht.sent(),(Tt=(ot=Ve==null?void 0:Ve.logger)===null||ot===void 0?void 0:ot.error)===null||Tt===void 0||Tt.call(ot,"Channel: Submit feedback failed.",bn),Pt(st.FEEDBACK_FAILED_SUBMIT),[3,4];case 4:return[3,6];case 5:rr(!0),ht.label=6;case 6:return[2]}})})},disabled:!!(N!=null&&N.myFeedback)&&N.myFeedback.rating!==yo.BAD},b.createElement(mn,{type:Ye.FEEDBACK_DISLIKE,width:"24px",height:"24px"})))),bt&&b.createElement("div",{className:Rt("sendbird-message-content__right",cr,un,pn),"data-testid":"sendbird-message-content__right"},b.createElement("div",{className:Rt("sendbird-message-content-menu",cr,Ae,qt)},Fe&&wn({className:"sendbird-message-content-menu__reaction-menu",message:N,userId:A,emojiContainer:ue,toggleReaction:be,filterEmojiCategoryIds:Yn}),Ln({className:"sendbird-message-content-menu__normal-menu",channel:O,message:N,isByMe:zn,replyType:$,showRemove:le,resendMessage:ve,setQuoteMessage:Qe,onReplyInThread:function(bn){var ot,Tt,ht=bn.message;Z===Is.THREAD?Ne==null||Ne({message:ht}):Z===Is.PARENT&&(pe==null||pe((Tt=(ot=ht.parentMessage)===null||ot===void 0?void 0:ot.createdAt)!==null&&Tt!==void 0?Tt:0,ht.parentMessageId))},deleteMessage:Ue}))),Qt&&Hh(N)&&O&&Ke({parentRef:In,channel:O,hideMenu:function(){Ot(!1)},message:N,isReactionEnabled:Fe,isByMe:zn,userId:A,replyType:$,disabled:D,showRemove:le,emojiContainer:ue,resendMessage:ve,deleteMessage:Ue,setQuoteMessage:Qe,toggleReaction:be,showEdit:he,onReplyInThread:function(bn){var ot,Tt=bn.message;Z===Is.THREAD?Ne==null||Ne({message:Tt}):Z===Is.PARENT&&(pe==null||pe(((ot=Tt==null?void 0:Tt.parentMessage)===null||ot===void 0?void 0:ot.createdAt)||0,(Tt==null?void 0:Tt.parentMessageId)||0))},onDownloadClick:function(bn){return Ar(t,void 0,void 0,function(){var ot,Tt,ht,Oi;return wr(this,function(di){switch(di.label){case 0:if(!En)return[2];di.label=1;case 1:return di.trys.push([1,3,,4]),[4,En({message:N})];case 2:return ot=di.sent(),ot||(bn.preventDefault(),(ht=mt==null?void 0:mt.info)===null||ht===void 0||ht.call(mt,"MessageContent: Not allowed to download.")),[3,4];case 3:return Tt=di.sent(),(Oi=mt==null?void 0:mt.error)===null||Oi===void 0||Oi.call(mt,"MessageContent: Error occurred while determining download continuation:",Tt),[3,4];case 4:return[2]}})})}}),((y=N==null?void 0:N.myFeedback)===null||y===void 0?void 0:y.rating)&&nn&&b.createElement(DQ,{hideMenu:function(){Sn(!1)},onEditFeedback:function(){Sn(!1),qn(!0)},onRemoveFeedback:function(){return Ar(t,void 0,void 0,function(){var bn,ot,Tt;return wr(this,function(ht){switch(ht.label){case 0:return ht.trys.push([0,3,,4]),N.myFeedback===null?[3,2]:[4,N.deleteFeedback(N.myFeedback.id)];case 1:ht.sent(),ht.label=2;case 2:return[3,4];case 3:return bn=ht.sent(),(Tt=(ot=Ve==null?void 0:Ve.logger)===null||ot===void 0?void 0:ot.error)===null||Tt===void 0||Tt.call(ot,"Channel: Delete feedback failed.",bn),Pt(st.FEEDBACK_FAILED_DELETE),[3,4];case 4:return Sn(!1),[2]}})})}}),((C=N==null?void 0:N.myFeedback)===null||C===void 0?void 0:C.rating)&&lt&&b.createElement(LQ,{selectedFeedback:N.myFeedback.rating,message:N,onUpdate:function(bn,ot){return Ar(t,void 0,void 0,function(){var Tt,ht,Oi,di;return wr(this,function(Ji){switch(Ji.label){case 0:if(N.myFeedback===null)return[3,4];Tt=new Lu({id:N.myFeedback.id,rating:bn,comment:ot}),Ji.label=1;case 1:return Ji.trys.push([1,3,,4]),[4,N.updateFeedback(Tt)];case 2:return Ji.sent(),[3,4];case 3:return ht=Ji.sent(),(di=(Oi=Ve==null?void 0:Ve.logger)===null||Oi===void 0?void 0:Oi.error)===null||di===void 0||di.call(Oi,"Channel: Update feedback failed.",ht),Pt(st.FEEDBACK_FAILED_SAVE),[3,4];case 4:return nr(),[2]}})})},onClose:nr,onRemove:function(){return Ar(t,void 0,void 0,function(){var bn,ot,Tt;return wr(this,function(ht){switch(ht.label){case 0:return ht.trys.push([0,3,,4]),N.myFeedback===null?[3,2]:[4,N.deleteFeedback(N.myFeedback.id)];case 1:ht.sent(),ht.label=2;case 2:return[3,4];case 3:return bn=ht.sent(),(Tt=(ot=Ve==null?void 0:Ve.logger)===null||ot===void 0?void 0:ot.error)===null||Tt===void 0||Tt.call(ot,"Channel: Delete feedback failed.",bn),Pt(st.FEEDBACK_FAILED_DELETE),[3,4];case 4:return nr(),[2]}})})}}),At&&b.createElement(lD,{text:At,onCancel:function(){Pt("")}}))}var FQ=function(n){var t=n.value,e=n.onClickReply,r=n.type,i=r===void 0?"vertical":r;return b.createElement("div",{className:"sendbird-suggested-replies__option ".concat(i),id:t,onClick:function(a){return e(a,t)}},t)},HQ=function(n){var t=n.replyOptions,e=n.onSendMessage,r=n.type,i=r===void 0?"vertical":r,a=F.useState(!1),s=a[0],u=a[1],d=function(p,g){p.preventDefault(),e({message:g}),u(!0)};if(s)return null;var h=t.map(function(p,g){return b.createElement(FQ,{key:g,value:p,onClickReply:d,type:i})});return b.createElement("div",{className:"sendbird-suggested-replies ".concat(i)},h)};function BQ(n){var t=n.member,e=n.isFocused,r=e===void 0?!1:e,i=n.parentScrollRef,a=n.onClick,s=n.onMouseOver,u=n.onMouseMove,d=n.renderUserMentionItem,h=F.useRef(null),p=F.useContext(kr).stringSet;F.useEffect(function(){r&&(i==null?void 0:i.current)!=null&&(h==null?void 0:h.current)!=null&&(i.current.scrollTop>=h.current.offsetTop||i.current.scrollTop+i.current.clientHeight<=h.current.offsetTop)&&h.current.scrollIntoView({block:"nearest",inline:"nearest"})},[r]);var g=F.useMemo(function(){if(d)return b.createElement("div",{className:"sendbird-mention-suggest-list__user-item",onClick:function(E){return a==null?void 0:a({event:E,member:t,itemRef:h})},onMouseOver:function(E){return s==null?void 0:s({event:E,member:t,itemRef:h})},onMouseMove:function(E){return u==null?void 0:u({event:E,member:t,itemRef:h})},key:(t==null?void 0:t.userId)||fs(),ref:h},d({user:t}))},[d]);return g||b.createElement("div",{className:Rt("sendbird-mention-suggest-list__user-item",r&&"focused"),onClick:function(E){return a==null?void 0:a({event:E,member:t,itemRef:h})},onMouseOver:function(E){return s==null?void 0:s({event:E,member:t,itemRef:h})},onMouseMove:function(E){return u==null?void 0:u({event:E,member:t,itemRef:h})},key:(t==null?void 0:t.userId)||fs(),ref:h},b.createElement(Na,{className:"sendbird-mention-suggest-list__user-item__avatar",src:t==null?void 0:t.profileUrl,alt:"user-profile",width:"24px",height:"24px"}),b.createElement(Ge,{className:"sendbird-mention-suggest-list__user-item__nickname",testID:"sendbird-mention-suggest-list__user-item__nickname",type:Be.SUBTITLE_2,color:t!=null&&t.nickname?Re.ONBACKGROUND_1:Re.ONBACKGROUND_3},(t==null?void 0:t.nickname)||(p==null?void 0:p.MENTION_NAME__NO_NAME)),b.createElement(Ge,{className:"sendbird-mention-suggest-list__user-item__user-id",testID:"sendbird-mention-suggest-list__user-item__user-id",type:Be.SUBTITLE_2,color:Re.ONBACKGROUND_2},t==null?void 0:t.userId))}function GQ(n,t,e,r){return Ar(this,void 0,void 0,function(){return wr(this,function(i){return[2,t.members.sort(function(a,s){var u;return(u=a.nickname)===null||u===void 0?void 0:u.localeCompare(s.nickname)}).filter(function(a){var s;return((s=a.nickname)===null||s===void 0?void 0:s.toLowerCase().startsWith(r.toLowerCase()))&&a.userId!==n&&a.isActive}).slice(0,e)]})})}function VQ(n,t,e,r){return Ar(this,void 0,void 0,function(){var i;return wr(this,function(a){return i=t.createMemberListQuery({limit:e+1,nicknameStartsWithFilter:r}),[2,i.next().then(function(s){return s.filter(function(u){return n!==(u==null?void 0:u.userId)}).slice(0,e)})]})})}var jQ=300,dD=function(n){var t,e,r,i=n.className,a=n.currentChannel,s=n.targetNickname,u=s===void 0?"":s,d=n.onUserItemClick,h=n.onFocusItemChange,p=n.onFetchUsers,g=n.renderUserMentionItem,E=n.inputEvent,y=n.ableAddMention,C=y===void 0?!0:y,T=n.maxMentionCount,A=T===void 0?rk:T,O=n.maxSuggestionCount,N=O===void 0?ik:O,k=Mt(),D=k.config,P=k.stores,U=D.logger,L=((r=(e=(t=P==null?void 0:P.sdkStore)===null||t===void 0?void 0:t.sdk)===null||e===void 0?void 0:e.currentUser)===null||r===void 0?void 0:r.userId)||"",B=F.useRef(null),q=Bt().stringSet,z=F.useState(null),Y=z[0],Q=z[1],$=F.useState(""),Z=$[0],ne=$[1],ue=F.useState(""),pe=ue[0],he=ue[1],le=F.useState(null),we=le[0],ve=le[1],Ue=F.useState([]),be=Ue[0],Qe=Ue[1];return F.useEffect(function(){clearTimeout(Y??void 0),Q(setTimeout(function(){ne(u)},jQ))},[u]),F.useEffect(function(){if((E==null?void 0:E.key)===Rs.Enter&&we&&be.length>0&&(d==null||d(we)),(E==null?void 0:E.key)===Rs.ArrowUp){var Ne=be.findIndex(function($e){return($e==null?void 0:$e.userId)===(we==null?void 0:we.userId)});0<Ne&&(ve(be[Ne-1]),h==null||h(be[Ne-1]))}if((E==null?void 0:E.key)===Rs.ArrowDown){var Ne=be.findIndex(function(gn){return(gn==null?void 0:gn.userId)===(we==null?void 0:we.userId)});Ne<be.length-1&&(ve(be[Ne+1]),h==null||h(be[Ne+1]))}},[E]),F.useEffect(function(){if(!(pe&&Z.indexOf(pe)===0&&be.length===0)){if(a!=null&&a.isSuper&&!(a!=null&&a.createMemberListQuery)){U.warning("SuggestedMentionList: Creating member list query failed");return}var Ne=a!=null&&a.isSuper?VQ:GQ;Ne(L,a,N,Z.slice(mh.length)).then(function($e){$e.length<1?U.info("SuggestedMentionList: Fetched member list is empty"):(U.info("SuggestedMentionList: Fetching member list succeeded",{memberList:$e}),ve($e[0])),he(Z),p==null||p($e),Qe($e)}).catch(function($e){$e&&U.error("SuggestedMentionList: Fetching member list failed",$e)})}},[a==null?void 0:a.url,a==null?void 0:a.members.map(function(Ne){return Ne.nickname}).join(),a==null?void 0:a.members.map(function(Ne){return Ne.isActive}).join(),Z,N,L,be.length,pe]),!C&&be.length===0?null:b.createElement("div",{className:Rt("sendbird-mention-suggest-list",i),"data-testid":"sendbird-mention-suggest-list",key:"sendbird-mention-suggest-list",ref:B},C&&(be==null?void 0:be.map(function(Ne){return b.createElement(BQ,{key:(Ne==null?void 0:Ne.userId)||fs(),member:Ne,isFocused:(Ne==null?void 0:Ne.userId)===(we==null?void 0:we.userId),parentScrollRef:B,onClick:function($e){var gn=$e.member;d==null||d(gn)},onMouseOver:function($e){var gn=$e.member;ve(gn)},renderUserMentionItem:g})})),!C&&b.createElement("div",{className:"sendbird-mention-suggest-list__notice-item"},b.createElement(mn,{className:"sendbird-mention-suggest-list__notice-item__icon",type:Ye.INFO,fillColor:sn.ON_BACKGROUND_2,width:"20px",height:"20px"}),b.createElement(Ge,{className:"sendbird-mention-suggest-list__notice-item__text",type:Be.SUBTITLE_2,color:Re.ONBACKGROUND_2},q.MENTION_COUNT__OVER_LIMIT.replace("%d",String(A)))))},$R=function(n,t){var e=F.useState(!1),r=e[0],i=e[1];F.useEffect(function(){r?n():i(!0)},t)},qQ=function(n){var t,e,r=n.message,i=n.children,a=n.hasSeparator,s=n.chainTop,u=n.chainBottom,d=n.handleScroll,h=n.channel,p=n.emojiContainer,g=n.editInputDisabled,E=n.shouldRenderSuggestedReplies,y=n.isReactionEnabled,C=n.replyType,T=n.threadReplySelectType,A=n.nicknamesMap,O=n.scrollToMessage,N=n.toggleReaction,k=n.setQuoteMessage,D=n.onQuoteMessageClick,P=n.onReplyInThreadClick,U=n.onBeforeDownloadFileMessage,L=n.sendUserMessage,B=n.updateUserMessage,q=n.resendMessage,z=n.deleteMessage,Y=n.setAnimatedMessageId,Q=n.animatedMessageId,$=n.onMessageAnimated,Z=n.usedInLegacy,ne=Z===void 0?!0:Z,ue=Bh(n),pe=ue.renderUserMentionItem,he=ue.renderMessage,le=ue.renderMessageContent,we=le===void 0?function(Ae){return b.createElement(PQ,re({},Ae))}:le,ve=ue.renderSuggestedReplies,Ue=ve===void 0?function(Ae){return b.createElement(HQ,re({},Ae))}:ve,be=ue.renderCustomSeparator,Qe=ue.renderEditInput,Ne=ue.renderFileViewer,$e=ue.renderRemoveMessageModal,gn=ue.filterEmojiCategoryIds,En=Bt(),Yn=En.dateLocale,Gn=En.stringSet,Tn=Mt(),kn=Tn.config,Vn=kn.userId,Hn=kn.isOnline,Jn=kn.userMention,jn=kn.logger,On=kn.groupChannel,Ln=(Jn==null?void 0:Jn.maxMentionCount)||rk,An=(Jn==null?void 0:Jn.maxSuggestionCount)||ik,wn=F.useState(!1),We=wn[0],ln=wn[1],Pe=F.useState(!1),Ke=Pe[0],yn=Pe[1],tn=F.useState(!1),st=tn[0],Cn=tn[1],Ve=F.useState(!1),Ut=Ve[0],mt=Ve[1],ut=F.useState(""),In=ut[0],Qn=ut[1],Ct=F.useState([]),Et=Ct[0],ct=Ct[1],Qt=F.useState([]),Ot=Qt[0],ft=Qt[1],rt=F.useState(null),xn=rt[0],Oe=rt[1],Ee=F.useState(null),nn=Ee[0],Sn=Ee[1],Pn=F.useState([]),lt=Pn[0],qn=Pn[1],Fn=F.useRef(null),At=F.useRef(null),Pt=Hn&&On.enableMention&&In.length>0&&!Em(h)&&!wh(h),zn=Ck({ref:Fn},{logger:jn}),qt=(zn==null?void 0:zn.length)<Ln;F.useEffect(function(){ct(Et.filter(function(Ae){var Dn=Ae.userId,pn=Ot.indexOf(Dn);return pn<0?!1:(Ot.splice(pn,1),!0)}))},[Ot]),$R(function(){d==null||d()},[We,(t=r==null?void 0:r.reactions)===null||t===void 0?void 0:t.length]),$R(function(){d==null||d(!0)},[r==null?void 0:r.updatedAt,r==null?void 0:r.message]);var cr=F.useRef(E);F.useEffect(function(){cr.current!==E?d==null||d():cr.current=E},[E]),F.useLayoutEffect(function(){ne&&(d==null||d(!0))},[]),F.useLayoutEffect(function(){var Ae=[];return Q===r.messageId&&(At!=null&&At.current)?(Ae.push(setTimeout(function(){mt(!0)},500)),Ae.push(setTimeout(function(){Y(null),$==null||$()},1600))):mt(!1),function(){Ae.forEach(function(Dn){return clearTimeout(Dn)})}},[Q,At.current,r.messageId]);var Fe=F.useMemo(function(){var Ae;return(Ae=be==null?void 0:be({message:r}))!==null&&Ae!==void 0?Ae:null},[r,be]),un=function(){if(i)return i;if(he){var Ae=re(re({},n),{renderMessage:void 0});return he(Ae)}return b.createElement(b.Fragment,null,we({className:"sendbird-message-hoc__message-content",userId:Vn,scrollToMessage:O,channel:h,message:r,disabled:!Hn,chainTop:s,chainBottom:u,isReactionEnabled:y,replyType:C,threadReplySelectType:T,nicknamesMap:A,emojiContainer:p,showEdit:ln,showRemove:yn,showFileViewer:Cn,resendMessage:q,deleteMessage:z,toggleReaction:N,setQuoteMessage:k,onReplyInThread:P,onQuoteMessageClick:D,onMessageHeightChange:d,onBeforeDownloadFileMessage:U,filterEmojiCategoryIds:gn}),E&&Ue({replyOptions:TO(r),onSendMessage:L,type:On==null?void 0:On.suggestedRepliesDirection}),Ke&&($e==null?void 0:$e({message:r,onCancel:function(){return yn(!1)}})),st&&Ne({message:r,onCancel:function(){return Cn(!1)}}))};return We&&(!((e=r==null?void 0:r.isUserMessage)===null||e===void 0)&&e.call(r))?(Qe==null?void 0:Qe())||b.createElement(b.Fragment,null,Pt&&b.createElement(dD,{currentChannel:h,targetNickname:In,inputEvent:xn??void 0,renderUserMentionItem:pe,onUserItemClick:function(Ae){Ae&&ct(en(en([],Et,!0),[Ae],!1)),Qn(""),Sn(Ae),Oe(null)},onFocusItemChange:function(){Oe(null)},onFetchUsers:function(Ae){qn(Ae)},ableAddMention:qt,maxMentionCount:Ln,maxSuggestionCount:An}),b.createElement(Pk,{isEdit:!0,channel:h,disabled:g,ref:Fn,mentionSelectedUser:nn,isMentionEnabled:On.enableMention,message:r,onStartTyping:function(){var Ae;(Ae=h==null?void 0:h.startTyping)===null||Ae===void 0||Ae.call(h)},onUpdateMessage:function(Ae){var Dn,pn=Ae.messageId,it=Ae.message,yt=Ae.mentionTemplate;B(pn,{message:it,mentionedUsers:Et,mentionedMessageTemplate:yt}),ln(!1),(Dn=h==null?void 0:h.endTyping)===null||Dn===void 0||Dn.call(h)},onCancelEdit:function(){var Ae;Qn(""),ct([]),ft([]),qn([]),ln(!1),(Ae=h==null?void 0:h.endTyping)===null||Ae===void 0||Ae.call(h)},onUserMentioned:function(Ae){(nn==null?void 0:nn.userId)===(Ae==null?void 0:Ae.userId)&&(Sn(null),Qn(""))},onMentionStringChange:function(Ae){Qn(Ae)},onMentionedUserIdsUpdated:function(Ae){ft(Ae)},onKeyDown:function(Ae){return Pt&&(lt==null?void 0:lt.length)>0&&(Ae.key===Rs.Enter&&qt||Ae.key===Rs.ArrowUp||Ae.key===Rs.ArrowDown)?(Oe(Ae),!0):!1}})):b.createElement("div",{className:Rt("sendbird-msg-hoc sendbird-msg--scroll-ref",Ut&&"sendbird-msg-hoc__animated"),"data-testid":"sendbird-message-view",style:i||he?void 0:{marginBottom:"2px"},"data-sb-message-id":r.messageId,"data-sb-created-at":r.createdAt,ref:At},a&&(Fe||b.createElement(hW,null,b.createElement(Ge,{type:Be.CAPTION_2,color:Re.ONBACKGROUND_2},su(r.createdAt,Gn.DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR,{locale:Yn})))),un())},zQ=function(n){var t=n.message,e=n.onCancel,r=n.deleteMessage,i=n.onDownloadClick,a=t.sender,s=t.type,u=t.url,d=t.name,h=d===void 0?"":d,p=t.threadInfo,g=a.profileUrl,E=a.nickname,y=a.userId,C=Mt().config;return Tc.createPortal(b.createElement(KQ,{profileUrl:g,nickname:E,type:s,url:u,name:h,onCancel:e,onDelete:function(){return r(t).then(function(){return e()})},isByMe:C.userId===y,disableDelete:p!=null&&p.replyCount?p.replyCount>0:!1,onDownloadClick:i}),document.getElementById(td))},KQ=function(n){var t=n.profileUrl,e=n.nickname,r=n.name,i=n.type,a=n.url,s=n.isByMe,u=n.onCancel,d=n.onDelete,h=n.disableDelete,p=n.onDownloadClick;return b.createElement(Za,{onClose:u},b.createElement("div",{className:"sendbird-fileviewer","data-testid":"sendbird-fileviewer"},b.createElement("div",{className:"sendbird-fileviewer__header"},b.createElement("div",{className:"sendbird-fileviewer__header__left"},b.createElement("div",{className:"sendbird-fileviewer__header__left__avatar"},b.createElement(Na,{height:"32px",width:"32px",src:t})),b.createElement("div",{className:"sendbird-fileviewer__header__left__text-container"},b.createElement(Ge,{className:"sendbird-fileviewer__header__left__filename",type:Be.H_2,color:Re.ONBACKGROUND_1},r),b.createElement(Ge,{className:"sendbird-fileviewer__header__left__sender-name",type:Be.BODY_1,color:Re.ONBACKGROUND_2},e))),b.createElement("div",{className:"sendbird-fileviewer__header__right"},Sh(i)&&b.createElement("div",{className:"sendbird-fileviewer__header__right__actions"},b.createElement("a",{className:"sendbird-fileviewer__header__right__actions__download",rel:"noopener noreferrer",href:a,target:"_blank",onClick:p},b.createElement(mn,{type:Ye.DOWNLOAD,fillColor:sn.ON_BACKGROUND_1,height:"24px",width:"24px"})),d&&s&&b.createElement("div",{className:"sendbird-fileviewer__header__right__actions__delete"},b.createElement(mn,{className:h?"disabled":"",type:Ye.DELETE,fillColor:h?sn.GRAY:sn.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(){h||d()}}))),b.createElement("div",{className:"sendbird-fileviewer__header__right__actions__close"},b.createElement(mn,{type:Ye.CLOSE,fillColor:sn.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:u})))),b.createElement("div",{className:"sendbird-fileviewer__content"},Ho(i)&&b.createElement("video",{controls:!0,className:"sendbird-fileviewer__content__video"},b.createElement("source",{src:a,type:i})),zu(i)&&b.createElement("img",{src:a,alt:r,className:"sendbird-fileviewer__content__img"}),!Sh(i)&&b.createElement("div",{className:"sendbird-fileviewer__content__unsupported"},b.createElement(Ge,{type:Be.H_1,color:Re.ONBACKGROUND_1},dd.UI__FILE_VIEWER__UNSUPPORT)))))},WQ=function(n){var t=Vo().deleteMessage;return b.createElement(zQ,re({},n,{deleteMessage:t}))};function $Q(n,t){return Mi(t).when(ca,function(){var e=t.fileInfoList.length;return"Do you want to delete all ".concat(e," photos?")}).otherwise(function(){return n.MODAL__DELETE_MESSAGE__TITLE})}var YQ=function(n){var t,e=n.onSubmit,r=e===void 0?function(){}:e,i=n.onCancel,a=n.message,s=n.deleteMessage,u=F.useContext(kr).stringSet;return b.createElement(Za,{type:Br.DANGER,disabled:!((t=a==null?void 0:a.threadInfo)===null||t===void 0)&&t.replyCount?a.threadInfo.replyCount>0:void 0,onCancel:i,onSubmit:function(){(a.isUserMessage()||a.isFileMessage()||a.isMultipleFilesMessage())&&s(a).then(function(){r(),i()})},submitText:u.MESSAGE_MENU__DELETE,titleText:$Q(u,a)})},QQ=function(n){var t=Vo().deleteMessage;return b.createElement(YQ,re({},n,{deleteMessage:t}))},YR=function(n){var t,e,r=Mt().config,i=Vo(),a=i.initialized,s=i.currentGroupChannel,u=i.animatedMessageId,d=i.setAnimatedMessageId,h=i.updateMessage,p=i.scrollToMessage,g=i.replyType,E=i.threadReplySelectType,y=i.isReactionEnabled,C=i.toggleReaction,T=i.emojiContainer,A=i.nicknamesMap,O=i.setQuoteMessage,N=i.resendMessage,k=i.deleteMessage,D=i.renderUserMentionItem,P=i.onReplyInThread,U=i.onQuoteMessageClick,L=i.onMessageAnimated,B=i.sendMessage,q=i.localMessages,z=i.allMessages,Y=n.message;return s?b.createElement(qQ,re({},n,{channel:s,emojiContainer:T,editInputDisabled:!a||qz(s)||zz(s)||!r.isOnline,shouldRenderSuggestedReplies:((t=r==null?void 0:r.groupChannel)===null||t===void 0?void 0:t.enableSuggestedReplies)&&(((e=r==null?void 0:r.groupChannel)===null||e===void 0?void 0:e.showSuggestedRepliesFor)==="all_messages"?!0:Y.messageId===z[z.length-1].messageId)&&(q==null?void 0:q.length)===0&&TO(Y).length>0,isReactionEnabled:y,replyType:g,threadReplySelectType:E,nicknamesMap:A,renderUserMentionItem:D,scrollToMessage:p,toggleReaction:C,setQuoteMessage:O,onQuoteMessageClick:U,onReplyInThreadClick:P,sendUserMessage:function(Q){B({message:Q.message,mentionedUsers:Q.mentionedUsers,mentionTemplate:Q.mentionedMessageTemplate})},updateUserMessage:function(Q,$){var Z;h({messageId:Q,message:(Z=$.message)!==null&&Z!==void 0?Z:"",mentionedUsers:$.mentionedUsers,mentionTemplate:$.mentionedMessageTemplate})},resendMessage:N,deleteMessage:k,animatedMessageId:u,setAnimatedMessageId:d,onMessageAnimated:L,renderFileViewer:function(Q){return b.createElement(WQ,re({},Q))},renderRemoveMessageModal:function(Q){return b.createElement(QQ,re({},Q))}})):null},ZQ=function(n){var t=n.className,e=t===void 0?"":t,r=n.count,i=r===void 0?0:r,a=n.time,s=a===void 0?"":a,u=n.onClick,d=n.lastReadAt,h=F.useContext(kr),p=h.stringSet,g=h.dateLocale,E=F.useMemo(function(){var y,C;if(p.CHANNEL__MESSAGE_LIST__NOTIFICATION__ON!=="on"){var T=((C=(y=s==null?void 0:s.toString)===null||y===void 0?void 0:y.call(s))===null||C===void 0?void 0:C.split(" "))||[];return T==null||T.splice(-2,0,p.CHANNEL__MESSAGE_LIST__NOTIFICATION__ON),T.join(" ")}else if(d)return su(d,p.DATE_FORMAT__MESSAGE_LIST__NOTIFICATION__UNREAD_SINCE,{locale:g})},[s,d]);return b.createElement("div",{className:Rt(i<1?"sendbird-notification--hide":"sendbird-notification",e),"data-testid":"sendbird-notification",onClick:u},b.createElement(Ge,{className:"sendbird-notification__text",testID:"sendbird-notification__text",color:Re.ONCONTENT_1,type:Be.CAPTION_2},"".concat(i," "),p.CHANNEL__MESSAGE_LIST__NOTIFICATION__NEW_MESSAGE," ".concat(E)),b.createElement(mn,{width:"24px",height:"24px",type:Ye.CHEVRON_DOWN,fillColor:sn.CONTENT}))},XQ=function(n){var t=n.className,e=t===void 0?"":t,r=F.useContext(kr).stringSet;return b.createElement("div",{className:Rt("sendbird-notification","sendbird-notification--frozen",e),"data-testid":"sendbird-notification"},b.createElement(Ge,{className:"sendbird-notification__text",testID:"sendbird-notification__text",type:Be.CAPTION_2},r.CHANNEL_FROZEN))};function XC(n,t,e){e===void 0&&(e={leading:!0,trailing:!1});var r=F.useRef(null),i=F.useRef(null);return F.useEffect(function(){return function(){r.current&&clearTimeout(r.current)}},[]),Ph(function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(r.current){i.current=a;return}e.leading?n.apply(void 0,a):i.current=a;var u=function(){e.trailing&&i.current?(n.apply(void 0,i.current),i.current=null,r.current=setTimeout(u,t)):r.current=null};r.current=setTimeout(u,t)})}var JQ=100;function eZ(n,t){return n-t}function nZ(n){var t=n.hasMore,e=n.hasNext,r=n.onScroll,i=n.scrollRef,a=n.setShowScrollDownButton,s=Ph(function(){var u=i==null?void 0:i.current;if(u!=null){var d=u.scrollTop,h=u.scrollHeight,p=u.clientHeight,g=eZ(h,d);typeof a=="function"&&a(h>d+p+1),t&&Yl(d,0,So)&&r(function(){var E=u.scrollHeight>h;E&&(u.scrollTop=u.scrollHeight-g)}),e&&Yl(p+d,h,So)&&r(function(){var E=u.scrollHeight>h;E&&(u.scrollTop=d)})}});return XC(s,JQ,{trailing:!0})}var tZ=function(){return b.createElement("div",{className:"typing-dots-container"},b.createElement("span",null),b.createElement("span",null),b.createElement("span",null))},cD=2,kh=28,QR=kh+cD*2,Kb=24,g_=3,rZ=cD,iZ=function(n){var t=n.sources,e=n.max;return b.createElement(b.Fragment,null," ",t.slice(0,e).map(function(r,i){return b.createElement(Na,{className:"sendbird-message-content__left__avatar multiple",src:r||"",key:"avatar_stack_item_".concat(r),width:"".concat(kh,"px"),height:"".concat(kh,"px"),zIndex:i,left:"".concat(i*Kb-rZ,"px")})})," ")},aZ=function(n){var t=n.typingMembers,e=t.length,r=Math.min(e,4),i=e-g_,a=(r-1)*(QR-Kb),s=12;return b.createElement("div",{className:"sendbird-message-content__left incoming",style:{minWidth:r*QR-a+s}},b.createElement(iZ,{sources:t.map(function(u){return u.profileUrl}),max:g_}),i>0?b.createElement(Na,{className:"sendbird-message-content__left__avatar multiple",width:"".concat(kh,"px"),height:"".concat(kh,"px"),zIndex:g_,left:"".concat(g_*Kb,"px"),customDefaultComponent:function(u){var d=u.width,h=u.height;return b.createElement(gk,{width:d,height:h,text:"+".concat(i)})}}):null)},sZ=function(n){var t=n.typingMembers,e=n.handleScroll;return F.useLayoutEffect(function(){e==null||e(!0)},[]),t.length===0?null:b.createElement("div",{className:"sendbird-message-content incoming",style:{marginBottom:"2px"}},b.createElement(aZ,{typingMembers:t}),b.createElement("div",{className:"sendbird-message-content__middle"},b.createElement(tZ,null)))},uZ=100;function fD(n){var t=n.onReachedTop,e=n.onReachedBottom,r=n.onInBetween,i=Ph(function(a){if(a!=null&&a.target){var s=a.target,u=s.scrollTop,d=s.scrollHeight,h=s.clientHeight,p={distanceFromBottom:d-u-h};t&&Yl(u,0,So)?t(p):e&&Yl(d,h+u,So)?e(p):r&&r(p)}});return XC(i,uZ,{trailing:!0})}var oZ=function(n,t,e,r,i){if(!r||r.channelType!=="group")return[v_(n,t),v_(t,e)];if(i==="THREAD"&&(t!=null&&t.threadInfo))return[!1,!1];var a=(t==null?void 0:t.sendingStatus)||"",s=a!=="pending"&&a!=="failed";return[v_(n,t,r)&&s,v_(t,e,r)&&s]},ZR=function(n){var t=Bt().stringSet;return su(n.createdAt,t.DATE_FORMAT__MESSAGE_CREATED_AT)},v_=function(n,t,e){var r,i;return n&&t&&n.messageType&&n.messageType!=="admin"&&t.messageType&&(t==null?void 0:t.messageType)!=="admin"&&"sender"in n&&"sender"in t&&n.createdAt&&t.createdAt&&n.sender.userId&&t.sender.userId?(n==null?void 0:n.sendingStatus)===(t==null?void 0:t.sendingStatus)&&((r=n==null?void 0:n.sender)===null||r===void 0?void 0:r.userId)===((i=t==null?void 0:t.sender)===null||i===void 0?void 0:i.userId)&&ZR(n)===ZR(t)&&(e?lA(e,n)===lA(e,t):!0):!1},XR=function(n){var t=n.allMessages,e=t===void 0?[]:t,r=n.isMessageGroupingEnabled,i=r===void 0?!0:r,a=n.currentIndex,s=a===void 0?0:a,u=n.currentMessage,d=n.currentChannel,h=d===void 0?null:d,p=n.replyType,g=p===void 0?"":p,E=e[s-1],y=e[s+1],C=i?oZ(E,u,y,h,g):[!1,!1],T=C[0],A=C[1],O=E==null?void 0:E.createdAt,N=u.createdAt,k="sendingStatus"in u&&u.sendingStatus!=="succeeded",D=k?!1:!(O&&$C(N,O));return{chainTop:T,chainBottom:A,hasSeparator:D}},lZ=100;function dZ(n){var t=n.loading,e=F.useState(0),r=e[0],i=e[1];F.useEffect(function(){t&&i(0)},[t]);var a=function(s){var u=s.target;try{i(u.scrollHeight-u.scrollTop-u.offsetHeight)}catch{}};return{scrollBottom:r,scrollToBottomHandler:XC(a,lZ,{trailing:!0})}}function cZ(){var n=Vo(),t=n.scrollRef,e=n.scrollBehavior,r=e===void 0?"auto":e;return F.useEffect(function(){t.current&&(t.current.style.scrollBehavior=r)},[t.current]),null}var fZ=50,hZ=function(n){var t,e,r,i,a,s,u,d=n.className,h=d===void 0?"":d,p=Bh(n),g=p.renderMessage,E=p.renderMessageContent,y=p.renderSuggestedReplies,C=p.renderCustomSeparator,T=p.renderPlaceholderLoader,A=T===void 0?function(){return b.createElement(nu,{type:Ur.LOADING})}:T,O=p.renderPlaceholderEmpty,N=O===void 0?function(){return b.createElement(nu,{className:"sendbird-conversation__no-messages",type:Ur.NO_MESSAGES})}:O,k=p.renderFrozenNotification,D=k===void 0?function(){return b.createElement(XQ,{className:"sendbird-conversation__messages__notification"})}:k,P=Vo(),U=P.allMessages,L=P.localMessages,B=P.hasMorePrev,q=P.hasMoreNext,z=P.setInitialTimeStamp,Y=P.setAnimatedMessageId,Q=P.setHighLightedMessageId,$=P.isMessageGroupingEnabled,Z=P.scrollRef,ne=P.onScrollCallback,ue=P.onScrollDownCallback,pe=P.messagesDispatcher,he=P.messageActionTypes,le=P.currentGroupChannel,we=P.disableMarkAsRead,ve=P.filterMessageList,Ue=P.replyType,be=P.loading,Qe=P.isScrolled,Ne=P.unreadSince,$e=P.unreadSinceDate,gn=P.typingMembers,En=Mt(),Yn=typeof ve=="function"?U.filter(ve):U,Gn=En.config.markAsReadScheduler,Tn=F.useState(!1),kn=Tn[0],Vn=Tn[1];cZ();var Hn=function(ln){var Pe=Z==null?void 0:Z.current;if(Pe!=null){var Ke=Pe.scrollTop,yn=Pe.clientHeight,tn=Pe.scrollHeight;B&&Yl(Ke,0,So)&&ne(ln),q&&Yl(yn+Ke,tn,So)&&ue(ln),!we&&Yl(yn+Ke,tn,So)&&le&&(pe({type:he.MARK_AS_READ,payload:{channel:le}}),Gn.push(le))}},Jn=function(){var ln,Pe;z==null||z(null),Y==null||Y(null),Q==null||Q(null),Z.current&&Z.current.scrollTop>-1&&(Z.current.scrollTop=((ln=Z.current.scrollHeight)!==null&&ln!==void 0?ln:0)-((Pe=Z.current.offsetHeight)!==null&&Pe!==void 0?Pe:0))},jn=function(ln){ln===void 0&&(ln=!1);var Pe=Z==null?void 0:Z.current;if(Pe){var Ke=Pe.scrollHeight-Pe.scrollTop-Pe.offsetHeight;We<Ke&&(!ln||We<So)&&(Pe.scrollTop+=Ke-We)}},On=nZ({hasMore:B,hasNext:q,onScroll:Hn,scrollRef:Z}),Ln=fD({onReachedBottom:function(){!q&&!we&&le&&(pe({type:he.MARK_AS_READ,payload:{channel:le}}),Gn.push(le)),Vn(!0)},onReachedTop:function(){Vn(!1)},onInBetween:function(){Vn(!1)}}),An=dZ({loading:be}),wn=An.scrollToBottomHandler,We=An.scrollBottom;return be?A():Yn.length<1?N():b.createElement(b.Fragment,null,!Qe&&b.createElement(nu,{type:Ur.LOADING}),b.createElement("div",{className:"sendbird-conversation__messages ".concat(h),dir:Yj((t=En==null?void 0:En.config)===null||t===void 0?void 0:t.htmlTextDirection,(e=En==null?void 0:En.config)===null||e===void 0?void 0:e.forceLeftToRightMessageLayout)},b.createElement("div",{className:"sendbird-conversation__scroll-container"},b.createElement("div",{className:"sendbird-conversation__padding"}),b.createElement("div",{className:"sendbird-conversation__messages-padding","data-testid":"sendbird-message-list-container",ref:Z,onScroll:function(ln){On(),wn(ln),Ln(ln)}},Yn.map(function(ln,Pe){var Ke,yn,tn=XR({allMessages:Yn,replyType:Ue,isMessageGroupingEnabled:$,currentIndex:Pe,currentMessage:ln,currentChannel:le}),st=tn.chainTop,Cn=tn.chainBottom,Ve=tn.hasSeparator,Ut=((Ke=ln==null?void 0:ln.sender)===null||Ke===void 0?void 0:Ke.userId)===((yn=En==null?void 0:En.config)===null||yn===void 0?void 0:yn.userId);return b.createElement(_R,{message:ln,key:ln==null?void 0:ln.messageId,isByMe:Ut},b.createElement(YR,{handleScroll:jn,message:ln,hasSeparator:Ve,chainTop:st,chainBottom:Cn,renderMessageContent:E,renderSuggestedReplies:y,renderCustomSeparator:C,renderMessage:g}))}),L.map(function(ln,Pe){var Ke,yn,tn=XR({allMessages:Yn,replyType:Ue,isMessageGroupingEnabled:$,currentIndex:Pe,currentMessage:ln,currentChannel:le}),st=tn.chainTop,Cn=tn.chainBottom,Ve=((Ke=ln==null?void 0:ln.sender)===null||Ke===void 0?void 0:Ke.userId)===((yn=En==null?void 0:En.config)===null||yn===void 0?void 0:yn.userId);return b.createElement(_R,{message:ln,key:ln==null?void 0:ln.messageId,isByMe:Ve},b.createElement(YR,{handleScroll:jn,message:ln,chainTop:st,chainBottom:Cn,renderMessageContent:E,renderSuggestedReplies:y,renderCustomSeparator:C,renderMessage:g}))}),!q&&((i=(r=En==null?void 0:En.config)===null||r===void 0?void 0:r.groupChannel)===null||i===void 0?void 0:i.enableTypingIndicator)&&((u=(s=(a=En==null?void 0:En.config)===null||a===void 0?void 0:a.groupChannel)===null||s===void 0?void 0:s.typingIndicatorTypes)===null||u===void 0?void 0:u.has(vm.Bubble))&&b.createElement(sZ,{typingMembers:gn,handleScroll:jn}))),(le==null?void 0:le.isFrozen)&&D(),(!kn||q)&&(Ne||$e)&&b.createElement(ZQ,{className:"sendbird-conversation__messages__notification",count:le==null?void 0:le.unreadMessageCount,time:Ne,lastReadAt:$e,onClick:function(){Z!=null&&Z.current&&(Z.current.scrollTop=Z.current.scrollHeight),!we&&le&&(Gn.push(le),pe({type:he.MARK_AS_READ,payload:{channel:le}})),z(null),Y(null),Q(null)}}),We>fZ&&b.createElement("div",{className:"sendbird-conversation__scroll-bottom-button",onClick:Jn,onKeyDown:Jn,tabIndex:0,role:"button"},b.createElement(mn,{width:"24px",height:"24px",type:Ye.CHEVRON_DOWN,fillColor:sn.PRIMARY}))))},pZ=function(n){return b.createElement(dD,re({},n))},E_="sendbird-quote_message_input__avatar";function _Z(n){var t,e=n.message;if(!Xi(e)&&!ca(e)||ou(e))return b.createElement(b.Fragment,null);var r=Wk(e);return r||(yO(e)||hc(e)?r=Cm(e):ca(e)&&xj((t=e.fileInfoList)===null||t===void 0?void 0:t[0])&&(r=e.fileInfoList[0].url)),hc(e)&&r?b.createElement("div",{className:E_},b.createElement("video",{style:{width:"44px",height:"44px"},src:r})):(Go(e)||ca(e))&&r?b.createElement(ui,{className:E_,url:r,alt:bm(e),width:"44px",height:"44px",fixedSize:!0}):Lj(e)?b.createElement("div",{className:E_},b.createElement(mn,{type:Ye.FILE_AUDIO,fillColor:sn.ON_BACKGROUND_2,width:"24px",height:"24px"})):b.createElement("div",{className:E_},b.createElement(mn,{type:Ye.FILE_DOCUMENT,fillColor:sn.ON_BACKGROUND_2,width:"24px",height:"24px"}))}function mZ(n){var t=n.className,e=n.replyingMessage,r=n.onClose,i=F.useContext(kr).stringSet,a=e,s=e==null?void 0:e.sender,u=(Xi(e)||ca(e))&&!ou(e);return b.createElement("div",{className:ma(["sendbird-quote_message_input",t??""])},u&&b.createElement(_Z,{message:a}),b.createElement("div",{className:"sendbird-quote_message_input__body",style:{width:"calc(100% - ".concat(u?"164px":"120px",")"),left:u?"92px":"40px"}},b.createElement(Ge,{className:"sendbird-quote_message_input__body__sender-name",type:Be.CAPTION_1,color:Re.ONBACKGROUND_1},"".concat(i.QUOTE_MESSAGE_INPUT__REPLY_TO," ").concat(s&&s.nickname?s.nickname:i.NO_NAME)),b.createElement(Ge,{className:"sendbird-quote_message_input__body__message-content",type:Be.BODY_2,color:Re.ONBACKGROUND_3},yO(a)&&!Ny(a)&&i.QUOTE_MESSAGE_INPUT__FILE_TYPE_IMAGE,hc(a)&&i.QUOTE_MESSAGE_INPUT__FILE_TYPE__VIDEO,Ny(a)&&i.QUOTE_MESSAGE_INPUT__FILE_TYPE_GIF,ha(e)&&e.message,EC(e)===Ws.FILE&&Kk(a),ca(e)&&"".concat(a.fileInfoList.length," Photos"),ou(e)&&i.VOICE_MESSAGE)),b.createElement(mn,{className:"sendbird-quote_message_input__close-button",type:Ye.CLOSE,fillColor:sn.ON_BACKGROUND_2,width:"24px",height:"24px",onClick:function(){return r==null?void 0:r(e)}}))}var Ul={PREPARING:"PREPARING",READY_TO_RECORD:"READY_TO_RECORD",RECORDING:"RECORDING",COMPLETED:"COMPLETED"},gZ=function(n){var t=n.onRecordingStarted,e=t===void 0?ur:t,r=n.onRecordingEnded,i=r===void 0?ur:r,a=Mt().config,s=a.voiceRecord,u=s.maxRecordingTime,d=XO(),h=d.isRecordable,p=F.useState(null),g=p[0],E=p[1],y=F.useState(Ul.PREPARING),C=y[0],T=y[1];F.useEffect(function(){h&&C===Ul.PREPARING&&T(Ul.READY_TO_RECORD)},[h]);var A=F.useCallback(function(){d==null||d.start({onRecordingStarted:function(){T(Ul.RECORDING),e(),L()},onRecordingEnded:function(q){T(Ul.COMPLETED),i(q),E(q),B()}})},[e,i]),O=F.useCallback(function(){d==null||d.stop(),B()},[d]),N=F.useCallback(function(){O(),E(null)},[d]),k=F.useState(0),D=k[0],P=k[1],U=F.useRef(null);function L(){B(),P(0),U.current=setInterval(function(){P(function(q){var z=q+100;return z>u&&B(),z})},100)}function B(){U.current&&(clearInterval(U.current),U.current=null)}return F.useEffect(function(){D>u&&O()},[D,u,O]),{start:A,stop:O,cancel:N,recordingStatus:C,recordingTime:D,recordedFile:g,recordingLimit:u}},ei={READY_TO_RECORD:"READY_TO_RECORD",RECORDING:"RECORDING",READY_TO_PLAY:"READY_TO_PLAY",PLAYING:"PLAYING"},vZ=function(n){var t=n.inputState;switch(t){case ei.READY_TO_RECORD:return b.createElement("div",{className:"sendbird-controler-icon record-icon"});case ei.RECORDING:return b.createElement("div",{className:"sendbird-controler-icon stop-icon"});case ei.READY_TO_PLAY:return b.createElement(mn,{className:"sendbird-controler-icon play-icon",width:"20px",height:"20px",type:Ye.PLAY,fillColor:sn.ON_BACKGROUND_1});case ei.PLAYING:return b.createElement("div",{className:"sendbird-controler-icon pause-icon"},b.createElement("div",{className:"sendbird-controler-icon pause-icon-inner"}),b.createElement("div",{className:"sendbird-controler-icon pause-icon-inner"}));default:return b.createElement(b.Fragment,null)}},EZ=function(n){var t=n.minRecordTime,e=t===void 0?cO:t,r=n.maximumValue,i=n.currentValue,a=i===void 0?0:i,s=n.currentType,u=n.onCancelClick,d=n.onControlClick,h=n.onSubmitClick,p=n.renderCancelButton,g=n.renderControlButton,E=n.renderSubmitButton,y=F.useState(0),C=y[0],T=y[1],A=F.useMemo(function(){return s===ei.READY_TO_RECORD},[s]),O=F.useMemo(function(){return s===ei.RECORDING},[s]),N=F.useMemo(function(){return s===ei.READY_TO_RECORD||s===ei.RECORDING?e>a:!1},[s,e,a]),k=F.useMemo(function(){return s===ei.READY_TO_PLAY||s===ei.PLAYING},[s]),D=Bt().stringSet,P=function(){var B=Date.now();B-C>CE&&(u==null||u(),T(B))},U=F.useCallback(function(){var B=Date.now();B-C>CE&&(d==null||d(s),T(B))},[s]),L=function(){var B=Date.now();B-C>CE&&(N||h==null||h(),T(B))};return b.createElement("div",{className:"sendbird-voice-message-input"},b.createElement("div",{className:"sendbird-voice-message-input__indicator"},b.createElement("div",{className:"sendbird-voice-message-input__indicator__progress-bar"},b.createElement($k,{className:"sendbird-voice-message-input__indicator__progress-bar__bar",disabled:A,maxSize:r,currentSize:a})),O?b.createElement("div",{className:"sendbird-voice-message-input__indicator__on-rec"}):null,b.createElement(Qk,{className:"sendbird-voice-message-input__indicator__playback-time",time:k?r-a:a,labelColor:A?Re.ONBACKGROUND_4:Re.ONCONTENT_1})),b.createElement("div",{className:"sendbird-voice-message-input__controler"},(p==null?void 0:p())||b.createElement(jh,{className:"sendbird-voice-message-input__controler__cancel",onClick:P,disableUnderline:!0},b.createElement(Ge,{type:Be.BUTTON_1,color:Re.PRIMARY},D.BUTTON__CANCEL)),(g==null?void 0:g(s))||b.createElement("div",{className:"sendbird-voice-message-input__controler__main",onClick:U},b.createElement(vZ,{inputState:s})),(E==null?void 0:E())||b.createElement("div",{className:Rt("sendbird-voice-message-input__controler__submit",N&&"voice-message--disabled"),onClick:L},b.createElement(mn,{width:"19px",height:"19px",type:Ye.SEND,fillColor:N?sn.ON_BACKGROUND_4:sn.CONTENT}))))},yZ=function(n){var t=n.imageFile,e=n.compressionRate,r=n.resizingWidth,i=n.resizingHeight,a=n.outputFormat,s=document.createElement("img");return new Promise(function(u,d){s.src=URL.createObjectURL(t),s.onerror=d,s.onload=function(){URL.revokeObjectURL(s.src);var h=document.createElement("canvas"),p=s.width,g=s.height,E=!r||r>p?p:r,y=!i||i>g?g:i,C=p/E,T=g/y;C>T?y=g/(r?C:1):T>C&&(E=p/(i?T:1)),h.width=E,h.height=y;var A=h.getContext("2d");if(!A){d(new Error("Failed to get canvas 2d context"));return}A.drawImage(s,0,0,E,y);var O=a==="preserve"?t.type:"image/".concat(a),N=O.split("/").pop(),k=t.name.lastIndexOf("."),D="".concat(k===-1?t.name:t.name.substring(0,k),".").concat(N);A.canvas.toBlob(function(P){if(P){var U=new File([P],D,{type:O});u(U)}else d(new Error("Failed to compress image"))},O,e)}})},bZ=function(n){return Ar(void 0,[n],void 0,function(t){var e,r,i,a,s,u,d=t.files,h=t.logger,p=t.imageCompression;return wr(this,function(g){switch(g.label){case 0:return e=p.compressionRate,r=p.outputFormat,i=r===void 0?"preserve":r,a=p.resizingWidth?Cc(p.resizingWidth):void 0,s=p.resizingHeight?Cc(p.resizingHeight):void 0,u={failedIndexes:[],compressedFiles:[]},Array.isArray(d)&&d.length>0?!e||e<0||1<e?(h==null||h.warning("utils - compressImages: The compressionRate is not acceptable.",e),[2,u]):[4,Promise.all(d.map(function(E,y){return Ar(void 0,void 0,void 0,function(){var C,T;return wr(this,function(A){switch(A.label){case 0:if(!(E.type==="image/jpg"||E.type==="image/png"||E.type==="image/jpeg"))return h==null||h.warning("utils - compressImages: The fileType is not compressible.",{file:E,index:y}),u.failedIndexes.push(y),u.compressedFiles.push(E),[2];A.label=1;case 1:return A.trys.push([1,3,,4]),[4,yZ({imageFile:E,compressionRate:e,resizingWidth:a,resizingHeight:s,outputFormat:i})];case 2:return C=A.sent(),u.compressedFiles.push(C),[3,4];case 3:return T=A.sent(),u.compressedFiles.push(E),u.failedIndexes.push(y),h==null||h.warning("utils - compressImages: Failed to compress image file",{file:E,err:T}),[3,4];case 4:return[2]}})})}))]:(h==null||h.warning("utils - compressImages: There are no files.",d),[2,u]);case 1:return g.sent(),h==null||h.info("utils - compressImages: Finished compressing images",u),[2,u]}})})},CZ=function(n){var t=n.channel,e=n.onCancelClick,r=n.onSubmitClick,i=F.useRef(fs()).current,a=F.useState(null),s=a[0],u=a[1],d=F.useState(ei.READY_TO_RECORD),h=d[0],p=d[1],g=F.useState(!1),E=g[0],y=g[1],C=F.useState(!1),T=C[0],A=C[1],O=F.useState(!1),N=O[0],k=O[1],D=Bt().stringSet,P=Mt().config,U=gZ({onRecordingStarted:function(){p(ei.RECORDING)},onRecordingEnded:function(le){u(le)}}),L=U.start,B=U.stop,q=U.cancel,z=U.recordingTime,Y=U.recordingStatus,Q=U.recordingLimit,$=Yk({channelUrl:t==null?void 0:t.url,key:i,audioFile:s??void 0}),Z=$.play,ne=$.pause,ue=$.playbackTime,pe=$.playingStatus,he=$.stop;return F.useEffect(function(){Em(t)||wh(t)?A(!0):A(!1)},[t==null?void 0:t.myRole,t==null?void 0:t.isFrozen,t==null?void 0:t.myMutedState]),F.useEffect(function(){E&&s&&(r==null||r(s,z),y(!1),u(null))},[E,s,z]),F.useEffect(function(){s&&(z<P.voiceRecord.minRecordingTime?(p(ei.READY_TO_RECORD),u(null)):pe===Ns.PLAYING?p(ei.PLAYING):p(ei.READY_TO_PLAY))},[s,z,pe]),b.createElement("div",{className:"sendbird-voice-message-input-wrapper"},b.createElement(EZ,{currentValue:Y===Ul.COMPLETED?ue:z,maximumValue:Y===Ul.COMPLETED?z:Q,currentType:h,onCancelClick:function(){e==null||e(),q(),he()},onSubmitClick:function(){T?(k(!0),p(ei.READY_TO_RECORD)):(B(),ne(),y(!0))},onControlClick:function(le){switch(le){case ei.READY_TO_RECORD:{he(),L();break}case ei.RECORDING:{z>=P.voiceRecord.minRecordingTime&&!T?B():T?(q(),k(!0),p(ei.READY_TO_RECORD)):(q(),p(ei.READY_TO_RECORD));break}case ei.READY_TO_PLAY:{Z();break}case ei.PLAYING:{ne();break}}}}),N&&b.createElement(Za,{className:"sendbird-voice-message-input-wrapper-alert",titleText:wh(t)?D.MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED:D.MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN,hideFooter:!0,isCloseOnClickOutside:!0,onClose:function(){k(!1),e==null||e()}},b.createElement("div",{className:"sendbird-voice-message-input-wrapper-alert__body"},b.createElement(ws,{className:"sendbird-voice-message-input-wrapper-alert__body__ok-button",type:Br.PRIMARY,size:Bo.BIG,onClick:function(){k(!1),e==null||e()}},D.BUTTON__OK))))},IZ=function(n,t){var e=n.sendFileMessage,r=n.sendMultipleFilesMessage,i=n.quoteMessage,a=t.logger,s=Bt().stringSet,u=Mt().config,d=u.imageCompression,h=u==null?void 0:u.uikitUploadSizeLimit,p=u==null?void 0:u.uikitMultipleFilesMessageLimit,g=ek().openModal;return F.useCallback(function(E){return Ar(void 0,void 0,void 0,function(){var y,C,T,A,O,N;return wr(this,function(k){switch(k.label){case 0:return E.length===0?(a.warning("Channel|useHandleUploadFiles: given file list is empty.",{files:E}),[2]):E.length>p?(a.info("Channel|useHandleUploadFiles: Cannot upload files more than ".concat(p)),g({modalProps:{titleText:s.FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT.replace("%d","".concat(h)),hideFooter:!0},childElement:function(D){var P=D.closeModal;return b.createElement(_m,{type:Br.PRIMARY,submitText:s.BUTTON__OK,hideCancelButton:!0,onCancel:P,onSubmit:P})}}),[2]):E.some(function(D){return D.size>h})?(a.info("Channel|useHandleUploadFiles: Cannot upload file size exceeding ".concat(h)),y=1024*1024,g({modalProps:{titleText:s.FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT.replace("%d","".concat(Math.floor(h/y))),hideFooter:!0},childElement:function(D){var P=D.closeModal;return b.createElement(_m,{type:Br.PRIMARY,submitText:s.BUTTON__OK,hideCancelButton:!0,onCancel:P,onSubmit:P})}}),[2]):[4,bZ({files:E,imageCompression:d,logger:a})];case 1:return C=k.sent().compressedFiles,T=C,T.length===1?(a.info("Channel|useHandleUploadFiles: sending one file."),A=T[0],[2,e({file:A,parentMessageId:i==null?void 0:i.messageId})]):T.length>1?(a.info("Channel|useHandleUploadFiles: sending multiple files."),O=[],N=[],T.forEach(function(D){zu(D.type)?O.push(D):N.push(D)}),[2,N.reduce(function(D,P){return D.then(function(){return e({file:P,parentMessageId:i==null?void 0:i.messageId})})},function(){return O.length===0?Promise.resolve():O.length===1?e({file:O[0]}):r({fileInfoList:O.map(function(D){return{file:D,fileName:D.name,fileSize:D.size,mimeType:D.type}}),parentMessageId:i==null?void 0:i.messageId})}())]):[2]}})})},[e,r,i])},TZ=b.forwardRef(function(n,t){var e,r=n.currentChannel,i=n.messages,a=n.loading,s=n.quoteMessage,u=n.setQuoteMessage,d=n.messageInputRef,h=n.sendUserMessage,p=n.sendFileMessage,g=n.sendVoiceMessage,E=n.sendMultipleFilesMessage,y=n.renderUserMentionItem,C=n.renderFileUploadIcon,T=n.renderVoiceMessageIcon,A=n.renderSendMessageIcon,O=n.acceptableMimeTypes,N=n.disabled,k=Bt().stringSet,D=Zi().isMobile,P=Mt(),U=P.stores,L=P.config,B=L.isOnline,q=L.userMention,z=L.logger,Y=L.groupChannel,Q=U.sdkStore.sdk,$=q.maxMentionCount,Z=q.maxSuggestionCount,ne=r==null?void 0:r.isBroadcast,ue=(r==null?void 0:r.myRole)==="operator",pe=(e=n.isMultipleFilesMessageEnabled)!==null&&e!==void 0?e:L.isMultipleFilesMessageEnabled,he=Y.enableMention,le=Y.enableVoiceMessage,we=F.useState(""),ve=we[0],Ue=we[1],be=F.useState([]),Qe=be[0],Ne=be[1],$e=F.useState([]),gn=$e[0],En=$e[1],Yn=F.useState(null),Gn=Yn[0],Tn=Yn[1],kn=F.useState([]),Vn=kn[0],Hn=kn[1],Jn=F.useState(null),jn=Jn[0],On=Jn[1],Ln=F.useState(!1),An=Ln[0],wn=Ln[1],We=a||!r||!Q||!Q.isCacheEnabled&&!B||Em(r)||wh(r)||Vw(r,L.groupChannel.enableSuggestedReplies)||jw(i,L.groupChannel.enableFormTypeMessage)||N,ln=!We&&he&&ve.length>0&&!ne,Pe=Ck({ref:t||d},{logger:z}),Ke=(Pe==null?void 0:Pe.length)<$;F.useEffect(function(){Ue(""),Ne([]),En([]),Tn(null),Hn([]),On(null),wn(!1)},[r==null?void 0:r.url]),F.useEffect(function(){Ne(Qe.filter(function(tn){var st=tn.userId,Cn=gn.indexOf(st);return Cn<0?!1:(gn.splice(Cn,1),!0)}))},[gn]);var yn=IZ({sendFileMessage:p,sendMultipleFilesMessage:E,quoteMessage:s??void 0},{logger:z});return ne&&!ue?null:b.createElement("div",{className:An?"sendbird-message-input-wrapper--voice-message":"sendbird-message-input-wrapper"},ln&&b.createElement(pZ,{currentChannel:r,targetNickname:ve,inputEvent:jn??void 0,renderUserMentionItem:y,onUserItemClick:function(tn){tn&&Ne(en(en([],Qe,!0),[tn],!1)),Ue(""),Tn(tn),On(null)},onFocusItemChange:function(){On(null)},onFetchUsers:function(tn){Hn(tn)},ableAddMention:Ke,maxMentionCount:$,maxSuggestionCount:Z}),s&&b.createElement("div",{className:"sendbird-message-input-wrapper__quote-message-input"},b.createElement(mZ,{replyingMessage:s,onClose:function(){return u(null)}})),An?b.createElement(CZ,{channel:r??void 0,onSubmitClick:function(tn,st){g({file:tn,parentMessageId:s==null?void 0:s.messageId},st),u(null),wn(!1)},onCancelClick:function(){wn(!1)}}):b.createElement(Pk,{className:"sendbird-message-input-wrapper__message-input",channel:r,channelUrl:r==null?void 0:r.url,isMobile:D,acceptableMimeTypes:O,mentionSelectedUser:Gn,isMentionEnabled:he,isVoiceMessageEnabled:le,isSelectingMultipleFilesEnabled:pe,onVoiceMessageIconClick:function(){wn(!0)},setMentionedUsers:Ne,placeholder:s&&k.MESSAGE_INPUT__QUOTE_REPLY__PLACE_HOLDER||Em(r)&&k.MESSAGE_INPUT__PLACE_HOLDER__FROZEN||wh(r)&&(D?k.MESSAGE_INPUT__PLACE_HOLDER__MUTED_SHORT:k.MESSAGE_INPUT__PLACE_HOLDER__MUTED)||Vw(r,L.groupChannel.enableSuggestedReplies)&&k.MESSAGE_INPUT__PLACE_HOLDER__SUGGESTED_REPLIES||jw(i,L.groupChannel.enableFormTypeMessage)&&k.MESSAGE_INPUT__PLACE_HOLDER__MESSAGE_FORM||N&&k.MESSAGE_INPUT__PLACE_HOLDER__DISABLED||void 0,ref:t||d,disabled:We,renderFileUploadIcon:C,renderSendMessageIcon:A,renderVoiceMessageIcon:T,onStartTyping:function(){r==null||r.startTyping()},onSendMessage:function(tn){var st,Cn=tn.message,Ve=tn.mentionTemplate;h({message:Cn,mentionedUsers:Qe,mentionedMessageTemplate:Ve,parentMessageId:s==null?void 0:s.messageId}),Ue(""),Ne([]),u(null),(st=r==null?void 0:r.endTyping)===null||st===void 0||st.call(r)},onFileUpload:function(tn){yn(tn),u(null)},onUserMentioned:function(tn){(Gn==null?void 0:Gn.userId)===(tn==null?void 0:tn.userId)&&(Tn(null),Ue(""))},onMentionStringChange:function(tn){Ue(tn)},onMentionedUserIdsUpdated:function(tn){En(tn)},onKeyDown:function(tn){return ln&&(Vn==null?void 0:Vn.length)>0&&(tn.key===Rs.Enter&&Ke||tn.key===Rs.ArrowUp||tn.key===Rs.ArrowDown)?(On(tn),!0):!1}}))}),SZ=function(n){var t=Vo(),e=t.quoteMessage,r=t.currentGroupChannel,i=t.sendMessage,a=t.sendFileMessage,s=t.sendVoiceMessage,u=t.sendMultipleFilesMessage;return b.createElement(TZ,re({},n,t,{currentChannel:r,messages:t.allMessages,sendUserMessage:function(d){return i({message:d.message,mentionTemplate:d.mentionedMessageTemplate,mentionedUsers:d.mentionedUsers,quoteMessage:e??void 0})},sendFileMessage:function(d){return a(d.file,e??void 0)},sendVoiceMessage:function(d,h){var p=d.file;return s(p,h,e??void 0)},sendMultipleFilesMessage:function(d){var h=d.fileInfoList;return u(h.map(function(p){return p.file}),e??void 0)}}))},NZ=function(n){var t=Vo(),e=t.channelUrl,r=t.isInvalid,i=Bh(n),a=i.renderChannelHeader,s=a===void 0?function(g){return b.createElement(fW,re({},g))}:a,u=i.renderMessageList,d=u===void 0?function(g){return b.createElement(hZ,re({},g,{className:"sendbird-conversation__message-list"}))}:u,h=i.renderMessageInput,p=h===void 0?function(){return b.createElement(SZ,re({},n))}:h;return b.createElement(XK,re({},n,t,{isLoading:n==null?void 0:n.isLoading,isInvalid:r,channelUrl:e,renderChannelHeader:s,renderMessageList:d,renderMessageInput:p}))},AZ=function(n){return b.createElement(YK,re({},n),b.createElement(NZ,re({},n)))},hD="RESET_CHANNEL_LIST",pD="CREATE_CHANNEL",JC="LEAVE_CHANNEL_SUCCESS",Sm="SET_CURRENT_CHANNEL",wZ="FETCH_CHANNELS_START",e0="FETCH_CHANNELS_SUCCESS",RZ="FETCH_CHANNELS_FAILURE",n0="INIT_CHANNELS_START",_D="INIT_CHANNELS_SUCCESS",mD="REFRESH_CHANNELS_SUCCESS",gD="INIT_CHANNELS_FAILURE",vD="ON_USER_JOINED",ED="ON_CHANNEL_DELETED",ku="ON_LAST_MESSAGE_UPDATED",Wb="ON_USER_LEFT",yD="ON_CHANNEL_CHANGED",bD="ON_CHANNEL_ARCHIVED",CD="ON_CHANNEL_FROZEN",ID="ON_CHANNEL_UNFROZEN",TD="ON_READ_RECEIPT_UPDATED",SD="ON_DELIVERY_RECEIPT_UPDATED",t0="CHANNEL_LIST_PARAMS_UPDATED",MZ="delivery_receipt",OZ=function(n){var t=n.sdk,e=n.sdkChannelHandlerId,r=n.channelListDispatcher,i=n.logger,a=new Uh({onChannelChanged:function(s){s.isGroupChannel()&&(i.info("ChannelList: onChannelChanged",s),r({type:yD,payload:s}))},onChannelDeleted:function(s){i.info("ChannelList: onChannelDeleted",s),r({type:ED,payload:s})},onUserJoined:function(s){i.info("ChannelList: onUserJoined",s),r({type:vD,payload:s})},onUserBanned:function(s,u){var d;if(s.isGroupChannel()){i.info("Channel: onUserBanned",s);var h=u.userId===((d=t==null?void 0:t.currentUser)===null||d===void 0?void 0:d.userId);r({type:Wb,payload:{channel:s,isMe:h}})}},onUserLeft:function(s,u){var d;i.info("ChannelList: onUserLeft",s);var h=u.userId===((d=t==null?void 0:t.currentUser)===null||d===void 0?void 0:d.userId);r({type:Wb,payload:{channel:s,isMe:h}})},onUnreadMemberStatusUpdated:function(s){i.info("ChannelList: onUnreadMemberStatusUpdated",s),r({type:TD,payload:s})},onUndeliveredMemberStatusUpdated:function(s){i.info("ChannelList: onUndeliveredMemberStatusUpdated",s),s.lastMessage&&r({type:SD,payload:s})},onMessageUpdated:function(s,u){var d;s.isGroupChannel()&&(!((d=s.lastMessage)===null||d===void 0)&&d.isEqual(u))&&(i.info("ChannelList: onMessageUpdated",s),r({type:ku,payload:s}))},onChannelHidden:function(s){i.info("ChannelList: onChannelHidden",s),r({type:bD,payload:s})},onChannelFrozen:function(s){s.isGroupChannel()&&(i.info("ChannelList: onChannelFrozen",s),r({type:CD,payload:s}))},onChannelUnfrozen:function(s){s.isGroupChannel()&&(i.info("ChannelList: onChannelUnfrozen",s),r({type:ID,payload:s}))}});i.info("ChannelList: Added channelHandler"),t.groupChannel.addGroupChannelHandler(e,a)},ND=function(n){var t=n.sdk,e=n.userFilledChannelListQuery,r=e===void 0?{}:e,i={includeEmpty:!1,limit:20,order:Er.LATEST_LAST_MESSAGE};return r&&Object.keys(r).forEach(function(a){i[a]=r[a]}),t.groupChannel.createMyGroupChannelListQuery(i)};function kZ(n){var t,e,r,i,a=n.sdk,s=n.sdkChannelHandlerId,u=n.channelListDispatcher,d=n.setChannelSource,h=n.onChannelSelect,p=n.userFilledChannelListQuery,g=n.logger,E=n.sortChannelList,y=n.disableAutoSelect,C=n.markAsDeliveredScheduler,T=n.disableMarkAsDelivered;a!=null&&a.groupChannel?OZ({sdk:a,channelListDispatcher:u,sdkChannelHandlerId:s,logger:g}):g.warning("ChannelList - createEventHandler: sdk or sdk.ChannelHandler does not exist",a),g.info("ChannelList - creating query",{userFilledChannelListQuery:p});var A=ND({sdk:a,userFilledChannelListQuery:p});g.info("ChannelList - created query",A),d(A),u({type:n0,payload:{currentUserId:(e=(t=a==null?void 0:a.currentUser)===null||t===void 0?void 0:t.userId)!==null&&e!==void 0?e:""}}),p&&(g.info("ChannelList - setting up channelListQuery",A),u({type:t0,payload:{channelListQuery:A,currentUserId:(i=(r=a==null?void 0:a.currentUser)===null||r===void 0?void 0:r.userId)!==null&&i!==void 0?i:""}})),g.info("ChannelList - fetching channels"),A.hasNext?A.next().then(function(O){var N,k;g.info("ChannelList - fetched channels",O),g.info("ChannelList - highlight channel",O[0]);var D=O;E&&typeof E=="function"&&(D=E(O),g.info("ChannelList - channel list sorted",D)),y||h==null||h(D[0]),u({type:_D,payload:{channelList:D,disableAutoSelect:y}});var P=(k=(N=a==null?void 0:a.appInfo)===null||N===void 0?void 0:N.premiumFeatureList)===null||k===void 0?void 0:k.find(function(U){return U===MZ});P&&!T&&D.forEach(function(U){C.push(U)})}).catch(function(O){O&&(g.error("ChannelList - couldnt fetch channels",O),u({type:gD}))}):g.info("ChannelList - there are no more channels")}var DZ=function(n){n.forEach(function(t){try{t.remove()}catch{}})},LZ=function(n,t){var e=new Map;return n&&(e.set(Yi.CREATE_CHANNEL,n.subscribe(Yi.CREATE_CHANNEL,function(r){var i=r.channel;t({type:pD,payload:i})})),e.set(Yi.UPDATE_USER_MESSAGE,n.subscribe(Yi.UPDATE_USER_MESSAGE,function(r){var i,a=r.channel,s=r.message;a.isGroupChannel()&&((i=a==null?void 0:a.lastMessage)===null||i===void 0?void 0:i.messageId)===s.messageId&&(a.lastMessage=s,t({type:ku,payload:a}))})),e.set(Yi.LEAVE_CHANNEL,n.subscribe(Yi.LEAVE_CHANNEL,function(r){var i=r.channel;t({type:JC,payload:i==null?void 0:i.url})}))),e},Gf=function(n){var t=n.channel,e=n.currentChannel,r=n.allChannels,i=n.disableAutoSelect,a=null;if((e==null?void 0:e.url)===t.url){if(!i&&r.length>0){var s=r[0],u=r[1],d=u===void 0?null:u;a=s.url===t.url?d:s}}else a=e;return a},AD={initialized:!1,loading:!0,allChannels:[],currentChannel:null,channelListQuery:null,currentUserId:"",disableAutoSelect:!1};function xZ(n,t){return Mi(t).with({type:n0},function(e){var r=e.payload;return re(re({},n),{loading:!0,currentUserId:r.currentUserId})}).with({type:hD},function(){return AD}).with({type:_D},function(e){var r=e.payload,i=r.channelList,a=r.disableAutoSelect;return re(re({},n),{initialized:!0,loading:!1,allChannels:i,disableAutoSelect:a,currentChannel:!a&&i&&i.length&&i.length>0?i[0]:n.currentChannel})}).with({type:mD},function(e){var r=e.payload,i=r.channelList,a=r.currentChannel;return re(re({},n),{loading:!1,allChannels:i,currentChannel:a})}).with({type:e0},function(e){var r=n.allChannels.map(function(a){return a.url}),i=e.payload.filter(function(a){var s=a.url;return!r.find(function(u){return u===s})});return re(re({},n),{allChannels:en(en([],n.allChannels,!0),i,!0)})}).with({type:pD},function(e){var r,i=e.payload,a=n.allChannels,s=n.currentUserId,u=n.channelListQuery;return u?Jd(u,i,s)?re(re({},n),{currentChannel:i,allChannels:ec(a,i,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)}):re(re({},n),{currentChannel:i}):re(re({},n),{currentChannel:i,allChannels:en([i],a.filter(function(d){return d.url!==(i==null?void 0:i.url)}),!0)})}).with({type:bD},function(e){var r,i=e.payload,a=n.allChannels,s=n.currentUserId,u=n.currentChannel,d=n.channelListQuery,h=n.disableAutoSelect;if(d&&Jd(d,i,s))return re(re({},n),{allChannels:ec(a,i,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)});var p=Gf({channel:i,currentChannel:u,allChannels:a,disableAutoSelect:h});return re(re({},n),{currentChannel:p,allChannels:a.filter(function(g){var E=g.url;return E!==(i==null?void 0:i.url)})})}).with({type:Sy.union(JC,ED)},function(e){var r,i=e.payload,a=n.allChannels.filter(function(s){var u=s.url;return u!==i});return re(re({},n),{currentChannel:i===((r=n.currentChannel)===null||r===void 0?void 0:r.url)?a[0]:n.currentChannel,allChannels:a})}).with({type:Wb},function(e){var r,i=e.payload,a=i.channel,s=i.isMe,u=n.allChannels,d=n.currentUserId,h=n.currentChannel,p=n.channelListQuery,g=n.disableAutoSelect,E=en([],u,!0),y=a;if(s||p&&!Jd(p,a,d)){var C=u.findIndex(function(T){return T.url===a.url});C>-1&&(E.splice(C,1),y=Gf({channel:a,currentChannel:h,allChannels:u,disableAutoSelect:g}))}else E=ec(u,a,(r=n.channelListQuery)===null||r===void 0?void 0:r.order),(h==null?void 0:h.url)===a.url&&(y=a);return re(re({},n),{currentChannel:y,allChannels:E})}).with({type:Sy.union(vD,yD,TD,SD)},function(e){var r,i,a,s=e.payload,u=n.allChannels,d=u===void 0?[]:u,h=n.currentUserId,p=n.currentChannel,g=n.channelListQuery,E=n.disableAutoSelect,y=s.unreadMessageCount;if(g){if(Jd(g,s,h))return re(re({},n),{allChannels:ec(d,s,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)});if($j(s))return n;var C=Gf({channel:s,currentChannel:p,allChannels:d,disableAutoSelect:E});return re(re({},n),{currentChannel:C,allChannels:d.filter(function(T){var A=T.url;return A!==(s==null?void 0:s.url)})})}return y===0&&((a=(i=s==null?void 0:s.lastMessage)===null||i===void 0?void 0:i.sender)===null||a===void 0?void 0:a.userId)!==h?re(re({},n),{allChannels:d.map(function(T){return T.url===(s==null?void 0:s.url)?s:T})}):re(re({},n),{allChannels:en([s],d.filter(function(T){var A=T.url;return A!==s.url}),!0)})}).with({type:Sm},function(e){return re(re({},n),{currentChannel:e.payload})}).with({type:ku},function(e){return re(re({},n),{allChannels:n.allChannels.map(function(r){return(r==null?void 0:r.url)===e.payload.url?e.payload:r})})}).with({type:CD},function(e){var r,i=e.payload,a=n.allChannels,s=n.currentUserId,u=n.currentChannel,d=n.channelListQuery,h=n.disableAutoSelect;if(d){if(Jd(d,i,s))return re(re({},n),{allChannels:ec(a,i,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)});var p=Gf({channel:i,currentChannel:u,allChannels:a,disableAutoSelect:h});return re(re({},n),{currentChannel:p,allChannels:a.filter(function(g){var E=g.url;return E!==(i==null?void 0:i.url)})})}return re(re({},n),{allChannels:a.map(function(g){return g.url===(i==null?void 0:i.url)&&(g.isFrozen=!0),g})})}).with({type:ID},function(e){var r,i=e.payload,a=n.allChannels,s=n.currentUserId,u=n.currentChannel,d=n.channelListQuery,h=n.disableAutoSelect;if(d){if(Jd(d,i,s))return re(re({},n),{allChannels:ec(a,i,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)});var p=Gf({channel:i,currentChannel:u,allChannels:a,disableAutoSelect:h});return re(re({},n),{currentChannel:p,allChannels:a.filter(function(g){var E=g.url;return E!==(i==null?void 0:i.url)})})}return re(re({},n),{allChannels:a.map(function(g){return g.url===(i==null?void 0:i.url)&&(g.isFrozen=!1),g})})}).with({type:t0},function(e){return re(re({},n),{channelListQuery:e.payload.channelListQuery,currentUserId:e.payload.currentUserId})}).otherwise(function(){return n})}function UZ(n,t){var e=n.activeChannelUrl,r=n.channels,i=n.sdk,a=t.logger,s=t.channelListDispatcher;return F.useEffect(function(){var u;if(e){a.info("ChannelListProvider: looking for active channel",{activeChannelUrl:e});var d=r==null?void 0:r.find(function(h){return h.url===e});d?s({type:Sm,payload:d}):(a.info("ChannelListProvider: searching backend for active channel",{activeChannelUrl:e}),(u=i==null?void 0:i.groupChannel)===null||u===void 0||u.getChannel(e).then(function(h){s({type:e0,payload:[h]}),s({type:Sm,payload:h})}).catch(function(){a.warning("ChannelListProvider: Active channel not found")}))}},[e])}var PZ=function(n,t){var e=n.channelSource,r=n.disableMarkAsDelivered,i=t.channelListDispatcher,a=t.logger,s=t.markAsDeliveredScheduler;return F.useCallback(function(){return Ar(void 0,void 0,void 0,function(){var u,d;return wr(this,function(h){switch(h.label){case 0:if(!(e!=null&&e.hasNext))return a.info("ChannelList: not able to fetch"),[2];a.info("ChannelList: starting fetch"),i({type:wZ,payload:null}),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,e.next()];case 2:return u=h.sent(),a.info("ChannelList: succeeded fetch",{channelList:u}),i({type:e0,payload:u}),r||(a.info("ChannelList: mark as delivered to fetched channels"),u==null||u.forEach(function(p){(p==null?void 0:p.unreadMessageCount)>0&&s.push(p)})),[3,4];case 3:return d=h.sent(),a.error("ChannelList: failed fetch",{error:d}),i({type:RZ,payload:d}),[3,4];case 4:return[2]}})})},[e,r])};function FZ(n){var t=n.isOnline,e=n.reconnectOnIdle,r=n.logger,i=n.sdk,a=n.currentGroupChannel,s=n.channelListDispatcher,u=n.setChannelSource,d=n.userFilledChannelListQuery,h=n.sortChannelList,p=n.disableAutoSelect,g=n.markAsDeliveredScheduler,E=n.disableMarkAsDelivered,y=ck(t,a,e).shouldReconnect;F.useEffect(function(){return function(){var C,T,A,O;if(y){r.info("ChannelList refresh - creating query",{userFilledChannelListQuery:d});var N=ND({sdk:i,userFilledChannelListQuery:d});r.info("ChannelList refresh - created query",N),u(N),s({type:n0,payload:{currentUserId:(T=(C=i==null?void 0:i.currentUser)===null||C===void 0?void 0:C.userId)!==null&&T!==void 0?T:""}}),d&&(r.info("ChannelList refresh - setting up channelListQuery",N),s({type:t0,payload:{channelListQuery:N,currentUserId:(O=(A=i==null?void 0:i.currentUser)===null||A===void 0?void 0:A.userId)!==null&&O!==void 0?O:""}})),r.info("ChannelList refresh - fetching channels"),N.hasNext?N.next().then(function(k){var D,P;r.info("ChannelList refresh - fetched channels",k);var U=k;h&&typeof h=="function"&&(U=h(k),r.info("ChannelList refresh - channel list sorted",U));var L=p?null:U[0];if(a!=null&&a.url){var B=U.find(function(z){return z.url===a.url});B&&(L=B)}r.info("ChannelList refresh - highlight channel",L),s({type:mD,payload:{channelList:U,currentChannel:L}});var q=(P=(D=i==null?void 0:i.appInfo)===null||D===void 0?void 0:D.premiumFeatureList)===null||P===void 0?void 0:P.find(function(z){return z===fO});q&&!E&&U.forEach(function(z){g.push(z)})}).catch(function(k){k&&(r.error("ChannelList refresh - could not fetch channels",k),s({type:gD}))}):r.info("ChannelList refresh - there are no more channels")}}},[y])}var wD=b.createContext(null),HZ=function(n){var t,e,r=n.children,i=n.className,a=n.disableUserProfile,s=n.allowProfileEdit,u=n.queries,d=n.onProfileEditSuccess,h=n.onThemeChange,p=n.onBeforeCreateChannel,g=n.sortChannelList,E=n.overrideInviteUser,y=n.activeChannelUrl,C=n.isTypingIndicatorEnabled,T=C===void 0?null:C,A=n.isMessageReceiptStatusEnabled,O=A===void 0?null:A,N=n.reconnectOnIdle,k=(n==null?void 0:n.disableAutoSelect)||!!y,D=(n==null?void 0:n.onChannelSelect)||ur,P=Mt(),U=P.config,L=P.stores,B=L.sdkStore,q=U.pubSub,z=U.logger,Y=U.markAsDeliveredScheduler,Q=U.disableMarkAsDelivered,$=Q===void 0?!1:Q,Z=U.isOnline,ne=B==null?void 0:B.sdk,ue=((t=ne==null?void 0:ne.appInfo)!==null&&t!==void 0?t:{}).premiumFeatureList,pe=ue===void 0?[]:ue,he=s||U.allowProfileEdit,le=u==null?void 0:u.channelListQuery,we=u==null?void 0:u.applicationUserListQuery,ve=B==null?void 0:B.initialized,Ue=F.useReducer(xZ,AD),be=Ue[0],Qe=Ue[1],Ne=be.currentChannel,$e=F.useState(null),gn=$e[0],En=$e[1],Yn=F.useState([]),Gn=Yn[0],Tn=Yn[1];F.useEffect(function(){var On=LZ(q,Qe);return function(){DZ(On)}},[ve]),F.useEffect(function(){var On,Ln=fs();return ve?(z.info("ChannelList: Setup channelHandlers"),kZ({sdk:ne,sdkChannelHandlerId:Ln,channelListDispatcher:Qe,setChannelSource:En,onChannelSelect:D,userFilledChannelListQuery:re({},le),logger:z,sortChannelList:g,disableAutoSelect:k,markAsDeliveredScheduler:Y,disableMarkAsDelivered:$})):(z.info("ChannelList: Removing channelHandlers"),!((On=ne==null?void 0:ne.groupChannel)===null||On===void 0)&&On.removeGroupChannelHandler&&ne.groupChannel.removeGroupChannelHandler(Ln),En(null),Qe({type:hD,payload:null})),function(){var An,wn;z.info("ChannelList: Removing channelHandlers"),!((An=ne==null?void 0:ne.groupChannel)===null||An===void 0)&&An.removeGroupChannelHandler&&((wn=ne==null?void 0:ne.groupChannel)===null||wn===void 0||wn.removeGroupChannelHandler(Ln))}},[ve,g,Object.entries(le??{}).map(function(On){var Ln=On[0],An=On[1];return Ln+An}).join()]),F.useEffect(function(){var On,Ln,An="";if(!((On=ne==null?void 0:ne.groupChannel)===null||On===void 0)&&On.addGroupChannelHandler){An=fs();var wn=new Uh({onTypingStatusUpdated:function(We){var ln,Pe=(ln=We==null?void 0:We.getTypingUsers())===null||ln===void 0?void 0:ln.length,Ke=Gn.filter(function(yn){return yn.url!==We.url});Pe>0?Tn(en(en([],Ke,!0),[We],!1)):Tn(Ke)},onUnreadMemberStatusUpdated:function(We){Qe({type:ku,payload:We})},onUndeliveredMemberStatusUpdated:function(We){Qe({type:ku,payload:We})},onMessageUpdated:function(We){We.isGroupChannel()&&(Qe({type:ku,payload:We}),ne.groupChannel.getChannelWithoutCache(We.url).then(function(ln){Qe({type:ku,payload:ln})}))},onMentionReceived:function(We){We.isGroupChannel()&&(Qe({type:ku,payload:We}),ne.groupChannel.getChannelWithoutCache(We.url).then(function(ln){Qe({type:ku,payload:ln})}))}});(Ln=ne==null?void 0:ne.groupChannel)===null||Ln===void 0||Ln.addGroupChannelHandler(An,wn)}return function(){var We;!((We=ne==null?void 0:ne.groupChannel)===null||We===void 0)&&We.removeGroupChannelHandler&&An!==""&&ne.groupChannel.removeGroupChannelHandler(An)}},[(e=ne==null?void 0:ne.currentUser)===null||e===void 0?void 0:e.userId]);var kn=F.useMemo(function(){return{applicationUserListQuery:we,channelListQuery:le}},[we,le]),Vn=be.allChannels,Hn=g&&typeof g=="function"?g(Vn):Vn;if(Hn.length!==Vn.length){var Jn=`ChannelList: You have removed/added extra channels on sortChannelList
      this could cause unexpected problems`;console.warn(Jn,{before:Vn,after:Hn}),z.warning(Jn,{before:Vn,after:Hn})}F.useEffect(function(){if(!(!ne||!ne.groupChannel)){if(!(Ne!=null&&Ne.url)){D(null);return}ne.groupChannel.getChannel(Ne.url).then(function(On){D(On||null)})}},[Ne==null?void 0:Ne.url]),UZ({activeChannelUrl:y,channels:Hn,sdk:ne},{logger:z,channelListDispatcher:Qe}),FZ({isOnline:Z,reconnectOnIdle:N,logger:z,sdk:ne,currentGroupChannel:Ne,channelListDispatcher:Qe,setChannelSource:En,userFilledChannelListQuery:le,sortChannelList:g,disableAutoSelect:k,markAsDeliveredScheduler:Y,disableMarkAsDelivered:$});var jn=PZ({channelSource:gn,disableMarkAsDelivered:$||!pe.some(function(On){return On===fO})},{channelListDispatcher:Qe,logger:z,markAsDeliveredScheduler:Y});return b.createElement(wD.Provider,{value:re(re({className:i,disableUserProfile:a,queries:kn,onProfileEditSuccess:d,onThemeChange:h,onBeforeCreateChannel:p,overrideInviteUser:E,onChannelSelect:D,sortChannelList:g,allowProfileEdit:he,channelListDispatcher:Qe,channelSource:gn},be),{allChannels:Hn,typingChannels:Gn,isTypingIndicatorEnabled:T??U.groupChannelList.enableTypingIndicator,isMessageReceiptStatusEnabled:O??U.groupChannelList.enableMessageReceiptStatus,fetchChannelList:jn})},b.createElement(tk,re({},n),b.createElement("div",{className:"sendbird-channel-list ".concat(i)},r)))};function r0(){var n=F.useContext(wD);if(!n)throw new Error("ChannelListContext not found. Use within the ChannelList module.");return n}function BZ(n){var t=n.count,e=n.maxLevel,r=e===void 0?2:e,i=n.className,a=i===void 0?"":i,s=F.useContext(kr).stringSet,u=parseInt("9".repeat(r>6?6:r),10);return b.createElement("div",{className:en(en([],Array.isArray(a)?a:[a],!0),["sendbird-badge"],!1).join(" ")},b.createElement("div",{className:"sendbird-badge__text"},b.createElement(Ge,{type:Be.CAPTION_2,color:Re.ONCONTENT_1},typeof t=="string"?t:t>u?"".concat(u).concat(s.BADGE__OVER):t)))}function GZ(n){var t=n.className,e=t===void 0?"":t,r=n.children,i=n.isReverse,a=i===void 0?!1:i,s=n.color,u=n.userId;return b.createElement("span",{className:Rt(Rk,e,a&&"reverse",s),contentEditable:!1,"data-userid":u,"data-sb-mention":!0},r)}var VZ=function(n){var t=n.channel,e=n.tabIndex,r=n.isTyping,i=n.isSelected,a=n.channelName,s=n.isMessageStatusEnabled,u=s===void 0?!0:s,d=n.onClick,h=d===void 0?ur:d,p=n.onLeaveChannel,g=p===void 0?function(){return Promise.resolve()}:p,E=n.renderChannelAction,y=Mt().config,C=y.theme,T=y.userId,A=Bt(),O=A.dateLocale,N=A.stringSet,k=Zi().isMobile,D=y.groupChannel.enableMention,P=o$(t,N),U=y.groupChannel.enableMarkdownForUserMessage?YW(P):P,L=F.useState(!1),B=L[0],q=L[1],z=Rc({onLongPress:function(){k&&q(!0)},onClick:h},{delay:1e3});return b.createElement(b.Fragment,null,b.createElement("div",re({className:["sendbird-channel-preview",i?"sendbird-channel-preview--active":""].join(" "),role:"link",tabIndex:e},k?re({},z):{onClick:h}),b.createElement("div",{className:"sendbird-channel-preview__avatar"},b.createElement(Ek,{channel:t,userId:T,theme:C})),b.createElement("div",{className:"sendbird-channel-preview__content"},b.createElement("div",{className:"sendbird-channel-preview__content__upper"},b.createElement("div",{className:"sendbird-channel-preview__content__upper__header"},(t.isBroadcast||!1)&&b.createElement("div",{className:"sendbird-channel-preview__content__upper__header__broadcast-icon"},b.createElement(mn,{type:Ye.BROADCAST,fillColor:sn.SECONDARY,height:"16px",width:"16px"})),b.createElement(Ge,{className:"sendbird-channel-preview__content__upper__header__channel-name",testID:"sendbird-channel-preview__content__upper__header__channel-name",type:Be.SUBTITLE_2,color:Re.ONBACKGROUND_1},a),b.createElement(Ge,{className:"sendbird-channel-preview__content__upper__header__total-members",type:Be.CAPTION_2,color:Re.ONBACKGROUND_2},s$(t)),t.isFrozen&&b.createElement("div",{title:"Frozen",className:"sendbird-channel-preview__content__upper__header__frozen-icon"},b.createElement(mn,{type:Ye.FREEZE,fillColor:sn.PRIMARY,height:12,width:12}))),!t.isEphemeral&&u&&b.createElement(Hk,{className:"sendbird-channel-preview__content__upper__last-message-at",channel:t,message:t.lastMessage,isDateSeparatorConsidered:!1}),!t.isEphemeral&&!u&&b.createElement(Ge,{className:"sendbird-channel-preview__content__upper__last-message-at",type:Be.CAPTION_3,color:Re.ONBACKGROUND_2},Fk({channel:t,locale:O,stringSet:N}))),b.createElement("div",{className:"sendbird-channel-preview__content__lower"},b.createElement(Ge,{className:"sendbird-channel-preview__content__lower__last-message",type:Be.BODY_2,color:Re.ONBACKGROUND_3},r&&b.createElement(_k,{members:t.getTypingUsers()}),!r&&!ou(t.lastMessage)&&U,!r&&ou(t.lastMessage)&&N.VOICE_MESSAGE),!i&&!t.isEphemeral&&b.createElement("div",{className:"sendbird-channel-preview__content__lower__unread-message-count"},D&&t.unreadMentionCount>0?b.createElement(GZ,{className:"sendbird-channel-preview__content__lower__unread-message-count__mention",color:"purple"},"@"):null,sR(t)?b.createElement(BZ,{count:sR(t)}):null))),!k&&b.createElement("div",{className:"sendbird-channel-preview__action"},E({channel:t}))),B&&k&&b.createElement(Za,{className:"sendbird-channel-preview__leave--mobile",titleText:a,hideFooter:!0,isCloseOnClickOutside:!0,onCancel:function(){return q(!1)}},b.createElement(jh,{onClick:function(){g(),q(!1)},className:"sendbird-channel-preview__leave-label--mobile"},b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},N.CHANNEL_PREVIEW_MOBILE_LEAVE))))},jZ=function(n){var t,e,r,i,a=n.channel,s=n.isActive,u=s===void 0?!1:s,d=n.isSelected,h=d===void 0?!1:d,p=n.isTyping,g=p===void 0?!1:p,E=n.renderChannelAction,y=n.onLeaveChannel,C=n.onClick,T=n.tabIndex,A=Mt().config,O=Bt().stringSet,N=r0(),k=N.isTypingIndicatorEnabled,D=k===void 0?!1:k,P=N.isMessageReceiptStatusEnabled,U=P===void 0?!1:P,L=A.userId,B=U&&(((t=a==null?void 0:a.lastMessage)===null||t===void 0?void 0:t.messageType)==="user"||((e=a==null?void 0:a.lastMessage)===null||e===void 0?void 0:e.messageType)==="file")&&((i=(r=a==null?void 0:a.lastMessage)===null||r===void 0?void 0:r.sender)===null||i===void 0?void 0:i.userId)===L;return b.createElement(VZ,{channel:a,tabIndex:T,isTyping:D&&g,isSelected:h??u,channelName:a$(a,L,O),isMessageStatusEnabled:B,onClick:C,onLeaveChannel:y,renderChannelAction:E})},qZ=function(n){var t=n.channel,e=n.onSubmit,r=n.onCancel,i=Mt().config,a=i.logger,s=i.isOnline,u=Bt().stringSet;if(t)return b.createElement(Za,{disabled:!s,onCancel:r,onSubmit:function(){a.info("LeaveGroupChannel: Leaving channel",t),t.leave().then(function(){a.info("LeaveGroupChannel: Leaving channel successful!",t),e==null||e()})},submitText:u.MODAL__LEAVE_CHANNEL__FOOTER,titleText:u.MODAL__LEAVE_CHANNEL__TITLE})};function zZ(n){var t=n.channel,e=n.disabled,r=e===void 0?!1:e,i=n.onLeaveChannel,a=F.useRef(null),s=F.useRef(null),u=F.useState(!1),d=u[0],h=u[1],p=F.useContext(kr).stringSet;return b.createElement("div",{ref:s,tabIndex:0,role:"button",style:{display:"inline-block"},onKeyDown:function(g){return g.stopPropagation()},onClick:function(g){return g.stopPropagation()}},b.createElement(wc,{menuTrigger:function(g){return b.createElement(Fu,{ref:a,onClick:g,height:"32px",width:"32px"},b.createElement(mn,{type:Ye.MORE,fillColor:sn.PRIMARY,width:"24px",height:"24px"}))},menuItems:function(g){return b.createElement(Ac,{parentRef:a,parentContainRef:s,closeDropdown:g},b.createElement(Mz,{onClick:function(){r||(h(!0),g())},testID:"channel_list_item_context_menu_leave_channel"},p.CHANNEL_SETTING__LEAVE_CHANNEL__TITLE))}}),d&&b.createElement(qZ,{channel:t,onSubmit:function(){h(!1),i==null||i()},onCancel:function(){return h(!1)}}))}var KZ=function(n){var t=n.renderTitle,e=n.renderIconButton,r=n.onEdit,i=n.allowProfileEdit,a=n.renderLeft,s=n.renderMiddle,u=n.renderRight,d=Mt().stores,h=d.userStore.user,p=Bt().stringSet,g=s??t;return b.createElement(Nu,{className:Rt("sendbird-channel-header",i&&"sendbird-channel-header--allow-edit"),renderLeft:a,renderMiddle:function(){var E;return(E=g==null?void 0:g())!==null&&E!==void 0?E:b.createElement("div",{className:"sendbird-channel-header__title",role:"button",onClick:function(){r==null||r()},onKeyDown:function(){r==null||r()},tabIndex:0},b.createElement("div",{className:"sendbird-channel-header__title__left"},b.createElement(Na,{width:"32px",height:"32px",src:h.profileUrl,alt:h.nickname})),b.createElement("div",{className:"sendbird-channel-header__title__right"},b.createElement(Ge,{className:"sendbird-channel-header__title__right__name",type:Be.SUBTITLE_2,color:Re.ONBACKGROUND_1},h.nickname||p.NO_NAME),b.createElement(Ge,{className:"sendbird-channel-header__title__right__user-id",type:Be.BODY_2,color:Re.ONBACKGROUND_2},h.userId)))},renderRight:u??e})},RD=b.createContext(null),WZ=function(n){var t=n.children,e=BV(n,["children"]);return b.createElement(RD.Provider,{value:e},t)},$Z=function(){var n=b.useContext(RD);if(!n)throw new Error("EditUserProfileContext not found. Use within the EditUserProfile module.");return n},xo={INIT_USER:"INIT_USER",RESET_USER:"RESET_USER",UPDATE_USER_INFO:"UPDATE_USER_INFO"},YZ=function(n){var t,e=n.formRef,r=n.inputRef,i=n.onThemeChange,a=n.setProfileImage,s=Mt(),u=s.stores,d=s.config,h=d.theme,p=d.setCurrentTheme,g=(t=u.userStore)===null||t===void 0?void 0:t.user,E=Bt().stringSet,y=F.useState(null),C=y[0],T=y[1],A=F.useRef(null);return b.createElement("form",{className:"sendbird-edit-user-profile",ref:e,onSubmit:function(O){O.preventDefault()}},b.createElement("section",{className:"sendbird-edit-user-profile__img"},b.createElement(m_,null,E.EDIT_PROFILE__IMAGE_LABEL),b.createElement("div",{className:"sendbird-edit-user-profile__img__avatar"},b.createElement(Na,{width:"80px",height:"80px",src:C||(g==null?void 0:g.profileUrl)})),b.createElement("input",{ref:A,type:"file",accept:"image/gif, image/jpeg, image/png",style:{display:"none"},onChange:function(O){O.target.files&&(T(URL.createObjectURL(O.target.files[0])),a(O.target.files[0])),A.current&&(A.current.value="")}}),b.createElement(jh,{className:"sendbird-edit-user-profile__img__avatar-button",disableUnderline:!0,onClick:function(){var O;return(O=A.current)===null||O===void 0?void 0:O.click()}},b.createElement(Ge,{type:Be.BUTTON_1,color:Re.PRIMARY},E.EDIT_PROFILE__IMAGE_UPLOAD))),b.createElement("section",{className:"sendbird-edit-user-profile__name"},b.createElement(m_,null,E.EDIT_PROFILE__NICKNAME_LABEL),b.createElement(qb,{required:(g==null?void 0:g.nickname)!=="",name:"sendbird-edit-user-profile__name__input",ref:r,value:g==null?void 0:g.nickname,placeHolder:E.EDIT_PROFILE__NICKNAME_PLACEHOLDER})),b.createElement("section",{className:"sendbird-edit-user-profile__userid"},b.createElement(m_,null,E.EDIT_PROFILE__USERID_LABEL),b.createElement(qb,{disabled:!0,name:"sendbird-edit-user-profile__userid__input",value:g==null?void 0:g.userId})),b.createElement("section",{className:"sendbird-edit-user-profile__theme"},b.createElement(m_,null,E.EDIT_PROFILE__THEME_LABEL),b.createElement("div",{className:"sendbird-edit-user-profile__theme__theme-icon"},h==="dark"?b.createElement(mn,{onClick:function(){p("light"),i==null||i("light")},type:Ye.TOGGLE_ON,width:44,height:24}):b.createElement(mn,{onClick:function(){p("dark"),i==null||i("dark")},type:Ye.TOGGLE_OFF,width:44,height:24}))))},QZ=function(n){var t,e,r,i=n.globalContext,a=n.formRef,s=n.inputRef,u=n.profileImage,d=n.onEditProfile,h=i.stores,p=i.dispatchers,g=h.sdkStore.sdk,E=h.userStore.user,y=p.userDispatcher;if((E==null?void 0:E.nickname)!==""&&!s.current.value){(e=(t=a.current).reportValidity)===null||e===void 0||e.call(t);return}g==null||g.updateCurrentUserInfo({nickname:(r=s==null?void 0:s.current)===null||r===void 0?void 0:r.value,profileImage:u??void 0}).then(function(C){y({type:xo.UPDATE_USER_INFO,payload:C}),d==null||d(C)})},ZZ=function(n){var t=n.onEditProfile,e=Mt(),r=F.useRef(null),i=F.useRef(null),a=F.useState(null),s=a[0],u=a[1],d=function(){QZ({globalContext:e,formRef:i,inputRef:r,profileImage:s,onEditProfile:t})};return{formRef:i,inputRef:r,updateUserInfo:d,profileImage:s,setProfileImage:u}},XZ=function(){var n=$Z(),t=n.onEditProfile,e=n.onCancel,r=n.onThemeChange,i=F.useContext(kr).stringSet,a=ZZ({onEditProfile:t}),s=a.formRef,u=a.inputRef,d=a.updateUserInfo,h=a.setProfileImage;return b.createElement(Za,{titleText:i.EDIT_PROFILE__TITLE,submitText:i.BUTTON__SAVE,type:Br.PRIMARY,onCancel:e,isFullScreenOnMobile:!0,onSubmit:d},b.createElement(YZ,{formRef:s,inputRef:u,setProfileImage:h,onThemeChange:r}))},JZ=function(n){var t=n.onEditProfile,e=n.onCancel,r=n.onThemeChange;return b.createElement(WZ,{onEditProfile:t,onCancel:e,onThemeChange:r},b.createElement(XZ,null))},eX=function(n){var t=n.renderHeader,e=n.renderPlaceHolderError,r=n.renderPlaceHolderLoading,i=n.renderPlaceHolderEmptyList,a=n.onChangeTheme,s=n.onUserProfileUpdated,u=n.allowProfileEdit,d=n.channels,h=n.onLoadMore,p=n.initialized,g=n.renderChannel,E=n.renderAddChannel,y=n.scrollRef,C=F.useState(!1),T=C[0],A=C[1],O=Mt().stores,N={addChannel:E,channel:g,placeholder:{loading:function(){return p?null:r?r():b.createElement(nu,{type:Ur.LOADING})},empty:function(){return p?i?i():b.createElement(nu,{type:Ur.NO_CHANNELS}):null},error:function(){return!p||!O.sdkStore.error?null:e?e():b.createElement(nu,{type:Ur.WRONG})}}};return b.createElement(b.Fragment,null,b.createElement("div",{className:"sendbird-channel-list__header"},(t==null?void 0:t())||b.createElement(KZ,{onEdit:function(){return u&&A(!0)},allowProfileEdit:u,renderIconButton:function(){return N.addChannel()}})),T&&b.createElement(JZ,{onThemeChange:a,onCancel:function(){return A(!1)},onEditProfile:function(k){A(!1),s(k)}}),b.createElement(nX,{data:d,renderItem:N.channel,onLoadMore:h,placeholderLoading:N.placeholder.loading(),placeholderEmpty:N.placeholder.empty(),placeholderError:N.placeholder.error(),scrollRef:y}))},nX=function(n){var t=n.data,e=n.renderItem,r=n.onLoadMore,i=n.placeholderLoading,a=n.placeholderError,s=n.placeholderEmpty,u=n.scrollRef,d=fD({onReachedBottom:function(){return r==null?void 0:r()}});return b.createElement("div",{className:"sendbird-channel-list__body",onScroll:d,ref:u},a,b.createElement("div",null,t.map(function(h,p){return e({item:h,index:p})})),i,t.length===0&&s)},Du;(function(n){n.GROUP="group",n.SUPERGROUP="supergroup",n.BROADCAST="broadcast"})(Du||(Du={}));var MD=b.createContext(null),tX=function(n){var t,e=n.children,r=n.onCreateChannelClick,i=n.onBeforeCreateChannel,a=n.onChannelCreated,s=n.userListQuery,u=n.onCreateChannel,d=n.overrideInviteUser,h=Mt(),p=s??((t=h==null?void 0:h.config)===null||t===void 0?void 0:t.userListQuery),g=F.useState(0),E=g[0],y=g[1],C=F.useState(Du.GROUP),T=C[0],A=C[1];return b.createElement(MD.Provider,{value:{sdk:h.stores.sdkStore.sdk,createChannel:Vk(h),onCreateChannelClick:r,onBeforeCreateChannel:i,onChannelCreated:a,userListQuery:p,step:E,setStep:y,type:T,setType:A,onCreateChannel:u,overrideInviteUser:d}},e)},i0=function(){var n=b.useContext(MD);if(!n)throw new Error("CreateChannelContext not found. Use within the CreateChannel module.");return n},rX=function(n){return function(t){return n==null?void 0:n.includes(t)}},JR=function(n,t){return t==="broadcast"&&(n.isBroadcast=!0),t==="supergroup"&&(n.isSuper=!0),n},iX=function(n){var t=n.sdk,e=n.userFilledApplicationUserListQuery,r=t.createApplicationUserListQuery();return e&&Object.keys(e).forEach(function(i){r[i]=e[i]}),r},aX=50,sX=function(n){var t,e,r,i=n.onCancel,a=n.userListQuery,s=i0(),u=s.onCreateChannelClick,d=s.onBeforeCreateChannel,h=s.onChannelCreated,p=s.createChannel,g=s.onCreateChannel,E=s.overrideInviteUser,y=s.type,C=Mt(),T=(t=C==null?void 0:C.config)===null||t===void 0?void 0:t.userId,A=(r=(e=C==null?void 0:C.stores)===null||e===void 0?void 0:e.sdkStore)===null||r===void 0?void 0:r.sdk,O=[T],N=F.useState([]),k=N[0],D=N[1],P=F.useState({}),U=P[0],L=P[1],B=F.useContext(kr).stringSet,q=F.useState(null),z=q[0],Y=q[1],Q=Object.keys(U).length,$=B.MODAL__CREATE_CHANNEL__TITLE,Z=B.BUTTON__CREATE,ne=Zi().isMobile,ue=F.useState(window.innerHeight),pe=ue[0],he=ue[1];return F.useEffect(function(){var le=a?a():iX({sdk:A});Y(le),le!=null&&le.isLoading||le.next().then(function(we){D(we)})},[]),F.useEffect(function(){var le=function(){he(window.innerHeight)};return window.addEventListener("resize",le),function(){window.removeEventListener("resize",le)}},[]),b.createElement(Za,{isFullScreenOnMobile:!0,titleText:$,submitText:Z,type:Br.PRIMARY,disabled:k.length>1&&Object.keys(U).length===0,onCancel:i,onSubmit:function(){var le=Object.keys(U).length>0?Object.keys(U):[T],we=h??g,ve=u??E;if(typeof ve=="function"){ve({users:le,onClose:i??ur,channelType:y});return}if(d){var Ue=d(le);JR(Ue,y),p(Ue).then(function(be){return we==null?void 0:we(be)})}else{var Ue={};Ue.invitedUserIds=le,Ue.isDistinct=!1,T&&(Ue.operatorUserIds=[T]),JR(Ue,y),p(Ue).then(function(Qe){return we==null?void 0:we(Qe)})}i==null||i()}},b.createElement("div",null,b.createElement(Ge,{color:Q>0?Re.PRIMARY:Re.ONBACKGROUND_3,type:Be.CAPTION_1},"".concat(Q," ").concat(B.MODAL__INVITE_MEMBER__SELECTED)),b.createElement("div",{className:"sendbird-create-channel--scroll",style:ne?{height:"calc(".concat(pe,"px - 200px)")}:{},onScroll:function(le){if(z){var we=le.target,ve=z.hasNext,Ue=z.isLoading,be=we.clientHeight+we.scrollTop+aX>we.scrollHeight;ve&&be&&!Ue&&z.next().then(function(Qe){D(en(en([],k,!0),Qe,!0))})}}},k.map(function(le){return!rX(O)(le.userId)&&b.createElement(jk,{key:le.userId,user:le,checkBox:!0,checked:U[le.userId],onChange:function(we){var ve,Ue=re(re({},U),(ve={},ve[we.target.id]=we.target.checked,ve));we.target.checked||delete Ue[we.target.id],L(Ue)}})}))))},uX=function(n){var t,e="allow_broadcast_channel",r=(t=n==null?void 0:n.appInfo)===null||t===void 0?void 0:t.applicationAttributes;return Array.isArray(r)?r.includes(e):!1},oX=function(n){var t,e="allow_super_group_channel",r=(t=n==null?void 0:n.appInfo)===null||t===void 0?void 0:t.applicationAttributes;return Array.isArray(r)?r.includes(e):!1},lX=function(n){var t=n.onCancel,e=Mt(),r=Gk(e),i=i0(),a=i.setStep,s=i.setType,u=F.useContext(kr).stringSet,d=uX(r),h=oX(r);return b.createElement(Za,{titleText:u==null?void 0:u.MODAL__CREATE_CHANNEL__TITLE,hideFooter:!0,onCancel:function(){t==null||t()},className:"sendbird-add-channel__modal"},b.createElement("div",{className:"sendbird-add-channel__rectangle-wrap"},b.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){s(Du.GROUP),a(1)},role:"button",tabIndex:0,onKeyDown:function(){s(Du.GROUP),a(1)}},b.createElement(mn,{className:"sendbird-add-channel__rectangle__chat-icon",type:Ye.CHAT,fillColor:sn.PRIMARY,width:"28px",height:"28px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__GROUP)),h&&b.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){s(Du.SUPERGROUP),a(1)},role:"button",tabIndex:0,onKeyDown:function(){s(Du.SUPERGROUP),a(1)}},b.createElement(mn,{className:"sendbird-add-channel__rectangle__supergroup-icon",type:Ye.SUPERGROUP,fillColor:sn.PRIMARY,width:"28px",height:"28px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__SUPER)),d&&b.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){s(Du.BROADCAST),a(1)},role:"button",tabIndex:0,onKeyDown:function(){s(Du.BROADCAST),a(1)}},b.createElement(mn,{className:"sendbird-add-channel__rectangle__broadcast-icon",type:Ye.BROADCAST,fillColor:sn.PRIMARY,width:"28px",height:"28px"}),b.createElement(Ge,{type:Be.SUBTITLE_1,color:Re.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__BROADCAST))))},dX=function(n){var t=n.onCancel,e=n.renderStepOne,r=i0(),i=r.step,a=r.setStep,s=r.userListQuery;return b.createElement(b.Fragment,null,i===0&&((e==null?void 0:e())||b.createElement(lX,{onCancel:t})),i===1&&b.createElement(sX,{userListQuery:s,onCancel:function(){a(0),t==null||t()}}))},cX=function(n){return b.createElement(tX,re({},n),b.createElement(dX,re({},n)))},fX=function(n){var t=n.createChannelVisible,e=n.onChangeCreateChannelVisible,r=n.onBeforeCreateChannel,i=n.onCreateChannelClick,a=n.onChannelCreated,s=Mt().config;return b.createElement(b.Fragment,null,b.createElement(Fu,{height:"32px",width:"32px",disabled:!s.isOnline,onClick:function(){return e(!0)}},b.createElement(mn,{type:Ye.CREATE,fillColor:sn.PRIMARY,width:"24px",height:"24px"})),t&&b.createElement(cX,{onCancel:function(){return e(!1)},onChannelCreated:function(u){a==null||a(u),e(!1)},onBeforeCreateChannel:r,onCreateChannelClick:i}))},hX=function(){var n=F.useState(!1),t=n[0],e=n[1],r=r0(),i=r.overrideInviteUser,a=r.onBeforeCreateChannel,s=r.onChannelSelect;return b.createElement(fX,{createChannelVisible:t,onChangeCreateChannelVisible:e,onCreateChannelClick:i,onBeforeCreateChannel:a,onChannelCreated:function(u){return s==null?void 0:s(u)}})},pX=function(n){var t=n.renderHeader,e=n.renderChannelPreview,r=n.renderPlaceHolderError,i=n.renderPlaceHolderLoading,a=n.renderPlaceHolderEmptyList,s=r0(),u=s.onThemeChange,d=s.allowProfileEdit,h=s.allChannels,p=s.currentChannel,g=s.channelListDispatcher,E=s.typingChannels,y=s.initialized,C=s.fetchChannelList,T=s.onProfileEditSuccess,A=Mt(),O=A.stores,N=A.config,k=N.logger,D=N.isOnline,P=D===void 0?!1:D,U=O.sdkStore.sdk,L=function(B){var q=B.item,z=B.index,Y={channel:q,tabIndex:z,isSelected:(q==null?void 0:q.url)===(p==null?void 0:p.url),isTyping:E==null?void 0:E.some(function(Q){var $=Q.url;return $===(q==null?void 0:q.url)}),renderChannelAction:function(Q){return b.createElement(zZ,re({},Q))},onClick:function(){if(!P&&!(U!=null&&U.isCacheEnabled)){k.warning("ChannelList: Inactivated clicking channel item during offline.");return}k.info("ChannelList: Clicked on channel:",q),g({type:Sm,payload:q})},onLeaveChannel:function(Q,$){return Ar(this,void 0,void 0,function(){var Z,ne;return wr(this,function(ue){switch(ue.label){case 0:if(k.info("ChannelList: Leaving channel",Q),!Q)return[3,4];ue.label=1;case 1:return ue.trys.push([1,3,,4]),[4,Q.leave()];case 2:return Z=ue.sent(),k.info("ChannelList: Leaving channel success",Z),$&&typeof $=="function"&&$(Q,null),g({type:JC,payload:Q.url}),[3,4];case 3:return ne=ue.sent(),k.error("ChannelList: Leaving channel failed",ne),$&&typeof $=="function"&&$(Q,ne),[3,4];case 4:return[2]}})})}};return e?b.createElement("div",{key:q==null?void 0:q.url,onClick:Y.onClick},e(Y)):b.createElement(jZ,re({key:q==null?void 0:q.url},Y))};return b.createElement(eX,{renderHeader:t,renderChannel:L,renderPlaceHolderError:r,renderPlaceHolderLoading:i,renderPlaceHolderEmptyList:a,onChangeTheme:u??ur,allowProfileEdit:d,onUserProfileUpdated:T??ur,channels:h,onLoadMore:C,initialized:y,renderAddChannel:function(){return b.createElement(hX,null)}})},_X=function(n){return b.createElement(HZ,re({},n),b.createElement(pX,re({},n)))};function mX(n,t){var e,r,i=F.useState(typeof window<"u"&&(r=(e=window==null?void 0:window.navigator)===null||e===void 0?void 0:e.onLine)!==null&&r!==void 0?r:!0),a=i[0],s=i[1];return F.useEffect(function(){var u=fs();try{t.warning("sdk changed",u);var d=new OM({onDisconnected:function(){s(!1),t.warning("onDisconnected",{isOnline:a})},onReconnectStarted:function(){s(!1),t.warning("onReconnectStarted",{isOnline:a})},onReconnectSucceeded:function(){s(!0),t.warning("onReconnectSucceeded",{isOnline:a})},onReconnectFailed:function(){n.reconnect(),t.warning("onReconnectFailed")}});n!=null&&n.addConnectionHandler&&(n.addConnectionHandler(u,d),t.info("Added ConnectionHandler",u))}catch{}return function(){try{n.removeConnectionHandler(u),t.info("Removed ConnectionHandler",u)}catch{}}},[n]),F.useEffect(function(){var u=function(){try{t.warning("Try reconnecting SDK"),n.connectionState!=="OPEN"&&n.reconnect()}catch{}};return window.addEventListener("online",u),function(){window.removeEventListener("online",u)}},[n]),F.useEffect(function(){var u=document.querySelector("body");if(!a&&!(n!=null&&n.isCacheEnabled))try{u==null||u.classList.add("sendbird__offline"),t.info("Added class sendbird__offline to body")}catch{}else try{u==null||u.classList.remove("sendbird__offline"),t.info("Removed class sendbird__offline from body")}catch{}},[a,n==null?void 0:n.isCacheEnabled]),a}var gX=2e3;function OD(n){var t=n.logger,e=n.timeout,r=n.cb,i=[],a=null,s=function(d){var h=i.find(function(g){return g.url===d.url});if(h?t.info("Channel: Mark as read already in queue",{channel:d}):i.push(d),!a){var p=i.shift();p&&r(p),a=setInterval(function(){if(i.length===0&&a){clearInterval(a),a=null;return}var g=i.shift();g&&r(g)},e||gX)}},u=function(){i=[],a&&(clearInterval(a),a=null)};return{push:s,clear:u,getQueue:function(){return i}}}function a0(n,t){t===void 0&&(t=[]),F.useLayoutEffect(function(){return function(){n()}},t)}function vX(n,t){var e=this,r=n.isConnected,i=t.logger,a=F.useMemo(function(){return OD({logger:i,cb:function(s){return Ar(e,void 0,void 0,function(){var u;return wr(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,s.markAsDelivered()];case 1:return d.sent(),[3,3];case 2:return u=d.sent(),i.warning("Channel: Mark as delivered failed",{channel:s,error:u}),[3,3];case 3:return[2]}})})}})},[]);return F.useEffect(function(){r||a.clear()},[r]),a0(function(){a.clear()}),a}var EX=function(n){var t={};return{__getTopics:function(){return t},subscribe:function(e,r){var i;return(i=t[e])!==null&&i!==void 0||(t[e]=new Set),t[e].add(r),{remove:function(){t[e].delete(r)}}},publish:function(e,r){t[e]&&t[e].forEach(function(i){setTimeout(function(){return i(r!==void 0?r:{})},0)})}}},yX={"--sendbird-dark-primary-500":"#4d2aa6","--sendbird-dark-primary-400":"#6440C4","--sendbird-dark-primary-300":"#7B53EF","--sendbird-dark-primary-200":"#9E8CF5","--sendbird-dark-primary-100":"#E2DFFF","--sendbird-dark-secondary-500":"#007A7A","--sendbird-dark-secondary-400":"#189A8D","--sendbird-dark-secondary-300":"#2EBA9F","--sendbird-dark-secondary-200":"#6FD6BE","--sendbird-dark-secondary-100":"#AEF2DC","--sendbird-dark-information-100":"#b2d9ff","--sendbird-dark-error-500":"#A30E2D","--sendbird-dark-error-400":"#C11F41","--sendbird-dark-error-300":"#E53157","--sendbird-dark-error-200":"#FF6183","--sendbird-dark-error-100":"#FFABBD","--sendbird-dark-background-700":"#000000","--sendbird-dark-background-600":"#161616","--sendbird-dark-background-500":"#2C2C2C","--sendbird-dark-background-400":"#393939","--sendbird-dark-background-300":"#A8A8A8","--sendbird-dark-background-200":"#D9D9D9","--sendbird-dark-background-100":"#F0F0F0","--sendbird-dark-background-50":"#FFFFFF","--sendbird-dark-overlay":"rgba(0, 0, 0, 0.32)","--sendbird-dark-onlight-01":"rgba(0, 0, 0, 0.88)","--sendbird-dark-onlight-02":"rgba(0, 0, 0, 0.50)","--sendbird-dark-onlight-03":"rgba(0, 0, 0, 0.38)","--sendbird-dark-onlight-04":"rgba(0, 0, 0, 0.12)","--sendbird-dark-ondark-01":"rgba(255, 255, 255, 0.88)","--sendbird-dark-ondark-02":"rgba(255, 255, 255, 0.50)","--sendbird-dark-ondark-03":"rgba(255, 255, 255, 0.38)","--sendbird-dark-ondark-04":"rgba(255, 255, 255, 0.12)","--sendbird-dark-shadow-01":"0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-02":"0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-03":"0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-04":"0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-message-input":"0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12)","--sendbird-light-primary-500":"#4d2aa6","--sendbird-light-primary-400":"#6440C4","--sendbird-light-primary-300":"#7B53EF","--sendbird-light-primary-200":"#9E8CF5","--sendbird-light-primary-100":"#E2DFFF","--sendbird-light-secondary-500":"#007A7A","--sendbird-light-secondary-400":"#189A8D","--sendbird-light-secondary-300":"#2EBA9F","--sendbird-light-secondary-200":"#6FD6BE","--sendbird-light-secondary-100":"#AEF2DC","--sendbird-light-information-100":"#b2d9ff","--sendbird-light-error-500":"#A30E2D","--sendbird-light-error-400":"#C11F41","--sendbird-light-error-300":"#E53157","--sendbird-light-error-200":"#FF6183","--sendbird-light-error-100":"#FFABBD","--sendbird-light-background-700":"#000000","--sendbird-light-background-600":"#161616","--sendbird-light-background-500":"#2C2C2C","--sendbird-light-background-400":"#393939","--sendbird-light-background-300":"#A8A8A8","--sendbird-light-background-200":"#D9D9D9","--sendbird-light-background-100":"#F0F0F0","--sendbird-light-background-50":" #FFFFFF","--sendbird-light-overlay":"rgba(0, 0, 0, 0.32)","--sendbird-light-onlight-01":"rgba(0, 0, 0, 0.88)","--sendbird-light-onlight-02":"rgba(0, 0, 0, 0.50)","--sendbird-light-onlight-03":"rgba(0, 0, 0, 0.38)","--sendbird-light-onlight-04":"rgba(0, 0, 0, 0.12)","--sendbird-light-ondark-01":"rgba(255, 255, 255, 0.88)","--sendbird-light-ondark-02":"rgba(255, 255, 255, 0.50)","--sendbird-light-ondark-03":"rgba(255, 255, 255, 0.38)","--sendbird-light-ondark-04":"rgba(255, 255, 255, 0.12)","--sendbird-light-shadow-01":"0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-02":"0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-03":"0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-04":"0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-message-input":"0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},bX=function(n){if(n==null)return!0;for(var t in n)if(n.hasOwnProperty(t))return!1;return JSON.stringify(n)===JSON.stringify({})},CX=function(n){F.useLayoutEffect(function(){if(!bX(n)){var t=re(re({},yX),xz(n));xu({variables:t})}},[n])},tu={INIT_SDK:"INIT_SDK",SET_SDK_LOADING:"SET_SDK_LOADING",RESET_SDK:"RESET_SDK",SDK_ERROR:"SDK_ERROR"},kD={initialized:!1,loading:!1,sdk:{},error:!1};function IX(n,t){return Mi(t).with({type:tu.SET_SDK_LOADING},function(e){var r=e.payload;return re(re({},n),{initialized:!1,loading:r})}).with({type:tu.SDK_ERROR},function(){return re(re({},n),{initialized:!1,loading:!1,error:!0})}).with({type:tu.INIT_SDK},function(e){var r=e.payload;return{sdk:r,initialized:!0,loading:!1,error:!1}}).with({type:tu.RESET_SDK},function(){return kD}).otherwise(function(){return n})}var DD={initialized:!1,loading:!1,user:{}};function TX(n,t){return Mi(t).with({type:xo.INIT_USER},function(e){var r=e.payload;return{initialized:!0,loading:!1,user:r}}).with({type:xo.RESET_USER},function(){return DD}).with({type:xo.UPDATE_USER_INFO},function(e){var r=e.payload;return re(re({},n),{user:r})}).otherwise(function(){return n})}var Ao={INITIALIZE_MESSAGE_TEMPLATES_INFO:"INITIALIZE_MESSAGE_TEMPLATES_INFO",UPSERT_MESSAGE_TEMPLATES:"UPSERT_MESSAGE_TEMPLATES",UPSERT_WAITING_TEMPLATE_KEYS:"UPSERT_WAITING_TEMPLATE_KEYS",MARK_ERROR_WAITING_TEMPLATE_KEYS:"MARK_ERROR_WAITING_TEMPLATE_KEYS"};function SX(n,t){return Mi(t).with({type:Ao.INITIALIZE_MESSAGE_TEMPLATES_INFO},function(e){var r=e.payload;return{messageTemplatesInfo:r,waitingTemplateKeysMap:{}}}).with({type:Ao.UPSERT_MESSAGE_TEMPLATES},function(e){var r=e.payload,i=n.messageTemplatesInfo;if(!i)return n;var a=re({},n.waitingTemplateKeysMap);return r.forEach(function(s){var u=s.key,d=s.template;i.templatesMap[u]=d,delete a[u]}),re(re({},n),{waitingTemplateKeysMap:a,messageTemplatesInfo:i})}).with({type:Ao.UPSERT_WAITING_TEMPLATE_KEYS},function(e){var r=e.payload,i=r.keys,a=r.requestedAt,s=re({},n.waitingTemplateKeysMap);return i.forEach(function(u){var d,h;s[u]={erroredMessageIds:(h=(d=s[u])===null||d===void 0?void 0:d.erroredMessageIds)!==null&&h!==void 0?h:[],requestedAt:a}}),re(re({},n),{waitingTemplateKeysMap:s})}).with({type:Ao.MARK_ERROR_WAITING_TEMPLATE_KEYS},function(e){var r=e.payload,i=r.keys,a=r.messageId,s=re({},n.waitingTemplateKeysMap);return i.forEach(function(u){var d=s[u];d&&d.erroredMessageIds.indexOf(a)===-1&&d.erroredMessageIds.push(a)}),re(re({},n),{waitingTemplateKeysMap:s})}).otherwise(function(){return n})}var NX={waitingTemplateKeysMap:{}};function LD(n){return Ar(this,arguments,void 0,function(t){var e=t.sdkDispatcher,r=t.userDispatcher,i=t.sdk;return wr(this,function(a){return[2,new Promise(function(s){e({type:tu.SET_SDK_LOADING,payload:!0}),i!=null&&i.disconnectWebSocket?i.disconnectWebSocket().then(function(){e({type:tu.RESET_SDK}),r({type:xo.RESET_USER})}).finally(function(){s(!0)}):s(!0)})]})})}var qE="3.15.13",AX=tu.INIT_SDK,wX=tu.SET_SDK_LOADING,RX=tu.RESET_SDK,e2=tu.SDK_ERROR,MX=xo.INIT_USER,OX=xo.UPDATE_USER_INFO,kX=xo.RESET_USER;function DX(n){var t=n.userId,e=n.appId;return"SendbirdProvider | useConnect/setupConnection/Connection failed UserId: ".concat(t," or appId: ").concat(e," missing")}function LX(n){return"SendbirdProvider | useConnect/setupConnection/Connection failed. ".concat((n==null?void 0:n.code)||""," ").concat((n==null?void 0:n.message)||"")}function xX(n){return Ar(this,arguments,void 0,function(t){var e,r=this,i,a,s=t.logger,u=t.sdkDispatcher,d=t.userDispatcher,h=t.initDashboardConfigs,p=t.userId,g=t.appId,E=t.isNewApp,y=t.customApiHost,C=t.customWebSocketHost,T=t.configureSession,A=t.nickname,O=t.profileUrl,N=t.accessToken,k=t.isUserIdUsedForNickname,D=t.sdkInitParams,P=t.customExtensionParams,U=t.isMobile,L=U===void 0?!1:U,B=t.eventHandlers,q=t.initializeMessageTemplatesInfo;return wr(this,function(z){return(i=s.info)===null||i===void 0||i.call(s,"SendbirdProvider | useConnect/setupConnection/init",{userId:p,appId:g}),u({type:wX,payload:!0}),!p||!g?(e=DX({userId:p,appId:g}),(a=s.error)===null||a===void 0||a.call(s,e),u({type:e2}),[2,Promise.reject(e)]):[2,new Promise(function(Y,Q){var $;($=s.info)===null||$===void 0||$.call(s,"SendbirdProvider | useConnect/setupConnection/connect connecting using ".concat(N??p));var Z=UX({appId:g,customApiHost:y,customWebSocketHost:C,isNewApp:E,sdkInitParams:D}),ne=typeof T=="function"?T(Z):void 0;PX(Z,{logger:s,sessionHandler:ne,customExtensionParams:P,isMobile:L}),Z.connect(p,N).then(function(he){return ue(he)}).catch(function(he){return Ar(r,void 0,void 0,function(){var le,we,ve,Ue;return wr(this,function(be){switch(be.label){case 0:if(!(HX(he)&&ne))return[3,6];be.label=1;case 1:return be.trys.push([1,5,,6]),[4,new Promise(ne.onSessionTokenRequired)];case 2:return le=be.sent(),le?((Ue=s.info)===null||Ue===void 0||Ue.call(s,"SendbirdProvider | useConnect/setupConnection/connect retry connect with valid session token: ".concat(le.slice(0,10)+"...")),[4,Z.connect(p,le)]):[3,4];case 3:return we=be.sent(),[2,ue(we)];case 4:return[3,6];case 5:return ve=be.sent(),ve instanceof ee?[2,pe(ve)]:[3,6];case 6:return[2,pe(he)]}})})});var ue=function(he){return Ar(r,void 0,void 0,function(){var le,we,ve,Ue,be,Qe,Ne,$e,gn,En,Yn,Gn;return wr(this,function(Tn){switch(Tn.label){case 0:(be=s.info)===null||be===void 0||be.call(s,"SendbirdProvider | useConnect/setupConnection/onConnected",he),u({type:AX,payload:Z}),d({type:MX,payload:he}),Tn.label=1;case 1:return Tn.trys.push([1,3,,4]),[4,q(Z)];case 2:return Tn.sent(),[3,4];case 3:return le=Tn.sent(),(Qe=s.error)===null||Qe===void 0||Qe.call(s,"SendbirdProvider | useConnect/setupConnection/upsertMessageTemplateListInLocalStorage failed",{error:le}),[3,4];case 4:return Tn.trys.push([4,6,,7]),[4,h(Z)];case 5:return Tn.sent(),(Ne=s.info)===null||Ne===void 0||Ne.call(s,"SendbirdProvider | useConnect/setupConnection/getUIKitConfiguration success"),[3,7];case 6:return we=Tn.sent(),($e=s.error)===null||$e===void 0||$e.call(s,"SendbirdProvider | useConnect/setupConnection/getUIKitConfiguration failed",{error:we}),[3,7];case 7:return Tn.trys.push([7,10,,11]),(A!==he.nickname||O!==he.profileUrl)&&!(oA(A)&&oA(O))?((gn=s.info)===null||gn===void 0||gn.call(s,"SendbirdProvider | useConnect/setupConnection/updateCurrentUserInfo",{nickname:A,profileUrl:O}),ve={nickname:A||he.nickname||(k?he.userId:""),profileUrl:O||he.profileUrl},[4,Z.updateCurrentUserInfo(ve)]):[3,9];case 8:Ue=Tn.sent(),(En=s.info)===null||En===void 0||En.call(s,"SendbirdProvider | useConnect/setupConnection/updateCurrentUserInfo success",ve),d({type:OX,payload:Ue}),Tn.label=9;case 9:return[3,11];case 10:return Tn.sent(),[3,11];case 11:return Y(),(Gn=(Yn=B==null?void 0:B.connection)===null||Yn===void 0?void 0:Yn.onConnected)===null||Gn===void 0||Gn.call(Yn,he),[2]}})})},pe=function(he){return Ar(r,void 0,void 0,function(){var le,we,ve,Ue,be;return wr(this,function(Qe){switch(Qe.label){case 0:return Z.isCacheEnabled&&FX(he)?((we=s.error)===null||we===void 0||we.call(s,"SendbirdProvider | useConnect/setupConnection/connect clear cache [".concat(he.code,"/").concat(he.message,"]")),[4,Z.clearCachedData()]):[3,2];case 1:Qe.sent(),Qe.label=2;case 2:return le=LX(he),(ve=s.error)===null||ve===void 0||ve.call(s,le,{e:he,appId:g,userId:p}),d({type:kX}),u({type:RX}),u({type:e2}),Q(le),(be=(Ue=B==null?void 0:B.connection)===null||Ue===void 0?void 0:Ue.onFailed)===null||be===void 0||be.call(Ue,he),[2]}})})}})]})})}function UX(n){var t=n.appId,e=n.isNewApp,r=e===void 0?!1:e,i=n.customApiHost,a=n.customWebSocketHost,s=n.sdkInitParams,u=s===void 0?{}:s,d=Object.assign({},{appId:t,modules:[new rO,new mz],newInstance:r,localCacheEnabled:!0},u);return i&&(d.customApiHost=i),a&&(d.customWebSocketHost=a),VM.init(d)}function PX(n,t){var e,r,i=t.logger,a=t.sessionHandler,s=t.isMobile,u=t.customExtensionParams;(e=i.info)===null||e===void 0||e.call(i,"SendbirdProvider | useConnect/setupConnection/setVersion",{version:qE}),n.addExtension("sb_uikit",qE),n.addSendbirdExtensions([{product:QE.UIKIT_CHAT,version:qE,platform:ql==null?void 0:ql.JS}],{platform:s?Io.MOBILE_WEB:Io.WEB},u),a&&((r=i.info)===null||r===void 0||r.call(i,"SendbirdProvider | useConnect/setupConnection/configureSession",a),n.setSessionHandler(a))}function FX(n){return n instanceof ee?[rn.USER_AUTH_DEACTIVATED,rn.USER_AUTH_DELETED_OR_NOT_FOUND,rn.SESSION_TOKEN_EXPIRED,rn.SESSION_REVOKED].includes(n.code):!1}function HX(n){return n instanceof ee?[rn.SESSION_TOKEN_EXPIRED,rn.INVALID_TOKEN].includes(n.code):!1}function n2(n){return Ar(this,arguments,void 0,function(t){var e=t.logger,r=t.sdkDispatcher,i=t.userDispatcher,a=t.appInfoDispatcher,s=t.initDashboardConfigs,u=t.userId,d=t.appId,h=t.isNewApp,p=h===void 0?!1:h,g=t.customApiHost,E=t.customWebSocketHost,y=t.configureSession,C=t.nickname,T=t.profileUrl,A=t.accessToken,O=t.sdk,N=t.sdkInitParams,k=t.customExtensionParams,D=t.isMobile,P=t.eventHandlers,U=t.isUserIdUsedForNickname,L=t.initializeMessageTemplatesInfo;return wr(this,function(B){switch(B.label){case 0:return[4,LD({logger:e,sdkDispatcher:r,userDispatcher:i,sdk:O})];case 1:return B.sent(),[4,xX({logger:e,sdkDispatcher:r,userDispatcher:i,appInfoDispatcher:a,initDashboardConfigs:s,userId:u,appId:d,isNewApp:p,customApiHost:g,customWebSocketHost:E,configureSession:y,nickname:C,profileUrl:T,accessToken:A,sdkInitParams:N,customExtensionParams:k,isMobile:D,eventHandlers:P,isUserIdUsedForNickname:U,initializeMessageTemplatesInfo:L})];case 2:return B.sent(),[2]}})})}function BX(n,t){var e=this,r=n.userId,i=n.appId,a=n.accessToken,s=n.isMobile,u=n.isUserIdUsedForNickname,d=t.logger,h=t.nickname,p=t.profileUrl,g=t.configureSession,E=t.customApiHost,y=t.customWebSocketHost,C=t.sdk,T=t.sdkDispatcher,A=t.userDispatcher,O=t.appInfoDispatcher,N=t.initDashboardConfigs,k=t.sdkInitParams,D=t.customExtensionParams,P=t.eventHandlers,U=t.initializeMessageTemplatesInfo,L=F.useRef({appId:"",userId:""});F.useEffect(function(){var q;(q=d==null?void 0:d.info)===null||q===void 0||q.call(d,"SendbirdProvider | useConnect/useEffect",{userId:r,appId:i,accessToken:a});var z=L.current.appId!==i;L.current.appId===i&&L.current.userId===r||(L.current={appId:i,userId:r},n2({userId:r,appId:i,isNewApp:z,accessToken:a,logger:d,nickname:h,profileUrl:p,configureSession:g,customApiHost:E,customWebSocketHost:y,sdk:C,sdkDispatcher:T,userDispatcher:A,appInfoDispatcher:O,initDashboardConfigs:N,isUserIdUsedForNickname:u,sdkInitParams:k,customExtensionParams:D,isMobile:s,eventHandlers:P,initializeMessageTemplatesInfo:U}).catch(function(Y){var Q;(Q=d==null?void 0:d.error)===null||Q===void 0||Q.call(d,"SendbirdProvider | useConnect/useEffect",Y)}))},[r,i]);var B=F.useCallback(function(){return Ar(e,void 0,void 0,function(){var q,z,Y;return wr(this,function(Q){switch(Q.label){case 0:(z=d==null?void 0:d.info)===null||z===void 0||z.call(d,"SendbirdProvider | useConnect/reconnect/useCallback",{sdk:C}),Q.label=1;case 1:return Q.trys.push([1,3,,4]),[4,n2({userId:r,appId:i,accessToken:a,logger:d,nickname:h,profileUrl:p,configureSession:g,customApiHost:E,customWebSocketHost:y,sdk:C,sdkDispatcher:T,userDispatcher:A,appInfoDispatcher:O,initDashboardConfigs:N,isUserIdUsedForNickname:u,sdkInitParams:k,customExtensionParams:D,isMobile:s,eventHandlers:P,initializeMessageTemplatesInfo:U})];case 2:return Q.sent(),[3,4];case 3:return q=Q.sent(),(Y=d==null?void 0:d.error)===null||Y===void 0||Y.call(d,"SendbirdProvider | useConnect/reconnect/useCallback",q),[3,4];case 4:return[2]}})})},[C]);return B}var Ua={DEBUG:"debug",WARNING:"warning",ERROR:"error",INFO:"info",ALL:"all"},GX=function(n){switch(n){case Ua.WARNING:return"color: Orange";case Ua.ERROR:return"color: Red";default:return"color: Gray"}},VX=function(n){var t=n.level,e=n.title,r=n.description,i=r===void 0?"":r,a=n.payload,s=a===void 0?[]:a;console.log.apply(console,en(["%c SendbirdUIKit | ".concat(t," | ").concat(new Date().toISOString()," | ").concat(e," ").concat(i&&"|"),GX(t),i],s,!1))},jX=function(){return{info:ur,error:ur,warning:ur}},t2=function(n,t){var e=VX,r=Array.isArray(n)?n:[n],i=function(a){return function(s,u){for(var d=[],h=2;h<arguments.length;h++)d[h-2]=arguments[h];return e({level:a,title:s,description:u,payload:d})}};return r.reduce(function(a,s){return s===Ua.DEBUG||s===Ua.ALL?re(re({},a),{info:i(Ua.INFO),error:i(Ua.ERROR),warning:i(Ua.WARNING)}):s===Ua.INFO?re(re({},a),{info:i(Ua.INFO)}):s===Ua.ERROR?re(re({},a),{error:i(Ua.ERROR)}):s===Ua.WARNING?re(re({},a),{warning:i(Ua.WARNING)}):re({},a)},jX())},qX=function(n){var t=n.children;return b.createElement(Iz,null,b.createElement(Hz,null,t))};function zX(n){var t,e,r,i,a,s,u,d,h,p,g,E,y,C,T,A,O,N,k,D,P,U,L,B,q,z,Y,Q,$,Z,ne,ue,pe=n.legacyConfig,he=n.uikitOptions,le=he===void 0?{}:he,we=pe.replyType,ve=pe.isMentionEnabled,Ue=pe.isReactionEnabled,be=pe.disableUserProfile,Qe=pe.isVoiceMessageEnabled,Ne=pe.isTypingIndicatorEnabledOnChannelList,$e=pe.isMessageReceiptStatusEnabledOnChannelList,gn=pe.showSearchIcon;return{common:{enableUsingDefaultUserProfile:(e=(t=le.common)===null||t===void 0?void 0:t.enableUsingDefaultUserProfile)!==null&&e!==void 0?e:typeof be=="boolean"?!be:void 0},groupChannel:{enableOgtag:(r=le.groupChannel)===null||r===void 0?void 0:r.enableOgtag,enableMention:(a=(i=le.groupChannel)===null||i===void 0?void 0:i.enableMention)!==null&&a!==void 0?a:ve,enableReactions:(u=(s=le.groupChannel)===null||s===void 0?void 0:s.enableReactions)!==null&&u!==void 0?u:Ue,enableReactionsSupergroup:(d=le.groupChannel)===null||d===void 0?void 0:d.enableReactionsSupergroup,enableTypingIndicator:(h=le.groupChannel)===null||h===void 0?void 0:h.enableTypingIndicator,enableVoiceMessage:(g=(p=le.groupChannel)===null||p===void 0?void 0:p.enableVoiceMessage)!==null&&g!==void 0?g:Qe,replyType:(y=(E=le.groupChannel)===null||E===void 0?void 0:E.replyType)!==null&&y!==void 0?y:we!=null?zC(we).lowerCase:void 0,threadReplySelectType:(C=le.groupChannel)===null||C===void 0?void 0:C.threadReplySelectType,input:{enableDocument:(A=(T=le.groupChannel)===null||T===void 0?void 0:T.input)===null||A===void 0?void 0:A.enableDocument},typingIndicatorTypes:(O=le.groupChannel)===null||O===void 0?void 0:O.typingIndicatorTypes,enableFeedback:(N=le.groupChannel)===null||N===void 0?void 0:N.enableFeedback,enableSuggestedReplies:(k=le.groupChannel)===null||k===void 0?void 0:k.enableSuggestedReplies,showSuggestedRepliesFor:(D=le.groupChannel)===null||D===void 0?void 0:D.showSuggestedRepliesFor,suggestedRepliesDirection:(P=le.groupChannel)===null||P===void 0?void 0:P.suggestedRepliesDirection,enableMarkdownForUserMessage:(U=le.groupChannel)===null||U===void 0?void 0:U.enableMarkdownForUserMessage,enableFormTypeMessage:(L=le.groupChannel)===null||L===void 0?void 0:L.enableFormTypeMessage},groupChannelList:{enableTypingIndicator:(q=(B=le.groupChannelList)===null||B===void 0?void 0:B.enableTypingIndicator)!==null&&q!==void 0?q:Ne,enableMessageReceiptStatus:(Y=(z=le.groupChannelList)===null||z===void 0?void 0:z.enableMessageReceiptStatus)!==null&&Y!==void 0?Y:$e},groupChannelSettings:{enableMessageSearch:($=(Q=le.groupChannelSettings)===null||Q===void 0?void 0:Q.enableMessageSearch)!==null&&$!==void 0?$:gn},openChannel:{enableOgtag:(Z=le.openChannel)===null||Z===void 0?void 0:Z.enableOgtag,input:{enableDocument:(ue=(ne=le.openChannel)===null||ne===void 0?void 0:ne.input)===null||ue===void 0?void 0:ue.enableDocument}}}}function KX(n,t){var e=n.isConnected,r=t.logger,i=F.useMemo(function(){return OD({logger:r,cb:function(a){try{a.markAsRead()}catch(s){r.warning("Channel: Mark as delivered failed",{channel:a,error:s})}}})},[]);return F.useEffect(function(){e||i.clear()},[e]),a0(function(){i.clear()}),i}var WX={getItem:function(n){return Ar(this,void 0,void 0,function(){var t;return wr(this,function(e){return[2,(t=localStorage.getItem(n))!==null&&t!==void 0?t:null]})})},setItem:function(n,t){return Ar(this,void 0,void 0,function(){return wr(this,function(e){return[2,localStorage.setItem(n,t)]})})}},xD=function(n){return{version:Number(n.ui_template.version),uiTemplate:JSON.stringify(n.ui_template.body.items),colorVariables:n.color_variables}},r2=function(n){var t={};return n.forEach(function(e){t[e.key]=xD(e)}),t},$X=20,i2=Ao.INITIALIZE_MESSAGE_TEMPLATES_INFO,YX=Ao.UPSERT_MESSAGE_TEMPLATES,QX=Ao.UPSERT_WAITING_TEMPLATE_KEYS,ZX=Ao.MARK_ERROR_WAITING_TEMPLATE_KEYS;function XX(n){var t=this,e=n.sdk,r=n.logger,i=n.appInfoStore,a=n.appInfoDispatcher,s=i==null?void 0:i.messageTemplatesInfo,u=function(g){var E,y;if(!s)return null;var C=null,T=(E=s==null?void 0:s.templatesMap)!==null&&E!==void 0?E:null;return T&&(C=(y=T[g])!==null&&y!==void 0?y:null),C},d=function(g){return Ar(t,void 0,void 0,function(){var E,y,C,T;return wr(this,function(A){switch(A.label){case 0:E=!0,y=null,C=[],A.label=1;case 1:return E?[4,g.message.getMessageTemplatesByToken(y,{limit:$X})]:[3,3];case 2:return T=A.sent(),E=T.hasMore,y=T.token,T.templates.forEach(function(O){C.push(JSON.parse(O.template))}),[3,1];case 3:return[2,C]}})})},h=function(g){return Ar(t,void 0,void 0,function(){var E,y,C,T,A,T,A,O;return wr(this,function(N){switch(N.label){case 0:return E=(O=g.appInfo)===null||O===void 0?void 0:O.messageTemplateInfo.token,E?(y=localStorage.getItem(IE),C=localStorage.getItem(Xd),!y||y!==E?[4,d(g)]:[3,2]):(localStorage.removeItem(IE),localStorage.removeItem(Xd),[2]);case 1:return T=N.sent(),A={token:E,templatesMap:r2(T)},a({type:i2,payload:A}),localStorage.setItem(IE,E),localStorage.setItem(Xd,JSON.stringify(T)),[3,3];case 2:y&&y===E&&C&&(T=JSON.parse(C),A={token:E,templatesMap:r2(T)},a({type:i2,payload:A})),N.label=3;case 3:return[2]}})})},p=function(g,E,y){return Ar(t,void 0,void 0,function(){var C,T,A,O,N,k,D,P,U;return wr(this,function(L){switch(L.label){case 0:if(!a)return[3,7];a({type:QX,payload:{keys:g,requestedAt:y}}),C=[],L.label=1;case 1:L.trys.push([1,5,,6]),T=!0,A=null,L.label=2;case 2:return T?[4,e.message.getMessageTemplatesByToken(A,{keys:g})]:[3,4];case 3:return O=L.sent(),O.templates.forEach(function(B){C.push(JSON.parse(B.template))}),T=O.hasMore,A=O.token,[3,2];case 4:return[3,6];case 5:return N=L.sent(),(U=r==null?void 0:r.error)===null||U===void 0||U.call(r,"Sendbird | fetchProcessedMessageTemplates failed",N,g),[3,6];case 6:C.length>0?(k=localStorage.getItem(Xd),k?(D=JSON.parse(k),P=D.map(function(B){return B.key}),C.forEach(function(B){P.includes(B.key)||D.push(B)}),localStorage.setItem(Xd,JSON.stringify(D))):localStorage.setItem(Xd,JSON.stringify([C])),a({type:YX,payload:C.map(function(B){return{key:B.key,template:xD(B)}})})):a({type:ZX,payload:{keys:g,messageId:E}}),L.label=7;case 7:return[2]}})})};return{getCachedTemplate:u,updateMessageTemplatesInfo:p,initializeMessageTemplatesInfo:h}}var JX=function(n){F.useEffect(function(){var t=document.getElementById(O_);t.parentElement.dir=n},[n])};function eJ(n){var t=zX({legacyConfig:{replyType:n.replyType,isMentionEnabled:n.isMentionEnabled,isReactionEnabled:n.isReactionEnabled,disableUserProfile:n.disableUserProfile,isVoiceMessageEnabled:n.isVoiceMessageEnabled,isTypingIndicatorEnabledOnChannelList:n.isTypingIndicatorEnabledOnChannelList,isMessageReceiptStatusEnabledOnChannelList:n.isMessageReceiptStatusEnabledOnChannelList,showSearchIcon:n.showSearchIcon},uikitOptions:n.uikitOptions});return b.createElement(ij,{storage:WX,localConfigs:{common:t==null?void 0:t.common,groupChannel:{channel:t==null?void 0:t.groupChannel,channelList:t==null?void 0:t.groupChannelList,setting:t==null?void 0:t.groupChannelSettings},openChannel:{channel:t==null?void 0:t.openChannel}}},b.createElement(nJ,re({},n)))}var nJ=function(n){var t,e,r,i=n.appId,a=n.userId,s=n.children,u=n.accessToken,d=n.customApiHost,h=n.customWebSocketHost,p=n.configureSession,g=n.theme,E=g===void 0?"light":g,y=n.config,C=y===void 0?{}:y,T=n.nickname,A=T===void 0?"":T,O=n.colorSet,N=n.stringSet,k=n.dateLocale,D=n.profileUrl,P=D===void 0?"":D,U=n.voiceRecord,L=n.userListQuery,B=n.imageCompression,q=B===void 0?{}:B,z=n.allowProfileEdit,Y=z===void 0?!1:z,Q=n.disableMarkAsDelivered,$=Q===void 0?!1:Q,Z=n.renderUserProfile,ne=n.onUserProfileMessage,ue=n.onStartDirectMessage,pe=n.breakpoint,he=pe===void 0?!1:pe,le=n.isUserIdUsedForNickname,we=le===void 0?!0:le,ve=n.sdkInitParams,Ue=n.customExtensionParams,be=n.isMultipleFilesMessageEnabled,Qe=be===void 0?!1:be,Ne=n.eventHandlers,$e=n.htmlTextDirection,gn=$e===void 0?"ltr":$e,En=n.forceLeftToRightMessageLayout,Yn=En===void 0?!1:En,Gn=ue??ne,Tn=C.logLevel,kn=Tn===void 0?"":Tn,Vn=C.userMention,Hn=Vn===void 0?{}:Vn,Jn=C.isREMUnitEnabled,jn=Jn===void 0?!1:Jn,On=C.pubSub,Ln=Zi().isMobile,An=F.useState(t2(kn)),wn=An[0],We=An[1],ln=F.useState(function(){return On??EX()})[0],Pe=F.useReducer(IX,kD),Ke=Pe[0],yn=Pe[1],tn=F.useReducer(TX,DD),st=tn[0],Cn=tn[1],Ve=F.useReducer(SX,NX),Ut=Ve[0],mt=Ve[1],ut=aj(),In=ut.configs,Qn=ut.configsWithAppAttr,Ct=ut.initDashboardConfigs,Et=Ke.initialized,ct=Ke==null?void 0:Ke.sdk,Qt=(t=ct==null?void 0:ct.appInfo)!==null&&t!==void 0?t:{},Ot=Qt.uploadSizeLimit,ft=Qt.multipleFilesMessageFileCountLimit;CX(O);var rt=XX({sdk:ct,logger:wn,appInfoStore:Ut,appInfoDispatcher:mt}),xn=rt.getCachedTemplate,Oe=rt.updateMessageTemplatesInfo,Ee=rt.initializeMessageTemplatesInfo,nn={updateMessageTemplatesInfo:Oe,getCachedTemplate:xn},Sn=BX({appId:i,userId:a,accessToken:u,isUserIdUsedForNickname:we,isMobile:Ln},{logger:wn,nickname:A,profileUrl:P,configureSession:p,customApiHost:d,customWebSocketHost:h,sdkInitParams:ve,customExtensionParams:Ue,sdk:ct,sdkDispatcher:yn,userDispatcher:Cn,appInfoDispatcher:mt,initDashboardConfigs:Ct,eventHandlers:Ne,initializeMessageTemplatesInfo:Ee});a0(function(){typeof ct.disconnect=="function"&&LD({logger:wn,sdkDispatcher:yn,userDispatcher:Cn,sdk:ct})},[ct.disconnectWebSocket]),F.useEffect(function(){We(t2(kn))},[kn]);var Pn=F.useState(E),lt=Pn[0],qn=Pn[1];F.useEffect(function(){qn(E)},[E]),F.useEffect(function(){var Fe=document.querySelector("body");Fe==null||Fe.classList.remove("sendbird-experimental__rem__units"),jn&&(Fe==null||Fe.classList.add("sendbird-experimental__rem__units"))},[jn]),F.useEffect(function(){wn.info("Setup theme","Theme: ".concat(lt));try{var Fe=document.querySelector("body");Fe==null||Fe.classList.remove("sendbird-theme--light"),Fe==null||Fe.classList.remove("sendbird-theme--dark"),Fe==null||Fe.classList.add("sendbird-theme--".concat(lt||"light")),wn.info("Finish setup theme")}catch(un){wn.warning("Setup theme failed","".concat(un))}return function(){try{var un=document.querySelector("body");un==null||un.classList.remove("sendbird-theme--light"),un==null||un.classList.remove("sendbird-theme--dark")}catch{}}},[lt]),JX(gn);var Fn=mX(Ke.sdk,wn),At=KX({isConnected:Fn},{logger:wn}),Pt=vX({isConnected:Fn},{logger:wn}),zn=b.useMemo(function(){return re(re({},IC("en")),N)},[N]),qt=F.useMemo(function(){return Math.min(mj,ft??Number.MAX_SAFE_INTEGER)},[ft]),cr=F.useMemo(function(){return new Gz({sdk:ct,logger:wn})},[Ke.initialized]);return b.createElement(oO.Provider,{value:{stores:{sdkStore:Ke,userStore:st,appInfoStore:Ut},dispatchers:{sdkDispatcher:yn,userDispatcher:Cn,appInfoDispatcher:mt,reconnect:Sn},config:{disableMarkAsDelivered:$,renderUserProfile:Z,onStartDirectMessage:Gn,onUserProfileMessage:Gn,allowProfileEdit:Y,isOnline:Fn,userId:a,appId:i,accessToken:u,theme:lt,setCurrentTheme:qn,setCurrenttheme:qn,isMultipleFilesMessageEnabled:Qe,uikitUploadSizeLimit:Ot??gj,uikitMultipleFilesMessageLimit:qt,userListQuery:L,logger:wn,pubSub:ln,imageCompression:re({compressionRate:.7,outputFormat:"preserve"},q),voiceRecord:{maxRecordingTime:(e=U==null?void 0:U.maxRecordingTime)!==null&&e!==void 0?e:lj,minRecordingTime:(r=U==null?void 0:U.minRecordingTime)!==null&&r!==void 0?r:cO},userMention:{maxMentionCount:(Hn==null?void 0:Hn.maxMentionCount)||10,maxSuggestionCount:(Hn==null?void 0:Hn.maxSuggestionCount)||15},markAsReadScheduler:At,markAsDeliveredScheduler:Pt,common:In.common,groupChannel:{enableOgtag:Et&&Qn(ct).groupChannel.channel.enableOgtag,enableTypingIndicator:In.groupChannel.channel.enableTypingIndicator,enableReactions:Et&&Qn(ct).groupChannel.channel.enableReactions,enableMention:In.groupChannel.channel.enableMention,replyType:In.groupChannel.channel.replyType,threadReplySelectType:In.groupChannel.channel.threadReplySelectType,enableVoiceMessage:In.groupChannel.channel.enableVoiceMessage,enableDocument:In.groupChannel.channel.input.enableDocument,typingIndicatorTypes:In.groupChannel.channel.typingIndicatorTypes,enableFeedback:In.groupChannel.channel.enableFeedback,enableSuggestedReplies:In.groupChannel.channel.enableSuggestedReplies,showSuggestedRepliesFor:In.groupChannel.channel.showSuggestedRepliesFor,suggestedRepliesDirection:In.groupChannel.channel.suggestedRepliesDirection,enableMarkdownForUserMessage:In.groupChannel.channel.enableMarkdownForUserMessage,enableFormTypeMessage:In.groupChannel.channel.enableFormTypeMessage,enableReactionsSupergroup:Et&&Qn(ct).groupChannel.channel.enableReactionsSupergroup},groupChannelList:{enableTypingIndicator:In.groupChannel.channelList.enableTypingIndicator,enableMessageReceiptStatus:In.groupChannel.channelList.enableMessageReceiptStatus},groupChannelSettings:{enableMessageSearch:Et&&Qn(ct).groupChannel.setting.enableMessageSearch},openChannel:{enableOgtag:Et&&Qn(ct).openChannel.channel.enableOgtag,enableDocument:In.openChannel.channel.input.enableDocument},disableUserProfile:!In.common.enableUsingDefaultUserProfile,isReactionEnabled:Et&&Qn(ct).groupChannel.channel.enableReactions,isMentionEnabled:In.groupChannel.channel.enableMention,isVoiceMessageEnabled:In.groupChannel.channel.enableVoiceMessage,replyType:zC(In.groupChannel.channel.replyType).upperCase,isTypingIndicatorEnabledOnChannelList:In.groupChannel.channelList.enableTypingIndicator,isMessageReceiptStatusEnabledOnChannelList:In.groupChannel.channelList.enableMessageReceiptStatus,showSearchIcon:Et&&Qn(ct).groupChannel.setting.enableMessageSearch,htmlTextDirection:gn,forceLeftToRightMessageLayout:Yn},eventHandlers:Ne,emojiManager:cr,utils:nn}},b.createElement(D9,{logger:wn,breakpoint:he},b.createElement(O9,{stringSet:zn,dateLocale:k},b.createElement(qX,null,b.createElement(Bz,null,s)))),b.createElement(kz,null),b.createElement(Uz,null),b.createElement(Oz,null))},F_={exports:{}},tJ=F_.exports,a2;function rJ(){return a2||(a2=1,function(n,t){(function(e,r){n.exports=r()})(tJ,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof RN<"u"?RN:typeof self<"u"?self:{};function r(o,c){return o(c={exports:{}},c.exports),c.exports}var i=function(o){return o&&o.Math==Math&&o},a=i(typeof globalThis=="object"&&globalThis)||i(typeof window=="object"&&window)||i(typeof self=="object"&&self)||i(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),s=function(o){try{return!!o()}catch{return!0}},u=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),d={}.propertyIsEnumerable,h=Object.getOwnPropertyDescriptor,p={f:h&&!d.call({1:2},1)?function(o){var c=h(this,o);return!!c&&c.enumerable}:d},g=function(o,c){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:c}},E={}.toString,y=function(o){return E.call(o).slice(8,-1)},C="".split,T=s(function(){return!Object("z").propertyIsEnumerable(0)})?function(o){return y(o)=="String"?C.call(o,""):Object(o)}:Object,A=function(o){if(o==null)throw TypeError("Can't call method on "+o);return o},O=function(o){return T(A(o))},N=function(o){return typeof o=="object"?o!==null:typeof o=="function"},k=function(o,c){if(!N(o))return o;var l,f;if(c&&typeof(l=o.toString)=="function"&&!N(f=l.call(o))||typeof(l=o.valueOf)=="function"&&!N(f=l.call(o))||!c&&typeof(l=o.toString)=="function"&&!N(f=l.call(o)))return f;throw TypeError("Can't convert object to primitive value")},D={}.hasOwnProperty,P=function(o,c){return D.call(o,c)},U=a.document,L=N(U)&&N(U.createElement),B=function(o){return L?U.createElement(o):{}},q=!u&&!s(function(){return Object.defineProperty(B("div"),"a",{get:function(){return 7}}).a!=7}),z=Object.getOwnPropertyDescriptor,Y={f:u?z:function(o,c){if(o=O(o),c=k(c,!0),q)try{return z(o,c)}catch{}if(P(o,c))return g(!p.f.call(o,c),o[c])}},Q=function(o){if(!N(o))throw TypeError(String(o)+" is not an object");return o},$=Object.defineProperty,Z={f:u?$:function(o,c,l){if(Q(o),c=k(c,!0),Q(l),q)try{return $(o,c,l)}catch{}if("get"in l||"set"in l)throw TypeError("Accessors not supported");return"value"in l&&(o[c]=l.value),o}},ne=u?function(o,c,l){return Z.f(o,c,g(1,l))}:function(o,c,l){return o[c]=l,o},ue=function(o,c){try{ne(a,o,c)}catch{a[o]=c}return c},pe="__core-js_shared__",he=a[pe]||ue(pe,{}),le=Function.toString;typeof he.inspectSource!="function"&&(he.inspectSource=function(o){return le.call(o)});var we,ve,Ue,be=he.inspectSource,Qe=a.WeakMap,Ne=typeof Qe=="function"&&/native code/.test(be(Qe)),$e=r(function(o){(o.exports=function(c,l){return he[c]||(he[c]=l!==void 0?l:{})})("versions",[]).push({version:"3.8.1",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})}),gn=0,En=Math.random(),Yn=function(o){return"Symbol("+String(o===void 0?"":o)+")_"+(++gn+En).toString(36)},Gn=$e("keys"),Tn=function(o){return Gn[o]||(Gn[o]=Yn(o))},kn={},Vn=a.WeakMap;if(Ne){var Hn=he.state||(he.state=new Vn),Jn=Hn.get,jn=Hn.has,On=Hn.set;we=function(o,c){return c.facade=o,On.call(Hn,o,c),c},ve=function(o){return Jn.call(Hn,o)||{}},Ue=function(o){return jn.call(Hn,o)}}else{var Ln=Tn("state");kn[Ln]=!0,we=function(o,c){return c.facade=o,ne(o,Ln,c),c},ve=function(o){return P(o,Ln)?o[Ln]:{}},Ue=function(o){return P(o,Ln)}}var An={set:we,get:ve,has:Ue,enforce:function(o){return Ue(o)?ve(o):we(o,{})},getterFor:function(o){return function(c){var l;if(!N(c)||(l=ve(c)).type!==o)throw TypeError("Incompatible receiver, "+o+" required");return l}}},wn=r(function(o){var c=An.get,l=An.enforce,f=String(String).split("String");(o.exports=function(_,m,v,I){var S,w=!!I&&!!I.unsafe,G=!!I&&!!I.enumerable,H=!!I&&!!I.noTargetGet;typeof v=="function"&&(typeof m!="string"||P(v,"name")||ne(v,"name",m),(S=l(v)).source||(S.source=f.join(typeof m=="string"?m:""))),_!==a?(w?!H&&_[m]&&(G=!0):delete _[m],G?_[m]=v:ne(_,m,v)):G?_[m]=v:ue(m,v)})(Function.prototype,"toString",function(){return typeof this=="function"&&c(this).source||be(this)})}),We=a,ln=function(o){return typeof o=="function"?o:void 0},Pe=function(o,c){return arguments.length<2?ln(We[o])||ln(a[o]):We[o]&&We[o][c]||a[o]&&a[o][c]},Ke=Math.ceil,yn=Math.floor,tn=function(o){return isNaN(o=+o)?0:(o>0?yn:Ke)(o)},st=Math.min,Cn=function(o){return o>0?st(tn(o),9007199254740991):0},Ve=Math.max,Ut=Math.min,mt=function(o,c){var l=tn(o);return l<0?Ve(l+c,0):Ut(l,c)},ut=function(o){return function(c,l,f){var _,m=O(c),v=Cn(m.length),I=mt(f,v);if(o&&l!=l){for(;v>I;)if((_=m[I++])!=_)return!0}else for(;v>I;I++)if((o||I in m)&&m[I]===l)return o||I||0;return!o&&-1}},In={includes:ut(!0),indexOf:ut(!1)},Qn=In.indexOf,Ct=function(o,c){var l,f=O(o),_=0,m=[];for(l in f)!P(kn,l)&&P(f,l)&&m.push(l);for(;c.length>_;)P(f,l=c[_++])&&(~Qn(m,l)||m.push(l));return m},Et=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ct=Et.concat("length","prototype"),Qt={f:Object.getOwnPropertyNames||function(o){return Ct(o,ct)}},Ot={f:Object.getOwnPropertySymbols},ft=Pe("Reflect","ownKeys")||function(o){var c=Qt.f(Q(o)),l=Ot.f;return l?c.concat(l(o)):c},rt=function(o,c){for(var l=ft(c),f=Z.f,_=Y.f,m=0;m<l.length;m++){var v=l[m];P(o,v)||f(o,v,_(c,v))}},xn=/#|\.prototype\./,Oe=function(o,c){var l=nn[Ee(o)];return l==Pn||l!=Sn&&(typeof c=="function"?s(c):!!c)},Ee=Oe.normalize=function(o){return String(o).replace(xn,".").toLowerCase()},nn=Oe.data={},Sn=Oe.NATIVE="N",Pn=Oe.POLYFILL="P",lt=Oe,qn=Y.f,Fn=function(o,c){var l,f,_,m,v,I=o.target,S=o.global,w=o.stat;if(l=S?a:w?a[I]||ue(I,{}):(a[I]||{}).prototype)for(f in c){if(m=c[f],_=o.noTargetGet?(v=qn(l,f))&&v.value:l[f],!lt(S?f:I+(w?".":"#")+f,o.forced)&&_!==void 0){if(typeof m==typeof _)continue;rt(m,_)}(o.sham||_&&_.sham)&&ne(m,"sham",!0),wn(l,f,m,o)}},At=function(o){if(typeof o!="function")throw TypeError(String(o)+" is not a function");return o},Pt=function(o,c,l){if(At(o),c===void 0)return o;switch(l){case 0:return function(){return o.call(c)};case 1:return function(f){return o.call(c,f)};case 2:return function(f,_){return o.call(c,f,_)};case 3:return function(f,_,m){return o.call(c,f,_,m)}}return function(){return o.apply(c,arguments)}},zn=function(o){return Object(A(o))},qt=Array.isArray||function(o){return y(o)=="Array"},cr=!!Object.getOwnPropertySymbols&&!s(function(){return!String(Symbol())}),Fe=cr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",un=$e("wks"),Ae=a.Symbol,Dn=Fe?Ae:Ae&&Ae.withoutSetter||Yn,pn=function(o){return P(un,o)||(cr&&P(Ae,o)?un[o]=Ae[o]:un[o]=Dn("Symbol."+o)),un[o]},it=pn("species"),yt=function(o,c){var l;return qt(o)&&(typeof(l=o.constructor)!="function"||l!==Array&&!qt(l.prototype)?N(l)&&(l=l[it])===null&&(l=void 0):l=void 0),new(l===void 0?Array:l)(c===0?0:c)},zt=[].push,Ht=function(o){var c=o==1,l=o==2,f=o==3,_=o==4,m=o==6,v=o==7,I=o==5||m;return function(S,w,G,H){for(var x,V,K=zn(S),te=T(K),me=Pt(w,G,3),_e=Cn(te.length),ye=0,Xe=H||yt,on=c?Xe(S,_e):l||v?Xe(S,0):void 0;_e>ye;ye++)if((I||ye in te)&&(V=me(x=te[ye],ye,K),o))if(c)on[ye]=V;else if(V)switch(o){case 3:return!0;case 5:return x;case 6:return ye;case 2:zt.call(on,x)}else switch(o){case 4:return!1;case 7:zt.call(on,x)}return m?-1:f||_?_:on}},Je={forEach:Ht(0),map:Ht(1),filter:Ht(2),some:Ht(3),every:Ht(4),find:Ht(5),findIndex:Ht(6),filterOut:Ht(7)},oe=function(o,c){var l=[][o];return!!l&&s(function(){l.call(null,c||function(){throw 1},1)})},ke=Object.defineProperty,fn={},bt=function(o){throw o},dt=function(o,c){if(P(fn,o))return fn[o];c||(c={});var l=[][o],f=!!P(c,"ACCESSORS")&&c.ACCESSORS,_=P(c,0)?c[0]:bt,m=P(c,1)?c[1]:void 0;return fn[o]=!!l&&!s(function(){if(f&&!u)return!0;var v={length:-1};f?ke(v,1,{enumerable:!0,get:bt}):v[1]=1,l.call(v,_,m)})},nr=Je.forEach,rr=oe("forEach"),Vr=dt("forEach"),Ir=rr&&Vr?[].forEach:function(o){return nr(this,o,arguments.length>1?arguments[1]:void 0)};Fn({target:"Array",proto:!0,forced:[].forEach!=Ir},{forEach:Ir});var bn,ot=Object.keys||function(o){return Ct(o,Et)},Tt=u?Object.defineProperties:function(o,c){Q(o);for(var l,f=ot(c),_=f.length,m=0;_>m;)Z.f(o,l=f[m++],c[l]);return o},ht=Pe("document","documentElement"),Oi="prototype",di="script",Ji=Tn("IE_PROTO"),Ds=function(){},Ls=function(o){return"<"+di+">"+o+"</"+di+">"},fu=function(){try{bn=document.domain&&new ActiveXObject("htmlfile")}catch{}var o,c,l;fu=bn?function(_){_.write(Ls("")),_.close();var m=_.parentWindow.Object;return _=null,m}(bn):(c=B("iframe"),l="java"+di+":",c.style.display="none",ht.appendChild(c),c.src=String(l),(o=c.contentWindow.document).open(),o.write(Ls("document.F=Object")),o.close(),o.F);for(var f=Et.length;f--;)delete fu[Oi][Et[f]];return fu()};kn[Ji]=!0;var ps=Object.create||function(o,c){var l;return o!==null?(Ds[Oi]=Q(o),l=new Ds,Ds[Oi]=null,l[Ji]=o):l=fu(),c===void 0?l:Tt(l,c)},hu=pn("unscopables"),pu=Array.prototype;pu[hu]==null&&Z.f(pu,hu,{configurable:!0,value:ps(null)});var ea,jo,fd,Ku=function(o){pu[hu][o]=!0},_u={},Mc=!s(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}),hd=Tn("IE_PROTO"),Oc=Object.prototype,mu=Mc?Object.getPrototypeOf:function(o){return o=zn(o),P(o,hd)?o[hd]:typeof o.constructor=="function"&&o instanceof o.constructor?o.constructor.prototype:o instanceof Object?Oc:null},qo=pn("iterator"),pd=!1;[].keys&&("next"in(fd=[].keys())?(jo=mu(mu(fd)))!==Object.prototype&&(ea=jo):pd=!0),ea==null&&(ea={}),P(ea,qo)||ne(ea,qo,function(){return this});var zo={IteratorPrototype:ea,BUGGY_SAFARI_ITERATORS:pd},Kh=Z.f,_d=pn("toStringTag"),gu=function(o,c,l){o&&!P(o=l?o:o.prototype,_d)&&Kh(o,_d,{configurable:!0,value:c})},kc=zo.IteratorPrototype,Wh=function(){return this},md=function(o,c,l){var f=c+" Iterator";return o.prototype=ps(kc,{next:g(1,l)}),gu(o,f,!1),_u[f]=Wh,o},Ko=Object.setPrototypeOf||("__proto__"in{}?function(){var o,c=!1,l={};try{(o=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(l,[]),c=l instanceof Array}catch{}return function(f,_){return Q(f),function(m){if(!N(m)&&m!==null)throw TypeError("Can't set "+String(m)+" as a prototype")}(_),c?o.call(f,_):f.__proto__=_,f}}():void 0),Wo=zo.IteratorPrototype,$o=zo.BUGGY_SAFARI_ITERATORS,Ft=pn("iterator"),St="keys",Ce="values",de="entries",$n=function(){return this},Rn=function(o,c,l,f,_,m,v){md(l,c,f);var I,S,w,G=function(_e){if(_e===_&&te)return te;if(!$o&&_e in V)return V[_e];switch(_e){case St:case Ce:case de:return function(){return new l(this,_e)}}return function(){return new l(this)}},H=c+" Iterator",x=!1,V=o.prototype,K=V[Ft]||V["@@iterator"]||_&&V[_],te=!$o&&K||G(_),me=c=="Array"&&V.entries||K;if(me&&(I=mu(me.call(new o)),Wo!==Object.prototype&&I.next&&(mu(I)!==Wo&&(Ko?Ko(I,Wo):typeof I[Ft]!="function"&&ne(I,Ft,$n)),gu(I,H,!0))),_==Ce&&K&&K.name!==Ce&&(x=!0,te=function(){return K.call(this)}),V[Ft]!==te&&ne(V,Ft,te),_u[c]=te,_)if(S={values:G(Ce),keys:m?te:G(St),entries:G(de)},v)for(w in S)($o||x||!(w in V))&&wn(V,w,S[w]);else Fn({target:c,proto:!0,forced:$o||x},S);return S},Wn="Array Iterator",Tr=An.set,Zt=An.getterFor(Wn),Yo=Rn(Array,"Array",function(o,c){Tr(this,{type:Wn,target:O(o),index:0,kind:c})},function(){var o=Zt(this),c=o.target,l=o.kind,f=o.index++;return!c||f>=c.length?(o.target=void 0,{value:void 0,done:!0}):l=="keys"?{value:f,done:!1}:l=="values"?{value:c[f],done:!1}:{value:[f,c[f]],done:!1}},"values");_u.Arguments=_u.Array,Ku("keys"),Ku("values"),Ku("entries");var UD=!s(function(){return Object.isExtensible(Object.preventExtensions({}))}),gd=r(function(o){var c=Z.f,l=Yn("meta"),f=0,_=Object.isExtensible||function(){return!0},m=function(I){c(I,l,{value:{objectID:"O"+ ++f,weakData:{}}})},v=o.exports={REQUIRED:!1,fastKey:function(I,S){if(!N(I))return typeof I=="symbol"?I:(typeof I=="string"?"S":"P")+I;if(!P(I,l)){if(!_(I))return"F";if(!S)return"E";m(I)}return I[l].objectID},getWeakData:function(I,S){if(!P(I,l)){if(!_(I))return!0;if(!S)return!1;m(I)}return I[l].weakData},onFreeze:function(I){return UD&&v.REQUIRED&&_(I)&&!P(I,l)&&m(I),I}};kn[l]=!0}),PD=(gd.REQUIRED,gd.fastKey,gd.getWeakData,gd.onFreeze,pn("iterator")),FD=Array.prototype,s0=function(o){return o!==void 0&&(_u.Array===o||FD[PD]===o)},u0={};u0[pn("toStringTag")]="z";var Wm=String(u0)==="[object z]",HD=pn("toStringTag"),BD=y(function(){return arguments}())=="Arguments",$m=Wm?y:function(o){var c,l,f;return o===void 0?"Undefined":o===null?"Null":typeof(l=function(_,m){try{return _[m]}catch{}}(c=Object(o),HD))=="string"?l:BD?y(c):(f=y(c))=="Object"&&typeof c.callee=="function"?"Arguments":f},GD=pn("iterator"),$h=function(o){if(o!=null)return o[GD]||o["@@iterator"]||_u[$m(o)]},Ym=function(o){var c=o.return;if(c!==void 0)return Q(c.call(o)).value},Dc=function(o,c){this.stopped=o,this.result=c},Yh=function(o,c,l){var f,_,m,v,I,S,w,G=l&&l.that,H=!(!l||!l.AS_ENTRIES),x=!(!l||!l.IS_ITERATOR),V=!(!l||!l.INTERRUPTED),K=Pt(c,G,1+H+V),te=function(_e){return f&&Ym(f),new Dc(!0,_e)},me=function(_e){return H?(Q(_e),V?K(_e[0],_e[1],te):K(_e[0],_e[1])):V?K(_e,te):K(_e)};if(x)f=o;else{if(typeof(_=$h(o))!="function")throw TypeError("Target is not iterable");if(s0(_)){for(m=0,v=Cn(o.length);v>m;m++)if((I=me(o[m]))&&I instanceof Dc)return I;return new Dc(!1)}f=_.call(o)}for(S=f.next;!(w=S.call(f)).done;){try{I=me(w.value)}catch(_e){throw Ym(f),_e}if(typeof I=="object"&&I&&I instanceof Dc)return I}return new Dc(!1)},Lc=function(o,c,l){if(!(o instanceof c))throw TypeError("Incorrect "+(l?l+" ":"")+"invocation");return o},o0=pn("iterator"),l0=!1;try{var VD=0,d0={next:function(){return{done:!!VD++}},return:function(){l0=!0}};d0[o0]=function(){return this},Array.from(d0,function(){throw 2})}catch{}var Qm=function(o,c){if(!l0)return!1;var l=!1;try{var f={};f[o0]=function(){return{next:function(){return{done:l=!0}}}},o(f)}catch{}return l},c0=function(o,c,l){var f,_;return Ko&&typeof(f=c.constructor)=="function"&&f!==l&&N(_=f.prototype)&&_!==l.prototype&&Ko(o,_),o},Qh=function(o,c,l){for(var f in c)wn(o,f,c[f],l);return o},f0=pn("species"),h0=function(o){var c=Pe(o),l=Z.f;u&&c&&!c[f0]&&l(c,f0,{configurable:!0,get:function(){return this}})},jD=Z.f,p0=gd.fastKey,_0=An.set,Zm=An.getterFor,qD={getConstructor:function(o,c,l,f){var _=o(function(S,w){Lc(S,_,c),_0(S,{type:c,index:ps(null),first:void 0,last:void 0,size:0}),u||(S.size=0),w!=null&&Yh(w,S[f],{that:S,AS_ENTRIES:l})}),m=Zm(c),v=function(S,w,G){var H,x,V=m(S),K=I(S,w);return K?K.value=G:(V.last=K={index:x=p0(w,!0),key:w,value:G,previous:H=V.last,next:void 0,removed:!1},V.first||(V.first=K),H&&(H.next=K),u?V.size++:S.size++,x!=="F"&&(V.index[x]=K)),S},I=function(S,w){var G,H=m(S),x=p0(w);if(x!=="F")return H.index[x];for(G=H.first;G;G=G.next)if(G.key==w)return G};return Qh(_.prototype,{clear:function(){for(var S=m(this),w=S.index,G=S.first;G;)G.removed=!0,G.previous&&(G.previous=G.previous.next=void 0),delete w[G.index],G=G.next;S.first=S.last=void 0,u?S.size=0:this.size=0},delete:function(S){var w=this,G=m(w),H=I(w,S);if(H){var x=H.next,V=H.previous;delete G.index[H.index],H.removed=!0,V&&(V.next=x),x&&(x.previous=V),G.first==H&&(G.first=x),G.last==H&&(G.last=V),u?G.size--:w.size--}return!!H},forEach:function(S){for(var w,G=m(this),H=Pt(S,arguments.length>1?arguments[1]:void 0,3);w=w?w.next:G.first;)for(H(w.value,w.key,this);w&&w.removed;)w=w.previous},has:function(S){return!!I(this,S)}}),Qh(_.prototype,l?{get:function(S){var w=I(this,S);return w&&w.value},set:function(S,w){return v(this,S===0?0:S,w)}}:{add:function(S){return v(this,S=S===0?0:S,S)}}),u&&jD(_.prototype,"size",{get:function(){return m(this).size}}),_},setStrong:function(o,c,l){var f=c+" Iterator",_=Zm(c),m=Zm(f);Rn(o,c,function(v,I){_0(this,{type:f,target:v,state:_(v),kind:I,last:void 0})},function(){for(var v=m(this),I=v.kind,S=v.last;S&&S.removed;)S=S.previous;return v.target&&(v.last=S=S?S.next:v.state.first)?I=="keys"?{value:S.key,done:!1}:I=="values"?{value:S.value,done:!1}:{value:[S.key,S.value],done:!1}:(v.target=void 0,{value:void 0,done:!0})},l?"entries":"values",!l,!0),h0(c)}},zD=(function(o,c,l){var f=o.indexOf("Map")!==-1,_=o.indexOf("Weak")!==-1,m=f?"set":"add",v=a[o],I=v&&v.prototype,S=v,w={},G=function(me){var _e=I[me];wn(I,me,me=="add"?function(ye){return _e.call(this,ye===0?0:ye),this}:me=="delete"?function(ye){return!(_&&!N(ye))&&_e.call(this,ye===0?0:ye)}:me=="get"?function(ye){return _&&!N(ye)?void 0:_e.call(this,ye===0?0:ye)}:me=="has"?function(ye){return!(_&&!N(ye))&&_e.call(this,ye===0?0:ye)}:function(ye,Xe){return _e.call(this,ye===0?0:ye,Xe),this})};if(lt(o,typeof v!="function"||!(_||I.forEach&&!s(function(){new v().entries().next()}))))S=l.getConstructor(c,o,f,m),gd.REQUIRED=!0;else if(lt(o,!0)){var H=new S,x=H[m](_?{}:-0,1)!=H,V=s(function(){H.has(1)}),K=Qm(function(me){new v(me)}),te=!_&&s(function(){for(var me=new v,_e=5;_e--;)me[m](_e,_e);return!me.has(-0)});K||((S=c(function(me,_e){Lc(me,S,o);var ye=c0(new v,me,S);return _e!=null&&Yh(_e,ye[m],{that:ye,AS_ENTRIES:f}),ye})).prototype=I,I.constructor=S),(V||te)&&(G("delete"),G("has"),f&&G("get")),(te||x)&&G(m),_&&I.clear&&delete I.clear}w[o]=S,Fn({global:!0,forced:S!=v},w),gu(S,o),_||l.setStrong(S,o,f)}("Map",function(o){return function(){return o(this,arguments.length?arguments[0]:void 0)}},qD),Wm?{}.toString:function(){return"[object "+$m(this)+"]"});Wm||wn(Object.prototype,"toString",zD,{unsafe:!0});var m0=function(o){return function(c,l){var f,_,m=String(A(c)),v=tn(l),I=m.length;return v<0||v>=I?o?"":void 0:(f=m.charCodeAt(v))<55296||f>56319||v+1===I||(_=m.charCodeAt(v+1))<56320||_>57343?o?m.charAt(v):f:o?m.slice(v,v+2):_-56320+(f-55296<<10)+65536}},Xm={codeAt:m0(!1),charAt:m0(!0)},KD=Xm.charAt,g0="String Iterator",WD=An.set,$D=An.getterFor(g0);Rn(String,"String",function(o){WD(this,{type:g0,string:String(o),index:0})},function(){var o,c=$D(this),l=c.string,f=c.index;return f>=l.length?{value:void 0,done:!0}:(o=KD(l,f),c.index+=o.length,{value:o,done:!1})});var Jm={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};for(var YD in Jm){var v0=a[YD],Zh=v0&&v0.prototype;if(Zh&&Zh.forEach!==Ir)try{ne(Zh,"forEach",Ir)}catch{Zh.forEach=Ir}}var De,eg=pn("iterator"),E0=pn("toStringTag"),ng=Yo.values;for(var tg in Jm){var y0=a[tg],vu=y0&&y0.prototype;if(vu){if(vu[eg]!==ng)try{ne(vu,eg,ng)}catch{vu[eg]=ng}if(vu[E0]||ne(vu,E0,tg),Jm[tg]){for(var vd in Yo)if(vu[vd]!==Yo[vd])try{ne(vu,vd,Yo[vd])}catch{vu[vd]=Yo[vd]}}}}function Xh(o){return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Xh(o)}function b0(o,c,l,f,_,m,v){try{var I=o[m](v),S=I.value}catch(w){return void l(w)}I.done?c(S):Promise.resolve(S).then(f,_)}function Bn(o){return function(){var c=this,l=arguments;return new Promise(function(f,_){var m=o.apply(c,l);function v(S){b0(m,f,_,v,I,"next",S)}function I(S){b0(m,f,_,v,I,"throw",S)}v(void 0)})}}function ie(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")}function C0(o,c){for(var l=0;l<c.length;l++){var f=c[l];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(o,f.key,f)}}function se(o,c,l){return c&&C0(o.prototype,c),l&&C0(o,l),o}function qe(o,c,l){return c in o?Object.defineProperty(o,c,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[c]=l,o}function I0(o,c){var l=Object.keys(o);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(o);c&&(f=f.filter(function(_){return Object.getOwnPropertyDescriptor(o,_).enumerable})),l.push.apply(l,f)}return l}function Fr(o){for(var c=1;c<arguments.length;c++){var l=arguments[c]!=null?arguments[c]:{};c%2?I0(Object(l),!0).forEach(function(f){qe(o,f,l[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(l)):I0(Object(l)).forEach(function(f){Object.defineProperty(o,f,Object.getOwnPropertyDescriptor(l,f))})}return o}function ce(o,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(c&&c.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),c&&xc(o,c)}function Xa(o){return Xa=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Xa(o)}function xc(o,c){return xc=Object.setPrototypeOf||function(l,f){return l.__proto__=f,l},xc(o,c)}function T0(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function xr(o,c,l){return xr=T0()?Reflect.construct:function(f,_,m){var v=[null];v.push.apply(v,_);var I=new(Function.bind.apply(f,v));return m&&xc(I,m.prototype),I},xr.apply(null,arguments)}function rg(o){var c=typeof Map=="function"?new Map:void 0;return rg=function(l){if(l===null||(f=l,Function.toString.call(f).indexOf("[native code]")===-1))return l;var f;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(c!==void 0){if(c.has(l))return c.get(l);c.set(l,_)}function _(){return xr(l,arguments,Xa(this).constructor)}return _.prototype=Object.create(l.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),xc(_,l)},rg(o)}function ig(o,c){if(o==null)return{};var l,f,_=function(v,I){if(v==null)return{};var S,w,G={},H=Object.keys(v);for(w=0;w<H.length;w++)S=H[w],I.indexOf(S)>=0||(G[S]=v[S]);return G}(o,c);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(o);for(f=0;f<m.length;f++)l=m[f],c.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(o,l)&&(_[l]=o[l])}return _}function je(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function fe(o){var c=T0();return function(){var l,f=Xa(o);if(c){var _=Xa(this).constructor;l=Reflect.construct(f,arguments,_)}else l=f.apply(this,arguments);return function(m,v){return!v||typeof v!="object"&&typeof v!="function"?je(m):v}(this,l)}}function Wu(o,c,l){return Wu=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(f,_,m){var v=function(S,w){for(;!Object.prototype.hasOwnProperty.call(S,w)&&(S=Xa(S))!==null;);return S}(f,_);if(v){var I=Object.getOwnPropertyDescriptor(v,_);return I.get?I.get.call(m):I.value}},Wu(o,c,l||o)}function $u(o,c){return S0(o)||function(l,f){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(l)))){var _=[],m=!0,v=!1,I=void 0;try{for(var S,w=l[Symbol.iterator]();!(m=(S=w.next()).done)&&(_.push(S.value),!f||_.length!==f);m=!0);}catch(G){v=!0,I=G}finally{try{m||w.return==null||w.return()}finally{if(v)throw I}}return _}}(o,c)||Jh(o,c)||A0()}function Ed(o){return function(c){if(Array.isArray(c))return ag(c)}(o)||N0(o)||Jh(o)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function S0(o){if(Array.isArray(o))return o}function N0(o){if(typeof Symbol<"u"&&Symbol.iterator in Object(o))return Array.from(o)}function Jh(o,c){if(o){if(typeof o=="string")return ag(o,c);var l=Object.prototype.toString.call(o).slice(8,-1);return l==="Object"&&o.constructor&&(l=o.constructor.name),l==="Map"||l==="Set"?Array.from(o):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?ag(o,c):void 0}}function ag(o,c){(c==null||c>o.length)&&(c=o.length);for(var l=0,f=new Array(c);l<c;l++)f[l]=o[l];return f}function A0(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hr(o,c){var l;if(typeof Symbol>"u"||o[Symbol.iterator]==null){if(Array.isArray(o)||(l=Jh(o))||c){l&&(o=l);var f=0,_=function(){};return{s:_,n:function(){return f>=o.length?{done:!0}:{done:!1,value:o[f++]}},e:function(S){throw S},f:_}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m,v=!0,I=!1;return{s:function(){l=o[Symbol.iterator]()},n:function(){var S=l.next();return v=S.done,S},e:function(S){I=!0,m=S},f:function(){try{v||l.return==null||l.return()}finally{if(I)throw m}}}}function w0(o){var c=function(l,f){if(typeof l!="object"||l===null)return l;var _=l[Symbol.toPrimitive];if(_!==void 0){var m=_.call(l,f||"default");if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(l)}(o,"string");return typeof c=="symbol"?c:String(c)}function R0(o,c,l,f){var _=M0(),m=c(function(I){_.initializeInstanceElements(I,v.elements)},l),v=_.decorateClass(function(I){for(var S=[],w=function(V){return V.kind==="method"&&V.key===x.key&&V.placement===x.placement},G=0;G<I.length;G++){var H,x=I[G];if(x.kind==="method"&&(H=S.find(w)))if(O0(x.descriptor)||O0(H.descriptor)){if(Uc(x)||Uc(H))throw new ReferenceError("Duplicated methods ("+x.key+") can't be decorated.");H.descriptor=x.descriptor}else{if(Uc(x)){if(Uc(H))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+x.key+").");H.decorators=x.decorators}ZD(x,H)}else S.push(x)}return S}(m.d.map(QD)),o);return _.initializeClassElements(m.F,v.elements),_.runClassFinishers(m.F,v.finishers)}function M0(){M0=function(){return o};var o={elementsDefinitionOrder:[["method"],["field"]],initializeInstanceElements:function(c,l){["method","field"].forEach(function(f){l.forEach(function(_){_.kind===f&&_.placement==="own"&&this.defineClassElement(c,_)},this)},this)},initializeClassElements:function(c,l){var f=c.prototype;["method","field"].forEach(function(_){l.forEach(function(m){var v=m.placement;if(m.kind===_&&(v==="static"||v==="prototype")){var I=v==="static"?c:f;this.defineClassElement(I,m)}},this)},this)},defineClassElement:function(c,l){var f=l.descriptor;if(l.kind==="field"){var _=l.initializer;f={enumerable:f.enumerable,writable:f.writable,configurable:f.configurable,value:_===void 0?void 0:_.call(c)}}Object.defineProperty(c,l.key,f)},decorateClass:function(c,l){var f=[],_=[],m={static:[],prototype:[],own:[]};if(c.forEach(function(I){this.addElementPlacement(I,m)},this),c.forEach(function(I){if(!Uc(I))return f.push(I);var S=this.decorateElement(I,m);f.push(S.element),f.push.apply(f,S.extras),_.push.apply(_,S.finishers)},this),!l)return{elements:f,finishers:_};var v=this.decorateConstructor(f,l);return _.push.apply(_,v.finishers),v.finishers=_,v},addElementPlacement:function(c,l,f){var _=l[c.placement];if(!f&&_.indexOf(c.key)!==-1)throw new TypeError("Duplicated element ("+c.key+")");_.push(c.key)},decorateElement:function(c,l){for(var f=[],_=[],m=c.decorators,v=m.length-1;v>=0;v--){var I=l[c.placement];I.splice(I.indexOf(c.key),1);var S=this.fromElementDescriptor(c),w=this.toElementFinisherExtras((0,m[v])(S)||S);c=w.element,this.addElementPlacement(c,l),w.finisher&&_.push(w.finisher);var G=w.extras;if(G){for(var H=0;H<G.length;H++)this.addElementPlacement(G[H],l);f.push.apply(f,G)}}return{element:c,finishers:_,extras:f}},decorateConstructor:function(c,l){for(var f=[],_=l.length-1;_>=0;_--){var m=this.fromClassDescriptor(c),v=this.toClassDescriptor((0,l[_])(m)||m);if(v.finisher!==void 0&&f.push(v.finisher),v.elements!==void 0){c=v.elements;for(var I=0;I<c.length-1;I++)for(var S=I+1;S<c.length;S++)if(c[I].key===c[S].key&&c[I].placement===c[S].placement)throw new TypeError("Duplicated element ("+c[I].key+")")}}return{elements:c,finishers:f}},fromElementDescriptor:function(c){var l={kind:c.kind,key:c.key,placement:c.placement,descriptor:c.descriptor};return Object.defineProperty(l,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),c.kind==="field"&&(l.initializer=c.initializer),l},toElementDescriptors:function(c){var l;if(c!==void 0)return(l=c,S0(l)||N0(l)||Jh(l)||A0()).map(function(f){var _=this.toElementDescriptor(f);return this.disallowProperty(f,"finisher","An element descriptor"),this.disallowProperty(f,"extras","An element descriptor"),_},this)},toElementDescriptor:function(c){var l=String(c.kind);if(l!=="method"&&l!=="field")throw new TypeError(`An element descriptor's .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "`+l+'"');var f=w0(c.key),_=String(c.placement);if(_!=="static"&&_!=="prototype"&&_!=="own")throw new TypeError(`An element descriptor's .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "`+_+'"');var m=c.descriptor;this.disallowProperty(c,"elements","An element descriptor");var v={kind:l,key:f,placement:_,descriptor:Object.assign({},m)};return l!=="field"?this.disallowProperty(c,"initializer","A method descriptor"):(this.disallowProperty(m,"get","The property descriptor of a field descriptor"),this.disallowProperty(m,"set","The property descriptor of a field descriptor"),this.disallowProperty(m,"value","The property descriptor of a field descriptor"),v.initializer=c.initializer),v},toElementFinisherExtras:function(c){return{element:this.toElementDescriptor(c),finisher:k0(c,"finisher"),extras:this.toElementDescriptors(c.extras)}},fromClassDescriptor:function(c){var l={kind:"class",elements:c.map(this.fromElementDescriptor,this)};return Object.defineProperty(l,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),l},toClassDescriptor:function(c){var l=String(c.kind);if(l!=="class")throw new TypeError(`A class descriptor's .kind property must be "class", but a decorator created a class descriptor with .kind "`+l+'"');this.disallowProperty(c,"key","A class descriptor"),this.disallowProperty(c,"placement","A class descriptor"),this.disallowProperty(c,"descriptor","A class descriptor"),this.disallowProperty(c,"initializer","A class descriptor"),this.disallowProperty(c,"extras","A class descriptor");var f=k0(c,"finisher");return{elements:this.toElementDescriptors(c.elements),finisher:f}},runClassFinishers:function(c,l){for(var f=0;f<l.length;f++){var _=(0,l[f])(c);if(_!==void 0){if(typeof _!="function")throw new TypeError("Finishers must return a constructor.");c=_}}return c},disallowProperty:function(c,l,f){if(c[l]!==void 0)throw new TypeError(f+" can't have a ."+l+" property.")}};return o}function QD(o){var c,l=w0(o.key);o.kind==="method"?c={value:o.value,writable:!0,configurable:!0,enumerable:!1}:o.kind==="get"?c={get:o.value,configurable:!0,enumerable:!1}:o.kind==="set"?c={set:o.value,configurable:!0,enumerable:!1}:o.kind==="field"&&(c={configurable:!0,writable:!0,enumerable:!0});var f={kind:o.kind==="field"?"field":"method",key:l,placement:o.static?"static":o.kind==="field"?"own":"prototype",descriptor:c};return o.decorators&&(f.decorators=o.decorators),o.kind==="field"&&(f.initializer=o.value),f}function ZD(o,c){o.descriptor.get!==void 0?c.descriptor.get=o.descriptor.get:c.descriptor.set=o.descriptor.set}function Uc(o){return o.decorators&&o.decorators.length}function O0(o){return o!==void 0&&!(o.value===void 0&&o.writable===void 0)}function k0(o,c){var l=o[c];if(l!==void 0&&typeof l!="function")throw new TypeError("Expected '"+c+"' to be a function");return l}(function(o){o[o.DIAL_CANCELED=1800100]="DIAL_CANCELED",o[o.MY_USER_ID_NOT_ALLOWED=1800101]="MY_USER_ID_NOT_ALLOWED",o[o.ERR_REQUEST_FAILED=1800200]="ERR_REQUEST_FAILED",o[o.ERR_WEBSOCKET_CONNECTION_NOT_OPENED=1800201]="ERR_WEBSOCKET_CONNECTION_NOT_OPENED",o[o.ERR_WEBSOCKET_CONNECTION_FAILED=1800202]="ERR_WEBSOCKET_CONNECTION_FAILED",o[o.ERR_NO_RESPONSE_DUE_TO_TIMEOUT=1800203]="ERR_NO_RESPONSE_DUE_TO_TIMEOUT",o[o.ERR_REQUEST_FAILED_DUE_TO_WEBSOCKET_CONNECTION_LOST=1800204]="ERR_REQUEST_FAILED_DUE_TO_WEBSOCKET_CONNECTION_LOST",o[o.ERR_WRONG_RESPONSE=1800205]="ERR_WRONG_RESPONSE",o[o.ERR_QUERY_IN_PROGRESS=1800206]="ERR_QUERY_IN_PROGRESS",o[o.INTERNAL_SERVER_ERROR=1800207]="INTERNAL_SERVER_ERROR",o[o.ERR_MALFORMED_DATA=1800208]="ERR_MALFORMED_DATA",o[o.ERR_PARTICIPANT_ALREADY_IN_ROOM=1800700]="ERR_PARTICIPANT_ALREADY_IN_ROOM",o[o.ERR_ENTERING_ROOM_STILL_IN_PROGRESS=1800701]="ERR_ENTERING_ROOM_STILL_IN_PROGRESS",o[o.ERR_PARTICIPANT_NOT_IN_ROOM=1800702]="ERR_PARTICIPANT_NOT_IN_ROOM",o[o.ERR_EXITING_ROOM_STILL_IN_PROGRESS=1800703]="ERR_EXITING_ROOM_STILL_IN_PROGRESS",o[o.ERR_FAILED_TO_ESTABLISH_CONNECTION_TO_SEND_STREAM=1800704]="ERR_FAILED_TO_ESTABLISH_CONNECTION_TO_SEND_STREAM",o[o.ERR_FAILED_TO_ESTABLISH_CONNECTION_TO_RECEIVE_STREAM=1800705]="ERR_FAILED_TO_ESTABLISH_CONNECTION_TO_RECEIVE_STREAM",o[o.ERR_LOCAL_PARTICIPANT_LOST_CONNECTION=1800706]="ERR_LOCAL_PARTICIPANT_LOST_CONNECTION",o[o.ERR_LOCAL_PARTICIPANT_KICKED_OUT=1800707]="ERR_LOCAL_PARTICIPANT_KICKED_OUT",o[o.INVALID_PARAMETER_VALUE=1800300]="INVALID_PARAMETER_VALUE",o[o.INVALID_PARAMETER_TYPE=1800301]="INVALID_PARAMETER_TYPE",o[o.INSTANCE_NOT_INITIALIZED=1800302]="INSTANCE_NOT_INITIALIZED",o[o.USER_NOT_AUTHENTICATED=1800303]="USER_NOT_AUTHENTICATED",o[o.CAMERA_ALREADY_SWITCHING=1800400]="CAMERA_ALREADY_SWITCHING",o[o.ERR_CAMERA_SWITCH=1800401]="ERR_CAMERA_SWITCH",o[o.ERR_CHANGING_AUDIO_DEVICE=1800402]="ERR_CHANGING_AUDIO_DEVICE",o[o.ERR_CAPTURE_NOT_ALLOWED_ON_AUDIO_CALL=1800600]="ERR_CAPTURE_NOT_ALLOWED_ON_AUDIO_CALL",o[o.ERR_VIDEO_VIEW_NOT_READY=1800601]="ERR_VIDEO_VIEW_NOT_READY",o[o.ERR_VIDEO_CALL_NOT_CONNECTED_YET=1800602]="ERR_VIDEO_CALL_NOT_CONNECTED_YET",o[o.ERR_FAILED_TO_GET_IMAGE_FROM_VIDEO_STREAM=1800603]="ERR_FAILED_TO_GET_IMAGE_FROM_VIDEO_STREAM",o[o.ERR_SERVER_INTERNAL_ERROR=1400999]="ERR_SERVER_INTERNAL_ERROR",o[o.ERR_INVALID_CALL_STATUS=1400101]="ERR_INVALID_CALL_STATUS",o[o.ERR_CALL_DOES_NOT_EXIST=1400102]="ERR_CALL_DOES_NOT_EXIST",o[o.ERR_CALLEE_DOES_NOT_EXIST=1400103]="ERR_CALLEE_DOES_NOT_EXIST",o[o.ERR_DIAL_MYSELF=1400104]="ERR_DIAL_MYSELF",o[o.ERR_NO_PERMISSION=1400105]="ERR_NO_PERMISSION",o[o.ERR_CALLEE_NEVER_AUTHENTICATE=1400106]="ERR_CALLEE_NEVER_AUTHENTICATE",o[o.ERR_ROOM_MAX_PARTICIPANTS=1400120]="ERR_ROOM_MAX_PARTICIPANTS",o[o.ERR_INVALID_ROOM_PARTICIPANT=1400121]="ERR_INVALID_ROOM_PARTICIPANT",o[o.ERR_CLIENT_ALREADY_ENTERED=1400122]="ERR_CLIENT_ALREADY_ENTERED",o[o.ERR_SEND_ENDPOINT_CANNOT_ATTACH=1400123]="ERR_SEND_ENDPOINT_CANNOT_ATTACH",o[o.ERR_PARTICIPANT_ALREADY_HAS_SEND_ENDPOINT=1400124]="ERR_PARTICIPANT_ALREADY_HAS_SEND_ENDPOINT",o[o.ERR_ROOM_DELETED=1400126]="ERR_ROOM_DELETED",o[o.ERR_CALL_NOT_CONNECTED_YET=1800610]="ERR_CALL_NOT_CONNECTED_YET",o[o.ERR_WRONG_RECORDING_TYPE_FOR_AUDIO_CALL=1800611]="ERR_WRONG_RECORDING_TYPE_FOR_AUDIO_CALL",o[o.ERR_RECORDING_ALREADY_IN_PROGRESS=1800612]="ERR_RECORDING_ALREADY_IN_PROGRESS",o[o.ERR_FAILED_TO_OPEN_FILE=1800613]="ERR_FAILED_TO_OPEN_FILE",o[o.ERR_FAILED_TO_START_RECORDING=1800614]="ERR_FAILED_TO_START_RECORDING",o[o.ERR_FAILED_TO_STOP_RECORDING=1800615]="ERR_FAILED_TO_STOP_RECORDING",o[o.ERR_NOT_SUPPORTED_BROWSER_FOR_RECORDING=1800616]="ERR_NOT_SUPPORTED_BROWSER_FOR_RECORDING",o[o.ERR_INVALID_RECORDING_TYPE=1800617]="ERR_INVALID_RECORDING_TYPE",o[o.ERR_NOT_SUPPORTED_OS_VERSION_FOR_RECORDING=1800618]="ERR_NOT_SUPPORTED_OS_VERSION_FOR_RECORDING",o[o.ERR_SCREEN_SHARE_RESTRICTED_FROM_AUDIO_CALL=1800620]="ERR_SCREEN_SHARE_RESTRICTED_FROM_AUDIO_CALL",o[o.ERR_SCREEN_SHARE_REQUEST_BEFORE_CALL_IS_CONNECTED=1800621]="ERR_SCREEN_SHARE_REQUEST_BEFORE_CALL_IS_CONNECTED",o[o.ERR_SCREEN_SHARE_ALREADY_IN_PROGRESS=1800622]="ERR_SCREEN_SHARE_ALREADY_IN_PROGRESS",o[o.ERR_NO_SCREEN_SHARE_EXISTS=1800623]="ERR_NO_SCREEN_SHARE_EXISTS",o[o.ERR_NOT_SUPPORTED_BROWSER_FOR_SCREEN_SHARE=1800625]="ERR_NOT_SUPPORTED_BROWSER_FOR_SCREEN_SHARE",o[o.ERR_SCREEN_SHARE_FAILED_DUE_TO_UNKNOWN_REASON=1800626]="ERR_SCREEN_SHARE_FAILED_DUE_TO_UNKNOWN_REASON",o[o.ERR_NOT_SUPPORTED_APP_STATE_FOR_SCREEN_SHARE=1800627]="ERR_NOT_SUPPORTED_APP_STATE_FOR_SCREEN_SHARE",o[o.ERR_PERMISSION_DENIED_FOR_SCREEN_SHARE=1800628]="ERR_PERMISSION_DENIED_FOR_SCREEN_SHARE",o[o.ERR_SELECTED_CONTENT_NOT_EXIST=1800629]="ERR_SELECTED_CONTENT_NOT_EXIST",o[o.ERR_SELECTED_CONTENT_INACCESSIBLE=1800630]="ERR_SELECTED_CONTENT_INACCESSIBLE",o[o.ERR_MEDIA_STREAM_NOT_ALLOWED_ON_HOLD=1800631]="ERR_MEDIA_STREAM_NOT_ALLOWED_ON_HOLD",o[o.ERR_CALL_ALREADY_ON_HOLD=1800801]="ERR_CALL_ALREADY_ON_HOLD",o[o.ERR_ACTIVE_CALL_IN_PROGRESS=1800802]="ERR_ACTIVE_CALL_IN_PROGRESS",o[o.ERR_ANOTHER_CALL_IN_PROGRESS=1800803]="ERR_ANOTHER_CALL_IN_PROGRESS"})(De||(De={}));var yd,ep,Yu=function(){function o(){ie(this,o)}return se(o,null,[{key:"getErrorMessage",value:function(c){var l=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).invalidParameter,f=l===void 0?"":l;switch(c){case De.DIAL_CANCELED:return"Call canceled before receiving a callback.";case De.MY_USER_ID_NOT_ALLOWED:return"The caller can't dial their own user ID.";case De.ERR_REQUEST_FAILED:return"The http request failed.";case De.ERR_WEBSOCKET_CONNECTION_NOT_OPENED:return"Websocket connection not established.";case De.ERR_WEBSOCKET_CONNECTION_FAILED:return"Websocket connection failed.";case De.ERR_NO_RESPONSE_DUE_TO_TIMEOUT:return"The request failed to receive a response due to timeout.";case De.ERR_REQUEST_FAILED_DUE_TO_WEBSOCKET_CONNECTION_LOST:return"The request failed because the websocket connection is lost.";case De.ERR_WRONG_RESPONSE:return"The response contains an unexpected object type of data.";case De.ERR_QUERY_IN_PROGRESS:return"The previous query is still in progress.";case De.INTERNAL_SERVER_ERROR:return"An internal server error has occurred.";case De.ERR_MALFORMED_DATA:return"The data format of the response is invalid.";case De.INVALID_PARAMETER_VALUE:return"".concat(f," is an invalid or empty value.");case De.INVALID_PARAMETER_TYPE:return"The data type of ".concat(f," is invalid.");case De.INSTANCE_NOT_INITIALIZED:return"SendBirdCall instance not initialized.";case De.USER_NOT_AUTHENTICATED:return"The user is not authenticated.";case De.CAMERA_ALREADY_SWITCHING:return"Camera is already switching.";case De.ERR_CAMERA_SWITCH:return"A camera switch error has occurred.";case De.ERR_CHANGING_AUDIO_DEVICE:return"An error occurred while changing audio device.";case De.ERR_CAPTURE_NOT_ALLOWED_ON_AUDIO_CALL:return"Capturing a video view isn't allowed while on an audio call.";case De.ERR_VIDEO_VIEW_NOT_READY:return"A video view isn't ready to be captured.";case De.ERR_VIDEO_CALL_NOT_CONNECTED_YET:return"A video call isn't connected yet therefore can't capture a video view.";case De.ERR_FAILED_TO_GET_IMAGE_FROM_VIDEO_STREAM:return"An error occurred while getting an image form the video stream.";case De.ERR_ROOM_MAX_PARTICIPANTS:return"The room has reached max participants.";case De.ERR_INVALID_ROOM_PARTICIPANT:return"The room participant argument is not valid.";case De.ERR_CLIENT_ALREADY_ENTERED:return"The given client is already entered.";case De.ERR_SEND_ENDPOINT_CANNOT_ATTACH:return"The send endpoint failed to attach.";case De.ERR_PARTICIPANT_ALREADY_HAS_SEND_ENDPOINT:return"The given participant already has send endpoint.";case De.ERR_CALL_NOT_CONNECTED_YET:return"A call isn’t connected yet therefore can’t start media recording.";case De.ERR_WRONG_RECORDING_TYPE_FOR_AUDIO_CALL:return"A wrong recording type is selected in an audio call.";case De.ERR_RECORDING_ALREADY_IN_PROGRESS:return"An ongoing recording session is already in progress.";case De.ERR_FAILED_TO_OPEN_FILE:return"Couldn't open a recording file due to an error.";case De.ERR_FAILED_TO_START_RECORDING:return"Couldn't start a recording session due to an error.";case De.ERR_FAILED_TO_STOP_RECORDING:return"Coudln't stop a recording session due to an error.";case De.ERR_NOT_SUPPORTED_BROWSER_FOR_RECORDING:return"The browser doesn't support media recording.";case De.ERR_INVALID_RECORDING_TYPE:return"Invalid recording type is selected.";case De.ERR_NOT_SUPPORTED_OS_VERSION_FOR_RECORDING:return"The operating system version doesn't support media recording.";case De.ERR_SCREEN_SHARE_RESTRICTED_FROM_AUDIO_CALL:return"Screen share is restricted from audio calls.";case De.ERR_SCREEN_SHARE_REQUEST_BEFORE_CALL_IS_CONNECTED:return"A call isn't connected yet, but the request for screen share has been made.";case De.ERR_SCREEN_SHARE_ALREADY_IN_PROGRESS:return"The user is trying to share the screen while the previous request is still in progress.";case De.ERR_MEDIA_STREAM_NOT_ALLOWED_ON_HOLD:return"Screen sharing or any other actions that need media streaming as well as capturing screen aren't allowed while a call is on hold.";case De.ERR_NOT_SUPPORTED_BROWSER_FOR_SCREEN_SHARE:return"The browser doesn't support screen share.";case De.ERR_SCREEN_SHARE_FAILED_DUE_TO_UNKNOWN_REASON:return"Screen share failed due to unknown reason.";case De.ERR_NOT_SUPPORTED_APP_STATE_FOR_SCREEN_SHARE:return"The application state isn't supported for screen share.";case De.ERR_PERMISSION_DENIED_FOR_SCREEN_SHARE:return"An access permission denied for screen share.";case De.ERR_SELECTED_CONTENT_NOT_EXIST:return"The selected content for screen share doesn't exist.";case De.ERR_SELECTED_CONTENT_INACCESSIBLE:return"The selected content for screen share is inaccessible by the system.";case De.ERR_PARTICIPANT_ALREADY_IN_ROOM:return"The participant is trying to enter the same room they're already in.";case De.ERR_ENTERING_ROOM_STILL_IN_PROGRESS:return"The participant is trying to enter the room while the previous request is still in progress.";case De.ERR_PARTICIPANT_NOT_IN_ROOM:return"The participant is not in the room and the request can't be processed.";case De.ERR_EXITING_ROOM_STILL_IN_PROGRESS:return"The participant is trying to exit the same room.";case De.ERR_FAILED_TO_ESTABLISH_CONNECTION_TO_SEND_STREAM:return"Couldn't establish a connection to send media streaming.";case De.ERR_FAILED_TO_ESTABLISH_CONNECTION_TO_RECEIVE_STREAM:return"Couldn't establish a connection to receive media streaming.";case De.ERR_LOCAL_PARTICIPANT_LOST_CONNECTION:return"The local participant exited the room due to lost connection.";case De.ERR_LOCAL_PARTICIPANT_KICKED_OUT:return"An existing participant has been disconnected from the room because a new participant entered with the same user ID.";case De.ERR_CALL_ALREADY_ON_HOLD:return"The call is already on hold.";case De.ERR_ACTIVE_CALL_IN_PROGRESS:return"The active call is in progress. Cannot remove the active call from a hold because the call is not on hold.";case De.ERR_ANOTHER_CALL_IN_PROGRESS:return"The active call is in progress. Cannot remove a hold from another call while there is an active call.";default:return""}}}]),o}(),bd=function(o,c,l){var f=k(c);f in o?Z.f(o,f,g(0,l)):o[f]=l},Pc=Pe("navigator","userAgent")||"",D0=a.process,L0=D0&&D0.versions,x0=L0&&L0.v8;x0?ep=(yd=x0.split("."))[0]+yd[1]:Pc&&(!(yd=Pc.match(/Edge\/(\d+)/))||yd[1]>=74)&&(yd=Pc.match(/Chrome\/(\d+)/))&&(ep=yd[1]);var Cd=ep&&+ep,XD=pn("species"),Fc=function(o){return Cd>=51||!s(function(){var c=[];return(c.constructor={})[XD]=function(){return{foo:1}},c[o](Boolean).foo!==1})},U0=pn("isConcatSpreadable"),P0=9007199254740991,F0="Maximum allowed index exceeded",JD=Cd>=51||!s(function(){var o=[];return o[U0]=!1,o.concat()[0]!==o}),eL=Fc("concat"),nL=function(o){if(!N(o))return!1;var c=o[U0];return c!==void 0?!!c:qt(o)};Fn({target:"Array",proto:!0,forced:!JD||!eL},{concat:function(o){var c,l,f,_,m,v=zn(this),I=yt(v,0),S=0;for(c=-1,f=arguments.length;c<f;c++)if(nL(m=c===-1?v:arguments[c])){if(S+(_=Cn(m.length))>P0)throw TypeError(F0);for(l=0;l<_;l++,S++)l in m&&bd(I,S,m[l])}else{if(S>=P0)throw TypeError(F0);bd(I,S++,m)}return I.length=S,I}});var tL=Je.map,rL=Fc("map"),iL=dt("map");Fn({target:"Array",proto:!0,forced:!rL||!iL},{map:function(o){return tL(this,o,arguments.length>1?arguments[1]:void 0)}});var H0=function(){var o=Q(this),c="";return o.global&&(c+="g"),o.ignoreCase&&(c+="i"),o.multiline&&(c+="m"),o.dotAll&&(c+="s"),o.unicode&&(c+="u"),o.sticky&&(c+="y"),c},sg="toString",B0=RegExp.prototype,G0=B0[sg],aL=s(function(){return G0.call({source:"a",flags:"b"})!="/a/b"}),sL=G0.name!=sg;(aL||sL)&&wn(RegExp.prototype,sg,function(){var o=Q(this),c=String(o.source),l=o.flags;return"/"+c+"/"+String(l===void 0&&o instanceof RegExp&&!("flags"in B0)?H0.call(o):l)},{unsafe:!0});var ki,np="".repeat||function(o){var c=String(A(this)),l="",f=tn(o);if(f<0||f==1/0)throw RangeError("Wrong number of repetitions");for(;f>0;(f>>>=1)&&(c+=c))1&f&&(l+=c);return l},uL=Math.ceil,V0=function(o){return function(c,l,f){var _,m,v=String(A(c)),I=v.length,S=f===void 0?" ":String(f),w=Cn(l);return w<=I||S==""?v:(_=w-I,(m=np.call(S,uL(_/S.length))).length>_&&(m=m.slice(0,_)),o?v+m:m+v)}},oL={start:V0(!1),end:V0(!0)},lL=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(Pc),dL=oL.start;Fn({target:"String",proto:!0,forced:lL},{padStart:function(o){return dL(this,o,arguments.length>1?arguments[1]:void 0)}}),function(o){o.VERBOSE="VERBOSE",o.DEBUG="DEBUG",o.INFO="INFO",o.WARNING="WARNING",o.ERROR="ERROR",o.NONE="NONE"}(ki||(ki={}));var Hc={VERBOSE:{level:-1,name:ki.VERBOSE,public:!1},DEBUG:{level:1,name:ki.DEBUG,public:!1},INFO:{level:2,name:ki.INFO,public:!0},WARNING:{level:3,name:ki.WARNING,public:!0},ERROR:{level:4,name:ki.ERROR,public:!0},NONE:{level:100,name:ki.NONE,public:!0}},cL=Je.some,fL=oe("some"),hL=dt("some");Fn({target:"Array",proto:!0,forced:!fL||!hL},{some:function(o){return cL(this,o,arguments.length>1?arguments[1]:void 0)}});var pL=s(function(){ot(1)});Fn({target:"Object",stat:!0,forced:pL},{keys:function(o){return ot(zn(o))}});var Id,j0,ug,tp=a.Promise,_L=pn("species"),q0=function(o,c){var l,f=Q(o).constructor;return f===void 0||(l=Q(f)[_L])==null?c:At(l)},z0=/(iphone|ipod|ipad).*applewebkit/i.test(Pc),xs=y(a.process)=="process",rp=a.location,og=a.setImmediate,lg=a.clearImmediate,mL=a.process,K0=a.MessageChannel,dg=a.Dispatch,cg=0,Bc={},W0="onreadystatechange",fg=function(o){if(Bc.hasOwnProperty(o)){var c=Bc[o];delete Bc[o],c()}},hg=function(o){return function(){fg(o)}},$0=function(o){fg(o.data)},Y0=function(o){a.postMessage(o+"",rp.protocol+"//"+rp.host)};og&&lg||(og=function(o){for(var c=[],l=1;arguments.length>l;)c.push(arguments[l++]);return Bc[++cg]=function(){(typeof o=="function"?o:Function(o)).apply(void 0,c)},Id(cg),cg},lg=function(o){delete Bc[o]},xs?Id=function(o){mL.nextTick(hg(o))}:dg&&dg.now?Id=function(o){dg.now(hg(o))}:K0&&!z0?(ug=(j0=new K0).port2,j0.port1.onmessage=$0,Id=Pt(ug.postMessage,ug,1)):a.addEventListener&&typeof postMessage=="function"&&!a.importScripts&&rp&&rp.protocol!=="file:"&&!s(Y0)?(Id=Y0,a.addEventListener("message",$0,!1)):Id=W0 in B("script")?function(o){ht.appendChild(B("script"))[W0]=function(){ht.removeChild(this),fg(o)}}:function(o){setTimeout(hg(o),0)});var Gc,Qo,Vc,jc,pg,_g,mg,Q0,Z0={set:og,clear:lg},gL=Y.f,vL=Z0.set,X0=a.MutationObserver||a.WebKitMutationObserver,J0=a.document,eI=a.process,gg=a.Promise,nI=gL(a,"queueMicrotask"),tI=nI&&nI.value;tI||(Gc=function(){var o,c;for(xs&&(o=eI.domain)&&o.exit();Qo;){c=Qo.fn,Qo=Qo.next;try{c()}catch(l){throw Qo?jc():Vc=void 0,l}}Vc=void 0,o&&o.enter()},!z0&&!xs&&X0&&J0?(pg=!0,_g=J0.createTextNode(""),new X0(Gc).observe(_g,{characterData:!0}),jc=function(){_g.data=pg=!pg}):gg&&gg.resolve?(mg=gg.resolve(void 0),Q0=mg.then,jc=function(){Q0.call(mg,Gc)}):jc=xs?function(){eI.nextTick(Gc)}:function(){vL.call(a,Gc)});var vg,rI,iI,aI,sI=tI||function(o){var c={fn:o,next:void 0};Vc&&(Vc.next=c),Qo||(Qo=c,jc()),Vc=c},EL=function(o){var c,l;this.promise=new o(function(f,_){if(c!==void 0||l!==void 0)throw TypeError("Bad Promise constructor");c=f,l=_}),this.resolve=At(c),this.reject=At(l)},Eg={f:function(o){return new EL(o)}},uI=function(o,c){if(Q(o),N(c)&&c.constructor===o)return c;var l=Eg.f(o);return(0,l.resolve)(c),l.promise},yg=function(o){try{return{error:!1,value:o()}}catch(c){return{error:!0,value:c}}},oI=Z0.set,yL=pn("species"),Us="Promise",lI=An.get,bL=An.set,CL=An.getterFor(Us),va=tp,dI=a.TypeError,bg=a.document,Cg=a.process,cI=Pe("fetch"),Td=Eg.f,IL=Td,TL=!!(bg&&bg.createEvent&&a.dispatchEvent),fI=typeof PromiseRejectionEvent=="function",hI="unhandledrejection",qc=lt(Us,function(){if(be(va)===String(va)&&(Cd===66||!xs&&!fI))return!0;if(Cd>=51&&/native code/.test(va))return!1;var o=va.resolve(1),c=function(l){l(function(){},function(){})};return(o.constructor={})[yL]=c,!(o.then(function(){})instanceof c)}),SL=qc||!Qm(function(o){va.all(o).catch(function(){})}),pI=function(o){var c;return!(!N(o)||typeof(c=o.then)!="function")&&c},Ig=function(o,c){if(!o.notified){o.notified=!0;var l=o.reactions;sI(function(){for(var f=o.value,_=o.state==1,m=0;l.length>m;){var v,I,S,w=l[m++],G=_?w.ok:w.fail,H=w.resolve,x=w.reject,V=w.domain;try{G?(_||(o.rejection===2&&AL(o),o.rejection=1),G===!0?v=f:(V&&V.enter(),v=G(f),V&&(V.exit(),S=!0)),v===w.promise?x(dI("Promise-chain cycle")):(I=pI(v))?I.call(v,H,x):H(v)):x(f)}catch(K){V&&!S&&V.exit(),x(K)}}o.reactions=[],o.notified=!1,c&&!o.rejection&&NL(o)})}},_I=function(o,c,l){var f,_;TL?((f=bg.createEvent("Event")).promise=c,f.reason=l,f.initEvent(o,!1,!0),a.dispatchEvent(f)):f={promise:c,reason:l},!fI&&(_=a["on"+o])?_(f):o===hI&&function(m,v){var I=a.console;I&&I.error&&(arguments.length===1?I.error(m):I.error(m,v))}("Unhandled promise rejection",l)},NL=function(o){oI.call(a,function(){var c,l=o.facade,f=o.value;if(mI(o)&&(c=yg(function(){xs?Cg.emit("unhandledRejection",f,l):_I(hI,l,f)}),o.rejection=xs||mI(o)?2:1,c.error))throw c.value})},mI=function(o){return o.rejection!==1&&!o.parent},AL=function(o){oI.call(a,function(){var c=o.facade;xs?Cg.emit("rejectionHandled",c):_I("rejectionhandled",c,o.value)})},Sd=function(o,c,l){return function(f){o(c,f,l)}},Nd=function(o,c,l){o.done||(o.done=!0,l&&(o=l),o.value=c,o.state=2,Ig(o,!0))},Tg=function(o,c,l){if(!o.done){o.done=!0,l&&(o=l);try{if(o.facade===c)throw dI("Promise can't be resolved itself");var f=pI(c);f?sI(function(){var _={done:!1};try{f.call(c,Sd(Tg,_,o),Sd(Nd,_,o))}catch(m){Nd(_,m,o)}}):(o.value=c,o.state=1,Ig(o,!1))}catch(_){Nd({done:!1},_,o)}}};function gI(o,c){return RegExp(o,c)}qc&&(va=function(o){Lc(this,va,Us),At(o),vg.call(this);var c=lI(this);try{o(Sd(Tg,c),Sd(Nd,c))}catch(l){Nd(c,l)}},(vg=function(o){bL(this,{type:Us,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Qh(va.prototype,{then:function(o,c){var l=CL(this),f=Td(q0(this,va));return f.ok=typeof o!="function"||o,f.fail=typeof c=="function"&&c,f.domain=xs?Cg.domain:void 0,l.parent=!0,l.reactions.push(f),l.state!=0&&Ig(l,!1),f.promise},catch:function(o){return this.then(void 0,o)}}),rI=function(){var o=new vg,c=lI(o);this.promise=o,this.resolve=Sd(Tg,c),this.reject=Sd(Nd,c)},Eg.f=Td=function(o){return o===va||o===iI?new rI(o):IL(o)},typeof tp=="function"&&(aI=tp.prototype.then,wn(tp.prototype,"then",function(o,c){var l=this;return new va(function(f,_){aI.call(l,f,_)}).then(o,c)},{unsafe:!0}),typeof cI=="function"&&Fn({global:!0,enumerable:!0,forced:!0},{fetch:function(o){return uI(va,cI.apply(a,arguments))}}))),Fn({global:!0,wrap:!0,forced:qc},{Promise:va}),gu(va,Us,!1),h0(Us),iI=Pe(Us),Fn({target:Us,stat:!0,forced:qc},{reject:function(o){var c=Td(this);return c.reject.call(void 0,o),c.promise}}),Fn({target:Us,stat:!0,forced:qc},{resolve:function(o){return uI(this,o)}}),Fn({target:Us,stat:!0,forced:SL},{all:function(o){var c=this,l=Td(c),f=l.resolve,_=l.reject,m=yg(function(){var v=At(c.resolve),I=[],S=0,w=1;Yh(o,function(G){var H=S++,x=!1;I.push(void 0),w++,v.call(c,G).then(function(V){x||(x=!0,I[H]=V,--w||f(I))},_)}),--w||f(I)});return m.error&&_(m.value),l.promise},race:function(o){var c=this,l=Td(c),f=l.reject,_=yg(function(){var m=At(c.resolve);Yh(o,function(v){m.call(c,v).then(l.resolve,f)})});return _.error&&f(_.value),l.promise}});var Sg,Ng,vI={UNSUPPORTED_Y:s(function(){var o=gI("a","y");return o.lastIndex=2,o.exec("abcd")!=null}),BROKEN_CARET:s(function(){var o=gI("^r","gy");return o.lastIndex=2,o.exec("str")!=null})},ip=RegExp.prototype.exec,wL=String.prototype.replace,EI=ip,Ag=(Sg=/a/,Ng=/b*/g,ip.call(Sg,"a"),ip.call(Ng,"a"),Sg.lastIndex!==0||Ng.lastIndex!==0),yI=vI.UNSUPPORTED_Y||vI.BROKEN_CARET,wg=/()??/.exec("")[1]!==void 0;(Ag||wg||yI)&&(EI=function(o){var c,l,f,_,m=this,v=yI&&m.sticky,I=H0.call(m),S=m.source,w=0,G=o;return v&&((I=I.replace("y","")).indexOf("g")===-1&&(I+="g"),G=String(o).slice(m.lastIndex),m.lastIndex>0&&(!m.multiline||m.multiline&&o[m.lastIndex-1]!==`
`)&&(S="(?: "+S+")",G=" "+G,w++),l=new RegExp("^(?:"+S+")",I)),wg&&(l=new RegExp("^"+S+"$(?!\\s)",I)),Ag&&(c=m.lastIndex),f=ip.call(v?l:m,G),v?f?(f.input=f.input.slice(w),f[0]=f[0].slice(w),f.index=m.lastIndex,m.lastIndex+=f[0].length):m.lastIndex=0:Ag&&f&&(m.lastIndex=m.global?f.index+f[0].length:c),wg&&f&&f.length>1&&wL.call(f[0],l,function(){for(_=1;_<arguments.length-2;_++)arguments[_]===void 0&&(f[_]=void 0)}),f});var zc=EI;Fn({target:"RegExp",proto:!0,forced:/./.exec!==zc},{exec:zc});var RL=pn("species"),ML=!s(function(){var o=/./;return o.exec=function(){var c=[];return c.groups={a:"7"},c},"".replace(o,"$<a>")!=="7"}),bI="a".replace(/./,"$0")==="$0",CI=pn("replace"),II=!!/./[CI]&&/./[CI]("a","$0")==="",OL=!s(function(){var o=/(?:)/,c=o.exec;o.exec=function(){return c.apply(this,arguments)};var l="ab".split(o);return l.length!==2||l[0]!=="a"||l[1]!=="b"}),Rg=function(o,c,l,f){var _=pn(o),m=!s(function(){var H={};return H[_]=function(){return 7},""[o](H)!=7}),v=m&&!s(function(){var H=!1,x=/a/;return o==="split"&&((x={}).constructor={},x.constructor[RL]=function(){return x},x.flags="",x[_]=/./[_]),x.exec=function(){return H=!0,null},x[_](""),!H});if(!m||!v||o==="replace"&&(!ML||!bI||II)||o==="split"&&!OL){var I=/./[_],S=l(_,""[o],function(H,x,V,K,te){return x.exec===zc?m&&!te?{done:!0,value:I.call(x,V,K)}:{done:!0,value:H.call(V,x,K)}:{done:!1}},{REPLACE_KEEPS_$0:bI,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:II}),w=S[0],G=S[1];wn(String.prototype,o,w),wn(RegExp.prototype,_,c==2?function(H,x){return G.call(H,this,x)}:function(H){return G.call(H,this)})}f&&ne(RegExp.prototype[_],"sham",!0)},kL=Xm.charAt,Mg=function(o,c,l){return c+(l?kL(o,c).length:1)},Kc=function(o,c){var l=o.exec;if(typeof l=="function"){var f=l.call(o,c);if(typeof f!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return f}if(y(o)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return zc.call(o,c)};Rg("match",1,function(o,c,l){return[function(f){var _=A(this),m=f==null?void 0:f[o];return m!==void 0?m.call(f,_):new RegExp(f)[o](String(_))},function(f){var _=l(c,f,this);if(_.done)return _.value;var m=Q(f),v=String(this);if(!m.global)return Kc(m,v);var I=m.unicode;m.lastIndex=0;for(var S,w=[],G=0;(S=Kc(m,v))!==null;){var H=String(S[0]);w[G]=H,H===""&&(m.lastIndex=Mg(v,Cn(m.lastIndex),I)),G++}return G===0?null:w}]});var DL=Math.max,LL=Math.min,xL=Math.floor,UL=/\$([$&'`]|\d\d?|<[^>]*>)/g,PL=/\$([$&'`]|\d\d?)/g;Rg("replace",2,function(o,c,l,f){var _=f.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,m=f.REPLACE_KEEPS_$0,v=_?"$":"$0";return[function(S,w){var G=A(this),H=S==null?void 0:S[o];return H!==void 0?H.call(S,G,w):c.call(String(G),S,w)},function(S,w){if(!_&&m||typeof w=="string"&&w.indexOf(v)===-1){var G=l(c,S,this,w);if(G.done)return G.value}var H=Q(S),x=String(this),V=typeof w=="function";V||(w=String(w));var K=H.global;if(K){var te=H.unicode;H.lastIndex=0}for(var me=[];;){var _e=Kc(H,x);if(_e===null||(me.push(_e),!K))break;String(_e[0])===""&&(H.lastIndex=Mg(x,Cn(H.lastIndex),te))}for(var ye,Xe="",on=0,Mn=0;Mn<me.length;Mn++){_e=me[Mn];for(var Zn=String(_e[0]),Xn=DL(LL(tn(_e.index),x.length),0),Nt=[],kt=1;kt<_e.length;kt++)Nt.push((ye=_e[kt])===void 0?ye:String(ye));var et=_e.groups;if(V){var ir=[Zn].concat(Nt,Xn,x);et!==void 0&&ir.push(et);var ss=String(w.apply(void 0,ir))}else ss=I(Zn,x,Xn,Nt,et,w);Xn>=on&&(Xe+=x.slice(on,Xn)+ss,on=Xn+Zn.length)}return Xe+x.slice(on)}];function I(S,w,G,H,x,V){var K=G+S.length,te=H.length,me=PL;return x!==void 0&&(x=zn(x),me=UL),c.call(V,me,function(_e,ye){var Xe;switch(ye.charAt(0)){case"$":return"$";case"&":return S;case"`":return w.slice(0,G);case"'":return w.slice(K);case"<":Xe=x[ye.slice(1,-1)];break;default:var on=+ye;if(on===0)return _e;if(on>te){var Mn=xL(on/10);return Mn===0?_e:Mn<=te?H[Mn-1]===void 0?ye.charAt(1):H[Mn-1]+ye.charAt(1):_e}Xe=H[on-1]}return Xe===void 0?"":Xe})}});var ap=function(o){ce(l,o);var c=fe(l);function l(f){var _,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=m.message,I=m.error,S=ig(m,["message","error"]);ie(this,l);var w=v||Yu.getErrorMessage(f,S);return(_=c.call(this,w)).code=f,_._error=I,_}return l}(rg(Error)),Jt=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return l}(ap);function wa(o){return function(c){o.then(function(l){return c(l)},function(l){return c(null,l)})}}var Ps,Wc,Og=function(o,c){if(Object.keys(o).some(function(f){return typeof o[f]!="string"})){var l=Promise.reject(new Jt(De.INVALID_PARAMETER_TYPE));return c&&wa(l)(c),[!1,l]}return[!0]},kg=function(o,c){if(o.some(function(f){return typeof f!="string"})){var l=Promise.reject(new Jt(De.INVALID_PARAMETER_TYPE));return c&&wa(l)(c),[!1,l]}return[!0]},sp=function(o,c,l){var f=o.match(c);return f&&f.length>=l&&parseInt(f[l],10)},Dg=function(){var o={browser:null,version:null};if(typeof window>"u"||!window.navigator)return o.browser="Not a browser.",o;var c=window.navigator;if(c.mozGetUserMedia)o.browser="firefox",o.version=sp(c.userAgent,/Firefox\/(\d+)\./,1);else if(c.webkitGetUserMedia||window.isSecureContext===!1&&window.webkitRTCPeerConnection&&!window.RTCIceGatherer)o.browser="chrome",o.version=sp(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(c.mediaDevices&&c.userAgent.match(/Edge\/(\d+).(\d+)$/))o.browser="edge",o.version=sp(c.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!window.RTCPeerConnection||!c.userAgent.match(/AppleWebKit\/(\d+)\./))return o.browser="Not a supported browser.",o;o.browser="safari",o.version=sp(c.userAgent,/AppleWebKit\/(\d+)\./,1),o.supportsUnifiedPlan=window.RTCRtpTransceiver&&"currentDirection"in window.RTCRtpTransceiver.prototype}return o},up=Dg().browser==="safari",FL=Dg().browser==="firefox",HL=function(o){return o.replace(/"access_token":".*?"/gm,'"access_token":"*************"').replace(/"password":".*?"/gm,'"password":"*************"').replace(/"sbcall_session_token":".*?"/gm,'"sbcall_session_token":"*************"').replace(/"turn_urls":\[".*?"\]/gm,'"turn_urls":"[*************]"').replace(/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/gm,"*************").replace(/((?:[0-9A-Fa-f]{1,4}))((?::[0-9A-Fa-f]{1,4}))*::((?:[0-9A-Fa-f]{1,4}))((?::[0-9A-Fa-f]{1,4}))*|((?:[0-9A-Fa-f]{1,4}))((?::[0-9A-Fa-f]{1,4})){7}/gm,"*************")},Ea=function(o){return{userId:o.user_id,nickname:o.nickname,profileUrl:o.profile_url,metaData:o.metadata,isActive:o.is_active}},BL=function(){function o(){ie(this,o),this.level=ki.NONE}return se(o,[{key:"setLoggerLevel",value:function(c){var l;return(l=Hc[c])!==null&&l!==void 0&&l.public&&(this.level=c),this.level}},{key:"verbose",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];this._permit.apply(this,[ki.VERBOSE].concat(l))}},{key:"debug",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];this._permit.apply(this,[ki.DEBUG].concat(l))}},{key:"info",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];this._permit.apply(this,[ki.INFO].concat(l))}},{key:"warning",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];this._permit.apply(this,[ki.WARNING].concat(l))}},{key:"error",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];this._permit.apply(this,[ki.ERROR].concat(l))}},{key:"_enabledFor",value:function(c){try{return Hc[this.level].level<=Hc[c].level}catch{return!1}}},{key:"_getLogType",value:function(c){switch(c){case ki.ERROR:return"error";case ki.WARNING:return"warn";default:return"log"}}},{key:"_getTimeString",value:function(c){var l=c.getFullYear().toString().padStart(2,"0"),f=(c.getMonth()+1).toString().padStart(2,"0"),_=c.getDate().toString().padStart(2,"0"),m=c.getHours().toString().padStart(2,"0"),v=c.getMinutes().toString().padStart(2,"0"),I=c.getSeconds().toString().padStart(2,"0"),S=c.getMilliseconds().toString().padStart(2,"0");return"[".concat(l,".").concat(f,".").concat(_," ").concat(m,":").concat(v,":").concat(I,":").concat(S,"]")}},{key:"_permit",value:function(c){for(var l=this._getLogType(c),f=new Date,_=arguments.length,m=new Array(_>1?_-1:0),v=1;v<_;v++)m[v-1]=arguments[v];if(this._enabledFor(c)&&console&&console[l]){var I,S="".concat(this._getTimeString(f)," [").concat(c,"]");(I=console)[l].apply(I,[S].concat(m))}if(this._logCollector){var w={logDt:f.getTime(),logLevel:c,logMessage:this._makeSDKLogMessage.apply(this,m)};this._logCollector.addLog(w)}}},{key:"_makeSDKLogMessage",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];var _=l.map(function(m){return JSON.stringify(m)});return HL(_.toString())}},{key:"logCollector",set:function(c){this._logCollector=c}}]),o}(),ae=new BL,GL=function(){if(!navigator.mediaDevices.getDisplayMedia){var o=Yu.getErrorMessage(De.ERR_NOT_SUPPORTED_BROWSER_FOR_SCREEN_SHARE);throw ae.error(o),o}},Ja=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return l}(ap),Lg=function(){function o(c){ie(this,o);var l=Fr(Fr({},o.default),c);this.localMediaView=l.localMediaView,this.remoteMediaView=l.remoteMediaView,this.videoEnabled=l.videoEnabled,this.audioEnabled=l.audioEnabled,this.videoWidth=l.videoWidth,this.videoHeight=l.videoHeight,this.videoFps=l.videoFps,this.frontCamera=l.frontCamera}return se(o,null,[{key:"default",get:function(){return{localMediaView:null,remoteMediaView:null,audioEnabled:!0,videoEnabled:!0,videoWidth:null,videoHeight:null,videoFps:null,frontCamera:!0}}}]),o}(),Ad=Object.assign,TI=Object.defineProperty,$c=!Ad||s(function(){if(u&&Ad({b:1},Ad(TI({},"a",{enumerable:!0,get:function(){TI(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var o={},c={},l=Symbol(),f="abcdefghijklmnopqrst";return o[l]=7,f.split("").forEach(function(_){c[_]=_}),Ad({},o)[l]!=7||ot(Ad({},c)).join("")!=f})?function(o,c){for(var l=zn(o),f=arguments.length,_=1,m=Ot.f,v=p.f;f>_;)for(var I,S=T(arguments[_++]),w=m?ot(S).concat(m(S)):ot(S),G=w.length,H=0;G>H;)I=w[H++],u&&!v.call(S,I)||(l[I]=S[I]);return l}:Ad;Fn({target:"Object",stat:!0,forced:Object.assign!==$c},{assign:$c}),function(o){o.UNAVAILABLE="unavailable",o.POOR="poor",o.FAIR="fair",o.AVERAGE="average",o.GOOD="good",o.EXCELLENT="excellent"}(Ps||(Ps={})),function(o){o.FREQUENCY="frequency",o.CONNECTION_QUALITY_CHANGE="connectionQualityChange"}(Wc||(Wc={}));var fr,Eu,SI=function(){function o(c){ie(this,o),Object.assign(this,c)}return se(o,[{key:"connectionQuality",get:function(){var c=this.mos;return c?0<=c&&c<2?Ps.POOR:2<=c&&c<3?Ps.FAIR:3<=c&&c<3.6?Ps.AVERAGE:3.6<=c&&c<4.2?Ps.GOOD:c>=4.2?Ps.EXCELLENT:Ps.UNAVAILABLE:Ps.UNAVAILABLE}}]),o}();(function(o){o.NO_ANSWER="no_answer",o.CANCELED="canceled",o.DECLINED="declined",o.OTHER_DEVICE_ACCEPTED="other_device_accepted",o.COMPLETED="completed",o.CONNECTION_LOST="connection_lost",o.TIMED_OUT="timed_out",o.DIAL_FAILED="dial_failed",o.ACCEPT_FAILED="accept_failed",o.NOT_CONNECTED="not_connected",o.UNKNOWN="unknown"})(fr||(fr={})),function(o){o.CALLER="dc_caller",o.CALLEE="dc_callee"}(Eu||(Eu={}));var VL=Math.min,xg=[].lastIndexOf,NI=!!xg&&1/[1].lastIndexOf(1,-0)<0,jL=oe("lastIndexOf"),qL=dt("indexOf",{ACCESSORS:!0,1:0}),AI=NI||!jL||!qL?function(o){if(NI)return xg.apply(this,arguments)||0;var c=O(this),l=Cn(c.length),f=l-1;for(arguments.length>1&&(f=VL(f,tn(arguments[1]))),f<0&&(f=l+f);f>=0;f--)if(f in c&&c[f]===o)return f||0;return-1}:xg;Fn({target:"Array",proto:!0,forced:AI!==[].lastIndexOf},{lastIndexOf:AI});var Di,zL=pn("match"),wI=function(o){var c;return N(o)&&((c=o[zL])!==void 0?!!c:y(o)=="RegExp")},KL=[].push,WL=Math.min,Ug=4294967295,wd=!s(function(){return!RegExp(Ug,"y")});Rg("split",2,function(o,c,l){var f;return f="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?function(_,m){var v=String(A(this)),I=m===void 0?Ug:m>>>0;if(I===0)return[];if(_===void 0)return[v];if(!wI(_))return c.call(v,_,I);for(var S,w,G,H=[],x=(_.ignoreCase?"i":"")+(_.multiline?"m":"")+(_.unicode?"u":"")+(_.sticky?"y":""),V=0,K=new RegExp(_.source,x+"g");(S=zc.call(K,v))&&!((w=K.lastIndex)>V&&(H.push(v.slice(V,S.index)),S.length>1&&S.index<v.length&&KL.apply(H,S.slice(1)),G=S[0].length,V=w,H.length>=I));)K.lastIndex===S.index&&K.lastIndex++;return V===v.length?!G&&K.test("")||H.push(""):H.push(v.slice(V)),H.length>I?H.slice(0,I):H}:"0".split(void 0,0).length?function(_,m){return _===void 0&&m===0?[]:c.call(this,_,m)}:c,[function(_,m){var v=A(this),I=_==null?void 0:_[o];return I!==void 0?I.call(_,v,m):f.call(String(v),_,m)},function(_,m){var v=l(f,_,this,m,f!==c);if(v.done)return v.value;var I=Q(_),S=String(this),w=q0(I,RegExp),G=I.unicode,H=(I.ignoreCase?"i":"")+(I.multiline?"m":"")+(I.unicode?"u":"")+(wd?"y":"g"),x=new w(wd?I:"^(?:"+I.source+")",H),V=m===void 0?Ug:m>>>0;if(V===0)return[];if(S.length===0)return Kc(x,S)===null?[S]:[];for(var K=0,te=0,me=[];te<S.length;){x.lastIndex=wd?te:0;var _e,ye=Kc(x,wd?S:S.slice(te));if(ye===null||(_e=WL(Cn(x.lastIndex+(wd?0:te)),S.length))===K)te=Mg(S,te,G);else{if(me.push(S.slice(K,te)),me.length===V)return me;for(var Xe=1;Xe<=ye.length-1;Xe++)if(me.push(ye[Xe]),me.length===V)return me;te=K=_e}}return me.push(S.slice(K)),me}]},!wd),function(o){o.REMOTE_AUDIO_AND_VIDEO="remote_audio_and_video",o.REMOTE_AUDIO_ONLY="remote_audio_only",o.LOCAL_REMOTE_AUDIOS="local_remote_audios",o.LOCAL_AUDIO_REMOTE_AUDIO_AND_VIDEO="local_audio_remote_audio_and_video",o.LOCAL_AUDIO_AND_VIDEO_REMOTE_AUDIO="local_audio_and_video_remote_audio"}(Di||(Di={}));var RI=function(){function o(c){if(ie(this,o),this.recordingType=c.recordingType,this.callId=c.callId,c.fileName){var l=up?"mp4":"webm";c.fileName.toLocaleLowerCase().split(".").reverse()[0]!==l?this.fileName="".concat(c.fileName,".").concat(l):this.fileName=c.fileName}else this.fileName=o.defaultFileName(this.recordingType,this.callId)}return se(o,[{key:"isVideo",get:function(){return this.recordingType===Di.LOCAL_AUDIO_AND_VIDEO_REMOTE_AUDIO||this.recordingType===Di.LOCAL_AUDIO_REMOTE_AUDIO_AND_VIDEO||this.recordingType===Di.REMOTE_AUDIO_AND_VIDEO}}],[{key:"defaultFileName",value:function(c,l){var f=new Date(Date.now()-6e4*new Date().getTimezoneOffset()).toISOString(),_=(f=f.replace(/-|:/g,"")).lastIndexOf(".");return"".concat(c,"_").concat(l,"_").concat(f.substring(0,_)).concat(up?".mp4":".webm")}}]),o}(),$L=(r(function(o){var c=function(l){var f,_=Object.prototype,m=_.hasOwnProperty,v=Object.defineProperty||function(vn,dn,Un){vn[dn]=Un.value},I=typeof Symbol=="function"?Symbol:{},S=I.iterator||"@@iterator",w=I.asyncIterator||"@@asyncIterator",G=I.toStringTag||"@@toStringTag";function H(vn,dn,Un){return Object.defineProperty(vn,dn,{value:Un,enumerable:!0,configurable:!0,writable:!0}),vn[dn]}try{H({},"")}catch{H=function(dn,Un,Xt){return dn[Un]=Xt}}function x(vn,dn,Un,Xt){var gt=dn&&dn.prototype instanceof Xe?dn:Xe,Mr=Object.create(gt.prototype),gi=new fo(Xt||[]);return v(Mr,"_invoke",{value:ss(vn,Un,gi)}),Mr}function V(vn,dn,Un){try{return{type:"normal",arg:vn.call(dn,Un)}}catch(Xt){return{type:"throw",arg:Xt}}}l.wrap=x;var K="suspendedStart",te="suspendedYield",me="executing",_e="completed",ye={};function Xe(){}function on(){}function Mn(){}var Zn={};H(Zn,S,function(){return this});var Xn=Object.getPrototypeOf,Nt=Xn&&Xn(Xn(Wd([])));Nt&&Nt!==_&&m.call(Nt,S)&&(Zn=Nt);var kt=Mn.prototype=Xe.prototype=Object.create(Zn);function et(vn){["next","throw","return"].forEach(function(dn){H(vn,dn,function(Un){return this._invoke(dn,Un)})})}function ir(vn,dn){function Un(gt,Mr,gi,Oa){var ka=V(vn[gt],vn,Mr);if(ka.type!=="throw"){var $d=ka.arg,If=$d.value;return If&&typeof If=="object"&&m.call(If,"__await")?dn.resolve(If.__await).then(function(bl){Un("next",bl,gi,Oa)},function(bl){Un("throw",bl,gi,Oa)}):dn.resolve(If).then(function(bl){$d.value=bl,gi($d)},function(bl){return Un("throw",bl,gi,Oa)})}Oa(ka.arg)}var Xt;v(this,"_invoke",{value:function(gt,Mr){function gi(){return new dn(function(Oa,ka){Un(gt,Mr,Oa,ka)})}return Xt=Xt?Xt.then(gi,gi):gi()}})}function ss(vn,dn,Un){var Xt=K;return function(gt,Mr){if(Xt===me)throw new Error("Generator is already running");if(Xt===_e){if(gt==="throw")throw Mr;return wN()}for(Un.method=gt,Un.arg=Mr;;){var gi=Un.delegate;if(gi){var Oa=Cf(gi,Un);if(Oa){if(Oa===ye)continue;return Oa}}if(Un.method==="next")Un.sent=Un._sent=Un.arg;else if(Un.method==="throw"){if(Xt===K)throw Xt=_e,Un.arg;Un.dispatchException(Un.arg)}else Un.method==="return"&&Un.abrupt("return",Un.arg);Xt=me;var ka=V(vn,dn,Un);if(ka.type==="normal"){if(Xt=Un.done?_e:te,ka.arg===ye)continue;return{value:ka.arg,done:Un.done}}ka.type==="throw"&&(Xt=_e,Un.method="throw",Un.arg=ka.arg)}}}function Cf(vn,dn){var Un=dn.method,Xt=vn.iterator[Un];if(Xt===f)return dn.delegate=null,Un==="throw"&&vn.iterator.return&&(dn.method="return",dn.arg=f,Cf(vn,dn),dn.method==="throw")||Un!=="return"&&(dn.method="throw",dn.arg=new TypeError("The iterator does not provide a '"+Un+"' method")),ye;var gt=V(Xt,vn.iterator,dn.arg);if(gt.type==="throw")return dn.method="throw",dn.arg=gt.arg,dn.delegate=null,ye;var Mr=gt.arg;return Mr?Mr.done?(dn[vn.resultName]=Mr.value,dn.next=vn.nextLoc,dn.method!=="return"&&(dn.method="next",dn.arg=f),dn.delegate=null,ye):Mr:(dn.method="throw",dn.arg=new TypeError("iterator result is not an object"),dn.delegate=null,ye)}function qs(vn){var dn={tryLoc:vn[0]};1 in vn&&(dn.catchLoc=vn[1]),2 in vn&&(dn.finallyLoc=vn[2],dn.afterLoc=vn[3]),this.tryEntries.push(dn)}function co(vn){var dn=vn.completion||{};dn.type="normal",delete dn.arg,vn.completion=dn}function fo(vn){this.tryEntries=[{tryLoc:"root"}],vn.forEach(qs,this),this.reset(!0)}function Wd(vn){if(vn){var dn=vn[S];if(dn)return dn.call(vn);if(typeof vn.next=="function")return vn;if(!isNaN(vn.length)){var Un=-1,Xt=function gt(){for(;++Un<vn.length;)if(m.call(vn,Un))return gt.value=vn[Un],gt.done=!1,gt;return gt.value=f,gt.done=!0,gt};return Xt.next=Xt}}return{next:wN}}function wN(){return{value:f,done:!0}}return on.prototype=Mn,v(kt,"constructor",{value:Mn,configurable:!0}),v(Mn,"constructor",{value:on,configurable:!0}),on.displayName=H(Mn,G,"GeneratorFunction"),l.isGeneratorFunction=function(vn){var dn=typeof vn=="function"&&vn.constructor;return!!dn&&(dn===on||(dn.displayName||dn.name)==="GeneratorFunction")},l.mark=function(vn){return Object.setPrototypeOf?Object.setPrototypeOf(vn,Mn):(vn.__proto__=Mn,H(vn,G,"GeneratorFunction")),vn.prototype=Object.create(kt),vn},l.awrap=function(vn){return{__await:vn}},et(ir.prototype),H(ir.prototype,w,function(){return this}),l.AsyncIterator=ir,l.async=function(vn,dn,Un,Xt,gt){gt===void 0&&(gt=Promise);var Mr=new ir(x(vn,dn,Un,Xt),gt);return l.isGeneratorFunction(dn)?Mr:Mr.next().then(function(gi){return gi.done?gi.value:Mr.next()})},et(kt),H(kt,G,"Generator"),H(kt,S,function(){return this}),H(kt,"toString",function(){return"[object Generator]"}),l.keys=function(vn){var dn=Object(vn),Un=[];for(var Xt in dn)Un.push(Xt);return Un.reverse(),function gt(){for(;Un.length;){var Mr=Un.pop();if(Mr in dn)return gt.value=Mr,gt.done=!1,gt}return gt.done=!0,gt}},l.values=Wd,fo.prototype={constructor:fo,reset:function(vn){if(this.prev=0,this.next=0,this.sent=this._sent=f,this.done=!1,this.delegate=null,this.method="next",this.arg=f,this.tryEntries.forEach(co),!vn)for(var dn in this)dn.charAt(0)==="t"&&m.call(this,dn)&&!isNaN(+dn.slice(1))&&(this[dn]=f)},stop:function(){this.done=!0;var vn=this.tryEntries[0].completion;if(vn.type==="throw")throw vn.arg;return this.rval},dispatchException:function(vn){if(this.done)throw vn;var dn=this;function Un(ka,$d){return Mr.type="throw",Mr.arg=vn,dn.next=ka,$d&&(dn.method="next",dn.arg=f),!!$d}for(var Xt=this.tryEntries.length-1;Xt>=0;--Xt){var gt=this.tryEntries[Xt],Mr=gt.completion;if(gt.tryLoc==="root")return Un("end");if(gt.tryLoc<=this.prev){var gi=m.call(gt,"catchLoc"),Oa=m.call(gt,"finallyLoc");if(gi&&Oa){if(this.prev<gt.catchLoc)return Un(gt.catchLoc,!0);if(this.prev<gt.finallyLoc)return Un(gt.finallyLoc)}else if(gi){if(this.prev<gt.catchLoc)return Un(gt.catchLoc,!0)}else{if(!Oa)throw new Error("try statement without catch or finally");if(this.prev<gt.finallyLoc)return Un(gt.finallyLoc)}}}},abrupt:function(vn,dn){for(var Un=this.tryEntries.length-1;Un>=0;--Un){var Xt=this.tryEntries[Un];if(Xt.tryLoc<=this.prev&&m.call(Xt,"finallyLoc")&&this.prev<Xt.finallyLoc){var gt=Xt;break}}gt&&(vn==="break"||vn==="continue")&&gt.tryLoc<=dn&&dn<=gt.finallyLoc&&(gt=null);var Mr=gt?gt.completion:{};return Mr.type=vn,Mr.arg=dn,gt?(this.method="next",this.next=gt.finallyLoc,ye):this.complete(Mr)},complete:function(vn,dn){if(vn.type==="throw")throw vn.arg;return vn.type==="break"||vn.type==="continue"?this.next=vn.arg:vn.type==="return"?(this.rval=this.arg=vn.arg,this.method="return",this.next="end"):vn.type==="normal"&&dn&&(this.next=dn),ye},finish:function(vn){for(var dn=this.tryEntries.length-1;dn>=0;--dn){var Un=this.tryEntries[dn];if(Un.finallyLoc===vn)return this.complete(Un.completion,Un.afterLoc),co(Un),ye}},catch:function(vn){for(var dn=this.tryEntries.length-1;dn>=0;--dn){var Un=this.tryEntries[dn];if(Un.tryLoc===vn){var Xt=Un.completion;if(Xt.type==="throw"){var gt=Xt.arg;co(Un)}return gt}}throw new Error("illegal catch attempt")},delegateYield:function(vn,dn,Un){return this.delegate={iterator:Wd(vn),resultName:dn,nextLoc:Un},this.method==="next"&&(this.arg=f),ye}},l}(o.exports);try{regeneratorRuntime=c}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=c:Function("r","regeneratorRuntime = r")(c)}}),Fc("slice")),YL=dt("slice",{ACCESSORS:!0,0:0,1:2}),QL=pn("species"),ZL=[].slice,XL=Math.max;Fn({target:"Array",proto:!0,forced:!$L||!YL},{slice:function(o,c){var l,f,_,m=O(this),v=Cn(m.length),I=mt(o,v),S=mt(c===void 0?v:c,v);if(qt(m)&&(typeof(l=m.constructor)!="function"||l!==Array&&!qt(l.prototype)?N(l)&&(l=l[QL])===null&&(l=void 0):l=void 0,l===Array||l===void 0))return ZL.call(m,I,S);for(f=new(l===void 0?Array:l)(XL(S-I,0)),_=0;I<S;I++,_++)I in m&&bd(f,_,m[I]);return f.length=_,f}});var JL=Fc("splice"),e3=dt("splice",{ACCESSORS:!0,0:0,1:2}),n3=Math.max,t3=Math.min,r3=9007199254740991,i3="Maximum allowed length exceeded";Fn({target:"Array",proto:!0,forced:!JL||!e3},{splice:function(o,c){var l,f,_,m,v,I,S=zn(this),w=Cn(S.length),G=mt(o,w),H=arguments.length;if(H===0?l=f=0:H===1?(l=0,f=w-G):(l=H-2,f=t3(n3(tn(c),0),w-G)),w+l-f>r3)throw TypeError(i3);for(_=yt(S,f),m=0;m<f;m++)(v=G+m)in S&&bd(_,m,S[v]);if(_.length=f,l<f){for(m=G;m<w-f;m++)I=m+l,(v=m+f)in S?S[I]=S[v]:delete S[I];for(m=w;m>w-f+l;m--)delete S[m-1]}else if(l>f)for(m=w-f;m>G;m--)I=m+l-1,(v=m+f-1)in S?S[I]=S[v]:delete S[I];for(m=0;m<l;m++)S[m+G]=arguments[m+2];return S.length=w-f+l,_}});var zi=function(){function o(){ie(this,o),qe(this,"_listeners",{}),qe(this,"on",this.addEventListener),qe(this,"off",this.removeEventListener)}return se(o,[{key:"addEventListener",value:function(c,l){var f=this;return c in this._listeners||(this._listeners[c]=[]),this._listeners[c].push(l),function(){return f.removeEventListener(c,l)}}},{key:"once",value:function(c,l){var f=this;return this.on(c,function _(){l.apply(void 0,arguments),f.removeEventListener(c,_)})}},{key:"removeEventListener",value:function(c,l){if(c in this._listeners){for(var f=this._listeners[c],_=0,m=f.length;_<m;_++)if(f[_]===l)return void f.splice(_,1)}}},{key:"removeAllEventListeners",value:function(){this._listeners={}}},{key:"_dispatchEvent",value:function(c){if(c in this._listeners){for(var l=this._listeners[c].slice(),f=arguments.length,_=new Array(f>1?f-1:0),m=1;m<f;m++)_[m-1]=arguments[m];for(var v=0,I=l.length;v<I;v++){var S;(S=l[v]).call.apply(S,[this].concat(_))}}}}]),o}(),a3=Z.f,Pg=Function.prototype,s3=Pg.toString,u3=/^\s*function ([^ (]*)/,MI="name";u&&!(MI in Pg)&&a3(Pg,MI,{configurable:!0,get:function(){try{return s3.call(this).match(u3)[1]}catch{return""}}});var Ze,OI=function(){function o(c){ie(this,o),this.active=!1,this.queue=[],this.name=c}return se(o,[{key:"acquire",value:function(){var c=this;return new Promise(function(l){var f=function(){c.active=!0,l()};c.active?c.queue.push(f):f()})}},{key:"release",value:function(){if(this.active){this.active=!1;var c=this.queue.shift();c&&c()}}}]),o}(),_s=function o(){ie(this,o)},o3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"getApiOption",value:function(){return{auth:this.getAuth(),path:this.getPath(),method:this.getMethod(),body:this.getData(),headers:this.getHeaders()}}},{key:"getAuth",value:function(){return!0}},{key:"getHeaders",value:function(){return{}}}]),l}(_s),l3=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).payload=f.payload||{},_}return l}(_s),kI=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).type=f.type,_.version=f.version,_.messageId=f.message_id,_.deliveryInfo=f.delivery_info,_.sequenceNumber=f.sequence_number,_.payload=_.parseData(f.payload),_}return se(l,[{key:"isSequential",value:function(){return typeof this.sequenceNumber=="number"}}]),l}(_s),d3=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).payload=_.parseData(f),_}return l}(_s),DI=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).version=f.version,_.messageId=f.message_id,_.type=f.type,_.deliveryInfo=f.delivery_info,_.sequenceNumber=f.sequence_number,_.payload=_.parseData(f.payload),_}return se(l,[{key:"isSequential",value:function(){return typeof this.sequenceNumber=="number"}}]),l}(_s),jr=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).roomId=f,_}return se(l,[{key:"getPath",value:function(){return"/v1/rooms".concat(this.getSubPath())}}]),l}(o3),na=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"getRoomId",value:function(){return this.payload.roomId}}]),l}(kI),pi=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return l}(d3),c3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"getRoomId",value:function(){return this.payload.roomId}}]),l}(DI);(function(o){o.CREATE="create",o.GET="get",o.QUERY="query",o.ENTER="enter",o.EXIT="exit",o.ALIVE="alive",o.AUDIO="audio",o.VIDEO="video",o.CUSTOM_ITEMS_FETCH="custom_items_fetch",o.CUSTOM_ITEMS_UPDATE="custom_items_update",o.CUSTOM_ITEMS_DELETE="custom_items_delete",o.INVITATION_SENT="invitation_sent",o.INVITATION_CANCELED="invitation_canceled",o.INVITATION_RECEIVED="invitation_received",o.INVITATION_ACCEPTED="invitation_accepted",o.INVITATION_DECLINED="invitation_declined",o.INVITATION_OTHER_DEVICE_ACCEPTED="invitation_other_device_accepted",o.INVITATION_OTHER_DEVICE_DECLINED="invitation_other_device_declined",o.ATTACH="attach",o.CONNECTED="connected",o.DETACH="detach",o.CREATE_ENDPOINT="create_endpoint",o.PUT_ENDPOINT="put_endpoint",o.RELEASE_ENDPOINT="release_endpoint",o.ROOM_DELETED="room_deleted",o.PARTICIPANT_ENTERED="participant_entered",o.PARTICIPANT_CONNECTED="participant_connected",o.PARTICIPANT_EXITED="participant_exited",o.PARTICIPANT_DISCONNECTED="participant_disconnected",o.PARTICIPANT_AUDIO_STATUS_CHANGED="participant_audio_status_changed",o.PARTICIPANT_VIDEO_STATUS_CHANGED="participant_video_status_changed"})(Ze||(Ze={}));var f3=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",Ze.ALIVE),m.participantId=_,m}return se(l,[{key:"getData",value:function(){return{}}},{key:"getMethod",value:function(){return"POST"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/alive")}}]),l}(jr),h3=function(o){ce(l,o);var c=fe(l);function l(f,_,m,v){var I;return ie(this,l),qe(je(I=c.call(this,f)),"type",Ze.ATTACH),I.participantId=_,I.endpointId=m,I.attachTo=v,I}return se(l,[{key:"getData",value:function(){return{attach_to:this.attachTo}}},{key:"getMethod",value:function(){return"POST"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/endpoints/").concat(this.endpointId,"/attach")}}]),l}(jr),p3=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this,f)),"type",Ze.AUDIO),v.participantId=_,v.enabled=m,v}return se(l,[{key:"getData",value:function(){return{on:this.enabled}}},{key:"getMethod",value:function(){return"PUT"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/audio")}}]),l}(jr),_3=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this,f)),"type",Ze.CONNECTED),v.participantId=_,v.endpointId=m,v}return se(l,[{key:"getData",value:function(){return{}}},{key:"getMethod",value:function(){return"POST"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/endpoints/").concat(this.endpointId,"/connected")}}]),l}(jr),m3=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,void 0)),"type",Ze.CREATE),_.params=f,_}return se(l,[{key:"getData",value:function(){return{type:this.params.roomType,custom_items:this.params.customItems}}},{key:"getMethod",value:function(){return"POST"}},{key:"getSubPath",value:function(){return""}}]),l}(jr),g3=function(o){ce(l,o);var c=fe(l);function l(f,_,m,v){var I;return ie(this,l),qe(je(I=c.call(this,f)),"type",Ze.CREATE_ENDPOINT),I.participantId=_,I.sdp=m,I.mediaDirection=v,I}return se(l,[{key:"getData",value:function(){return{sdp:this.sdp,audio_attr:this.mediaDirection.audio,video_attr:this.mediaDirection.video}}},{key:"getMethod",value:function(){return"POST"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/endpoints")}}]),l}(jr),v3=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",Ze.CUSTOM_ITEMS_DELETE),m.customItemKeys=_,m}return se(l,[{key:"getData",value:function(){return this.customItemKeys.length>0?{keys:this.customItemKeys}:{}}},{key:"getMethod",value:function(){return"DELETE"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/custom_items")}}]),l}(jr),E3=function(o){ce(l,o);var c=fe(l);function l(f,_,m,v){var I;return ie(this,l),qe(je(I=c.call(this,f)),"type",Ze.DETACH),I.participantId=_,I.endpointId=m,I.attachTo=v,I}return se(l,[{key:"getData",value:function(){return{attach_to:this.attachTo}}},{key:"getMethod",value:function(){return"DELETE"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/endpoints/").concat(this.endpointId)}}]),l}(jr),y3=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",Ze.ENTER),m.params=_,m}return se(l,[{key:"getData",value:function(){return{is_audio_on:this.params.audioEnabled,is_video_on:this.params.videoEnabled,kick_siblings:this.params.kickSiblings}}},{key:"getMethod",value:function(){return"POST"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants")}}]),l}(jr),b3=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",Ze.EXIT),m.participantId=_,m}return se(l,[{key:"getData",value:function(){return{}}},{key:"getMethod",value:function(){return"DELETE"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId)}}]),l}(jr),C3=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,f)),"type",Ze.CUSTOM_ITEMS_FETCH),_}return se(l,[{key:"getData",value:function(){}},{key:"getMethod",value:function(){return"GET"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/custom_items")}}]),l}(jr),I3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.GET),f}return se(l,[{key:"getData",value:function(){}},{key:"getMethod",value:function(){return"GET"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId)}}]),l}(jr),T3=function(o){ce(l,o);var c=fe(l);function l(f,_,m,v){var I;return ie(this,l),qe(je(I=c.call(this,f)),"type",Ze.PUT_ENDPOINT),I.participantId=_,I.endpointId=m,I.sdp=v,I}return se(l,[{key:"getData",value:function(){return{sdp:this.sdp}}},{key:"getMethod",value:function(){return"PUT"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/endpoints/").concat(this.endpointId)}}]),l}(jr),S3=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this,f)),"type",Ze.RELEASE_ENDPOINT),v.participantId=_,v.endpointId=m,v}return se(l,[{key:"getData",value:function(){return{}}},{key:"getMethod",value:function(){return"DELETE"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/endpoints/").concat(this.endpointId)}}]),l}(jr),N3=Je.filter,A3=Fc("filter"),w3=dt("filter");Fn({target:"Array",proto:!0,forced:!A3||!w3},{filter:function(o){return N3(this,o,arguments.length>1?arguments[1]:void 0)}});var R3=[].join,M3=T!=Object,O3=oe("join",",");Fn({target:"Array",proto:!0,forced:M3||!O3},{join:function(o){return R3.call(O(this),o===void 0?",":o)}});var LI=function(){function o(){ie(this,o)}return se(o,null,[{key:"createQuery",value:function(c){var l=this;return Object.keys(c).filter(function(f){return c[f]!=null}).map(function(f){return"".concat(encodeURIComponent(f),"=").concat(l.toQueryParam(c[f]))}).join("&")}},{key:"toQueryParam",value:function(c){return Array.isArray(c)?c.map(function(l){return encodeURIComponent(l.toString())}).join(","):encodeURIComponent(c.toString())}}]),o}(),k3=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this)),"type",Ze.QUERY),v.params=v._normalizeParams(f),v.prev=_,v.next=m,v}return se(l,[{key:"getData",value:function(){}},{key:"getSubPath",value:function(){return"?".concat(this._createQuery())}},{key:"getMethod",value:function(){return"GET"}},{key:"_normalizeParams",value:function(f){var _=f.type,m=f.limit,v=f.state,I=f.currentParticipantCount,S=f.createdByUserIds,w=f.roomIds,G=f.createdAt;return{type:_,limit:m!=null?Math.min(Math.max(1,m),100):void 0,state:v,currentParticipantCount:I,createdByUserIds:S,roomIds:w,createdAt:G}}},{key:"_createQuery",value:function(){var f,_,m,v;return LI.createQuery({type:this.params.type,limit:this.params.limit,state:this.params.state,current_participant_range_gte:(f=this.params.currentParticipantCount)===null||f===void 0?void 0:f[0],current_participant_range_lte:(_=this.params.currentParticipantCount)===null||_===void 0?void 0:_[1],created_by_user_ids:this.params.createdByUserIds,room_ids:this.params.roomIds,created_at_start_date:(m=this.params.createdAt)===null||m===void 0?void 0:m[0],created_at_end_date:(v=this.params.createdAt)===null||v===void 0?void 0:v[1],prev:this.prev,next:this.next})}}]),l}(jr),D3=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this,f)),"type",Ze.CUSTOM_ITEMS_UPDATE),v.customItems=_,v.mode=m,v}return se(l,[{key:"getData",value:function(){return{custom_items:this.customItems,mode:this.mode}}},{key:"getMethod",value:function(){return"PUT"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/custom_items")}}]),l}(jr),L3=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this,f)),"type",Ze.VIDEO),v.participantId=_,v.enabled=m,v}return se(l,[{key:"getData",value:function(){return{on:this.enabled}}},{key:"getMethod",value:function(){return"PUT"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/participants/").concat(this.participantId,"/video")}}]),l}(jr),x3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.CUSTOM_ITEMS_DELETE),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id,deleted:f.deleted,customItems:f.custom_items,affectedAt:f.affected_at}}}]),l}(na),ya=function o(c){ie(this,o),Object.assign(this,c)},$r=function(){function o(){ie(this,o)}return se(o,null,[{key:"parseRoom",value:function(c){return c?{roomId:c.room_id,state:c.state,roomType:c.room_type,customItems:c.custom_items,createdAt:c.created_at,createdBy:c.created_by,participants:o.parseParticipants(c.current_participants)}:{}}},{key:"parseCustomItemsResult",value:function(c){return{customItems:c.custom_items||{},affectedKeys:[].concat(Ed(c.updated||[]),Ed(c.deleted||[])),affectedAt:c.affected_at||0}}},{key:"parseParticipants",value:function(c){return c&&Array.isArray(c)?c.map(function(l){return o.parseParticipant(l)}):[]}},{key:"parseParticipant",value:function(c){return c?{participantId:c.participant_id,enteredAt:c.entered_at,updatedAt:c.updated_at,exitedAt:c.exited_at,duration:c.duration,state:c.state,user:new ya(Ea(c.user)),isLocalParticipant:c.is_local_participant,clientId:c.client_id,isAudioEnabled:c.is_audio_on,isVideoEnabled:c.is_video_on}:{}}}]),o}(),U3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.PARTICIPANT_AUDIO_STATUS_CHANGED),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id,participant:$r.parseParticipant(f.participant),on:f.on}}}]),l}(na),P3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.PARTICIPANT_CONNECTED),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id,participant:$r.parseParticipant(f.participant)}}}]),l}(na),F3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.PARTICIPANT_DISCONNECTED),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id,participant:$r.parseParticipant(f.participant),reason:f.reason}}}]),l}(na),H3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.PARTICIPANT_ENTERED),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id,participant:$r.parseParticipant(f.participant)}}}]),l}(na),B3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.PARTICIPANT_EXITED),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id,participant:$r.parseParticipant(f.participant)}}}]),l}(na),G3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.PARTICIPANT_VIDEO_STATUS_CHANGED),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id,participant:$r.parseParticipant(f.participant),on:f.on}}}]),l}(na),V3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.ROOM_DELETED),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id}}}]),l}(na),j3=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.CUSTOM_ITEMS_UPDATE),f}return se(l,[{key:"parseData",value:function(f){return{roomId:f.room_id,updated:f.updated,customItems:f.custom_items,affectedAt:f.affected_at}}}]),l}(na),q3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{}}}]),l}(pi),z3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{}}}]),l}(pi),K3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{me:$r.parseParticipant(f.me)}}}]),l}(pi),W3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{}}}]),l}(pi),$3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{endpointId:f.endpoint_id,sdp:f.sdp}}}]),l}(pi),Y3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room)}}}]),l}(pi),Q3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return $r.parseCustomItemsResult(f)}}]),l}(pi),Z3=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{}}}]),l}(pi),X3=Je.find,op="find",xI=!0,J3=dt(op);op in[]&&Array(1)[op](function(){xI=!1}),Fn({target:"Array",proto:!0,forced:xI||!J3},{find:function(o){return X3(this,o,arguments.length>1?arguments[1]:void 0)}}),Ku(op);var ex=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return f.room.current_participants.find(function(_){return _.participant_id===f.me.participant_id}).is_local_participant=!0,f.me.is_local_participant=!0,{me:$r.parseParticipant(f.me),room:$r.parseRoom(f.room)}}}]),l}(pi),nx=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{}}}]),l}(pi),tx=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return $r.parseCustomItemsResult(f)}}]),l}(pi),rx=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room)}}}]),l}(pi),ix=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{endpointId:f.endpoint_id,sdp:f.sdp}}}]),l}(pi),ax=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{}}}]),l}(pi),sx=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{rooms:f.rooms.map(function(_){return $r.parseRoom(_)}),prev:f.prev,next:f.next}}}]),l}(pi),ux=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return $r.parseCustomItemsResult(f)}}]),l}(pi),ox=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{me:$r.parseParticipant(f.me)}}}]),l}(pi),lx=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",Ze.INVITATION_ACCEPTED),m.inviterId=_,m}return se(l,[{key:"getData",value:function(){return{action:"accept",inviter_id:this.inviterId}}},{key:"getMethod",value:function(){return"PUT"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/invitation")}}]),l}(jr),dx=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",Ze.INVITATION_CANCELED),m.inviteeId=_,m}return se(l,[{key:"getData",value:function(){return{invitee_id:this.inviteeId}}},{key:"getMethod",value:function(){return"DELETE"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/invitation")}}]),l}(jr),cx=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",Ze.INVITATION_DECLINED),m.inviterId=_,m}return se(l,[{key:"getData",value:function(){return{action:"decline",inviter_id:this.inviterId}}},{key:"getMethod",value:function(){return"PUT"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/invitation")}}]),l}(jr),fx=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,void 0)),"type",Ze.ROOM_DELETED),_.roomId=f,_}return se(l,[{key:"getData",value:function(){return{}}},{key:"getMethod",value:function(){return"DELETE"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId)}}]),l}(jr),hx=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this,f)),"type",Ze.INVITATION_RECEIVED),v.inviterId=_,v.shortLivedToken=m,v}return se(l,[{key:"getHeaders",value:function(){return{"SBCall-Short-Lived-Token":this.shortLivedToken}}},{key:"getData",value:function(){return{action:"receive",inviter_id:this.inviterId}}},{key:"getMethod",value:function(){return"PUT"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/invitation")}}]),l}(jr),px=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",Ze.INVITATION_SENT),m.inviteeId=_,m}return se(l,[{key:"getData",value:function(){return{invitee_id:this.inviteeId}}},{key:"getMethod",value:function(){return"POST"}},{key:"getSubPath",value:function(){return"/".concat(this.roomId,"/invitation")}}]),l}(jr),_x=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.INVITATION_ACCEPTED),f}return se(l,[{key:"getRoomId",value:function(){return this.payload.room.roomId}},{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room),inviter:new ya(Ea(f.inviter)),invitee:new ya(Ea(f.invitee))}}}]),l}(na),mx=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.INVITATION_CANCELED),f}return se(l,[{key:"getRoomId",value:function(){return this.payload.room.roomId}},{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room),inviter:new ya(Ea(f.inviter)),invitee:new ya(Ea(f.invitee))}}}]),l}(na),gx=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.INVITATION_DECLINED),f}return se(l,[{key:"getRoomId",value:function(){return this.payload.room.roomId}},{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room),inviter:new ya(Ea(f.inviter)),invitee:new ya(Ea(f.invitee))}}}]),l}(na),vx=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.INVITATION_RECEIVED),f}return se(l,[{key:"getRoomId",value:function(){return this.payload.room.roomId}},{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room),inviter:new ya(Ea(f.inviter)),invitee:new ya(Ea(f.invitee))}}}]),l}(na),Ex=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",Ze.INVITATION_SENT),f}return se(l,[{key:"getRoomId",value:function(){return this.payload.room.roomId}},{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room),inviter:new ya(Ea(f.inviter)),invitee:new ya(Ea(f.invitee)),shortLivedToken:f.sbcall_short_lived_token}}}]),l}(na),yx=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room)}}}]),l}(pi),bx=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{room:$r.parseRoom(f.room),inviter:new ya(Ea(f.inviter)),invitee:new ya(Ea(f.invitee)),shortLivedToken:f.shortLivedToken}}}]),l}(pi),qr=function(){function o(){ie(this,o)}return se(o,null,[{key:"createCreate",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(m3,l)}},{key:"createDeleteRoom",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(fx,l)}},{key:"createGet",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(I3,l)}},{key:"createRoomListQuery",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(k3,l)}},{key:"createEnter",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(y3,l)}},{key:"createExit",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(b3,l)}},{key:"createCreateEndpoint",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(g3,l)}},{key:"createPutEndpoint",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(T3,l)}},{key:"createReleaseEndpoint",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(S3,l)}},{key:"createAttach",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(h3,l)}},{key:"createConnected",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(_3,l)}},{key:"createDetach",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(E3,l)}},{key:"createAlive",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(f3,l)}},{key:"createAudio",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(p3,l)}},{key:"createVideo",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(L3,l)}},{key:"createFetchCustomItems",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(C3,l)}},{key:"createUpdateCustomItems",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(D3,l)}},{key:"createDeleteCustomItems",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(v3,l)}},{key:"createSendInvitation",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(px,l)}},{key:"createCancelInvitation",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(dx,l)}},{key:"createInvitationReceive",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(hx,l)}},{key:"createAcceptInvitation",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(lx,l)}},{key:"createDeclineInvitation",value:function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return xr(cx,l)}},{key:"parseResponse",value:function(c,l){switch(c){case Ze.CREATE:return new Y3(l);case Ze.ROOM_DELETED:return new yx(l);case Ze.GET:return new rx(l);case Ze.QUERY:return new sx(l);case Ze.ENTER:return new ex(l);case Ze.EXIT:return new nx(l);case Ze.CUSTOM_ITEMS_FETCH:return new tx(l);case Ze.CUSTOM_ITEMS_UPDATE:return new ux(l);case Ze.CUSTOM_ITEMS_DELETE:return new Q3(l);case Ze.CREATE_ENDPOINT:return new $3(l);case Ze.PUT_ENDPOINT:return new ix(l);case Ze.RELEASE_ENDPOINT:return new ax(l);case Ze.ATTACH:return new z3(l);case Ze.CONNECTED:return new W3(l);case Ze.DETACH:return new Z3(l);case Ze.ALIVE:return new q3(l);case Ze.AUDIO:return new K3(l);case Ze.VIDEO:return new ox(l);case Ze.INVITATION_SENT:return new bx(l);default:return void ae.error(new Jt(De.ERR_WRONG_RESPONSE,{error:new Error("unhandled command data. ".concat(JSON.stringify(l)))}))}}},{key:"parse",value:function(c){switch(c.type){case Ze.CUSTOM_ITEMS_UPDATE:return new j3(c);case Ze.CUSTOM_ITEMS_DELETE:return new x3(c);case Ze.ROOM_DELETED:return new V3(c);case Ze.PARTICIPANT_ENTERED:return new H3(c);case Ze.PARTICIPANT_CONNECTED:return new P3(c);case Ze.PARTICIPANT_EXITED:return new B3(c);case Ze.PARTICIPANT_DISCONNECTED:return new F3(c);case Ze.PARTICIPANT_AUDIO_STATUS_CHANGED:return new U3(c);case Ze.PARTICIPANT_VIDEO_STATUS_CHANGED:return new G3(c);case Ze.INVITATION_SENT:return new Ex(c);case Ze.INVITATION_CANCELED:return new mx(c);case Ze.INVITATION_RECEIVED:return new vx(c);case Ze.INVITATION_ACCEPTED:return new _x(c);case Ze.INVITATION_DECLINED:return new gx(c);default:return void ae.error(new Jt(De.ERR_WRONG_RESPONSE,{error:new Error("unhandled command data. ".concat(JSON.stringify(c)))}))}}}]),o}(),Cx=function(o,c,l,f){try{return f?c(Q(l)[0],l[1]):c(l)}catch(_){throw Ym(o),_}},Zo=function(o){var c,l,f,_,m,v,I=zn(o),S=typeof this=="function"?this:Array,w=arguments.length,G=w>1?arguments[1]:void 0,H=G!==void 0,x=$h(I),V=0;if(H&&(G=Pt(G,w>2?arguments[2]:void 0,2)),x==null||S==Array&&s0(x))for(l=new S(c=Cn(I.length));c>V;V++)v=H?G(I[V],V):I[V],bd(l,V,v);else for(m=(_=x.call(I)).next,l=new S;!(f=m.call(_)).done;V++)v=H?Cx(_,G,[f.value,V],!0):f.value,bd(l,V,v);return l.length=V,l},Ix=!Qm(function(o){Array.from(o)});Fn({target:"Array",stat:!0,forced:Ix},{from:Zo});for(var Tx=function(o,c){return o(c={exports:{}},c.exports),c.exports}(function(o){var c=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(c){var l=new Uint8Array(16);o.exports=function(){return c(l),l}}else{var f=new Array(16);o.exports=function(){for(var _,m=0;m<16;m++)!(3&m)&&(_=4294967296*Math.random()),f[m]=_>>>((3&m)<<3)&255;return f}}}),UI=[],lp=0;lp<256;++lp)UI[lp]=(lp+256).toString(16).substr(1);var Sx=function(o,c){var l=0,f=UI;return[f[o[l++]],f[o[l++]],f[o[l++]],f[o[l++]],"-",f[o[l++]],f[o[l++]],"-",f[o[l++]],f[o[l++]],"-",f[o[l++]],f[o[l++]],"-",f[o[l++]],f[o[l++]],f[o[l++]],f[o[l++]],f[o[l++]],f[o[l++]]].join("")},dp=function(o,c,l){var f=c&&l||0;typeof o=="string"&&(c=o==="binary"?new Array(16):null,o=null);var _=(o=o||{}).random||(o.rng||Tx)();if(_[6]=15&_[6]|64,_[8]=63&_[8]|128,c)for(var m=0;m<16;++m)c[f+m]=_[m];return c||Sx(_)},Nx=In.includes,Ax=dt("indexOf",{ACCESSORS:!0,1:0});Fn({target:"Array",proto:!0,forced:!Ax},{includes:function(o){return Nx(this,o,arguments.length>1?arguments[1]:void 0)}}),Ku("includes");var wx=function(o){if(wI(o))throw TypeError("The method doesn't accept regular expressions");return o},Rx=pn("match");Fn({target:"String",proto:!0,forced:!function(o){var c=/./;try{"/./"[o](c)}catch{try{return c[Rx]=!1,"/./"[o](c)}catch{}}return!1}("includes")},{includes:function(o){return!!~String(A(this)).indexOf(wx(o),arguments.length>1?arguments[1]:void 0)}});var cp=`[	
\v\f\r                　\u2028\u2029\uFEFF]`,Mx=RegExp("^"+cp+cp+"*"),Ox=RegExp(cp+cp+"*$"),Fg=function(o){return function(c){var l=String(A(c));return 1&o&&(l=l.replace(Mx,"")),2&o&&(l=l.replace(Ox,"")),l}},kx={start:Fg(1),end:Fg(2),trim:Fg(3)},Dx=Qt.f,Lx=Y.f,xx=Z.f,Ux=kx.trim,Yc="Number",Qu=a[Yc],fp=Qu.prototype,Px=y(ps(fp))==Yc,PI=function(o){var c,l,f,_,m,v,I,S,w=k(o,!1);if(typeof w=="string"&&w.length>2){if((c=(w=Ux(w)).charCodeAt(0))===43||c===45){if((l=w.charCodeAt(2))===88||l===120)return NaN}else if(c===48){switch(w.charCodeAt(1)){case 66:case 98:f=2,_=49;break;case 79:case 111:f=8,_=55;break;default:return+w}for(v=(m=w.slice(2)).length,I=0;I<v;I++)if((S=m.charCodeAt(I))<48||S>_)return NaN;return parseInt(m,f)}}return+w};if(lt(Yc,!Qu(" 0o1")||!Qu("0b1")||Qu("+0x1"))){for(var hp,Xo=function(o){var c=arguments.length<1?0:o,l=this;return l instanceof Xo&&(Px?s(function(){fp.valueOf.call(l)}):y(l)!=Yc)?c0(new Qu(PI(c)),l,Xo):PI(c)},FI=u?Dx(Qu):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),Hg=0;FI.length>Hg;Hg++)P(Qu,hp=FI[Hg])&&!P(Xo,hp)&&xx(Xo,hp,Lx(Qu,hp));Xo.prototype=fp,fp.constructor=Xo,wn(a,Yc,Xo)}Fn({target:"Number",stat:!0},{isNaN:function(o){return o!=o}});var pp=function(o){return o===void 0||Number.isNaN(o)||o===""||o===[]},Bg=function(o){Object.keys(o).forEach(function(c){pp(o[c])&&delete o[c]})},Zu,Fx=function(){var o=Bn(regeneratorRuntime.mark(function c(l){var f,_,m,v,I,S,w,G,H,x,V,K,te;return regeneratorRuntime.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(l){me.next=2;break}throw new Error("'getCandidateInfo()' is called without rtcConnection");case 2:return me.next=4,l.getStats();case 4:f=me.sent,m=f.entries(),v=0;case 7:if(!(v<f.size)){me.next=18;break}if(I=m.next(),S=I.value){me.next=11;break}return me.abrupt("continue",15);case 11:if((w=S[1]).type!=="candidate-pair"||w.state!=="succeeded"){me.next=15;break}return _=w.localCandidateId,me.abrupt("break",18);case 15:v++,me.next=7;break;case 18:if(!(v<f.size)){me.next=28;break}if(G=m.next(),H=G.value){me.next=22;break}return me.abrupt("continue",25);case 22:if((x=H[1]).type!=="local-candidate"||x.id!==_){me.next=25;break}return me.abrupt("return",{connectionType:(V=x.candidateType)!==null&&V!==void 0?V:"",protocol:(K=x.protocol)!==null&&K!==void 0?K:"",relayProtocol:(te=x.relayProtocol)!==null&&te!==void 0?te:""});case 25:v++,me.next=18;break;case 28:return me.abrupt("return",null);case 29:case"end":return me.stop()}},c)}));return function(c){return o.apply(this,arguments)}}(),Hx=function(){var o=Bn(regeneratorRuntime.mark(function c(l){var f,_,m,v,I,S,w;return regeneratorRuntime.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return f={},_={},m={},v={},I=new Map,S=new Map,l.forEach(function(H){H.type==="codec"&&I.set(H.id,H),H.type==="candidate-pair"&&H.state==="succeeded"&&(w=H.localCandidateId,f.webrtc_timestamp=H.time),H.type==="media-source"&&S.set(H.kind,H)}),l.forEach(function(H){if(H.type==="local-candidate"&&H.id===w&&(f.network_type=H.networkType,_.network_type=H.networkType,_.protocol=H.protocol,_.candidate_type=H.candidateType),H.kind==="audio"||H.mediaType==="audio"){if(H.type==="outbound-rtp"){var x=I.get(H.codecId);x&&(m.codec=x.mimeType),m.total_packets_sent=H.packetsSent,m.total_bytes_sent=H.bytesSent,m.total_retransmitted_packets_sent=H.retransmittedPacketsSent,m.total_retransmitted_bytes_sent=H.retransmittedBytesSent,m.target_bitrate=H.targetBitrate,m.outbound_nack_count=H.nackCount}if(H.type==="remote-inbound-rtp"&&(m.remote_jitter=H.jitter,m.remote_rtt=1e3*H.roundTripTime,m.remote_total_packets_lost=H.packetsLost,m.remote_fraction_lost=H.fractionLost),H.type==="inbound-rtp"){var V=I.get(H.codecId);V&&(m.codec=V.mimeType),m.total_packets_lost=H.packetsLost,m.total_packets_received=H.packetsReceived,m.total_bytes_received=H.bytesReceived,m.inbound_jitter=H.jitter,m.total_packets_discarded=H.packetsDiscarded,m.total_fec_packets_received=H.fecPacketsReceived,m.total_fec_packets_discarded=H.fecPacketsDiscarded,m.jitter_buffer_delay=H.jitterBufferDelay,m.jitter_buffer_emitted_count=H.jitterBufferEmittedCount,m.jitter_buffer_target_delay=H.jitterBufferTargetDelay,m.total_samples_received=H.totalSamplesReceived,m.total_concealed_samples=H.concealedSamples,m.concealed_samples_ratio=H.concealedSamples/H.totalSamplesReceived*100,m.total_silent_concealed_samples=H.silentConcealedSamples,m.total_inserted_samples_for_deceleration=H.insertedSamplesForDeceleration,m.total_removed_samples_for_acceleration=H.removedSamplesForAcceleration}}if(H.kind==="video"||H.mediaType==="video"){var K,te,me;if(v.video_source_width=(K=S.get("video"))===null||K===void 0?void 0:K.width,v.video_source_height=(te=S.get("video"))===null||te===void 0?void 0:te.height,v.video_source_frames_per_second=(me=S.get("video"))===null||me===void 0?void 0:me.framesPerSecond,H.type==="outbound-rtp"){var _e=I.get(H.codecId);_e&&(v.codec=_e.mimeType),v.target_bitrate=H.targetBitrate,v.sent_frame_width=H.frameWidth,v.sent_frame_height=H.frameHeight,v.outbound_fir_count=H.firCount,v.outbound_pli_count=H.pliCount,v.outbound_nack_count=H.nackCount,v.total_packets_sent=H.packetsSent,v.total_bytes_sent=H.bytesSent,v.total_frames_encoded=H.framesEncoded,v.total_key_frames_encoded=H.keyFramesEncoded,v.total_frames_sent=H.framesSent,v.huge_frames_sent=H.hugeFramesSent,v.quality_limitation_reason=H.qualityLimitationReason,v.quality_limitation_durations=H.qualityLimitationDurations,v.quality_limitation_resolution_changes=H.qualityLimitationResolutionChanges,v.total_retransmitted_packets_sent=H.retransmittedPacketsSent,v.total_retransmitted_bytes_sent=H.retransmittedBytesSent}if(H.type==="remote-inbound-rtp"&&(v.remote_jitter=H.jitter,v.remote_rtt=1e3*H.roundTripTime,v.remote_total_packets_lost=H.packetsLost,v.remote_packets_lost_rate=H.remote_packets_lost/v.packets_sent*100,v.remote_fraction_lost=H.fractionLost),H.type==="inbound-rtp"){var ye=I.get(H.codecId);ye&&(v.codec=ye.mimeType),v.received_frame_width=H.frameWidth,v.received_frame_height=H.frameHeight,v.total_frames_received=H.framesReceived,v.total_frames_decoded=H.framesDecoded,v.total_key_frames_decoded=H.keyFramesDecoded,v.total_frames_dropped=H.framesDropped,v.inbound_jitter=H.jitter,v.total_bytes_received=H.bytesReceived,v.total_decode_time=H.totalDecodeTime,v.total_inter_frame_delay=H.totalInterFrameDelay,v.average_inter_frame_delay=H.totalInterFrameDelay/H.framesDecoded,v.total_squared_inter_frame_delay=H.totalSquaredInterFrameDelay,v.jitter_buffer_delay=H.jitterBufferDelay,v.jitter_buffer_emitted_count=H.jitterBufferEmittedCount,v.jitter_buffer_target_delay=H.jitterBufferTargetDelay,v.freeze_count=H.freezeCount,v.pause_count=H.pauseCount,v.total_freezes_duration=H.totalFreezesDuration,v.total_pauses_duration=H.totalPausesDuration,H.packetsLost,H.packetsLost,H.packetsReceived,v.total_packets_lost=H.packetsLost,v.total_packets_received=H.packetsReceived,v.inbound_fir_count=H.firCount,v.inbound_pli_count=H.pliCount,v.inbound_nack_count=H.nackCount}}}),Bg(_),Bg(m),Bg(v),f.transport_info=_,f.audio=m,f.video=v,G.abrupt("return",f);case 15:case"end":return G.stop()}},c)}));return function(c){return o.apply(this,arguments)}}(),Bx=function(){var o=Bn(regeneratorRuntime.mark(function c(l){var f;return regeneratorRuntime.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(l){_.next=2;break}throw new Error("'getStats()' is called without rtcConnection");case 2:return _.next=4,l.getStats();case 4:return f=_.sent,_.abrupt("return",Hx(f));case 6:case"end":return _.stop()}},c)}));return function(c){return o.apply(this,arguments)}}(),Gg=function(o){var c=Fr(Fr({},o),{},{transport_info:Fr({},o.transport_info),audio:Fr({},o.audio)});return o.video&&(c.video=Fr({},o.video)),c},Vg=function(o,c){var l=Gg(o),f=l.audio,_=l.video;return f.packets_lost=f.total_packets_lost,f.packets_sent=f.total_packets_sent,f.packets_received=f.total_packets_received,f.bytes_sent=f.total_bytes_sent,f.bytes_received=f.total_bytes_received,f.remote_packets_lost=f.remote_total_packets_lost,f.retransmitted_packets_sent=f.total_retransmitted_packets_sent,f.retransmitted_bytes_sent=f.total_retransmitted_bytes_sent,f.fec_packets_received=f.total_fec_packets_received,f.samples_received=f.total_samples_received,f.concealed_samples=f.total_concealed_samples,f.silent_concealed_samples=f.total_silent_concealed_samples,f.inserted_samples_for_deceleration=f.total_inserted_samples_for_deceleration,f.removed_samples_for_acceleration=f.total_removed_samples_for_acceleration,c&&(f.packets_lost-=c.audio.total_packets_lost,f.packets_sent-=c.audio.total_packets_sent,f.packets_received-=c.audio.total_packets_received,f.bytes_sent-=c.audio.total_bytes_sent,f.remote_packets_lost-=c.audio.remote_total_packets_lost,f.retransmitted_packets_sent-=c.audio.total_retransmitted_packets_sent,f.retransmitted_bytes_sent-=c.audio.total_retransmitted_bytes_sent,f.fec_packets_received-=c.audio.total_fec_packets_received,f.bytes_received-=c.audio.total_bytes_received,f.samples_received-=c.audio.total_samples_received,f.concealed_samples-=c.audio.total_concealed_samples,f.silent_concealed_samples-=c.audio.total_silent_concealed_samples,f.inserted_samples_for_deceleration-=c.audio.total_inserted_samples_for_deceleration,f.removed_samples_for_acceleration-=c.audio.total_removed_samples_for_acceleration),f.packets_lost_rate=f.packets_lost/(f.packets_lost+f.packets_received)*100,f.remote_packets_lost_rate=f.remote_packets_lost/f.packets_sent*100,_.packets_lost=_.total_packets_lost,_.remote_packets_lost=_.remote_total_packets_lost,_.packets_sent=_.total_packets_sent,_.packets_received=_.total_packets_received,_.bytes_sent=_.total_bytes_sent,_.bytes_received=_.total_bytes_received,_.retransmitted_packets_sent=_.total_retransmitted_packets_sent,_.retransmitted_bytes_sent=_.total_retransmitted_bytes_sent,_.frames_encoded=_.total_frames_encoded,_.key_frames_encoded=_.total_key_frames_encoded,_.frames_decoded=_.total_frames_decoded,_.key_frames_decoded=_.total_key_frames_decoded,_.frames_sent=_.total_frames_sent,_.frames_received=_.total_frames_received,c&&(_.packets_lost-=c.video.total_packets_lost,_.remote_packets_lost-=c.video.remote_total_packets_lost,_.packets_sent-=c.video.total_packets_sent,_.packets_received-=c.video.total_packets_received,_.bytes_sent-=c.video.total_bytes_sent,_.bytes_received-=c.video.total_bytes_received,_.retransmitted_packets_sent-=c.video.total_retransmitted_packets_sent,_.retransmitted_bytes_sent-=c.video.total_retransmitted_bytes_sent,_.frames_encoded-=c.video.total_frames_encoded,_.key_frames_encoded-=c.video.total_key_frames_encoded,_.frames_decoded-=c.video.total_frames_decoded,_.key_frames_decoded-=c.video.total_key_frames_decoded,_.frames_sent-=c.video.total_frames_sent,_.frames_received-=c.video.total_frames_received),_.packets_lost_rate=_.packets_lost/(_.packets_lost+_.packets_received)*100,_.remote_packets_lost_rate=_.remote_packets_lost/_.packets_sent*100,f.remote_rtt&&(f.mos=function(m,v,I){if(!(pp(m)||pp(v)||pp(I))){var S,w,G=I/2+2*v+10;return S=G<160?93.2-G/40:93.2-(G-120)/10,(S-=2.5*m)<=0?w=1:0<S&&S<100?w=1+.035*S+7e-6*S*(S-60)*(100-S):S>=100&&(w=4.5),w<1&&(w=1),w>4.5&&(w=4.5),w}}(f.packets_lost,f.remote_jitter,f.remote_rtt)),l},HI=function(o,c){if(o!==void 0||c!==void 0)return(o??0)+(c??0)},BI=function(o,c,l){if(o!==void 0||c!==void 0)return(o??0)*l+(c??0)*(1-l)},GI=function(o,c){var l=Gg(o);if(!c)return l;function f(_){return _==="audio"?function(m){l.audio[m]=HI(l.audio[m],c.audio[m])}:function(m){l.video[m]=HI(l.video[m],c.video[m])}}return f("audio")("total_packets_sent"),f("audio")("total_packets_received"),f("audio")("total_packets_lost"),f("audio")("retransmitted_packets_sent"),f("audio")("jitter_buffer_delay"),f("video")("outbound_fir_count"),f("video")("outbound_pli_count"),f("video")("outbound_nack_count"),f("video")("retransmitted_packets_sent"),f("video")("quality_limitation_resolution_changes"),l.video.quality_limitation_reason==="none"&&(l.video.quality_limitation_reason=c.video.quality_limitation_reason),f("video")("key_frames_decoded"),f("video")("total_decode_time"),f("video")("total_inter_frame_delay"),f("video")("total_squared_inter_frame_delay"),f("video")("total_packets_lost"),f("video")("total_packets_received"),f("video")("jitter_buffer_delay"),f("video")("jitter_buffer_emitted_count"),f("video")("frames_received"),f("video")("frames_decoded"),f("video")("freeze_count"),f("video")("pause_count"),f("video")("total_freezes_duration"),f("video")("total_pauses_duration"),l},VI=function(o,c,l){var f=Gg(o);if(l<=1||!c)return f;var _=1/l,m=1/(l-1);function v(S){return S==="audio"?function(w){f.audio[w]=BI(f.audio[w],c.audio[w],["rtt","mos"].includes(w)?m:_)}:function(w){f.video[w]=BI(f.video[w],c.video[w],["rtt","mos"].includes(w)?m:_)}}function I(S){return S==="audio"?function(w){f.audio[w]=c.audio[w]}:function(w){f.video[w]=c.video[w]}}return I("audio")("codec"),v("audio")("remote_rtt"),v("audio")("packets_sent"),v("audio")("packets_received"),v("audio")("bytes_sent"),v("audio")("bytes_received"),v("audio")("retransmitted_packets_sent"),v("audio")("retransmitted_bytes_sent"),v("audio")("fec_packets_received"),v("audio")("samples_received"),v("audio")("concealed_samples"),v("audio")("silent_concealed_samples"),v("audio")("inserted_samples_for_deceleration"),v("audio")("removed_samples_for_acceleration"),v("audio")("target_bitrate"),v("audio")("remote_fraction_lost"),v("audio")("inbound_jitter"),v("audio")("remote_jitter"),v("audio")("packets_lost"),v("audio")("packets_lost_rate"),v("audio")("remote_packets_lost"),v("audio")("remote_packets_lost_rate"),v("audio")("mos"),I("video")("codec"),v("video")("remote_rtt"),v("video")("packets_sent"),v("video")("packets_received"),v("video")("packets_lost"),v("video")("bytes_sent"),v("video")("bytes_received"),v("video")("retransmitted_packets_sent"),v("video")("retransmitted_bytes_sent"),v("video")("packets_lost_rate"),v("video")("remote_packets_lost"),v("video")("remote_packets_lost_rate"),v("video")("frames_sent"),v("video")("frames_received"),v("video")("frames_encoded"),v("video")("key_frames_encoded"),v("video")("frames_decoded"),v("video")("key_frames_decoded"),v("video")("video_source_width"),v("video")("video_source_height"),v("video")("video_source_frames_per_second"),v("video")("received_frame_width"),v("video")("received_frame_height"),v("video")("sent_frame_width"),v("video")("sent_frame_height"),v("video")("target_bitrate"),v("video")("inbound_jitter"),v("video")("remote_jitter"),v("video")("remote_fraction_lost"),f.video.quality_limitation_reason==="none"&&(f.video.quality_limitation_reason=c.video.quality_limitation_reason),f},jg=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return l}(l3);(function(o){o.OFFER="offer",o.ANSWER="answer",o.CANDIDATE="candidate"})(Zu||(Zu={}));var or,Gx=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,{payload:f})),"type",Zu.ANSWER),_}return l}(jg),Vx=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,{payload:f})),"type",Zu.CANDIDATE),_}return l}(jg),jx=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,{payload:f})),"type",Zu.OFFER),_}return l}(jg),_p=function(){function o(){ie(this,o)}return se(o,null,[{key:"createOffer",value:function(c,l){return new jx({peerConnectionId:c,sdp:l})}},{key:"createAnswer",value:function(c,l){return new Gx({peerConnectionId:c,sdp:l})}},{key:"createCandidate",value:function(c,l){return new Vx({peerConnectionId:c,candidate:l})}}]),o}(),jI=function(){function o(c){ie(this,o),this._context=c}return se(o,[{key:"_changeState",value:function(c){this._state&&this._state.type===c.type?ae.error(new Error("self-transition is not allowed")):(ae.debug("[".concat(this.name,"] state: ").concat(this._state?this._state.type:"null"," -> ").concat(c.type)),this._state&&this._state.destroy(),this._state=c,this._state.context=this._context,this._state.start())}},{key:"state",get:function(){return this._state}}]),o}(),qI=function(){function o(c){ie(this,o),this._stateMutator=c}return se(o,[{key:"start",value:function(){this._onStart()}},{key:"destroy",value:function(){this._onDestroy()}},{key:"context",set:function(c){this._context=c}}]),o}(),zI=function(){function o(c,l){ie(this,o),this._context=c,this._stateMutator=l}return se(o,[{key:"state",get:function(){return this._stateMutator.state}}]),o}(),Xu=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this,f))._stateMutator=f,_}return l}(qI);(function(o){o.IDLE="idle",o.OFFERING="offering",o.ANSWERING="answering",o.CONNECTED="connected",o.RECONNECTING="reconnecting",o.ICE_RESTART_OFFERING="iceRestartOffering",o.ICE_RESTART_ANSWERING="iceRestartAnswering",o.CLOSED="closed"})(or||(or={}));var qg,qx=function(o){ce(f,o);var c,l=fe(f);function f(_,m){var v;return ie(this,f),qe(je(v=l.call(this,_)),"type",or.ANSWERING),v._stateMutator=_,v._offerCommand=m,v}return se(f,[{key:"_onStart",value:function(){this._context.dispatchEvent("answering"),this._context.createRTCConnection(),this._offerCommand&&this.onOfferReceived(this._offerCommand)}},{key:"_onDestroy",value:function(){}},{key:"onOfferReceived",value:(c=Bn(regeneratorRuntime.mark(function _(m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this._context.setRemoteDescription("offer",m.payload.sdp);case 2:this._context.prepareSessionDescription(),this._context.sendAnswer().catch(function(I){return ae.debug(I)});case 4:case"end":return v.stop()}},_,this)})),function(_){return c.apply(this,arguments)})},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!1)}},{key:"onClose",value:function(){this._stateMutator.toClosed()}}]),f}(Xu),zx=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",or.CLOSED),f}return se(l,[{key:"_onStart",value:function(){this._context.dispatchEvent("closed")}},{key:"_onDestroy",value:function(){}}]),l}(Xu),Kx=function(o){ce(f,o);var c,l=fe(f);function f(_,m){var v;return ie(this,f),qe(je(v=l.call(this,_)),"type",or.CONNECTED),v._stateMutator=_,v._isReconnected=m,v}return se(f,[{key:"_onStart",value:function(){this._context.dispatchEvent("connected")}},{key:"_onDestroy",value:function(){}},{key:"onOfferReceived",value:(c=Bn(regeneratorRuntime.mark(function _(m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:this._stateMutator.toReconnecting(m);case 1:case"end":return v.stop()}},_,this)})),function(_){return c.apply(this,arguments)})},{key:"onIceDisconnected",value:function(){this._stateMutator.toReconnecting()}},{key:"onIceFailed",value:function(){this._context.isDisposable&&this.onClose(),this._context.isInitiator?this._stateMutator.toIceRestartOffering():this._stateMutator.toIceRestartAnswering()}},{key:"onClose",value:function(){this._stateMutator.toClosed()}}]),f}(Xu),Wx=function(o){ce(f,o);var c,l=fe(f);function f(_,m){var v;return ie(this,f),qe(je(v=l.call(this,_)),"type",or.ICE_RESTART_ANSWERING),v._stateMutator=_,v._offerCommand=m,v}return se(f,[{key:"_onStart",value:function(){this._context.dispatchEvent("iceRestartAnswering"),this._offerCommand&&this.onOfferReceived(this._offerCommand)}},{key:"_onDestroy",value:function(){}},{key:"onOfferReceived",value:(c=Bn(regeneratorRuntime.mark(function _(m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this._context.setRemoteDescription("offer",m.payload.sdp);case 2:this._context.sendAnswer().catch(function(I){return ae.debug(I)});case 3:case"end":return v.stop()}},_,this)})),function(_){return c.apply(this,arguments)})},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!0)}},{key:"onClose",value:function(){this._stateMutator.toClosed()}}]),f}(Xu),$x=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",or.ICE_RESTART_OFFERING),f}return se(l,[{key:"_onStart",value:function(){this._context.dispatchEvent("iceRestartOffering"),this._context.sendOffer(!0)}},{key:"_onDestroy",value:function(){}},{key:"onAnswerReceived",value:function(f){this._context.setRemoteDescription("answer",f.payload.sdp)}},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!0)}},{key:"onClose",value:function(){this._stateMutator.toClosed()}}]),l}(Xu),Yx=function(o){ce(f,o);var c,l=fe(f);function f(){var _;ie(this,f);for(var m=arguments.length,v=new Array(m),I=0;I<m;I++)v[I]=arguments[I];return qe(je(_=l.call.apply(l,[this].concat(v))),"type",or.IDLE),_}return se(f,[{key:"_onStart",value:function(){}},{key:"_onDestroy",value:function(){}},{key:"createOffer",value:function(){this._stateMutator.toOffering()}},{key:"onOfferReceived",value:(c=Bn(regeneratorRuntime.mark(function _(m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:this._stateMutator.toAnswering(m);case 1:case"end":return v.stop()}},_,this)})),function(_){return c.apply(this,arguments)})},{key:"onClose",value:function(){this._stateMutator.toClosed()}}]),f}(Xu),Qx=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",or.OFFERING),f}return se(l,[{key:"_onStart",value:function(){this._context.dispatchEvent("offering"),this._context.createRTCConnection(),this._context.prepareSessionDescription()}},{key:"_onDestroy",value:function(){}},{key:"onAnswerReceived",value:function(f){this._context.setRemoteDescription("answer",f.payload.sdp)}},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!1)}},{key:"onClose",value:function(){this._stateMutator.toClosed()}}]),l}(Xu),Zx=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",or.RECONNECTING),m._stateMutator=f,m._offerCommand=_,m}return se(l,[{key:"_onStart",value:function(){this._context.dispatchEvent("reconnecting"),this._offerCommand&&this.onOfferReceived(this._offerCommand)}},{key:"_onDestroy",value:function(){}},{key:"onOfferReceived",value:function(f){this._stateMutator.toIceRestartAnswering(f)}},{key:"onIceConnected",value:function(){this._stateMutator.toConnected(!0)}},{key:"onIceFailed",value:function(){this._context.isDisposable&&this.onClose(),this._context.isInitiator?this._stateMutator.toIceRestartOffering():this._stateMutator.toIceRestartAnswering()}},{key:"onClose",value:function(){this._stateMutator.toClosed()}}]),l}(Xu),Xx=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"toIdle",value:function(){this._changeState(new Yx(this))}},{key:"toOffering",value:function(){this._changeState(new Qx(this))}},{key:"toAnswering",value:function(f){this._changeState(new qx(this,f))}},{key:"toConnected",value:function(f){this._changeState(new Kx(this,f))}},{key:"toReconnecting",value:function(f){this._changeState(new Zx(this,f))}},{key:"toIceRestartOffering",value:function(){this._changeState(new $x(this))}},{key:"toIceRestartAnswering",value:function(f){this._changeState(new Wx(this,f))}},{key:"toClosed",value:function(){this._changeState(new zx(this))}},{key:"state",get:function(){return this._state}},{key:"name",get:function(){return"PeerConnection"}}]),l}(jI),Jx=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this,f,new Xx(f)))._context=f,_._stateMutator.toIdle(),_}return se(l,[{key:"onOfferReceived",value:function(f){ae.verbose("[".concat(this.state.type,"] onOfferReceived"));var _=this.state;switch(_.type){case or.IDLE:case or.ANSWERING:case or.CONNECTED:case or.RECONNECTING:case or.ICE_RESTART_ANSWERING:_.onOfferReceived(f);break;default:ae.error("[".concat(this.state.type,"] onOfferReceived"))}}},{key:"onAnswerReceived",value:function(f){ae.verbose("[".concat(this.state.type,"] onAnswerReceived"));var _=this.state;switch(_.type){case or.OFFERING:case or.ICE_RESTART_OFFERING:_.onAnswerReceived(f);break;default:ae.error("[".concat(this.state.type,"] onAnswerReceived"))}}},{key:"onClose",value:function(){ae.verbose("[".concat(this.state.type,"] onClose"));var f=this.state;switch(f.type){case or.IDLE:case or.OFFERING:case or.ANSWERING:case or.CONNECTED:case or.RECONNECTING:case or.ICE_RESTART_OFFERING:case or.ICE_RESTART_ANSWERING:f.onClose();break;default:ae.error("[".concat(this.state.type,"] onClose"))}}},{key:"createOffer",value:function(){ae.verbose("[".concat(this.state.type,"] createOffer"));var f=this.state;f.type===or.IDLE?f.createOffer():ae.error("[".concat(this.state.type,"] createOffer"))}},{key:"onIceConnected",value:function(){ae.verbose("[".concat(this.state.type,"] onIceConnected"));var f=this.state;switch(f.type){case or.OFFERING:case or.ANSWERING:case or.RECONNECTING:case or.ICE_RESTART_OFFERING:case or.ICE_RESTART_ANSWERING:f.onIceConnected();break;default:ae.error("[".concat(this.state.type,"] onIceConnected"))}}},{key:"onIceDisconnected",value:function(){ae.verbose("[".concat(this.state.type,"] onIceDisconnected"));var f=this.state;f.type===or.CONNECTED?f.onIceDisconnected():ae.error("[".concat(this.state.type,"] onIceDisconnected"))}},{key:"onIceFailed",value:function(){ae.verbose("[".concat(this.state.type,"] onIceFailed"));var f=this.state;switch(f.type){case or.CONNECTED:case or.RECONNECTING:f.onIceFailed();break;default:ae.error("[".concat(this.state.type,"] onIceFailed"))}}},{key:"state",get:function(){return this._stateMutator.state}}]),l}(zI);(function(o){o.RELAY="relay",o.ALL="all"})(qg||(qg={}));var ar,mp=function o(){var c=this;ie(this,o),this.promise=new Promise(function(l,f){c.resolve=l,c.reject=f})},Qc=function(){var o=Bn(regeneratorRuntime.mark(function c(l,f,_){var m,v,I,S,w,G,H,x,V,K=arguments;return regeneratorRuntime.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(m=K.length>3&&K[3]!==void 0&&K[3],v=K.length>4&&K[4]!==void 0?K[4]:{count:0,deferred:new mp},I=v.deferred,S=v.count,!m){te.next=6;break}return I.reject("retry is halted."),te.abrupt("return",I.promise);case 6:return te.prev=6,te.next=9,f();case 9:G=te.sent,S>0&&((w=_.onRecover)===null||w===void 0||w.call(_)),I.resolve(G),te.next=23;break;case 14:if(te.prev=14,te.t0=te.catch(6),(H=_.onError)===null||H===void 0||H.call(_,te.t0),!((x=l.calcTimeout(S+1))>=0)){te.next=22;break}return(V=_.onRetrial)===null||V===void 0||V.call(_,S+1,te.t0),setTimeout(function(){Qc(l,f,_,m,{count:S+1,deferred:I})},x),te.abrupt("return",I.promise);case 22:I.reject(te.t0);case 23:return te.abrupt("return",I.promise);case 24:case"end":return te.stop()}},c,null,[[6,14]])}));return function(c,l,f){return o.apply(this,arguments)}}(),KI=function(){function o(){ie(this,o)}return se(o,[{key:"calcTimeout",value:function(c){switch(c){case 1:return 1e3;case 2:return 2e3;case 3:return 3e3;default:return-1}}}]),o}(),gp=function(){function o(c,l,f){ie(this,o),this.interval=c,this.noise=l,this.maxRetrial=f}return se(o,[{key:"calcTimeout",value:function(c){return c>this.maxRetrial?-1:this.interval+(Math.random()-.5)*this.noise*2}}]),o}(),WI=function(o){ce(v,o);var c,l,f,_,m=fe(v);function v(I,S,w,G,H,x,V,K){var te;return ie(this,v),(te=m.call(this))._ctx=I,te.id=S,te._signalingClient=w,te._localStream=G,te._isInitiator=H,te._turnCredential=x,te._mediaDirections=V,te._isDisposable=K,te._stateMachine=new Jx({dispatchEvent:te._dispatchEvent.bind(je(te)),isInitiator:te._isInitiator,setRemoteDescription:te._setRemoteDescription.bind(je(te)),sendAnswer:te._sendAnswer.bind(je(te)),sendOffer:te._sendOffer.bind(je(te)),createRTCConnection:te._createRTCConnection.bind(je(te)),prepareSessionDescription:te._prepareSessionDescription.bind(je(te)),isDisposable:te._isDisposable}),G&&G.on("streamChanged",function(me){return te.onLocalStream(me)}),te._halts=[],te}return se(v,[{key:"onEvent",value:function(I){switch(I.type){case Zu.CANDIDATE:return void this._receiveCandidate(I);case Zu.OFFER:this._stateMachine.onOfferReceived(I);break;case Zu.ANSWER:this._stateMachine.onAnswerReceived(I);break;default:ae.error(new Error("unhandled call event ".concat(I)))}}},{key:"createOffer",value:function(){this._stateMachine.createOffer()}},{key:"close",value:function(){this._halts.forEach(function(I){return I()}),this._closeRTCConnection(),this._stateMachine.onClose()}},{key:"onLocalStream",value:function(I){if(this._rtcConnection){var S,w=Hr(I.getTracks());try{for(w.s();!(S=w.n()).done;){var G=S.value;this._replaceTrack(G)}}catch(H){w.e(H)}finally{w.f()}}}},{key:"getCandidateInfo",value:(_=Bn(regeneratorRuntime.mark(function I(){return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",Fx(this.rtcConnection));case 1:case"end":return S.stop()}},I,this)})),function(){return _.apply(this,arguments)})},{key:"getStatsLog",value:(f=Bn(regeneratorRuntime.mark(function I(){return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",Bx(this.rtcConnection));case 1:case"end":return S.stop()}},I,this)})),function(){return f.apply(this,arguments)})},{key:"_replaceTrack",value:function(I){var S,w=Hr(this._rtcConnection.getSenders());try{for(w.s();!(S=w.n()).done;){var G=S.value;G.track&&G.track.kind===I.kind&&G.replaceTrack(I)}}catch(H){w.e(H)}finally{w.f()}}},{key:"_createRTCConnection",value:function(){var I,S=this;this._turnCredential&&(I={iceServers:[{username:this._turnCredential.username,credential:this._turnCredential.password,urls:this._turnCredential.turnUrls}],iceTransportPolicy:this._turnCredential.transportPolicy||qg.ALL});var w=new RTCPeerConnection(I);w.onnegotiationneeded=function(){S._sendOffer(!1)},w.onicecandidate=function(G){var H,x;G.candidate&&((H=(x=S._signalingClient).sendCandidate)===null||H===void 0||H.call(x,G.candidate))},w.onconnectionstatechange=function(){return S._handleConnectionStateChange(w)},w.oniceconnectionstatechange=function(){return S._handleIceConnectionStateChange(w)},w.ontrack=function(G){return S._onRemoteTrack(G)},this._rtcConnection=w}},{key:"_closeRTCConnection",value:function(){this._rtcConnection&&(this._rtcConnection.onnegotiationneeded=null,this._rtcConnection.onicecandidate=null,this._rtcConnection.oniceconnectionstatechange=null,this._rtcConnection.onconnectionstatechange=null,this._rtcConnection.close(),this._rtcConnection=null,delete this._remoteStream)}},{key:"_prepareSessionDescription",value:function(){var I=this._mediaDirections,S=I.audio,w=I.video,G={sendrecv:[],sendonly:[],recvonly:[],none:[]};G[S].push("audio"),G[w].push("video"),G.sendrecv.length&&this._addTracks(G.sendrecv),G.sendonly.length&&this._addSendOnlyTransceivers(G.sendonly),G.recvonly.length&&this._addReceiveOnlyTransceivers(G.recvonly)}},{key:"_addTracks",value:function(I){var S=this;ae.debug("_addTracks()");var w=this._localStream.localStream;w.getTracks().forEach(function(G){I.includes(G.kind)&&S._rtcConnection.addTrack(G,w)})}},{key:"_addReceiveOnlyTransceivers",value:function(I){var S=this;I.forEach(function(w){S._rtcConnection.addTransceiver(w,{direction:"recvonly"})})}},{key:"_addSendOnlyTransceivers",value:function(I){var S=this,w=this._localStream.localStream;I.forEach(function(G){w.getTracks().forEach(function(H){H.kind===G&&S._rtcConnection.addTransceiver(H,{direction:"sendonly",streams:[w]})})})}},{key:"_setRemoteDescription",value:function(I,S){var w=new RTCSessionDescription({type:I,sdp:S});return this._rtcConnection.setRemoteDescription(w)}},{key:"_sendOffer",value:(l=Bn(regeneratorRuntime.mark(function I(S){var w,G,H,x,V=this;return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return w={iceRestart:S||!1},K.next=3,this._rtcConnection.createOffer(w);case 3:return G=K.sent,K.next=6,this._rtcConnection.setLocalDescription(G);case 6:return H=function(){return V._signalingClient.sendOfferSdp(V._rtcConnection.localDescription)},x=!1,this._halts.push(function(){x=!0}),K.abrupt("return",Qc(new gp(2500,1e3,12),H,{onError:function(te){ae.warning("Failed to send offer command",te)}},x));case 10:case"end":return K.stop()}},I,this)})),function(I){return l.apply(this,arguments)})},{key:"_sendAnswer",value:(c=Bn(regeneratorRuntime.mark(function I(){var S,w,G,H=this;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,this._rtcConnection.createAnswer();case 2:return(S=x.sent).sdp=S.sdp.replace("actpass","active"),x.next=6,this._rtcConnection.setLocalDescription(S);case 6:return w=function(){return H._signalingClient.sendAnswerSdp(H._rtcConnection.localDescription)},G=!1,this._halts.push(function(){G=!0}),x.abrupt("return",Qc(new gp(2500,1e3,12),w,{onError:function(V){ae.warning("Failed to send answer command",V)}},G));case 10:case"end":return x.stop()}},I,this)})),function(){return c.apply(this,arguments)})},{key:"_handleIceConnectionStateChange",value:function(I){switch(ae.verbose("[".concat(this._state.type,"] iceConnectionState ").concat(I.iceConnectionState)),I.iceConnectionState){case"connected":this._stateMachine.onIceConnected();break;case"disconnected":this._stateMachine.onIceDisconnected();break;case"failed":this._stateMachine.onIceFailed(),this._dispatchEvent("iceFailed")}}},{key:"_handleConnectionStateChange",value:function(I){I.connectionState==="failed"&&(this._stateMachine.onIceFailed(),this._dispatchEvent("iceFailed"))}},{key:"_receiveCandidate",value:function(I){var S=I.payload.candidate;this._rtcConnection.addIceCandidate({sdpMLineIndex:S.sdpMLineIndex,sdpMid:S.sdpMid,candidate:S.sdp}).catch(function(w){ae.error(w)})}},{key:"_onRemoteTrack",value:function(I){this._remoteStream=I.streams[0],this._dispatchEvent("remoteStream",this._remoteStream)}},{key:"_state",get:function(){return this._stateMachine.state}},{key:"rtcConnection",get:function(){return this._rtcConnection}},{key:"remoteStream",get:function(){return this._remoteStream}},{key:"signalingClient",get:function(){return this._signalingClient}}]),v}(zi),eU=function(){function o(){ie(this,o)}var c;return se(o,[{key:"addStatsLog",value:function(l){this._accumulated=GI(l,this._accumulated)}},{key:"getAccumulatedStats",value:(c=Bn(regeneratorRuntime.mark(function l(f){var _;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,f.getStatsLog();case 2:return _=m.sent,m.abrupt("return",GI(_,this._accumulated));case 4:case"end":return m.stop()}},l,this)})),function(l){return c.apply(this,arguments)})}]),o}(),nU=function(o){ce(f,o);var c,l=fe(f);function f(_,m){var v;return ie(this,f),qe(je(v=l.call(this)),"_peerConnections",new Map),qe(je(v),"_unhandledCommands",[]),v._ctx=_,v._mediaDirections=m,v._statsLogAccumulator=new eU,v}return se(f,[{key:"_activePC",get:function(){return this._peerConnections.get(this._activePCId)},set:function(_){this._peerConnections.has(_.id)||this._addPC(_),this._activePCId=_.id}},{key:"_preparingPC",get:function(){return this._peerConnections.get(this._preparingPCId)},set:function(_){this._peerConnections.has(_.id)||this._addPC(_),this._preparingPCId=_.id}},{key:"activePeerConnection",get:function(){return this._activePC}}]),se(f,[{key:"createPeerConnection",value:function(_,m,v,I,S){ae.debug("Create new peer connection");var w=new WI(this._ctx,_,m,v,I,S,this._mediaDirections,!1);return this._activePC?(this._replacePreparing(w,I),this._dispatchUnhandledCommands(w),w):(this._activePC=w,this._dispatchEvent("initialized"),this._dispatchUnhandledCommands(w),w)}},{key:"createOffer",value:function(){this._activePC&&this._activePC.createOffer()}},{key:"close",value:function(){this._deactivatePreparing(),this._deactivateActive()}},{key:"onEvent",value:function(_){var m,v=(m=_.payload.peerConnectionId)!==null&&m!==void 0?m:void 0,I=this._peerConnections.get(v);this._isActive(v)||this._isPreparing(v)?I.onEvent(_):this._isInactive(v)||this._dispatchOnCreation(_)}},{key:"getStatsLog",value:(c=Bn(regeneratorRuntime.mark(function _(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this._activePC){m.next=2;break}return m.abrupt("return",void 0);case 2:return m.abrupt("return",this._statsLogAccumulator.getAccumulatedStats(this._activePC));case 3:case"end":return m.stop()}},_,this)})),function(){return c.apply(this,arguments)})},{key:"_addPC",value:function(_){this._peerConnections.set(_.id,_)}},{key:"_isActive",value:function(_){return _===this._activePCId}},{key:"_isPreparing",value:function(_){return _===this._preparingPCId}},{key:"_isInactive",value:function(_){return!this._isActive(_)&&!this._isPreparing(_)&&!!this._peerConnections.get(_)}},{key:"_deactivateActive",value:function(){ae.debug("Close active pc if exist"),this._activePC&&(this._activePC.removeAllEventListeners(),this._activePC.close(),delete this._activePCId)}},{key:"_activatePreparing",value:function(){var _=this;if(ae.debug("Activate preparing pc if exist"),this._preparingPC){var m=this._activePC;this._activePC=this._preparingPC,delete this._preparingPCId,this._dispatchEvent("replaced"),m.removeAllEventListeners(),m.getStatsLog().then(function(v){_._statsLogAccumulator.addStatsLog(v),m.close()})}}},{key:"_deactivatePreparing",value:function(){ae.debug("Close preparing pc if exist"),this._preparingPC&&(this._preparingPC.removeAllEventListeners(),this._preparingPC.close(),delete this._preparingPCId)}},{key:"_replacePreparing",value:function(_,m){var v=this;ae.debug("Create preparing peer connection"),this._deactivatePreparing(),this._preparingPC=_,this._preparingPC.once("connected",function(){setTimeout(function(){v._activatePreparing()},2e3)}),m&&this._preparingPC.createOffer()}},{key:"_dispatchUnhandledCommands",value:function(_){this._unhandledCommands.filter(function(m){return m.payload.peerConnectionId===_.id}).forEach(function(m){return _.onEvent(m)}),this._unhandledCommands=this._unhandledCommands.filter(function(m){return m.payload.peerConnectionId!==_.id})}},{key:"_dispatchOnCreation",value:function(_){this._unhandledCommands.push(_)}}]),f}(zi),$I=function(){function o(c){ie(this,o),this._requests=new Map,this.timeoutTime=c}return se(o,[{key:"has",value:function(c){return this._requests.has(c)}},{key:"get",value:function(c){return this._requests.get(c)}},{key:"register",value:function(c){if(!c)throw new Error("invalid request id");if(this._requests.has(c))throw new Error("duplicate requests");var l=new mp;return this._requests.set(c,{deferred:l,timer:this._createTimeoutTimer(c)}),l}},{key:"unregister",value:function(c){if(!this._requests.has(c))return null;var l=this._requests.get(c),f=l.timer,_=l.deferred;return clearTimeout(f),this._requests.delete(c),_}},{key:"_createTimeoutTimer",value:function(c){var l=this;return setTimeout(function(){l.unregister(c).reject(new Jt(De.ERR_NO_RESPONSE_DUE_TO_TIMEOUT))},this._getTimeoutTime())}},{key:"rejectAll",value:function(c){var l,f=Hr(this._requests.keys());try{for(f.s();!(l=f.n()).done;){var _=l.value,m=this._requests.get(_);clearTimeout(m.timer),m.deferred.reject(c)}}catch(v){f.e(v)}finally{f.f()}this._requests.clear()}},{key:"_getTimeoutTime",value:function(){return this.timeoutTime}}]),o}(),tU=function(){function o(_,m,v,I){ie(this,o),qe(this,"_timeoutTime",6e4),this._ctx=_,this._participantId=m,this._mediaDirections=v,this._endpointId=I,this._requestMap=new $I(this._timeoutTime)}var c,l,f;return se(o,[{key:"sendOfferSdp",value:(f=Bn(regeneratorRuntime.mark(function _(m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this._endpointId){v.next=5;break}return v.next=3,this._sendOfferAndUnregisterCreateEndpointRequest(m);case 3:v.next=7;break;case 5:return v.next=7,this._sendOfferAndUnregisterPutEndpointRequest(m);case 7:case"end":return v.stop()}},_,this)})),function(_){return f.apply(this,arguments)})},{key:"_sendOfferAndUnregisterCreateEndpointRequest",value:(l=Bn(regeneratorRuntime.mark(function _(m){var v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return v=this._requestMap.unregister("".concat(this._participantId,":create-endpoint-request")),S.prev=1,S.next=4,this._sendCreateEndpoint(m);case 4:return I=S.sent,v&&v.resolve(I),S.abrupt("return",I);case 9:throw S.prev=9,S.t0=S.catch(1),v&&v.reject(S.t0),S.t0;case 13:case"end":return S.stop()}},_,this,[[1,9]])})),function(_){return l.apply(this,arguments)})},{key:"_sendOfferAndUnregisterPutEndpointRequest",value:(c=Bn(regeneratorRuntime.mark(function _(m){var v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return v=this._requestMap.unregister("".concat(this._participantId,":put-endpoint-request")),S.prev=1,S.next=4,this._sendPutEndpoint(m);case 4:return I=S.sent,v&&v.resolve(I),S.abrupt("return",I);case 9:throw S.prev=9,S.t0=S.catch(1),v&&v.reject(S.t0),S.t0;case 13:case"end":return S.stop()}},_,this,[[1,9]])})),function(_){return c.apply(this,arguments)})},{key:"registerCreateEndpointRequest",value:function(){if(ae.debug("registerCreateEndpointRequest()"),this._endpointId)throw new Error("Cannot register create endpoint request on endpoint recycle");return this._requestMap.register("".concat(this._participantId,":create-endpoint-request"))}},{key:"registerPutEndpointRequest",value:function(){if(ae.debug("registerPutEndpointRequest()"),!this._endpointId)throw new Error("Cannot register put endpoint request without endpoint id");return this._requestMap.register("".concat(this._participantId,":put-endpoint-request"))}},{key:"_sendCreateEndpoint",value:function(_){var m=qr.createCreateEndpoint(this._ctx.roomId,this._participantId,_.sdp,this._mediaDirections);return this._ctx.sender.send(m)}},{key:"_sendPutEndpoint",value:function(_){var m=qr.createPutEndpoint(this._ctx.roomId,this._participantId,this._endpointId,_.sdp);return this._ctx.sender.send(m)}}]),o}(),Ju=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this,f))._stateMutator=f,_}return l}(qI);(function(o){o.IDLE="idle",o.OFFERING="offering",o.ESTABLISHED="established",o.CONNECTED="connected",o.DISCONNECTED="disconnected",o.RECONNECTING="reconnecting",o.RELEASING="releasing",o.CLOSED="closed"})(ar||(ar={}));var rU=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",ar.CLOSED),f}return se(l,[{key:"_onStart",value:function(){this._context.dispatchEvent("closed")}},{key:"_onDestroy",value:function(){}}]),l}(Ju),iU=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,f)),"type",ar.CONNECTED),_._stateMutator=f,_}return se(l,[{key:"_onStart",value:function(){var f=this._context.reconnectCount>0;this._context.dispatchEvent("connected",f)}},{key:"_onDestroy",value:function(){}},{key:"onICEFailed",value:function(){this._stateMutator.toDisconnected(!0)}},{key:"onAttach",value:function(){this._context.requestAttach()}},{key:"onRelease",value:function(){this._stateMutator.toReleasing()}},{key:"onExit",value:function(){this._stateMutator.toClosed()}}]),l}(Ju),aU=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this,f)),"type",ar.ESTABLISHED),v._stateMutator=f,v._sdp=_,v._hasPendingAttach=m,v}return se(l,[{key:"_onStart",value:function(){this._context.dispatchEvent("established"),this._context.setRemoteDescription(this._sdp),this._hasPendingAttach&&this.onAttach()}},{key:"_onDestroy",value:function(){}},{key:"onPCConnected",value:function(){this._stateMutator.toConnected()}},{key:"onICEFailed",value:function(){this._stateMutator.toDisconnected(!1)}},{key:"onAttach",value:function(){this._context.requestAttach()}},{key:"onRelease",value:function(){this._stateMutator.toReleasing()}},{key:"onExit",value:function(){this._stateMutator.toClosed()}}]),l}(Ju),sU=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",ar.IDLE),f}return se(l,[{key:"_onStart",value:function(){this._context.dispatchEvent("idle"),this._stateMutator.toOffering()}},{key:"_onDestroy",value:function(){}},{key:"onRelease",value:function(){this._stateMutator.toReleasing()}},{key:"onExit",value:function(){this._stateMutator.toClosed()}}]),l}(Ju),uU=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",ar.RELEASING),f}return se(l,[{key:"_onStart",value:function(){this._context.dispatchEvent("releasing"),this._context.closePeerConnection(),this._context.endpoint.id&&this._context.requestRelease()}},{key:"_onDestroy",value:function(){}},{key:"onEndpointRequestSucceeded",value:function(){this._context.requestRelease()}},{key:"onEndpointRequestFailed",value:function(){this._stateMutator.toClosed()}},{key:"onReleased",value:function(){this._stateMutator.toClosed()}},{key:"onExit",value:function(){this._stateMutator.toClosed()}}]),l}(Ju),oU=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,f)),"type",ar.OFFERING),_._stateMutator=f,_}return se(l,[{key:"_onStart",value:function(){this._request()}},{key:"_onDestroy",value:function(){this._requestTimeout&&clearTimeout(this._requestTimeout),delete this._requestTimeout}},{key:"_request",value:function(){this._context.createSession(),this._context.requestCreateOrPutEndpoint()}},{key:"onICEFailed",value:function(){this._stateMutator.toDisconnected(!1)}},{key:"onEndpointRequestSucceeded",value:function(f){this._stateMutator.toEstablished(f,this._hasPendingAttach)}},{key:"onEndpointRequestFailed",value:function(){this._stateMutator.toDisconnected(!1)}},{key:"onAttach",value:function(){this._hasPendingAttach=!0}},{key:"onRelease",value:function(){this._stateMutator.toReleasing()}},{key:"onExit",value:function(){this._stateMutator.toClosed()}}]),l}(Ju),lU=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this,f)),"type",ar.DISCONNECTED),m._stateMutator=f,m.shouldDispatchEvent=_,m}return se(l,[{key:"_onStart",value:function(){this.shouldDispatchEvent&&this._context.dispatchEvent("disconnected"),this._stateMutator.toReconnecting()}},{key:"_onDestroy",value:function(){}},{key:"onRelease",value:function(){this._stateMutator.toReleasing()}},{key:"onExit",value:function(){this._stateMutator.toClosed()}}]),l}(Ju),dU=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,f)),"type",ar.RECONNECTING),_._stateMutator=f,_}return se(l,[{key:"_onStart",value:function(){var f=this;this._context.reconnectCount+=1,setTimeout(function(){f._stateMutator.toOffering()},5e3+1e3*Math.random())}},{key:"_onDestroy",value:function(){}},{key:"onRelease",value:function(){this._stateMutator.toReleasing()}},{key:"onExit",value:function(){this._stateMutator.toClosed()}}]),l}(Ju),cU=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"toIdle",value:function(){this._changeState(new sU(this))}},{key:"toOffering",value:function(){this._changeState(new oU(this))}},{key:"toEstablished",value:function(f,_){this._changeState(new aU(this,f,_))}},{key:"toConnected",value:function(){this._changeState(new iU(this))}},{key:"toDisconnected",value:function(f){this._changeState(new lU(this,f))}},{key:"toReconnecting",value:function(){this._changeState(new dU(this))}},{key:"toReleasing",value:function(){this._changeState(new uU(this))}},{key:"toClosed",value:function(){this._changeState(new rU(this))}},{key:"state",get:function(){return this._state}},{key:"name",get:function(){return"Endpoint"}}]),l}(jI),fU=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this,f,new cU(f)))._context=f,_._stateMutator.toIdle(),_}return se(l,[{key:"onEndpointRequestSucceeded",value:function(f){ae.verbose("[".concat(this.state.type,"] onEndpointRequestSucceeded"));var _=this.state;switch(_.type){case ar.OFFERING:_.onEndpointRequestSucceeded(f);break;case ar.RELEASING:_.onEndpointRequestSucceeded();break;default:ae.error("[".concat(this.state.type,"] onEndpointRequestSucceeded"))}}},{key:"onEndpointRequestFailed",value:function(){ae.verbose("[".concat(this.state.type,"] onEndpointCreateFailed"));var f=this.state;switch(f.type){case ar.OFFERING:case ar.RELEASING:f.onEndpointRequestFailed();break;default:ae.error("[".concat(this.state.type,"] onEndpointCreateFailed"))}}},{key:"onICEFailed",value:function(){ae.verbose("[".concat(this.state.type,"] onICEFailed"));var f=this.state;switch(f.type){case ar.OFFERING:case ar.ESTABLISHED:case ar.CONNECTED:f.onICEFailed();break;default:ae.error("[".concat(this.state.type,"] onICEFailed"))}}},{key:"onPCConnected",value:function(){ae.verbose("[".concat(this.state.type,"] onPCConnected"));var f=this.state;f.type===ar.ESTABLISHED?f.onPCConnected():ae.error("[".concat(this.state.type,"] onPCConnected"))}},{key:"onAttach",value:function(){ae.verbose("[".concat(this.state.type,"] onAttach"));var f=this.state;switch(f.type){case ar.OFFERING:case ar.ESTABLISHED:case ar.CONNECTED:f.onAttach();break;default:ae.error("[".concat(this.state.type,"] onAttach"))}}},{key:"onRelease",value:function(){ae.verbose("[".concat(this.state.type,"] onRelease"));var f=this.state;switch(f.type){case ar.IDLE:case ar.OFFERING:case ar.ESTABLISHED:case ar.CONNECTED:case ar.DISCONNECTED:case ar.RECONNECTING:f.onRelease();break;default:ae.error("[".concat(this.state.type,"] onRelease"))}}},{key:"onReleased",value:function(){ae.verbose("[".concat(this.state.type,"] onReleased"));var f=this.state;f.type===ar.RELEASING?f.onReleased():ae.error("[".concat(this.state.type,"] onReleased"))}},{key:"onExit",value:function(){ae.verbose("[".concat(this.state.type,"] onExit"));var f=this.state;switch(f.type){case ar.RELEASING:case ar.IDLE:case ar.CONNECTED:case ar.ESTABLISHED:case ar.OFFERING:case ar.DISCONNECTED:case ar.RECONNECTING:f.onExit();break;default:ae.error("[".concat(this.state.type,"] onExit"))}}},{key:"state",get:function(){return this._stateMutator.state}}]),l}(zI),hU=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),qe(je(v=c.call(this)),"tmpId",dp()),qe(je(v),"_createSession",function(){switch(ae.debug("_createSession()"),v.type){case"master":v._createMasterSession();break;case"viewer":v._createViewerSession();break;default:ae.error("Not supported endpoint type : ",v.type)}}),qe(je(v),"_closePeerConnection",function(){var I,S;ae.debug("_closePeerConnection()"),(I=v._pc)===null||I===void 0||I.removeAllEventListeners(),(S=v._pc)===null||S===void 0||S.close(),v._pc=null}),qe(je(v),"_requestCreateOrPutEndpoint",function(){ae.debug("_requestCreateEndpoint()");var I,S=v._pc;I=v.id?S.signalingClient.registerPutEndpointRequest():S.signalingClient.registerCreateEndpointRequest(),S.createOffer(),I.promise.then(function(w){v.id=w.payload.endpointId,v._stateMachine.onEndpointRequestSucceeded(w.payload.sdp)}).catch(function(w){ae.error("Endpoint request failed",w),v._stateMachine.onEndpointRequestFailed()})}),qe(je(v),"_requestAttach",function(){var I=v.attachedTo;Qc(new gp(5e3,1e3,8),function(){return v._sendAttach(I.id)},{onError:function(S){ae.error("Fail attach endpoint endpointId = ".concat(v.id,", to = ").concat(I.id," ErrorCode = ").concat(S.code))}}).then(function(){v._dispatchEvent("attached",I)})}),qe(je(v),"_requestRelease",function(){ae.debug("_requestRelease()"),v._sendReleaseEndpoint().then(function(){v._stateMachine.onReleased()}).catch(function(I){ae.error("Release request failed",I),v._stateMachine.onReleased()})}),qe(je(v),"_setRemoteDescription",function(I){ae.debug("_setRemoteDescription()");var S=v._pc,w=_p.createAnswer(void 0,I);S.onEvent(w),S.once("connected",function(){v._stateMachine.onPCConnected(),v._sendConnected()}),S.once("iceFailed",function(){v._stateMachine.onICEFailed()})}),v._ctx=f,v._collection=_,v.type=m,v._stateMachine=new fU({endpoint:je(v),dispatchEvent:v._dispatchEvent.bind(je(v)),createSession:v._createSession,requestCreateOrPutEndpoint:v._requestCreateOrPutEndpoint,setRemoteDescription:v._setRemoteDescription,closePeerConnection:v._closePeerConnection,requestAttach:v._requestAttach,requestRelease:v._requestRelease,trialCount:0,reconnectCount:0}),v}return se(l,[{key:"attach",value:function(f){ae.debug("attach()"),f.viewerEndpoint=this,this.attachedTo=f,this._stateMachine.onAttach()}},{key:"release",value:function(){ae.debug("release()"),this._stateMachine.onRelease()}},{key:"exit",value:function(){ae.debug("exit()"),this._closePeerConnection(),this._stateMachine.onExit()}},{key:"_createMasterSession",value:function(){ae.debug("_createMasterSession()"),this._pc&&this._closePeerConnection(),this._createPeerConnection(this._masterSessionDirection,this._localParticipant.localStream)}},{key:"_createViewerSession",value:function(){ae.debug("_createViewerSession()"),this._pc&&this._closePeerConnection(),this._createPeerConnection(this._viewerSessionDirection,void 0)}},{key:"_createPeerConnection",value:function(f,_){var m=this;ae.debug("_createPeerConnection()");var v=new tU(this._ctx,this._localParticipant.id,f,this.id);this._pc=new WI(this._ctx,void 0,v,_,!0,void 0,f,!0),this._dispatchEvent("pcChanged",this._pc),this._pc.on("remoteStream",function(I){m._dispatchEvent("remoteStream",I)})}},{key:"_sendConnected",value:function(){var f=qr.createConnected(this._ctx.roomId,this._localParticipant.id,this.id);return this._ctx.sender.send(f)}},{key:"_sendReleaseEndpoint",value:function(){var f=qr.createReleaseEndpoint(this._ctx.roomId,this._localParticipant.id,this.id);return this._ctx.sender.sendWithRetry(f)}},{key:"_sendAttach",value:function(f){var _=qr.createAttach(this._ctx.roomId,this._localParticipant.id,this.id,f);return this._ctx.sender.sendWithRetry(_,new KI)}},{key:"remoteStream",get:function(){var f;return(f=this._pc)===null||f===void 0?void 0:f.remoteStream}},{key:"_state",get:function(){return this._stateMachine.state}},{key:"_localParticipant",get:function(){return this._collection.localParticipant}},{key:"_masterSessionDirection",get:function(){switch(this._ctx.roomType){case Ra.SMALL_ROOM_FOR_AUDIO_ONLY:return{audio:"sendonly",video:"none"};case Ra.LARGE_ROOM_FOR_AUDIO_ONLY:return{audio:"sendrecv",video:"none"};case Ra.SMALL_ROOM_FOR_VIDEO:return{audio:"sendonly",video:"sendonly"};case Ra.LARGE_ROOM_FOR_VIDEO:return{audio:"sendrecv",video:"sendonly"};default:return ae.error("Not supported room type : ",this._ctx.roomType),{audio:"sendonly",video:"sendonly"}}}},{key:"_viewerSessionDirection",get:function(){switch(this._ctx.roomType){case Ra.SMALL_ROOM_FOR_AUDIO_ONLY:return{audio:"recvonly",video:"none"};case Ra.LARGE_ROOM_FOR_AUDIO_ONLY:return{audio:"none",video:"none"};case Ra.SMALL_ROOM_FOR_VIDEO:return{audio:"recvonly",video:"recvonly"};case Ra.LARGE_ROOM_FOR_VIDEO:return{audio:"none",video:"recvonly"};default:return ae.error("Not supported room type : ",this._ctx.roomType),{audio:"recvonly",video:"recvonly"}}}}]),l}(zi),pU=function(){function o(c,l){ie(this,o),qe(this,"_endpoints",new Map),this._ctx=c,this._collection=l}return se(o,[{key:"getMaster",value:function(){return Array.from(this._endpoints.values()).find(function(c){return c.type==="master"})}},{key:"getViewers",value:function(){return Array.from(this._endpoints.values()).filter(function(c){return c.type==="viewer"})}},{key:"exit",value:function(){var c,l=Hr(this._endpoints.values());try{for(l.s();!(c=l.n()).done;)c.value.exit()}catch(f){l.e(f)}finally{l.f()}}},{key:"releaseEndpoint",value:function(c){c.release(),c.removeAllEventListeners()}},{key:"createMaster",value:function(){return ae.debug("_createSendSession()"),this._createEndpoint("master")}},{key:"createViewer",value:function(){return ae.debug("_createRecvSession()"),this._createEndpoint("viewer")}},{key:"_createEndpoint",value:function(c){var l=this,f=new hU(this._ctx,this._collection,c);return this._endpoints.set(f.tmpId,f),f.once("established",function(){l._endpoints.delete(f.tmpId),l._endpoints.set(f.id,f)}),f.once("closed",function(){l._endpoints.delete(f.id)}),f}}]),o}(),YI=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this)),"_unsubscribes",[]),m._ctx=f,m._collection=_,m._endpointManager=new pU(f,_),m._registerParticipantCollectionListeners(),m}return se(l,[{key:"_registerParticipantCollectionListeners",value:function(){var f=this;this._unsubscribes.length&&this._unregisterParticipantCollectionListeners(),this._unsubscribes=[this._collection.on("entered",function(_){return f._onParticipantEntered(_)}),this._collection.on("connected",function(_){return f._onParticipantConnected(_)}),this._collection.on("exited",function(_){return f._onParticipantExited(_)})]}},{key:"_unregisterParticipantCollectionListeners",value:function(){this._unsubscribes.forEach(function(f){return f()}),this._unsubscribes=[]}},{key:"_clearParticipantToEndpoint",value:function(){this._collection.remoteParticipants.forEach(function(f){f.viewerEndpoint=null})}},{key:"onSelfEntered",value:function(){var f=this;ae.debug("onSelfEntered()");var _=this._endpointManager.createMaster();this._localParticipant.masterEndpoint=_,_.on("connected",function(m){if(f._dispatchEvent("localParticipantConnected",f._localParticipant,m),m){f._onEndpointReconnected(_);var v,I=Hr(f._endpointManager.getViewers());try{for(I.s();!(v=I.n()).done;){var S=v.value;f._onEndpointReconnected(S)}}catch(w){I.e(w)}finally{I.f()}}}),_.on("disconnected",function(){f._dispatchEvent("localParticipantDisconnected",f._localParticipant)})}},{key:"exit",value:function(){ae.debug("exit()"),this._unregisterParticipantCollectionListeners(),this._clearParticipantToEndpoint(),this._endpointManager.exit()}},{key:"_onEndpointReconnected",value:function(f){ae.debug("_remotePCChanged(endpointId: ".concat(f.id,")"))}},{key:"_onParticipantEntered",value:function(f){ae.debug("_onParticipantEntered(id: ".concat(f.id,")"))}},{key:"_onParticipantConnected",value:function(f){ae.debug("_onParticipantConnected(id : ".concat(f.id,")"))}},{key:"_onParticipantExited",value:function(f){ae.debug("_onParticipantExited(id : ".concat(f.id,")"));var _=f.viewerEndpoint;f.viewerEndpoint=null,_&&this._endpointManager.releaseEndpoint(_)}},{key:"_updateLocalResolution",value:function(f){this._localParticipant.updateResolution(f)}},{key:"_localParticipant",get:function(){return this._collection.localParticipant}}]),l}(zi),ta=function(){function o(c,l){ie(this,o),this.key=c,this.value=l}return se(o,[{key:"toString",value:function(){return this.key}},{key:"equals",value:function(c){return this.value.width===c.value.width&&this.value.height===c.value.height}}]),o}();qe(ta,"_720P",new ta("_720P",{width:1280,height:720})),qe(ta,"_540P",new ta("_540P",{width:960,height:540})),qe(ta,"_480P",new ta("_480P",{width:848,height:480})),qe(ta,"_360P",new ta("_360P",{width:640,height:360}));var zg=ta._720P,_U=In.indexOf,QI=[].indexOf,ZI=!!QI&&1/[1].indexOf(1,-0)<0,mU=oe("indexOf"),gU=dt("indexOf",{ACCESSORS:!0,1:0});Fn({target:"Array",proto:!0,forced:ZI||!mU||!gU},{indexOf:function(o){return ZI?QI.apply(this,arguments)||0:_U(this,o,arguments.length>1?arguments[1]:void 0)}});var XI=function(o){return function(c,l,f,_){At(l);var m=zn(c),v=T(m),I=Cn(m.length),S=o?I-1:0,w=o?-1:1;if(f<2)for(;;){if(S in v){_=v[S],S+=w;break}if(S+=w,o?S<0:I<=S)throw TypeError("Reduce of empty array with no initial value")}for(;o?S>=0:I>S;S+=w)S in v&&(_=l(_,v[S],S,m));return _}},vU={left:XI(!1),right:XI(!0)}.left,EU=oe("reduce"),yU=dt("reduce",{1:0});Fn({target:"Array",proto:!0,forced:!EU||!yU||!xs&&Cd>79&&Cd<83},{reduce:function(o){return vU(this,o,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Kg,eo,Jo,Zc,vp,Ep,bU=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),qe(je(m=c.call(this)),"hasVideoPermission",!1),m._streamManger=f,m.constraints=_,m}return se(l,[{key:"dispose",value:function(){var f;this.removeAllEventListeners(),(f=this.onDisposed)===null||f===void 0||f.call(this)}},{key:"streamChanged",value:function(f){this._dispatchEvent("streamChanged",f)}},{key:"audioOutputChanged",value:function(){this._dispatchEvent("audioOutputChanged")}},{key:"stream",get:function(){return this._streamManger.stream}}]),l}(zi),JI=function(o,c){c.audio&&o.getAudioTracks().length===0&&o.addTrack(function(){Kg||(Kg=new(window.AudioContext||window.webkitAudioContext));var l=Kg;eo=l.createOscillator();var f=l.createMediaStreamDestination(),_=l.createGain();return _.gain.setValueAtTime(0,l.currentTime),eo.connect(_).connect(f),eo.start(),vp=f.stream.getAudioTracks()[0],f.stream.getAudioTracks()[0]}()),c.video&&o.getVideoTracks().length===0&&o.addTrack(function(l){var f=l.width,_=l.height,m=l.frameRate;Jo||(Jo=document.createElement("canvas")),Jo.width=f,Jo.height=_,Jo.getContext("2d").fillRect(0,0,f,_),Zc||(Zc=setInterval(function(){Jo.getContext("2d").fillRect(0,0,f,_)},1e3));var v=Jo.captureStream(m);return Ep=v.getVideoTracks()[0],v.getVideoTracks()[0]}(Fr(Fr({},zg.value),{},{frameRate:24})))};function eT(){vp&&vp.stop(),Ep&&Ep.stop(),vp=null,Ep=null,Zc&&(clearInterval(Zc),Zc=null),eo&&(eo.onended=function(){eo.disconnect(),eo=null},eo.stop())}function Wg(o){if(o){var c,l=Hr(o.getTracks());try{for(l.s();!(c=l.n()).done;)c.value.stop()}catch(f){l.e(f)}finally{l.f()}}}var CU=function(){function o(f){ie(this,o),this._deviceManager=f,this._updateQueued=!1}var c,l;return se(o,[{key:"_getUserMedia",value:(l=Bn(regeneratorRuntime.mark(function f(_){var m,v,I,S;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.prev=0,w.next=3,navigator.mediaDevices.getUserMedia(_);case 3:return m=w.sent,eT(),w.abrupt("return",m);case 8:return w.prev=8,w.t0=w.catch(0),ae.warning("Failed to first 'getUserMedia()' call Error[".concat(w.t0,"]")),v=new MediaStream,w.prev=12,w.next=15,navigator.mediaDevices.getUserMedia({audio:_.audio});case 15:I=w.sent,v.addTrack(I.getAudioTracks()[0]),w.next=22;break;case 19:w.prev=19,w.t1=w.catch(12),ae.warning("Failed to get local audio stream Error[".concat(w.t1,"]"));case 22:return w.prev=22,w.next=25,navigator.mediaDevices.getUserMedia({video:_.video});case 25:S=w.sent,v.addTrack(S.getVideoTracks()[0]),w.next=32;break;case 29:w.prev=29,w.t2=w.catch(22),ae.warning("Failed to get local video stream Error[".concat(w.t2,"]"));case 32:return w.abrupt("return",v);case 33:case"end":return w.stop()}},f,null,[[0,8],[12,19],[22,29]])})),function(f){return l.apply(this,arguments)})},{key:"updateStream",value:(c=Bn(regeneratorRuntime.mark(function f(){var _,m,v,I,S,w,G,H,x,V;return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(!this._updateAt){K.next=3;break}return this._updateQueued=!0,K.abrupt("return");case 3:if(_=this._deviceManager.mediaAccesses.some(function(te){return te.constraints.audio}),m=this._deviceManager.mediaAccesses.some(function(te){return te.constraints.video}),_||m){K.next=9;break}return Wg(this.stream),eT(),K.abrupt("return");case 9:return this._updateAt=Date.now(),(v=this.stream)||(I=new MediaStream,JI(I,{audio:_,video:m}),this.stream=I),up&&Wg(v),K.next=15,this._deviceManager.getMediaConstraints({usingAudio:_,usingVideo:m});case 15:return S=K.sent,K.next=18,this._getUserMedia(S);case 18:if((w=K.sent).getVideoTracks().length>0){G=Hr(this._deviceManager.mediaAccesses);try{for(G.s();!(H=G.n()).done;)H.value.hasVideoPermission=!0}catch(te){G.e(te)}finally{G.f()}}JI(w,{audio:_,video:m}),up||Wg(v),this.stream=w,x=Hr(this._deviceManager.mediaAccesses);try{for(x.s();!(V=x.n()).done;)V.value.streamChanged(this.stream)}catch(te){x.e(te)}finally{x.f()}delete this._updateAt,this._updateQueued?(this._updateQueued=!1,this.updateStream()):this._deviceManager.refreshMediaDevices({audio:_,video:m},!0);case 27:case"end":return K.stop()}},f,this)})),function(){return c.apply(this,arguments)})}]),o}();function nT(o,c){return(o==null?void 0:o.deviceId)===(c==null?void 0:c.deviceId)&&(o==null?void 0:o.label)===(c==null?void 0:c.label)&&(o==null?void 0:o.groupId)===(c==null?void 0:c.groupId)}var yp,IU=function(){function o(){var m=this;ie(this,o),this.mediaAccesses=[],this._availableMediaDevices={audioinput:[],audiooutput:[],videoinput:[]},this._currentMediaDevices={audioinput:void 0,audiooutput:void 0,videoinput:void 0},this._sendbirdCallListeners=new Map,this._streamManager=new CU(this),navigator.mediaDevices.ondevicechange=function(){return m._onDeviceChanged()}}var c,l,f,_;return se(o,[{key:"_onDeviceChanged",value:function(){this.mediaAccesses.length!==0&&this.refreshMediaDevices({audio:this.mediaAccesses.some(function(m){return m.constraints.audio}),video:this.mediaAccesses.some(function(m){return m.constraints.video})})}},{key:"addSendBirdCallListener",value:function(m,v){this._sendbirdCallListeners.set(m,v)}},{key:"removeSendBirdCallListener",value:function(m){this._sendbirdCallListeners.delete(m)}},{key:"removeAllSendBirdCallListener",value:function(){this._sendbirdCallListeners.clear()}},{key:"getCurrentAudioInputDevice",value:function(){return this._currentMediaDevices.audioinput}},{key:"getCurrentAudioOutputDevice",value:function(){return this._currentMediaDevices.audiooutput}},{key:"getCurrentVideoInputDevice",value:function(){return this._currentMediaDevices.videoinput}},{key:"getAvailableAudioInputDevices",value:function(){return this._availableMediaDevices.audioinput}},{key:"getAvailableAudioOutputDevices",value:function(){return this._availableMediaDevices.audiooutput}},{key:"getAvailableVideoInputDevices",value:function(){return this._availableMediaDevices.videoinput}},{key:"updateStream",value:(_=Bn(regeneratorRuntime.mark(function m(){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",this._streamManager.updateStream());case 1:case"end":return v.stop()}},m,this)})),function(){return _.apply(this,arguments)})},{key:"_registerMediaAccess",value:function(m){var v=this;this.mediaAccesses.push(m),m.onDisposed=function(){return v.stopMedia(m)}}},{key:"useMedia",value:function(m){if(m.audio||m.video){var v=new bU(this._streamManager,m);return this._registerMediaAccess(v),this.updateStream(),v}ae.error(new Error("you should set true for at least 1 media type."))}},{key:"stopMedia",value:function(m){this.mediaAccesses.splice(this.mediaAccesses.indexOf(m),1),this.updateStream()}},{key:"fetchMediaDevices",value:(f=Bn(regeneratorRuntime.mark(function m(){var v;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,navigator.mediaDevices.enumerateDevices();case 2:return v=I.sent,I.abrupt("return",v.reduce(function(S,w){return S[w.kind].push(w),S},{audioinput:[],audiooutput:[],videoinput:[]}));case 4:case"end":return I.stop()}},m)})),function(){return f.apply(this,arguments)})},{key:"getMediaConstraints",value:(l=Bn(regeneratorRuntime.mark(function m(v){var I,S,w,G,H,x,V,K;return regeneratorRuntime.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return I=v.usingAudio,S=v.usingVideo,w={audio:!1,video:!1},te.next=4,this.fetchMediaDevices();case 4:return G=te.sent,H=G.audioinput,x=G.videoinput,I&&H.length&&(V=this.getCurrentAudioInputDevice(),w.audio={deviceId:V==null?void 0:V.deviceId}),S&&x.length&&(K=this.getCurrentVideoInputDevice(),w.video=Fr(Fr({deviceId:K==null?void 0:K.deviceId},zg.value),{},{frameRate:24})),te.abrupt("return",w);case 10:case"end":return te.stop()}},m,this)})),function(m){return l.apply(this,arguments)})},{key:"_updateCurrentMediaDevice",value:function(m,v){var I,S=this._availableMediaDevices[m],w=this._currentMediaDevices[m],G=S.find(function(H){return H.deviceId===(v==null?void 0:v.deviceId)});return G||(ae.warning("Selected device is unavailable. fallback to default device."),G=((I=G)!==null&&I!==void 0?I:S.length>0)?S[0]:null),this._currentMediaDevices[m]=G,!nT(w,G)}},{key:"_onAudioOutputChanged",value:function(){var m,v=Hr(this.mediaAccesses);try{for(v.s();!(m=v.n()).done;){var I=m.value;I.constraints.audio&&I.audioOutputChanged()}}catch(S){v.e(S)}finally{v.f()}}},{key:"selectDevice",value:function(m,v){v.kind===m?this._updateCurrentMediaDevice(m,v)&&(m!=="audioinput"&&m!=="videoinput"||this.updateStream(),m==="audiooutput"&&this._onAudioOutputChanged()):ae.error(new Error("Tried to select invalid device of type"))}},{key:"_updateAvailableDevices",value:function(m,v){var I,S,w,G=this._currentMediaDevices[m],H=!function(_e,ye){if(_e.length!==ye.length)return!1;for(var Xe=0;Xe<ye.length;Xe++)if(!nT(_e[Xe],ye[Xe]))return!1;return!0}(this._availableMediaDevices[m],v);if(!H)return!1;var x;this._availableMediaDevices[m]=v,x=this._updateCurrentMediaDevice(m,G);var V,K=Hr(this._sendbirdCallListeners.values());try{for(K.s();!(V=K.n()).done;){var te=V.value,me=this._currentMediaDevices[m];switch(m){case"audioinput":(I=te.onAudioInputDeviceChanged)===null||I===void 0||I.call(te,me,v);break;case"audiooutput":(S=te.onAudioOutputDeviceChanged)===null||S===void 0||S.call(te,me,v);break;case"videoinput":(w=te.onVideoInputDeviceChanged)===null||w===void 0||w.call(te,me,v)}}}catch(_e){K.e(_e)}finally{K.f()}return x}},{key:"refreshMediaDevices",value:(c=Bn(regeneratorRuntime.mark(function m(v){var I,S,w,G,H,x,V,K,te,me=arguments;return regeneratorRuntime.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(I=v.audio,S=v.video,w=me.length>1&&me[1]!==void 0&&me[1],I||S){_e.next=4;break}throw new Error("at least one of the audio or video must be true");case 4:return _e.next=6,this.fetchMediaDevices();case 6:G=_e.sent,H=G.audioinput,x=G.audiooutput,V=G.videoinput,K=!1,te=!1,I&&(K=this._updateAvailableDevices("audioinput",H),te=this._updateAvailableDevices("audiooutput",x)),S&&(K=this._updateAvailableDevices("videoinput",V)||K),!w&&K&&this.updateStream(),te&&this._onAudioOutputChanged();case 16:case"end":return _e.stop()}},m,this)})),function(m){return c.apply(this,arguments)})}]),o}(),tT=function(){function o(_,m,v){var I=this;ie(this,o),this._ctx=_,Object.assign(this,m),this._localStream=v,this._localStream.on("audioOutputChanged",function(){I._onAudioOutputChanged()})}var c,l,f;return se(o,[{key:"id",get:function(){return this.participantId}}]),se(o,[{key:"updateInfo",value:function(_){var m=this,v=new Map;return Object.keys(_).forEach(function(I){m[I]!==_[I]&&v.set(I,_[I])}),Object.assign(this,_),v}},{key:"setMediaView",value:(f=Bn(regeneratorRuntime.mark(function _(m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this._mediaView!==m){v.next=2;break}return v.abrupt("return");case 2:if(this._mediaView&&(this._mediaView.srcObject=null),m){v.next=6;break}return delete this._mediaView,v.abrupt("return");case 6:return v.next=8,this._updateMediaViewStream(m,this.stream);case 8:this._mediaView=v.sent;case 9:case"end":return v.stop()}},_,this)})),function(_){return f.apply(this,arguments)})},{key:"_updateMediaViewStream",value:(l=Bn(regeneratorRuntime.mark(function _(m,v){var I,S;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(!(I=this._ctx.deviceManager.getCurrentAudioOutputDevice())){w.next=4;break}return w.next=4,(S=m.setSinkId)===null||S===void 0?void 0:S.call(m,I.deviceId);case 4:return v&&(m.srcObject=v),w.abrupt("return",m);case 6:case"end":return w.stop()}},_,this)})),function(_,m){return l.apply(this,arguments)})},{key:"_onAudioOutputChanged",value:(c=Bn(regeneratorRuntime.mark(function _(){var m,v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(this._ctx.roomType!==Ra.SMALL_ROOM_FOR_VIDEO&&this._ctx.roomType!==Ra.SMALL_ROOM_FOR_AUDIO_ONLY){S.next=4;break}return I=this._ctx.deviceManager.getCurrentAudioOutputDevice(),S.next=4,(m=this._mediaView)===null||m===void 0||(v=m.setSinkId)===null||v===void 0?void 0:v.call(m,I.deviceId);case 4:case"end":return S.stop()}},_,this)})),function(){return c.apply(this,arguments)})}]),o}(),rT=function(o){ce(f,o);var c,l=fe(f);function f(_,m,v){var I;return ie(this,f),qe(je(I=l.call(this,_,m,v)),"isLocalParticipant",!0),qe(je(I),"_resolution",ta._720P),I._localStream.on("streamChanged",function(S){return I._onStream(S)}),I}return se(f,[{key:"stream",get:function(){var _;return(_=this._localStream)===null||_===void 0?void 0:_.localStream}},{key:"localStream",get:function(){return this._localStream}},{key:"masterEndpoint",get:function(){return this._masterEndpoint},set:function(_){this._masterEndpoint=_}}]),se(f,[{key:"exit",value:function(){this._release()}},{key:"setLocalMediaView",value:(c=Bn(regeneratorRuntime.mark(function _(m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",this.setMediaView(m));case 1:case"end":return v.stop()}},_,this)})),function(_){return c.apply(this,arguments)})},{key:"muteMicrophone",value:function(){ae.info("muteMicrophone()"),this._toggleAudio(!1)}},{key:"unmuteMicrophone",value:function(){ae.info("unmuteMicrophone()"),this._toggleAudio(!0)}},{key:"startVideo",value:function(){ae.info("startVideo()"),this._toggleVideo(!0)}},{key:"stopVideo",value:function(){ae.info("stopVideo()"),this._toggleVideo(!1)}},{key:"updateResolution",value:function(_){this._resolution.equals(_)||(this._resolution=_,this._applyConstraints())}},{key:"_toggleAudio",value:function(_){this.isAudioEnabled!==_&&(this.stream.getAudioTracks().forEach(function(m){m.enabled=_}),this.isAudioEnabled=_,this._sendAudioCommand(_).catch(function(m){return ae.debug(m)}))}},{key:"_toggleVideo",value:function(_){this.isVideoEnabled!==_&&(this.stream.getVideoTracks().forEach(function(m){m.enabled=_}),this.isVideoEnabled=_,this._sendVideoCommand(_).catch(function(m){return ae.debug(m)}))}},{key:"_isMediaEnabled",value:function(_){switch(_){case"audio":return this.isAudioEnabled;case"video":return this.isVideoEnabled;default:return ae.error(new Error("unrecognized media type ".concat(_))),!1}}},{key:"_applyConstraints",value:function(){var _;if(ae.debug("_applyConstraints()"),this.stream&&(_=this._localStream)!==null&&_!==void 0&&_.hasVideoPermission){var m,v=Hr(this.stream.getVideoTracks());try{for(v.s();!(m=v.n()).done;){var I=m.value,S=void 0;S=this._resolution.equals(ta._360P)&&FL?{height:this._resolution.value.height}:this._resolution.value,I.applyConstraints(S).catch(function(w){return ae.error("Fail change local video resolution error = ",w)})}}catch(w){v.e(w)}finally{v.f()}}}},{key:"_onStream",value:function(_){var m,v=Hr(_.getTracks());try{for(v.s();!(m=v.n()).done;){var I=m.value;I.enabled=this._isMediaEnabled(I.kind)}}catch(S){v.e(S)}finally{v.f()}this._applyConstraints(),this._mediaView&&(this._mediaView.srcObject=_)}},{key:"_release",value:function(){this._localStream.release(),delete this._localStream}},{key:"_sendAudioCommand",value:function(_){var m=qr.createAudio(this._ctx.roomId,this.id,_);return this._ctx.sender.send(m)}},{key:"_sendVideoCommand",value:function(_){var m=qr.createVideo(this._ctx.roomId,this.id,_);return this._ctx.sender.send(m)}}]),f}(tT),iT=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"isLocalParticipant",!1),qe(je(f),"_onStream",function(){var I=je(f).stream;f._mediaView&&f._updateMediaViewStream(f._mediaView,I)}),f}return se(l,[{key:"viewerEndpoint",set:function(f){var _;(_=this._unsubscribeRemoteStream)===null||_===void 0||_.call(this),this._viewerEndpoint=f,f&&(this._unsubscribeRemoteStream=f.on("remoteStream",this._onStream)),this._onStream()}},{key:"stream",get:function(){var f;return(f=this._viewerEndpoint)===null||f===void 0?void 0:f.remoteStream}}]),l}(tT);(function(o){o.ENTERED="entered",o.CONNECTED="connected",o.EXITED="exited"})(yp||(yp={}));var Ra,TU=function(o){ce(f,o);var c,l=fe(f);function f(){return ie(this,f),l.apply(this,arguments)}return se(f,[{key:"onSelfEntered",value:function(){this._updateLocalResolution(this._localResolution),Wu(Xa(f.prototype),"onSelfEntered",this).call(this),this._createRecvSessionsForConnectedParticipants()}},{key:"_onEndpointReconnected",value:function(_){Wu(Xa(f.prototype),"_onEndpointReconnected",this).call(this,_),_.type==="viewer"&&_.attachedTo&&this._attach(_,_.attachedTo)}},{key:"_onParticipantEntered",value:function(_){Wu(Xa(f.prototype),"_onParticipantEntered",this).call(this,_),this._updateLocalResolution(this._localResolution)}},{key:"_onParticipantConnected",value:(c=Bn(regeneratorRuntime.mark(function _(m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return Wu(Xa(f.prototype),"_onParticipantConnected",this).call(this,m),v.abrupt("return",this._createParticipantRecvSession(m));case 2:case"end":return v.stop()}},_,this)})),function(_){return c.apply(this,arguments)})},{key:"_onParticipantExited",value:function(_){Wu(Xa(f.prototype),"_onParticipantExited",this).call(this,_),this._updateLocalResolution(this._localResolution)}},{key:"_createParticipantRecvSession",value:function(_){ae.debug("_createParticipantRecvSession(".concat(_.id,")"));var m=this._endpointManager.createViewer();return this._attach(m,_),m}},{key:"_attach",value:function(_,m){var v=this;_.attach(m),_.once("attached",function(){v._dispatchEvent("remoteParticipantStream",m)})}},{key:"_createRecvSessionsForConnectedParticipants",value:function(){ae.debug("_createRecvSessionForConnectedParticipant()");var _,m=Hr(this._collection.remoteParticipants);try{for(m.s();!(_=m.n()).done;){var v=_.value;v.isLocalParticipant||v.state===yp.CONNECTED&&this._createParticipantRecvSession(v)}}catch(I){m.e(I)}finally{m.f()}}},{key:"_localResolution",get:function(){switch(this._collection.connectedRemoteParticipants.length){case 0:case 1:return ta._720P;case 2:return ta._540P;case 3:return ta._480P;default:return ta._360P}}}]),f}(YI),SU=function(o){ce(I,o);var c,l,f,_,m,v=fe(I);function I(S,w){var G;return ie(this,I),(G=v.call(this,S,w))._ctx=S,G._collection=w,w.localStream.on("audioOutputChanged",function(){G._onAudioOutputChanged()}),G}return se(I,[{key:"onSelfEntered",value:(m=Bn(regeneratorRuntime.mark(function S(){var w=this;return regeneratorRuntime.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:Wu(Xa(I.prototype),"onSelfEntered",this).call(this),this._localParticipant.masterEndpoint.on("remoteStream",function(H){w._onRemoteStream(H)});case 2:case"end":return G.stop()}},S,this)})),function(){return m.apply(this,arguments)})},{key:"_onParticipantEntered",value:function(S){}},{key:"_onParticipantConnected",value:(_=Bn(regeneratorRuntime.mark(function S(w){return regeneratorRuntime.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:case"end":return G.stop()}},S)})),function(S){return _.apply(this,arguments)})},{key:"_onParticipantExited",value:function(S){}},{key:"_onRemoteStream",value:function(S){this._mediaView&&(this._mediaView.srcObject=S)}},{key:"setMediaView",value:(f=Bn(regeneratorRuntime.mark(function S(w){return regeneratorRuntime.wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(this._mediaView!==w){G.next=2;break}return G.abrupt("return");case 2:if(this._mediaView&&(this._mediaView.srcObject=null),w){G.next=6;break}return delete this._mediaView,G.abrupt("return");case 6:return G.next=8,this._updateMediaViewStream(w,this._stream);case 8:this._mediaView=G.sent;case 9:case"end":return G.stop()}},S,this)})),function(S){return f.apply(this,arguments)})},{key:"_updateMediaViewStream",value:(l=Bn(regeneratorRuntime.mark(function S(w,G){var H,x;return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!(H=this._ctx.deviceManager.getCurrentAudioOutputDevice())){V.next=4;break}return V.next=4,(x=w.setSinkId)===null||x===void 0?void 0:x.call(w,H.deviceId);case 4:return G&&(w.srcObject=G),V.abrupt("return",w);case 6:case"end":return V.stop()}},S,this)})),function(S,w){return l.apply(this,arguments)})},{key:"_onAudioOutputChanged",value:(c=Bn(regeneratorRuntime.mark(function S(){var w,G,H;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return H=this._ctx.deviceManager.getCurrentAudioOutputDevice(),x.next=3,(w=this._mediaView)===null||w===void 0||(G=w.setSinkId)===null||G===void 0?void 0:G.call(w,H.deviceId);case 3:case"end":return x.stop()}},S,this)})),function(){return c.apply(this,arguments)})},{key:"_stream",get:function(){return this._localParticipant.masterEndpoint.remoteStream}}]),I}(YI),NU=function(o){ce(f,o);var c,l=fe(f);function f(_,m){var v;return ie(this,f),(v=l.call(this))._ctx=_,v._participantCollection=m,v._aliveFailureCount=0,v}return se(f,[{key:"onEntered",value:function(){var _=this;switch(this._keepAliveInterval=setInterval(function(){Promise.race([_._sendAlive(),new Promise(function(m,v){return setTimeout(v,5e3)})]).then(function(){_._aliveFailureCount=0}).catch(function(m){m&&(m.code!==De.ERR_ROOM_DELETED?(_._aliveFailureCount+=1,(_._aliveFailureCount>=8||m.code===De.ERR_INVALID_ROOM_PARTICIPANT)&&_._dispatchEvent("aliveFailed")):_._dispatchEvent("deleted"))})},5e3),this._ctx.roomType){case"small_room_for_video":this._participantManager=new TU(this._ctx,this._participantCollection);break;case"large_room_for_audio_only":this._participantManager=new SU(this._ctx,this._participantCollection);break;default:throw new Error("Unsupported room type : ".concat(this._ctx.roomType))}this._registerEventListeners(),this._participantManager.onSelfEntered()}},{key:"exit",value:function(){clearInterval(this._keepAliveInterval),delete this._keepAliveInterval,this._participantManager.removeAllEventListeners(),this._participantManager.exit()}},{key:"setAudioForLargeRoom",value:(c=Bn(regeneratorRuntime.mark(function _(m){var v;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(ae.info("setAudioForLargeRoom()"),this._ctx.roomType==="large_room_for_audio_only"){I.next=5;break}throw v=new Error("Room type not audio mcu"),ae.error(v),v;case 5:return I.abrupt("return",this._participantManager.setMediaView(m));case 6:case"end":return I.stop()}},_,this)})),function(_){return c.apply(this,arguments)})},{key:"_sendAlive",value:function(){var _=qr.createAlive(this._ctx.roomId,this._localParticipant.id);return this._ctx.sender.send(_)}},{key:"_registerEventListeners",value:function(){var _=this;this._participantManager.on("remoteParticipantStream",function(m){_._dispatchEvent("remoteParticipantStream",m)}),this._participantManager.on("localParticipantConnected",function(m,v){_._dispatchEvent("localParticipantConnected",m,v)}),this._participantManager.on("localParticipantDisconnected",function(m){_._dispatchEvent("localParticipantDisconnected",m)})}},{key:"_localParticipant",get:function(){return this._participantCollection.localParticipant}}]),f}(zi),AU=function(o){ce(f,o);var c,l=fe(f);function f(){return ie(this,f),l.call(this)}return se(f,[{key:"startStream",value:(c=Bn(regeneratorRuntime.mark(function _(){var m,v,I=this;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.prev=0,S.next=3,navigator.mediaDevices.getDisplayMedia({video:!0});case 3:m=S.sent,this._stream=m,this._stream.getVideoTracks()[0].onended=function(){I._releaseStream(),I._dispatchEvent("streamStopped")},S.next=23;break;case 8:S.prev=8,S.t0=S.catch(0),S.t1=S.t0.name,S.next=S.t1==="InvalidStateError"?13:S.t1==="NotAllowedError"?15:S.t1==="NotFoundError"?17:S.t1==="NotReadableError"?19:21;break;case 13:return v=De.ERR_NOT_SUPPORTED_APP_STATE_FOR_SCREEN_SHARE,S.abrupt("break",22);case 15:return v=De.ERR_PERMISSION_DENIED_FOR_SCREEN_SHARE,S.abrupt("break",22);case 17:return v=De.ERR_SELECTED_CONTENT_NOT_EXIST,S.abrupt("break",22);case 19:return v=De.ERR_SELECTED_CONTENT_INACCESSIBLE,S.abrupt("break",22);case 21:v=De.ERR_SCREEN_SHARE_FAILED_DUE_TO_UNKNOWN_REASON;case 22:throw new Jt(v);case 23:case"end":return S.stop()}},_,this,[[0,8]])})),function(){return c.apply(this,arguments)})},{key:"stopStream",value:function(){this._releaseStream(),this._dispatchEvent("streamStopped")}},{key:"_releaseStream",value:function(){if(this._stream){var _,m=Hr(this._stream.getTracks());try{for(m.s();!(_=m.n()).done;)_.value.stop()}catch(v){m.e(v)}finally{m.f()}delete this._stream}}},{key:"stream",get:function(){return this._stream}},{key:"isSharing",get:function(){return!!this._stream}}]),f}(zi),aT=function(o){ce(f,o);var c,l=fe(f);function f(_){var m,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{audio:!0,video:!0};return ie(this,f),(m=l.call(this))._deviceManager=_,m._mediaConstraints=v,m._screenShare=new AU,m._screenShare.on("streamStopped",function(){m._releaseMergedStream(),m._dispatchEvent("screenShareStreamStopped")}),m}return se(f,[{key:"useScreenStream",value:(c=Bn(regeneratorRuntime.mark(function _(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return GL(),m.next=3,this._screenShare.startStream();case 3:this._mergeScreenShareStream(),this._dispatchEvent("streamChanged",this.localStream);case 5:case"end":return m.stop()}},_,this)})),function(){return c.apply(this,arguments)})},{key:"getLocalMediaStream",value:function(){return this._mediaAccess||this._grantMediaAccess(this._mediaConstraints),this._mediaAccess.stream}},{key:"stopScreenShare",value:function(){this._screenShare.isSharing&&this._screenShare.stopStream()}},{key:"revokeMediaAccess",value:function(){this._mediaAccess&&(this._mediaAccess.dispose(),this._mediaAccess=null)}},{key:"release",value:function(){this.stopScreenShare(),this.revokeMediaAccess()}},{key:"_grantMediaAccess",value:function(_){var m=this;this._mediaAccess=this._deviceManager.useMedia(_),this._mediaAccess.on("streamChanged",function(){m._screenShare.isSharing&&m._mergeScreenShareStream(),m._dispatchEvent("streamChanged",m.localStream)}),this._mediaAccess.on("audioOutputChanged",function(){return m._dispatchEvent("audioOutputChanged")})}},{key:"_mergeScreenShareStream",value:function(){if(this._screenShare.isSharing){var _=new MediaStream;this._mediaAccess.stream&&this._mediaAccess.stream.getAudioTracks().length>0&&_.addTrack(this._mediaAccess.stream.getAudioTracks()[0]),_.addTrack(this.screenStream.getVideoTracks()[0]),this._mergedStream=_}}},{key:"_releaseMergedStream",value:function(){this._mergedStream&&(this._mergedStream.removeTrack(this._mergedStream.getAudioTracks()[0]),delete this._mergedStream,this._dispatchEvent("streamChanged",this.localStream))}},{key:"mediaConstraints",set:function(_){this._mediaConstraints=_}},{key:"hasVideoPermission",get:function(){var _;return(_=this._mediaAccess)===null||_===void 0?void 0:_.hasVideoPermission}},{key:"localStream",get:function(){return this.isScreenSharing?this._mergedStream:this.getLocalMediaStream()}},{key:"mergedStream",get:function(){return this._mergedStream}},{key:"screenStream",get:function(){return this._screenShare.stream}},{key:"isScreenSharing",get:function(){return this._screenShare.isSharing}}]),f}(zi),wU=function(o){ce(l,o);var c=fe(l);function l(f){var _,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return ie(this,l),qe(je(_=c.call(this)),"_remoteParticipants",[]),_._ctx=f,_.initialize(m),_}return se(l,[{key:"_getMediaConstraints",value:function(){switch(this._ctx.roomType){case"large_room_for_audio_only":case"small_room_for_audio_only":return{audio:!0,video:!1};default:return{audio:!0,video:!0}}}},{key:"findRemoteById",value:function(f){return this._remoteParticipants.find(function(_){return _.participantId===f})}},{key:"initialize",value:function(f){var _=this;ae.debug("initialize()",f),this._localStream=new aT(this._ctx.deviceManager),this._localStream.mediaConstraints=this._getMediaConstraints(),f.forEach(function(m){m.isLocalParticipant?_._localParticipant=new rT(_._ctx,m,_._localStream):_._remoteParticipants.push(new iT(_._ctx,m,_._localStream))})}},{key:"updateInfo",value:function(f){ae.debug("updateInfo()",f),this._stampLocalParticipant(f);var _=f.filter(function(v){return v.isLocalParticipant})[0],m=f.filter(function(v){return!v.isLocalParticipant});_&&this._upsertLocalParticipantInfo(_),this._updateRemoteParticipantsInfo(m)}},{key:"exit",value:function(){ae.debug("exit()"),this._localParticipant.exit(),delete this._localParticipant}},{key:"onEvent",value:function(f){switch(f.type){case Ze.PARTICIPANT_ENTERED:this._onEntered(f.payload.participant);break;case Ze.PARTICIPANT_CONNECTED:this._onConnected(f.payload.participant);break;case Ze.PARTICIPANT_EXITED:this._onExited(f.payload.participant);break;case Ze.PARTICIPANT_DISCONNECTED:this._onDisconnected(f.payload.participant,f.payload.reason);break;case Ze.PARTICIPANT_AUDIO_STATUS_CHANGED:this._onAudioSettingsChanged(f.payload.participant);break;case Ze.PARTICIPANT_VIDEO_STATUS_CHANGED:this._onVideoSettingsChanged(f.payload.participant)}}},{key:"_upsertLocalParticipantInfo",value:function(f){ae.debug("_upsertLocalParticipantInfo()"),this._localParticipant?this._localParticipant.updateInfo(f):this._localParticipant=new rT(this._ctx,f,this._localStream)}},{key:"_updateRemoteParticipantsInfo",value:function(f){var _=this;ae.debug("_updateRemoteParticipantsInfo()"),f.forEach(function(m){return _._upsertParticipantInfo(m)}),this._remoteParticipants.filter(function(m){return!f.some(function(v){return v.participantId===m.id})}).forEach(function(m){_._deleteParticipantInfo(m)})}},{key:"_upsertParticipantInfo",value:function(f){ae.debug("_upsertParticipantInfo()");var _=this._updateParticipantInfo(f);return _||this._insertParticipantInfo(f)}},{key:"_insertParticipantInfo",value:function(f){ae.debug("_insertParticipantInfo()");var _=new iT(this._ctx,f,this._localStream);return this._dispatchEventIfOnCall("entered",_),_.state==="connected"&&this._dispatchEventIfOnCall("connected",_),this._remoteParticipants.push(_),_}},{key:"_updateParticipantInfo",value:function(f){ae.debug("_updateParticipantInfo()");var _=this.findRemoteById(f.participantId);if(!_)return!1;var m,v=Hr(_.updateInfo(f).entries());try{for(v.s();!(m=v.n()).done;){var I=$u(m.value,2),S=I[0],w=I[1];switch(S){case"isAudioEnabled":this._dispatchEventIfOnCall("audioSettingsChanged",_);break;case"isVideoEnabled":this._dispatchEventIfOnCall("videoSettingsChanged",_);break;case"state":w==="connected"&&this._dispatchEventIfOnCall("connected",_);break;default:ae.debug(`_updateParticipantInfo() => Ignore diff
key : `,S,`
value : `,w)}}}catch(G){v.e(G)}finally{v.f()}return _}},{key:"_deleteParticipantInfo",value:function(f){ae.debug("_deleteParticipantInfo()");var _=this.findRemoteById(f.participantId);if(_){var m=this._remoteParticipants.indexOf(_);this._remoteParticipants.splice(m,1),this._dispatchEventIfOnCall("exited",_)}}},{key:"_stampLocalParticipant",value:function(f){var _=this;this._localParticipant&&(f.find(function(m){return m.participantId===_._localParticipant.participantId}).isLocalParticipant=!0)}},{key:"_onEntered",value:function(f){ae.debug("_onEntered()"),this._upsertParticipantInfo(f)}},{key:"_onConnected",value:function(f){ae.debug("_onConnected()"),this._upsertParticipantInfo(f)}},{key:"_onExited",value:function(f){ae.debug("_onExited()"),this._deleteParticipantInfo(f)}},{key:"_onDisconnected",value:function(f,_){ae.debug("_onDisconnected()"),this._localParticipant.participantId===f.participantId?this._dispatchEvent("selfDisconnected",_):this._deleteParticipantInfo(f)}},{key:"_onAudioSettingsChanged",value:function(f){ae.debug("_onAudioSettingsChanged()"),this._upsertParticipantInfo(f)}},{key:"_onVideoSettingsChanged",value:function(f){ae.debug("_onVideoSettingsChanged()"),this._upsertParticipantInfo(f)}},{key:"_dispatchEventIfOnCall",value:function(f){if(this._isOnCall){for(var _=arguments.length,m=new Array(_>1?_-1:0),v=1;v<_;v++)m[v-1]=arguments[v];this._dispatchEvent.apply(this,[f].concat(m))}}},{key:"participants",get:function(){var f=Ed(this._remoteParticipants);return this._localParticipant&&f.unshift(this._localParticipant),f}},{key:"localParticipant",get:function(){return this._localParticipant}},{key:"remoteParticipants",get:function(){return this._remoteParticipants}},{key:"connectedRemoteParticipants",get:function(){return this._remoteParticipants.filter(function(f){return f.state===yp.CONNECTED})}},{key:"localStream",get:function(){return this._localStream}},{key:"_isOnCall",get:function(){return this._ctx.room.isOnCall}}]),l}(zi),Xc=function(){function o(_){var m=_.sender,v=_.room,I=_.inviter,S=_.invitee;ie(this,o),this._sender=m,this.room=v,this.inviter=I,this.invitee=S}var c,l,f;return se(o,[{key:"accept",value:(f=Bn(regeneratorRuntime.mark(function _(){var m;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return m=qr.createAcceptInvitation(this.room.roomId,this.inviter.userId),v.abrupt("return",this._sender.send(m));case 2:case"end":return v.stop()}},_,this)})),function(){return f.apply(this,arguments)})},{key:"decline",value:(l=Bn(regeneratorRuntime.mark(function _(){var m;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return m=qr.createDeclineInvitation(this.room.roomId,this.inviter.userId),v.abrupt("return",this._sender.send(m));case 2:case"end":return v.stop()}},_,this)})),function(){return l.apply(this,arguments)})},{key:"cancel",value:(c=Bn(regeneratorRuntime.mark(function _(){var m;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return m=qr.createCancelInvitation(this.room.roomId,this.invitee.userId),v.abrupt("return",this._sender.send(m));case 2:case"end":return v.stop()}},_,this)})),function(){return c.apply(this,arguments)})}]),o}();(function(o){o.SMALL_ROOM_FOR_AUDIO_ONLY="small_room_for_audio_only",o.LARGE_ROOM_FOR_AUDIO_ONLY="large_room_for_audio_only",o.SMALL_ROOM_FOR_VIDEO="small_room_for_video",o.LARGE_ROOM_FOR_VIDEO="large_room_for_video"})(Ra||(Ra={}));var $g,RU=function(o){ce(v,o);var c,l,f,_,m=fe(v);function v(I,S){var w;return ie(this,v),qe(je(w=m.call(this)),"_enterLock",new OI),qe(je(w),"_customItemsUpdatedAt",0),w._ctx=Fr(Fr({},I),{},{room:je(w),roomId:S.roomId,roomType:S.roomType,customItems:S.customItems}),w.initialize(S),w._registerCollectionEventListeners(),w}return se(v,[{key:"_send",value:function(I){return this._ctx.sender.send(I)}},{key:"initialize",value:function(I){var S=I.participants,w=ig(I,["participants"]);Object.assign(this,w),this._participantCollection?this._participantCollection.initialize(S):this._participantCollection=new wU(this._ctx,I.participants)}},{key:"updateInfo",value:function(I){var S=I.participants,w=ig(I,["participants"]);return Object.assign(this,w),this._participantCollection.updateInfo(S),this}},{key:"onEvent",value:function(I){var S=this;this._enterLock.acquire().then(function(){S._processEvent(I),S._enterLock.release()})}},{key:"fetchCustomItems",value:function(){var I=this,S=qr.createFetchCustomItems(this.roomId);return this._send(S).then(function(w){var G=w.payload;return I._setCustomItems(G.customItems,G.affectedAt),G}).catch(function(w){throw ae.error("failed to update customItems"),w})}},{key:"updateCustomItems",value:function(I){var S=this,w=$u(Og(I),2)[1];if(w)return w;var G=qr.createUpdateCustomItems(this.roomId,I,"upsert");return this._send(G).then(function(H){var x=H.payload;return S._setCustomItems(x.customItems,x.affectedAt),x}).catch(function(H){throw ae.error("failed to update customItems"),H})}},{key:"deleteCustomItems",value:function(I){var S=this,w=$u(kg(I),2)[1];if(w)return w;var G=qr.createDeleteCustomItems(this.roomId,I);return this._send(G).then(function(H){var x=H.payload;return S._setCustomItems(x.customItems,x.affectedAt),x}).catch(function(H){throw ae.error("failed to delete customItems"),H})}},{key:"_setCustomItems",value:function(I,S){return S>this._customItemsUpdatedAt&&(this._customItemsUpdatedAt=S,this.customItems=I||{},!0)}},{key:"_processEvent",value:function(I){switch(I.type){case Ze.CUSTOM_ITEMS_UPDATE:this._updateCustomItems(I);break;case Ze.CUSTOM_ITEMS_DELETE:this._deleteCustomItems(I);break;case Ze.ROOM_DELETED:this._dispatchEvent("deleted"),this._teardown();break;case Ze.INVITATION_DECLINED:this._dispatchEvent("invitationDeclined",new Xc({sender:this._ctx.sender,room:this,inviter:I.payload.inviter,invitee:I.payload.invitee}));break;case Ze.INVITATION_ACCEPTED:this._dispatchEvent("invitationAccepted",new Xc({sender:this._ctx.sender,room:this,inviter:I.payload.inviter,invitee:I.payload.invitee}));break;case Ze.INVITATION_CANCELED:this._dispatchEvent("invitationCanceled",new Xc({sender:this._ctx.sender,room:this,inviter:I.payload.inviter,invitee:I.payload.invitee}));break;case Ze.PARTICIPANT_ENTERED:case Ze.PARTICIPANT_CONNECTED:case Ze.PARTICIPANT_EXITED:case Ze.PARTICIPANT_DISCONNECTED:case Ze.PARTICIPANT_AUDIO_STATUS_CHANGED:case Ze.PARTICIPANT_VIDEO_STATUS_CHANGED:this._passToCollection(I)}}},{key:"enter",value:(_=Bn(regeneratorRuntime.mark(function I(S){var w,G;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(ae.info("enter()"),!this._session){H.next=5;break}throw w=new Jt(De.ERR_CLIENT_ALREADY_ENTERED),ae.debug(w),w;case 5:return H.next=7,this._enterLock.acquire();case 7:return H.prev=7,H.next=10,this._sendEnter(S);case 10:G=H.sent,H.next=18;break;case 13:throw H.prev=13,H.t0=H.catch(7),this._enterLock.release(),ae.error(H.t0),H.t0;case 18:this.updateInfo(G.payload.room),this._session=new NU(this._ctx,this._participantCollection),this._registerSessionEventListeners(),this._session.onEntered(),this._enterLock.release();case 23:case"end":return H.stop()}},I,this,[[7,13]])})),function(I){return _.apply(this,arguments)})},{key:"exit",value:function(){ae.info("exit()"),this._validateEntered();var I=this.localParticipant.id;this._teardown(),this._sendExit(I).catch(function(S){ae.error("_sendExit() failed : ",S)})}},{key:"setAudioForLargeRoom",value:(f=Bn(regeneratorRuntime.mark(function I(S){return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return ae.info("setAudioForLargeRoom()"),this._validateEntered(),w.abrupt("return",this._session.setAudioForLargeRoom(S));case 3:case"end":return w.stop()}},I,this)})),function(I){return f.apply(this,arguments)})},{key:"sendInvitation",value:(l=Bn(regeneratorRuntime.mark(function I(S){var w,G;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return w=qr.createSendInvitation(this.roomId,S),H.next=3,this._ctx.sender.send(w);case 3:return G=H.sent,H.abrupt("return",new Xc({sender:this._ctx.sender,room:this,inviter:G.payload.inviter,invitee:G.payload.invitee}));case 5:case"end":return H.stop()}},I,this)})),function(I){return l.apply(this,arguments)})},{key:"delete",value:(c=Bn(regeneratorRuntime.mark(function I(){var S;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._sendDelete(this.roomId);case 2:S=w.sent,this.updateInfo(S.payload.room),this._dispatchEvent("deleted");case 5:case"end":return w.stop()}},I,this)})),function(){return c.apply(this,arguments)})},{key:"_validateEntered",value:function(){if(!this._session){var I=new Jt(De.ERR_PARTICIPANT_NOT_IN_ROOM);throw ae.debug(I),I}}},{key:"_registerSessionEventListeners",value:function(){var I=this;this._session.on("remoteParticipantStream",function(S){I._dispatchEvent("remoteParticipantStreamStarted",S)}),this._session.on("localParticipantConnected",function(S,w){w&&I._dispatchEvent("localParticipantReconnected",S)}),this._session.on("localParticipantDisconnected",function(S){I._dispatchEvent("localParticipantDisconnected",S)}),this._session.on("aliveFailed",function(){I._dispatchEvent("error",new Jt(De.ERR_LOCAL_PARTICIPANT_LOST_CONNECTION)),I._teardown()}),this._session.on("deleted",function(){I._dispatchEvent("deleted"),I._teardown()})}},{key:"_registerCollectionEventListeners",value:function(){var I=this;this._participantCollection.on("entered",function(S){I._dispatchEvent("remoteParticipantEntered",S)}),this._participantCollection.on("connected",function(S){I._dispatchEvent("remoteParticipantConnected",S)}),this._participantCollection.on("exited",function(S){I._dispatchEvent("remoteParticipantExited",S)}),this._participantCollection.on("audioSettingsChanged",function(S){I._dispatchEvent("remoteAudioSettingsChanged",S)}),this._participantCollection.on("videoSettingsChanged",function(S){I._dispatchEvent("remoteVideoSettingsChanged",S)}),this._participantCollection.on("selfDisconnected",function(S){I._teardown(),S==="sibling_kicked"?I._dispatchEvent("error",new Jt(De.ERR_LOCAL_PARTICIPANT_KICKED_OUT)):I._dispatchEvent("error",new Jt(De.ERR_LOCAL_PARTICIPANT_LOST_CONNECTION))})}},{key:"_updateCustomItems",value:function(I){var S=I.payload,w=S.customItems,G=S.updated,H=S.affectedAt;this._setCustomItems(w,H)&&this._dispatchEvent("customItemsUpdated",w,G)}},{key:"_deleteCustomItems",value:function(I){var S=I.payload,w=S.customItems,G=S.deleted,H=S.affectedAt;this._setCustomItems(w,H)&&this._dispatchEvent("customItemsDeleted",w,G)}},{key:"_passToCollection",value:function(I){this._participantCollection.onEvent(I)}},{key:"_sendEnter",value:function(I){var S=qr.createEnter(this._ctx.roomId,I);return this._ctx.sender.send(S)}},{key:"_sendExit",value:function(I){var S=qr.createExit(this._ctx.roomId,I);return this._ctx.sender.send(S)}},{key:"_sendDelete",value:function(I){var S=qr.createDeleteRoom(I);return this._ctx.sender.send(S)}},{key:"_teardown",value:function(){this._session.removeAllEventListeners(),this._session.exit(),this._participantCollection.exit(),delete this._session}},{key:"participants",get:function(){return this._participantCollection.participants}},{key:"localParticipant",get:function(){return this._participantCollection.localParticipant}},{key:"remoteParticipants",get:function(){return this._participantCollection.remoteParticipants}},{key:"isOnCall",get:function(){return!!this._session}}]),v}(zi);(function(o){o.OPEN="open",o.DELETED="deleted"})($g||($g={}));var Ma,MU=function(){function o(c){ie(this,o),this._ctx=c}return se(o,[{key:"createRoom",value:function(c){return new RU(this._ctx,c)}}]),o}(),OU=function(){function o(_){ie(this,o),this._ctx=_,this._factory=new MU(_),this._rooms=new Map,this._sendbirdCallListeners=new Map}var c,l,f;return se(o,[{key:"_hasRoom",value:function(_){return this._rooms.has(_)}},{key:"onEvent",value:function(_){switch(_.type){case Ze.INVITATION_SENT:this._onInvitation(_);break;case Ze.CUSTOM_ITEMS_UPDATE:case Ze.CUSTOM_ITEMS_DELETE:case Ze.ROOM_DELETED:case Ze.PARTICIPANT_CONNECTED:case Ze.PARTICIPANT_ENTERED:case Ze.PARTICIPANT_EXITED:case Ze.PARTICIPANT_DISCONNECTED:case Ze.PARTICIPANT_AUDIO_STATUS_CHANGED:case Ze.PARTICIPANT_VIDEO_STATUS_CHANGED:case Ze.INVITATION_CANCELED:case Ze.INVITATION_ACCEPTED:case Ze.INVITATION_DECLINED:this._passToRoom(_);break;default:ae.error(new Error("unhandled room event ".concat(_.type)))}}},{key:"addListener",value:function(_,m){this._sendbirdCallListeners.set(_,m)}},{key:"removeListener",value:function(_){this._sendbirdCallListeners.delete(_)}},{key:"removeAllListeners",value:function(){this._sendbirdCallListeners.clear()}},{key:"_onInvitation",value:function(_){var m;this._sendInvitationReceiveCommand(_),(m=this._rooms.get(_.payload.room.roomId))||(m=this._factory.createRoom(_.payload.room),this._rooms.set(m.roomId,m));var v,I=new Xc({sender:this._ctx.sender,room:m,inviter:_.payload.inviter,invitee:_.payload.invitee}),S=Hr(this._sendbirdCallListeners.values());try{for(S.s();!(v=S.n()).done;){var w,G=v.value;(w=G.onInvitationReceived)===null||w===void 0||w.call(G,I)}}catch(H){S.e(H)}finally{S.f()}}},{key:"_sendInvitationReceiveCommand",value:function(_){var m=qr.createInvitationReceive(_.payload.room.roomId,_.payload.inviter.userId,_.payload.shortLivedToken);return this._ctx.sender.send(m).catch(function(){})}},{key:"_passToRoom",value:function(_){this._hasRoom(_.getRoomId())?this._rooms.get(_.getRoomId()).onEvent(_):ae.debug("received command ".concat(_.type," for non-existing room ").concat(_.getRoomId()))}},{key:"createRoom",value:(f=Bn(regeneratorRuntime.mark(function _(m){var v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._sendCreate(m);case 2:return v=S.sent,I=this._factory.createRoom(v.payload.room),this._rooms.set(I.roomId,I),S.abrupt("return",I);case 6:case"end":return S.stop()}},_,this)})),function(_){return f.apply(this,arguments)})},{key:"deserializeRoom",value:(l=Bn(regeneratorRuntime.mark(function _(m){var v,I,S;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(v=m.roomId,!(I=this._rooms.get(v))){w.next=5;break}return I.updateInfo(m),w.abrupt("return",I);case 5:return S=this._factory.createRoom(m),this._rooms.set(S.roomId,S),w.abrupt("return",S);case 8:case"end":return w.stop()}},_,this)})),function(_){return l.apply(this,arguments)})},{key:"getCachedRoomById",value:function(_){return this._rooms.get(_)}},{key:"fetchRoomById",value:(c=Bn(regeneratorRuntime.mark(function _(m){var v,I,S;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._sendGetRoom(m);case 2:if(v=w.sent,!(I=this._rooms.get(m))){w.next=7;break}return I.updateInfo(v.payload.room),w.abrupt("return",I);case 7:return S=this._factory.createRoom(v.payload.room),this._rooms.set(S.roomId,S),w.abrupt("return",S);case 10:case"end":return w.stop()}},_,this)})),function(_){return c.apply(this,arguments)})},{key:"_sendCreate",value:function(_){var m=qr.createCreate(_);return this._ctx.sender.send(m)}},{key:"_sendGetRoom",value:function(_){var m=qr.createGet(_);return this._ctx.sender.send(m)}},{key:"clear",value:function(){var _,m=Hr(this._rooms.values());try{for(m.s();!(_=m.n()).done;){var v=_.value;v.isOnCall&&v.exit()}}catch(I){m.e(I)}finally{m.f()}this._rooms.clear()}}]),o}();(function(o){o.DIALING="DIALING",o.RINGING="RINGING",o.RECONNECTING="RECONNECTING",o.RECONNECTED="RECONNECTED"})(Ma||(Ma={}));var Yg,no,Qg,kU=function(){function o(){ie(this,o),this.audioElms=new Map}var c,l;return se(o,[{key:"loadSound",value:(l=Bn(regeneratorRuntime.mark(function f(_,m){var v;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(typeof m=="string"&&m){I.next=2;break}return I.abrupt("return",!1);case 2:return(v=this._createAudio(_)).src=m,v.volume=0,I.prev=5,I.next=8,v.play();case 8:v.pause(),v.currentTime=0,v.volume=1,this.audioElms.set(_,v),I.next=18;break;case 14:return I.prev=14,I.t0=I.catch(5),ae.error(I.t0),I.abrupt("return",!1);case 18:return I.abrupt("return",!0);case 19:case"end":return I.stop()}},f,this,[[5,14]])})),function(f,_){return l.apply(this,arguments)})},{key:"unloadSound",value:function(f){return!!this.audioElms.get(f)&&this.audioElms.delete(f)}},{key:"playSound",value:(c=Bn(regeneratorRuntime.mark(function f(_){var m;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(m=this.audioElms.get(_)){v.next=3;break}return v.abrupt("return",!1);case 3:return v.prev=3,m.currentTime=0,v.next=7,m.play();case 7:v.next=13;break;case 9:return v.prev=9,v.t0=v.catch(3),ae.error(v.t0),v.abrupt("return",!1);case 13:return v.abrupt("return",!0);case 14:case"end":return v.stop()}},f,this,[[3,9]])})),function(f){return c.apply(this,arguments)})},{key:"stopSound",value:function(f){var _=this.audioElms.get(f);return!!_&&_.pause()}},{key:"stopAllSound",value:function(){var f,_=Hr(this.audioElms.values());try{for(_.s();!(f=_.n()).done;)f.value.pause()}catch(m){_.e(m)}finally{_.f()}}},{key:"isPlaying",value:function(f){var _=this.audioElms.get(f);return _&&!_.paused}},{key:"_isLoop",value:function(f){return f===Ma.DIALING||f===Ma.RINGING}},{key:"_createAudio",value:function(f){var _=new Audio;return _.autoplay=!1,_.muted=!1,_.loop=this._isLoop(f),_}}]),o}();function el(o){return function(c){var l=c.descriptor.value;return c.descriptor.value=function(){if(el.checkIE())throw new Error(o??"Method ".concat(c.key," is not supported in Internet Explorer"));for(var f=arguments.length,_=new Array(f),m=0;m<f;m++)_[m]=arguments[m];return l.call.apply(l,[this].concat(_))},c}}(function(o){o.INFO="INFO",o.WARNING="WARNING",o.ERROR="ERROR",o.NONE="NONE"})(Yg||(Yg={})),function(o){o.RECORDING="recording",o.NONE="none"}(no||(no={})),function(o){o.APNS="apns_voip",o.FCM="fcm_voip"}(Qg||(Qg={})),el.checkIE=function(){return!!window&&(window.navigator.userAgent.indexOf("MSIE ")>0||!!navigator.userAgent.match(/Trident.*rv:11\./))},el.messages={CALL_IS_NOT_SUPPORTED:"Call is not supported in Internet Explorer"};var Xr,nl,sT,Rd,Zg="1.10.20",uT=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return l}(ap),to=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.call(this)}return se(l,[{key:"getApiOption",value:function(){return{auth:this.getAuth(),path:this.getPath(),method:this.getMethod(),body:this.getData(),headers:this.getHeaders()}}},{key:"getAuth",value:function(){return!0}},{key:"getHeaders",value:function(){return{}}}]),l}(_s),DU=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).statsLog=f,_}return se(l,[{key:"getData",value:function(){return{log_group:"sdk_webrtc_statistics_v1.1",log_data:this.statsLog}}},{key:"getPath",value:function(){return"/v1/sdk/logs"}},{key:"getMethod",value:function(){return"POST"}}]),l}(to),LU=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this)).version=1,m.isOverflowLogs=_,m.logs=f,m}return se(l,[{key:"getData",value:function(){return{version:this.version,is_overflow_logs:this.isOverflowLogs,logs:this.getLogsData()}}},{key:"getPath",value:function(){return"/v1/sdk/debug_logs"}},{key:"getMethod",value:function(){return"POST"}},{key:"getLogsData",value:function(){return this.logs.map(function(f){return{log_dt:f.logDt,log_level:f.logLevel,log_message:f.logMessage}})}}]),l}(to),xU=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this)).appId=f,v.userId=_,v.accessToken=m,v}return se(l,[{key:"getAuth",value:function(){return!1}},{key:"getData",value:function(){return{app_id:this.appId,user_id:this.userId,access_token:this.accessToken}}},{key:"getPath",value:function(){return"/v1/users/".concat(encodeURIComponent(this.userId),"/login")}},{key:"getMethod",value:function(){return"POST"}}]),l}(to),UU=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this)).userId=f,v.params=_,v.next=m,v}return se(l,[{key:"getData",value:function(){}},{key:"getPath",value:function(){return"/v1/users/".concat(encodeURIComponent(this.userId),"/calls?").concat(this._createQuery())}},{key:"getMethod",value:function(){return"GET"}},{key:"_createQuery",value:function(){var f;return LI.createQuery({role:this.params.myRole,limit:this._applyLimitConstraints((f=this.params)===null||f===void 0?void 0:f.limit),start_ts:this.params.startedAt,end_ts:this.params.endedAt,end_result:this.params.endResults,next:this.next})}},{key:"_applyLimitConstraints",value:function(f){return f!=null?Math.min(Math.max(f,10),100):void 0}}]),l}(to),PU=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this)).userId=f,v.pushToken=_,v.tokenType=m,v}return se(l,[{key:"getAuth",value:function(){return!0}},{key:"getData",value:function(){return{token:this.pushToken,is_unique:!0}}},{key:"getPath",value:function(){return"/v1/users/".concat(encodeURIComponent(this.userId),"/push/").concat(this.tokenType)}},{key:"getMethod",value:function(){return"POST"}}]),l}(to),FU=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this)).userId=f,v.pushToken=_,v.tokenType=m,v}return se(l,[{key:"getAuth",value:function(){return!0}},{key:"getData",value:function(){return{}}},{key:"getPath",value:function(){return"/v1/users/".concat(encodeURIComponent(this.userId),"/push/").concat(this.tokenType,"/").concat(this.pushToken)}},{key:"getMethod",value:function(){return"DELETE"}}]),l}(to),HU=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this)).userId=f,m.tokenType=_,m}return se(l,[{key:"getAuth",value:function(){return!0}},{key:"getData",value:function(){return{}}},{key:"getPath",value:function(){return"/v1/users/".concat(encodeURIComponent(this.userId),"/push/").concat(this.tokenType)}},{key:"getMethod",value:function(){return"DELETE"}}]),l}(to),Jc=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).callId=f,_}return se(l,[{key:"getPath",value:function(){return"/v1/direct_calls".concat(this.getSubPath())}}]),l}(to);(function(o){o.CALL="CALL",o.SGNL="SGNL",o.COMM="COMM",o.UTIL="UTIL"})(Xr||(Xr={})),function(o){o[o.WS=0]="WS",o[o.API=1]="API",o[o.BOTH=2]="BOTH"}(nl||(nl={})),function(o){o.API="api",o.CMD_RETRIEVING="cmd_retrieving",o.WEBHOOK="webhook",o.WS="ws",o.PUSH="push"}(sT||(sT={})),function(o){o.REMOTE_PUSH="remote_push",o.VOIP_PUSH="voip_push",o.WEBHOOK="webhook",o.WS="ws"}(Rd||(Rd={}));var He,_i=function(o){ce(l,o);var c=fe(l);function l(){var f;return ie(this,l),(f=c.call(this)).version=1,f.requestId=dp(),f}return se(l,[{key:"getApiOption",value:function(){return{auth:!0,path:"/v1/action/direct_call",method:"POST",headers:this.getHeaders(),body:{version:this.version,request_id:this.requestId,cmd:this.getCMD(),type:this.getType(),payload:this.getData()}}}},{key:"serialize",value:function(){return JSON.stringify({version:this.version,request_id:this.requestId,cmd:this.getCMD(),type:this.getType(),payload:this.getData()})}},{key:"requireResponse",value:function(){return!1}},{key:"getHeaders",value:function(){return{}}},{key:"sendStrategy",get:function(){return nl.WS}}]),l}(_s),oT=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).cmd=f.cmd,_.type=f.type,_.payload=f.payload||{},_}return l}(_s),lT=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"getCallId",value:function(){return this.payload.callId}}]),l}(oT),Li=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).version=f.version,_.messageId=f.message_id,_.cmd=f.cmd,_.type=f.type,_.deliveryInfo=f.delivery_info,_.sequenceNumber=f.sequence_number,_.payload=_.parseData(f.payload),_}return se(l,[{key:"getCallId",value:function(){return this.payload.callId}},{key:"isSequential",value:function(){return typeof this.sequenceNumber=="number"}}]),l}(_s),Md=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).version=f.version,_.requestId=f.request_id,_.cmd=f.cmd,_.type=f.type,_.deliveryInfo=f.delivery_info,_.sequenceNumber=f.sequence_number,_.payload=_.parseData(f.payload),_}return se(l,[{key:"getCallId",value:function(){return this.payload.callId}},{key:"isSequential",value:function(){return typeof this.sequenceNumber=="number"}}]),l}(_s),dT=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).version=f.version,_.messageId=f.message_id,_.cmd=f.cmd,_.type=f.type,_.deliveryInfo=f.delivery_info,_.sequenceNumber=f.sequence_number,_.payload=_.parseData(f.payload),_}return se(l,[{key:"isSequential",value:function(){return typeof this.sequenceNumber=="number"}}]),l}(_s),cT=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"getCallId",value:function(){return this.payload.callId}}]),l}(dT),BU=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this,null)).callIds=f,_}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getData",value:function(){}},{key:"getSubPath",value:function(){var f=this.callIds.join(",");return"/missed_signal?call_ids=".concat(encodeURIComponent(f))}},{key:"getMethod",value:function(){return"GET"}}]),l}(Jc),GU=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"getData",value:function(){return{}}},{key:"getSubPath",value:function(){return"/".concat(this.callId,"/custom_items")}},{key:"getMethod",value:function(){return"DELETE"}}]),l}(Jc),VU=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this,f)).keys=_,m}return se(l,[{key:"getData",value:function(){return{keys:this.keys}}},{key:"getSubPath",value:function(){return"/".concat(this.callId,"/custom_items")}},{key:"getMethod",value:function(){return"DELETE"}}]),l}(Jc),jU=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this,f)).customItems=_,m}return se(l,[{key:"getData",value:function(){return{custom_items:this.customItems,mode:"upsert"}}},{key:"getSubPath",value:function(){return"/".concat(this.callId,"/custom_items")}},{key:"getMethod",value:function(){return"PUT"}}]),l}(Jc),qU=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this,f)).userRole=_,v.data=m,v}return se(l,[{key:"getData",value:function(){return{version:1,user_role:this.userRole,summary_data:this.data}}},{key:"getSubPath",value:function(){return"/".concat(this.callId,"/summary")}},{key:"getMethod",value:function(){return"POST"}}]),l}(Jc);(function(o){o.DIAL="dial",o.DIAL_ACK="dial_ack",o.DIAL_RCV="dial_rcv",o.CANCEL="cancel",o.ACCEPT="accept",o.ACCEPT_ACK="accept_ack",o.OTHER_DEVICE_ACCEPTED="other_device_accepted",o.DECLINE="decline",o.DECLINE_ACK="decline_ack",o.OFFER="offer",o.ANSWER="answer",o.CANDIDATE="candidate",o.REMOVE_CANDIDATES="remove_candidates",o.AUDIO="audio",o.VIDEO="video",o.HOLD="hold",o.HOLD_ACK="hold_ack",o.CUSTOM_ITEMS_UPDATE="custom_items_update",o.CUSTOM_ITEMS_DELETE="custom_items_delete",o.RECORDING="recording",o.END="end",o.TIME_OUT="timeout",o.CONNECTION_LOST="connection_lost",o.UNKNOWN_END="unknown_end",o.ALIVE="alive",o.NO_ANSWER="no_answer",o.CANCEL_ACK="cancel_ack",o.END_ACK="end_ack",o.TIMEOUT_ACK="timeout_ack",o.NO_ANSWER_ACK="no_answer_ack",o.CONNECTION_LOST_ACK="connection_lost_ack",o.UNKNOWN_END_ACK="unknown_end_ack",o.ALIVE_ACK="alive_ack",o.CONNECTED="connected",o.SNAPSHOT="snapshot",o.TURN_CHANGED="turn_changed"})(He||(He={}));var zU=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,{type:He.DECLINE_ACK,cmd:Xr.SGNL,payload:f})),"type",He.DECLINE_ACK),_}return l}(lT),KU=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),qe(je(_=c.call(this,{type:He.SNAPSHOT,cmd:Xr.SGNL,payload:f})),"type",He.SNAPSHOT),_}return l}(lT),WU=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.ACCEPT),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,turnCredential:{username:f.turn_credential.username,password:f.turn_credential.password,turnUrls:f.turn_credential.turn_urls,transportPolicy:f.turn_credential.transport_policy},constraints:{audio:f.audio,video:f.video},capabilities:f.capabilities||[]}}}]),l}(Li),fT=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.OTHER_DEVICE_ACCEPTED),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id}}}]),l}(Li),It=r(function(o,c){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function f(v,I){return Object.prototype.hasOwnProperty.call(v,I)}c.assign=function(v){for(var I=Array.prototype.slice.call(arguments,1);I.length;){var S=I.shift();if(S){if(typeof S!="object")throw new TypeError(S+"must be non-object");for(var w in S)f(S,w)&&(v[w]=S[w])}}return v},c.shrinkBuf=function(v,I){return v.length===I?v:v.subarray?v.subarray(0,I):(v.length=I,v)};var _={arraySet:function(v,I,S,w,G){if(I.subarray&&v.subarray)v.set(I.subarray(S,S+w),G);else for(var H=0;H<w;H++)v[G+H]=I[S+H]},flattenChunks:function(v){var I,S,w,G,H,x;for(w=0,I=0,S=v.length;I<S;I++)w+=v[I].length;for(x=new Uint8Array(w),G=0,I=0,S=v.length;I<S;I++)H=v[I],x.set(H,G),G+=H.length;return x}},m={arraySet:function(v,I,S,w,G){for(var H=0;H<w;H++)v[G+H]=I[S+H]},flattenChunks:function(v){return[].concat.apply([],v)}};c.setTyped=function(v){v?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,c.assign(c,_)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,m))},c.setTyped(l)}),$U=(It.assign,It.shrinkBuf,It.setTyped,It.Buf8,It.Buf16,It.Buf32,4),hT=0,pT=1,YU=2;function Od(o){for(var c=o.length;--c>=0;)o[c]=0}var QU=0,_T=1,ZU=2,Xg=29,ef=256,nf=ef+1+Xg,kd=30,Jg=19,mT=2*nf+1,tl=15,ev=16,XU=7,nv=256,gT=16,vT=17,ET=18,tv=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],bp=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],JU=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],yT=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],yu=new Array(2*(nf+2));Od(yu);var tf=new Array(2*kd);Od(tf);var rf=new Array(512);Od(rf);var af=new Array(256);Od(af);var rv=new Array(Xg);Od(rv);var bT,CT,IT,Cp=new Array(kd);function iv(o,c,l,f,_){this.static_tree=o,this.extra_bits=c,this.extra_base=l,this.elems=f,this.max_length=_,this.has_stree=o&&o.length}function av(o,c){this.dyn_tree=o,this.max_code=0,this.stat_desc=c}function TT(o){return o<256?rf[o]:rf[256+(o>>>7)]}function sf(o,c){o.pending_buf[o.pending++]=255&c,o.pending_buf[o.pending++]=c>>>8&255}function ba(o,c,l){o.bi_valid>ev-l?(o.bi_buf|=c<<o.bi_valid&65535,sf(o,o.bi_buf),o.bi_buf=c>>ev-o.bi_valid,o.bi_valid+=l-ev):(o.bi_buf|=c<<o.bi_valid&65535,o.bi_valid+=l)}function Fs(o,c,l){ba(o,l[2*c],l[2*c+1])}function ST(o,c){var l=0;do l|=1&o,o>>>=1,l<<=1;while(--c>0);return l>>>1}function NT(o,c,l){var f,_,m=new Array(tl+1),v=0;for(f=1;f<=tl;f++)m[f]=v=v+l[f-1]<<1;for(_=0;_<=c;_++){var I=o[2*_+1];I!==0&&(o[2*_]=ST(m[I]++,I))}}function AT(o){var c;for(c=0;c<nf;c++)o.dyn_ltree[2*c]=0;for(c=0;c<kd;c++)o.dyn_dtree[2*c]=0;for(c=0;c<Jg;c++)o.bl_tree[2*c]=0;o.dyn_ltree[2*nv]=1,o.opt_len=o.static_len=0,o.last_lit=o.matches=0}function wT(o){o.bi_valid>8?sf(o,o.bi_buf):o.bi_valid>0&&(o.pending_buf[o.pending++]=o.bi_buf),o.bi_buf=0,o.bi_valid=0}function RT(o,c,l,f){var _=2*c,m=2*l;return o[_]<o[m]||o[_]===o[m]&&f[c]<=f[l]}function sv(o,c,l){for(var f=o.heap[l],_=l<<1;_<=o.heap_len&&(_<o.heap_len&&RT(c,o.heap[_+1],o.heap[_],o.depth)&&_++,!RT(c,f,o.heap[_],o.depth));)o.heap[l]=o.heap[_],l=_,_<<=1;o.heap[l]=f}function MT(o,c,l){var f,_,m,v,I=0;if(o.last_lit!==0)do f=o.pending_buf[o.d_buf+2*I]<<8|o.pending_buf[o.d_buf+2*I+1],_=o.pending_buf[o.l_buf+I],I++,f===0?Fs(o,_,c):(Fs(o,(m=af[_])+ef+1,c),(v=tv[m])!==0&&ba(o,_-=rv[m],v),Fs(o,m=TT(--f),l),(v=bp[m])!==0&&ba(o,f-=Cp[m],v));while(I<o.last_lit);Fs(o,nv,c)}function uv(o,c){var l,f,_,m=c.dyn_tree,v=c.stat_desc.static_tree,I=c.stat_desc.has_stree,S=c.stat_desc.elems,w=-1;for(o.heap_len=0,o.heap_max=mT,l=0;l<S;l++)m[2*l]!==0?(o.heap[++o.heap_len]=w=l,o.depth[l]=0):m[2*l+1]=0;for(;o.heap_len<2;)m[2*(_=o.heap[++o.heap_len]=w<2?++w:0)]=1,o.depth[_]=0,o.opt_len--,I&&(o.static_len-=v[2*_+1]);for(c.max_code=w,l=o.heap_len>>1;l>=1;l--)sv(o,m,l);_=S;do l=o.heap[1],o.heap[1]=o.heap[o.heap_len--],sv(o,m,1),f=o.heap[1],o.heap[--o.heap_max]=l,o.heap[--o.heap_max]=f,m[2*_]=m[2*l]+m[2*f],o.depth[_]=(o.depth[l]>=o.depth[f]?o.depth[l]:o.depth[f])+1,m[2*l+1]=m[2*f+1]=_,o.heap[1]=_++,sv(o,m,1);while(o.heap_len>=2);o.heap[--o.heap_max]=o.heap[1],function(G,H){var x,V,K,te,me,_e,ye=H.dyn_tree,Xe=H.max_code,on=H.stat_desc.static_tree,Mn=H.stat_desc.has_stree,Zn=H.stat_desc.extra_bits,Xn=H.stat_desc.extra_base,Nt=H.stat_desc.max_length,kt=0;for(te=0;te<=tl;te++)G.bl_count[te]=0;for(ye[2*G.heap[G.heap_max]+1]=0,x=G.heap_max+1;x<mT;x++)(te=ye[2*ye[2*(V=G.heap[x])+1]+1]+1)>Nt&&(te=Nt,kt++),ye[2*V+1]=te,V>Xe||(G.bl_count[te]++,me=0,V>=Xn&&(me=Zn[V-Xn]),_e=ye[2*V],G.opt_len+=_e*(te+me),Mn&&(G.static_len+=_e*(on[2*V+1]+me)));if(kt!==0){do{for(te=Nt-1;G.bl_count[te]===0;)te--;G.bl_count[te]--,G.bl_count[te+1]+=2,G.bl_count[Nt]--,kt-=2}while(kt>0);for(te=Nt;te!==0;te--)for(V=G.bl_count[te];V!==0;)(K=G.heap[--x])>Xe||(ye[2*K+1]!==te&&(G.opt_len+=(te-ye[2*K+1])*ye[2*K],ye[2*K+1]=te),V--)}}(o,c),NT(m,w,o.bl_count)}function OT(o,c,l){var f,_,m=-1,v=c[1],I=0,S=7,w=4;for(v===0&&(S=138,w=3),c[2*(l+1)+1]=65535,f=0;f<=l;f++)_=v,v=c[2*(f+1)+1],++I<S&&_===v||(I<w?o.bl_tree[2*_]+=I:_!==0?(_!==m&&o.bl_tree[2*_]++,o.bl_tree[2*gT]++):I<=10?o.bl_tree[2*vT]++:o.bl_tree[2*ET]++,I=0,m=_,v===0?(S=138,w=3):_===v?(S=6,w=3):(S=7,w=4))}function kT(o,c,l){var f,_,m=-1,v=c[1],I=0,S=7,w=4;for(v===0&&(S=138,w=3),f=0;f<=l;f++)if(_=v,v=c[2*(f+1)+1],!(++I<S&&_===v)){if(I<w)do Fs(o,_,o.bl_tree);while(--I!=0);else _!==0?(_!==m&&(Fs(o,_,o.bl_tree),I--),Fs(o,gT,o.bl_tree),ba(o,I-3,2)):I<=10?(Fs(o,vT,o.bl_tree),ba(o,I-3,3)):(Fs(o,ET,o.bl_tree),ba(o,I-11,7));I=0,m=_,v===0?(S=138,w=3):_===v?(S=6,w=3):(S=7,w=4)}}Od(Cp);var DT=!1;function LT(o,c,l,f){ba(o,(QU<<1)+(f?1:0),3),function(_,m,v,I){wT(_),sf(_,v),sf(_,~v),It.arraySet(_.pending_buf,_.window,m,v,_.pending),_.pending+=v}(o,c,l)}var eP=function(o,c,l,f){var _,m,v=0;o.level>0?(o.strm.data_type===YU&&(o.strm.data_type=function(I){var S,w=4093624447;for(S=0;S<=31;S++,w>>>=1)if(1&w&&I.dyn_ltree[2*S]!==0)return hT;if(I.dyn_ltree[18]!==0||I.dyn_ltree[20]!==0||I.dyn_ltree[26]!==0)return pT;for(S=32;S<ef;S++)if(I.dyn_ltree[2*S]!==0)return pT;return hT}(o)),uv(o,o.l_desc),uv(o,o.d_desc),v=function(I){var S;for(OT(I,I.dyn_ltree,I.l_desc.max_code),OT(I,I.dyn_dtree,I.d_desc.max_code),uv(I,I.bl_desc),S=Jg-1;S>=3&&I.bl_tree[2*yT[S]+1]===0;S--);return I.opt_len+=3*(S+1)+5+5+4,S}(o),_=o.opt_len+3+7>>>3,(m=o.static_len+3+7>>>3)<=_&&(_=m)):_=m=l+5,l+4<=_&&c!==-1?LT(o,c,l,f):o.strategy===$U||m===_?(ba(o,(_T<<1)+(f?1:0),3),MT(o,yu,tf)):(ba(o,(ZU<<1)+(f?1:0),3),function(I,S,w,G){var H;for(ba(I,S-257,5),ba(I,w-1,5),ba(I,G-4,4),H=0;H<G;H++)ba(I,I.bl_tree[2*yT[H]+1],3);kT(I,I.dyn_ltree,S-1),kT(I,I.dyn_dtree,w-1)}(o,o.l_desc.max_code+1,o.d_desc.max_code+1,v+1),MT(o,o.dyn_ltree,o.dyn_dtree)),AT(o),f&&wT(o)},es={_tr_init:function(o){DT||(function(){var c,l,f,_,m,v=new Array(tl+1);for(f=0,_=0;_<Xg-1;_++)for(rv[_]=f,c=0;c<1<<tv[_];c++)af[f++]=_;for(af[f-1]=_,m=0,_=0;_<16;_++)for(Cp[_]=m,c=0;c<1<<bp[_];c++)rf[m++]=_;for(m>>=7;_<kd;_++)for(Cp[_]=m<<7,c=0;c<1<<bp[_]-7;c++)rf[256+m++]=_;for(l=0;l<=tl;l++)v[l]=0;for(c=0;c<=143;)yu[2*c+1]=8,c++,v[8]++;for(;c<=255;)yu[2*c+1]=9,c++,v[9]++;for(;c<=279;)yu[2*c+1]=7,c++,v[7]++;for(;c<=287;)yu[2*c+1]=8,c++,v[8]++;for(NT(yu,nf+1,v),c=0;c<kd;c++)tf[2*c+1]=5,tf[2*c]=ST(c,5);bT=new iv(yu,tv,ef+1,nf,tl),CT=new iv(tf,bp,0,kd,tl),IT=new iv(new Array(0),JU,0,Jg,XU)}(),DT=!0),o.l_desc=new av(o.dyn_ltree,bT),o.d_desc=new av(o.dyn_dtree,CT),o.bl_desc=new av(o.bl_tree,IT),o.bi_buf=0,o.bi_valid=0,AT(o)},_tr_stored_block:LT,_tr_flush_block:eP,_tr_tally:function(o,c,l){return o.pending_buf[o.d_buf+2*o.last_lit]=c>>>8&255,o.pending_buf[o.d_buf+2*o.last_lit+1]=255&c,o.pending_buf[o.l_buf+o.last_lit]=255&l,o.last_lit++,c===0?o.dyn_ltree[2*l]++:(o.matches++,c--,o.dyn_ltree[2*(af[l]+ef+1)]++,o.dyn_dtree[2*TT(c)]++),o.last_lit===o.lit_bufsize-1},_tr_align:function(o){ba(o,_T<<1,3),Fs(o,nv,yu),function(c){c.bi_valid===16?(sf(c,c.bi_buf),c.bi_buf=0,c.bi_valid=0):c.bi_valid>=8&&(c.pending_buf[c.pending++]=255&c.bi_buf,c.bi_buf>>=8,c.bi_valid-=8)}(o)}},uf=function(o,c,l,f){for(var _=65535&o|0,m=o>>>16&65535|0,v=0;l!==0;){l-=v=l>2e3?2e3:l;do m=m+(_=_+c[f++]|0)|0;while(--v);_%=65521,m%=65521}return _|m<<16|0},nP=function(){for(var o,c=[],l=0;l<256;l++){o=l;for(var f=0;f<8;f++)o=1&o?3988292384^o>>>1:o>>>1;c[l]=o}return c}(),Dd,yi=function(o,c,l,f){var _=nP,m=f+l;o^=-1;for(var v=f;v<m;v++)o=o>>>8^_[255&(o^c[v])];return-1^o},rl={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},il=0,tP=1,rP=3,ro=4,xT=5,Hs=0,UT=1,ns=-2,iP=-3,ov=-5,aP=-1,sP=1,Ip=2,uP=3,oP=4,lP=0,dP=2,Tp=8,cP=9,fP=15,hP=8,lv=286,pP=30,_P=19,mP=2*lv+1,gP=15,sr=3,io=258,ms=io+sr+1,vP=32,Sp=42,dv=69,Np=73,Ap=91,wp=103,al=113,of=666,bi=1,lf=2,sl=3,Ld=4,EP=3;function ao(o,c){return o.msg=rl[c],c}function PT(o){return(o<<1)-(o>4?9:0)}function so(o){for(var c=o.length;--c>=0;)o[c]=0}function uo(o){var c=o.state,l=c.pending;l>o.avail_out&&(l=o.avail_out),l!==0&&(It.arraySet(o.output,c.pending_buf,c.pending_out,l,o.next_out),o.next_out+=l,c.pending_out+=l,o.total_out+=l,o.avail_out-=l,c.pending-=l,c.pending===0&&(c.pending_out=0))}function xi(o,c){es._tr_flush_block(o,o.block_start>=0?o.block_start:-1,o.strstart-o.block_start,c),o.block_start=o.strstart,uo(o.strm)}function hr(o,c){o.pending_buf[o.pending++]=c}function df(o,c){o.pending_buf[o.pending++]=c>>>8&255,o.pending_buf[o.pending++]=255&c}function FT(o,c){var l,f,_=o.max_chain_length,m=o.strstart,v=o.prev_length,I=o.nice_match,S=o.strstart>o.w_size-ms?o.strstart-(o.w_size-ms):0,w=o.window,G=o.w_mask,H=o.prev,x=o.strstart+io,V=w[m+v-1],K=w[m+v];o.prev_length>=o.good_match&&(_>>=2),I>o.lookahead&&(I=o.lookahead);do if(w[(l=c)+v]===K&&w[l+v-1]===V&&w[l]===w[m]&&w[++l]===w[m+1]){m+=2,l++;do;while(w[++m]===w[++l]&&w[++m]===w[++l]&&w[++m]===w[++l]&&w[++m]===w[++l]&&w[++m]===w[++l]&&w[++m]===w[++l]&&w[++m]===w[++l]&&w[++m]===w[++l]&&m<x);if(f=io-(x-m),m=x-io,f>v){if(o.match_start=c,v=f,f>=I)break;V=w[m+v-1],K=w[m+v]}}while((c=H[c&G])>S&&--_!=0);return v<=o.lookahead?v:o.lookahead}function ul(o){var c,l,f,_,m,v,I,S,w,G,H=o.w_size;do{if(_=o.window_size-o.lookahead-o.strstart,o.strstart>=H+(H-ms)){It.arraySet(o.window,o.window,H,H,0),o.match_start-=H,o.strstart-=H,o.block_start-=H,c=l=o.hash_size;do f=o.head[--c],o.head[c]=f>=H?f-H:0;while(--l);c=l=H;do f=o.prev[--c],o.prev[c]=f>=H?f-H:0;while(--l);_+=H}if(o.strm.avail_in===0)break;if(v=o.strm,I=o.window,S=o.strstart+o.lookahead,w=_,G=void 0,(G=v.avail_in)>w&&(G=w),l=G===0?0:(v.avail_in-=G,It.arraySet(I,v.input,v.next_in,G,S),v.state.wrap===1?v.adler=uf(v.adler,I,G,S):v.state.wrap===2&&(v.adler=yi(v.adler,I,G,S)),v.next_in+=G,v.total_in+=G,G),o.lookahead+=l,o.lookahead+o.insert>=sr)for(m=o.strstart-o.insert,o.ins_h=o.window[m],o.ins_h=(o.ins_h<<o.hash_shift^o.window[m+1])&o.hash_mask;o.insert&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[m+sr-1])&o.hash_mask,o.prev[m&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=m,m++,o.insert--,!(o.lookahead+o.insert<sr)););}while(o.lookahead<ms&&o.strm.avail_in!==0)}function cv(o,c){for(var l,f;;){if(o.lookahead<ms){if(ul(o),o.lookahead<ms&&c===il)return bi;if(o.lookahead===0)break}if(l=0,o.lookahead>=sr&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+sr-1])&o.hash_mask,l=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),l!==0&&o.strstart-l<=o.w_size-ms&&(o.match_length=FT(o,l)),o.match_length>=sr)if(f=es._tr_tally(o,o.strstart-o.match_start,o.match_length-sr),o.lookahead-=o.match_length,o.match_length<=o.max_lazy_match&&o.lookahead>=sr){o.match_length--;do o.strstart++,o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+sr-1])&o.hash_mask,l=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart;while(--o.match_length!=0);o.strstart++}else o.strstart+=o.match_length,o.match_length=0,o.ins_h=o.window[o.strstart],o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+1])&o.hash_mask;else f=es._tr_tally(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++;if(f&&(xi(o,!1),o.strm.avail_out===0))return bi}return o.insert=o.strstart<sr-1?o.strstart:sr-1,c===ro?(xi(o,!0),o.strm.avail_out===0?sl:Ld):o.last_lit&&(xi(o,!1),o.strm.avail_out===0)?bi:lf}function xd(o,c){for(var l,f,_;;){if(o.lookahead<ms){if(ul(o),o.lookahead<ms&&c===il)return bi;if(o.lookahead===0)break}if(l=0,o.lookahead>=sr&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+sr-1])&o.hash_mask,l=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),o.prev_length=o.match_length,o.prev_match=o.match_start,o.match_length=sr-1,l!==0&&o.prev_length<o.max_lazy_match&&o.strstart-l<=o.w_size-ms&&(o.match_length=FT(o,l),o.match_length<=5&&(o.strategy===sP||o.match_length===sr&&o.strstart-o.match_start>4096)&&(o.match_length=sr-1)),o.prev_length>=sr&&o.match_length<=o.prev_length){_=o.strstart+o.lookahead-sr,f=es._tr_tally(o,o.strstart-1-o.prev_match,o.prev_length-sr),o.lookahead-=o.prev_length-1,o.prev_length-=2;do++o.strstart<=_&&(o.ins_h=(o.ins_h<<o.hash_shift^o.window[o.strstart+sr-1])&o.hash_mask,l=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart);while(--o.prev_length!=0);if(o.match_available=0,o.match_length=sr-1,o.strstart++,f&&(xi(o,!1),o.strm.avail_out===0))return bi}else if(o.match_available){if((f=es._tr_tally(o,0,o.window[o.strstart-1]))&&xi(o,!1),o.strstart++,o.lookahead--,o.strm.avail_out===0)return bi}else o.match_available=1,o.strstart++,o.lookahead--}return o.match_available&&(f=es._tr_tally(o,0,o.window[o.strstart-1]),o.match_available=0),o.insert=o.strstart<sr-1?o.strstart:sr-1,c===ro?(xi(o,!0),o.strm.avail_out===0?sl:Ld):o.last_lit&&(xi(o,!1),o.strm.avail_out===0)?bi:lf}function Bs(o,c,l,f,_){this.good_length=o,this.max_lazy=c,this.nice_length=l,this.max_chain=f,this.func=_}function yP(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Tp,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new It.Buf16(2*mP),this.dyn_dtree=new It.Buf16(2*(2*pP+1)),this.bl_tree=new It.Buf16(2*(2*_P+1)),so(this.dyn_ltree),so(this.dyn_dtree),so(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new It.Buf16(gP+1),this.heap=new It.Buf16(2*lv+1),so(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new It.Buf16(2*lv+1),so(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function HT(o){var c;return o&&o.state?(o.total_in=o.total_out=0,o.data_type=dP,(c=o.state).pending=0,c.pending_out=0,c.wrap<0&&(c.wrap=-c.wrap),c.status=c.wrap?Sp:al,o.adler=c.wrap===2?0:1,c.last_flush=il,es._tr_init(c),Hs):ao(o,ns)}function BT(o){var c,l=HT(o);return l===Hs&&((c=o.state).window_size=2*c.w_size,so(c.head),c.max_lazy_match=Dd[c.level].max_lazy,c.good_match=Dd[c.level].good_length,c.nice_match=Dd[c.level].nice_length,c.max_chain_length=Dd[c.level].max_chain,c.strstart=0,c.block_start=0,c.lookahead=0,c.insert=0,c.match_length=c.prev_length=sr-1,c.match_available=0,c.ins_h=0),l}function GT(o,c,l,f,_,m){if(!o)return ns;var v=1;if(c===aP&&(c=6),f<0?(v=0,f=-f):f>15&&(v=2,f-=16),_<1||_>cP||l!==Tp||f<8||f>15||c<0||c>9||m<0||m>oP)return ao(o,ns);f===8&&(f=9);var I=new yP;return o.state=I,I.strm=o,I.wrap=v,I.gzhead=null,I.w_bits=f,I.w_size=1<<I.w_bits,I.w_mask=I.w_size-1,I.hash_bits=_+7,I.hash_size=1<<I.hash_bits,I.hash_mask=I.hash_size-1,I.hash_shift=~~((I.hash_bits+sr-1)/sr),I.window=new It.Buf8(2*I.w_size),I.head=new It.Buf16(I.hash_size),I.prev=new It.Buf16(I.w_size),I.lit_bufsize=1<<_+6,I.pending_buf_size=4*I.lit_bufsize,I.pending_buf=new It.Buf8(I.pending_buf_size),I.d_buf=1*I.lit_bufsize,I.l_buf=3*I.lit_bufsize,I.level=c,I.strategy=m,I.method=l,BT(o)}Dd=[new Bs(0,0,0,0,function(o,c){var l=65535;for(l>o.pending_buf_size-5&&(l=o.pending_buf_size-5);;){if(o.lookahead<=1){if(ul(o),o.lookahead===0&&c===il)return bi;if(o.lookahead===0)break}o.strstart+=o.lookahead,o.lookahead=0;var f=o.block_start+l;if((o.strstart===0||o.strstart>=f)&&(o.lookahead=o.strstart-f,o.strstart=f,xi(o,!1),o.strm.avail_out===0)||o.strstart-o.block_start>=o.w_size-ms&&(xi(o,!1),o.strm.avail_out===0))return bi}return o.insert=0,c===ro?(xi(o,!0),o.strm.avail_out===0?sl:Ld):(o.strstart>o.block_start&&(xi(o,!1),o.strm.avail_out),bi)}),new Bs(4,4,8,4,cv),new Bs(4,5,16,8,cv),new Bs(4,6,32,32,cv),new Bs(4,4,16,16,xd),new Bs(8,16,32,32,xd),new Bs(8,16,128,128,xd),new Bs(8,32,128,256,xd),new Bs(32,128,258,1024,xd),new Bs(32,258,258,4096,xd)];var bP=function(o,c){return o&&o.state?o.state.wrap!==2?ns:(o.state.gzhead=c,Hs):ns},CP=function(o,c){var l,f,_,m;if(!o||!o.state||c>xT||c<0)return o?ao(o,ns):ns;if(f=o.state,!o.output||!o.input&&o.avail_in!==0||f.status===of&&c!==ro)return ao(o,o.avail_out===0?ov:ns);if(f.strm=o,l=f.last_flush,f.last_flush=c,f.status===Sp)if(f.wrap===2)o.adler=0,hr(f,31),hr(f,139),hr(f,8),f.gzhead?(hr(f,(f.gzhead.text?1:0)+(f.gzhead.hcrc?2:0)+(f.gzhead.extra?4:0)+(f.gzhead.name?8:0)+(f.gzhead.comment?16:0)),hr(f,255&f.gzhead.time),hr(f,f.gzhead.time>>8&255),hr(f,f.gzhead.time>>16&255),hr(f,f.gzhead.time>>24&255),hr(f,f.level===9?2:f.strategy>=Ip||f.level<2?4:0),hr(f,255&f.gzhead.os),f.gzhead.extra&&f.gzhead.extra.length&&(hr(f,255&f.gzhead.extra.length),hr(f,f.gzhead.extra.length>>8&255)),f.gzhead.hcrc&&(o.adler=yi(o.adler,f.pending_buf,f.pending,0)),f.gzindex=0,f.status=dv):(hr(f,0),hr(f,0),hr(f,0),hr(f,0),hr(f,0),hr(f,f.level===9?2:f.strategy>=Ip||f.level<2?4:0),hr(f,EP),f.status=al);else{var v=Tp+(f.w_bits-8<<4)<<8;v|=(f.strategy>=Ip||f.level<2?0:f.level<6?1:f.level===6?2:3)<<6,f.strstart!==0&&(v|=vP),v+=31-v%31,f.status=al,df(f,v),f.strstart!==0&&(df(f,o.adler>>>16),df(f,65535&o.adler)),o.adler=1}if(f.status===dv)if(f.gzhead.extra){for(_=f.pending;f.gzindex<(65535&f.gzhead.extra.length)&&(f.pending!==f.pending_buf_size||(f.gzhead.hcrc&&f.pending>_&&(o.adler=yi(o.adler,f.pending_buf,f.pending-_,_)),uo(o),_=f.pending,f.pending!==f.pending_buf_size));)hr(f,255&f.gzhead.extra[f.gzindex]),f.gzindex++;f.gzhead.hcrc&&f.pending>_&&(o.adler=yi(o.adler,f.pending_buf,f.pending-_,_)),f.gzindex===f.gzhead.extra.length&&(f.gzindex=0,f.status=Np)}else f.status=Np;if(f.status===Np)if(f.gzhead.name){_=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>_&&(o.adler=yi(o.adler,f.pending_buf,f.pending-_,_)),uo(o),_=f.pending,f.pending===f.pending_buf_size)){m=1;break}m=f.gzindex<f.gzhead.name.length?255&f.gzhead.name.charCodeAt(f.gzindex++):0,hr(f,m)}while(m!==0);f.gzhead.hcrc&&f.pending>_&&(o.adler=yi(o.adler,f.pending_buf,f.pending-_,_)),m===0&&(f.gzindex=0,f.status=Ap)}else f.status=Ap;if(f.status===Ap)if(f.gzhead.comment){_=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>_&&(o.adler=yi(o.adler,f.pending_buf,f.pending-_,_)),uo(o),_=f.pending,f.pending===f.pending_buf_size)){m=1;break}m=f.gzindex<f.gzhead.comment.length?255&f.gzhead.comment.charCodeAt(f.gzindex++):0,hr(f,m)}while(m!==0);f.gzhead.hcrc&&f.pending>_&&(o.adler=yi(o.adler,f.pending_buf,f.pending-_,_)),m===0&&(f.status=wp)}else f.status=wp;if(f.status===wp&&(f.gzhead.hcrc?(f.pending+2>f.pending_buf_size&&uo(o),f.pending+2<=f.pending_buf_size&&(hr(f,255&o.adler),hr(f,o.adler>>8&255),o.adler=0,f.status=al)):f.status=al),f.pending!==0){if(uo(o),o.avail_out===0)return f.last_flush=-1,Hs}else if(o.avail_in===0&&PT(c)<=PT(l)&&c!==ro)return ao(o,ov);if(f.status===of&&o.avail_in!==0)return ao(o,ov);if(o.avail_in!==0||f.lookahead!==0||c!==il&&f.status!==of){var I=f.strategy===Ip?function(S,w){for(var G;;){if(S.lookahead===0&&(ul(S),S.lookahead===0)){if(w===il)return bi;break}if(S.match_length=0,G=es._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++,G&&(xi(S,!1),S.strm.avail_out===0))return bi}return S.insert=0,w===ro?(xi(S,!0),S.strm.avail_out===0?sl:Ld):S.last_lit&&(xi(S,!1),S.strm.avail_out===0)?bi:lf}(f,c):f.strategy===uP?function(S,w){for(var G,H,x,V,K=S.window;;){if(S.lookahead<=io){if(ul(S),S.lookahead<=io&&w===il)return bi;if(S.lookahead===0)break}if(S.match_length=0,S.lookahead>=sr&&S.strstart>0&&(H=K[x=S.strstart-1])===K[++x]&&H===K[++x]&&H===K[++x]){V=S.strstart+io;do;while(H===K[++x]&&H===K[++x]&&H===K[++x]&&H===K[++x]&&H===K[++x]&&H===K[++x]&&H===K[++x]&&H===K[++x]&&x<V);S.match_length=io-(V-x),S.match_length>S.lookahead&&(S.match_length=S.lookahead)}if(S.match_length>=sr?(G=es._tr_tally(S,1,S.match_length-sr),S.lookahead-=S.match_length,S.strstart+=S.match_length,S.match_length=0):(G=es._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++),G&&(xi(S,!1),S.strm.avail_out===0))return bi}return S.insert=0,w===ro?(xi(S,!0),S.strm.avail_out===0?sl:Ld):S.last_lit&&(xi(S,!1),S.strm.avail_out===0)?bi:lf}(f,c):Dd[f.level].func(f,c);if(I!==sl&&I!==Ld||(f.status=of),I===bi||I===sl)return o.avail_out===0&&(f.last_flush=-1),Hs;if(I===lf&&(c===tP?es._tr_align(f):c!==xT&&(es._tr_stored_block(f,0,0,!1),c===rP&&(so(f.head),f.lookahead===0&&(f.strstart=0,f.block_start=0,f.insert=0))),uo(o),o.avail_out===0))return f.last_flush=-1,Hs}return c!==ro?Hs:f.wrap<=0?UT:(f.wrap===2?(hr(f,255&o.adler),hr(f,o.adler>>8&255),hr(f,o.adler>>16&255),hr(f,o.adler>>24&255),hr(f,255&o.total_in),hr(f,o.total_in>>8&255),hr(f,o.total_in>>16&255),hr(f,o.total_in>>24&255)):(df(f,o.adler>>>16),df(f,65535&o.adler)),uo(o),f.wrap>0&&(f.wrap=-f.wrap),f.pending!==0?Hs:UT)},cf={deflateInit:function(o,c){return GT(o,c,Tp,fP,hP,lP)},deflateInit2:GT,deflateReset:BT,deflateResetKeep:HT,deflateSetHeader:bP,deflate:CP,deflateEnd:function(o){var c;return o&&o.state?(c=o.state.status)!==Sp&&c!==dv&&c!==Np&&c!==Ap&&c!==wp&&c!==al&&c!==of?ao(o,ns):(o.state=null,c===al?ao(o,iP):Hs):ns},deflateSetDictionary:function(o,c){var l,f,_,m,v,I,S,w,G=c.length;if(!o||!o.state||(m=(l=o.state).wrap)===2||m===1&&l.status!==Sp||l.lookahead)return ns;for(m===1&&(o.adler=uf(o.adler,c,G,0)),l.wrap=0,G>=l.w_size&&(m===0&&(so(l.head),l.strstart=0,l.block_start=0,l.insert=0),w=new It.Buf8(l.w_size),It.arraySet(w,c,G-l.w_size,l.w_size,0),c=w,G=l.w_size),v=o.avail_in,I=o.next_in,S=o.input,o.avail_in=G,o.next_in=0,o.input=c,ul(l);l.lookahead>=sr;){f=l.strstart,_=l.lookahead-(sr-1);do l.ins_h=(l.ins_h<<l.hash_shift^l.window[f+sr-1])&l.hash_mask,l.prev[f&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=f,f++;while(--_);l.strstart=f,l.lookahead=sr-1,ul(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=sr-1,l.match_available=0,o.next_in=I,o.input=S,o.avail_in=v,l.wrap=m,Hs},deflateInfo:"pako deflate (from Nodeca project)"},VT=!0,jT=!0;try{String.fromCharCode.apply(null,[0])}catch{VT=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{jT=!1}for(var ff=new It.Buf8(256),oo=0;oo<256;oo++)ff[oo]=oo>=252?6:oo>=248?5:oo>=240?4:oo>=224?3:oo>=192?2:1;ff[254]=ff[254]=1;function qT(o,c){if(c<65534&&(o.subarray&&jT||!o.subarray&&VT))return String.fromCharCode.apply(null,It.shrinkBuf(o,c));for(var l="",f=0;f<c;f++)l+=String.fromCharCode(o[f]);return l}var ol={string2buf:function(o){var c,l,f,_,m,v=o.length,I=0;for(_=0;_<v;_++)(64512&(l=o.charCodeAt(_)))==55296&&_+1<v&&(64512&(f=o.charCodeAt(_+1)))==56320&&(l=65536+(l-55296<<10)+(f-56320),_++),I+=l<128?1:l<2048?2:l<65536?3:4;for(c=new It.Buf8(I),m=0,_=0;m<I;_++)(64512&(l=o.charCodeAt(_)))==55296&&_+1<v&&(64512&(f=o.charCodeAt(_+1)))==56320&&(l=65536+(l-55296<<10)+(f-56320),_++),l<128?c[m++]=l:l<2048?(c[m++]=192|l>>>6,c[m++]=128|63&l):l<65536?(c[m++]=224|l>>>12,c[m++]=128|l>>>6&63,c[m++]=128|63&l):(c[m++]=240|l>>>18,c[m++]=128|l>>>12&63,c[m++]=128|l>>>6&63,c[m++]=128|63&l);return c},buf2binstring:function(o){return qT(o,o.length)},binstring2buf:function(o){for(var c=new It.Buf8(o.length),l=0,f=c.length;l<f;l++)c[l]=o.charCodeAt(l);return c},buf2string:function(o,c){var l,f,_,m,v=c||o.length,I=new Array(2*v);for(f=0,l=0;l<v;)if((_=o[l++])<128)I[f++]=_;else if((m=ff[_])>4)I[f++]=65533,l+=m-1;else{for(_&=m===2?31:m===3?15:7;m>1&&l<v;)_=_<<6|63&o[l++],m--;m>1?I[f++]=65533:_<65536?I[f++]=_:(_-=65536,I[f++]=55296|_>>10&1023,I[f++]=56320|1023&_)}return qT(I,f)},utf8border:function(o,c){var l;for((c=c||o.length)>o.length&&(c=o.length),l=c-1;l>=0&&(192&o[l])==128;)l--;return l<0||l===0?c:l+ff[o[l]]>c?l:c}},zT=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},KT=Object.prototype.toString,Ud=0,IP=-1,TP=0,SP=8;function ll(o){if(!(this instanceof ll))return new ll(o);this.options=It.assign({level:IP,method:SP,chunkSize:16384,windowBits:15,memLevel:8,strategy:TP,to:""},o||{});var c=this.options;c.raw&&c.windowBits>0?c.windowBits=-c.windowBits:c.gzip&&c.windowBits>0&&c.windowBits<16&&(c.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zT,this.strm.avail_out=0;var l=cf.deflateInit2(this.strm,c.level,c.method,c.windowBits,c.memLevel,c.strategy);if(l!==Ud)throw new Error(rl[l]);if(c.header&&cf.deflateSetHeader(this.strm,c.header),c.dictionary){var f;if(f=typeof c.dictionary=="string"?ol.string2buf(c.dictionary):KT.call(c.dictionary)==="[object ArrayBuffer]"?new Uint8Array(c.dictionary):c.dictionary,(l=cf.deflateSetDictionary(this.strm,f))!==Ud)throw new Error(rl[l]);this._dict_set=!0}}function fv(o,c){var l=new ll(c);if(l.push(o,!0),l.err)throw l.msg||rl[l.err];return l.result}ll.prototype.push=function(o,c){var l,f,_=this.strm,m=this.options.chunkSize;if(this.ended)return!1;f=c===~~c?c:c===!0?4:0,typeof o=="string"?_.input=ol.string2buf(o):KT.call(o)==="[object ArrayBuffer]"?_.input=new Uint8Array(o):_.input=o,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new It.Buf8(m),_.next_out=0,_.avail_out=m),(l=cf.deflate(_,f))!==1&&l!==Ud)return this.onEnd(l),this.ended=!0,!1;_.avail_out!==0&&(_.avail_in!==0||f!==4&&f!==2)||(this.options.to==="string"?this.onData(ol.buf2binstring(It.shrinkBuf(_.output,_.next_out))):this.onData(It.shrinkBuf(_.output,_.next_out)))}while((_.avail_in>0||_.avail_out===0)&&l!==1);return f===4?(l=cf.deflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===Ud):f!==2||(this.onEnd(Ud),_.avail_out=0,!0)},ll.prototype.onData=function(o){this.chunks.push(o)},ll.prototype.onEnd=function(o){o===Ud&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=It.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg};var NP={Deflate:ll,deflate:fv,deflateRaw:function(o,c){return(c=c||{}).raw=!0,fv(o,c)},gzip:function(o,c){return(c=c||{}).gzip=!0,fv(o,c)}},AP=function(o,c){var l,f,_,m,v,I,S,w,G,H,x,V,K,te,me,_e,ye,Xe,on,Mn,Zn,Xn,Nt,kt,et;l=o.state,f=o.next_in,kt=o.input,_=f+(o.avail_in-5),m=o.next_out,et=o.output,v=m-(c-o.avail_out),I=m+(o.avail_out-257),S=l.dmax,w=l.wsize,G=l.whave,H=l.wnext,x=l.window,V=l.hold,K=l.bits,te=l.lencode,me=l.distcode,_e=(1<<l.lenbits)-1,ye=(1<<l.distbits)-1;e:do{K<15&&(V+=kt[f++]<<K,K+=8,V+=kt[f++]<<K,K+=8),Xe=te[V&_e];n:for(;;){if(V>>>=on=Xe>>>24,K-=on,(on=Xe>>>16&255)===0)et[m++]=65535&Xe;else{if(!(16&on)){if(!(64&on)){Xe=te[(65535&Xe)+(V&(1<<on)-1)];continue n}if(32&on){l.mode=12;break e}o.msg="invalid literal/length code",l.mode=30;break e}Mn=65535&Xe,(on&=15)&&(K<on&&(V+=kt[f++]<<K,K+=8),Mn+=V&(1<<on)-1,V>>>=on,K-=on),K<15&&(V+=kt[f++]<<K,K+=8,V+=kt[f++]<<K,K+=8),Xe=me[V&ye];t:for(;;){if(V>>>=on=Xe>>>24,K-=on,!(16&(on=Xe>>>16&255))){if(!(64&on)){Xe=me[(65535&Xe)+(V&(1<<on)-1)];continue t}o.msg="invalid distance code",l.mode=30;break e}if(Zn=65535&Xe,K<(on&=15)&&(V+=kt[f++]<<K,(K+=8)<on&&(V+=kt[f++]<<K,K+=8)),(Zn+=V&(1<<on)-1)>S){o.msg="invalid distance too far back",l.mode=30;break e}if(V>>>=on,K-=on,Zn>(on=m-v)){if((on=Zn-on)>G&&l.sane){o.msg="invalid distance too far back",l.mode=30;break e}if(Xn=0,Nt=x,H===0){if(Xn+=w-on,on<Mn){Mn-=on;do et[m++]=x[Xn++];while(--on);Xn=m-Zn,Nt=et}}else if(H<on){if(Xn+=w+H-on,(on-=H)<Mn){Mn-=on;do et[m++]=x[Xn++];while(--on);if(Xn=0,H<Mn){Mn-=on=H;do et[m++]=x[Xn++];while(--on);Xn=m-Zn,Nt=et}}}else if(Xn+=H-on,on<Mn){Mn-=on;do et[m++]=x[Xn++];while(--on);Xn=m-Zn,Nt=et}for(;Mn>2;)et[m++]=Nt[Xn++],et[m++]=Nt[Xn++],et[m++]=Nt[Xn++],Mn-=3;Mn&&(et[m++]=Nt[Xn++],Mn>1&&(et[m++]=Nt[Xn++]))}else{Xn=m-Zn;do et[m++]=et[Xn++],et[m++]=et[Xn++],et[m++]=et[Xn++],Mn-=3;while(Mn>2);Mn&&(et[m++]=et[Xn++],Mn>1&&(et[m++]=et[Xn++]))}break}}break}}while(f<_&&m<I);f-=Mn=K>>3,V&=(1<<(K-=Mn<<3))-1,o.next_in=f,o.next_out=m,o.avail_in=f<_?_-f+5:5-(f-_),o.avail_out=m<I?I-m+257:257-(m-I),l.hold=V,l.bits=K},Rp=15,wP=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],RP=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],MP=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],OP=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],hf=function(o,c,l,f,_,m,v,I){var S,w,G,H,x,V,K,te,me,_e=I.bits,ye=0,Xe=0,on=0,Mn=0,Zn=0,Xn=0,Nt=0,kt=0,et=0,ir=0,ss=null,Cf=0,qs=new It.Buf16(16),co=new It.Buf16(16),fo=null,Wd=0;for(ye=0;ye<=Rp;ye++)qs[ye]=0;for(Xe=0;Xe<f;Xe++)qs[c[l+Xe]]++;for(Zn=_e,Mn=Rp;Mn>=1&&qs[Mn]===0;Mn--);if(Zn>Mn&&(Zn=Mn),Mn===0)return _[m++]=20971520,_[m++]=20971520,I.bits=1,0;for(on=1;on<Mn&&qs[on]===0;on++);for(Zn<on&&(Zn=on),kt=1,ye=1;ye<=Rp;ye++)if(kt<<=1,(kt-=qs[ye])<0)return-1;if(kt>0&&(o===0||Mn!==1))return-1;for(co[1]=0,ye=1;ye<Rp;ye++)co[ye+1]=co[ye]+qs[ye];for(Xe=0;Xe<f;Xe++)c[l+Xe]!==0&&(v[co[c[l+Xe]]++]=Xe);if(o===0?(ss=fo=v,V=19):o===1?(ss=wP,Cf-=257,fo=RP,Wd-=257,V=256):(ss=MP,fo=OP,V=-1),ir=0,Xe=0,ye=on,x=m,Xn=Zn,Nt=0,G=-1,H=(et=1<<Zn)-1,o===1&&et>852||o===2&&et>592)return 1;for(;;){K=ye-Nt,v[Xe]<V?(te=0,me=v[Xe]):v[Xe]>V?(te=fo[Wd+v[Xe]],me=ss[Cf+v[Xe]]):(te=96,me=0),S=1<<ye-Nt,on=w=1<<Xn;do _[x+(ir>>Nt)+(w-=S)]=K<<24|te<<16|me|0;while(w!==0);for(S=1<<ye-1;ir&S;)S>>=1;if(S!==0?(ir&=S-1,ir+=S):ir=0,Xe++,--qs[ye]==0){if(ye===Mn)break;ye=c[l+v[Xe]]}if(ye>Zn&&(ir&H)!==G){for(Nt===0&&(Nt=Zn),x+=on,kt=1<<(Xn=ye-Nt);Xn+Nt<Mn&&!((kt-=qs[Xn+Nt])<=0);)Xn++,kt<<=1;if(et+=1<<Xn,o===1&&et>852||o===2&&et>592)return 1;_[G=ir&H]=Zn<<24|Xn<<16|x-m|0}}return ir!==0&&(_[x+ir]=ye-Nt<<24|64<<16|0),I.bits=Zn,0},kP=0,WT=1,$T=2,YT=4,DP=5,Mp=6,dl=0,LP=1,xP=2,ts=-2,QT=-3,ZT=-4,UP=-5,XT=8,JT=1,eS=2,nS=3,tS=4,rS=5,iS=6,aS=7,sS=8,uS=9,oS=10,Op=11,bu=12,hv=13,lS=14,pv=15,dS=16,cS=17,fS=18,hS=19,kp=20,Dp=21,pS=22,_S=23,mS=24,gS=25,vS=26,_v=27,ES=28,yS=29,zr=30,bS=31,PP=852,FP=592,HP=15;function CS(o){return(o>>>24&255)+(o>>>8&65280)+((65280&o)<<8)+((255&o)<<24)}function BP(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new It.Buf16(320),this.work=new It.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function IS(o){var c;return o&&o.state?(c=o.state,o.total_in=o.total_out=c.total=0,o.msg="",c.wrap&&(o.adler=1&c.wrap),c.mode=JT,c.last=0,c.havedict=0,c.dmax=32768,c.head=null,c.hold=0,c.bits=0,c.lencode=c.lendyn=new It.Buf32(PP),c.distcode=c.distdyn=new It.Buf32(FP),c.sane=1,c.back=-1,dl):ts}function TS(o){var c;return o&&o.state?((c=o.state).wsize=0,c.whave=0,c.wnext=0,IS(o)):ts}function SS(o,c){var l,f;return o&&o.state?(f=o.state,c<0?(l=0,c=-c):(l=1+(c>>4),c<48&&(c&=15)),c&&(c<8||c>15)?ts:(f.window!==null&&f.wbits!==c&&(f.window=null),f.wrap=l,f.wbits=c,TS(o))):ts}function NS(o,c){var l,f;return o?(f=new BP,o.state=f,f.window=null,(l=SS(o,c))!==dl&&(o.state=null),l):ts}var mv,gv,AS=!0;function GP(o){if(AS){var c;for(mv=new It.Buf32(512),gv=new It.Buf32(32),c=0;c<144;)o.lens[c++]=8;for(;c<256;)o.lens[c++]=9;for(;c<280;)o.lens[c++]=7;for(;c<288;)o.lens[c++]=8;for(hf(WT,o.lens,0,288,mv,0,o.work,{bits:9}),c=0;c<32;)o.lens[c++]=5;hf($T,o.lens,0,32,gv,0,o.work,{bits:5}),AS=!1}o.lencode=mv,o.lenbits=9,o.distcode=gv,o.distbits=5}function wS(o,c,l,f){var _,m=o.state;return m.window===null&&(m.wsize=1<<m.wbits,m.wnext=0,m.whave=0,m.window=new It.Buf8(m.wsize)),f>=m.wsize?(It.arraySet(m.window,c,l-m.wsize,m.wsize,0),m.wnext=0,m.whave=m.wsize):((_=m.wsize-m.wnext)>f&&(_=f),It.arraySet(m.window,c,l-f,_,m.wnext),(f-=_)?(It.arraySet(m.window,c,l-f,f,0),m.wnext=f,m.whave=m.wsize):(m.wnext+=_,m.wnext===m.wsize&&(m.wnext=0),m.whave<m.wsize&&(m.whave+=_))),0}var VP=function(o,c){var l,f,_,m,v,I,S,w,G,H,x,V,K,te,me,_e,ye,Xe,on,Mn,Zn,Xn,Nt,kt,et=0,ir=new It.Buf8(4),ss=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!o||!o.state||!o.output||!o.input&&o.avail_in!==0)return ts;(l=o.state).mode===bu&&(l.mode=hv),v=o.next_out,_=o.output,S=o.avail_out,m=o.next_in,f=o.input,I=o.avail_in,w=l.hold,G=l.bits,H=I,x=S,Xn=dl;e:for(;;)switch(l.mode){case JT:if(l.wrap===0){l.mode=hv;break}for(;G<16;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(2&l.wrap&&w===35615){l.check=0,ir[0]=255&w,ir[1]=w>>>8&255,l.check=yi(l.check,ir,2,0),w=0,G=0,l.mode=eS;break}if(l.flags=0,l.head&&(l.head.done=!1),!(1&l.wrap)||(((255&w)<<8)+(w>>8))%31){o.msg="incorrect header check",l.mode=zr;break}if((15&w)!==XT){o.msg="unknown compression method",l.mode=zr;break}if(G-=4,Zn=8+(15&(w>>>=4)),l.wbits===0)l.wbits=Zn;else if(Zn>l.wbits){o.msg="invalid window size",l.mode=zr;break}l.dmax=1<<Zn,o.adler=l.check=1,l.mode=512&w?oS:bu,w=0,G=0;break;case eS:for(;G<16;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(l.flags=w,(255&l.flags)!==XT){o.msg="unknown compression method",l.mode=zr;break}if(57344&l.flags){o.msg="unknown header flags set",l.mode=zr;break}l.head&&(l.head.text=w>>8&1),512&l.flags&&(ir[0]=255&w,ir[1]=w>>>8&255,l.check=yi(l.check,ir,2,0)),w=0,G=0,l.mode=nS;case nS:for(;G<32;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}l.head&&(l.head.time=w),512&l.flags&&(ir[0]=255&w,ir[1]=w>>>8&255,ir[2]=w>>>16&255,ir[3]=w>>>24&255,l.check=yi(l.check,ir,4,0)),w=0,G=0,l.mode=tS;case tS:for(;G<16;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}l.head&&(l.head.xflags=255&w,l.head.os=w>>8),512&l.flags&&(ir[0]=255&w,ir[1]=w>>>8&255,l.check=yi(l.check,ir,2,0)),w=0,G=0,l.mode=rS;case rS:if(1024&l.flags){for(;G<16;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}l.length=w,l.head&&(l.head.extra_len=w),512&l.flags&&(ir[0]=255&w,ir[1]=w>>>8&255,l.check=yi(l.check,ir,2,0)),w=0,G=0}else l.head&&(l.head.extra=null);l.mode=iS;case iS:if(1024&l.flags&&((V=l.length)>I&&(V=I),V&&(l.head&&(Zn=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),It.arraySet(l.head.extra,f,m,V,Zn)),512&l.flags&&(l.check=yi(l.check,f,V,m)),I-=V,m+=V,l.length-=V),l.length))break e;l.length=0,l.mode=aS;case aS:if(2048&l.flags){if(I===0)break e;V=0;do Zn=f[m+V++],l.head&&Zn&&l.length<65536&&(l.head.name+=String.fromCharCode(Zn));while(Zn&&V<I);if(512&l.flags&&(l.check=yi(l.check,f,V,m)),I-=V,m+=V,Zn)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=sS;case sS:if(4096&l.flags){if(I===0)break e;V=0;do Zn=f[m+V++],l.head&&Zn&&l.length<65536&&(l.head.comment+=String.fromCharCode(Zn));while(Zn&&V<I);if(512&l.flags&&(l.check=yi(l.check,f,V,m)),I-=V,m+=V,Zn)break e}else l.head&&(l.head.comment=null);l.mode=uS;case uS:if(512&l.flags){for(;G<16;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(w!==(65535&l.check)){o.msg="header crc mismatch",l.mode=zr;break}w=0,G=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),o.adler=l.check=0,l.mode=bu;break;case oS:for(;G<32;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}o.adler=l.check=CS(w),w=0,G=0,l.mode=Op;case Op:if(l.havedict===0)return o.next_out=v,o.avail_out=S,o.next_in=m,o.avail_in=I,l.hold=w,l.bits=G,xP;o.adler=l.check=1,l.mode=bu;case bu:if(c===DP||c===Mp)break e;case hv:if(l.last){w>>>=7&G,G-=7&G,l.mode=_v;break}for(;G<3;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}switch(l.last=1&w,G-=1,3&(w>>>=1)){case 0:l.mode=lS;break;case 1:if(GP(l),l.mode=kp,c===Mp){w>>>=2,G-=2;break e}break;case 2:l.mode=cS;break;case 3:o.msg="invalid block type",l.mode=zr}w>>>=2,G-=2;break;case lS:for(w>>>=7&G,G-=7&G;G<32;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if((65535&w)!=(w>>>16^65535)){o.msg="invalid stored block lengths",l.mode=zr;break}if(l.length=65535&w,w=0,G=0,l.mode=pv,c===Mp)break e;case pv:l.mode=dS;case dS:if(V=l.length){if(V>I&&(V=I),V>S&&(V=S),V===0)break e;It.arraySet(_,f,m,V,v),I-=V,m+=V,S-=V,v+=V,l.length-=V;break}l.mode=bu;break;case cS:for(;G<14;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(l.nlen=257+(31&w),w>>>=5,G-=5,l.ndist=1+(31&w),w>>>=5,G-=5,l.ncode=4+(15&w),w>>>=4,G-=4,l.nlen>286||l.ndist>30){o.msg="too many length or distance symbols",l.mode=zr;break}l.have=0,l.mode=fS;case fS:for(;l.have<l.ncode;){for(;G<3;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}l.lens[ss[l.have++]]=7&w,w>>>=3,G-=3}for(;l.have<19;)l.lens[ss[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,Nt={bits:l.lenbits},Xn=hf(kP,l.lens,0,19,l.lencode,0,l.work,Nt),l.lenbits=Nt.bits,Xn){o.msg="invalid code lengths set",l.mode=zr;break}l.have=0,l.mode=hS;case hS:for(;l.have<l.nlen+l.ndist;){for(;_e=(et=l.lencode[w&(1<<l.lenbits)-1])>>>16&255,ye=65535&et,!((me=et>>>24)<=G);){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(ye<16)w>>>=me,G-=me,l.lens[l.have++]=ye;else{if(ye===16){for(kt=me+2;G<kt;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(w>>>=me,G-=me,l.have===0){o.msg="invalid bit length repeat",l.mode=zr;break}Zn=l.lens[l.have-1],V=3+(3&w),w>>>=2,G-=2}else if(ye===17){for(kt=me+3;G<kt;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}G-=me,Zn=0,V=3+(7&(w>>>=me)),w>>>=3,G-=3}else{for(kt=me+7;G<kt;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}G-=me,Zn=0,V=11+(127&(w>>>=me)),w>>>=7,G-=7}if(l.have+V>l.nlen+l.ndist){o.msg="invalid bit length repeat",l.mode=zr;break}for(;V--;)l.lens[l.have++]=Zn}}if(l.mode===zr)break;if(l.lens[256]===0){o.msg="invalid code -- missing end-of-block",l.mode=zr;break}if(l.lenbits=9,Nt={bits:l.lenbits},Xn=hf(WT,l.lens,0,l.nlen,l.lencode,0,l.work,Nt),l.lenbits=Nt.bits,Xn){o.msg="invalid literal/lengths set",l.mode=zr;break}if(l.distbits=6,l.distcode=l.distdyn,Nt={bits:l.distbits},Xn=hf($T,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,Nt),l.distbits=Nt.bits,Xn){o.msg="invalid distances set",l.mode=zr;break}if(l.mode=kp,c===Mp)break e;case kp:l.mode=Dp;case Dp:if(I>=6&&S>=258){o.next_out=v,o.avail_out=S,o.next_in=m,o.avail_in=I,l.hold=w,l.bits=G,AP(o,x),v=o.next_out,_=o.output,S=o.avail_out,m=o.next_in,f=o.input,I=o.avail_in,w=l.hold,G=l.bits,l.mode===bu&&(l.back=-1);break}for(l.back=0;_e=(et=l.lencode[w&(1<<l.lenbits)-1])>>>16&255,ye=65535&et,!((me=et>>>24)<=G);){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(_e&&!(240&_e)){for(Xe=me,on=_e,Mn=ye;_e=(et=l.lencode[Mn+((w&(1<<Xe+on)-1)>>Xe)])>>>16&255,ye=65535&et,!(Xe+(me=et>>>24)<=G);){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}w>>>=Xe,G-=Xe,l.back+=Xe}if(w>>>=me,G-=me,l.back+=me,l.length=ye,_e===0){l.mode=vS;break}if(32&_e){l.back=-1,l.mode=bu;break}if(64&_e){o.msg="invalid literal/length code",l.mode=zr;break}l.extra=15&_e,l.mode=pS;case pS:if(l.extra){for(kt=l.extra;G<kt;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}l.length+=w&(1<<l.extra)-1,w>>>=l.extra,G-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=_S;case _S:for(;_e=(et=l.distcode[w&(1<<l.distbits)-1])>>>16&255,ye=65535&et,!((me=et>>>24)<=G);){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(!(240&_e)){for(Xe=me,on=_e,Mn=ye;_e=(et=l.distcode[Mn+((w&(1<<Xe+on)-1)>>Xe)])>>>16&255,ye=65535&et,!(Xe+(me=et>>>24)<=G);){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}w>>>=Xe,G-=Xe,l.back+=Xe}if(w>>>=me,G-=me,l.back+=me,64&_e){o.msg="invalid distance code",l.mode=zr;break}l.offset=ye,l.extra=15&_e,l.mode=mS;case mS:if(l.extra){for(kt=l.extra;G<kt;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}l.offset+=w&(1<<l.extra)-1,w>>>=l.extra,G-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){o.msg="invalid distance too far back",l.mode=zr;break}l.mode=gS;case gS:if(S===0)break e;if(V=x-S,l.offset>V){if((V=l.offset-V)>l.whave&&l.sane){o.msg="invalid distance too far back",l.mode=zr;break}V>l.wnext?(V-=l.wnext,K=l.wsize-V):K=l.wnext-V,V>l.length&&(V=l.length),te=l.window}else te=_,K=v-l.offset,V=l.length;V>S&&(V=S),S-=V,l.length-=V;do _[v++]=te[K++];while(--V);l.length===0&&(l.mode=Dp);break;case vS:if(S===0)break e;_[v++]=l.length,S--,l.mode=Dp;break;case _v:if(l.wrap){for(;G<32;){if(I===0)break e;I--,w|=f[m++]<<G,G+=8}if(x-=S,o.total_out+=x,l.total+=x,x&&(o.adler=l.check=l.flags?yi(l.check,_,x,v-x):uf(l.check,_,x,v-x)),x=S,(l.flags?w:CS(w))!==l.check){o.msg="incorrect data check",l.mode=zr;break}w=0,G=0}l.mode=ES;case ES:if(l.wrap&&l.flags){for(;G<32;){if(I===0)break e;I--,w+=f[m++]<<G,G+=8}if(w!==(4294967295&l.total)){o.msg="incorrect length check",l.mode=zr;break}w=0,G=0}l.mode=yS;case yS:Xn=LP;break e;case zr:Xn=QT;break e;case bS:return ZT;default:return ts}return o.next_out=v,o.avail_out=S,o.next_in=m,o.avail_in=I,l.hold=w,l.bits=G,(l.wsize||x!==o.avail_out&&l.mode<zr&&(l.mode<_v||c!==YT))&&wS(o,o.output,o.next_out,x-o.avail_out),H-=o.avail_in,x-=o.avail_out,o.total_in+=H,o.total_out+=x,l.total+=x,l.wrap&&x&&(o.adler=l.check=l.flags?yi(l.check,_,x,o.next_out-x):uf(l.check,_,x,o.next_out-x)),o.data_type=l.bits+(l.last?64:0)+(l.mode===bu?128:0)+(l.mode===kp||l.mode===pv?256:0),(H===0&&x===0||c===YT)&&Xn===dl&&(Xn=UP),Xn},jP=function(o,c){var l;return o&&o.state&&2&(l=o.state).wrap?(l.head=c,c.done=!1,dl):ts},Pd={inflateReset:TS,inflateReset2:SS,inflateResetKeep:IS,inflateInit:function(o){return NS(o,HP)},inflateInit2:NS,inflate:VP,inflateEnd:function(o){if(!o||!o.state)return ts;var c=o.state;return c.window&&(c.window=null),o.state=null,dl},inflateGetHeader:jP,inflateSetDictionary:function(o,c){var l,f=c.length;return o&&o.state?(l=o.state).wrap!==0&&l.mode!==Op?ts:l.mode===Op&&uf(1,c,f,0)!==l.check?QT:wS(o,c,f,f)?(l.mode=bS,ZT):(l.havedict=1,dl):ts},inflateInfo:"pako inflate (from Nodeca project)"},Jr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},qP=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},RS=Object.prototype.toString;function cl(o){if(!(this instanceof cl))return new cl(o);this.options=It.assign({chunkSize:16384,windowBits:0,to:""},o||{});var c=this.options;c.raw&&c.windowBits>=0&&c.windowBits<16&&(c.windowBits=-c.windowBits,c.windowBits===0&&(c.windowBits=-15)),!(c.windowBits>=0&&c.windowBits<16)||o&&o.windowBits||(c.windowBits+=32),c.windowBits>15&&c.windowBits<48&&!(15&c.windowBits)&&(c.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zT,this.strm.avail_out=0;var l=Pd.inflateInit2(this.strm,c.windowBits);if(l!==Jr.Z_OK)throw new Error(rl[l]);if(this.header=new qP,Pd.inflateGetHeader(this.strm,this.header),c.dictionary&&(typeof c.dictionary=="string"?c.dictionary=ol.string2buf(c.dictionary):RS.call(c.dictionary)==="[object ArrayBuffer]"&&(c.dictionary=new Uint8Array(c.dictionary)),c.raw&&(l=Pd.inflateSetDictionary(this.strm,c.dictionary))!==Jr.Z_OK))throw new Error(rl[l])}function vv(o,c){var l=new cl(c);if(l.push(o,!0),l.err)throw l.msg||rl[l.err];return l.result}cl.prototype.push=function(o,c){var l,f,_,m,v,I=this.strm,S=this.options.chunkSize,w=this.options.dictionary,G=!1;if(this.ended)return!1;f=c===~~c?c:c===!0?Jr.Z_FINISH:Jr.Z_NO_FLUSH,typeof o=="string"?I.input=ol.binstring2buf(o):RS.call(o)==="[object ArrayBuffer]"?I.input=new Uint8Array(o):I.input=o,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new It.Buf8(S),I.next_out=0,I.avail_out=S),(l=Pd.inflate(I,Jr.Z_NO_FLUSH))===Jr.Z_NEED_DICT&&w&&(l=Pd.inflateSetDictionary(this.strm,w)),l===Jr.Z_BUF_ERROR&&G===!0&&(l=Jr.Z_OK,G=!1),l!==Jr.Z_STREAM_END&&l!==Jr.Z_OK)return this.onEnd(l),this.ended=!0,!1;I.next_out&&(I.avail_out!==0&&l!==Jr.Z_STREAM_END&&(I.avail_in!==0||f!==Jr.Z_FINISH&&f!==Jr.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=ol.utf8border(I.output,I.next_out),m=I.next_out-_,v=ol.buf2string(I.output,_),I.next_out=m,I.avail_out=S-m,m&&It.arraySet(I.output,I.output,_,m,0),this.onData(v)):this.onData(It.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(G=!0)}while((I.avail_in>0||I.avail_out===0)&&l!==Jr.Z_STREAM_END);return l===Jr.Z_STREAM_END&&(f=Jr.Z_FINISH),f===Jr.Z_FINISH?(l=Pd.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===Jr.Z_OK):f!==Jr.Z_SYNC_FLUSH||(this.onEnd(Jr.Z_OK),I.avail_out=0,!0)},cl.prototype.onData=function(o){this.chunks.push(o)},cl.prototype.onEnd=function(o){o===Jr.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=It.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg};var zP={Inflate:cl,inflate:vv,inflateRaw:function(o,c){return(c=c||{}).raw=!0,vv(o,c)},ungzip:vv},Ev={};(0,It.assign)(Ev,NP,zP,Jr);var pf,KP=Ev.gzip,WP=Ev.ungzip,MS=function(){function o(){ie(this,o)}return se(o,null,[{key:"encode",value:function(c){return btoa(c)}},{key:"decode",value:function(c){return atob(c)}}]),o}(),Lp=function(){function o(){ie(this,o)}return se(o,null,[{key:"compress",value:function(c){var l=KP(c,{to:"string"});return MS.encode(l)}},{key:"decompress",value:function(c){var l=MS.decode(c);return WP(l,{to:"string"})}}]),o}(),$P=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.ANSWER),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,peerConnectionId:f.peer_connection_id,sdp:Lp.decompress(f.sdp)}}}]),l}(Li),YP=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.AUDIO),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,isEnabled:f.is_enabled}}}]),l}(Li),QP=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.CANDIDATE),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,peerConnectionId:f.peer_connection_id,candidate:{sdpMLineIndex:f.candidate.sdp_mline_index,sdpMid:f.candidate.sdp_mid,sdp:f.candidate.sdp}}}}]),l}(Li),ZP=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.CUSTOM_ITEMS_DELETE),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,deleted:f.deleted,customItems:f.custom_items}}}]),l}(Li),_f=function o(c){ie(this,o),this.userId=c.user_id,this.nickname=c.nickname,this.profileUrl=c.profile_url,this.metaData=c.meta_data,this.isActive=c.is_active,this.role=c.role},XP=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.DIAL),f}return se(l,[{key:"parseData",value:function(f){return{isVideoCall:f.is_video_call,callId:f.call_id,caller:new _f(f.caller),callee:new _f(f.callee),turnCredential:{username:f.turn_credential.username,password:f.turn_credential.password,turnUrls:f.turn_credential.turn_urls,transportPolicy:f.turn_credential.transport_policy},constraints:{audio:f.constraints.audio,video:f.constraints.video},customItems:f.custom_items,shortLivedToken:f.sbcall_short_lived_token,capabilities:f.capabilities||[]}}}]),l}(Li),JP=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.DIAL_RCV),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,calleeDeliveryInfo:f.callee_delivery_info,receivedType:f.received_type}}}]),l}(Li),xp=function(){function o(c){var l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];ie(this,o),this.callId=c.call_id,this.isVideoCall=c.is_video_call,this._customItems=c.custom_items,this.userRole=c.user_role,this.startedAt=c.started_at,this.endedAt=c.ended_at,this._participants=c.participants.map(function(f){return new _f(f)}),this.endedBy=this._participants.find(function(f){return f.userId===c.ended_by}),this.duration=c.duration,this.endResult=c.end_result_ex,this.callType=c.call_type,this._isFromServer=l}return se(o,[{key:"caller",get:function(){return this._participants.find(function(c){return c.role===Eu.CALLER})}},{key:"callee",get:function(){return this._participants.find(function(c){return c.role===Eu.CALLEE})}},{key:"customItems",get:function(){return Fr({},this._customItems)}},{key:"isFromServer",get:function(){return this._isFromServer}}]),o}(),fl=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,endedCall:new xp(f.ended_call)}}}]),l}(Li),e6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.HOLD),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,holdedBy:f.holded_by,isPeerOnHold:f.is_peer_on_hold,isRelayed:f.is_relayed}}}]),l}(Li),n6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.OFFER),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,peerConnectionId:f.peer_connection_id,sdp:Lp.decompress(f.sdp)}}}]),l}(Li),t6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.RECORDING),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,recordingId:f.recording_id,recordingType:f.recording_type,recordingStatus:f.recording_status}}}]),l}(Li),r6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.REMOVE_CANDIDATES),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,candidates:f.candidates.map(function(_){return{sdpMLineIndex:_.sdp_mline_index,sdpMid:_.sdp_mid,candidate:_.sdp}})}}}]),l}(Li),i6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.CUSTOM_ITEMS_UPDATE),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,updated:f.updated,customItems:f.custom_items}}}]),l}(Li),a6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.VIDEO),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,isEnabled:f.is_enabled}}}]),l}(Li),yv=["turn_changed"],s6=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this)).callId=f,m.constraints=_,m.capabilities=yv,m}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.ACCEPT}},{key:"getData",value:function(){return{call_id:this.callId,constraints:{audio:this.constraints.audio,video:this.constraints.video},capabilities:this.capabilities}}}]),l}(_i),u6=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).callId=f,_}return se(l,[{key:"getCMD",value:function(){return Xr.SGNL}},{key:"getType",value:function(){return He.ALIVE}},{key:"getData",value:function(){return{call_id:this.callId}}}]),l}(_i),o6=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this)).callId=f,v.peerConnectionId=_,v.sdp=m,v}return se(l,[{key:"getCMD",value:function(){return Xr.SGNL}},{key:"getType",value:function(){return He.ANSWER}},{key:"getData",value:function(){var f={call_id:this.callId,sdp:Lp.compress(this.sdp)};return this.peerConnectionId?Fr(Fr({},f),{},{peer_connection_id:this.peerConnectionId}):f}}]),l}(_i),l6=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this)).callId=f,m.isEnabled=_,m}return se(l,[{key:"getCMD",value:function(){return Xr.COMM}},{key:"getType",value:function(){return He.AUDIO}},{key:"getData",value:function(){return{call_id:this.callId,is_enabled:this.isEnabled}}}]),l}(_i),d6=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).callId=f,_}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.CANCEL}},{key:"getData",value:function(){return{call_id:this.callId}}}]),l}(_i),c6=function(o){ce(l,o);var c=fe(l);function l(f,_,m,v,I){var S;return ie(this,l),qe(je(S=c.call(this)),"type",He.CANDIDATE),S.callId=f,S.peerConnectionId=_,S.sdp=m,S.sdpMLineIndex=v,S.sdpMid=I,S}return se(l,[{key:"getCMD",value:function(){return Xr.SGNL}},{key:"getType",value:function(){return He.CANDIDATE}},{key:"getData",value:function(){var f={call_id:this.callId,candidate:{sdp:this.sdp,sdp_mline_index:this.sdpMLineIndex,sdp_mid:this.sdpMid}};return this.peerConnectionId?Fr(Fr({},f),{},{peer_connection_id:this.peerConnectionId}):f}}]),l}(_i),f6=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this)).callId=f,v.reconnect=m,v.connectionType=_.connectionType,v.relayProtocol=_.relayProtocol,v.protocol=_.protocol,v}return se(l,[{key:"getCMD",value:function(){return Xr.SGNL}},{key:"getType",value:function(){return He.CONNECTED}},{key:"getData",value:function(){return{call_id:this.callId,connection:{connection_type:this.connectionType,relay_protocol:this.relayProtocol,protocol:this.protocol},reconnect:this.reconnect}}}]),l}(_i),h6=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).callId=f,_}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.CONNECTION_LOST}},{key:"getData",value:function(){return{call_id:this.callId}}}]),l}(_i),p6=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).callId=f,_}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.DECLINE}},{key:"getData",value:function(){return{call_id:this.callId}}}]),l}(_i),_6=function(o){ce(l,o);var c=fe(l);function l(f,_,m,v,I,S){var w;return ie(this,l),(w=c.call(this)).calleeId=f,w.isVideoCall=_,w.customItems=m,w.sendBirdChatOptions=v,w.constraints=I,w.webhook=S,w.capabilities=yv,w}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.DIAL}},{key:"getData",value:function(){var f,_=this.webhook?{url:this.webhook.url,enabled_events:this.webhook.enabledEvents,headers:this.webhook.headers}:void 0;return{callee_id:this.calleeId,is_video_call:this.isVideoCall,custom_items:this.customItems,sb_chat:{channel_url:(f=this.sendBirdChatOptions)===null||f===void 0?void 0:f.channelUrl},constraints:{audio:this.constraints.audio,video:this.constraints.video},capabilities:this.capabilities,webhook:_}}}]),l}(_i),m6=function(o){ce(l,o);var c=fe(l);function l(f,_,m,v){var I;return ie(this,l),(I=c.call(this)).callId=f,I.calleeDeliveryInfo=_,I.receivedType=m,I.shortLivedToken=v,I}return se(l,[{key:"getHeaders",value:function(){return{"SBCall-Short-Lived-Token":this.shortLivedToken}}},{key:"getData",value:function(){return{call_id:this.callId,callee_delivery_info:this.calleeDeliveryInfo,received_type:this.receivedType}}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.DIAL_RCV}},{key:"sendStrategy",get:function(){return nl.API}}]),l}(_i),g6=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).callId=f,_}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.END}},{key:"getData",value:function(){return{call_id:this.callId}}}]),l}(_i),v6=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this)).callId=f,v.isOnHold=_,v.wasRelayed=m,v}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.HOLD}},{key:"getData",value:function(){return{call_id:this.callId,is_on_hold:this.isOnHold,was_relayed:this.wasRelayed}}}]),l}(_i),E6=function(o){ce(l,o);var c=fe(l);function l(f){var _;return ie(this,l),(_=c.call(this)).callId=f,_}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.NO_ANSWER}},{key:"getData",value:function(){return{call_id:this.callId}}}]),l}(_i),y6=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this)).callId=f,v.peerConnectionId=_,v.sdp=m,v}return se(l,[{key:"getCMD",value:function(){return Xr.SGNL}},{key:"getType",value:function(){return He.OFFER}},{key:"getData",value:function(){var f={call_id:this.callId,sdp:Lp.compress(this.sdp)};return this.peerConnectionId?Fr(Fr({},f),{},{peer_connection_id:this.peerConnectionId}):f}}]),l}(_i),b6=function(o){ce(l,o);var c=fe(l);function l(f,_,m,v){var I;return ie(this,l),(I=c.call(this)).callId=f,I.recordingId=_,I.recordingType=m,I.recordingStatus=v,I}return se(l,[{key:"getCMD",value:function(){return Xr.COMM}},{key:"getType",value:function(){return He.RECORDING}},{key:"getData",value:function(){return{call_id:this.callId,recording_id:this.recordingId,recording_type:this.recordingType,recording_status:this.recordingStatus}}}]),l}(_i),C6=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this)).callId=f,m.reason=_,m}return se(l,[{key:"requireResponse",value:function(){return!0}},{key:"getCMD",value:function(){return Xr.CALL}},{key:"getType",value:function(){return He.TIME_OUT}},{key:"getData",value:function(){return{call_id:this.callId,reason:this.reason}}}]),l}(_i),I6=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this)).callId=f,m.isEnabled=_,m}return se(l,[{key:"getCMD",value:function(){return Xr.COMM}},{key:"getType",value:function(){return He.VIDEO}},{key:"getData",value:function(){return{call_id:this.callId,is_enabled:this.isEnabled}}}]),l}(_i),T6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.ACCEPT_ACK),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id}}}]),l}(Md),S6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.ALIVE_ACK),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,alive_at:f.alive_at}}}]),l}(Md),N6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.DIAL_ACK),f}return se(l,[{key:"parseData",value:function(f){return{isVideoCall:f.is_video_call,callId:f.call_id,caller:new _f(f.caller),callee:new _f(f.callee)}}}]),l}(Md),hl=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,endedCall:new xp(f.ended_call)}}}]),l}(Md),A6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.HOLD_ACK),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,holdedBy:f.holded_by,isRelayed:f.is_relayed}}}]),l}(Md),w6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",He.TURN_CHANGED),f}return se(l,[{key:"parseData",value:function(f){return{callId:f.call_id,turnCredential:{username:f.turn_credential.username,password:f.turn_credential.password,turnUrls:f.turn_credential.turn_urls,transportPolicy:f.turn_credential.transport_policy},eventId:f.event_id}}}]),l}(cT),OS=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return l}(dT);(function(o){o.LOG="log"})(pf||(pf={}));var Up,R6=function(o){ce(l,o);var c=fe(l);function l(){var f;ie(this,l);for(var _=arguments.length,m=new Array(_),v=0;v<_;v++)m[v]=arguments[v];return qe(je(f=c.call.apply(c,[this].concat(m))),"type",pf.LOG),f}return se(l,[{key:"parseData",value:function(f){return{logLevel:f.log_level.toUpperCase()}}}]),l}(OS),M6=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return l}(oT);(function(o){o.CONNECTED="websocket_connected"})(Up||(Up={}));var O6=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.call(this,{type:Up.CONNECTED})}return l}(M6),Kt=function(){function o(){ie(this,o)}return se(o,null,[{key:"createAuthRequest",value:function(c,l,f){return new xU(c,l,f)}},{key:"createDial",value:function(c,l,f,_,m,v){return new _6(c,l,f,_,m,v)}},{key:"createDialReceive",value:function(c,l,f,_){return new m6(c,l,f,_)}},{key:"createAccept",value:function(c,l){return new s6(c,l)}},{key:"createDecline",value:function(c){return new p6(c)}},{key:"createCancel",value:function(c){return new d6(c)}},{key:"createEnd",value:function(c){return new g6(c)}},{key:"createTimeout",value:function(c,l){return new C6(c,l)}},{key:"createConnectionLost",value:function(c){return new h6(c)}},{key:"createNoAnswer",value:function(c){return new E6(c)}},{key:"createOffer",value:function(c,l,f){return new y6(c,l,f)}},{key:"createAnswer",value:function(c,l,f){return new o6(c,l,f)}},{key:"createCandidate",value:function(c,l,f,_,m){return new c6(c,l,f,_,m)}},{key:"createAudio",value:function(c,l){return new l6(c,l)}},{key:"createVideo",value:function(c,l){return new I6(c,l)}},{key:"createAlive",value:function(c){return new u6(c)}},{key:"createConnected",value:function(c,l,f){return new f6(c,l,f)}},{key:"createStatsLogCommand",value:function(c){return new DU(c)}},{key:"createCallSummaryCommand",value:function(c,l,f){return new qU(c,l,f)}},{key:"createUpdateCustomItems",value:function(c,l){return new jU(c,l)}},{key:"createDeleteCustomItems",value:function(c,l){return new VU(c,l)}},{key:"createDeleteAllCustomItems",value:function(c){return new GU(c)}},{key:"createRecording",value:function(c,l,f,_){return new b6(c,l,f,_)}},{key:"createHoldCommand",value:function(c,l,f){return new v6(c,l,f)}},{key:"createCommandList",value:function(c){return new BU(c)}},{key:"createUploadLogsCommand",value:function(c,l){return new LU(c,l)}},{key:"createRegisterPushToken",value:function(c,l,f){return new PU(c,l,f)}},{key:"createUnregisterPushToken",value:function(c,l,f){return new FU(c,l,f)}},{key:"createUnregisterAllPushTokens",value:function(c,l){return new HU(c,l)}},{key:"createAccepted",value:function(c){return new fT({type:"other_device_accepted",payload:{call_id:c}})}},{key:"createDeclined",value:function(c,l){return new zU({callId:c,endedCall:l})}},{key:"createWebSocketConnectedCommand",value:function(){return new O6}},{key:"createSnapshot",value:function(c,l){return new KU(Fr({callId:c},l))}},{key:"parse",value:function(c){try{switch(c.type){case He.DIAL_ACK:return new N6(c);case He.DIAL:return new XP(c);case He.DIAL_RCV:return new JP(c);case He.NO_ANSWER_ACK:return new hl(c);case He.NO_ANSWER:return new fl(c);case He.CANCEL_ACK:return new hl(c);case He.CANCEL:return new fl(c);case He.ACCEPT_ACK:return new T6(c);case He.ACCEPT:return new WU(c);case He.OTHER_DEVICE_ACCEPTED:return new fT(c);case He.DECLINE_ACK:return new hl(c);case He.DECLINE:return new fl(c);case He.OFFER:return new n6(c);case He.ANSWER:return new $P(c);case He.CANDIDATE:return new QP(c);case He.REMOVE_CANDIDATES:return new r6(c);case He.AUDIO:return new YP(c);case He.VIDEO:return new a6(c);case He.HOLD:return new e6(c);case He.HOLD_ACK:return new A6(c);case He.END_ACK:return new hl(c);case He.END:return new fl(c);case He.TIMEOUT_ACK:return new hl(c);case He.TIME_OUT:return new fl(c);case He.CONNECTION_LOST_ACK:return new hl(c);case He.CONNECTION_LOST:return new fl(c);case He.UNKNOWN_END_ACK:return new hl(c);case He.UNKNOWN_END:return new fl(c);case He.CUSTOM_ITEMS_UPDATE:return new i6(c);case He.CUSTOM_ITEMS_DELETE:return new ZP(c);case He.ALIVE_ACK:return new S6(c);case He.RECORDING:return new t6(c);case He.TURN_CHANGED:return new w6(c);case pf.LOG:return new R6(c);default:throw new Error("unhandled command data. ".concat(JSON.stringify(c)))}}catch(l){return void ae.error(new Jt(De.ERR_WRONG_RESPONSE,{error:l}))}}}]),o}(),k6=function(){function o(c){ie(this,o),qe(this,"_isOverflowLogs",!1),qe(this,"_logs",[]),this._ctx=c}return se(o,[{key:"addLog",value:function(c){this._logs.length>=500&&(this._isOverflowLogs=!0,this._logs.shift()),this._logs.push(c)}},{key:"_flush",value:function(c){var l=this._logs.filter(function(_){return Hc[_.logLevel].level>=Hc[c].level}),f=Kt.createUploadLogsCommand(l,this._isOverflowLogs);this._isOverflowLogs=!1,this._logs=[],this._ctx.sender.send(f)}},{key:"onEvent",value:function(c){c.type===pf.LOG?this._flush(c.payload.logLevel):console.error("Cannot reach here")}}]),o}(),D6=p.f,kS=function(o){return function(c){for(var l,f=O(c),_=ot(f),m=_.length,v=0,I=[];m>v;)l=_[v++],u&&!D6.call(f,l)||I.push(o?[l,f[l]]:f[l]);return I}},DS={entries:kS(!0),values:kS(!1)},L6=DS.values;Fn({target:"Object",stat:!0},{values:function(o){return L6(o)}});var x6=DS.entries;function LS(o,c){var l=0,f=null;if(typeof o=="number")throw new Error("'obj' parameter is required");if(!o||c)throw new Error("'obj' parameter is required");return f=o,function(_){var m=_.descriptor.value;return _.descriptor.value=function(){for(var v=arguments.length,I=new Array(v),S=0;S<v;S++)I[S]=arguments[S];var w=I[l];if(Xh(w)!=="object")throw new Error("'object' is expected");return Object.entries(f).forEach(function(G){var H=$u(G,2),x=H[0],V=H[1];!w[x]||w[x]instanceof V||(w[x]=new V(w[x]))}),m.call.apply(m,[this].concat(I))},_}}Fn({target:"Object",stat:!0},{entries:function(o){return x6(o)}});var U6=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.call(this)}return l}(zi),xS=1 .toFixed,US=Math.floor,Fd=function(o,c,l){return c===0?l:c%2==1?Fd(o,c-1,l*o):Fd(o*o,c/2,l)},P6=xS&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128")||!s(function(){xS.call({})});Fn({target:"Number",proto:!0,forced:P6},{toFixed:function(o){var c,l,f,_,m=function(V){if(typeof V!="number"&&y(V)!="Number")throw TypeError("Incorrect invocation");return+V}(this),v=tn(o),I=[0,0,0,0,0,0],S="",w="0",G=function(V,K){for(var te=-1,me=K;++te<6;)me+=V*I[te],I[te]=me%1e7,me=US(me/1e7)},H=function(V){for(var K=6,te=0;--K>=0;)te+=I[K],I[K]=US(te/V),te=te%V*1e7},x=function(){for(var V=6,K="";--V>=0;)if(K!==""||V===0||I[V]!==0){var te=String(I[V]);K=K===""?te:K+np.call("0",7-te.length)+te}return K};if(v<0||v>20)throw RangeError("Incorrect fraction digits");if(m!=m)return"NaN";if(m<=-1e21||m>=1e21)return String(m);if(m<0&&(S="-",m=-m),m>1e-21)if(l=(c=function(V){for(var K=0,te=V;te>=4096;)K+=12,te/=4096;for(;te>=2;)K+=1,te/=2;return K}(m*Fd(2,69,1))-69)<0?m*Fd(2,-c,1):m/Fd(2,c,1),l*=4503599627370496,(c=52-c)>0){for(G(0,l),f=v;f>=7;)G(1e7,0),f-=7;for(G(Fd(10,f,1),0),f=c-1;f>=23;)H(1<<23),f-=23;H(1<<f),G(1,1),H(2),w=x()}else G(0,l),G(1<<-c,0),w=x()+np.call("0",v);return w=v>0?S+((_=w.length)<=v?"0."+np.call("0",v-_)+w:w.slice(0,_-v)+"."+w.slice(_-v)):S+w}});var F6=function(){function o(c,l){ie(this,o),qe(this,"_count",0),this._call=c,this._statsInterval=l,this._init(),this._audioMosList=[]}return se(o,[{key:"_init",value:function(){this._reconnectionCount=0}},{key:"insertStatsLog",value:function(c){var l,f=this._accumulatedStatsLog;this._count+=1;var _=Vg(c,f);this._audioMosList.push((l=_.audio.mos)!==null&&l!==void 0?l:0),this._accumulatedStatsLog=VI(_,this._accumulatedStatsLog,this._count)}},{key:"onDial",value:function(){this._dialSentAt=Date.now()}},{key:"onDialAck",value:function(){this._pdd=Date.now()-this._dialSentAt}},{key:"onAccept",value:function(){this._callSetupStartedAt=Date.now()}},{key:"onAcceptAck",value:function(){this._callSetupStartedAt=Date.now()}},{key:"onConnected",value:function(){this._setupTime=Date.now()-this._callSetupStartedAt}},{key:"increaseReconnectedCount",value:function(){this._reconnectionCount+=1}},{key:"getSummary",value:function(){var c={};if(c.pdd=this._pdd,c.setup_time=this._setupTime,c.reconnection_count=this._reconnectionCount,!this._accumulatedStatsLog)return c;var l=this._accumulatedStatsLog,f=l.transport_info,_=l.audio,m=l.video;return c.network_type=f.network_type,c.transport_info_candidate_type=f.candidate_type,c.audio_mos_list=this._audioMosList.map(function(v){return parseFloat(v.toFixed(1))}),c.stats_interval=this._statsInterval/1e3,c.audio_codec=_.codec,c.audio_mos=_.mos,c.audio_packets_lost_rate=_.packets_lost_rate,c.audio_rtt=_.remote_rtt,c.video_codec=m.codec,c.video_freeze_count=m.freeze_count,c.video_jitter_buffer_delay=m.jitter_buffer_delay,c.video_jitter_buffer_emitted_count=m.jitter_buffer_emitted_count,c.video_packets_lost_rate=m.packets_lost_rate,c.video_received_frame_height=m.received_frame_height,c.video_received_frame_width=m.received_frame_width,c.video_rtt=m.remote_rtt,c.video_sent_frame_height=m.sent_frame_height,c.video_sent_frame_width=m.sent_frame_width,c.video_total_decode_time=m.total_decode_time,c.video_total_freezes_duration=m.total_freezes_duration,c.video_total_inter_frame_delay=m.total_inter_frame_delay,c.video_source_frames_per_second=m.video_source_frames_per_second,c.video_source_height=m.video_source_height,c.video_source_width=m.video_source_width,c}}]),o}(),H6=function(){function o(c,l){ie(this,o),this._ctx=c,this._call=l,this._statsList=[],this._summary=new F6(l,this._interval)}return se(o,[{key:"_insertInfo",value:function(){var c=this._call;Object.assign(this._accumulated,{app_id:this._ctx.appId,browser_type:Dg(),call_id:c.callId,device_timestamp:new Date().getTime(),role:c.myRole,caller_id:c.caller.userId,callee_id:c.callee.userId,is_video_call:c.isVideoCall,metadata:{measure_count:c.options.statsIntervalValue/1e3,measure_interval:c.options.statsIntervalValue/1e3}})}},{key:"insertStatsLog",value:function(c){var l=this,f=Vg(c,this._prev);if(this._statsList.push(f),this._prev=f,this._statsList.length&&this._statsList.length%(this._interval/1e3)==0){var _,m=0;this._accumulated=this._statsList.reduce(function(v,I){return m+=1,VI(l._statsList[m-1],I,m)},{}),this._statsList.length=0,(_=this._sendStatsLogCommand)===null||_===void 0||_.call(this,this._accumulated),this._summary.insertStatsLog(this._accumulated)}}},{key:"_sendStatsLogCommand",value:function(c){this._insertInfo();var l=Kt.createStatsLogCommand(c);this._ctx.sender.send(l).catch(function(f){return ae.warning("failed to send stats to server",f)})}},{key:"summary",get:function(){return this._summary}},{key:"_interval",get:function(){return this._call.options.statsIntervalValue}}]),o}(),B6=function(o){ce(l,o);var c=fe(l);function l(){var f;return ie(this,l),(f=c.call(this))._haveRetrievedValidStat=!1,f._updateCount=0,f._prevStats=null,f._prevMetrics=null,f}return se(l,[{key:"setMode",value:function(f){switch(this._stopDispatchInterval(),f){case Wc.FREQUENCY:this._startDispatchInterval();break;case Wc.CONNECTION_QUALITY_CHANGE:break;default:throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"ConnectionQualityMonitoringMode"})}}},{key:"insertStatsLog",value:function(f){var _=this._prevStats,m=this._prevMetrics;if(this._updateCount+=1,!this._haveRetrievedValidStat&&f!=null&&f.audio.mos&&(this._haveRetrievedValidStat=!0),this._haveRetrievedValidStat||!(this._updateCount<=15)){var v,I;f?(v=Vg(f,_),I=new SI({mos:v.audio.mos,packetsLostRate:v.audio.packets_lost_rate,rtt:v.audio.remote_rtt,jitter:v.audio.remote_jitter})):I=new SI({mos:void 0,packetsLostRate:void 0,rtt:void 0,jitter:void 0});var S=m==null?void 0:m.connectionQuality;this._prevStats=v,this._prevMetrics=I,I.connectionQuality!==S&&this._dispatchIfExist()}}},{key:"onReconnecting",value:function(){this.insertStatsLog(void 0)}},{key:"onEnded",value:function(){this._stopDispatchInterval()}},{key:"_startDispatchInterval",value:function(){var f=this;this._dispatchIntervalId=setInterval(function(){f._dispatchIfExist()},3e3)}},{key:"_stopDispatchInterval",value:function(){this._dispatchIntervalId&&(clearInterval(this._dispatchIntervalId),delete this._dispatchIntervalId)}},{key:"_dispatchIfExist",value:function(){var f=this._prevMetrics;f&&this._dispatchEvent("updated",f)}}]),l}(zi),G6=function(){function o(c,l){ie(this,o),this._ctx=c,this._call=l,this._collector=new H6(c,l),this._connectionQuality=new B6}return se(o,[{key:"startGetWebRtcStats",value:function(c){var l=this;this._statsIntervalId||(this._statsIntervalId=setInterval(function(){c.getStatsLog().then(function(f){l._collector.insertStatsLog(f),l._connectionQuality.insertStatsLog(f)})},1e3))}},{key:"stopGetWebRtcStats",value:function(){this._statsIntervalId&&(clearInterval(this._statsIntervalId),delete this._statsIntervalId)}},{key:"getCallSummary",value:function(){return this.summary.getSummary()}},{key:"setConnectionQualityListener",value:function(c,l){this.removeConnectionQualityListener(),this._connectionQuality.on("updated",function(f){l(f)}),this._connectionQuality.setMode(c)}},{key:"removeConnectionQualityListener",value:function(){this._connectionQuality.removeAllEventListeners()}},{key:"onReconnecting",value:function(){this._connectionQuality.onReconnecting()}},{key:"onEnded",value:function(){this._connectionQuality.onEnded()}},{key:"summary",get:function(){return this._collector.summary}}]),o}(),V6=pn("iterator"),bv=!s(function(){var o=new URL("b?a=1&b=2&c=3","http://a"),c=o.searchParams,l="";return o.pathname="c%20d",c.forEach(function(f,_){c.delete("b"),l+=_+f}),!c.sort||o.href!=="http://a/c%20d?a=1&c=3"||c.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!c[V6]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||l!=="a1c3"||new URL("http://x",void 0).host!=="x"}),Cv=2147483647,j6=/[^\0-\u007E]/,q6=/[.\u3002\uFF0E\uFF61]/g,PS="Overflow: input needs wider integers to process",Hd=Math.floor,Iv=String.fromCharCode,FS=function(o){return o+22+75*(o<26)},z6=function(o,c,l){var f=0;for(o=l?Hd(o/700):o>>1,o+=Hd(o/c);o>455;f+=36)o=Hd(o/35);return Hd(f+36*o/(o+38))},K6=function(o){var c=[];o=function(_e){for(var ye=[],Xe=0,on=_e.length;Xe<on;){var Mn=_e.charCodeAt(Xe++);if(Mn>=55296&&Mn<=56319&&Xe<on){var Zn=_e.charCodeAt(Xe++);(64512&Zn)==56320?ye.push(((1023&Mn)<<10)+(1023&Zn)+65536):(ye.push(Mn),Xe--)}else ye.push(Mn)}return ye}(o);var l,f,_=o.length,m=128,v=0,I=72;for(l=0;l<o.length;l++)(f=o[l])<128&&c.push(Iv(f));var S=c.length,w=S;for(S&&c.push("-");w<_;){var G=Cv;for(l=0;l<o.length;l++)(f=o[l])>=m&&f<G&&(G=f);var H=w+1;if(G-m>Hd((Cv-v)/H))throw RangeError(PS);for(v+=(G-m)*H,m=G,l=0;l<o.length;l++){if((f=o[l])<m&&++v>Cv)throw RangeError(PS);if(f==m){for(var x=v,V=36;;V+=36){var K=V<=I?1:V>=I+26?26:V-I;if(x<K)break;var te=x-K,me=36-K;c.push(Iv(FS(K+te%me))),x=Hd(te/me)}c.push(Iv(FS(x))),I=z6(v,H,w==S),v=0,++w}}++v,++m}return c.join("")},HS=function(o){var c=$h(o);if(typeof c!="function")throw TypeError(String(o)+" is not iterable");return Q(c.call(o))},BS=Pe("fetch"),Tv=Pe("Headers"),W6=pn("iterator"),Bd="URLSearchParams",GS=Bd+"Iterator",VS=An.set,gs=An.getterFor(Bd),$6=An.getterFor(GS),Y6=/\+/g,jS=Array(4),Q6=function(o){return jS[o-1]||(jS[o-1]=RegExp("((?:%[\\da-f]{2}){"+o+"})","gi"))},Z6=function(o){try{return decodeURIComponent(o)}catch{return o}},qS=function(o){var c=o.replace(Y6," "),l=4;try{return decodeURIComponent(c)}catch{for(;l;)c=c.replace(Q6(l--),Z6);return c}},X6=/[!'()~]|%20/g,J6={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},e4=function(o){return J6[o]},zS=function(o){return encodeURIComponent(o).replace(X6,e4)},KS=function(o,c){if(c)for(var l,f,_=c.split("&"),m=0;m<_.length;)(l=_[m++]).length&&(f=l.split("="),o.push({key:qS(f.shift()),value:qS(f.join("="))}))},n4=function(o){this.entries.length=0,KS(this.entries,o)},Gd=function(o,c){if(o<c)throw TypeError("Not enough arguments")},Sv=md(function(o,c){VS(this,{type:GS,iterator:HS(gs(o).entries),kind:c})},"Iterator",function(){var o=$6(this),c=o.kind,l=o.iterator.next(),f=l.value;return l.done||(l.value=c==="keys"?f.key:c==="values"?f.value:[f.key,f.value]),l}),mf=function(){Lc(this,mf,Bd);var o,c,l,f,_,m,v,I,S,w=arguments.length>0?arguments[0]:void 0,G=[];if(VS(this,{type:Bd,entries:G,updateURL:function(){},updateSearchParams:n4}),w!==void 0)if(N(w))if(typeof(o=$h(w))=="function")for(l=(c=o.call(w)).next;!(f=l.call(c)).done;){if((v=(m=(_=HS(Q(f.value))).next).call(_)).done||(I=m.call(_)).done||!m.call(_).done)throw TypeError("Expected sequence with length 2");G.push({key:v.value+"",value:I.value+""})}else for(S in w)P(w,S)&&G.push({key:S,value:w[S]+""});else KS(G,typeof w=="string"?w.charAt(0)==="?"?w.slice(1):w:w+"")},Pp=mf.prototype;Qh(Pp,{append:function(o,c){Gd(arguments.length,2);var l=gs(this);l.entries.push({key:o+"",value:c+""}),l.updateURL()},delete:function(o){Gd(arguments.length,1);for(var c=gs(this),l=c.entries,f=o+"",_=0;_<l.length;)l[_].key===f?l.splice(_,1):_++;c.updateURL()},get:function(o){Gd(arguments.length,1);for(var c=gs(this).entries,l=o+"",f=0;f<c.length;f++)if(c[f].key===l)return c[f].value;return null},getAll:function(o){Gd(arguments.length,1);for(var c=gs(this).entries,l=o+"",f=[],_=0;_<c.length;_++)c[_].key===l&&f.push(c[_].value);return f},has:function(o){Gd(arguments.length,1);for(var c=gs(this).entries,l=o+"",f=0;f<c.length;)if(c[f++].key===l)return!0;return!1},set:function(o,c){Gd(arguments.length,1);for(var l,f=gs(this),_=f.entries,m=!1,v=o+"",I=c+"",S=0;S<_.length;S++)(l=_[S]).key===v&&(m?_.splice(S--,1):(m=!0,l.value=I));m||_.push({key:v,value:I}),f.updateURL()},sort:function(){var o,c,l,f=gs(this),_=f.entries,m=_.slice();for(_.length=0,l=0;l<m.length;l++){for(o=m[l],c=0;c<l;c++)if(_[c].key>o.key){_.splice(c,0,o);break}c===l&&_.push(o)}f.updateURL()},forEach:function(o){for(var c,l=gs(this).entries,f=Pt(o,arguments.length>1?arguments[1]:void 0,3),_=0;_<l.length;)f((c=l[_++]).value,c.key,this)},keys:function(){return new Sv(this,"keys")},values:function(){return new Sv(this,"values")},entries:function(){return new Sv(this,"entries")}},{enumerable:!0}),wn(Pp,W6,Pp.entries),wn(Pp,"toString",function(){for(var o,c=gs(this).entries,l=[],f=0;f<c.length;)o=c[f++],l.push(zS(o.key)+"="+zS(o.value));return l.join("&")},{enumerable:!0}),gu(mf,Bd),Fn({global:!0,forced:!bv},{URLSearchParams:mf}),bv||typeof BS!="function"||typeof Tv!="function"||Fn({global:!0,enumerable:!0,forced:!0},{fetch:function(o){var c,l,f,_=[o];return arguments.length>1&&(N(c=arguments[1])&&(l=c.body,$m(l)===Bd&&((f=c.headers?new Tv(c.headers):new Tv).has("content-type")||f.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),c=ps(c,{body:g(0,String(l)),headers:g(0,f)}))),_.push(c)),BS.apply(this,_)}});var rs,WS={URLSearchParams:mf,getState:gs},t4=Xm.codeAt,gf=a.URL,r4=WS.URLSearchParams,Nv=WS.getState,i4=An.set,Yr=An.getterFor("URL"),a4=Math.floor,$S=Math.pow,Av="Invalid scheme",pl="Invalid host",YS="Invalid port",QS=/[A-Za-z]/,s4=/[\d+-.A-Za-z]/,wv=/\d/,u4=/^(0x|0X)/,o4=/^[0-7]+$/,l4=/^\d+$/,ZS=/^[\dA-Fa-f]+$/,d4=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,c4=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,f4=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,h4=/[\u0009\u000A\u000D]/g,Rv=function(o,c){var l,f,_;if(c.charAt(0)=="["){if(c.charAt(c.length-1)!="]"||!(l=_4(c.slice(1,-1))))return pl;o.host=l}else if(Ci(o)){if(c=function(m){var v,I,S=[],w=m.toLowerCase().replace(q6,".").split(".");for(v=0;v<w.length;v++)I=w[v],S.push(j6.test(I)?"xn--"+K6(I):I);return S.join(".")}(c),d4.test(c)||(l=p4(c))===null)return pl;o.host=l}else{if(c4.test(c))return pl;for(l="",f=Zo(c),_=0;_<f.length;_++)l+=lo(f[_],Fp);o.host=l}},p4=function(o){var c,l,f,_,m,v,I,S=o.split(".");if(S.length&&S[S.length-1]==""&&S.pop(),(c=S.length)>4)return o;for(l=[],f=0;f<c;f++){if((_=S[f])=="")return o;if(m=10,_.length>1&&_.charAt(0)=="0"&&(m=u4.test(_)?16:8,_=_.slice(m==8?1:2)),_==="")v=0;else{if(!(m==10?l4:m==8?o4:ZS).test(_))return o;v=parseInt(_,m)}l.push(v)}for(f=0;f<c;f++)if(v=l[f],f==c-1){if(v>=$S(256,5-c))return null}else if(v>255)return null;for(I=l.pop(),f=0;f<l.length;f++)I+=l[f]*$S(256,3-f);return I},_4=function(o){var c,l,f,_,m,v,I,S=[0,0,0,0,0,0,0,0],w=0,G=null,H=0,x=function(){return o.charAt(H)};if(x()==":"){if(o.charAt(1)!=":")return;H+=2,G=++w}for(;x();){if(w==8)return;if(x()!=":"){for(c=l=0;l<4&&ZS.test(x());)c=16*c+parseInt(x(),16),H++,l++;if(x()=="."){if(l==0||(H-=l,w>6))return;for(f=0;x();){if(_=null,f>0){if(!(x()=="."&&f<4))return;H++}if(!wv.test(x()))return;for(;wv.test(x());){if(m=parseInt(x(),10),_===null)_=m;else{if(_==0)return;_=10*_+m}if(_>255)return;H++}S[w]=256*S[w]+_,++f!=2&&f!=4||w++}if(f!=4)return;break}if(x()==":"){if(H++,!x())return}else if(x())return;S[w++]=c}else{if(G!==null)return;H++,G=++w}}if(G!==null)for(v=w-G,w=7;w!=0&&v>0;)I=S[w],S[w--]=S[G+v-1],S[G+--v]=I;else if(w!=8)return;return S},vf=function(o){var c,l,f,_;if(typeof o=="number"){for(c=[],l=0;l<4;l++)c.unshift(o%256),o=a4(o/256);return c.join(".")}if(typeof o=="object"){for(c="",f=function(m){for(var v=null,I=1,S=null,w=0,G=0;G<8;G++)m[G]!==0?(w>I&&(v=S,I=w),S=null,w=0):(S===null&&(S=G),++w);return w>I&&(v=S,I=w),v}(o),l=0;l<8;l++)_&&o[l]===0||(_&&(_=!1),f===l?(c+=l?":":"::",_=!0):(c+=o[l].toString(16),l<7&&(c+=":")));return"["+c+"]"}return o},Fp={},XS=$c({},Fp,{" ":1,'"':1,"<":1,">":1,"`":1}),JS=$c({},XS,{"#":1,"?":1,"{":1,"}":1}),Mv=$c({},JS,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),lo=function(o,c){var l=t4(o,0);return l>32&&l<127&&!P(c,o)?o:encodeURIComponent(o)},Hp={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Ci=function(o){return P(Hp,o.scheme)},Ov=function(o){return o.username!=""||o.password!=""},kv=function(o){return!o.host||o.cannotBeABaseURL||o.scheme=="file"},Ef=function(o,c){var l;return o.length==2&&QS.test(o.charAt(0))&&((l=o.charAt(1))==":"||!c&&l=="|")},eN=function(o){var c;return o.length>1&&Ef(o.slice(0,2))&&(o.length==2||(c=o.charAt(2))==="/"||c==="\\"||c==="?"||c==="#")},nN=function(o){var c=o.path,l=c.length;!l||o.scheme=="file"&&l==1&&Ef(c[0],!0)||c.pop()},m4=function(o){return o==="."||o.toLowerCase()==="%2e"},Dv={},tN={},Lv={},rN={},iN={},xv={},aN={},sN={},Bp={},Gp={},Uv={},Pv={},Fv={},Hv={},uN={},Bv={},Vd={},Gs={},oN={},_l={},Cu={},Vs=function(o,c,l,f){var _,m,v,I,S,w=l||Dv,G=0,H="",x=!1,V=!1,K=!1;for(l||(o.scheme="",o.username="",o.password="",o.host=null,o.port=null,o.path=[],o.query=null,o.fragment=null,o.cannotBeABaseURL=!1,c=c.replace(f4,"")),c=c.replace(h4,""),_=Zo(c);G<=_.length;){switch(m=_[G],w){case Dv:if(!m||!QS.test(m)){if(l)return Av;w=Lv;continue}H+=m.toLowerCase(),w=tN;break;case tN:if(m&&(s4.test(m)||m=="+"||m=="-"||m=="."))H+=m.toLowerCase();else{if(m!=":"){if(l)return Av;H="",w=Lv,G=0;continue}if(l&&(Ci(o)!=P(Hp,H)||H=="file"&&(Ov(o)||o.port!==null)||o.scheme=="file"&&!o.host))return;if(o.scheme=H,l)return void(Ci(o)&&Hp[o.scheme]==o.port&&(o.port=null));H="",o.scheme=="file"?w=Hv:Ci(o)&&f&&f.scheme==o.scheme?w=rN:Ci(o)?w=sN:_[G+1]=="/"?(w=iN,G++):(o.cannotBeABaseURL=!0,o.path.push(""),w=oN)}break;case Lv:if(!f||f.cannotBeABaseURL&&m!="#")return Av;if(f.cannotBeABaseURL&&m=="#"){o.scheme=f.scheme,o.path=f.path.slice(),o.query=f.query,o.fragment="",o.cannotBeABaseURL=!0,w=Cu;break}w=f.scheme=="file"?Hv:xv;continue;case rN:if(m!="/"||_[G+1]!="/"){w=xv;continue}w=Bp,G++;break;case iN:if(m=="/"){w=Gp;break}w=Gs;continue;case xv:if(o.scheme=f.scheme,m==rs)o.username=f.username,o.password=f.password,o.host=f.host,o.port=f.port,o.path=f.path.slice(),o.query=f.query;else if(m=="/"||m=="\\"&&Ci(o))w=aN;else if(m=="?")o.username=f.username,o.password=f.password,o.host=f.host,o.port=f.port,o.path=f.path.slice(),o.query="",w=_l;else{if(m!="#"){o.username=f.username,o.password=f.password,o.host=f.host,o.port=f.port,o.path=f.path.slice(),o.path.pop(),w=Gs;continue}o.username=f.username,o.password=f.password,o.host=f.host,o.port=f.port,o.path=f.path.slice(),o.query=f.query,o.fragment="",w=Cu}break;case aN:if(!Ci(o)||m!="/"&&m!="\\"){if(m!="/"){o.username=f.username,o.password=f.password,o.host=f.host,o.port=f.port,w=Gs;continue}w=Gp}else w=Bp;break;case sN:if(w=Bp,m!="/"||H.charAt(G+1)!="/")continue;G++;break;case Bp:if(m!="/"&&m!="\\"){w=Gp;continue}break;case Gp:if(m=="@"){x&&(H="%40"+H),x=!0,v=Zo(H);for(var te=0;te<v.length;te++){var me=v[te];if(me!=":"||K){var _e=lo(me,Mv);K?o.password+=_e:o.username+=_e}else K=!0}H=""}else if(m==rs||m=="/"||m=="?"||m=="#"||m=="\\"&&Ci(o)){if(x&&H=="")return"Invalid authority";G-=Zo(H).length+1,H="",w=Uv}else H+=m;break;case Uv:case Pv:if(l&&o.scheme=="file"){w=Bv;continue}if(m!=":"||V){if(m==rs||m=="/"||m=="?"||m=="#"||m=="\\"&&Ci(o)){if(Ci(o)&&H=="")return pl;if(l&&H==""&&(Ov(o)||o.port!==null))return;if(I=Rv(o,H))return I;if(H="",w=Vd,l)return;continue}m=="["?V=!0:m=="]"&&(V=!1),H+=m}else{if(H=="")return pl;if(I=Rv(o,H))return I;if(H="",w=Fv,l==Pv)return}break;case Fv:if(!wv.test(m)){if(m==rs||m=="/"||m=="?"||m=="#"||m=="\\"&&Ci(o)||l){if(H!=""){var ye=parseInt(H,10);if(ye>65535)return YS;o.port=Ci(o)&&ye===Hp[o.scheme]?null:ye,H=""}if(l)return;w=Vd;continue}return YS}H+=m;break;case Hv:if(o.scheme="file",m=="/"||m=="\\")w=uN;else{if(!f||f.scheme!="file"){w=Gs;continue}if(m==rs)o.host=f.host,o.path=f.path.slice(),o.query=f.query;else if(m=="?")o.host=f.host,o.path=f.path.slice(),o.query="",w=_l;else{if(m!="#"){eN(_.slice(G).join(""))||(o.host=f.host,o.path=f.path.slice(),nN(o)),w=Gs;continue}o.host=f.host,o.path=f.path.slice(),o.query=f.query,o.fragment="",w=Cu}}break;case uN:if(m=="/"||m=="\\"){w=Bv;break}f&&f.scheme=="file"&&!eN(_.slice(G).join(""))&&(Ef(f.path[0],!0)?o.path.push(f.path[0]):o.host=f.host),w=Gs;continue;case Bv:if(m==rs||m=="/"||m=="\\"||m=="?"||m=="#"){if(!l&&Ef(H))w=Gs;else if(H==""){if(o.host="",l)return;w=Vd}else{if(I=Rv(o,H))return I;if(o.host=="localhost"&&(o.host=""),l)return;H="",w=Vd}continue}H+=m;break;case Vd:if(Ci(o)){if(w=Gs,m!="/"&&m!="\\")continue}else if(l||m!="?")if(l||m!="#"){if(m!=rs&&(w=Gs,m!="/"))continue}else o.fragment="",w=Cu;else o.query="",w=_l;break;case Gs:if(m==rs||m=="/"||m=="\\"&&Ci(o)||!l&&(m=="?"||m=="#")){if((S=(S=H).toLowerCase())===".."||S==="%2e."||S===".%2e"||S==="%2e%2e"?(nN(o),m=="/"||m=="\\"&&Ci(o)||o.path.push("")):m4(H)?m=="/"||m=="\\"&&Ci(o)||o.path.push(""):(o.scheme=="file"&&!o.path.length&&Ef(H)&&(o.host&&(o.host=""),H=H.charAt(0)+":"),o.path.push(H)),H="",o.scheme=="file"&&(m==rs||m=="?"||m=="#"))for(;o.path.length>1&&o.path[0]==="";)o.path.shift();m=="?"?(o.query="",w=_l):m=="#"&&(o.fragment="",w=Cu)}else H+=lo(m,JS);break;case oN:m=="?"?(o.query="",w=_l):m=="#"?(o.fragment="",w=Cu):m!=rs&&(o.path[0]+=lo(m,Fp));break;case _l:l||m!="#"?m!=rs&&(m=="'"&&Ci(o)?o.query+="%27":o.query+=m=="#"?"%23":lo(m,Fp)):(o.fragment="",w=Cu);break;case Cu:m!=rs&&(o.fragment+=lo(m,XS))}G++}},ml=function(o){var c,l,f=Lc(this,ml,"URL"),_=arguments.length>1?arguments[1]:void 0,m=String(o),v=i4(f,{type:"URL"});if(_!==void 0){if(_ instanceof ml)c=Yr(_);else if(l=Vs(c={},String(_)))throw TypeError(l)}if(l=Vs(v,m,null,c))throw TypeError(l);var I=v.searchParams=new r4,S=Nv(I);S.updateSearchParams(v.query),S.updateURL=function(){v.query=String(I)||null},u||(f.href=Vp.call(f),f.origin=lN.call(f),f.protocol=dN.call(f),f.username=cN.call(f),f.password=fN.call(f),f.host=hN.call(f),f.hostname=pN.call(f),f.port=_N.call(f),f.pathname=mN.call(f),f.search=gN.call(f),f.searchParams=vN.call(f),f.hash=EN.call(f))},Gv=ml.prototype,Vp=function(){var o=Yr(this),c=o.scheme,l=o.username,f=o.password,_=o.host,m=o.port,v=o.path,I=o.query,S=o.fragment,w=c+":";return _!==null?(w+="//",Ov(o)&&(w+=l+(f?":"+f:"")+"@"),w+=vf(_),m!==null&&(w+=":"+m)):c=="file"&&(w+="//"),w+=o.cannotBeABaseURL?v[0]:v.length?"/"+v.join("/"):"",I!==null&&(w+="?"+I),S!==null&&(w+="#"+S),w},lN=function(){var o=Yr(this),c=o.scheme,l=o.port;if(c=="blob")try{return new URL(c.path[0]).origin}catch{return"null"}return c!="file"&&Ci(o)?c+"://"+vf(o.host)+(l!==null?":"+l:""):"null"},dN=function(){return Yr(this).scheme+":"},cN=function(){return Yr(this).username},fN=function(){return Yr(this).password},hN=function(){var o=Yr(this),c=o.host,l=o.port;return c===null?"":l===null?vf(c):vf(c)+":"+l},pN=function(){var o=Yr(this).host;return o===null?"":vf(o)},_N=function(){var o=Yr(this).port;return o===null?"":String(o)},mN=function(){var o=Yr(this),c=o.path;return o.cannotBeABaseURL?c[0]:c.length?"/"+c.join("/"):""},gN=function(){var o=Yr(this).query;return o?"?"+o:""},vN=function(){return Yr(this).searchParams},EN=function(){var o=Yr(this).fragment;return o?"#"+o:""},is=function(o,c){return{get:o,set:c,configurable:!0,enumerable:!0}};if(u&&Tt(Gv,{href:is(Vp,function(o){var c=Yr(this),l=String(o),f=Vs(c,l);if(f)throw TypeError(f);Nv(c.searchParams).updateSearchParams(c.query)}),origin:is(lN),protocol:is(dN,function(o){var c=Yr(this);Vs(c,String(o)+":",Dv)}),username:is(cN,function(o){var c=Yr(this),l=Zo(String(o));if(!kv(c)){c.username="";for(var f=0;f<l.length;f++)c.username+=lo(l[f],Mv)}}),password:is(fN,function(o){var c=Yr(this),l=Zo(String(o));if(!kv(c)){c.password="";for(var f=0;f<l.length;f++)c.password+=lo(l[f],Mv)}}),host:is(hN,function(o){var c=Yr(this);c.cannotBeABaseURL||Vs(c,String(o),Uv)}),hostname:is(pN,function(o){var c=Yr(this);c.cannotBeABaseURL||Vs(c,String(o),Pv)}),port:is(_N,function(o){var c=Yr(this);kv(c)||((o=String(o))==""?c.port=null:Vs(c,o,Fv))}),pathname:is(mN,function(o){var c=Yr(this);c.cannotBeABaseURL||(c.path=[],Vs(c,o+"",Vd))}),search:is(gN,function(o){var c=Yr(this);(o=String(o))==""?c.query=null:(o.charAt(0)=="?"&&(o=o.slice(1)),c.query="",Vs(c,o,_l)),Nv(c.searchParams).updateSearchParams(c.query)}),searchParams:is(vN),hash:is(EN,function(o){var c=Yr(this);(o=String(o))!=""?(o.charAt(0)=="#"&&(o=o.slice(1)),c.fragment="",Vs(c,o,Cu)):c.fragment=null})}),wn(Gv,"toJSON",function(){return Vp.call(this)},{enumerable:!0}),wn(Gv,"toString",function(){return Vp.call(this)},{enumerable:!0}),gf){var yN=gf.createObjectURL,bN=gf.revokeObjectURL;yN&&wn(ml,"createObjectURL",function(o){return yN.apply(gf,arguments)}),bN&&wn(ml,"revokeObjectURL",function(o){return bN.apply(gf,arguments)})}gu(ml,"URL"),Fn({global:!0,forced:!bv,sham:!u},{URL:ml});var ci,jd=null,qd=function(){function o(){ie(this,o)}return se(o,null,[{key:"downloadRecordedFile",value:function(c,l){var f=window.URL.createObjectURL(c),_=document.createElement("a");_.style.display="none",_.href=f,_.download=l,document.body.appendChild(_),_.click(),setTimeout(function(){document.body.removeChild(_),window.URL.revokeObjectURL(f)},100)}},{key:"getMergedAudioStream",value:function(c,l){var f=[];jd||(jd=new(window.AudioContext||window.webkitAudioContext));var _=jd.createGain();_.gain.value=1;var m=new MediaStream;m.addTrack(c),f.push(jd.createMediaStreamSource(m).connect(_));var v=new MediaStream;v.addTrack(l),f.push(jd.createMediaStreamSource(v).connect(_));for(var I=jd.createMediaStreamDestination(),S=0,w=f;S<w.length;S++)w[S].connect(I);return I.stream.getAudioTracks()[0]}},{key:"getVideoStream",value:function(c){var l=document.createElement("canvas"),f=zg.value,_=f.width,m=f.height;l.width=_,l.height=m;var v=c.videoWidth,I=c.videoHeight,S=l.getContext("2d"),w=setInterval(function(){var G=c.videoWidth,H=c.videoHeight;if(G!==0&&H!==0){if((I>H||v>G)&&S.fillRect(0,0,_,m),v=G,I=H,H>l.height){var x=c.videoWidth/c.videoHeight;G=(H=l.height)*x}S.drawImage(c,l.width/2-G/2,l.height/2-H/2,G,H)}},10);return{stream:l.captureStream(),cleanup:function(){return clearInterval(w)}}}}]),o}(),g4=function(){function o(){ie(this,o)}return se(o,null,[{key:"getRecorderMimeType",value:function(c){switch(c){case Di.REMOTE_AUDIO_AND_VIDEO:case Di.LOCAL_AUDIO_REMOTE_AUDIO_AND_VIDEO:case Di.LOCAL_AUDIO_AND_VIDEO_REMOTE_AUDIO:return this.getVideoRecordFileMimeType();case Di.REMOTE_AUDIO_ONLY:case Di.LOCAL_REMOTE_AUDIOS:return this.getAudioRecordFileMimeType();default:return this.getVideoRecordFileMimeType()}}},{key:"getVideoRecordFileMimeType",value:function(){var c="video/mp4";return MediaRecorder.isTypeSupported(c)||(c="video/webm"),c}},{key:"getAudioRecordFileMimeType",value:function(){var c="audio/mp4";return MediaRecorder.isTypeSupported(c)||(c="audio/webm"),c}},{key:"createStream",value:function(c,l){var f={mimeType:this.getRecorderMimeType(l)},_=c.localMediaView.srcObject,m=c.remoteMediaView.srcObject;switch(l){case Di.REMOTE_AUDIO_AND_VIDEO:return{stream:m,options:f};case Di.REMOTE_AUDIO_ONLY:var v=new MediaStream;return v.addTrack(m.getAudioTracks()[0]),{stream:v,options:f};case Di.LOCAL_REMOTE_AUDIOS:var I=new MediaStream,S=qd.getMergedAudioStream(_.getAudioTracks()[0],m.getAudioTracks()[0]);return I.addTrack(S),{stream:I,options:f};case Di.LOCAL_AUDIO_REMOTE_AUDIO_AND_VIDEO:var w=qd.getVideoStream(c.remoteMediaView),G=w.stream,H=w.cleanup,x=qd.getMergedAudioStream(_.getAudioTracks()[0],m.getAudioTracks()[0]);return G.addTrack(x),{stream:G,options:f,cleanup:H};case Di.LOCAL_AUDIO_AND_VIDEO_REMOTE_AUDIO:var V=qd.getVideoStream(c.localMediaView),K=V.stream,te=V.cleanup,me=qd.getMergedAudioStream(_.getAudioTracks()[0],m.getAudioTracks()[0]);return K.addTrack(me),{stream:K,options:f,cleanup:te};default:return ae.error("Cannot reach here!"),{options:f}}}}]),o}(),as=function(){function o(c,l){ie(this,o),this.call=c,this.stateManager=l,this.timer=null}return se(o,[{key:"dialSent",value:function(){ae.verbose("[".concat(this.type,"] dialSent"))}},{key:"dialFailed",value:function(){ae.verbose("[".concat(this.type,"] dialFailed"))}},{key:"accept",value:function(c){ae.verbose("[".concat(this.type,"] accept"))}},{key:"acceptSent",value:function(c){ae.verbose("[".concat(this.type,"] acceptSent"))}},{key:"acceptFailed",value:function(){ae.verbose("[".concat(this.type,"] acceptFailed"))}},{key:"receiveAccept",value:function(){ae.verbose("[".concat(this.type,"] receiveAccept"))}},{key:"receiveAccepted",value:function(){ae.verbose("[".concat(this.type,"] receiveAccepted"))}},{key:"end",value:function(){ae.verbose("[".concat(this.type,"] end"))}},{key:"endSent",value:function(c){ae.verbose("[".concat(this.type,"] endSent"))}},{key:"receiveOffer",value:function(){ae.verbose("[".concat(this.type,"] receiveOffer"))}},{key:"receiveEnd",value:function(c){ae.verbose("[".concat(this.type,"] receiveEnd"))}},{key:"timeout",value:function(){ae.verbose("[".concat(this.type,"] timeout"))}},{key:"pcConnected",value:function(){ae.verbose("[".concat(this.type,"] pc connected"))}},{key:"pcReconnecting",value:function(){ae.verbose("[".concat(this.type,"] pc reconnecting"))}},{key:"closed",value:function(){ae.verbose("[".concat(this.type,"] closed"))}},{key:"onStart",value:function(){}},{key:"onDestroy",value:function(){}},{key:"fireTimeout",value:function(){}},{key:"toggleVideo",value:function(c){ae.verbose("[".concat(this.type,"] toggleVideo ").concat(c))}},{key:"toggleMicrophone",value:function(c){ae.verbose("[".concat(this.type,"] toggleMicrophone ").concat(c))}},{key:"_createTimer",value:function(c,l){var f=this;this.timer?ae.error("Only one timer allowed"):this.timer=setTimeout(function(){f._removeTimer(),c()},l)}},{key:"_removeTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}}]),o}();(function(o){o.IDLE="idle",o.DIALING="dialing",o.RINGING="ringing",o.ACCEPTING="accepting",o.ESTABLISHED="established",o.CONNECTED="connected",o.RECONNECTING="reconnecting",o.ICERESTART="icerestart",o.ENDED="ended",o.ABORTED="aborted",o.CLOSING="closing",o.ENDING="ending",o.CANCELED="canceled"})(ci||(ci={}));var yf,v4=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"onStart",value:function(){this.call.stopToSendAlive(),this.call.fireOnEnded()}},{key:"dialSent",value:function(){this.call.sendCancelCommand().catch(function(f){return ae.debug(f)})}},{key:"dialFailed",value:function(){this.stateManager.toEnded()}},{key:"endSent",value:function(f){this.call.setEndInfo(f.payload.endedCall),this.stateManager.toEnded()}},{key:"receiveEnd",value:function(f){this.call.setEndInfo(f.payload.endedCall),this.stateManager.toEnded()}},{key:"type",get:function(){return ci.ABORTED}}]),l}(as);(function(o){o.ACCEPTING="accepting_timeout",o.ANSWERING="answering_timeout",o.OFFERING="offering_timeout"})(yf||(yf={}));var E4=function(o){ce(f,o);var c,l=fe(f);function f(){return ie(this,f),l.apply(this,arguments)}return se(f,[{key:"onStart",value:function(){this.call.sendAcceptCommand().catch(function(_){return ae.debug(_)}),this.call.startCallConnectionTimer()}},{key:"acceptSent",value:function(){this.stateManager.toEstablished()}},{key:"receiveOffer",value:(c=Bn(regeneratorRuntime.mark(function _(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:this.stateManager.toEstablished();case 1:case"end":return m.stop()}},_,this)})),function(){return c.apply(this,arguments)})},{key:"acceptFailed",value:function(){this.call.setEndResult(fr.ACCEPT_FAILED),this.stateManager.toClosing()}},{key:"end",value:function(){this.call.sendEndCommand().catch(function(_){return ae.debug(_)}),this.call.setEndResult(fr.COMPLETED),this.stateManager.toClosing()}},{key:"fireTimeout",value:function(){this.call.sendTimeoutCommand(yf.ACCEPTING).catch(function(_){return ae.debug(_)}),this.call.setEndResult(fr.TIMED_OUT),this.stateManager.toClosing()}},{key:"receiveEnd",value:function(_){this.call.setEndResult(_.payload.endedCall.endResult),this.call.setEndInfo(_.payload.endedCall),this.stateManager.toClosing()}},{key:"toggleMicrophone",value:function(_){this.call.toggleMicrophone(_),this.call.sendAudioCommand().catch(function(m){return ae.debug(m)})}},{key:"toggleVideo",value:function(_){this.call.toggleVideo(_),this.call.sendVideoCommand().catch(function(m){return ae.debug(m)})}},{key:"type",get:function(){return ci.ACCEPTING}}]),f}(as),y4=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"onStart",value:function(){this.call.stopCallConnectionTimer(),this.call.fireOnRinging(),this.stateManager.toClosing()}},{key:"type",get:function(){return ci.CANCELED}}]),l}(as),b4=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"onStart",value:function(){this.call.stopGetWebRtcStats(),this.call.stopCallConnectionTimer(),this.call.stopToSendAlive(),this.call.stopCurrentRecording(),this.call.stopScreenShare(),this.call.closeRTCConnection(),this.closed()}},{key:"endSent",value:function(f){this.call.setEndInfo(f.payload.endedCall)}},{key:"closed",value:function(){this.stateManager.toEnding()}},{key:"type",get:function(){return ci.CLOSING}}]),l}(as),C4=function(o){ce(l,o);var c=fe(l);function l(f,_,m){var v;return ie(this,l),(v=c.call(this,f,_)).isReconnected=m,v}return se(l,[{key:"onStart",value:function(){this.call.stopCallConnectionTimer(),this.call.startGetWebRtcStats(),this.call.sendConnectedInfo(),this.isReconnected?(this.call.setIsReconnected(!0),this.call.fireOnReconnected(),this.call.playSound(Ma.RECONNECTED)):(this.call.calcCallSetupTime(),this.call.fireOnConnected())}},{key:"onDestroy",value:function(){this.isReconnected&&this.call.stopSound(Ma.RECONNECTED)}},{key:"pcReconnecting",value:function(){this.stateManager.toReconnecting()}},{key:"end",value:function(){this.call.sendEndCommand().catch(function(f){return ae.debug(f)}),this.call.setEndResult(fr.COMPLETED),this.stateManager.toClosing()}},{key:"receiveEnd",value:function(f){this.call.setEndResult(f.payload.endedCall.endResult),this.call.setEndInfo(f.payload.endedCall),this.stateManager.toClosing()}},{key:"toggleMicrophone",value:function(f){this.call.toggleMicrophone(f),this.call.sendAudioCommand().catch(function(_){return ae.debug(_)})}},{key:"toggleVideo",value:function(f){this.call.toggleVideo(f),this.call.sendVideoCommand().catch(function(_){return ae.debug(_)})}},{key:"type",get:function(){return ci.CONNECTED}}]),l}(as),I4=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"onStart",value:function(){var f=this;this._createTimer(function(){f._noAnswer()},this._getTimeoutTime()),this.call.startToSendAlive(),this.call.playSound(Ma.DIALING)}},{key:"onDestroy",value:function(){this._removeTimer(),this.call.stopSound(Ma.DIALING)}},{key:"receiveAccept",value:function(){this.stateManager.toEstablished()}},{key:"end",value:function(){this.call.sendCancelCommand().catch(function(f){return ae.debug(f)}),this.call.setEndResult(fr.CANCELED),this.stateManager.toClosing()}},{key:"receiveEnd",value:function(f){this.call.setEndResult(f.payload.endedCall.endResult),this.call.setEndInfo(f.payload.endedCall),this.stateManager.toClosing()}},{key:"_noAnswer",value:function(){this.call.sendNoAnswerCommand().catch(function(f){return ae.debug(f)}),this.call.setEndResult(fr.NO_ANSWER),this.stateManager.toClosing()}},{key:"_getTimeoutTime",value:function(){return this.call.options.ringingTimeoutValue}},{key:"toggleMicrophone",value:function(f){this.call.toggleMicrophone(f),this.call.sendAudioCommand().catch(function(_){return ae.debug(_)})}},{key:"toggleVideo",value:function(f){this.call.toggleVideo(f),this.call.sendVideoCommand().catch(function(_){return ae.debug(_)})}},{key:"type",get:function(){return ci.DIALING}}]),l}(as),T4=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"onStart",value:function(){this.call.stopAllSound()}},{key:"endSent",value:function(f){this.call.setEndInfo(f.payload.endedCall)}},{key:"type",get:function(){return ci.ENDED}}]),l}(as),S4=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"onStart",value:function(){this.call.sendCallSummary(),this.call.fireOnEnded(),this.stateManager.toEnded()}},{key:"type",get:function(){return ci.ENDING}}]),l}(as),N4=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this,f,_)).isInitiator=f.isCaller,m}return se(l,[{key:"onStart",value:function(){this.call.fireOnEstablished(),this.call.sendAudioCommand(),this.call.sendVideoCommand(),this.call.createPeerConnection(),this.isInitiator&&this.call.startCallConnectionTimer()}},{key:"onDestroy",value:function(){}},{key:"pcConnected",value:function(){this.stateManager.toConnected(!1)}},{key:"end",value:function(){this.call.sendEndCommand().catch(function(f){return ae.debug(f)}),this.call.setEndResult(fr.COMPLETED),this.stateManager.toClosing()}},{key:"fireTimeout",value:function(){this.call.sendTimeoutCommand(this.isInitiator?yf.OFFERING:yf.ANSWERING).catch(function(f){return ae.debug(f)}),this.call.setEndResult(fr.TIMED_OUT),this.stateManager.toClosing()}},{key:"receiveEnd",value:function(f){this.call.setEndResult(f.payload.endedCall.endResult),this.call.setEndInfo(f.payload.endedCall),this.stateManager.toClosing()}},{key:"toggleMicrophone",value:function(f){this.call.toggleMicrophone(f),this.call.sendAudioCommand().catch(function(_){return ae.debug(_)})}},{key:"toggleVideo",value:function(f){this.call.toggleVideo(f),this.call.sendVideoCommand().catch(function(_){return ae.debug(_)})}},{key:"type",get:function(){return ci.ESTABLISHED}}]),l}(as),A4=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"dialSent",value:function(){this.stateManager.toDialing()}},{key:"dialFailed",value:function(){this.call.setEndResult(fr.DIAL_FAILED),this.stateManager.toClosing()}},{key:"end",value:function(){this.call.setEndResult(fr.CANCELED),this.stateManager.toAborted()}},{key:"toggleMicrophone",value:function(f){this.call.toggleMicrophone(f)}},{key:"toggleVideo",value:function(f){this.call.toggleVideo(f)}},{key:"type",get:function(){return ci.IDLE}}]),l}(as),w4=function(o){ce(l,o);var c=fe(l);function l(f,_){return ie(this,l),c.call(this,f,_)}return se(l,[{key:"onStart",value:function(){var f=this;this._createTimer(function(){f.call.sendConnectionLostCommand().catch(function(_){return ae.debug(_)})},this._getTimeoutTime()),this.call.fireOnReconnecting(),this.call.playSound(Ma.RECONNECTING)}},{key:"onDestroy",value:function(){this._removeTimer(),this.call.stopSound(Ma.RECONNECTING)}},{key:"pcConnected",value:function(){this.stateManager.toConnected(!0)}},{key:"end",value:function(){this.call.sendEndCommand().catch(function(f){return ae.debug(f)}),this.call.setEndResult(fr.COMPLETED),this.stateManager.toClosing()}},{key:"endSent",value:function(f){this.call.setEndResult(fr.CONNECTION_LOST),this.call.setEndInfo(f.payload.endedCall),this.stateManager.toClosing()}},{key:"receiveEnd",value:function(f){this.call.setEndResult(f.payload.endedCall.endResult),this.call.setEndInfo(f.payload.endedCall),this.stateManager.toClosing()}},{key:"_getTimeoutTime",value:function(){return 3e4}},{key:"toggleMicrophone",value:function(f){this.call.toggleMicrophone(f),this.call.sendAudioCommand().catch(function(_){return ae.debug(_)})}},{key:"toggleVideo",value:function(f){this.call.toggleVideo(f),this.call.sendVideoCommand().catch(function(_){return ae.debug(_)})}},{key:"type",get:function(){return ci.RECONNECTING}}]),l}(as),R4=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return se(l,[{key:"onStart",value:function(){var f=this;this._createTimer(function(){f._noAnswer()},this._getTimeoutTime()),this.call.startToSendAlive(),this.call.playSound(Ma.RINGING),this.call.fireOnRinging()}},{key:"onDestroy",value:function(){this._removeTimer(),this.call.stopSound(Ma.RINGING)}},{key:"accept",value:function(f){this.stateManager.toAccepting()}},{key:"receiveAccepted",value:function(){this.call.setEndResult(fr.OTHER_DEVICE_ACCEPTED),this.stateManager.toClosing()}},{key:"end",value:function(){this.call.sendDeclineCommand().catch(function(f){return ae.debug(f)}),this.call.setEndResult(fr.DECLINED),this.stateManager.toClosing()}},{key:"endSent",value:function(f){this.call.setEndResult(fr.DECLINED),this.call.setEndInfo(f.payload.endedCall),this.stateManager.toClosing()}},{key:"receiveEnd",value:function(f){this.call.setEndResult(f.payload.endedCall.endResult),this.call.setEndInfo(f.payload.endedCall),this.stateManager.toClosing()}},{key:"toggleMicrophone",value:function(f){this.call.toggleMicrophone(f)}},{key:"toggleVideo",value:function(f){this.call.toggleVideo(f)}},{key:"_noAnswer",value:function(){this.call.sendNoAnswerCommand().catch(function(f){return ae.debug(f)}),this.call.setEndResult(fr.NO_ANSWER),this.stateManager.toClosing()}},{key:"_getTimeoutTime",value:function(){return this.call.options.ringingTimeoutValue}},{key:"type",get:function(){return ci.RINGING}}]),l}(as),M4=function(){function o(c){ie(this,o),this.call=c,this._state=null}return se(o,[{key:"toAborted",value:function(){this._changeState(new v4(this.call,this))}},{key:"toAccepting",value:function(){this._changeState(new E4(this.call,this))}},{key:"toCanceled",value:function(){this._changeState(new y4(this.call,this))}},{key:"toClosing",value:function(){this._changeState(new b4(this.call,this))}},{key:"toConnected",value:function(c){this._changeState(new C4(this.call,this,c))}},{key:"toDialing",value:function(){this._changeState(new I4(this.call,this))}},{key:"toEnded",value:function(){this._changeState(new T4(this.call,this))}},{key:"toEnding",value:function(){this._changeState(new S4(this.call,this))}},{key:"toEstablished",value:function(){this._changeState(new N4(this.call,this))}},{key:"toIdle",value:function(){this._changeState(new A4(this.call,this))}},{key:"toReconnecting",value:function(){this._changeState(new w4(this.call,this))}},{key:"toRinging",value:function(){this._changeState(new R4(this.call,this))}},{key:"_changeState",value:function(c){this._state&&this._state.type===c.type?ae.error(new Error("self-transition is not allowed")):(ae.debug("state: ".concat(this._state?this._state.type:"null"," -> ").concat(c.type)),this._state&&this._state.onDestroy(),this._state=c,this._state.onStart())}},{key:"state",get:function(){return this._state}}]),o}(),O4=function(){function o(c,l,f){ie(this,o),this._ctx=c,this.peerConnectionId=l,this.callId=f}return se(o,[{key:"sendOfferSdp",value:function(c){var l=Kt.createOffer(this.callId,this.peerConnectionId,c.sdp);return this._ctx.sender.send(l)}},{key:"sendAnswerSdp",value:function(c){var l=Kt.createAnswer(this.callId,this.peerConnectionId,c.sdp);return this._ctx.sender.send(l)}},{key:"sendCandidate",value:function(c){var l=Kt.createCandidate(this.callId,this.peerConnectionId,c.candidate,c.sdpMLineIndex,c.sdpMid);return this._ctx.sender.send(l)}}]),o}(),k4=R0(null,function(o,c){var l,f,_,m,v,I,S,w,G,H;return{F:function(x){ce(K,x);var V=fe(K);function K(te,me){var _e;return ie(this,K),_e=V.call(this),o(je(_e)),_e._ctx=te,_e._options=me,_e._localMediaView=null,_e._remoteMediaView=null,_e._caller=null,_e._callee=null,_e._localConstraints={audio:!0,video:!0},_e._remoteConstraints={audio:void 0,video:void 0},_e._endResult=null,_e._endInfo=null,_e._customItems=null,_e._webhook=null,_e._remoteRecordingStatus=no.NONE,_e._sendBirdChatOptions=null,_e._holdedBy=[],_e._wasRelayed=!1,_e._logManager=new G6(te,je(_e)),_e._stateManager=new M4(je(_e)),_e._isReconnected=!1,_e._rotatablePeerConnection=new nU(te,{audio:"sendrecv",video:"sendrecv"}),_e._rotatablePeerConnection.once("initialized",function(){_e._onPeerConnectionInitialized()}),_e._rotatablePeerConnection.on("replaced",function(){_e._onPeerConnectionReplaced()}),_e._localStream=new aT(te.deviceManager),_e._localStream.on("streamChanged",function(){_e._onLocalStream()}),_e._localStream.on("audioOutputChanged",function(){_e._onAudioOutputChanged()}),_e._localStream.on("screenShareStreamStopped",function(){_e.onScreenShareStopped&&_e.onScreenShareStopped(),_e._dispatchEvent("onScreenShareStopped")}),_e}return K}(c),d:[{kind:"field",key:"_wasCalleeDialReceivedProcessed",value:function(){return!1}},{kind:"field",key:"_remoteCapabilities",value:function(){return[]}},{kind:"get",key:"_pc",value:function(){return this._rotatablePeerConnection.activePeerConnection}},{kind:"get",key:"callId",value:function(){return this._callId}},{kind:"get",key:"isVideoCall",value:function(){return this._isVideoCall}},{kind:"get",key:"isCaller",value:function(){return this._isCaller}},{kind:"get",key:"caller",value:function(){return this._caller}},{kind:"get",key:"callee",value:function(){return this._callee}},{kind:"get",key:"localUser",value:function(){return this._isCaller?this.caller:this.callee}},{kind:"get",key:"remoteUser",value:function(){return this._isCaller?this.callee:this.caller}},{kind:"get",key:"isLocalAudioEnabled",value:function(){return this._localConstraints.audio}},{kind:"get",key:"isRemoteAudioEnabled",value:function(){return this._remoteConstraints.audio}},{kind:"get",key:"isLocalVideoEnabled",value:function(){return this._localConstraints.video}},{kind:"get",key:"isRemoteVideoEnabled",value:function(){return this._remoteConstraints.video}},{kind:"get",key:"localRecordingStatus",value:function(){var x,V;return(x=(V=this._record)===null||V===void 0?void 0:V.recordingStatus)!==null&&x!==void 0?x:no.NONE}},{kind:"get",key:"remoteRecordingStatus",value:function(){return this._remoteRecordingStatus}},{kind:"get",key:"localMediaView",value:function(){return this._localMediaView}},{kind:"get",key:"remoteMediaView",value:function(){return this._remoteMediaView}},{kind:"get",key:"myRole",value:function(){return this._isCaller?Eu.CALLER:Eu.CALLEE}},{kind:"get",key:"endedBy",value:function(){return this._endInfo?this._endInfo.endedBy:void 0}},{kind:"get",key:"options",value:function(){return this._options}},{kind:"get",key:"isOngoing",value:function(){return!this.isEnded}},{kind:"get",key:"isOnHold",value:function(){return this._holdedBy.length>0}},{kind:"get",key:"_isLocalOnHold",value:function(){return this._holdedBy.indexOf(this.localUser.userId)>-1}},{kind:"get",key:"isEnded",value:function(){return!!this._endResult}},{kind:"get",key:"endResult",value:function(){return this._endResult}},{kind:"get",key:"_state",value:function(){return this._stateManager.state}},{kind:"get",key:"customItems",value:function(){return Fr({},this._customItems)}},{kind:"get",key:"rtcConnection",value:function(){var x;return(x=this._pc)===null||x===void 0?void 0:x.rtcConnection}},{kind:"get",key:"callLog",value:function(){var x=this._state.type;if(x!==ci.ENDING&&x!==ci.ENDED)return null;var V=this._endInfo;return new xp({call_id:V?V.callId:this.callId,is_video_call:V?V.isVideoCall:this.isVideoCall,custom_items:V?V.customItems:this._customItems,user_role:V?V.userRole:this.myRole,started_at:V?V.startedAt:this._startedAt||Date.now(),ended_at:V?V.endedAt:Date.now(),participants:V?V._participants:[this.caller,this.callee],ended_by:this.endedBy,duration:V?V.duration:this.getDuration(),end_result:V?V.endResult:this.endResult,call_type:V?V.callType:"direct"},!1)}},{kind:"get",key:"_record",value:function(){return this._ctx.recordingManager.getRecord(this._recordId)}},{kind:"get",key:"_isTurnChangedSupported",value:function(){return yv.includes("turn_changed")&&this._remoteCapabilities.includes("turn_changed")}},{kind:"method",key:"setLocalMediaView",value:(H=Bn(regeneratorRuntime.mark(function x(V){return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,this._updateLocalMediaView(V);case 2:case"end":return K.stop()}},x,this)})),function(x){return H.apply(this,arguments)})},{kind:"method",key:"setRemoteMediaView",value:(G=Bn(regeneratorRuntime.mark(function x(V){return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,this._updateRemoteMediaView(V);case 2:case"end":return K.stop()}},x,this)})),function(x){return G.apply(this,arguments)})},{kind:"method",key:"startDuration",value:function(){this._startedAt===void 0&&(this._startedAt=Date.now())}},{kind:"method",key:"getDuration",value:function(){return this._endInfo?this._endInfo.duration:this._startedAt===void 0?0:Date.now()-this._startedAt}},{kind:"method",key:"_send",value:function(x){return this._ctx.sender.send(x)}},{kind:"method",decorators:[LS({callOption:Lg})],key:"dial",value:function(x){var V=this,K=x.userId,te=x.isVideoCall,me=x.callOption,_e=x.customItems,ye=x.sendBirdChatOptions,Xe=x.webhook;this._isCaller=!0,this._stateManager.toIdle();var on=new mp;return this._dialDeferred=on,this._isVideoCall=te,this._localStream.mediaConstraints={audio:!0,video:te},this._sendBirdChatOptions=ye,this._webhook=Xe,this._setLocalOption(me),this._getLocalStream(),this._setCustomItems(_e),this._logManager.summary.onDial(),this.sendDialCommand(K).then(function(){var Mn;(Mn=V._dialDeferred)===null||Mn===void 0||Mn.resolve(),delete V._dialDeferred}).catch(function(Mn){var Zn;(Zn=V._dialDeferred)===null||Zn===void 0||Zn.reject(Mn),delete V._dialDeferred}),on.promise}},{kind:"method",key:"_dialed",value:function(x){this._isCaller=!1;var V=x.payload;this._isVideoCall=V.isVideoCall,this._localStream.mediaConstraints={audio:!0,video:V.isVideoCall},this._remoteCapabilities=V.capabilities,this._initTurnCredential=V.turnCredential,this._isTurnChangedSupported&&(this._initTurnCredential.turnUrls=[this._initTurnCredential.turnUrls[0]]),this._setCallInfo(V.callId,V.caller,V.callee),this._setCustomItems(V.customItems),this._setRemoteOption(V.constraints),this._stateManager.toRinging()}},{kind:"method",key:"_dialSent",value:function(x){var V=x.payload;this._setCallInfo(V.callId,V.caller,V.callee),this._logManager.summary.onDialAck(),this._state.dialSent()}},{kind:"method",key:"_calleeDialReceived",value:function(x){var V;this._wasCalleeDialReceivedProcessed||(this._wasCalleeDialReceivedProcessed=!0,this._dispatchEvent("onCalleeDialReceived",this),(V=this.onCalleeDialReceived)===null||V===void 0||V.call(this,this))}},{kind:"method",decorators:[el(el.messages.CALL_IS_NOT_SUPPORTED),LS({callOption:Lg})],key:"accept",value:function(x){var V=x.callOption,K=x.holdActiveCall;ae.info("accept()"),K?this._ctx.callManager.holdExcept(this):this._ctx.callManager.endExcept(this),this._setLocalOption(V),this._getLocalStream(),this._logManager.summary.onAccept(),this._state.accept(V)}},{kind:"method",key:"_receiveAccept",value:function(x){var V=x.payload;this._remoteCapabilities=V.capabilities,this._initTurnCredential=V.turnCredential,this._isTurnChangedSupported&&(this._initTurnCredential.turnUrls=[this._initTurnCredential.turnUrls[0]]),this._setRemoteOption(V.constraints),this._logManager.summary.onAcceptAck(),this._state.receiveAccept()}},{kind:"method",key:"_canceled",value:function(x){var V=x.payload.endedCall;this._setCallInfo(V.callId,V.caller,V.callee),this._setCustomItems(V.customItems),this.setEndResult(V.endResult),this.setEndInfo(V),this._stateManager.toCanceled()}},{kind:"method",key:"end",value:function(){ae.info("end()"),this._dialDeferred&&(this._dialDeferred.reject(new uT(De.DIAL_CANCELED)),delete this._dialDeferred),this._state.end()}},{kind:"method",key:"_setLocalOption",value:function(x){this._updateLocalMediaView(x.localMediaView),this._updateRemoteMediaView(x.remoteMediaView),this._localConstraints.audio=x.audioEnabled,this._localConstraints.video=x.videoEnabled}},{kind:"method",key:"_setRemoteOption",value:function(x){this._remoteConstraints=x}},{kind:"method",key:"_setCallInfo",value:function(x,V,K){this._callId=x,this._caller=V,this._callee=K}},{kind:"method",key:"setEndResult",value:function(x){x&&(Object.values(fr).includes(x)?this._endResult=x:this._endResult=fr.UNKNOWN)}},{kind:"method",key:"setEndInfo",value:function(x){this._endInfo=x}},{kind:"method",key:"_setRemoteAudioEnabled",value:function(x){var V,K=this._remoteConstraints.audio;this._remoteConstraints.audio=x,K!==x&&(this._dispatchEvent("onRemoteAudioSettingsChanged",this),(V=this.onRemoteAudioSettingsChanged)===null||V===void 0||V.call(this,this))}},{kind:"method",key:"_setRemoteVideoEnabled",value:function(x){var V,K=this._remoteConstraints.video;this._remoteConstraints.video=x,K!==x&&(this._dispatchEvent("onRemoteVideoSettingsChanged",this),(V=this.onRemoteVideoSettingsChanged)===null||V===void 0||V.call(this,this))}},{kind:"method",key:"_setHoldInfo",value:function(x,V,K){var te,me=V?this.localUser:this.remoteUser;if(this._wasRelayed)if(K)this._holdedBy.indexOf(me.userId)<0&&this._holdedBy.push(me.userId);else{var _e=this._holdedBy.indexOf(me.userId);_e>-1&&this._holdedBy.splice(_e,1)}else this._holdedBy=x;this._updateStreamByHoldStream(),this._dispatchEvent("onUserHoldStatusChanged",this,V,K),(te=this.onUserHoldStatusChanged)===null||te===void 0||te.call(this,this,V,K)}},{kind:"method",key:"_setCustomItems",value:function(x){this._customItems=x||{}}},{kind:"method",key:"_setRemoteRecordingStatus",value:function(x){var V,K=this._remoteRecordingStatus;this._remoteRecordingStatus=x,x!==K&&(this._dispatchEvent("onRemoteRecordingStatusChanged",this),(V=this.onRemoteRecordingStatusChanged)===null||V===void 0||V.call(this,this))}},{kind:"method",key:"closeRTCConnection",value:function(){this._releaseLocalStream(),this._rotatablePeerConnection.removeAllEventListeners(),this._rotatablePeerConnection.close()}},{kind:"method",key:"startVideo",value:function(){ae.info("startVideo()"),this._state.toggleVideo(!0)}},{kind:"method",key:"stopVideo",value:function(){ae.info("stopVideo()"),this._state.toggleVideo(!1)}},{kind:"method",key:"hold",value:(w=Bn(regeneratorRuntime.mark(function x(){return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(ae.info("hold()"),!this._isLocalOnHold){V.next=3;break}throw new Jt(De.ERR_CALL_ALREADY_ON_HOLD);case 3:return V.next=5,this.sendHoldCommand(!0,this._wasRelayed);case 5:case"end":return V.stop()}},x,this)})),function(){return w.apply(this,arguments)})},{kind:"method",key:"unhold",value:(S=Bn(regeneratorRuntime.mark(function x(V){return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(ae.info("unhold()"),this._isLocalOnHold){K.next=3;break}throw new Jt(De.ERR_ACTIVE_CALL_IN_PROGRESS);case 3:if(V&&this._ctx.callManager.endExcept(this),!(this._ctx.callManager.getActiveCallCount()>0)){K.next=6;break}throw new Jt(De.ERR_ANOTHER_CALL_IN_PROGRESS);case 6:return K.next=8,this.sendHoldCommand(!1,this._wasRelayed);case 8:case"end":return K.stop()}},x,this)})),function(x){return S.apply(this,arguments)})},{kind:"method",key:"_holdSent",value:function(x,V){var K=x.payload;K.isRelayed&&(this._wasRelayed=!0),this._setHoldInfo(K.holdedBy,!0,V)}},{kind:"method",key:"_updateStreamByHoldStream",value:function(){var x,V=this;this.stopScreenShare(),this._getLocalStream(),(x=this._pc)!==null&&x!==void 0&&x.remoteStream&&(this._pc.remoteStream.getAudioTracks().forEach(function(K){K.enabled=!V.isOnHold}),this._pc.remoteStream.getVideoTracks().forEach(function(K){K.enabled=!V.isOnHold}))}},{kind:"method",key:"_checkRecordingCondition",value:function(x){return this._state.type!==ci.CONNECTED?(ae.error(Yu.getErrorMessage(De.ERR_CALL_NOT_CONNECTED_YET)),!1):!(!this.isVideoCall&&x.isVideo)||(ae.error(Yu.getErrorMessage(De.ERR_WRONG_RECORDING_TYPE_FOR_AUDIO_CALL)),!1)}},{kind:"method",key:"startRecording",value:function(x){var V=this,K=new RI(x);if(!Object.values(Di).includes(K.recordingType))return ae.error(Yu.getErrorMessage(De.ERR_INVALID_RECORDING_TYPE)),!1;try{(function(){if(!window.MediaRecorder){var Mn=Yu.getErrorMessage(De.ERR_NOT_SUPPORTED_BROWSER_FOR_RECORDING);throw ae.error(Mn),Mn}})()}catch{return}if(this._checkRecordingCondition(K))if(this._recordId)ae.error(Yu.getErrorMessage(De.ERR_RECORDING_ALREADY_IN_PROGRESS));else{var te=g4.createStream(this,K.recordingType),me=te.stream,_e=te.options,ye=te.cleanup,Xe=this._ctx.recordingManager.startRecording(me,_e,Fr(Fr({},K),{},{callId:this.callId}));if(Xe){var on=function(){V.sendRecordingCommand(Xe.recordId,x.recordingType,Xe.recordingStatus)};return Xe.on("start",function(){return on()}),Xe.on("stop",function(){ye&&ye(),on()}),Xe.on("pause",function(){return on()}),Xe.on("resume",function(){return on()}),Xe.on("error",function(){return on()}),this._recordId=Xe.recordId,Xe.recordId}}}},{kind:"method",key:"stopRecording",value:function(x){return x&&this._recordId===x?(this._ctx.recordingManager.stopRecording(x),delete this._recordId,!0):(ae.error(Yu.getErrorMessage(De.ERR_FAILED_TO_STOP_RECORDING)),!1)}},{kind:"method",key:"stopCurrentRecording",value:function(){return!!this._recordId&&this.stopRecording(this._recordId)}},{kind:"method",key:"toggleVideo",value:function(x){var V=this;if(this._localConstraints.video!==x){this._localConstraints.video=x;var K=this._getLocalStream();K&&K.getVideoTracks().forEach(function(te){te.enabled=V._isMediaEnabled("video")})}}},{kind:"method",key:"muteMicrophone",value:function(){ae.info("muteMicrophone()"),this._state.toggleMicrophone(!1)}},{kind:"method",key:"unmuteMicrophone",value:function(){ae.info("unmuteMicrophone()"),this._state.toggleMicrophone(!0)}},{kind:"method",key:"toggleMicrophone",value:function(x){var V=this;if(this._localConstraints.audio!==x){this._localConstraints.audio=x;var K=this._getLocalStream();K&&K.getAudioTracks().forEach(function(te){te.enabled=V._isMediaEnabled("audio")})}}},{kind:"method",key:"_validateScreenShareAvailability",value:function(){if(this._state.type!==ci.CONNECTED&&this._state.type!==ci.RECONNECTING)throw new Jt(De.ERR_SCREEN_SHARE_REQUEST_BEFORE_CALL_IS_CONNECTED);if(!this.isVideoCall)throw new Jt(De.ERR_SCREEN_SHARE_RESTRICTED_FROM_AUDIO_CALL);if(this.isLocalScreenShareEnabled)throw new Jt(De.ERR_SCREEN_SHARE_ALREADY_IN_PROGRESS);if(this.isOnHold)throw new Jt(De.ERR_MEDIA_STREAM_NOT_ALLOWED_ON_HOLD)}},{kind:"get",key:"isLocalScreenShareEnabled",value:function(){return this._localStream.isScreenSharing}},{kind:"method",key:"startScreenShare",value:(I=Bn(regeneratorRuntime.mark(function x(){return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return this._validateScreenShareAvailability(),V.next=3,this._localStream.useScreenStream();case 3:case"end":return V.stop()}},x,this)})),function(){return I.apply(this,arguments)})},{kind:"method",key:"stopScreenShare",value:function(){this.isLocalScreenShareEnabled&&this._localStream.stopScreenShare()}},{kind:"method",key:"_validateCaptureAvailability",value:function(x){if(this._state.type!==ci.CONNECTED)throw new Jt(De.ERR_VIDEO_CALL_NOT_CONNECTED_YET);if(!this.isVideoCall)throw new Jt(De.ERR_CAPTURE_NOT_ALLOWED_ON_AUDIO_CALL);if(x instanceof HTMLAudioElement)throw new Jt(De.ERR_VIDEO_VIEW_NOT_READY);if(x==null||!x.srcObject)throw new Jt(De.ERR_VIDEO_VIEW_NOT_READY);if(this.isOnHold)throw new Jt(De.ERR_MEDIA_STREAM_NOT_ALLOWED_ON_HOLD)}},{kind:"method",key:"captureLocalVideoView",value:function(x){var V=this,K=new Promise(function(te,me){V._validateCaptureAvailability(V._localMediaView),te(V._captureVideoView(V._localMediaView))});return x&&wa(K)(x),K}},{kind:"method",key:"captureRemoteVideoView",value:function(x){var V=this,K=new Promise(function(te,me){V._validateCaptureAvailability(V.remoteMediaView),te(V._captureVideoView(V._remoteMediaView))});return x&&wa(K)(x),K}},{kind:"method",key:"_captureVideoView",value:function(x){try{var V,K,te=document.createElement("canvas"),me=te.getContext("2d"),_e=x;te.width=(V=_e.videoWidth)!==null&&V!==void 0?V:640,te.height=(K=_e.videoHeight)!==null&&K!==void 0?K:360,me.drawImage(_e,0,0);var ye={width:te.width,height:te.height,data:te.toDataURL("image/jpeg",1)};return te.remove(),ye}catch(Xe){throw ae.error(Xe),new Jt(De.ERR_FAILED_TO_GET_IMAGE_FROM_VIDEO_STREAM)}}},{kind:"method",key:"updateCustomItems",value:function(x,V){var K=this,te=$u(Og(x,V),2)[1];if(te)return te;var me=Kt.createUpdateCustomItems(this.callId,x),_e=this._send(me).then(function(ye){return K._setCustomItems(ye.custom_items),{customItems:ye.custom_items,affectedKeys:ye.updated}}).catch(function(ye){throw ae.error("failed to update customItems"),ye});return V&&wa(_e)(V),_e}},{kind:"method",key:"deleteCustomItems",value:function(x,V){var K=this,te=$u(kg(x,V),2)[1];if(te)return te;var me=Kt.createDeleteCustomItems(this.callId,x),_e=this._send(me).then(function(ye){return K._setCustomItems(ye.custom_items),{customItems:ye.custom_items,affectedKeys:ye.deleted}}).catch(function(ye){throw ae.error("failed to delete customItems"),ye});return V&&wa(_e)(V),_e}},{kind:"method",key:"deleteAllCustomItems",value:function(x){var V=this,K=Kt.createDeleteAllCustomItems(this.callId),te=this._send(K).then(function(me){return V._setCustomItems(me.custom_items),{customItems:me.custom_items,affectedKeys:me.deleted}}).catch(function(me){throw ae.error("failed to delete all customItems"),me});return x&&wa(te)(x),te}},{kind:"method",key:"setConnectionQualityListener",value:function(x,V){this._logManager.setConnectionQualityListener(x,V)}},{kind:"method",key:"removeConnectionQualityListener",value:function(){this._logManager.removeConnectionQualityListener()}},{kind:"method",key:"fireOnRinging",value:function(){ae.info("onRinging"),this.onRinging&&this.onRinging()}},{kind:"method",key:"fireOnEstablished",value:function(){var x;ae.info("onEstablished"),this._dispatchEvent("onEstablished",this),(x=this.onEstablished)===null||x===void 0||x.call(this,this)}},{kind:"method",key:"fireOnEnded",value:function(){var x;switch(this.endResult){case fr.NO_ANSWER:case fr.CANCELED:case fr.DECLINED:case fr.OTHER_DEVICE_ACCEPTED:case fr.COMPLETED:ae.info("onEnded");break;case fr.TIMED_OUT:ae.warning("onEnded");break;case fr.CONNECTION_LOST:case fr.DIAL_FAILED:case fr.ACCEPT_FAILED:case fr.UNKNOWN:ae.error("onEnded");break;default:ae.info("onEnded")}this._logManager.onEnded(),this._dispatchEvent("onEnded",this),(x=this.onEnded)===null||x===void 0||x.call(this,this)}},{kind:"method",key:"fireOnConnected",value:function(){var x;ae.info("onConnected"),this._dispatchEvent("onConnected",this),(x=this.onConnected)===null||x===void 0||x.call(this,this)}},{kind:"method",key:"fireOnReconnecting",value:function(){var x;ae.info("onReconnecting"),this._logManager.onReconnecting(),this._dispatchEvent("onReconnecting",this),(x=this.onReconnecting)===null||x===void 0||x.call(this,this)}},{kind:"method",key:"fireOnReconnected",value:function(){var x;ae.info("onReconnected"),this._dispatchEvent("onReconnected",this),(x=this.onReconnected)===null||x===void 0||x.call(this,this)}},{kind:"method",key:"sendDialCommand",value:function(x){var V=this,K=Kt.createDial(x,this._isVideoCall,this._customItems,this._sendBirdChatOptions,this._localConstraints,this._webhook);return this._send(K).then(function(te){V.onEvent(te)}).catch(function(te){throw V._state.dialFailed(),te})}},{kind:"method",key:"sendAcceptCommand",value:function(){var x=this,V=Kt.createAccept(this.callId,this._localConstraints);return this._send(V).then(function(K){x.onEvent(K)}).catch(function(K){throw x._state.acceptFailed(),K})}},{kind:"method",key:"sendCancelCommand",value:function(){var x=this,V=Kt.createCancel(this.callId);return this._send(V).then(function(K){x.onEvent(K)})}},{kind:"method",key:"sendDeclineCommand",value:function(){var x=this,V=Kt.createDecline(this.callId);return this._send(V).then(function(K){x.onEvent(K)})}},{kind:"method",key:"sendEndCommand",value:function(){var x=this,V=Kt.createEnd(this.callId);return this._send(V).then(function(K){x.onEvent(K)})}},{kind:"method",key:"sendTimeoutCommand",value:function(x){var V=this,K=Kt.createTimeout(this.callId,x);return this._send(K).then(function(te){V.onEvent(te)})}},{kind:"method",key:"sendConnectionLostCommand",value:function(){var x=this,V=Kt.createConnectionLost(this.callId);return this._send(V).then(function(K){x.onEvent(K)})}},{kind:"method",key:"sendNoAnswerCommand",value:function(){var x=this,V=Kt.createNoAnswer(this.callId);return this._send(V).then(function(K){x.onEvent(K)})}},{kind:"method",key:"sendAliveCommand",value:function(){var x=Kt.createAlive(this.callId);return this._send(x)}},{kind:"method",key:"sendAudioCommand",value:function(){var x=Kt.createAudio(this.callId,this._localConstraints.audio);return this._send(x)}},{kind:"method",key:"sendVideoCommand",value:function(){var x=Kt.createVideo(this.callId,this._localConstraints.video);return this._send(x)}},{kind:"method",key:"sendCallSummaryCommand",value:function(x){var V=Kt.createCallSummaryCommand(this._callId,this.myRole,x);return this._send(V)}},{kind:"method",key:"sendConnectedCommand",value:function(x,V,K){var te=Kt.createConnected(x,V,K);return this._send(te)}},{kind:"method",key:"sendRecordingCommand",value:function(x,V,K){var te=Kt.createRecording(this.callId,x,V,K);return this._send(te)}},{kind:"method",key:"sendHoldCommand",value:function(x,V){var K=this,te=Kt.createHoldCommand(this.callId,x,V);return this._send(te).then(function(me){K._holdSent(me,x)})}},{kind:"method",key:"startToSendAlive",value:function(){var x=this;this._aliveIntervalId=setInterval(function(){x.sendAliveCommand().catch(function(V){return ae.debug(V)})},3e4)}},{kind:"method",key:"stopToSendAlive",value:function(){this._aliveIntervalId&&(clearInterval(this._aliveIntervalId),delete this._aliveIntervalId)}},{kind:"method",key:"startGetWebRtcStats",value:function(){this._logManager.startGetWebRtcStats(this._rotatablePeerConnection)}},{kind:"method",key:"stopGetWebRtcStats",value:function(){this._logManager.stopGetWebRtcStats()}},{kind:"method",key:"sendConnectedInfo",value:function(){var x=this;this._pc.getCandidateInfo().then(function(V){V&&x.sendConnectedCommand(x.callId,V,x._isReconnected)})}},{kind:"method",key:"sendCallSummary",value:function(){if(this.callId&&this.endResult!==fr.OTHER_DEVICE_ACCEPTED){var x=this._logManager.getCallSummary();this.sendCallSummaryCommand(x).catch(function(V){return ae.error("failed to send call summary to server",V)})}}},{kind:"method",key:"startCallConnectionTimer",value:function(){var x=this;this._callConnectionTimer=setTimeout(function(){x._state.fireTimeout()},this._options.callConnectionTimeoutValue)}},{kind:"method",key:"stopCallConnectionTimer",value:function(){this._callConnectionTimer&&(clearTimeout(this._callConnectionTimer),delete this._callConnectionTimer)}},{kind:"method",key:"playSound",value:(v=Bn(regeneratorRuntime.mark(function x(V){return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",this._ctx.soundManager.playSound(V));case 1:case"end":return K.stop()}},x,this)})),function(x){return v.apply(this,arguments)})},{kind:"method",key:"stopSound",value:function(x){return this._ctx.soundManager.stopSound(x)}},{kind:"method",key:"stopAllSound",value:function(){return this._ctx.soundManager.stopAllSound()}},{kind:"method",key:"_receiveAudio",value:function(x){this._setRemoteAudioEnabled(x.payload.isEnabled)}},{kind:"method",key:"_receiveVideo",value:function(x){this._setRemoteVideoEnabled(x.payload.isEnabled)}},{kind:"method",key:"_receiveHold",value:function(x){x.payload.isRelayed&&(this._wasRelayed=!0),this._setHoldInfo(x.payload.holdedBy,!1,x.payload.isPeerOnHold)}},{kind:"method",key:"_receiveCustomItemsUpdate",value:function(x){var V;this._setCustomItems(x.payload.customItems),this._dispatchEvent("onCustomItemsUpdated",this,x.payload.updated),(V=this.onCustomItemsUpdated)===null||V===void 0||V.call(this,this,x.payload.updated)}},{kind:"method",key:"_receiveCustomItemsDelete",value:function(x){var V;this._setCustomItems(x.payload.customItems),this._dispatchEvent("onCustomItemsDeleted",this,x.payload.deleted),(V=this.onCustomItemsDeleted)===null||V===void 0||V.call(this,this,x.payload.deleted)}},{kind:"method",key:"_receiveRecording",value:function(x){this._setRemoteRecordingStatus(x.payload.recordingStatus)}},{kind:"method",key:"_receiveTurnChanged",value:function(x){if(this._isTurnChangedSupported){var V=x.payload,K=V.turnCredential,te=V.eventId;this.createPeerConnection(te,K)}}},{kind:"method",key:"_registerPCListeners",value:function(){var x=this,V=this._pc;V.on("connected",function(){x._onPeerConnectionConnected()}),V.on("reconnecting",function(){x._onPeerConnectionReconnecting()}),V.on("remoteStream",function(){x._onRemoteStream()})}},{kind:"method",key:"createPeerConnection",value:function(x,V){var K=new O4(this._ctx,x,this.callId),te=this._rotatablePeerConnection.createPeerConnection(x,K,this._localStream,this._isCaller,x?V:this._initTurnCredential);return this.isCaller&&te.createOffer(),te}},{kind:"method",key:"_onPeerConnectionConnected",value:function(){this._state.pcConnected()}},{kind:"method",key:"_onPeerConnectionReconnecting",value:function(){this._state.pcReconnecting()}},{kind:"method",key:"_onPeerConnectionInitialized",value:function(){this._registerPCListeners(),this._onRemoteStream()}},{kind:"method",key:"_onPeerConnectionReplaced",value:function(){this._onPeerConnectionInitialized(),this._onPeerConnectionConnected()}},{kind:"method",key:"_receiveSnapshot",value:function(x){ae.verbose("snapshot is received");var V=x.payload,K=V.audioEnabled,te=V.videoEnabled,me=V.customItems,_e=V.recording;if(typeof K=="boolean"&&this._setRemoteAudioEnabled(K),typeof te=="boolean"&&this._setRemoteVideoEnabled(te),_e?this._setRemoteRecordingStatus(no.RECORDING):this._setRemoteRecordingStatus(no.NONE),me){var ye,Xe,on=me,Mn=Object.keys(on),Zn=this._customItems,Xn=Object.keys(Zn),Nt=Mn.filter(function(et){return!Xn.includes(et)||on[et]!==Zn[et]}),kt=Xn.filter(function(et){return!Mn.includes(et)});this._setCustomItems(me),Nt.length>0&&(this._dispatchEvent("onCustomItemsUpdated",this,Nt),(ye=this.onCustomItemsUpdated)===null||ye===void 0||ye.call(this,this,Nt)),kt.length>0&&(this._dispatchEvent("onCustomItemsDeleted",this,kt),(Xe=this.onCustomItemsDeleted)===null||Xe===void 0||Xe.call(this,this,kt))}}},{kind:"method",key:"_passToPeerConnection",value:function(x){switch(x.type){case He.CANDIDATE:var V=_p.createCandidate(x.payload.peerConnectionId,x.payload.candidate);this._rotatablePeerConnection.onEvent(V);break;case He.OFFER:var K=_p.createOffer(x.payload.peerConnectionId,x.payload.sdp);this._rotatablePeerConnection.onEvent(K);break;case He.ANSWER:var te=_p.createAnswer(x.payload.peerConnectionId,x.payload.sdp);this._rotatablePeerConnection.onEvent(te)}}},{kind:"method",key:"onEvent",value:function(x){switch(ae.verbose("'onEvent' on ".concat(x.constructor.name)),x.type){case He.DIAL:this._dialed(x);break;case He.DIAL_ACK:this._dialSent(x);break;case He.DIAL_RCV:this._calleeDialReceived(x);break;case He.ACCEPT:this._receiveAccept(x);break;case He.ACCEPT_ACK:this._state.acceptSent(x);break;case He.OTHER_DEVICE_ACCEPTED:this._state.receiveAccepted();break;case He.CANCEL:this._canceled(x);break;case He.DECLINE:case He.END:case He.TIME_OUT:case He.NO_ANSWER:case He.CONNECTION_LOST:case He.UNKNOWN_END:this._state.receiveEnd(x);break;case He.CANCEL_ACK:case He.DECLINE_ACK:case He.END_ACK:case He.TIMEOUT_ACK:case He.NO_ANSWER_ACK:case He.CONNECTION_LOST_ACK:case He.UNKNOWN_END_ACK:this._state.endSent(x);break;case He.REMOVE_CANDIDATES:break;case He.AUDIO:this._receiveAudio(x);break;case He.VIDEO:this._receiveVideo(x);break;case He.HOLD:this._receiveHold(x);break;case He.CUSTOM_ITEMS_UPDATE:this._receiveCustomItemsUpdate(x);break;case He.CUSTOM_ITEMS_DELETE:this._receiveCustomItemsDelete(x);break;case He.RECORDING:this._receiveRecording(x);break;case He.TURN_CHANGED:this._receiveTurnChanged(x);break;case He.SNAPSHOT:this._receiveSnapshot(x);break;case He.CANDIDATE:this._passToPeerConnection(x);break;case He.OFFER:this._passToPeerConnection(x),this._state.type==="accepting"&&this._state.receiveOffer(),this._startedAt||this.startDuration();break;case He.ANSWER:this._passToPeerConnection(x),this._startedAt||this.startDuration();break;default:ae.error(new Error("unhandled call event ".concat(x.type)))}}},{kind:"method",key:"_onAudioOutputChanged",value:(m=Bn(regeneratorRuntime.mark(function x(){var V,K,te,me,_e;return regeneratorRuntime.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return _e=this._ctx.deviceManager.getCurrentAudioOutputDevice(),ye.next=3,(V=this._localMediaView)===null||V===void 0||(K=V.setSinkId)===null||K===void 0?void 0:K.call(V,_e.deviceId);case 3:return ye.next=5,(te=this._remoteMediaView)===null||te===void 0||(me=te.setSinkId)===null||me===void 0?void 0:me.call(te,_e.deviceId);case 5:case"end":return ye.stop()}},x,this)})),function(){return m.apply(this,arguments)})},{kind:"method",key:"_onLocalStream",value:function(){var x=this._getLocalStream();this._localMediaView&&(this._localMediaView.srcObject=x);var V,K=Hr(x.getTracks());try{for(K.s();!(V=K.n()).done;){var te,me=V.value;me.enabled=(te=this._isMediaEnabled)===null||te===void 0?void 0:te.call(this,me.kind)}}catch(_e){K.e(_e)}finally{K.f()}}},{kind:"method",key:"_onRemoteStream",value:function(){this._remoteMediaView&&(this._remoteMediaView.srcObject=this._pc.remoteStream)}},{kind:"method",key:"calcCallSetupTime",value:function(){this._logManager.summary.onConnected()}},{kind:"method",key:"setIsReconnected",value:function(x){this._isReconnected=x,this._logManager.summary.increaseReconnectedCount()}},{kind:"method",key:"_isMediaEnabled",value:function(x){switch(x){case"audio":return this._localConstraints.audio&&!this.isOnHold;case"video":return this._localConstraints.video&&!this.isOnHold;default:return ae.error(new Error("unrecognized media type ".concat(x))),!1}}},{kind:"method",key:"_updateLocalMediaView",value:(_=Bn(regeneratorRuntime.mark(function x(V){return regeneratorRuntime.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(this._localMediaView!==V){K.next=2;break}return K.abrupt("return");case 2:if(this._localMediaView&&(this._localMediaView.srcObject=null),V){K.next=6;break}return this._localMediaView=null,K.abrupt("return");case 6:return K.next=8,this._updateMediaView(V,this._getLocalStream());case 8:this._localMediaView=K.sent;case 9:case"end":return K.stop()}},x,this)})),function(x){return _.apply(this,arguments)})},{kind:"method",key:"_updateRemoteMediaView",value:(f=Bn(regeneratorRuntime.mark(function x(V){var K;return regeneratorRuntime.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(this._remoteMediaView!==V){te.next=2;break}return te.abrupt("return");case 2:if(this._remoteMediaView&&(this._remoteMediaView.srcObject=null),V){te.next=6;break}return this._remoteMediaView=null,te.abrupt("return");case 6:return te.next=8,this._updateMediaView(V,(K=this._pc)===null||K===void 0?void 0:K.remoteStream);case 8:this._remoteMediaView=te.sent;case 9:case"end":return te.stop()}},x,this)})),function(x){return f.apply(this,arguments)})},{kind:"method",key:"_updateMediaView",value:(l=Bn(regeneratorRuntime.mark(function x(V,K){var te,me;return regeneratorRuntime.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(!(te=this._ctx.deviceManager.getCurrentAudioOutputDevice())){_e.next=4;break}return _e.next=4,(me=V.setSinkId)===null||me===void 0?void 0:me.call(V,te.deviceId);case 4:return K&&(V.srcObject=K),_e.abrupt("return",V);case 6:case"end":return _e.stop()}},x,this)})),function(x,V){return l.apply(this,arguments)})},{kind:"method",key:"_getLocalStream",value:function(){return this._localStream.localStream}},{kind:"method",key:"_releaseLocalStream",value:function(){this._localStream&&(this._localStream.removeAllEventListeners(),this._localStream.release())}}]}},U6),D4=function(){function o(c){var l=c.ringingTimeout,f=c.callConnectionTimeout,_=c.statsInterval;ie(this,o),this._ringingTimeout=l,this._callConnectionTimeout=f,this._statsInterval=_}return se(o,[{key:"ringingTimeoutValue",get:function(){return this._ringingTimeout}},{key:"callConnectionTimeoutValue",get:function(){return this._callConnectionTimeout}},{key:"statsIntervalValue",get:function(){return this._statsInterval}}]),o}(),L4=function(){function o(c){ie(this,o),this._ctx=c,this.options={ringingTimeout:6e4,callConnectionTimeout:6e4,statsInterval:3e3}}return se(o,[{key:"createDirectCall",value:function(){return new k4(this._ctx,new D4(this.options))}},{key:"setRingingTimeout",value:function(c){typeof c=="number"&&c>0&&(this.options.ringingTimeout=1e3*c)}},{key:"setStatsInterval",value:function(c){if(typeof c=="number"){var l=c;l<1&&(l=1),l>60&&(l=60),this.options.statsInterval=1e3*l}}},{key:"setCallConnectionTimeout",value:function(c){typeof c=="number"&&c>0&&(this.options.callConnectionTimeout=1e3*c)}}]),o}(),x4=function o(c){var l;ie(this,o),this.audioEnabled=c.is_audio_enabled,this.videoEnabled=c.is_video_enabled,this.customItems=(l=c.custom_items)===null||l===void 0?void 0:l.custom_items},U4=function(){function o(c){ie(this,o),this.callId=c.call_id,this.callType=c.call_type,this.userRole=c.user_role,this.callerClientId=c.caller_client_id,this.calleeClientId=c.callee_client_id,this.signalSeq=c.signal_seq.map(Kt.parse).filter(function(l){return!!l}),this.signalSnapshot=new x4(c.signal_snapshot)}return se(o,[{key:"getAcceptResponse",value:function(){return this.signalSeq.find(function(c){return c.type===He.ACCEPT_ACK})}},{key:"getDeclineResponse",value:function(){return this.signalSeq.find(function(c){return c.type===He.DECLINE_ACK})}},{key:"commands",get:function(){return this.signalSeq}},{key:"snapshot",get:function(){return this.signalSnapshot}}]),o}(),P4=function(){function o(c){ie(this,o),this._ctx=c,this._callFactory=new L4(c),this._calls=new Map,this.dialListeners=new Map}return se(o,[{key:"setRingingTimeout",value:function(c){this._callFactory.setRingingTimeout(c)}},{key:"setStatsInterval",value:function(c){this._callFactory.setStatsInterval(c)}},{key:"setCallConnectionTimeout",value:function(c){this._callFactory.setCallConnectionTimeout(c)}},{key:"getCall",value:function(c){return this._calls.get(c)}},{key:"_hasCall",value:function(c){return this._calls.has(c)}},{key:"getOngoingCalls",value:function(){return Ed(this._calls.values())}},{key:"getOngoingCallCount",value:function(){return Ed(this._calls.values()).reduce(function(c,l){return l.isOngoing?c+1:c},0)}},{key:"getActiveCallCount",value:function(){return Ed(this._calls.values()).reduce(function(c,l){return l.isOngoing&&!l.isOnHold?c+1:c},0)}},{key:"dial",value:function(c,l){var f=this,_=this._callFactory.createDirectCall();c.holdActiveCall?this.holdExcept(_):this.endExcept(_);var m=_.dial(c).then(function(){return f._register(_.callId,_),_}).catch(function(v){throw ae.error(v),v});return l&&wa(m)(l),_}},{key:"holdExcept",value:function(c){var l,f=Hr(this._calls.values());try{for(f.s();!(l=f.n()).done;){var _=l.value;_.callId===c.callId||_.isOnHold||_.hold()}}catch(m){f.e(m)}finally{f.f()}}},{key:"endExcept",value:function(c){var l,f=Hr(this._calls.values());try{for(f.s();!(l=f.n()).done;){var _=l.value;_.callId!==c.callId&&_.end()}}catch(m){f.e(m)}finally{f.f()}}},{key:"onEvent",value:function(c){switch(c.type){case He.DIAL:this._onCallDialed(c);break;case He.CANCEL:this._hasCall(c.getCallId())?this._passToCall(c):this._onCallCanceled(c);break;case Up.CONNECTED:this._requestCommandLists();break;default:this._passToCall(c)}}},{key:"addListener",value:function(c,l){this.dialListeners.set(c,l)}},{key:"removeListener",value:function(c){this.dialListeners.delete(c)}},{key:"removeAllListeners",value:function(){this.dialListeners.clear()}},{key:"clear",value:function(){var c,l=Hr(this._calls.values());try{for(l.s();!(c=l.n()).done;){var f=c.value;try{f.end()}catch{ae.error("failed to clear call.")}}}catch(_){l.e(_)}finally{l.f()}this._calls.clear()}},{key:"_register",value:function(c,l){if(!c)throw new Error("call id is not set in call");if(!l)throw new Error("call is null");this._calls.set(c,l)}},{key:"_sendDialReceiveCommand",value:function(c){var l=Kt.createDialReceive(c.getCallId(),c.deliveryInfo,c.receivedType,c.payload.shortLivedToken);return this._ctx.sender.send(l).catch(function(){})}},{key:"_onCallDialed",value:function(c){var l=this,f=this._callFactory.createDirectCall();this._sendDialReceiveCommand(c),this._register(c.getCallId(),f),f.onRinging=function(){return l._onCallRinging(f)},this._passToCall(c)}},{key:"_onCallCanceled",value:function(c){var l=this,f=this._callFactory.createDirectCall();this._register(c.getCallId(),f),f.onRinging=function(){return l._onCallRinging(f)},this._passToCall(c)}},{key:"_onCallRinging",value:function(c){var l,f=Hr(this.dialListeners.values());try{for(f.s();!(l=f.n()).done;){var _=l.value;_.onRinging&&_.onRinging(c)}}catch(m){f.e(m)}finally{f.f()}}},{key:"_requestCommandLists",value:function(){var c=this;ae.verbose("request command list");var l=Array.from(this._calls.keys()).filter(function(_){return!c._calls.get(_).isEnded}),f=Kt.createCommandList(l);this._retrieveCommands(f)}},{key:"_retrieveCommands",value:function(c){var l=this;return this._ctx.sender.send(c).then(function(f){ae.verbose("commandLists is received.");var _=f.call_signal.map(function(m){return new U4(m)});l._ctx.sender.processCommandLists(_)}).catch(function(f){ae.debug("failed to get commandLists",f)})}},{key:"_passToCall",value:function(c){this._hasCall(c.getCallId())?this._calls.get(c.getCallId()).onEvent(c):ae.debug("received command ".concat(c.type," for non-existing call ").concat(c.getCallId()))}}]),o}(),Ki=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||Ki!==void 0&&Ki,Ca={searchParams:"URLSearchParams"in Ki,iterable:"Symbol"in Ki&&"iterator"in Symbol,blob:"FileReader"in Ki&&"Blob"in Ki&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Ki,arrayBuffer:"ArrayBuffer"in Ki};if(Ca.arrayBuffer)var F4=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],H4=ArrayBuffer.isView||function(o){return o&&F4.indexOf(Object.prototype.toString.call(o))>-1};function bf(o){if(typeof o!="string"&&(o=String(o)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(o)||o==="")throw new TypeError("Invalid character in header field name");return o.toLowerCase()}function Vv(o){return typeof o!="string"&&(o=String(o)),o}function jv(o){var c={next:function(){var l=o.shift();return{done:l===void 0,value:l}}};return Ca.iterable&&(c[Symbol.iterator]=function(){return c}),c}function mi(o){this.map={},o instanceof mi?o.forEach(function(c,l){this.append(l,c)},this):Array.isArray(o)?o.forEach(function(c){this.append(c[0],c[1])},this):o&&Object.getOwnPropertyNames(o).forEach(function(c){this.append(c,o[c])},this)}function qv(o){if(o.bodyUsed)return Promise.reject(new TypeError("Already read"));o.bodyUsed=!0}function CN(o){return new Promise(function(c,l){o.onload=function(){c(o.result)},o.onerror=function(){l(o.error)}})}function B4(o){var c=new FileReader,l=CN(c);return c.readAsArrayBuffer(o),l}function IN(o){if(o.slice)return o.slice(0);var c=new Uint8Array(o.byteLength);return c.set(new Uint8Array(o)),c.buffer}function TN(){return this.bodyUsed=!1,this._initBody=function(o){var c;this.bodyUsed=this.bodyUsed,this._bodyInit=o,o?typeof o=="string"?this._bodyText=o:Ca.blob&&Blob.prototype.isPrototypeOf(o)?this._bodyBlob=o:Ca.formData&&FormData.prototype.isPrototypeOf(o)?this._bodyFormData=o:Ca.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)?this._bodyText=o.toString():Ca.arrayBuffer&&Ca.blob&&(c=o)&&DataView.prototype.isPrototypeOf(c)?(this._bodyArrayBuffer=IN(o.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):Ca.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(o)||H4(o))?this._bodyArrayBuffer=IN(o):this._bodyText=o=Object.prototype.toString.call(o):this._bodyText="",this.headers.get("content-type")||(typeof o=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Ca.searchParams&&URLSearchParams.prototype.isPrototypeOf(o)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Ca.blob&&(this.blob=function(){var o=qv(this);if(o)return o;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var o=qv(this);return o||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(B4)}),this.text=function(){var o=qv(this);if(o)return o;if(this._bodyBlob)return function(c){var l=new FileReader,f=CN(l);return l.readAsText(c),f}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(c){for(var l=new Uint8Array(c),f=new Array(l.length),_=0;_<l.length;_++)f[_]=String.fromCharCode(l[_]);return f.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Ca.formData&&(this.formData=function(){return this.text().then(V4)}),this.json=function(){return this.text().then(JSON.parse)},this}mi.prototype.append=function(o,c){o=bf(o),c=Vv(c);var l=this.map[o];this.map[o]=l?l+", "+c:c},mi.prototype.delete=function(o){delete this.map[bf(o)]},mi.prototype.get=function(o){return o=bf(o),this.has(o)?this.map[o]:null},mi.prototype.has=function(o){return this.map.hasOwnProperty(bf(o))},mi.prototype.set=function(o,c){this.map[bf(o)]=Vv(c)},mi.prototype.forEach=function(o,c){for(var l in this.map)this.map.hasOwnProperty(l)&&o.call(c,this.map[l],l,this)},mi.prototype.keys=function(){var o=[];return this.forEach(function(c,l){o.push(l)}),jv(o)},mi.prototype.values=function(){var o=[];return this.forEach(function(c){o.push(c)}),jv(o)},mi.prototype.entries=function(){var o=[];return this.forEach(function(c,l){o.push([l,c])}),jv(o)},Ca.iterable&&(mi.prototype[Symbol.iterator]=mi.prototype.entries);var G4=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function gl(o,c){if(!(this instanceof gl))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var l,f,_=(c=c||{}).body;if(o instanceof gl){if(o.bodyUsed)throw new TypeError("Already read");this.url=o.url,this.credentials=o.credentials,c.headers||(this.headers=new mi(o.headers)),this.method=o.method,this.mode=o.mode,this.signal=o.signal,_||o._bodyInit==null||(_=o._bodyInit,o.bodyUsed=!0)}else this.url=String(o);if(this.credentials=c.credentials||this.credentials||"same-origin",!c.headers&&this.headers||(this.headers=new mi(c.headers)),this.method=(l=c.method||this.method||"GET",f=l.toUpperCase(),G4.indexOf(f)>-1?f:l),this.mode=c.mode||this.mode||null,this.signal=c.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&_)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(_),!(this.method!=="GET"&&this.method!=="HEAD"||c.cache!=="no-store"&&c.cache!=="no-cache")){var m=/([?&])_=[^&]*/;m.test(this.url)?this.url=this.url.replace(m,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function V4(o){var c=new FormData;return o.trim().split("&").forEach(function(l){if(l){var f=l.split("="),_=f.shift().replace(/\+/g," "),m=f.join("=").replace(/\+/g," ");c.append(decodeURIComponent(_),decodeURIComponent(m))}}),c}function js(o,c){if(!(this instanceof js))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');c||(c={}),this.type="default",this.status=c.status===void 0?200:c.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in c?c.statusText:"",this.headers=new mi(c.headers),this.url=c.url||"",this._initBody(o)}gl.prototype.clone=function(){return new gl(this,{body:this._bodyInit})},TN.call(gl.prototype),TN.call(js.prototype),js.prototype.clone=function(){return new js(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new mi(this.headers),url:this.url})},js.error=function(){var o=new js(null,{status:0,statusText:""});return o.type="error",o};var j4=[301,302,303,307,308];js.redirect=function(o,c){if(j4.indexOf(c)===-1)throw new RangeError("Invalid status code");return new js(null,{status:c,headers:{location:o}})};var zd=Ki.DOMException;try{new zd}catch{(zd=function(c,l){this.message=c,this.name=l;var f=Error(c);this.stack=f.stack}).prototype=Object.create(Error.prototype),zd.prototype.constructor=zd}function zv(o,c){return new Promise(function(l,f){var _=new gl(o,c);if(_.signal&&_.signal.aborted)return f(new zd("Aborted","AbortError"));var m=new XMLHttpRequest;function v(){m.abort()}m.onload=function(){var I,S,w={status:m.status,statusText:m.statusText,headers:(I=m.getAllResponseHeaders()||"",S=new mi,I.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(H){return H.indexOf(`
`)===0?H.substr(1,H.length):H}).forEach(function(H){var x=H.split(":"),V=x.shift().trim();if(V){var K=x.join(":").trim();S.append(V,K)}}),S)};w.url="responseURL"in m?m.responseURL:w.headers.get("X-Request-URL");var G="response"in m?m.response:m.responseText;setTimeout(function(){l(new js(G,w))},0)},m.onerror=function(){setTimeout(function(){f(new TypeError("Network request failed"))},0)},m.ontimeout=function(){setTimeout(function(){f(new TypeError("Network request failed"))},0)},m.onabort=function(){setTimeout(function(){f(new zd("Aborted","AbortError"))},0)},m.open(_.method,function(I){try{return I===""&&Ki.location.href?Ki.location.href:I}catch{return I}}(_.url),!0),_.credentials==="include"?m.withCredentials=!0:_.credentials==="omit"&&(m.withCredentials=!1),"responseType"in m&&(Ca.blob?m.responseType="blob":Ca.arrayBuffer&&_.headers.get("Content-Type")&&_.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(m.responseType="arraybuffer")),!c||typeof c.headers!="object"||c.headers instanceof mi?_.headers.forEach(function(I,S){m.setRequestHeader(S,I)}):Object.getOwnPropertyNames(c.headers).forEach(function(I){m.setRequestHeader(I,Vv(c.headers[I]))}),_.signal&&(_.signal.addEventListener("abort",v),m.onreadystatechange=function(){m.readyState===4&&_.signal.removeEventListener("abort",v)}),m.send(_._bodyInit===void 0?null:_._bodyInit)})}zv.polyfill=!0,Ki.fetch||(Ki.fetch=zv,Ki.Headers=mi,Ki.Request=gl,Ki.Response=js);var q4=function(){var o,c;return(o=window)!==null&&o!==void 0&&o.fetch?(c=window).fetch.apply(c,arguments):zv.apply(void 0,arguments)},SN=function(){function o(){ie(this,o)}return se(o,null,[{key:"getOsVersion",value:function(){return typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"undefined"}}]),o}(),NN=function(o){ce(l,o);var c=fe(l);function l(){return ie(this,l),c.apply(this,arguments)}return l}(ap),z4=function(){function o(l){var f;ie(this,o),this._ctx=l,this._fetch=q4,this._sessionKey=null,this._hostUrl=(f=this._ctx.apiHost)!==null&&f!==void 0?f:"https://api-IDENTIFIER.calls.sendbird.com".replace("IDENTIFIER",this._ctx.appId)}var c;return se(o,[{key:"setSessionKey",value:function(l){this._sessionKey=l}},{key:"clearSessionKey",value:function(){this._sessionKey=null}},{key:"send",value:(c=Bn(regeneratorRuntime.mark(function l(f){var _,m,v,I,S,w,G;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(f.getApiOption){H.next=2;break}throw new Error("invalid api request ".concat(JSON.stringify(f)));case 2:if(!(_=f.getApiOption()).auth||this._sessionKey){H.next=5;break}throw new Error("tried to call private api without auth");case 5:return(m=Fr({"Content-Type":"application/json"},_.headers)).SendBird="JS,".concat(SN.getOsVersion(),",").concat(Zg),m["SBCall-Client-Id"]=this._ctx.clientId,this._sessionKey&&(m["SBCall-Session-Token"]=this._sessionKey),H.next=11,this._fetch("".concat(this._getHost()).concat(_.path),{method:_.method,body:JSON.stringify(_.body),headers:m});case 11:return v=H.sent,H.next=14,v.text();case 14:I=H.sent,S=null,H.prev=16,S=JSON.parse(I),H.next=23;break;case 20:throw H.prev=20,H.t0=H.catch(16),new Jt(De.ERR_MALFORMED_DATA);case 23:if(v.ok){H.next=33;break}if(!S.error){H.next=28;break}throw new NN(S.code,{message:S.message});case 28:if(v.status!==500){H.next=30;break}throw new Jt(De.INTERNAL_SERVER_ERROR);case 30:if(!(v.status>=300&&v.status<400)){H.next=32;break}throw new Jt(De.ERR_MALFORMED_DATA);case 32:throw new Jt(De.ERR_REQUEST_FAILED);case 33:if(!(f instanceof jr)){H.next=36;break}return w=qr.parseResponse(f.type,S),H.abrupt("return",w);case 36:if(!S.cmd){H.next=39;break}return G=Kt.parse(S),H.abrupt("return",G);case 39:return H.abrupt("return",S);case 40:case"end":return H.stop()}},l,this,[[16,20]])})),function(l){return c.apply(this,arguments)})},{key:"_getHost",value:function(){return this._hostUrl}}]),o}(),K4=function(){function o(){ie(this,o)}return se(o,[{key:"parseToJson",value:function(c){try{return JSON.parse(c)}catch(l){return ae.error("failed to parse JSON message",l),{}}}},{key:"validate",value:function(c){var l=c.cmd,f=c.request_id,_=c.call_type;return!!(f||l||_)}},{key:"parseCommand",value:function(c){return c.error?{isValid:!0,error:{requestId:c.request_id,message:c.message,code:c.code}}:c.call_type==="room"?{isValid:!0,command:qr.parse(c)}:{isValid:!0,command:Kt.parse(c)}}},{key:"parse",value:function(c){var l=this.parseToJson(c);return this.validate(l)?this.parseCommand(l):{isValid:!1}}}]),o}(),W4=function(){function o(c){var l;ie(this,o),this._ctx=c,this._ws=null,this._retryTimer=null,this._closed=!0,this._sessionKey=null,this._requestMap=new $I(this._getTimeoutTime()),this._messageParser=new K4,this._hostUrl=(l=this._ctx.websocketHost)!==null&&l!==void 0?l:"wss://ws-IDENTIFIER.calls.sendbird.com".replace("IDENTIFIER",this._ctx.appId)}return se(o,[{key:"connect",value:function(){var c=this;return new Promise(function(l,f){var _;c._sessionKey||f(new Error("tried to connect to websocket server without auth")),((_=c._ws)===null||_===void 0?void 0:_.readyState)===0&&f(new Error("websocket is reconnecting already")),c._disconnect(),c._ws=c._createWebSocket(),c._closed=!1,c._ws.onopen=function(){c._onOpen(),l(null)},c._ws.onmessage=function(m){var v=c._messageParser.parse(m.data),I=v.isValid,S=v.error,w=v.command;I&&(S?c._processError(S):c.processCommand(w))},c._ws.onerror=function(m){return c._onError(m)},c._ws.onclose=function(){c._onClose(),f(new Jt(De.ERR_WEBSOCKET_CONNECTION_FAILED))}})}},{key:"_processError",value:function(c){var l=c.requestId,f=c.code,_=c.message,m=this._requestMap.unregister(l);m&&(ae.debug(l,c.message),m.reject(new NN(f,{message:_})))}},{key:"processCommand",value:function(c){var l=this._ctx.router;if(c instanceof Li)l.routeDirectCallPeerCommand(c,Rd.WS);else if(c instanceof Md){var f=this._requestMap.unregister(c.requestId);if(!f)return;l.routeDirectCallResponseCommand(c,f)}else c instanceof cT?l.routeDirectCallServerCommand(c,Rd.WS):c instanceof OS?l.routeLogServerCommand(c):c instanceof DI?l.routeServerCommand(c):c instanceof kI&&l.routePeerCommand(c)}},{key:"setSessionKey",value:function(c){this._sessionKey=c}},{key:"clearSessionKey",value:function(){this._disconnect(),this._sessionKey=null}},{key:"_disconnect",value:function(){this._ws&&(this._closed=!0,this._removeRetryTimer(),this._ws.onopen=null,this._ws.onmessage=null,this._ws.onerror=null,this._ws.onclose=null,this._ws.close(),this._requestMap.rejectAll(new Jt(De.ERR_REQUEST_FAILED_DUE_TO_WEBSOCKET_CONNECTION_LOST)),this._ws=null)}},{key:"send",value:function(c){var l=c.requireResponse()?this._requestMap.register(c.requestId).promise:Promise.resolve(),f=c.serialize();return this._ws.send("".concat(f,`
`)),l}},{key:"_onOpen",value:function(){this._ctx.router.routeWebSocketInternalCommand(Kt.createWebSocketConnectedCommand())}},{key:"_onError",value:function(c){ae.error(c)}},{key:"_onClose",value:function(){this.startToReconnect()}},{key:"_createWebSocket",value:function(){var c="/?sbcall_session_token=".concat(encodeURIComponent(this._sessionKey),"&sbcall_client_id=").concat(encodeURIComponent(this._ctx.clientId),"&sendbird=").concat(encodeURIComponent(this._getVersion()));return new WebSocket(this._getHost()+c)}},{key:"_getVersion",value:function(){return"JS,".concat(SN.getOsVersion(),",").concat(Zg)}},{key:"_getHost",value:function(){return this._hostUrl}},{key:"startToReconnect",value:function(){this._closed||this._retryTimer||(this._retryTimer=setTimeout(this._reconnect.bind(this),this._getRetryTime()))}},{key:"_reconnect",value:function(){var c=this;this._removeRetryTimer(),Qc(new gp(5e3,1e3,void 0),function(){return c.connect()},{onError:function(l){ae.error("Fail reconnect WebSocket ErrorCode = ".concat(l.code))}})}},{key:"_removeRetryTimer",value:function(){this._retryTimer&&(clearTimeout(this._retryTimer),this._retryTimer=null)}},{key:"_getTimeoutTime",value:function(){return 6e4}},{key:"_getRetryTime",value:function(){return 2e3}},{key:"isConnected",get:function(){return!!this._ws&&this._ws.readyState===1}}]),o}(),$4=function(){function o(f){ie(this,o),this._ctx=f,this.wsClient=new W4(f),this.apiClient=new z4(f)}var c,l;return se(o,[{key:"connectWs",value:function(){return this.wsClient.connect()}},{key:"reconnectWs",value:function(){return this.wsClient.startToReconnect()}},{key:"sendAPI",value:function(f){return this.apiClient.send(f)}},{key:"sendWs",value:function(f){return this.wsClient.send(f)}},{key:"send",value:(l=Bn(regeneratorRuntime.mark(function f(_){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(_ instanceof _i)){m.next=11;break}if(_.sendStrategy!==nl.API){m.next=3;break}return m.abrupt("return",this.sendAPI(_));case 3:if(_.sendStrategy!==nl.WS){m.next=7;break}if(!this.wsClient.isConnected){m.next=6;break}return m.abrupt("return",this.sendWs(_));case 6:throw new Jt(De.ERR_WEBSOCKET_CONNECTION_NOT_OPENED);case 7:if(_.sendStrategy!==nl.BOTH){m.next=11;break}if(!this.wsClient.isConnected){m.next=10;break}return m.abrupt("return",this.sendWs(_));case 10:case 11:return m.abrupt("return",this.sendAPI(_));case 12:case"end":return m.stop()}},f,this)})),function(f){return l.apply(this,arguments)})},{key:"sendWithRetry",value:(c=Bn(regeneratorRuntime.mark(function f(_){var m,v,I,S,w,G,H=this,x=arguments;return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return m=x.length>1&&x[1]!==void 0?x[1]:new KI,v=x.length>2&&x[2]!==void 0?x[2]:{count:0,deferred:new mp},I=v.deferred,S=v.count,V.prev=3,V.next=6,this.send(_);case 6:w=V.sent,I.resolve(w),V.next=14;break;case 10:V.prev=10,V.t0=V.catch(3),(G=m.calcTimeout(S))>0?setTimeout(function(){H.sendWithRetry(_,m,{count:S+1,deferred:I})},G):I.reject(V.t0);case 14:return V.abrupt("return",I.promise);case 15:case"end":return V.stop()}},f,this,[[3,10]])})),function(f){return c.apply(this,arguments)})},{key:"_setSessionKey",value:function(f){this.apiClient.setSessionKey(f),this.wsClient.setSessionKey(f)}},{key:"authenticate",value:function(f){var _=this,m=f.userId,v=f.accessToken,I=Kt.createAuthRequest(this._ctx.appId,m,v);return this.send(I).then(function(S){_._setSessionKey(S.sbcall_session_token);var w=Ea(S.user);return{user:new ya(w),statsInterval:S.stats_interval}}).catch(function(S){throw ae.error("failed to authenticate user ".concat(m)),S})}},{key:"deauthenticate",value:function(){this.apiClient.clearSessionKey(),this.wsClient.clearSessionKey()}},{key:"processCommandLists",value:function(f){var _,m=Hr(f);try{for(m.s();!(_=m.n()).done;){var v=_.value;if(v.userRole!==Eu.CALLER||this._ctx.clientId===v.callerClientId){if(v.userRole===Eu.CALLEE&&this._ctx.clientId!==v.calleeClientId){var I=v.getAcceptResponse();if(I){var S=I.payload.callId,w=Kt.createAccepted(S);this._ctx.router.routeDirectCallPeerCommand(w,Rd.WS);continue}var G=v.getDeclineResponse();if(G){var H=G.payload,x=H.callId,V=H.endedCall,K=Kt.createDeclined(x,V);this._ctx.router.routeDirectCallInternalCommand(K)}}var te=v.commands,me=v.snapshot;ae.verbose("process commandList. length: ".concat(te.length));var _e,ye=Hr(te);try{for(ye.s();!(_e=ye.n()).done;){var Xe=_e.value;this.wsClient.processCommand(Xe)}}catch(Mn){ye.e(Mn)}finally{ye.f()}var on=Kt.createSnapshot(v.callId,me);this._ctx.router.routeDirectCallInternalCommand(on)}}}catch(Mn){m.e(Mn)}finally{m.f()}}}]),o}(),Y4=function(o){ce(l,o);var c=fe(l);function l(f,_){var m;return ie(this,l),(m=c.call(this))._recordId=dp(),m._blobs=[],m._mediaRecorder=new MediaRecorder(f,_),m._mediaRecorder.ondataavailable=function(v){v.data&&v.data.size>0&&m._blobs.push(v.data)},m._mediaRecorder.onstart=function(){return m._onStart()},m._mediaRecorder.onstop=function(){return m._onStop()},m._mediaRecorder.onpause=function(){return m._onPause()},m._mediaRecorder.onresume=function(){return m._onResume()},m._mediaRecorder.onerror=function(){return m._onError()},m}return se(l,[{key:"startRecording",value:function(){try{this._mediaRecorder.start()}catch(f){return ae.error("start recording failed with error : ",f),!1}return!0}},{key:"stopRecording",value:function(){try{this._mediaRecorder.stop()}catch(f){return ae.error("stop recording failed with error : ",f),!1}return!0}},{key:"_onStart",value:function(){this._dispatchEvent("start")}},{key:"_onStop",value:function(){this._dispatchEvent("stop"),this._onRecordingSucceeded(new Blob(this._blobs))}},{key:"_onPause",value:function(){this._dispatchEvent("pause")}},{key:"_onResume",value:function(){this._dispatchEvent("resume")}},{key:"_onError",value:function(){this._dispatchEvent("error"),this._onRecordingFailed(new Jt(De.ERR_FAILED_TO_STOP_RECORDING))}},{key:"_onRecordingSucceeded",value:function(f){this._dispatchEvent("succeeded",f)}},{key:"_onRecordingFailed",value:function(f){this._dispatchEvent("failed",f)}},{key:"recordId",get:function(){return this._recordId}},{key:"recordingStatus",get:function(){return this._mediaRecorder.state==="recording"?no.RECORDING:no.NONE}}]),l}(zi),Q4=function(){function o(){ie(this,o),this._listeners=new Map,this._recorders=new Map}return se(o,[{key:"getRecord",value:function(c){return this._recorders.get(c)}},{key:"addListener",value:function(c,l){this._listeners.set(c,l)}},{key:"removeListener",value:function(c){this._listeners.delete(c)}},{key:"removeAllListeners",value:function(){this._listeners.clear()}},{key:"_fireOnSucceeded",value:function(c,l){this._listeners.forEach(function(f){f.onRecordingSucceeded&&f.onRecordingSucceeded(l.callId,c,l.recordingOptions,l.fileName)})}},{key:"_fireOnFailed",value:function(c,l,f){this._listeners.forEach(function(_){_.onRecordingFailed&&_.onRecordingFailed(l.callId,c,f)})}},{key:"startRecording",value:function(c,l,f){var _=this,m=new Y4(c,l);if(m.startRecording())return this._recorders.set(m.recordId,m),m.on("succeeded",function(v){qd.downloadRecordedFile(v,f.fileName),_._fireOnSucceeded(m.recordId,f)}),m.on("failed",function(v){_._fireOnFailed(m.recordId,f,v)}),m}},{key:"stopRecording",value:function(c){if(this._recorders.size>0){var l=this._recorders.get(c);return!!l&&l.stopRecording()}return!1}},{key:"listeners",get:function(){return this._listeners}}]),o}(),Z4=function(){function o(){ie(this,o),this.processed=new Map}return se(o,[{key:"process",value:function(c){return!c.messageId||(this._isProcessed(c)?(this.processed.delete(c.messageId),!1):(this._setProcessed(c),!0))}},{key:"_isProcessed",value:function(c){return this.processed.has(c.messageId)}},{key:"_setProcessed",value:function(c){this.processed.set(c.messageId,!0)}}]),o}(),X4=function(){function o(){ie(this,o),this.lastSeqNumber=-1,this.queue=new Map}var c,l;return se(o,[{key:"insert",value:(l=Bn(regeneratorRuntime.mark(function f(_,m){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(this.lastSeqNumber>=_.sequenceNumber)){v.next=2;break}return v.abrupt("return");case 2:return this.queue.set(_.sequenceNumber,{command:_,handler:m}),ae.verbose("".concat(_.constructor.name," is inserted")),v.next=6,this.flush();case 6:case"end":return v.stop()}},f,this)})),function(f,_){return l.apply(this,arguments)})},{key:"flush",value:(c=Bn(regeneratorRuntime.mark(function f(){var _,m,v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:ae.verbose("try flushing sequence queue"),_=this.next();case 2:if(!_){S.next=10;break}return v=(m=_).command,I=m.handler,ae.verbose("flush ".concat(v.constructor.name)),S.next=7,I(v);case 7:_=this.next(),S.next=2;break;case 10:case"end":return S.stop()}},f,this)})),function(){return c.apply(this,arguments)})},{key:"next",value:function(){var f=this.lastSeqNumber+1;if(this.queue.has(f)){var _=this.queue.get(f),m=_.command,v=_.handler;return this.queue.delete(f),this.lastSeqNumber=f,{command:m,handler:v}}return null}}]),o}(),J4=function(){function o(){ie(this,o),this.sequences=new Map,this.lock=new OI}var c;return se(o,[{key:"insert",value:(c=Bn(regeneratorRuntime.mark(function l(f,_){var m,v,I;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.lock.acquire();case 2:if(S.prev=2,ae.verbose("try to insert in SequenceManager with ".concat(f.constructor.name)),m=f.getCallId(),f.isSequential()&&m){S.next=10;break}return ae.verbose("not sequential; immediately flush ".concat(f.constructor.name)),this.lock.release(),_(f),S.abrupt("return");case 10:if(!this.sequences.has(m)){S.next=16;break}return v=this.sequences.get(m),S.next=14,v.insert(f,_);case 14:S.next=20;break;case 16:return I=new X4,this.sequences.set(m,I),S.next=20,I.insert(f,_);case 20:S.next=25;break;case 22:S.prev=22,S.t0=S.catch(2),ae.warning("failed to SequenceManager.insert()",S.t0);case 25:return S.prev=25,this.lock.release(),S.finish(25);case 28:case"end":return S.stop()}},l,this,[[2,22,25,28]])})),function(l,f){return c.apply(this,arguments)})}]),o}(),e5=function(o){ce(l,o);var c=fe(l);function l(){var f;return ie(this,l),(f=c.call(this))._sequenceManager=new J4,f._eventDeduplicator=new Z4,f}return se(l,[{key:"routeWebSocketInternalCommand",value:function(f){this._dispatchEvent("webSocketInternal",f)}},{key:"routeLogServerCommand",value:function(f){this._dispatchEvent("logServer",f)}},{key:"routeDirectCallInternalCommand",value:function(f){this._dispatchEvent("directCallInternal",f)}},{key:"routeDirectCallPeerCommand",value:function(f,_){var m=this;this._eventDeduplicator.process(f)&&(f.receivedType=_,this._sequenceManager.insert(f,function(v){m._dispatchEvent("directCallPeer",v)}))}},{key:"routeDirectCallResponseCommand",value:function(f,_){this._sequenceManager.insert(f,function(){var m=Bn(regeneratorRuntime.mark(function v(I){return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return _.resolve(I),S.abrupt("return",_.promise);case 2:case"end":return S.stop()}},v)}));return function(v){return m.apply(this,arguments)}}())}},{key:"routeDirectCallServerCommand",value:function(f,_){var m=this;this._eventDeduplicator.process(f)&&(f.receivedType=_,this._sequenceManager.insert(f,function(v){m._dispatchEvent("directCallServer",v)}))}},{key:"routeServerCommand",value:function(f){f instanceof c3&&this._dispatchEvent("roomServer",f)}},{key:"routePeerCommand",value:function(f){f instanceof na&&this._dispatchEvent("roomPeer",f)}}]),l}(zi),n5=function(){function o(l,f,_){ie(this,o),this.isLoading=!1,this.hasNext=!0,this.userId=l,this.params=f,this.sender=_,this.nextToken=null}var c;return se(o,[{key:"next",value:(c=Bn(regeneratorRuntime.mark(function l(f){var _,m=this;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!this.isLoading){v.next=2;break}throw new Jt(De.ERR_QUERY_IN_PROGRESS);case 2:if(this.hasNext){v.next=4;break}return v.abrupt("return",[]);case 4:return this.isLoading=!0,_=this.sender.send(this._createCommand()).then(function(I){return m.nextToken=I.next,m.hasNext=I.has_next,m.isLoading=!1,I.calls.map(function(S){return new xp(S,!0)})}),f&&wa(_)(f),v.abrupt("return",_);case 8:case"end":return v.stop()}},l,this)})),function(l){return c.apply(this,arguments)})},{key:"_createCommand",value:function(){return new UU(this.userId,this.params,this.nextToken)}}]),o}(),t5=function(){function o(_,m,v){ie(this,o),this.isLoading=!1,this.params=_,this.sender=m,this.roomManager=v,this.prevToken=null,this.nextToken=null}var c,l,f;return se(o,[{key:"next",value:(f=Bn(regeneratorRuntime.mark(function _(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!this.isLoading){m.next=2;break}throw new Jt(De.ERR_QUERY_IN_PROGRESS);case 2:if(this.hasNext){m.next=4;break}return m.abrupt("return",[]);case 4:return m.abrupt("return",this._sendQueryCommand(null,this.nextToken));case 5:case"end":return m.stop()}},_,this)})),function(){return f.apply(this,arguments)})},{key:"prev",value:(l=Bn(regeneratorRuntime.mark(function _(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!this.isLoading){m.next=2;break}throw new Jt(De.ERR_QUERY_IN_PROGRESS);case 2:if(this.hasPrev){m.next=4;break}return m.abrupt("return",[]);case 4:return m.abrupt("return",this._sendQueryCommand(this.prevToken,null));case 5:case"end":return m.stop()}},_,this)})),function(){return l.apply(this,arguments)})},{key:"_sendQueryCommand",value:(c=Bn(regeneratorRuntime.mark(function _(m,v){var I,S,w,G=this;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!m||!v){H.next=2;break}throw new Error("internal error while creating RoomListQueryCommand");case 2:return I=qr.createRoomListQuery(this.params,m,v),H.next=5,this.sender.send(I);case 5:return S=H.sent,w=S.payload,this.isLoading=!0,this.prevToken=w.prev,this.nextToken=w.next,this.isLoading=!1,H.prev=11,H.abrupt("return",Promise.all(w.rooms.map(function(x){return G.roomManager.deserializeRoom(x)})));case 15:return H.prev=15,H.t0=H.catch(11),H.abrupt("return",w.rooms);case 18:case"end":return H.stop()}},_,this,[[11,15]])})),function(_,m){return c.apply(this,arguments)})},{key:"hasPrev",get:function(){return!!this.prevToken}},{key:"hasNext",get:function(){return!this.prevToken&&!this.nextToken||!!this.nextToken}}]),o}(),vl="active",Kd="passive",El="hidden",yl="frozen",Kv="terminated",AN=function(){return typeof window<"u"&&Xh(window.safari)==="object"&&window.safari.pushNotification},r5=function(){return["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in window?"pagehide":"unload"]},i5=[[vl,Kd,El,Kv],[vl,Kd,El,yl],[El,Kd,vl],[yl,El],[yl,vl],[yl,Kd]].map(function(o){return o.reduce(function(c,l,f){return c[l]=f,c},{})}),jp=function(){return typeof document>"u"?Kd:document.visibilityState===El?El:document.hasFocus()?vl:Kd},a5=function(o){ce(l,o);var c=fe(l);function l(){var f;return ie(this,l),(f=c.call(this))._state=jp(),f._handleEvents=f._handleEvents.bind(je(f)),r5().forEach(function(_){return addEventListener(_,f._handleEvents,!0)}),AN()&&addEventListener("beforeunload",function(_){f._safariBeforeUnloadTimeout=setTimeout(function(){_.defaultPrevented||_.returnValue.length>0||f._dispatchChangesIfNeeded(_,El)},0)}),f}return se(l,[{key:"_dispatchChangesIfNeeded",value:function(f,_){if(_!==this._state)for(var m=function(w,G){for(var H,x=0;H=i5[x];++x){var V=H[w],K=H[G];if(V>=0&&K>=0&&K>V)return Object.keys(H).slice(V,K+1)}return[]}(this._state,_),v=0;v<m.length-1;++v){var I=m[v],S=m[v+1];this._state=S,this._dispatchEvent("statechange",{oldState:I,newState:S,originalEvent:f})}}},{key:"_handleEvents",value:function(f){switch(AN()&&clearTimeout(this._safariBeforeUnloadTimeout),f.type){case"pageshow":case"resume":this._dispatchChangesIfNeeded(f,jp());break;case"focus":this._dispatchChangesIfNeeded(f,vl);break;case"blur":this._state===vl&&this._dispatchChangesIfNeeded(f,jp());break;case"pagehide":case"unload":this._dispatchChangesIfNeeded(f,f.persisted?yl:Kv);break;case"visibilitychange":this._state!==yl&&this._state!==Kv&&this._dispatchChangesIfNeeded(f,jp());break;case"freeze":this._dispatchChangesIfNeeded(f,yl)}}},{key:"state",get:function(){return this._state}},{key:"pageWasDiscarded",get:function(){return typeof document<"u"&&(document.wasDiscarded||!1)}}]),l}(zi),s5=function(o){ce(l,o);var c=fe(l);function l(){var f;return ie(this,l),(f=c.call(this))._currentState="active",f._lifecycle=new a5,f}return se(l,[{key:"_onStateChanged",value:function(f){f.newState!=="hidden"?this._currentState==="hidden"&&this._dispatchEvent("resume"):this._currentState!=="hidden"&&this._dispatchEvent("pause"),this._currentState=f.newState}},{key:"start",value:function(){var f=this;this._lifecycle.addEventListener("statechange",function(_){return f._onStateChanged(_)})}},{key:"stop",value:function(){var f=this;this._lifecycle.removeEventListener("statechange",function(_){return f._onStateChanged(_)})}}]),l}(zi),u5=function(){function o(c,l,f){if(ie(this,o),qe(this,"_ctx",{}),this._appId=c,this._apiHost=l,this._websocketHost=f,!c)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"appId"});this._ctx.appId=c,this._ctx.apiHost=l,this._ctx.websocketHost=f,this._user=null,this._visibilityDetector=new s5,this.init()}return se(o,[{key:"init",value:function(){this._ctx.clientId=dp();var c=new e5;this._ctx.router=c,this._ctx.sender=new $4(this._ctx),this._ctx.deviceManager=new IU,this._ctx.recordingManager=new Q4,this._ctx.soundManager=new kU;var l=new P4(this._ctx);this._ctx.callManager=l,this._callManager=l;var f=new OU(this._ctx);this._roomManager=f,c.on("directCallInternal",function(m){return l.onEvent(m)}),c.on("directCallPeer",function(m){return l.onEvent(m)}),c.on("directCallServer",function(m){return l.onEvent(m)}),c.on("webSocketInternal",function(m){return l.onEvent(m)}),c.on("roomServer",function(m){return f.onEvent(m)}),c.on("roomPeer",function(m){return f.onEvent(m)});var _=new k6(this._ctx);ae.logCollector=_,c.on("logServer",function(m){return _.onEvent(m)})}},{key:"_checkAuthed",value:function(){if(!this.currentUser)throw new Ja(De.USER_NOT_AUTHENTICATED)}},{key:"authenticate",value:function(c,l){var f=this,_=c.userId,m=c.accessToken;if(ae.info("authenticate()"),!_)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"userId"});var v=this._ctx.sender.authenticate({userId:_,accessToken:m}).then(function(I){return f._user=I.user,f._callManager.setStatsInterval(I.statsInterval),f._user});return l&&wa(v)(l),v}},{key:"deauthenticate",value:function(){ae.info("deauthenticate()"),this._callManager&&this._callManager.clear(),this._roomManager&&this._roomManager.clear(),this._visibilityDetector.stop(),this._visibilityDetector.removeAllEventListeners(),this._ctx.sender.deauthenticate(),this._user=null}},{key:"connectWebSocket",value:function(){var c=this;return this._visibilityDetector.start(),this._visibilityDetector.on("resume",function(){c._ctx.sender.reconnectWs(),c._ctx.deviceManager.updateStream()}),this._ctx.sender.connectWs()}},{key:"handleWebhookData",value:function(c){var l=c.sendbird_call;if(!l)throw new Jt(De.ERR_MALFORMED_DATA);if(!l.cmd)throw new Jt(De.ERR_MALFORMED_DATA);var f=Kt.parse(l);f instanceof Li&&this._ctx.router.routeDirectCallPeerCommand(f,Rd.WEBHOOK)}},{key:"addListener",value:function(c,l){if(!l)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"listener"});this._callManager.addListener(c,l),this._roomManager.addListener(c,l),this._ctx.deviceManager.addSendBirdCallListener(c,l)}},{key:"removeListener",value:function(c){this._callManager.removeListener(c),this._roomManager.removeListener(c),this._ctx.deviceManager.removeSendBirdCallListener(c)}},{key:"removeAllListeners",value:function(){this._callManager.removeAllListeners(),this._ctx.deviceManager.removeAllSendBirdCallListener()}},{key:"addRecordingListener",value:function(c,l){this._ctx.recordingManager.addListener(c,l)}},{key:"removeRecordingListener",value:function(c){this._ctx.recordingManager.removeListener(c)}},{key:"removeAllRecordingListeners",value:function(){this._ctx.recordingManager.removeAllListeners()}},{key:"useMedia",value:function(c){return this._ctx.deviceManager.useMedia(c)}},{key:"updateMediaDevices",value:function(c){return this._ctx.deviceManager.refreshMediaDevices(c)}},{key:"getCurrentAudioInputDevice",value:function(){return this._ctx.deviceManager.getCurrentAudioInputDevice()}},{key:"getAvailableAudioInputDevices",value:function(){return this._ctx.deviceManager.getAvailableAudioInputDevices()}},{key:"selectAudioInputDevice",value:function(c){return this._ctx.deviceManager.selectDevice("audioinput",c)}},{key:"getCurrentAudioOutputDevice",value:function(){return this._ctx.deviceManager.getCurrentAudioOutputDevice()}},{key:"getAvailableAudioOutputDevices",value:function(){return this._ctx.deviceManager.getAvailableAudioOutputDevices()}},{key:"selectAudioOutputDevice",value:function(c){return this._ctx.deviceManager.selectDevice("audiooutput",c)}},{key:"getCurrentVideoInputDevice",value:function(){return this._ctx.deviceManager.getCurrentVideoInputDevice()}},{key:"getAvailableVideoInputDevices",value:function(){return this._ctx.deviceManager.getAvailableVideoInputDevices()}},{key:"selectVideoInputDevice",value:function(c){return this._ctx.deviceManager.selectDevice("videoinput",c)}},{key:"getCall",value:function(c){return this._callManager.getCall(c)}},{key:"getOngoingCalls",value:function(){return this._callManager.getOngoingCalls()}},{key:"getOngoingCallCount",value:function(){return this._callManager.getOngoingCallCount()}},{key:"setRingingTimeout",value:function(c){this._callManager.setRingingTimeout(c)}},{key:"setCallConnectionTimeout",value:function(c){this._callManager.setCallConnectionTimeout(c)}},{key:"isPlaying",value:function(c){return this._ctx.soundManager.isPlaying(c)}},{key:"addDirectCallSound",value:function(c,l){return this._ctx.soundManager.loadSound(c,l)}},{key:"removeDirectCallSound",value:function(c){return this._ctx.soundManager.unloadSound(c)}},{key:"dial",value:function(c,l){ae.info("dial()"),this._checkAuthed();var f=c.userId;if(this._user.userId===f)throw new uT(De.MY_USER_ID_NOT_ALLOWED);return this._callManager.dial(c,l)}},{key:"updateCustomItems",value:function(c,l,f){var _=$u(Og(l,f),2)[1];if(_)return _;var m=this._callManager.getCall(c);if(!m){var v=Kt.createUpdateCustomItems(c,l),I=this._ctx.sender.send(v).then(function(S){return{customItems:S.custom_items,affectedKeys:S.updated}}).catch(function(S){throw ae.error("failed to update customItems"),S});return f&&wa(I)(f),I}return m.updateCustomItems(l,f)}},{key:"deleteCustomItems",value:function(c,l,f){var _=$u(kg(l,f),2)[1];if(_)return _;var m=this._callManager.getCall(c);if(!m){var v=Kt.createDeleteCustomItems(c,l),I=this._ctx.sender.send(v).then(function(S){return{customItems:S.custom_items,affectedKeys:S.deleted}}).catch(function(S){throw ae.error("failed to delete customItems"),S});return f&&wa(I)(f),I}return m.deleteCustomItems(l,f)}},{key:"deleteAllCustomItems",value:function(c,l){var f=this._callManager.getCall(c);if(!f){var _=Kt.createDeleteAllCustomItems(c),m=this._ctx.sender.send(_).then(function(v){return{customItems:v.custom_items,affectedKeys:v.deleted}}).catch(function(v){throw ae.error("failed to delete all customItems"),v});return l&&wa(m)(l),m}return f.deleteAllCustomItems(l)}},{key:"createDirectCallLogListQuery",value:function(c){return new n5(this._user.userId,c,this._ctx.sender)}},{key:"createRoom",value:function(c){return this._roomManager.createRoom(c)}},{key:"getCachedRoomById",value:function(c){return this._roomManager.getCachedRoomById(c)}},{key:"fetchRoomById",value:function(c){return this._roomManager.fetchRoomById(c)}},{key:"createRoomListQuery",value:function(c){return new t5(c,this._ctx.sender,this._roomManager)}},{key:"registerPushToken",value:function(c,l){if(!c)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"pushToken"});if(!l)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"tokenType"});var f=Kt.createRegisterPushToken(this._user.userId,c,l);return this._ctx.sender.send(f).then(function(){}).catch(function(_){throw ae.error("failed to register the user's push token"),_})}},{key:"unregisterPushToken",value:function(c,l){if(!c)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"pushToken"});if(!l)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"tokenType"});var f=Kt.createUnregisterPushToken(this._user.userId,c,l);return this._ctx.sender.send(f).then(function(){}).catch(function(_){throw ae.error("failed to unregister the user's push token"),_})}},{key:"unregisterAllPushTokens",value:function(c){if(!c)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"tokenType"});var l=Kt.createUnregisterAllPushTokens(this._user.userId,c);return this._ctx.sender.send(l).then(function(){}).catch(function(f){throw ae.error("failed to unregister the user's all push token"),f})}},{key:"appId",get:function(){return this._appId}},{key:"currentUser",get:function(){return this._user}},{key:"dialListeners",get:function(){return this._callManager.dialListeners}},{key:"recordingListeners",get:function(){return this._ctx.recordingManager.listeners}}]),o}(),at=null;function Vt(){if(!at)throw new Ja(De.INSTANCE_NOT_INITIALIZED)}var o5=R0(null,function(o){var c=function l(){ie(this,l),o(this)};return{F:c,d:[{kind:"get",static:!0,key:"sdkVersion",value:function(){return Zg}},{kind:"get",static:!0,key:"LoggerLevel",value:function(){return Yg}},{kind:"method",static:!0,key:"setLoggerLevel",value:function(l){return ae.setLoggerLevel(ki[l])}},{kind:"get",static:!0,key:"SoundType",value:function(){return Ma}},{kind:"get",static:!0,key:"RoomType",value:function(){return Ra}},{kind:"get",static:!0,key:"RoomState",value:function(){return $g}},{kind:"get",static:!0,key:"DirectCallUserRole",value:function(){return Eu}},{kind:"get",static:!0,key:"DirectCallEndResult",value:function(){return fr}},{kind:"get",static:!0,key:"DirectCallOption",value:function(){return Lg}},{kind:"get",static:!0,key:"DirectCallRecordOption",value:function(){return RI}},{kind:"get",static:!0,key:"RecordingType",value:function(){return Di}},{kind:"get",static:!0,key:"ErrorCode",value:function(){return De}},{kind:"get",static:!0,key:"TokenType",value:function(){return Qg}},{kind:"get",static:!0,key:"ConnectionQualityMonitoringMode",value:function(){return Wc}},{kind:"get",static:!0,key:"ConnectionQualityState",value:function(){return Ps}},{kind:"method",static:!0,key:"init",value:function(l,f,_){if(!l)throw new Ja(De.INVALID_PARAMETER_VALUE,{invalidParameter:"appId"});if(function(){if(typeof window>"u"){var S="SendBirdCall needs 'window' in global";throw ae.error(S),S}if(window.RTCPeerConnection===void 0){var w="SendBirdCall needs 'RTCPeerConnection' in global";throw ae.error(w),w}var G=window.location,H=G.protocol,x=G.hostname;if(H!=="file:"&&H!=="https:"&&x!=="127.0.0.1"&&x!=="localhost"){var V="SendBirdCall needs https connection, except for 'localhost' or '127.0.0.1'";throw ae.error(V),V}if(window.RTCPeerConnection.prototype.addTrack===void 0||window.RTCPeerConnection.prototype.getSenders===void 0){var K="SendBirdCall can't support the browser using legacy WebRTC module";throw ae.error(K),K}}(),at&&at.appId===l)return!1;var m=null,v=null,I=null;return at&&(at.deauthenticate(),v=new Map(at.dialListeners),I=new Map(at.recordingListeners),at.removeAllListeners(),at.removeAllRecordingListeners(),m=at),at=new u5(l,f,_),m&&(v.forEach(function(S,w){at.addListener(w,S)}),I.forEach(function(S,w){at.addRecordingListener(w,S)})),!0}},{kind:"get",static:!0,key:"appId",value:function(){var l;return(l=at)===null||l===void 0?void 0:l.appId}},{kind:"get",static:!0,key:"currentUser",value:function(){var l;return(l=at)===null||l===void 0?void 0:l.currentUser}},{kind:"method",static:!0,key:"authenticate",value:function(l,f){Vt();var _=l.userId,m=l.accessToken;return at&&at.currentUser&&at.currentUser.userId!==_&&c.deauthenticate(),at.authenticate({userId:_,accessToken:m},f)}},{kind:"method",static:!0,key:"deauthenticate",value:function(){Vt(),at.deauthenticate()}},{kind:"method",static:!0,key:"connectWebSocket",value:function(){return Vt(),at.connectWebSocket()}},{kind:"method",static:!0,key:"handleWebhookData",value:function(l){Vt(),at.handleWebhookData(l)}},{kind:"method",static:!0,key:"addListener",value:function(l,f){Vt(),at.addListener(l,f)}},{kind:"method",static:!0,key:"removeListener",value:function(l){Vt(),at.removeListener(l)}},{kind:"method",static:!0,key:"removeAllListeners",value:function(){Vt(),at.removeAllListeners()}},{kind:"method",static:!0,key:"addRecordingListener",value:function(l,f){Vt(),at.addRecordingListener(l,f)}},{kind:"method",static:!0,key:"removeRecordingListener",value:function(l){Vt(),at.removeRecordingListener(l)}},{kind:"method",static:!0,key:"removeAllRecordingListeners",value:function(){Vt(),at.removeAllRecordingListeners()}},{kind:"method",static:!0,key:"useMedia",value:function(l){return Vt(),at.useMedia(l)}},{kind:"method",static:!0,key:"updateMediaDevices",value:function(l){return Vt(),at.updateMediaDevices(l)}},{kind:"method",static:!0,key:"getCurrentAudioInputDevice",value:function(){return Vt(),at.getCurrentAudioInputDevice()}},{kind:"method",static:!0,key:"getAvailableAudioInputDevices",value:function(){return Vt(),at.getAvailableAudioInputDevices()}},{kind:"method",static:!0,key:"selectAudioInputDevice",value:function(l){return Vt(),at.selectAudioInputDevice(l)}},{kind:"method",static:!0,key:"getCurrentAudioOutputDevice",value:function(){return Vt(),at.getCurrentAudioOutputDevice()}},{kind:"method",static:!0,key:"getAvailableAudioOutputDevices",value:function(){return Vt(),at.getAvailableAudioOutputDevices()}},{kind:"method",static:!0,key:"selectAudioOutputDevice",value:function(l){return Vt(),at.selectAudioOutputDevice(l)}},{kind:"method",static:!0,key:"getCurrentVideoInputDevice",value:function(){return Vt(),at.getCurrentVideoInputDevice()}},{kind:"method",static:!0,key:"getAvailableVideoInputDevices",value:function(){return Vt(),at.getAvailableVideoInputDevices()}},{kind:"method",static:!0,key:"selectVideoInputDevice",value:function(l){return Vt(),at.selectVideoInputDevice(l)}},{kind:"method",static:!0,key:"getCall",value:function(l){return Vt(),at.getCall(l)}},{kind:"method",static:!0,key:"getOngoingCalls",value:function(){return Vt(),at.getOngoingCalls()}},{kind:"method",static:!0,key:"getOngoingCallCount",value:function(){return Vt(),at.getOngoingCallCount()}},{kind:"method",static:!0,key:"setRingingTimeout",value:function(l){Vt(),at.setRingingTimeout(l)}},{kind:"method",static:!0,key:"setCallConnectionTimeout",value:function(l){Vt(),at.setCallConnectionTimeout(l)}},{kind:"method",static:!0,key:"isPlaying",value:function(l){return Vt(),at.isPlaying(l)}},{kind:"method",static:!0,key:"addDirectCallSound",value:function(l,f){return Vt(),at.addDirectCallSound(l,f)}},{kind:"method",static:!0,key:"removeDirectCallSound",value:function(l){return Vt(),at.removeDirectCallSound(l)}},{kind:"method",decorators:[el(el.messages.CALL_IS_NOT_SUPPORTED)],static:!0,key:"dial",value:function(l,f){return Vt(),at.dial(l,f)}},{kind:"method",static:!0,key:"updateCustomItems",value:function(l,f,_){return Vt(),at.updateCustomItems(l,f,_)}},{kind:"method",static:!0,key:"deleteCustomItems",value:function(l,f,_){return Vt(),at.deleteCustomItems(l,f,_)}},{kind:"method",static:!0,key:"deleteAllCustomItems",value:function(l,f){return Vt(),at.deleteAllCustomItems(l,f)}},{kind:"method",static:!0,key:"createDirectCallLogListQuery",value:function(l){return Vt(),at.createDirectCallLogListQuery(l)}},{kind:"method",static:!0,key:"createRoom",value:function(l){return Vt(),at.createRoom(l)}},{kind:"method",static:!0,key:"getCachedRoomById",value:function(l){return Vt(),at.getCachedRoomById(l)}},{kind:"method",static:!0,key:"fetchRoomById",value:function(l){return Vt(),at.fetchRoomById(l)}},{kind:"method",static:!0,key:"createRoomListQuery",value:function(l){return Vt(),at.createRoomListQuery(l)}},{kind:"method",static:!0,key:"registerPushToken",value:function(l,f){return Vt(),at.registerPushToken(l,f)}},{kind:"method",static:!0,key:"unregisterPushToken",value:function(l,f){return Vt(),at.unregisterPushToken(l,f)}},{kind:"method",static:!0,key:"unregisterAllPushTokens",value:function(l){return Vt(),at.unregisterAllPushTokens(l)}}]}});return o5})}(F_)),F_.exports}var iJ=rJ();const Vf=d5(iJ);function aJ(){const{channelUrl:n}=c5(),t=f5(),[e,r]=F.useState(n||null),[i,a]=F.useState(null),[s,u]=F.useState(null),[d,h]=F.useState(null),[p,g]=F.useState(!1),[E,y]=F.useState(!0),[C,T]=F.useState(!0),[A,O]=F.useState(!1),[N,k]=F.useState(!0),[D,P]=F.useState({}),U=F.useRef(null),L=F.useRef(null),B=F.useRef(null),q=window.localStorage.getItem("token")||"",z="AED40948-FDBF-4552-9062-8B2F35D974A3",Y=localStorage.getItem("sendbird_user_id")||"testUser",Q=localStorage.getItem("sendbird_access_token")||"",$=localStorage.getItem("nickname")||"Tester";localStorage.getItem("token");const[Z,ne]=F.useState(null),[ue,pe]=F.useState(!1),[he,le]=F.useState(!1),[we,ve]=F.useState(""),[Ue,be]=F.useState(0),[Qe,Ne]=F.useState(null);F.useEffect(()=>{const Pe=VM.init({appId:z,modules:[new rO]});Pe.connect(Y,Q).then(Ke=>{console.log("已連接到 Sendbird Chat:",Ke),ne(Pe)}).catch(Ke=>{console.error("連接 Sendbird Chat 失敗:",Ke)}),Vf.init(z),Vf.authenticate({userId:Y,accessToken:Q}).then(()=>Vf.connectWebSocket()).then(()=>{console.log("WebSocket 連接成功"),$e()}).catch(Ke=>console.error("Sendbird Calls 初始化失敗:",Ke))},[z,Y,Q]),F.useEffect(()=>{(async()=>{if(!Z){console.warn("SendBirdChat 尚未初始化，等待 sbInstance...");return}if(!e){console.warn("沒有選擇的頻道，無法讀取訊息");return}try{console.log("正在獲取頻道：",e);const Ke=await Z.groupChannel.getChannel(e);console.log("成功獲取頻道：",Ke);const tn=await Ke.createPreviousMessageListQuery().load(20);tn.length===0?console.log("此頻道沒有訊息！"):console.log("獲取的訊息：",tn)}catch(Ke){console.error("讀取訊息失敗:",Ke)}})()},[Z,e]),F.useEffect(()=>{(async()=>{if(!(!Z||!n))try{const yn=(await Z.groupChannel.getChannel(n)).members.find(tn=>tn.userId!==Y);wn(q,yn.metaData.user_id),ve(yn.metaData.user_id),yn?a(yn):alert("該頻道不是 1 對 1 對話！")}catch(Ke){console.error("取得頻道資訊失敗:",Ke)}})()},[Z,n,Y]),F.useEffect(()=>{console.log("useParams 取得的 channelUrl:",n),n?r(n):(console.warn("未取得有效的 channelUrl"),r(null))},[n]);const $e=()=>{Vf.addListener("INCOMING_CALL_LISTENER",{onRinging:Pe=>{console.log("收到來電:",Pe),u(Pe)}})},gn=async Pe=>{if(!await An(Pe)){alert("金額不足");return}if(!i){alert("找不到聊天對象，請確認這是 1 對 1 對話。");return}try{const yn=await qp.post("https://api.dageiwo.com/api/pay/purchase",{host_id:we,type:Pe==="voice"?"CALL":"VIDEO"},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),tn=yn.data.data.purchase_id;if(console.log("購買ID:",tn),be(tn),yn.status===200&&yn.data.success){const st=await navigator.mediaDevices.getUserMedia({audio:!0,video:Pe==="video"?{facingMode:{ideal:N?"environment":"user"}}:!1});U.current&&(U.current.srcObject=st);const Cn={userId:i.userId,isVideoCall:Pe==="video",callOption:{localMediaView:U.current,remoteMediaView:L.current,audioEnabled:!0,videoEnabled:Pe==="video"}},Ve=Vf.dial(Cn);En(Ve,tn),h(Ve),g(!0)}}catch(yn){console.error("撥打通話時出現錯誤:",yn)}},En=(Pe,Ke)=>{Pe.onConnected=()=>{console.log("通話已接通"),Tn(Ke),g(!1)},Pe.onEstablished=()=>{console.log("媒體流已建立")},Pe.onEnded=()=>{console.log("通話已結束"),kn(),U.current&&U.current.srcObject&&(U.current.srcObject.getTracks().forEach(yn=>yn.stop()),U.current.srcObject=null),h(null),g(!1)},Pe.onError=yn=>{console.error("通話出現錯誤:",yn),g(!1)}},Yn=()=>{s&&(s.accept({callOption:{localMediaView:U.current,remoteMediaView:L.current,audioEnabled:!0,videoEnabled:s.isVideoCall}}),En(s),h(s),u(null))},Gn=()=>{s&&(s.end(),u(null))},Tn=Pe=>{Ln(Pe);const Ke=setInterval(()=>{Ln(Pe)},3e3);Ne(Ke)},kn=()=>{clearInterval(Qe),Ne(null)},Vn=()=>{kn(),d&&(d.end(),U.current&&U.current.srcObject&&(U.current.srcObject.getTracks().forEach(Pe=>Pe.stop()),U.current.srcObject=null),h(null),g(!1))},Hn=()=>{d&&(E?d.muteMicrophone():d.unmuteMicrophone(),y(!E))},Jn=()=>{d&&(C?d.stopVideo():d.startVideo(),T(!C))},jn=()=>{B.current&&(A?document.exitFullscreen():B.current.requestFullscreen(),O(!A))},On=async()=>{const Pe=!N;if(k(Pe),d&&U.current&&U.current.srcObject){U.current.srcObject.getTracks().forEach(Ke=>Ke.stop());try{const Ke=await navigator.mediaDevices.getUserMedia({audio:!0,video:{facingMode:{ideal:Pe?"environment":"user"}}});U.current.srcObject=Ke}catch(Ke){console.error("切換鏡頭失敗:",Ke)}}},Ln=async Pe=>{try{const Ke=await qp.post("https://api.dageiwo.com/api/pay/deposit_coins",{purchase_id:Pe},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(console.log("扣點 API 呼叫結果:",Ke.data),Ke.data.data==="coin_not_enough"){console.warn("點數不足，掛斷通話"),Vn(),alert("您的點數不足，通話將自動結束，請前往儲值！");return}}catch(Ke){console.error("扣點 API 呼叫失敗:",Ke)}},An=async Pe=>{try{const Ke=await qp.get("https://api.dageiwo.com/api/pay/check_coin",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});return console.log("檢查金額 API 回傳:",Ke.data),Ke.data.success&&Ke.data.data?Pe==="voice"?Ke.data.data>D.call_coin:Ke.data.data>D.video_coin:!1}catch(Ke){return console.error("檢查金額 API 呼叫失敗:",Ke),alert("查詢金額失敗，請稍後再試！"),!1}},wn=async(Pe,Ke)=>{try{const yn=await qp.get(`https://api.dageiwo.com/index/detail/${Ke}`,{headers:{Authorization:`Bearer ${Pe}`}});if(yn.status===200&&yn.data.success){const tn=yn.data.data;P(tn)}}catch(yn){console.error("RetrieveInfo error:",yn)}},We=async()=>{gn("voice"),pe(!1)},ln=async()=>{gn("video"),le(!1)};return wt.jsxs("div",{style:{height:"100vh",position:"relative"},children:[wt.jsx(eJ,{appId:z,userId:Y,accessToken:Q,nickname:$,children:wt.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:[wt.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,opacity:e?0:1,width:"100%",pointerEvents:e?"none":"auto",transition:"opacity 0.3s"},children:wt.jsx(_X,{onChannelSelect:Pe=>{if(Pe&&Pe.url){r(Pe.url),t(`/man-chat-list/${Pe.url}`);const Ke=Pe.members.find(yn=>yn.userId!==Y);a(Ke)}},disableAutoSelect:!0})}),wt.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,opacity:e?1:0,pointerEvents:e?"auto":"none",transition:"opacity 0.3s",display:e?"block":"none"},children:[wt.jsxs("div",{style:{marginTop:"10px"},children:[wt.jsx("button",{onClick:()=>{r(null),t("/man-chat-list")},style:Wi.callButton,children:"⬅ 返回列表"}),wt.jsx("button",{onClick:()=>pe(!0),style:Wi.callButton,children:"📞 語音通話"}),wt.jsx("button",{onClick:()=>le(!0),style:Wi.callButton,children:"📹 視訊通話"})]}),wt.jsx(AZ,{channelUrl:e}),wt.jsx("div",{style:{color:"#616161"},children:"每則訊息需花費 1 元金幣！！"})]})]})}),ue&&wt.jsx("div",{className:"modal-overlay",children:wt.jsxs("div",{className:"modal-content",children:[wt.jsx("button",{className:"modal-close",onClick:()=>pe(!1),children:wt.jsx("i",{className:"mdi mdi-close"})}),wt.jsxs("div",{style:{textAlign:"center"},children:[wt.jsx("img",{src:"../src/assets/通話費率.png",alt:"通話費率",style:{maxWidth:"120px"}}),wt.jsxs("p",{children:["將以每",wt.jsxs("span",{style:{fontWeight:"bolder"},children:[D.call_coin,"點/分鐘"]}),"扣點進行語音通話"]}),wt.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",padding:"8px 16px",borderRadius:"4px",border:"none",margin:"0.5rem 0",width:"100%"},onClick:We,children:"確定"}),wt.jsx("button",{style:{backgroundColor:"#fff",color:"#dd8ea4",padding:"8px 16px",borderRadius:"4px",border:"2px solid #dd8ea4",width:"100%"},onClick:()=>t("/purchase/deposit"),children:"前往加值"})]})]})}),he&&wt.jsx("div",{className:"modal-overlay",children:wt.jsxs("div",{className:"modal-content",children:[wt.jsx("button",{className:"modal-close",onClick:()=>le(!1),children:wt.jsx("i",{className:"mdi mdi-close"})}),wt.jsxs("div",{style:{textAlign:"center"},children:[wt.jsx("img",{src:"../src/assets/視訊費率.png",alt:"視訊費率",style:{maxWidth:"120px"}}),wt.jsxs("p",{children:["將以每",wt.jsxs("span",{style:{fontWeight:"bolder"},children:[D.video_coin,"點/分鐘"]}),"扣點進行視訊通話"]}),wt.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",padding:"8px 16px",borderRadius:"4px",border:"none",margin:"0.5rem 0",width:"100%"},onClick:ln,children:"確定"}),wt.jsx("button",{style:{backgroundColor:"#fff",color:"#dd8ea4",padding:"8px 16px",borderRadius:"4px",border:"2px solid #dd8ea4",width:"100%"},onClick:()=>t("/purchase/deposit"),children:"前往加值"})]})]})}),p&&wt.jsxs("div",{style:Wi.waitingCallContainer,children:[wt.jsx("h3",{children:"等待對方接聽中..."}),wt.jsx("button",{onClick:Vn,style:Wi.declineButton,children:"❌ 取消通話"})]}),s&&wt.jsxs("div",{style:Wi.incomingCallContainer,children:[wt.jsxs("h3",{children:["來電來自: ",s.caller.nickname||s.caller.userId]}),wt.jsx("button",{onClick:Yn,style:Wi.acceptButton,children:"✅ 接聽"}),wt.jsx("button",{onClick:Gn,style:Wi.declineButton,children:"❌ 拒絕"})]}),wt.jsxs("div",{ref:B,style:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"#000",display:d?"block":"none",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:1e4},children:[wt.jsx("video",{ref:L,autoPlay:!0,playsInline:!0,style:Wi.remoteVideo}),wt.jsx("video",{ref:U,autoPlay:!0,muted:!0,playsInline:!0,style:Wi.localVideo}),wt.jsxs("div",{style:Wi.controlPanel,children:[wt.jsxs("button",{onClick:Hn,style:Wi.controlButton,children:[E?"🎤 麥克風關閉":"🎤 麥克風開啟",Ue]}),wt.jsx("button",{onClick:Jn,style:Wi.controlButton,children:C?"📷 關閉攝影機":"📷 開啟攝影機"}),wt.jsx("button",{onClick:jn,style:Wi.controlButton,children:A?"⛶ 退出全螢幕":"⛶ 全螢幕"}),wt.jsx("button",{onClick:On,style:Wi.callButton,children:"切換鏡頭"}),wt.jsx("button",{onClick:Vn,style:Wi.endCallButton,children:"❌ 結束通話"})]})]})]})}const Wi={callButton:{margin:"5px",padding:"10px 20px",backgroundColor:"#dd8ea4",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},waitingCallContainer:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"8px",padding:"20px",zIndex:1e3,textAlign:"center"},incomingCallContainer:{position:"fixed",top:"20px",right:"20px",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"8px",padding:"20px",zIndex:1e3},acceptButton:{backgroundColor:"#4CAF50",color:"white",padding:"10px 20px",margin:"5px",border:"none",borderRadius:"5px",cursor:"pointer"},declineButton:{backgroundColor:"#F44336",color:"white",padding:"10px 20px",margin:"5px",border:"none",borderRadius:"5px",cursor:"pointer"},videoContainer:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"#000",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:1e4},remoteVideo:{width:"100%",height:"80%",backgroundColor:"#000"},localVideo:{width:"100px",height:"100px",position:"absolute",bottom:"180px",right:"20px",border:"2px solid white",borderRadius:"8px"},controlPanel:{display:"flex",justifyContent:"center",marginTop:"10px"},controlButton:{backgroundColor:"#555",color:"#fff",border:"none",padding:"10px 15px",fontSize:"14px",cursor:"pointer",borderRadius:"5px",margin:"0 5px"},endCallButton:{backgroundColor:"#dd4b39",color:"#fff",border:"none",padding:"10px 20px",fontSize:"16px",cursor:"pointer",borderRadius:"5px",marginLeft:"5px"}},lJ=Object.freeze(Object.defineProperty({__proto__:null,default:aJ},Symbol.toStringTag,{value:"Module"}));export { lJ as C, Me as F, Yb as G, mc as H, oJ as V, m2 as W, ee as b, Qi as i, X as o, j_ as r };

