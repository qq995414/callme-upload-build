import{u as B,r as n,j as t}from"./index-BYUO2iQu.js";import{a as l}from"./axios-upsvKRUO.js";import{C as E}from"./CopyrightFooter-DGUZG5Yy.js";import{S as F,b}from"./blur-CG1WBxfd.js";function q(){const p=B(),[g,y]=n.useState(window.innerWidth),[h,k]=n.useState(""),[D,S]=n.useState(""),[M,j]=n.useState(""),[O,v]=n.useState(""),[P,C]=n.useState(""),[U,_]=n.useState(""),[I,z]=n.useState([]),[T,a]=n.useState([]),[i,m]=n.useState("關注"),[u,d]=n.useState(1);n.useEffect(()=>{const e=window.sessionStorage.getItem("nickname")||"",o=window.sessionStorage.getItem("gender_type")||"",s=sessionStorage.getItem("token")||"",r=window.sessionStorage.getItem("chat_id")||"",c=window.sessionStorage.getItem("chat_token")||"",A=window.sessionStorage.getItem("u_id")||"";console.log("s",s),S(e),j(o),k(s),v(r),C(c),_(A),$(s),x(!0)},[]),n.useEffect(()=>{const e=()=>y(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const f=n.useCallback(()=>{let e=2;return g>960&&(e=3),((g>800?800:g)-30)/e},[g]),R=e=>{if(!e)return"";const o=Date.now()-new Date(e).getTime(),s=new Date(o);return" "+Math.abs(s.getUTCFullYear()-1970)},$=async e=>{try{console.log(h);const o=await l.get("https://api.dageiwo.com/index/pinned_picture",{headers:{Authorization:`Bearer ${e}`}});o.status===200&&o.data.success&&z(s=>[...s,...o.data.data])}catch(o){console.error(o)}},w=async e=>{try{e&&(d(1),a([])),m("列表");const o=await l.get(`https://api.dageiwo.com/index/list?page=${e?1:u}&limit=40&order=dsc&sort=femaleRegister.clickRate`,{headers:{Authorization:`Bearer ${h}`}});if(o.status===200&&o.data.success){const{records:s}=o.data.data;s.length>0&&d(r=>r+1),a(r=>[...r,...s])}}catch(o){console.error(o)}},x=async(e,o)=>{try{e&&(d(1),a([])),m("關注");const s=await l.get(`https://api.dageiwo.com/api/user/follows?page=${e?1:u}&limit=40&order=dsc&sort=femaleRegister.clickRate`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});if(s.status===200&&s.data.success){const{records:r}=s.data.data;r.length>0&&d(c=>c+1),a(c=>[...c,...r])}}catch(s){console.error(s)}},L=async()=>{try{a([]),m("在線");const e=await l.get("https://api.dageiwo.com/index/is_online",{headers:{Authorization:`Bearer ${h}`}});if(e.status===200&&e.data.success){const{records:o}=e.data.data;o.length>0&&d(s=>s+1),a(s=>[...s,...o])}}catch(e){console.error(e)}},N=async()=>{try{const e=await l.post("https://api.dageiwo.com/auth/logout",{},{headers:{Authorization:`Bearer ${h}`}});e.status===200&&e.data.success&&(window.sessionStorage.setItem("nickname",""),window.sessionStorage.setItem("gender_type",""),window.sessionStorage.setItem("token",""),window.sessionStorage.setItem("chat_id",""),window.sessionStorage.setItem("chat_token",""),window.sessionStorage.setItem("u_id",""),window.WebSocketObject&&window.WebSocketObject.close(),p("/home"))}catch(e){console.error(e),p("/home")}},W={dots:!1,infinite:!0,speed:500,slidesToShow:9,slidesToScroll:1,arrows:!0,responsive:[{breakpoint:768,settings:{slidesToShow:4,slidesToScroll:1}},{breakpoint:480,settings:{slidesToShow:3,slidesToScroll:1}}]};return t.jsxs("div",{className:"home-man-view",style:{backgroundColor:"#f2e9eb"},children:[t.jsx("div",{className:"app-bar",style:{backgroundColor:"#dd8ea4",padding:"1rem"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[t.jsx("div",{style:{flex:1}}),t.jsx("div",{style:{flex:1,display:"flex",justifyContent:"center"},children:t.jsx("div",{style:{backgroundColor:"white",width:"120px",height:"40px",borderRadius:"8px",overflow:"hidden"},children:t.jsx("img",{src:"../public/assets/Logo-wide.png",alt:"Logo",style:{width:"100%",height:"100%",objectFit:"cover"}})})}),t.jsx("div",{style:{flex:1,display:"flex",justifyContent:"flex-end"},children:t.jsxs("button",{style:{backgroundColor:"#dd8ea4",color:"white",fontSize:"18px",marginRight:"26px",border:"none",cursor:"pointer"},onClick:N,children:[t.jsx("i",{className:"mdi mdi-logout",style:{marginRight:"6px"}}),"登出"]})})]})}),t.jsxs("div",{className:"home-man-main",style:{maxWidth:"800px",margin:"0 auto",padding:"1rem"},children:[t.jsx("h2",{style:{margin:"10px"},children:"為你推薦"}),t.jsx("div",{style:{margin:"0 5%"},children:t.jsx(F,{...W,children:I.map((e,o)=>t.jsxs("div",{style:{padding:"8px"},children:[t.jsx(b.LazyLoadImage,{src:e.url||"/images/placeholder.png",alt:e.nickname||"No name",effect:"blur",placeholderSrc:"/images/placeholder.png",onClick:()=>p(`/woman-info/${e.id}`),style:{border:"2px solid #f2e9eb",outline:"#dd8ea4 solid 2px",width:"64px",height:"64px",objectFit:"cover",cursor:"pointer",borderRadius:"50%",margin:"0 auto",display:"block"}}),t.jsx("p",{style:{fontSize:"12px",textAlign:"center",marginTop:"4px"},children:e.nickname})]},o))})}),t.jsx("h2",{style:{margin:"10px"},children:"女神列表"}),t.jsxs("div",{style:{display:"flex",marginBottom:"5px"},children:[t.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:i==="關注"?"#dd8ea4":"grey",borderBottom:i==="關注"?"2px solid #dd8ea4":"none"},onClick:()=>x(!0),children:"關注"}),t.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:i==="列表"?"#dd8ea4":"grey",borderBottom:i==="列表"?"2px solid #dd8ea4":"none"},onClick:()=>w(!0),children:"列表"}),t.jsx("button",{style:{flex:1,border:"none",background:"none",cursor:"pointer",fontSize:"1rem",color:i==="在線"?"#dd8ea4":"grey",borderBottom:i==="在線"?"2px solid #dd8ea4":"none"},onClick:L,children:"在線"})]}),t.jsx("div",{className:"female-member-list",children:T.map((e,o)=>{const r=e.img_responses&&e.img_responses[0]&&e.img_responses[0].status==="APPROVED";return t.jsx("div",{className:"female-member-item",style:{position:"relative",height:f()},children:t.jsxs("div",{style:{position:"relative",borderRadius:"16px",overflow:"hidden"},children:[t.jsx(b.LazyLoadImage,{src:e.img_responses?e.img_responses[0].image_url:"/images/placeholder.png",alt:e.nickname||"No name",effect:"blur",placeholderSrc:"/images/placeholder.png",onClick:()=>p(`/woman-info/${e.id}`),width:"100%",height:f(),style:{objectFit:"cover",filter:r?"none":"blur(8px)",transform:r?"scale(1)":"scale(0.95)",cursor:"pointer"}}),!r&&t.jsx("div",{style:{color:"white",fontSize:"32px",fontWeight:"1000",WebkitTextStroke:"1px black",top:"50%",left:"50%",minWidth:"130px",justifyContent:"center",position:"absolute",display:"block",zIndex:999,transform:"translate(-50%, -50%)"},children:"審查中"}),r&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{position:"absolute",top:"8px",right:"8px"},children:[!e.cannot_take_call&&t.jsx("span",{style:{backgroundColor:"purple",color:"#fff",padding:"2px 6px",marginRight:"4px",fontSize:"12px",borderRadius:"4px"},children:"語音"}),!e.cannot_take_video_call&&t.jsx("span",{style:{backgroundColor:"cyan",color:"#fff",padding:"2px 6px",fontSize:"12px",borderRadius:"4px"},children:"視訊"})]}),t.jsxs("div",{style:{position:"absolute",bottom:"8px",left:"16px",color:"white",fontSize:"14px",fontWeight:"bolder",textShadow:"1px 1px 2px #000"},children:[e.nickname+R(e.birthday),e.review_notes&&t.jsx("div",{style:{fontSize:"10px",marginTop:"0"},children:e.review_notes})]})]})]})},o)})}),i==="列表"&&t.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",border:"none",padding:"8px 16px",cursor:"pointer",marginTop:"1rem"},onClick:()=>w(!1),children:"查看更多"}),i==="關注"&&t.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",border:"none",padding:"8px 16px",cursor:"pointer",marginTop:"1rem"},onClick:()=>x(!1),children:"查看更多"})]}),t.jsx(E,{})]})}export{q as default};
