const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/__bundle-c4e6f51b-CerIW5s9.js","assets/index-C3mMhQvi.js","assets/index-1tep4V0S.css","assets/axios-upsvKRUO.js","assets/__bundle-46d64517-HHxQgd_i.js","assets/bundle-BGxqCTv7-C32Zrtsx.js"])))=>i.map(i=>d[i]);
import{f as zS,_ as so,r as N,R as p,b as KS,u as $S,S as ra,j as Ze}from"./index-C3mMhQvi.js";import{a as Uu}from"./axios-upsvKRUO.js";var Nu=zS(),gf=function(n,t){return gf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},gf(n,t)};function w(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}gf(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var D=function(){return D=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},D.apply(this,arguments)};function WS(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e}function y(n,t,e,r){return new(e||(e=Promise))(function(i,a){function s(l){try{o(r.next(l))}catch(d){a(d)}}function u(l){try{o(r.throw(l))}catch(d){a(d)}}function o(l){var d;l.done?i(l.value):(d=l.value,d instanceof e?d:new e(function(c){c(d)})).then(s,u)}o((r=r.apply(n,[])).next())})}function v(n,t){var e,r,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=u(0),s.throw=u(1),s.return=u(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(o){return function(l){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;s&&(s=0,d[0]&&(a=0)),a;)try{if(e=1,r&&(i=2&d[0]?r.return:d[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,d[1])).done)return i;switch(r=0,i&&(d=[2&d[0],i.value]),d[0]){case 0:case 1:i=d;break;case 4:return a.label++,{value:d[1],done:!1};case 5:a.label++,r=d[1],d=[0];continue;case 7:d=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||d[0]!==6&&d[0]!==2)){a=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){a.label=d[1];break}if(d[0]===6&&a.label<i[1]){a.label=i[1],i=d;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(d);break}i[2]&&a.ops.pop(),a.trys.pop();continue}d=t.call(n,a)}catch(c){d=[6,c],r=0}finally{e=i=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([o,l])}}}function oe(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function we(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r,i,a=e.call(n),s=[];try{for(;(t===void 0||t-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(e=a.return)&&e.call(a)}finally{if(i)throw i.error}}return s}function Be(n,t,e){if(arguments.length===2)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))}var Ne,py="4.16.5",ja=function(){function n(){}return Object.defineProperty(n,"OS_VERSION",{get:function(){return typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SDK_VERSION",{get:function(){return py},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SDK_MAJOR_VERSION",{get:function(){return n.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(n,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),n}();(function(n){n[n.NON_AUTHORIZED=400108]="NON_AUTHORIZED",n[n.INVALID_TOKEN=400111]="INVALID_TOKEN",n[n.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",n[n.USER_AUTH_DEACTIVATED=400300]="USER_AUTH_DEACTIVATED",n[n.USER_AUTH_DELETED_OR_NOT_FOUND=400301]="USER_AUTH_DELETED_OR_NOT_FOUND",n[n.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",n[n.APPLICATION_NOT_FOUND=400304]="APPLICATION_NOT_FOUND",n[n.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",n[n.SESSION_REVOKED=400310]="SESSION_REVOKED",n[n.INVALID_SESSION_TYPE=400312]="INVALID_SESSION_TYPE",n[n.INVALID_AUTH_FOR_SERVICE=400313]="INVALID_AUTH_FOR_SERVICE",n[n.STAT_UPLOAD_NOT_ALLOWED=403200]="STAT_UPLOAD_NOT_ALLOWED",n[n.NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE=400940]="NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE",n[n.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",n[n.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",n[n.INVALID_REQUIRED_FORM_VALUE=400105]="INVALID_REQUIRED_FORM_VALUE",n[n.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",n[n.NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE=901500]="NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE",n[n.ERR_DUPLICATED_DATA=400202]="ERR_DUPLICATED_DATA",n[n.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",n[n.LOST_INSTANCE=700100]="LOST_INSTANCE",n[n.CONNECTION_RENEW=700102]="CONNECTION_RENEW",n[n.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",n[n.INVALID_COMMAND=700700]="INVALID_COMMAND",n[n.XMLHTTPREQUEST_NOT_SUPPORTED=700800]="XMLHTTPREQUEST_NOT_SUPPORTED",n[n.UNKNOWN_ERROR=77e4]="UNKNOWN_ERROR",n[n.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",n[n.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",n[n.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",n[n.INVALID_PARAMETER=800110]="INVALID_PARAMETER",n[n.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",n[n.NETWORK_ERROR=800120]="NETWORK_ERROR",n[n.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",n[n.MALFORMED_DATA=800130]="MALFORMED_DATA",n[n.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",n[n.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",n[n.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",n[n.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",n[n.ACK_TIMEOUT=800180]="ACK_TIMEOUT",n[n.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",n[n.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",n[n.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",n[n.REQUEST_FAILED=800220]="REQUEST_FAILED",n[n.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",n[n.REQUEST_CANCELED=800240]="REQUEST_CANCELED",n[n.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",n[n.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",n[n.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED=800270]="ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED",n[n.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",n[n.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",n[n.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",n[n.COLLECTION_DISPOSED=800600]="COLLECTION_DISPOSED",n[n.DATABASE_ERROR=800700]="DATABASE_ERROR",n[n.USER_DEACTIVATED=900021]="USER_DEACTIVATED",n[n.CHANNEL_IS_FROZEN=900050]="CHANNEL_IS_FROZEN",n[n.RECEIVER_USER_DEACTIVATED=900081]="RECEIVER_USER_DEACTIVATED"})(Ne||(Ne={}));var Cr,ys,Qt,ed,Ef,uo,gr=function(n){return!(n instanceof H&&!n.shouldThrowOutside)},H=function(n){function t(e){var r=e.code,i=r===void 0?0:r,a=e.message,s=a===void 0?"":a,u=n.call(this,s)||this;return u.shouldThrowOutside=!1,u._detail="",u.name="SendbirdError",u.code=i,Object.setPrototypeOf(u,t.prototype),u}return w(t,n),Object.defineProperty(t.prototype,"detail",{get:function(){return this._detail},enumerable:!1,configurable:!0}),t.prototype.setDetail=function(e){this._detail=e},Object.defineProperty(t.prototype,"isInvalidTokenError",{get:function(){return this.code===Ne.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiredError",{get:function(){return this.isSessionTokenExpiredError||this.isSessionKeyExpiredError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===Ne.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===Ne.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionInvalidatedError",{get:function(){return this.isSessionRevokedError||this.isUserAuthDeactivedError||this.isUserAuthDeletedOrNotFoundError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionRevokedError",{get:function(){return this.code===Ne.SESSION_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeactivedError",{get:function(){return this.code===Ne.USER_AUTH_DEACTIVATED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeletedOrNotFoundError",{get:function(){return this.code===Ne.USER_AUTH_DELETED_OR_NOT_FOUND},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNetworkError",{get:function(){return this.code===Ne.NETWORK_ERROR||this.code===Ne.NETWORK_ROUTING_ERROR},enumerable:!1,configurable:!0}),Object.defineProperty(t,"debugModeRequired",{get:function(){return new t({code:Ne.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lostInstance",{get:function(){return new t({code:Ne.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidCommand",{get:function(){return new t({code:Ne.INVALID_COMMAND,message:"Cannot send invalid command."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"unknown",{get:function(){return new t({code:Ne.UNKNOWN_ERROR,message:"Unknown error occurred."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRenew",{get:function(){return new t({code:Ne.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidConnectionStateTransition",{get:function(){return new t({code:Ne.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"xmlHttpRequestNotSupported",{get:function(){return new t({code:Ne.XMLHTTPREQUEST_NOT_SUPPORTED,message:"Cannot upload file. XMLHttpRequest is not defined in this environment."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRequired",{get:function(){return new t({code:Ne.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionCanceled",{get:function(){return new t({code:Ne.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidParameters",{get:function(){return new t({code:Ne.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"notSupportedError",{get:function(){return new t({code:Ne.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"channelTypeNotSupportedError",{get:function(){return new t({code:Ne.NOT_SUPPORTED_ERROR,message:"Called method is not supported in the current channel's channel type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"networkError",{get:function(){return new t({code:Ne.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"markAsReadAllRateLimitExceeded",{get:function(){return new t({code:Ne.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"queryInProgress",{get:function(){return new t({code:Ne.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"noAckTimeout",{get:function(){return new t({code:Ne.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loginTimeout",{get:function(){return new t({code:Ne.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionClosed",{get:function(){return new t({code:Ne.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestFailed",{get:function(){return new t({code:Ne.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"tooManyRequests",{get:function(){return new t({code:Ne.REQUEST_DUPLICATED,message:"Too many requests."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"alreadyConnectedAsAnotherUser",{get:function(){return new t({code:Ne.REQUEST_FAILED,message:"Already logged in as a different user. Call disconnect() first."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileUploadCanceled",{get:function(){return new t({code:Ne.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestCanceled",{get:function(){return new t({code:Ne.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRefreshFailed",{get:function(){return new t({code:Ne.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRequestFailed",{get:function(){return new t({code:Ne.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseError",{get:function(){return new t({code:Ne.DATABASE_ERROR,message:"Database error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileSizeLimitExceededError",{get:function(){return new t({code:Ne.FILE_SIZE_LIMIT_EXCEEDED,message:"File size exceeds the file size limit."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"statLogUploadLimitExceededError",{get:function(){return new t({code:Ne.ERR_UPLOAD_STAT_RETRY_COUNT_EXCEEDED,message:"The upload request failed due to the retry count being exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"malformedDataError",{get:function(){return new t({code:Ne.MALFORMED_DATA,message:"Malformed data."})},enumerable:!1,configurable:!0}),t.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},t}(Error),YS=[Ne.CONNECTION_REQUIRED,Ne.NETWORK_ERROR,Ne.ACK_TIMEOUT,Ne.WEBSOCKET_CONNECTION_CLOSED,Ne.WEBSOCKET_CONNECTION_FAILED,Ne.FILE_UPLOAD_CANCEL_FAILED,Ne.REQUEST_CANCELED,Ne.INTERNAL_SERVER_ERROR,Ne.RATE_LIMIT_EXCEEDED,Ne.UNKNOWN_SERVER_ERROR,Ne.USER_DEACTIVATED,Ne.CHANNEL_IS_FROZEN,Ne.RECEIVER_USER_DEACTIVATED],QS=[Ne.WEBSOCKET_CONNECTION_CLOSED,Ne.WEBSOCKET_CONNECTION_FAILED,Ne.CONNECTION_REQUIRED,Ne.CHANNEL_IS_FROZEN],my=function(n,t){if(n!==t){var e=D({},n),r=D({},t);return(!e.hasOwnProperty("messageId")||!r.hasOwnProperty("messageId")||e.messageId===r.messageId)&&(!e.hasOwnProperty("reqId")||!r.hasOwnProperty("reqId")||e.reqId===r.reqId)&&(e.hasOwnProperty("messageId")&&delete e.messageId,e.hasOwnProperty("reqId")&&delete e.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(e)===JSON.stringify(r))}return!0},x=function(n,t,e){return e===void 0&&(e=!1),!(!e||!zo(t))||(typeof n!="string"?typeof n=="object"?_n(n,t):XS(n,t):typeof t===n)},_n=function(n,t,e){return e===void 0&&(e=!1),!(!e||!zo(t))||Object.values(n).includes(t)},XS=function(n,t){return t instanceof n},gn=function(n,t,e){return e===void 0&&(e=!1),!(!e||!zo(t))||Array.isArray(t)&&t.every(function(r){return x(n,r)})},Hm=function(n,t){return t===void 0&&(t=!1),!(!t||!zo(n))||typeof n=="number"&&n.toString().length===13},ZS=function(n){return n>0&&YS.indexOf(n)>=0},nd=function(n){return n>0&&QS.indexOf(n)>=0},Zt=function(n,t){if(t===void 0&&(t=!1),t&&zo(n))return!0;var e=typeof n=="object"&&n!==null&&n.hasOwnProperty("name")&&typeof n.name=="string"&&n.hasOwnProperty("uri")&&typeof n.uri=="string"&&n.hasOwnProperty("type")&&typeof n.type=="string";if(!e){if(typeof Blob<"u")return n instanceof Blob;if(typeof File<"u")return n instanceof File}return e},JS=function(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(var e=Be([],we(n),!1).sort(),r=Be([],we(t),!1).sort(),i=0;i<e.length;++i)if(e[i]!==r[i])return!1;return!0},zo=function(n){return n==null},_y=function(){function n(t){var e=t===void 0?{}:t,r=e.useMemberInfoInMessage,i=r===void 0||r,a=e.typingIndicatorInvalidateTime,s=a===void 0?1e4:a,u=e.typingIndicatorThrottle,o=u===void 0?1e3:u,l=e.websocketResponseTimeout,d=l===void 0?1e4:l,c=e.websocketPayloadDecompression,f=c===void 0||c,h=e.sessionTokenRefreshTimeout,m=h===void 0?60:h;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=i,this._typingIndicatorInvalidateTime=s,this._typingIndicatorThrottle=o,this._websocketResponseTimeout=d,this._sessionTokenRefreshTimeout=m,this.websocketPayloadDecompression=f}return Object.defineProperty(n.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(t){x("boolean",t)&&(this._useMemberInfoInMessage=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(t){x("number",t)&&(this._typingIndicatorInvalidateTime=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(t){x("number",t)&&t>=1e3&&t<=9e3&&(this._typingIndicatorThrottle=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(t){x("number",t)&&t>=5e3&&t<=3e4&&(this._websocketResponseTimeout=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(t){x("number",t)&&(t<60?t=60:t>1800&&(t=1800),this._sessionTokenRefreshTimeout=t)},enumerable:!1,configurable:!0}),n}(),gy={encrypt:function(n){return n},decrypt:function(n){return n}},Bm=function(){function n(t){var e=t.store;this._preference=new Map,this._store=e}return n.prototype._savePreferenceKeys=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this._store.set({key:this._keysAddress,value:Be([],we(this._preference.keys()),!1)})];case 1:return t.sent(),[2]}})})},n.prototype.init=function(t,e){var r;return e===void 0&&(e=1),y(this,void 0,void 0,function(){var i,a,s,u,o,l,d,c,f,h;return v(this,function(m){switch(m.label){case 0:return this._version=e,this._keysAddress=t,i="".concat(t,".metadata.version"),[4,this._store.get(i)];case 1:return a=m.sent(),[4,this._store.get(t)];case 2:return s=(r=m.sent())!==null&&r!==void 0?r:[],!a||a.version<this._version?[4,this._resetPreferenceData(s,i)]:[3,4];case 3:return m.sent(),[3,11];case 4:m.trys.push([4,9,10,11]),u=oe(s),o=u.next(),m.label=5;case 5:return o.done?[3,8]:(l=o.value,[4,this._store.get(l)]);case 6:(d=m.sent())&&this._preference.set(l,d),m.label=7;case 7:return o=u.next(),[3,5];case 8:return[3,11];case 9:return c=m.sent(),f={error:c},[3,11];case 10:try{o&&!o.done&&(h=u.return)&&h.call(u)}finally{if(f)throw f.error}return[7];case 11:return[2]}})})},n.prototype._resetPreferenceData=function(t,e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return this._preference=new Map,[4,this._store.removeMany(t)];case 1:return r.sent(),[4,this._store.set({key:e,value:{version:this._version}})];case 2:return r.sent(),[2]}})})},n.prototype.get=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){return[2,this._preference.get(t)]})})},n.prototype.set=function(t,e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=!this._preference.has(t),[4,this._store.set({key:t,value:e})];case 1:return i.sent(),this._preference.set(t,e),r?[4,this._savePreferenceKeys()]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},n.prototype.remove=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._store.remove(t)];case 1:return e.sent(),this._preference.delete(t),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2]}})})},n.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this._store.removeMany(Be([],we(this._preference.keys()),!1))];case 1:return t.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}})})},n}(),eT=function(){function n(t){var e=t.encryption,r=t.store,i=t.localCacheEnabled,a=t.localCacheConfig;this.store=r,this.preference=new Bm({store:r}),this.encryption=e??gy,this.localCacheEnabled=i,this.localCacheConfig=a}return n.prototype.replaceStore=function(t){this.store=t,this.preference=new Bm({store:t})},n}();(function(n){n.SUCCESS="success",n.PENDING="pending",n.ERROR="error"})(Cr||(Cr={})),function(n){n.DEFAULT="default",n.ALL="all",n.MENTION_ONLY="mention_only",n.OFF="off"}(ys||(ys={})),function(n){n.FCM="gcm",n.APNS="apns",n.UNKNOWN="unknown"}(Qt||(Qt={})),function(n){n.SESSION_TOKEN="session_token",n.ACCESS_TOKEN="access_token"}(ed||(ed={})),function(n){n.ALTERNATIVE="alternative",n.DEFAULT="default"}(Ef||(Ef={})),function(n){n.CUSTOM="custom",n.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at"}(uo||(uo={}));var td,nT=function(){function n(t){var e=t.channel,r=t.cachedMessageCount;this._cachedMessageCount=0,this._channel=e,this._cachedMessageCount=r}return Object.defineProperty(n.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cachedMessageCount",{get:function(){return this._cachedMessageCount},enumerable:!1,configurable:!0}),n}(),Ey=function(){function n(t){var e=t===void 0?{}:t,r=e.maxSize,i=r===void 0?256:r,a=e.clearOrder,s=a===void 0?uo.MESSAGE_COLLECTION_ACCESSED_AT:a,u=e.customClearOrderComparator,o=e.enableAutoResend,l=o===void 0||o;this._clearOrderComparatorUseMessageCollectionAccessedAt=function(d,c){return d.channel.messageCollectionLastAccessedAt===c.channel.messageCollectionLastAccessedAt?d.channel.lastMessage&&!c.channel.lastMessage?1:!d.channel.lastMessage&&c.channel.lastMessage?-1:d.channel.lastMessage||c.channel.lastMessage?d.channel.lastMessage.createdAt-c.channel.lastMessage.createdAt:0:d.channel.messageCollectionLastAccessedAt>c.channel.messageCollectionLastAccessedAt?1:-1},this._maxSize=Math.max(i,64),u?(this._clearOrder=s,this._customClearOrderComparator=u):this._clearOrder=uo.MESSAGE_COLLECTION_ACCESSED_AT,this._enableAutoResend=l}return Object.defineProperty(n.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clearOrder",{get:function(){return this._clearOrder},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clearOrderComparator",{get:function(){var t;return this._clearOrder===uo.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:(t=this._customClearOrderComparator)!==null&&t!==void 0?t:this._clearOrderComparatorUseMessageCollectionAccessedAt},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"enableAutoResend",{get:function(){return this._enableAutoResend},enumerable:!1,configurable:!0}),n}();(function(n){n.FEED="feed",n.CHAT="chat",n.CHAT_API="chat_api"})(td||(td={}));var wn,ui,Ai,At,ur,mu,lr,Kt,Li,Qn,Gm,vf,yf,tT=function(){function n(){this.isRefreshing=!1}return Object.defineProperty(n.prototype,"hasSession",{get:function(){return!!this.sessionKey},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasChatServicePermission",{get:function(){var t;return!!(!((t=this.services)===null||t===void 0)&&t.includes(td.CHAT))},enumerable:!1,configurable:!0}),n.prototype.clear=function(){this.authToken=void 0,this.sessionKey=void 0,this.services=[]},n}(),ba=function(){var n=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(n+16*Math.random())%16|0;return n=Math.floor(n/16),(t==="x"?e:3&e|8).toString(16)})},Vm=function(){function n(t){var e=t.container;this._container={},this._container=e,this.key=ba()}return n.prototype._register=function(t,e,r){var i;return t in this._container||(this._container[t]=new Map),(i=this._container[t])===null||i===void 0||i.set(this.key,{occurence:e,handler:r}),this},n.prototype.on=function(t,e){return this._register(t,-1,e)},n.prototype.once=function(t,e){return this._register(t,1,e)},n.prototype.close=function(){var t=this;Object.keys(this._container).forEach(function(e){var r;(r=t._container[e])===null||r===void 0||r.delete(t.key)})},n}(),Bs=function(){function n(){this._container={}}return n.prototype.on=function(t,e){return new Vm({container:this._container}).on(t,e)},n.prototype.once=function(t,e){return new Vm({container:this._container}).once(t,e)},n.prototype.dispatch=function(t,e){var r,i,a=this._container[t];if(a){var s=[];try{for(var u=oe(a.keys()),o=u.next();!o.done;o=u.next()){var l=o.value,d=a.get(l);d.handler(e),d.occurence>0&&(d.occurence--,d.occurence===0&&s.push(l))}}catch(c){r={error:c}}finally{try{o&&!o.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}s.forEach(function(c){return a.delete(c)})}},n}(),rT=function(){function n(){this._dispatcher=new Bs}return n.prototype.on=function(t){return this._dispatcher.on("event",t)},n.prototype.once=function(t){return this._dispatcher.once("event",t)},n.prototype.dispatch=function(t){this._dispatcher.dispatch("event",t)},n}(),bt=function(){},ge=function(n){var t={};return n&&Object.keys(n).forEach(function(e){n[e]===void 0||Number.isNaN(n[e])||n[e]===null||(t[e]=n[e])}),t},Re=function(n){if(n!=null){if(typeof n=="object"){if(Array.isArray(n)){for(var t=Be([],we(n),!1),e=0;e<t.length;e++)t[e]=Re(t[e]);return t}return Object.keys(n).forEach(function(r){n[r]===null&&delete n[r]}),n}return n}};(function(n){n.BASE="base",n.GROUP="group",n.OPEN="open",n.FEED="feed"})(wn||(wn={})),function(n){n.OPERATOR="operator",n.NONE="none"}(ui||(ui={})),function(n){n.MUTED="muted",n.UNMUTED="unmuted"}(Ai||(Ai={})),function(n){n.BASE="base",n.USER="user",n.FILE="file",n.ADMIN="admin"}(At||(At={})),function(n){n.ALL="",n.USER="MESG",n.FILE="FILE",n.ADMIN="ADMM"}(ur||(ur={})),function(n){n.USER="MESG",n.FILE="FILE",n.ADMIN="ADMM"}(mu||(mu={})),function(n){n.USERS="users",n.CHANNEL="channel"}(lr||(lr={})),function(n){n.ALL="all",n.NONE="none",n.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel"}(Kt||(Kt={})),function(n){n.DEFAULT="default",n.SUPPRESS="suppress"}(Li||(Li={})),function(n){n.PENDING="pending",n.SCHEDULED="scheduled",n.SUCCEEDED="succeeded",n.FAILED="failed",n.CANCELED="canceled"}(Qn||(Qn={})),function(n){n.INREVIEW="InReview",n.APPROVED="Approved"}(Gm||(Gm={})),function(n){n.HIGH="high",n.NORMAL="normal",n.LOW="low"}(vf||(vf={})),function(n){n.CREATED_AT="created_at",n.UPDATED_AT="updated_at"}(yf||(yf={}));var J,nr="v3",qn="/".concat(nr,"/users"),iT="/".concat(nr,"/sdk/users"),aT="/".concat(nr,"/storage/file"),yr="/".concat(nr,"/group_channels"),sT="/".concat(nr,"/sdk/group_channels"),Gs="/".concat(nr,"/open_channels"),uT="/".concat(nr,"/sdk/open_channels"),oT="/".concat(nr,"/search"),bf="/".concat(nr,"/report"),lT="/".concat(nr,"/emojis"),vy="/".concat(nr,"/emoji_categories"),ki="/".concat(nr,"/polls"),yy="/".concat(nr,"/scheduled_messages"),dT="/".concat(nr,"/sdk/ui_kit/configuration"),cT="/".concat(nr,"/sdk/statistics"),fT="/".concat(nr,"/sdk/statistics/notification_statistics"),by="/".concat(nr,"/message_templates"),hT="/".concat(nr,"/sdk/push_delivery"),pT="/".concat(nr,"/forms"),mT="/".concat(nr,"/report_category"),jn=function(n){switch(n){case wn.FEED:case wn.GROUP:return yr;case wn.OPEN:return Gs;default:return null}},Cy=function(n){switch(n){case wn.GROUP:return"".concat(bf,"/group_channels");case wn.OPEN:return"".concat(bf,"/open_channels");default:return null}},_u=function(n,t,e){var r,i;switch(n){case lr.CHANNEL:return!0;case lr.USERS:if(t)try{for(var a=oe(t),s=a.next();!s.done;s=a.next())if(s.value===e)return!0}catch(u){r={error:u}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}return!1},yp=function(n,t,e){var r,i,a,s,u=_u((r=n.mentionType)!==null&&r!==void 0?r:null,(i=n.mentionedUserIds)!==null&&i!==void 0?i:[],e),o=_u((a=t.mentionType)!==null&&a!==void 0?a:null,(s=t.mentionedUserIds)!==null&&s!==void 0?s:[],e);return!u&&o?1:u&&!o?-1:0},Sy=function(n,t,e){var r,i=t||new FormData;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a],u=e?"".concat(e,"[").concat(a,"]"):a;Zt(s)?i.append(u,s,(r=s.name)!==null&&r!==void 0?r:"filename"):typeof s!="object"||s===null||Array.isArray(s)||s instanceof Blob?i.append(u,String(s)):i=Sy(s,i,u)}return i};(function(n){n.GET="GET",n.POST="POST",n.PUT="PUT",n.DELETE="DELETE"})(J||(J={}));var _t,ee=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.params={},e.requireAuth=!0,e.headers={},e.requestId=ba(),e}return w(t,n),t.prototype.encodeParams=function(e){var r=this;return e==null||e===""?encodeURIComponent(""):Array.isArray(e)?e.map(function(i){return r.encodeParams(i)}).join(","):encodeURIComponent(typeof e=="object"?JSON.stringify(e):String(e))},Object.defineProperty(t.prototype,"query",{get:function(){var e=this,r=ge(this.params);return"?".concat(Object.keys(r).map(function(i){return"".concat(encodeURIComponent(i),"=").concat(e.encodeParams(r[i]))}).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){var e=ge(this.params);return Object.keys(e).some(function(r){return Zt(e[r])})?Sy(e):JSON.stringify(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSessionKey",{get:function(){return this.headers["Session-Key"]!==void 0},enumerable:!1,configurable:!0}),t}(bt),ie=function(n){function t(e,r){var i=n.call(this)||this;return i._iid=e,i._payload=r,i}return w(t,n),Object.defineProperty(t.prototype,"payload",{get:function(){return D({},this._payload)},enumerable:!1,configurable:!0}),t.prototype.as=function(e){return new e(this._iid,this.payload)},t}(bt),_T=function(n){function t(e){var r=n.call(this)||this;return r.requestId=e,r}return w(t,n),t}(bt),gu=function(n){function t(e){var r=e.expires_in,i=e.reason,a=i===void 0?Ne.SESSION_KEY_EXPIRED:i,s=e.message,u=s===void 0?"":s,o=n.call(this)||this;switch(o.expiresIn=r??0,a){case Ne.SESSION_KEY_EXPIRED:case Ne.SESSION_TOKEN_EXPIRED:case Ne.SESSION_REVOKED:case Ne.USER_AUTH_DEACTIVATED:case Ne.USER_AUTH_DELETED_OR_NOT_FOUND:o.error=new H({code:a,message:u})}return o}return w(t,n),Object.defineProperty(t.prototype,"invalidateSessionToken",{get:function(){var e;return!!(!((e=this.error)===null||e===void 0)&&e.isSessionTokenExpiredError)},enumerable:!1,configurable:!0}),t}(bt),ft=function(n){function t(e,r,i,a){a===void 0&&(a="");var s,u=this;return(u=n.call(this)||this)._iid=e,u.code=r,u.payload=i,u.requestId=(s=i.req_id)!==null&&s!==void 0?s:a,u}return w(t,n),t.createFromRawMessage=function(e,r){var i=r.substring(0,4),a={};try{a=JSON.parse(r.substring(4))}catch{i="NOOP"}finally{return new t(e,i,a)}},t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),`
`)},t.prototype.as=function(e){return new e(this._iid,this.code,this.payload)},t}(bt),or=function(n){function t(e){var r,i=e.code,a=e.ackRequired,s=e.payload,u=s===void 0?{}:s,o=this;return(o=n.call(this)||this).code=i,o.payload=u,o.requestId=(r=o.payload.req_id)!==null&&r!==void 0?r:ba(),o.ackRequired=a,o.payload.req_id=o.requestId,o}return w(t,n),t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),`
`)},t}(bt),bp=function(n){function t(e){var r=e.userId,i=e.authToken,a=e.services,s=e.expiringSession,u=s===void 0||s,o=n.call(this)||this;return o.path="".concat(qn,"/").concat(r,"/session_key"),o.method=J.POST,o.params=ge({token:i,services:a,expiring_session:!!u}),o.requireAuth=!1,o}return w(t,n),t}(ee),gT=function(n){function t(e){var r=e.authToken,i=e.expiringSession,a=i===void 0||i,s=e.requestId,u=s===void 0?void 0:s;return n.call(this,{code:"LOGI",payload:ge({token:r,expiring_session:a?1:0,req_id:u}),ackRequired:!0})||this}return w(t,n),t}(or),ET=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.key,s=r.expires_at,u=r.services;return i.key=a,i.expiresAt=s,i.services=u,i}return w(t,n),t}(ie),vT=function(n){function t(e,r,i){var a,s=this;return(s=n.call(this,e,"LOGI",i)||this).error=null,s.newKey=null,s.newKey=(a=i.new_key)!==null&&a!==void 0?a:null,s.error=i.error?new H(i):null,s}return w(t,n),t}(ft),Cp=function(n){function t(e){var r=n.call(this)||this;return r.statLog=e,r}return w(t,n),t}(bt),Ty=function(n){function t(e){var r=e.request,i=e.deferred,a=e.error,s=a===void 0?H.requestFailed:a,u=n.call(this)||this;return u.request=r,u.deferred=i,u.error=s,u}return w(t,n),t}(bt);(function(n){n.FEATURE_LOCALCACHE="feature:local_cache",n.FEATURE_LOCALCACHE_EVENT="feature:local_cache_event",n.NOTIFICATION="noti:stats",n.WEBSOCKET_CONNECT="ws:connect",n.API_RESULT="api:result"})(_t||(_t={}));var Cf,As,Fa,Mt=function(){function n(t){var e=t.type,r=t.data,i=t.ts,a=i===void 0?Date.now():i;this.type=e,this.createdAt=a,this.data=r}return n.payloadify=function(t){return ge({stat_type:t.type,ts:t.createdAt,data:ge(t.data)})},n}(),Sf=function(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product=="ReactNative"},jm=function(){return!(typeof navigator>"u"||!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent))};(function(n){n.CHAT="chat",n.CALLS="calls",n.DESK="desk",n.LIVE="live",n.UIKIT_CHAT="uikit-chat",n.UIKIT_LIVE="uikit-live"})(Cf||(Cf={})),function(n){n.ANDROID="android",n.IOS="ios",n.JS="js",n.UNREAL="unreal",n.UNITY="unity",n.REACT_NATIVE="react-native",n.FLUTTER="flutter"}(As||(As={})),function(n){n.ANDROID="android",n.IOS="ios",n.WEB="web",n.MOBILE_WEB="mobile_web",n.WINDOWS="windows"}(Fa||(Fa={}));var yT="^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",rd=function(){function n(){}return n.sendbirdSdkUserAgentWithExtension=function(t){var e=Sf()?As.REACT_NATIVE:As.JS,r={main_sdk_info:"chat/".concat(e,"/").concat(ja.SDK_VERSION),device_os_platform:jm()?"mobile-web":"web",os_version:ja.OS_VERSION};if(t){var i=t.sendbirdExtensions,a=t.deviceOS,s=t.customData,u=s===void 0?{}:s;a.version&&(r.os_version=a.version),a.platform&&(r.device_os_platform=a.platform),i.length>0&&(r.extension_sdk_info=i.map(function(o){var l=o.product,d=o.platform,c=o.version;return"".concat(l,"/").concat(d,"/").concat(c)}).join(",")),Object.keys(r).forEach(function(o){return delete u[o]}),Object.keys(u).length>0&&(r=D(D({},r),u))}return Object.entries(r).map(function(o){var l=we(o,2),d=l[0],c=l[1];return"".concat(d,"=").concat(c)}).join("&")},n.userAgentWithExtension=function(t){var e=Sf()?"reactnative":"JS",r=t.sb_syncmanager?"s".concat(t.sb_syncmanager):"",i=t.sb_uikit?"u".concat(t.sb_uikit):"",a=t["device-os-platform"]?"o".concat(t["device-os-platform"]):jm()?"omobile-web":"oweb";return"".concat(e,"/c").concat(ja.SDK_VERSION,"/").concat(r,"/").concat(i,"/").concat(a)},n}(),Tr=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=function(r){e(r)}})},id=function(n){function t(e){var r=n.call(this)||this;return r.requestId=e.requestId,r}return w(t,n),t}(bt),Ny=function(n){function t(e){var r=n.call(this)||this;return r.method=J.DELETE,r.path="".concat(jn(e.channelType),"/").concat(e.channelUrl,"/messages/").concat(e.messageId),e.messageToken&&(r.params=ge({mesg_token:e.messageToken})),r}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var Iy=function(n){function t(e,r,i){var a,s=this;return(s=n.call(this,e,"DELM",i)||this).channelUrl=i.channel_url,s.channelType=i.channel_type,s.messageId=Number(i.msg_id),s.silent=i.silent,s.messageCreatedAt=i.message_created_at?Number(i.message_created_at):-1,s.senderId=(a=i.sender_id)!==null&&a!==void 0?a:void 0,s}return w(t,n),t}(ft),bT=function(){function n(t,e){var r=e.session,i=e.sdkState,a=e.dispatcher,s=e.logger,u=e.useFetchCompat,o=u!==void 0&&u,l=this;this._abortControl=new Map,this._shouldImportFetchCompat=!1,this._iid=t,this._session=r,this._sdkState=i,this._dispatcher=a,this._dispatcher.on(function(d){d instanceof _T&&l.cancel(d.requestId)}),this._logger=s,this._shouldImportFetchCompat=o}return n.prototype._createHeader=function(t,e){var r=this._sdkState,i=r.appId,a=r.appVersion,s=r.sendbirdRuntimeEnvironment,u=D(D({},t.headers),{SendBird:"JS,".concat(ja.OS_VERSION,",").concat(ja.SDK_VERSION,",").concat(i).concat(a?",".concat(a):""),"SB-User-Agent":rd.userAgentWithExtension(this._sdkState.extensions),"Request-Sent-Timestamp":Date.now().toString(),"SB-SDK-User-Agent":rd.sendbirdSdkUserAgentWithExtension(s)});return e||(u["Content-Type"]="application/json; charset=utf-8"),t.requireAuth&&!t.hasSessionKey&&this._session.hasSession&&(u["Session-Key"]=this._session.sessionKey),u["App-Id"]=i,this._session&&this._session.authToken&&(u["Access-Token"]=this._session.authToken),u},n.prototype._statLogApiResult=function(t,e,r){t.path.includes("/sdk/statistics")||this._dispatcher.dispatch(new Cp(new Mt({type:_t.API_RESULT,data:{endpoint:t.path,method:t.method,success:!r,latency:Date.now()-e,error_code:r==null?void 0:r.code,error_description:r==null?void 0:r.message}})))},n.prototype._isBodyRequired=function(t){var e=t.method;return e!==J.GET&&(e!==J.DELETE||t instanceof Ny)},n.prototype.send=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S;return v(this,function(A){switch(A.label){case 0:e=t.path,r=t.method,i=t.uploadProgressHandler,a=this._isBodyRequired(t),s=this._sdkState.api,u="".concat(s.host).concat(e).concat(a?"":t.query),o=a?t.payload:null,l=this._createHeader(t,o instanceof FormData?o:void 0),d=new AbortController,c=d.signal,this._abortControl.set(t.requestId,d),f=Date.now(),A.label=1;case 1:return A.trys.push([1,13,,14]),i?[4,so(()=>import("./__bundle-c4e6f51b-CerIW5s9.js"),__vite__mapDeps([0,1,2,3]))]:[3,6];case 2:h=A.sent().xmlHttpRequest,A.label=3;case 3:return A.trys.push([3,5,,6]),[4,h(this._iid,{requestId:t.requestId,method:t.method,url:u,headers:l,data:o??void 0,uploadProgressHandler:i})];case 4:return m=A.sent(),this._logger.debug("receive api response",t.requestId),this._statLogApiResult(t,f),[2,m];case 5:if(!((_=A.sent())instanceof H&&_.code===Ne.XMLHTTPREQUEST_NOT_SUPPORTED))throw _;return this._logger.debug("XMLHttpRequest is not available in this environment. progressHandler is ignored."),[3,6];case 6:return this._shouldImportFetchCompat&&(this._shouldImportFetchCompat=!1,(typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{fetch:null}).fetch=null),typeof AbortController<"u"?[3,8]:[4,so(()=>import("./index-C3mMhQvi.js").then(I=>I.h),__vite__mapDeps([1,2]))];case 7:A.sent(),A.label=8;case 8:return typeof fetch=="function"?[3,10]:[4,so(()=>import("./__bundle-46d64517-HHxQgd_i.js").then(I=>I._),__vite__mapDeps([4,1,2]))];case 9:A.sent(),A.label=10;case 10:return[4,fetch(u,{method:r,body:o,headers:l,signal:c})];case 11:return[4,(E=A.sent()).json()];case 12:if(b=A.sent(),E.ok||E.redirected)return this._logger.debug("receive api response",t.requestId),this._statLogApiResult(t,f),[2,new ie(this._iid,b)];if(b){if((g=new H(b)).isSessionExpiredError){if(this._dispatcher.dispatch(new gu({reason:g.code,message:g.message})),!(t instanceof bp))return C=new Tr,this._dispatcher.dispatch(new Ty({request:t,deferred:C,error:g})),[2,C.promise];throw g}throw g.isSessionInvalidatedError&&this._dispatcher.dispatch(new gu({reason:g.code,message:g.message})),g}throw H.requestFailed;case 13:throw S=A.sent(),this._statLogApiResult(t,f,S),S instanceof H?(this._logger.debug("fail api request",S),S):(S==null?void 0:S.name)==="AbortError"?H.requestCanceled:(this._logger.debug("fail api request",S),H.networkError);case 14:return[2]}})})},n.prototype.cancel=function(t){this._abortControl.has(t)&&(this._abortControl.get(t).abort(),this._abortControl.delete(t)),this._dispatcher.dispatch(new id({requestId:t}))},n.prototype.cancelAll=function(){var t,e;try{for(var r=oe(this._abortControl.values()),i=r.next();!i.done;i=r.next())i.value.abort()}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this._abortControl.clear(),this._dispatcher.dispatch(new id({}))},n}(),tn=function(){};function Iu(n){let t=n.length;for(;--t>=0;)n[t]=0}const Sp=256,Ay=286,oo=30,lo=15,Tf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Pl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),CT=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),qm=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),oa=new Array(576);Iu(oa);const co=new Array(60);Iu(co);const Oo=new Array(512);Iu(Oo);const fo=new Array(256);Iu(fo);const Tp=new Array(29);Iu(Tp);const ad=new Array(oo);function Ec(n,t,e,r,i){this.static_tree=n,this.extra_bits=t,this.extra_base=e,this.elems=r,this.max_length=i,this.has_stree=n&&n.length}let zm,Km,$m;function vc(n,t){this.dyn_tree=n,this.max_code=0,this.stat_desc=t}Iu(ad);const My=n=>n<256?Oo[n]:Oo[256+(n>>>7)],Ro=(n,t)=>{n.pending_buf[n.pending++]=255&t,n.pending_buf[n.pending++]=t>>>8&255},qr=(n,t,e)=>{n.bi_valid>16-e?(n.bi_buf|=t<<n.bi_valid&65535,Ro(n,n.bi_buf),n.bi_buf=t>>16-n.bi_valid,n.bi_valid+=e-16):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=e)},Vi=(n,t,e)=>{qr(n,e[2*t],e[2*t+1])},wy=(n,t)=>{let e=0;do e|=1&n,n>>>=1,e<<=1;while(--t>0);return e>>>1},Oy=(n,t,e)=>{const r=new Array(16);let i,a,s=0;for(i=1;i<=lo;i++)s=s+e[i-1]<<1,r[i]=s;for(a=0;a<=t;a++){let u=n[2*a+1];u!==0&&(n[2*a]=wy(r[u]++,u))}},Ry=n=>{let t;for(t=0;t<Ay;t++)n.dyn_ltree[2*t]=0;for(t=0;t<oo;t++)n.dyn_dtree[2*t]=0;for(t=0;t<19;t++)n.bl_tree[2*t]=0;n.dyn_ltree[512]=1,n.opt_len=n.static_len=0,n.sym_next=n.matches=0},Dy=n=>{n.bi_valid>8?Ro(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},Wm=(n,t,e,r)=>{const i=2*t,a=2*e;return n[i]<n[a]||n[i]===n[a]&&r[t]<=r[e]},yc=(n,t,e)=>{const r=n.heap[e];let i=e<<1;for(;i<=n.heap_len&&(i<n.heap_len&&Wm(t,n.heap[i+1],n.heap[i],n.depth)&&i++,!Wm(t,r,n.heap[i],n.depth));)n.heap[e]=n.heap[i],e=i,i<<=1;n.heap[e]=r},Ym=(n,t,e)=>{let r,i,a,s,u=0;if(n.sym_next!==0)do r=255&n.pending_buf[n.sym_buf+u++],r+=(255&n.pending_buf[n.sym_buf+u++])<<8,i=n.pending_buf[n.sym_buf+u++],r===0?Vi(n,i,t):(a=fo[i],Vi(n,a+Sp+1,t),s=Tf[a],s!==0&&(i-=Tp[a],qr(n,i,s)),r--,a=My(r),Vi(n,a,e),s=Pl[a],s!==0&&(r-=ad[a],qr(n,r,s)));while(u<n.sym_next);Vi(n,256,t)},bc=(n,t)=>{const e=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let s,u,o,l=-1;for(n.heap_len=0,n.heap_max=573,s=0;s<a;s++)e[2*s]!==0?(n.heap[++n.heap_len]=l=s,n.depth[s]=0):e[2*s+1]=0;for(;n.heap_len<2;)o=n.heap[++n.heap_len]=l<2?++l:0,e[2*o]=1,n.depth[o]=0,n.opt_len--,i&&(n.static_len-=r[2*o+1]);for(t.max_code=l,s=n.heap_len>>1;s>=1;s--)yc(n,e,s);o=a;do s=n.heap[1],n.heap[1]=n.heap[n.heap_len--],yc(n,e,1),u=n.heap[1],n.heap[--n.heap_max]=s,n.heap[--n.heap_max]=u,e[2*o]=e[2*s]+e[2*u],n.depth[o]=(n.depth[s]>=n.depth[u]?n.depth[s]:n.depth[u])+1,e[2*s+1]=e[2*u+1]=o,n.heap[1]=o++,yc(n,e,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],((d,c)=>{const f=c.dyn_tree,h=c.max_code,m=c.stat_desc.static_tree,_=c.stat_desc.has_stree,E=c.stat_desc.extra_bits,b=c.stat_desc.extra_base,g=c.stat_desc.max_length;let C,S,A,I,T,M,O=0;for(I=0;I<=lo;I++)d.bl_count[I]=0;for(f[2*d.heap[d.heap_max]+1]=0,C=d.heap_max+1;C<573;C++)S=d.heap[C],I=f[2*f[2*S+1]+1]+1,I>g&&(I=g,O++),f[2*S+1]=I,S>h||(d.bl_count[I]++,T=0,S>=b&&(T=E[S-b]),M=f[2*S],d.opt_len+=M*(I+T),_&&(d.static_len+=M*(m[2*S+1]+T)));if(O!==0){do{for(I=g-1;d.bl_count[I]===0;)I--;d.bl_count[I]--,d.bl_count[I+1]+=2,d.bl_count[g]--,O-=2}while(O>0);for(I=g;I!==0;I--)for(S=d.bl_count[I];S!==0;)A=d.heap[--C],A>h||(f[2*A+1]!==I&&(d.opt_len+=(I-f[2*A+1])*f[2*A],f[2*A+1]=I),S--)}})(n,t),Oy(e,l,n.bl_count)},Qm=(n,t,e)=>{let r,i,a=-1,s=t[1],u=0,o=7,l=4;for(s===0&&(o=138,l=3),t[2*(e+1)+1]=65535,r=0;r<=e;r++)i=s,s=t[2*(r+1)+1],++u<o&&i===s||(u<l?n.bl_tree[2*i]+=u:i!==0?(i!==a&&n.bl_tree[2*i]++,n.bl_tree[32]++):u<=10?n.bl_tree[34]++:n.bl_tree[36]++,u=0,a=i,s===0?(o=138,l=3):i===s?(o=6,l=3):(o=7,l=4))},Xm=(n,t,e)=>{let r,i,a=-1,s=t[1],u=0,o=7,l=4;for(s===0&&(o=138,l=3),r=0;r<=e;r++)if(i=s,s=t[2*(r+1)+1],!(++u<o&&i===s)){if(u<l)do Vi(n,i,n.bl_tree);while(--u!=0);else i!==0?(i!==a&&(Vi(n,i,n.bl_tree),u--),Vi(n,16,n.bl_tree),qr(n,u-3,2)):u<=10?(Vi(n,17,n.bl_tree),qr(n,u-3,3)):(Vi(n,18,n.bl_tree),qr(n,u-11,7));u=0,a=i,s===0?(o=138,l=3):i===s?(o=6,l=3):(o=7,l=4)}};let Zm=!1;const Ly=(n,t,e,r)=>{qr(n,0+(r?1:0),3),Dy(n),Ro(n,e),Ro(n,~e),e&&n.pending_buf.set(n.window.subarray(t,t+e),n.pending),n.pending+=e};var ST=(n,t,e,r)=>{let i,a,s=0;n.level>0?(n.strm.data_type===2&&(n.strm.data_type=(u=>{let o,l=4093624447;for(o=0;o<=31;o++,l>>>=1)if(1&l&&u.dyn_ltree[2*o]!==0)return 0;if(u.dyn_ltree[18]!==0||u.dyn_ltree[20]!==0||u.dyn_ltree[26]!==0)return 1;for(o=32;o<Sp;o++)if(u.dyn_ltree[2*o]!==0)return 1;return 0})(n)),bc(n,n.l_desc),bc(n,n.d_desc),s=(u=>{let o;for(Qm(u,u.dyn_ltree,u.l_desc.max_code),Qm(u,u.dyn_dtree,u.d_desc.max_code),bc(u,u.bl_desc),o=18;o>=3&&u.bl_tree[2*qm[o]+1]===0;o--);return u.opt_len+=3*(o+1)+5+5+4,o})(n),i=n.opt_len+3+7>>>3,a=n.static_len+3+7>>>3,a<=i&&(i=a)):i=a=e+5,e+4<=i&&t!==-1?Ly(n,t,e,r):n.strategy===4||a===i?(qr(n,2+(r?1:0),3),Ym(n,oa,co)):(qr(n,4+(r?1:0),3),((u,o,l,d)=>{let c;for(qr(u,o-257,5),qr(u,l-1,5),qr(u,d-4,4),c=0;c<d;c++)qr(u,u.bl_tree[2*qm[c]+1],3);Xm(u,u.dyn_ltree,o-1),Xm(u,u.dyn_dtree,l-1)})(n,n.l_desc.max_code+1,n.d_desc.max_code+1,s+1),Ym(n,n.dyn_ltree,n.dyn_dtree)),Ry(n),r&&Dy(n)},TT={_tr_init:n=>{Zm||((()=>{let t,e,r,i,a;const s=new Array(16);for(r=0,i=0;i<28;i++)for(Tp[i]=r,t=0;t<1<<Tf[i];t++)fo[r++]=i;for(fo[r-1]=i,a=0,i=0;i<16;i++)for(ad[i]=a,t=0;t<1<<Pl[i];t++)Oo[a++]=i;for(a>>=7;i<oo;i++)for(ad[i]=a<<7,t=0;t<1<<Pl[i]-7;t++)Oo[256+a++]=i;for(e=0;e<=lo;e++)s[e]=0;for(t=0;t<=143;)oa[2*t+1]=8,t++,s[8]++;for(;t<=255;)oa[2*t+1]=9,t++,s[9]++;for(;t<=279;)oa[2*t+1]=7,t++,s[7]++;for(;t<=287;)oa[2*t+1]=8,t++,s[8]++;for(Oy(oa,287,s),t=0;t<oo;t++)co[2*t+1]=5,co[2*t]=wy(t,5);zm=new Ec(oa,Tf,257,Ay,lo),Km=new Ec(co,Pl,0,oo,lo),$m=new Ec(new Array(0),CT,0,19,7)})(),Zm=!0),n.l_desc=new vc(n.dyn_ltree,zm),n.d_desc=new vc(n.dyn_dtree,Km),n.bl_desc=new vc(n.bl_tree,$m),n.bi_buf=0,n.bi_valid=0,Ry(n)},_tr_stored_block:Ly,_tr_flush_block:ST,_tr_tally:(n,t,e)=>(n.pending_buf[n.sym_buf+n.sym_next++]=t,n.pending_buf[n.sym_buf+n.sym_next++]=t>>8,n.pending_buf[n.sym_buf+n.sym_next++]=e,t===0?n.dyn_ltree[2*e]++:(n.matches++,t--,n.dyn_ltree[2*(fo[e]+Sp+1)]++,n.dyn_dtree[2*My(t)]++),n.sym_next===n.sym_end),_tr_align:n=>{qr(n,2,3),Vi(n,256,oa),(t=>{t.bi_valid===16?(Ro(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(n)}},ho=(n,t,e,r)=>{let i=65535&n,a=n>>>16&65535,s=0;for(;e!==0;){s=e>2e3?2e3:e,e-=s;do i=i+t[r++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16};const NT=new Uint32Array((()=>{let n,t=[];for(var e=0;e<256;e++){n=e;for(var r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t})());var ar=(n,t,e,r)=>{const i=NT,a=r+e;n^=-1;for(let s=r;s<a;s++)n=n>>>8^i[255&(n^t[s])];return~n},Ls={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Vs={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:IT,_tr_stored_block:Nf,_tr_flush_block:AT,_tr_tally:qa,_tr_align:MT}=TT,{Z_NO_FLUSH:za,Z_PARTIAL_FLUSH:wT,Z_FULL_FLUSH:OT,Z_FINISH:mi,Z_BLOCK:Jm,Z_OK:fr,Z_STREAM_END:e_,Z_STREAM_ERROR:Pi,Z_DATA_ERROR:RT,Z_BUF_ERROR:Cc,Z_DEFAULT_COMPRESSION:DT,Z_FILTERED:LT,Z_HUFFMAN_ONLY:ol,Z_RLE:UT,Z_FIXED:kT,Z_DEFAULT_STRATEGY:xT,Z_UNKNOWN:PT,Z_DEFLATED:sd}=Vs,bs=258,Wi=262,cu=42,cs=113,Ju=666,fs=(n,t)=>(n.msg=Ls[t],t),n_=n=>2*n-(n>4?9:0),xa=n=>{let t=n.length;for(;--t>=0;)n[t]=0},FT=n=>{let t,e,r,i=n.w_size;t=n.hash_size,r=t;do e=n.head[--r],n.head[r]=e>=i?e-i:0;while(--t);t=i,r=t;do e=n.prev[--r],n.prev[r]=e>=i?e-i:0;while(--t)};let Ka=(n,t,e)=>(t<<n.hash_shift^e)&n.hash_mask;const Zr=n=>{const t=n.state;let e=t.pending;e>n.avail_out&&(e=n.avail_out),e!==0&&(n.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),n.next_out),n.next_out+=e,t.pending_out+=e,n.total_out+=e,n.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},ri=(n,t)=>{AT(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t),n.block_start=n.strstart,Zr(n.strm)},pt=(n,t)=>{n.pending_buf[n.pending++]=t},ku=(n,t)=>{n.pending_buf[n.pending++]=t>>>8&255,n.pending_buf[n.pending++]=255&t},If=(n,t,e,r)=>{let i=n.avail_in;return i>r&&(i=r),i===0?0:(n.avail_in-=i,t.set(n.input.subarray(n.next_in,n.next_in+i),e),n.state.wrap===1?n.adler=ho(n.adler,t,i,e):n.state.wrap===2&&(n.adler=ar(n.adler,t,i,e)),n.next_in+=i,n.total_in+=i,i)},Uy=(n,t)=>{let e,r,i=n.max_chain_length,a=n.strstart,s=n.prev_length,u=n.nice_match;const o=n.strstart>n.w_size-Wi?n.strstart-(n.w_size-Wi):0,l=n.window,d=n.w_mask,c=n.prev,f=n.strstart+bs;let h=l[a+s-1],m=l[a+s];n.prev_length>=n.good_match&&(i>>=2),u>n.lookahead&&(u=n.lookahead);do if(e=t,l[e+s]===m&&l[e+s-1]===h&&l[e]===l[a]&&l[++e]===l[a+1]){a+=2,e++;do;while(l[++a]===l[++e]&&l[++a]===l[++e]&&l[++a]===l[++e]&&l[++a]===l[++e]&&l[++a]===l[++e]&&l[++a]===l[++e]&&l[++a]===l[++e]&&l[++a]===l[++e]&&a<f);if(r=bs-(f-a),a=f-bs,r>s){if(n.match_start=t,s=r,r>=u)break;h=l[a+s-1],m=l[a+s]}}while((t=c[t&d])>o&&--i!=0);return s<=n.lookahead?s:n.lookahead},lu=n=>{const t=n.w_size;let e,r,i;do{if(r=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-Wi)&&(n.window.set(n.window.subarray(t,t+t-r),0),n.match_start-=t,n.strstart-=t,n.block_start-=t,n.insert>n.strstart&&(n.insert=n.strstart),FT(n),r+=t),n.strm.avail_in===0)break;if(e=If(n.strm,n.window,n.strstart+n.lookahead,r),n.lookahead+=e,n.lookahead+n.insert>=3)for(i=n.strstart-n.insert,n.ins_h=n.window[i],n.ins_h=Ka(n,n.ins_h,n.window[i+1]);n.insert&&(n.ins_h=Ka(n,n.ins_h,n.window[i+3-1]),n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,n.insert--,!(n.lookahead+n.insert<3)););}while(n.lookahead<Wi&&n.strm.avail_in!==0)},ky=(n,t)=>{let e,r,i,a=n.pending_buf_size-5>n.w_size?n.w_size:n.pending_buf_size-5,s=0,u=n.strm.avail_in;do{if(e=65535,i=n.bi_valid+42>>3,n.strm.avail_out<i||(i=n.strm.avail_out-i,r=n.strstart-n.block_start,e>r+n.strm.avail_in&&(e=r+n.strm.avail_in),e>i&&(e=i),e<a&&(e===0&&t!==mi||t===za||e!==r+n.strm.avail_in)))break;s=t===mi&&e===r+n.strm.avail_in?1:0,Nf(n,0,0,s),n.pending_buf[n.pending-4]=e,n.pending_buf[n.pending-3]=e>>8,n.pending_buf[n.pending-2]=~e,n.pending_buf[n.pending-1]=~e>>8,Zr(n.strm),r&&(r>e&&(r=e),n.strm.output.set(n.window.subarray(n.block_start,n.block_start+r),n.strm.next_out),n.strm.next_out+=r,n.strm.avail_out-=r,n.strm.total_out+=r,n.block_start+=r,e-=r),e&&(If(n.strm,n.strm.output,n.strm.next_out,e),n.strm.next_out+=e,n.strm.avail_out-=e,n.strm.total_out+=e)}while(s===0);return u-=n.strm.avail_in,u&&(u>=n.w_size?(n.matches=2,n.window.set(n.strm.input.subarray(n.strm.next_in-n.w_size,n.strm.next_in),0),n.strstart=n.w_size,n.insert=n.strstart):(n.window_size-n.strstart<=u&&(n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,n.insert>n.strstart&&(n.insert=n.strstart)),n.window.set(n.strm.input.subarray(n.strm.next_in-u,n.strm.next_in),n.strstart),n.strstart+=u,n.insert+=u>n.w_size-n.insert?n.w_size-n.insert:u),n.block_start=n.strstart),n.high_water<n.strstart&&(n.high_water=n.strstart),s?4:t!==za&&t!==mi&&n.strm.avail_in===0&&n.strstart===n.block_start?2:(i=n.window_size-n.strstart,n.strm.avail_in>i&&n.block_start>=n.w_size&&(n.block_start-=n.w_size,n.strstart-=n.w_size,n.window.set(n.window.subarray(n.w_size,n.w_size+n.strstart),0),n.matches<2&&n.matches++,i+=n.w_size,n.insert>n.strstart&&(n.insert=n.strstart)),i>n.strm.avail_in&&(i=n.strm.avail_in),i&&(If(n.strm,n.window,n.strstart,i),n.strstart+=i,n.insert+=i>n.w_size-n.insert?n.w_size-n.insert:i),n.high_water<n.strstart&&(n.high_water=n.strstart),i=n.bi_valid+42>>3,i=n.pending_buf_size-i>65535?65535:n.pending_buf_size-i,a=i>n.w_size?n.w_size:i,r=n.strstart-n.block_start,(r>=a||(r||t===mi)&&t!==za&&n.strm.avail_in===0&&r<=i)&&(e=r>i?i:r,s=t===mi&&n.strm.avail_in===0&&e===r?1:0,Nf(n,n.block_start,e,s),n.block_start+=e,Zr(n.strm)),s?3:1)},Sc=(n,t)=>{let e,r;for(;;){if(n.lookahead<Wi){if(lu(n),n.lookahead<Wi&&t===za)return 1;if(n.lookahead===0)break}if(e=0,n.lookahead>=3&&(n.ins_h=Ka(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),e!==0&&n.strstart-e<=n.w_size-Wi&&(n.match_length=Uy(n,e)),n.match_length>=3)if(r=qa(n,n.strstart-n.match_start,n.match_length-3),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=3){n.match_length--;do n.strstart++,n.ins_h=Ka(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!=0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=Ka(n,n.ins_h,n.window[n.strstart+1]);else r=qa(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(r&&(ri(n,!1),n.strm.avail_out===0))return 1}return n.insert=n.strstart<2?n.strstart:2,t===mi?(ri(n,!0),n.strm.avail_out===0?3:4):n.sym_next&&(ri(n,!1),n.strm.avail_out===0)?1:2},Qs=(n,t)=>{let e,r,i;for(;;){if(n.lookahead<Wi){if(lu(n),n.lookahead<Wi&&t===za)return 1;if(n.lookahead===0)break}if(e=0,n.lookahead>=3&&(n.ins_h=Ka(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=2,e!==0&&n.prev_length<n.max_lazy_match&&n.strstart-e<=n.w_size-Wi&&(n.match_length=Uy(n,e),n.match_length<=5&&(n.strategy===LT||n.match_length===3&&n.strstart-n.match_start>4096)&&(n.match_length=2)),n.prev_length>=3&&n.match_length<=n.prev_length){i=n.strstart+n.lookahead-3,r=qa(n,n.strstart-1-n.prev_match,n.prev_length-3),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=i&&(n.ins_h=Ka(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!=0);if(n.match_available=0,n.match_length=2,n.strstart++,r&&(ri(n,!1),n.strm.avail_out===0))return 1}else if(n.match_available){if(r=qa(n,0,n.window[n.strstart-1]),r&&ri(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return 1}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(r=qa(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<2?n.strstart:2,t===mi?(ri(n,!0),n.strm.avail_out===0?3:4):n.sym_next&&(ri(n,!1),n.strm.avail_out===0)?1:2};function xi(n,t,e,r,i){this.good_length=n,this.max_lazy=t,this.nice_length=e,this.max_chain=r,this.func=i}const eo=[new xi(0,0,0,0,ky),new xi(4,4,8,4,Sc),new xi(4,5,16,8,Sc),new xi(4,6,32,32,Sc),new xi(4,4,16,16,Qs),new xi(8,16,32,32,Qs),new xi(8,16,128,128,Qs),new xi(8,32,128,256,Qs),new xi(32,128,258,1024,Qs),new xi(32,258,258,4096,Qs)];function HT(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=sd,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),xa(this.dyn_ltree),xa(this.dyn_dtree),xa(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),xa(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),xa(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const no=n=>{if(!n)return 1;const t=n.state;return!t||t.strm!==n||t.status!==cu&&t.status!==57&&t.status!==69&&t.status!==73&&t.status!==91&&t.status!==103&&t.status!==cs&&t.status!==Ju?1:0},xy=n=>{if(no(n))return fs(n,Pi);n.total_in=n.total_out=0,n.data_type=PT;const t=n.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?57:t.wrap?cu:cs,n.adler=t.wrap===2?0:1,t.last_flush=-2,IT(t),fr},Py=n=>{const t=xy(n);var e;return t===fr&&((e=n.state).window_size=2*e.w_size,xa(e.head),e.max_lazy_match=eo[e.level].max_lazy,e.good_match=eo[e.level].good_length,e.nice_match=eo[e.level].nice_length,e.max_chain_length=eo[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),t},t_=(n,t,e,r,i,a)=>{if(!n)return Pi;let s=1;if(t===DT&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>9||e!==sd||r<8||r>15||t<0||t>9||a<0||a>kT||r===8&&s!==1)return fs(n,Pi);r===8&&(r=9);const u=new HT;return n.state=u,u.strm=n,u.status=cu,u.wrap=s,u.gzhead=null,u.w_bits=r,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=i+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new Uint8Array(2*u.w_size),u.head=new Uint16Array(u.hash_size),u.prev=new Uint16Array(u.w_size),u.lit_bufsize=1<<i+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new Uint8Array(u.pending_buf_size),u.sym_buf=u.lit_bufsize,u.sym_end=3*(u.lit_bufsize-1),u.level=t,u.strategy=a,u.method=e,Py(n)};var po={deflateInit:(n,t)=>t_(n,t,sd,15,8,xT),deflateInit2:t_,deflateReset:Py,deflateResetKeep:xy,deflateSetHeader:(n,t)=>no(n)||n.state.wrap!==2?Pi:(n.state.gzhead=t,fr),deflate:(n,t)=>{if(no(n)||t>Jm||t<0)return n?fs(n,Pi):Pi;const e=n.state;if(!n.output||n.avail_in!==0&&!n.input||e.status===Ju&&t!==mi)return fs(n,n.avail_out===0?Cc:Pi);const r=e.last_flush;if(e.last_flush=t,e.pending!==0){if(Zr(n),n.avail_out===0)return e.last_flush=-1,fr}else if(n.avail_in===0&&n_(t)<=n_(r)&&t!==mi)return fs(n,Cc);if(e.status===Ju&&n.avail_in!==0)return fs(n,Cc);if(e.status===cu&&e.wrap===0&&(e.status=cs),e.status===cu){let i=sd+(e.w_bits-8<<4)<<8,a=-1;if(a=e.strategy>=ol||e.level<2?0:e.level<6?1:e.level===6?2:3,i|=a<<6,e.strstart!==0&&(i|=32),i+=31-i%31,ku(e,i),e.strstart!==0&&(ku(e,n.adler>>>16),ku(e,65535&n.adler)),n.adler=1,e.status=cs,Zr(n),e.pending!==0)return e.last_flush=-1,fr}if(e.status===57){if(n.adler=0,pt(e,31),pt(e,139),pt(e,8),e.gzhead)pt(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),pt(e,255&e.gzhead.time),pt(e,e.gzhead.time>>8&255),pt(e,e.gzhead.time>>16&255),pt(e,e.gzhead.time>>24&255),pt(e,e.level===9?2:e.strategy>=ol||e.level<2?4:0),pt(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(pt(e,255&e.gzhead.extra.length),pt(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(n.adler=ar(n.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69;else if(pt(e,0),pt(e,0),pt(e,0),pt(e,0),pt(e,0),pt(e,e.level===9?2:e.strategy>=ol||e.level<2?4:0),pt(e,3),e.status=cs,Zr(n),e.pending!==0)return e.last_flush=-1,fr}if(e.status===69){if(e.gzhead.extra){let i=e.pending,a=(65535&e.gzhead.extra.length)-e.gzindex;for(;e.pending+a>e.pending_buf_size;){let u=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+u),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>i&&(n.adler=ar(n.adler,e.pending_buf,e.pending-i,i)),e.gzindex+=u,Zr(n),e.pending!==0)return e.last_flush=-1,fr;i=0,a-=u}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending+=a,e.gzhead.hcrc&&e.pending>i&&(n.adler=ar(n.adler,e.pending_buf,e.pending-i,i)),e.gzindex=0}e.status=73}if(e.status===73){if(e.gzhead.name){let i,a=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>a&&(n.adler=ar(n.adler,e.pending_buf,e.pending-a,a)),Zr(n),e.pending!==0)return e.last_flush=-1,fr;a=0}i=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,pt(e,i)}while(i!==0);e.gzhead.hcrc&&e.pending>a&&(n.adler=ar(n.adler,e.pending_buf,e.pending-a,a)),e.gzindex=0}e.status=91}if(e.status===91){if(e.gzhead.comment){let i,a=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>a&&(n.adler=ar(n.adler,e.pending_buf,e.pending-a,a)),Zr(n),e.pending!==0)return e.last_flush=-1,fr;a=0}i=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,pt(e,i)}while(i!==0);e.gzhead.hcrc&&e.pending>a&&(n.adler=ar(n.adler,e.pending_buf,e.pending-a,a))}e.status=103}if(e.status===103){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(Zr(n),e.pending!==0))return e.last_flush=-1,fr;pt(e,255&n.adler),pt(e,n.adler>>8&255),n.adler=0}if(e.status=cs,Zr(n),e.pending!==0)return e.last_flush=-1,fr}if(n.avail_in!==0||e.lookahead!==0||t!==za&&e.status!==Ju){let i=e.level===0?ky(e,t):e.strategy===ol?((a,s)=>{let u;for(;;){if(a.lookahead===0&&(lu(a),a.lookahead===0)){if(s===za)return 1;break}if(a.match_length=0,u=qa(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,u&&(ri(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,s===mi?(ri(a,!0),a.strm.avail_out===0?3:4):a.sym_next&&(ri(a,!1),a.strm.avail_out===0)?1:2})(e,t):e.strategy===UT?((a,s)=>{let u,o,l,d;const c=a.window;for(;;){if(a.lookahead<=bs){if(lu(a),a.lookahead<=bs&&s===za)return 1;if(a.lookahead===0)break}if(a.match_length=0,a.lookahead>=3&&a.strstart>0&&(l=a.strstart-1,o=c[l],o===c[++l]&&o===c[++l]&&o===c[++l])){d=a.strstart+bs;do;while(o===c[++l]&&o===c[++l]&&o===c[++l]&&o===c[++l]&&o===c[++l]&&o===c[++l]&&o===c[++l]&&o===c[++l]&&l<d);a.match_length=bs-(d-l),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=3?(u=qa(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(u=qa(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),u&&(ri(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,s===mi?(ri(a,!0),a.strm.avail_out===0?3:4):a.sym_next&&(ri(a,!1),a.strm.avail_out===0)?1:2})(e,t):eo[e.level].func(e,t);if(i!==3&&i!==4||(e.status=Ju),i===1||i===3)return n.avail_out===0&&(e.last_flush=-1),fr;if(i===2&&(t===wT?MT(e):t!==Jm&&(Nf(e,0,0,!1),t===OT&&(xa(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),Zr(n),n.avail_out===0))return e.last_flush=-1,fr}return t!==mi?fr:e.wrap<=0?e_:(e.wrap===2?(pt(e,255&n.adler),pt(e,n.adler>>8&255),pt(e,n.adler>>16&255),pt(e,n.adler>>24&255),pt(e,255&n.total_in),pt(e,n.total_in>>8&255),pt(e,n.total_in>>16&255),pt(e,n.total_in>>24&255)):(ku(e,n.adler>>>16),ku(e,65535&n.adler)),Zr(n),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?fr:e_)},deflateEnd:n=>{if(no(n))return Pi;const t=n.state.status;return n.state=null,t===cs?fs(n,RT):fr},deflateSetDictionary:(n,t)=>{let e=t.length;if(no(n))return Pi;const r=n.state,i=r.wrap;if(i===2||i===1&&r.status!==cu||r.lookahead)return Pi;if(i===1&&(n.adler=ho(n.adler,t,e,0)),r.wrap=0,e>=r.w_size){i===0&&(xa(r.head),r.strstart=0,r.block_start=0,r.insert=0);let o=new Uint8Array(r.w_size);o.set(t.subarray(e-r.w_size,e),0),t=o,e=r.w_size}const a=n.avail_in,s=n.next_in,u=n.input;for(n.avail_in=e,n.next_in=0,n.input=t,lu(r);r.lookahead>=3;){let o=r.strstart,l=r.lookahead-2;do r.ins_h=Ka(r,r.ins_h,r.window[o+3-1]),r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++;while(--l);r.strstart=o,r.lookahead=2,lu(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,n.next_in=s,n.input=u,n.avail_in=a,r.wrap=i,fr},deflateInfo:"pako deflate (from Nodeca project)"};const BT=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var Fy=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const r in e)BT(e,r)&&(n[r]=e[r])}}return n},Hy=n=>{let t=0;for(let r=0,i=n.length;r<i;r++)t+=n[r].length;const e=new Uint8Array(t);for(let r=0,i=0,a=n.length;r<a;r++){let s=n[r];e.set(s,i),i+=s.length}return e};let By=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{By=!1}const Do=new Uint8Array(256);for(let n=0;n<256;n++)Do[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Do[254]=Do[254]=1;var Np=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let t,e,r,i,a,s=n.length,u=0;for(i=0;i<s;i++)e=n.charCodeAt(i),(64512&e)==55296&&i+1<s&&(r=n.charCodeAt(i+1),(64512&r)==56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),u+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(u),a=0,i=0;a<u;i++)e=n.charCodeAt(i),(64512&e)==55296&&i+1<s&&(r=n.charCodeAt(i+1),(64512&r)==56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),e<128?t[a++]=e:e<2048?(t[a++]=192|e>>>6,t[a++]=128|63&e):e<65536?(t[a++]=224|e>>>12,t[a++]=128|e>>>6&63,t[a++]=128|63&e):(t[a++]=240|e>>>18,t[a++]=128|e>>>12&63,t[a++]=128|e>>>6&63,t[a++]=128|63&e);return t},GT=(n,t)=>{const e=t||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,t));let r,i;const a=new Array(2*e);for(i=0,r=0;r<e;){let s=n[r++];if(s<128){a[i++]=s;continue}let u=Do[s];if(u>4)a[i++]=65533,r+=u-1;else{for(s&=u===2?31:u===3?15:7;u>1&&r<e;)s=s<<6|63&n[r++],u--;u>1?a[i++]=65533:s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|1023&s)}}return((s,u)=>{if(u<65534&&s.subarray&&By)return String.fromCharCode.apply(null,s.length===u?s:s.subarray(0,u));let o="";for(let l=0;l<u;l++)o+=String.fromCharCode(s[l]);return o})(a,i)},VT=(n,t)=>{(t=t||n.length)>n.length&&(t=n.length);let e=t-1;for(;e>=0&&(192&n[e])==128;)e--;return e<0||e===0?t:e+Do[n[e]]>t?e:t},Gy=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Vy=Object.prototype.toString,{Z_NO_FLUSH:jT,Z_SYNC_FLUSH:qT,Z_FULL_FLUSH:zT,Z_FINISH:KT,Z_OK:ud,Z_STREAM_END:$T,Z_DEFAULT_COMPRESSION:WT,Z_DEFAULT_STRATEGY:YT,Z_DEFLATED:QT}=Vs;function mo(n){this.options=Fy({level:WT,method:QT,chunkSize:16384,windowBits:15,memLevel:8,strategy:YT},n||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gy,this.strm.avail_out=0;let e=po.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==ud)throw new Error(Ls[e]);if(t.header&&po.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(r=typeof t.dictionary=="string"?Np(t.dictionary):Vy.call(t.dictionary)==="[object ArrayBuffer]"?new Uint8Array(t.dictionary):t.dictionary,e=po.deflateSetDictionary(this.strm,r),e!==ud)throw new Error(Ls[e]);this._dict_set=!0}}function Tc(n,t){const e=new mo(t);if(e.push(n,!0),e.err)throw e.msg||Ls[e.err];return e.result}mo.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(a=t===~~t?t:t===!0?KT:jT,typeof n=="string"?e.input=Np(n):Vy.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;)if(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),(a===qT||a===zT)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(i=po.deflate(e,a),i===$T)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),i=po.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===ud;if(e.avail_out!==0){if(a>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(e.avail_in===0)break}else this.onData(e.output)}return!0},mo.prototype.onData=function(n){this.chunks.push(n)},mo.prototype.onEnd=function(n){n===ud&&(this.result=Hy(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var XT={Deflate:mo,deflate:Tc,deflateRaw:function(n,t){return(t=t||{}).raw=!0,Tc(n,t)},gzip:function(n,t){return(t=t||{}).gzip=!0,Tc(n,t)},constants:Vs};const ll=16209;var ZT=function(n,t){let e,r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O;const R=n.state;e=n.next_in,M=n.input,r=e+(n.avail_in-5),i=n.next_out,O=n.output,a=i-(t-n.avail_out),s=i+(n.avail_out-257),u=R.dmax,o=R.wsize,l=R.whave,d=R.wnext,c=R.window,f=R.hold,h=R.bits,m=R.lencode,_=R.distcode,E=(1<<R.lenbits)-1,b=(1<<R.distbits)-1;e:do{h<15&&(f+=M[e++]<<h,h+=8,f+=M[e++]<<h,h+=8),g=m[f&E];n:for(;;){if(C=g>>>24,f>>>=C,h-=C,C=g>>>16&255,C===0)O[i++]=65535&g;else{if(!(16&C)){if(64&C){if(32&C){R.mode=16191;break e}n.msg="invalid literal/length code",R.mode=ll;break e}g=m[(65535&g)+(f&(1<<C)-1)];continue n}for(S=65535&g,C&=15,C&&(h<C&&(f+=M[e++]<<h,h+=8),S+=f&(1<<C)-1,f>>>=C,h-=C),h<15&&(f+=M[e++]<<h,h+=8,f+=M[e++]<<h,h+=8),g=_[f&b];;){if(C=g>>>24,f>>>=C,h-=C,C=g>>>16&255,16&C){if(A=65535&g,C&=15,h<C&&(f+=M[e++]<<h,h+=8,h<C&&(f+=M[e++]<<h,h+=8)),A+=f&(1<<C)-1,A>u){n.msg="invalid distance too far back",R.mode=ll;break e}if(f>>>=C,h-=C,C=i-a,A>C){if(C=A-C,C>l&&R.sane){n.msg="invalid distance too far back",R.mode=ll;break e}if(I=0,T=c,d===0){if(I+=o-C,C<S){S-=C;do O[i++]=c[I++];while(--C);I=i-A,T=O}}else if(d<C){if(I+=o+d-C,C-=d,C<S){S-=C;do O[i++]=c[I++];while(--C);if(I=0,d<S){C=d,S-=C;do O[i++]=c[I++];while(--C);I=i-A,T=O}}}else if(I+=d-C,C<S){S-=C;do O[i++]=c[I++];while(--C);I=i-A,T=O}for(;S>2;)O[i++]=T[I++],O[i++]=T[I++],O[i++]=T[I++],S-=3;S&&(O[i++]=T[I++],S>1&&(O[i++]=T[I++]))}else{I=i-A;do O[i++]=O[I++],O[i++]=O[I++],O[i++]=O[I++],S-=3;while(S>2);S&&(O[i++]=O[I++],S>1&&(O[i++]=O[I++]))}break}if(64&C){n.msg="invalid distance code",R.mode=ll;break e}g=_[(65535&g)+(f&(1<<C)-1)]}}break}}while(e<r&&i<s);S=h>>3,e-=S,h-=S<<3,f&=(1<<h)-1,n.next_in=e,n.next_out=i,n.avail_in=e<r?r-e+5:5-(e-r),n.avail_out=i<s?s-i+257:257-(i-s),R.hold=f,R.bits=h};const dl=15,JT=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),e1=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),n1=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),t1=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var _o=(n,t,e,r,i,a,s,u)=>{const o=u.bits;let l,d,c,f,h,m,_=0,E=0,b=0,g=0,C=0,S=0,A=0,I=0,T=0,M=0,O=null;const R=new Uint16Array(16),U=new Uint16Array(16);let P,L,F,B=null;for(_=0;_<=dl;_++)R[_]=0;for(E=0;E<r;E++)R[t[e+E]]++;for(C=o,g=dl;g>=1&&R[g]===0;g--);if(C>g&&(C=g),g===0)return i[a++]=20971520,i[a++]=20971520,u.bits=1,0;for(b=1;b<g&&R[b]===0;b++);for(C<b&&(C=b),I=1,_=1;_<=dl;_++)if(I<<=1,I-=R[_],I<0)return-1;if(I>0&&(n===0||g!==1))return-1;for(U[1]=0,_=1;_<dl;_++)U[_+1]=U[_]+R[_];for(E=0;E<r;E++)t[e+E]!==0&&(s[U[t[e+E]]++]=E);if(n===0?(O=B=s,m=20):n===1?(O=JT,B=e1,m=257):(O=n1,B=t1,m=0),M=0,E=0,_=b,h=a,S=C,A=0,c=-1,T=1<<C,f=T-1,n===1&&T>852||n===2&&T>592)return 1;for(;;){P=_-A,s[E]+1<m?(L=0,F=s[E]):s[E]>=m?(L=B[s[E]-m],F=O[s[E]-m]):(L=96,F=0),l=1<<_-A,d=1<<S,b=d;do d-=l,i[h+(M>>A)+d]=P<<24|L<<16|F;while(d!==0);for(l=1<<_-1;M&l;)l>>=1;if(l!==0?(M&=l-1,M+=l):M=0,E++,--R[_]==0){if(_===g)break;_=t[e+s[E]]}if(_>C&&(M&f)!==c){for(A===0&&(A=C),h+=b,S=_-A,I=1<<S;S+A<g&&(I-=R[S+A],!(I<=0));)S++,I<<=1;if(T+=1<<S,n===1&&T>852||n===2&&T>592)return 1;c=M&f,i[c]=C<<24|S<<16|h-a}}return M!==0&&(i[h+M]=_-A<<24|64<<16),u.bits=C,0};const{Z_FINISH:r_,Z_BLOCK:r1,Z_TREES:cl,Z_OK:hs,Z_STREAM_END:i1,Z_NEED_DICT:a1,Z_STREAM_ERROR:pi,Z_DATA_ERROR:i_,Z_MEM_ERROR:a_,Z_BUF_ERROR:s1,Z_DEFLATED:s_}=Vs,Gd=16180,fl=16190,ia=16191,Nc=16192,Ic=16194,hl=16199,pl=16200,Ac=16206,Pt=16209,u_=n=>(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24);function u1(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Cs=n=>{if(!n)return 1;const t=n.state;return!t||t.strm!==n||t.mode<Gd||t.mode>16211?1:0},jy=n=>{if(Cs(n))return pi;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=1&t.wrap),t.mode=Gd,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,hs},qy=n=>{if(Cs(n))return pi;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,jy(n)},zy=(n,t)=>{let e;if(Cs(n))return pi;const r=n.state;return t<0?(e=0,t=-t):(e=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?pi:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=e,r.wbits=t,qy(n))},o_=(n,t)=>{if(!n)return pi;const e=new u1;n.state=e,e.strm=n,e.window=null,e.mode=Gd;const r=zy(n,t);return r!==hs&&(n.state=null),r};let Mc,wc,l_=!0;const o1=n=>{if(l_){Mc=new Int32Array(512),wc=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(_o(1,n.lens,0,288,Mc,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;_o(2,n.lens,0,32,wc,0,n.work,{bits:5}),l_=!1}n.lencode=Mc,n.lenbits=9,n.distcode=wc,n.distbits=5},d_=(n,t,e,r)=>{let i;const a=n.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(e-a.wsize,e),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(t.subarray(e-r,e-r+i),a.wnext),(r-=i)?(a.window.set(t.subarray(e-r,e),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0};var ca={inflateReset:qy,inflateReset2:zy,inflateResetKeep:jy,inflateInit:n=>o_(n,15),inflateInit2:o_,inflate:(n,t)=>{let e,r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M=0;const O=new Uint8Array(4);let R,U;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Cs(n)||!n.output||!n.input&&n.avail_in!==0)return pi;e=n.state,e.mode===ia&&(e.mode=Nc),s=n.next_out,i=n.output,o=n.avail_out,a=n.next_in,r=n.input,u=n.avail_in,l=e.hold,d=e.bits,c=u,f=o,T=hs;e:for(;;)switch(e.mode){case Gd:if(e.wrap===0){e.mode=Nc;break}for(;d<16;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(2&e.wrap&&l===35615){e.wbits===0&&(e.wbits=15),e.check=0,O[0]=255&l,O[1]=l>>>8&255,e.check=ar(e.check,O,2,0),l=0,d=0,e.mode=16181;break}if(e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&l)<<8)+(l>>8))%31){n.msg="incorrect header check",e.mode=Pt;break}if((15&l)!==s_){n.msg="unknown compression method",e.mode=Pt;break}if(l>>>=4,d-=4,I=8+(15&l),e.wbits===0&&(e.wbits=I),I>15||I>e.wbits){n.msg="invalid window size",e.mode=Pt;break}e.dmax=1<<e.wbits,e.flags=0,n.adler=e.check=1,e.mode=512&l?16189:ia,l=0,d=0;break;case 16181:for(;d<16;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(e.flags=l,(255&e.flags)!==s_){n.msg="unknown compression method",e.mode=Pt;break}if(57344&e.flags){n.msg="unknown header flags set",e.mode=Pt;break}e.head&&(e.head.text=l>>8&1),512&e.flags&&4&e.wrap&&(O[0]=255&l,O[1]=l>>>8&255,e.check=ar(e.check,O,2,0)),l=0,d=0,e.mode=16182;case 16182:for(;d<32;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}e.head&&(e.head.time=l),512&e.flags&&4&e.wrap&&(O[0]=255&l,O[1]=l>>>8&255,O[2]=l>>>16&255,O[3]=l>>>24&255,e.check=ar(e.check,O,4,0)),l=0,d=0,e.mode=16183;case 16183:for(;d<16;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}e.head&&(e.head.xflags=255&l,e.head.os=l>>8),512&e.flags&&4&e.wrap&&(O[0]=255&l,O[1]=l>>>8&255,e.check=ar(e.check,O,2,0)),l=0,d=0,e.mode=16184;case 16184:if(1024&e.flags){for(;d<16;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}e.length=l,e.head&&(e.head.extra_len=l),512&e.flags&&4&e.wrap&&(O[0]=255&l,O[1]=l>>>8&255,e.check=ar(e.check,O,2,0)),l=0,d=0}else e.head&&(e.head.extra=null);e.mode=16185;case 16185:if(1024&e.flags&&(h=e.length,h>u&&(h=u),h&&(e.head&&(I=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(r.subarray(a,a+h),I)),512&e.flags&&4&e.wrap&&(e.check=ar(e.check,r,h,a)),u-=h,a+=h,e.length-=h),e.length))break e;e.length=0,e.mode=16186;case 16186:if(2048&e.flags){if(u===0)break e;h=0;do I=r[a+h++],e.head&&I&&e.length<65536&&(e.head.name+=String.fromCharCode(I));while(I&&h<u);if(512&e.flags&&4&e.wrap&&(e.check=ar(e.check,r,h,a)),u-=h,a+=h,I)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=16187;case 16187:if(4096&e.flags){if(u===0)break e;h=0;do I=r[a+h++],e.head&&I&&e.length<65536&&(e.head.comment+=String.fromCharCode(I));while(I&&h<u);if(512&e.flags&&4&e.wrap&&(e.check=ar(e.check,r,h,a)),u-=h,a+=h,I)break e}else e.head&&(e.head.comment=null);e.mode=16188;case 16188:if(512&e.flags){for(;d<16;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(4&e.wrap&&l!==(65535&e.check)){n.msg="header crc mismatch",e.mode=Pt;break}l=0,d=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),n.adler=e.check=0,e.mode=ia;break;case 16189:for(;d<32;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}n.adler=e.check=u_(l),l=0,d=0,e.mode=fl;case fl:if(e.havedict===0)return n.next_out=s,n.avail_out=o,n.next_in=a,n.avail_in=u,e.hold=l,e.bits=d,a1;n.adler=e.check=1,e.mode=ia;case ia:if(t===r1||t===cl)break e;case Nc:if(e.last){l>>>=7&d,d-=7&d,e.mode=Ac;break}for(;d<3;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}switch(e.last=1&l,l>>>=1,d-=1,3&l){case 0:e.mode=16193;break;case 1:if(o1(e),e.mode=hl,t===cl){l>>>=2,d-=2;break e}break;case 2:e.mode=16196;break;case 3:n.msg="invalid block type",e.mode=Pt}l>>>=2,d-=2;break;case 16193:for(l>>>=7&d,d-=7&d;d<32;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if((65535&l)!=(l>>>16^65535)){n.msg="invalid stored block lengths",e.mode=Pt;break}if(e.length=65535&l,l=0,d=0,e.mode=Ic,t===cl)break e;case Ic:e.mode=16195;case 16195:if(h=e.length,h){if(h>u&&(h=u),h>o&&(h=o),h===0)break e;i.set(r.subarray(a,a+h),s),u-=h,a+=h,o-=h,s+=h,e.length-=h;break}e.mode=ia;break;case 16196:for(;d<14;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(e.nlen=257+(31&l),l>>>=5,d-=5,e.ndist=1+(31&l),l>>>=5,d-=5,e.ncode=4+(15&l),l>>>=4,d-=4,e.nlen>286||e.ndist>30){n.msg="too many length or distance symbols",e.mode=Pt;break}e.have=0,e.mode=16197;case 16197:for(;e.have<e.ncode;){for(;d<3;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}e.lens[P[e.have++]]=7&l,l>>>=3,d-=3}for(;e.have<19;)e.lens[P[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,R={bits:e.lenbits},T=_o(0,e.lens,0,19,e.lencode,0,e.work,R),e.lenbits=R.bits,T){n.msg="invalid code lengths set",e.mode=Pt;break}e.have=0,e.mode=16198;case 16198:for(;e.have<e.nlen+e.ndist;){for(;M=e.lencode[l&(1<<e.lenbits)-1],E=M>>>24,b=M>>>16&255,g=65535&M,!(E<=d);){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(g<16)l>>>=E,d-=E,e.lens[e.have++]=g;else{if(g===16){for(U=E+2;d<U;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(l>>>=E,d-=E,e.have===0){n.msg="invalid bit length repeat",e.mode=Pt;break}I=e.lens[e.have-1],h=3+(3&l),l>>>=2,d-=2}else if(g===17){for(U=E+3;d<U;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}l>>>=E,d-=E,I=0,h=3+(7&l),l>>>=3,d-=3}else{for(U=E+7;d<U;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}l>>>=E,d-=E,I=0,h=11+(127&l),l>>>=7,d-=7}if(e.have+h>e.nlen+e.ndist){n.msg="invalid bit length repeat",e.mode=Pt;break}for(;h--;)e.lens[e.have++]=I}}if(e.mode===Pt)break;if(e.lens[256]===0){n.msg="invalid code -- missing end-of-block",e.mode=Pt;break}if(e.lenbits=9,R={bits:e.lenbits},T=_o(1,e.lens,0,e.nlen,e.lencode,0,e.work,R),e.lenbits=R.bits,T){n.msg="invalid literal/lengths set",e.mode=Pt;break}if(e.distbits=6,e.distcode=e.distdyn,R={bits:e.distbits},T=_o(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,R),e.distbits=R.bits,T){n.msg="invalid distances set",e.mode=Pt;break}if(e.mode=hl,t===cl)break e;case hl:e.mode=pl;case pl:if(u>=6&&o>=258){n.next_out=s,n.avail_out=o,n.next_in=a,n.avail_in=u,e.hold=l,e.bits=d,ZT(n,f),s=n.next_out,i=n.output,o=n.avail_out,a=n.next_in,r=n.input,u=n.avail_in,l=e.hold,d=e.bits,e.mode===ia&&(e.back=-1);break}for(e.back=0;M=e.lencode[l&(1<<e.lenbits)-1],E=M>>>24,b=M>>>16&255,g=65535&M,!(E<=d);){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(b&&!(240&b)){for(C=E,S=b,A=g;M=e.lencode[A+((l&(1<<C+S)-1)>>C)],E=M>>>24,b=M>>>16&255,g=65535&M,!(C+E<=d);){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}l>>>=C,d-=C,e.back+=C}if(l>>>=E,d-=E,e.back+=E,e.length=g,b===0){e.mode=16205;break}if(32&b){e.back=-1,e.mode=ia;break}if(64&b){n.msg="invalid literal/length code",e.mode=Pt;break}e.extra=15&b,e.mode=16201;case 16201:if(e.extra){for(U=e.extra;d<U;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}e.length+=l&(1<<e.extra)-1,l>>>=e.extra,d-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=16202;case 16202:for(;M=e.distcode[l&(1<<e.distbits)-1],E=M>>>24,b=M>>>16&255,g=65535&M,!(E<=d);){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(!(240&b)){for(C=E,S=b,A=g;M=e.distcode[A+((l&(1<<C+S)-1)>>C)],E=M>>>24,b=M>>>16&255,g=65535&M,!(C+E<=d);){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}l>>>=C,d-=C,e.back+=C}if(l>>>=E,d-=E,e.back+=E,64&b){n.msg="invalid distance code",e.mode=Pt;break}e.offset=g,e.extra=15&b,e.mode=16203;case 16203:if(e.extra){for(U=e.extra;d<U;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}e.offset+=l&(1<<e.extra)-1,l>>>=e.extra,d-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){n.msg="invalid distance too far back",e.mode=Pt;break}e.mode=16204;case 16204:if(o===0)break e;if(h=f-o,e.offset>h){if(h=e.offset-h,h>e.whave&&e.sane){n.msg="invalid distance too far back",e.mode=Pt;break}h>e.wnext?(h-=e.wnext,m=e.wsize-h):m=e.wnext-h,h>e.length&&(h=e.length),_=e.window}else _=i,m=s-e.offset,h=e.length;h>o&&(h=o),o-=h,e.length-=h;do i[s++]=_[m++];while(--h);e.length===0&&(e.mode=pl);break;case 16205:if(o===0)break e;i[s++]=e.length,o--,e.mode=pl;break;case Ac:if(e.wrap){for(;d<32;){if(u===0)break e;u--,l|=r[a++]<<d,d+=8}if(f-=o,n.total_out+=f,e.total+=f,4&e.wrap&&f&&(n.adler=e.check=e.flags?ar(e.check,i,f,s-f):ho(e.check,i,f,s-f)),f=o,4&e.wrap&&(e.flags?l:u_(l))!==e.check){n.msg="incorrect data check",e.mode=Pt;break}l=0,d=0}e.mode=16207;case 16207:if(e.wrap&&e.flags){for(;d<32;){if(u===0)break e;u--,l+=r[a++]<<d,d+=8}if(4&e.wrap&&l!==(4294967295&e.total)){n.msg="incorrect length check",e.mode=Pt;break}l=0,d=0}e.mode=16208;case 16208:T=i1;break e;case Pt:T=i_;break e;case 16210:return a_;default:return pi}return n.next_out=s,n.avail_out=o,n.next_in=a,n.avail_in=u,e.hold=l,e.bits=d,(e.wsize||f!==n.avail_out&&e.mode<Pt&&(e.mode<Ac||t!==r_))&&d_(n,n.output,n.next_out,f-n.avail_out),c-=n.avail_in,f-=n.avail_out,n.total_in+=c,n.total_out+=f,e.total+=f,4&e.wrap&&f&&(n.adler=e.check=e.flags?ar(e.check,i,f,n.next_out-f):ho(e.check,i,f,n.next_out-f)),n.data_type=e.bits+(e.last?64:0)+(e.mode===ia?128:0)+(e.mode===hl||e.mode===Ic?256:0),(c===0&&f===0||t===r_)&&T===hs&&(T=s1),T},inflateEnd:n=>{if(Cs(n))return pi;let t=n.state;return t.window&&(t.window=null),n.state=null,hs},inflateGetHeader:(n,t)=>{if(Cs(n))return pi;const e=n.state;return 2&e.wrap?(e.head=t,t.done=!1,hs):pi},inflateSetDictionary:(n,t)=>{const e=t.length;let r,i,a;return Cs(n)?pi:(r=n.state,r.wrap!==0&&r.mode!==fl?pi:r.mode===fl&&(i=1,i=ho(i,t,e,0),i!==r.check)?i_:(a=d_(n,t,e,e),a?(r.mode=16210,a_):(r.havedict=1,hs)))},inflateInfo:"pako inflate (from Nodeca project)"},l1=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Ky=Object.prototype.toString,{Z_NO_FLUSH:d1,Z_FINISH:c1,Z_OK:go,Z_STREAM_END:Oc,Z_NEED_DICT:Rc,Z_STREAM_ERROR:f1,Z_DATA_ERROR:c_,Z_MEM_ERROR:h1}=Vs;function Eo(n){this.options=Fy({chunkSize:65536,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||n&&n.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gy,this.strm.avail_out=0;let e=ca.inflateInit2(this.strm,t.windowBits);if(e!==go)throw new Error(Ls[e]);if(this.header=new l1,ca.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Np(t.dictionary):Ky.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=ca.inflateSetDictionary(this.strm,t.dictionary),e!==go)))throw new Error(Ls[e])}function Dc(n,t){const e=new Eo(t);if(e.push(n),e.err)throw e.msg||Ls[e.err];return e.result}Eo.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,s,u;if(this.ended)return!1;for(s=t===~~t?t:t===!0?c1:d1,Ky.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),a=ca.inflate(e,s),a===Rc&&i&&(a=ca.inflateSetDictionary(e,i),a===go?a=ca.inflate(e,s):a===c_&&(a=Rc));e.avail_in>0&&a===Oc&&e.state.wrap>0&&n[e.next_in]!==0;)ca.inflateReset(e),a=ca.inflate(e,s);switch(a){case f1:case c_:case Rc:case h1:return this.onEnd(a),this.ended=!0,!1}if(u=e.avail_out,e.next_out&&(e.avail_out===0||a===Oc))if(this.options.to==="string"){let o=VT(e.output,e.next_out),l=e.next_out-o,d=GT(e.output,o);e.next_out=l,e.avail_out=r-l,l&&e.output.set(e.output.subarray(o,o+l),0),this.onData(d)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(a!==go||u!==0){if(a===Oc)return a=ca.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(e.avail_in===0)break}}return!0},Eo.prototype.onData=function(n){this.chunks.push(n)},Eo.prototype.onEnd=function(n){n===go&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Hy(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var p1={Inflate:Eo,inflate:Dc,inflateRaw:function(n,t){return(t=t||{}).raw=!0,Dc(n,t)},ungzip:Dc,constants:Vs};const{Deflate:m1,deflate:_1,deflateRaw:g1,gzip:E1}=XT,{Inflate:v1,inflate:y1,inflateRaw:b1,ungzip:C1}=p1;var ji,S1={Deflate:m1,deflate:_1,deflateRaw:g1,gzip:E1,Inflate:v1,inflate:y1,inflateRaw:b1,ungzip:C1,constants:Vs},Lc=function(n){return y(void 0,void 0,void 0,function(){var t;return v(this,function(e){return t=S1.ungzip(n),[2,String.fromCharCode.apply(null,t)]})})},Ae=function(n){return y(void 0,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,n()];case 1:return e.sent(),[3,3];case 2:if(!((t=e.sent())instanceof H))throw t;return t.throwOutside(),[3,3];case 3:return[2]}})})},Lt=function(n){return y(void 0,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,n()];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})})};(function(n){n.CONNECTING="CONNECTING",n.OPEN="OPEN",n.CLOSED="CLOSED"})(ji||(ji={}));var Wn,T1=function(n){function t(e,r){var i=r.sdkState,a=r.dispatcher,s=r.logger,u=n.call(this)||this;return u.lastActive=0,u._iid=e,u._sdkState=i,u._dispatcher=a,u._logger=s,u}return w(t,n),Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.connectionState===ji.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return ji.CONNECTING;case 1:return ji.OPEN}return ji.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ws",{get:function(){var e;return(e=this._ws)!==null&&e!==void 0?e:null},enumerable:!1,configurable:!0}),t.prototype._handleMessage=function(e){var r=this;e.split(`
`).forEach(function(i){if(i){var a=ft.createFromRawMessage(r._iid,i);if(r._logger.debug("receive websocket event",a),a.code==="LOGI")r.dispatch("message",a);else if(a.code==="PONG")r.dispatch("pong");else if(a.code==="EXPR"){if(a.payload){var s=new gu(a.payload);s.expiresIn>=0&&r._dispatcher.dispatch(s)}}else a.code==="NOOP"||r.dispatch("message",a)}})},t.prototype.connect=function(e,r){return r===void 0&&(r=""),y(this,void 0,void 0,function(){var i=this;return v(this,function(a){switch(a.label){case 0:return typeof fetch=="function"?[3,2]:[4,so(()=>import("./__bundle-46d64517-HHxQgd_i.js").then(s=>s._),__vite__mapDeps([4,1,2]))];case 1:a.sent(),a.label=2;case 2:return Lt(function(){return y(i,void 0,void 0,function(){return v(this,function(s){return fetch(this._sdkState.api.host),[2]})})}),this._ws=new WebSocket(e,encodeURIComponent(r)),this._ws.onopen=function(){i._logger.debug("websocket open"),i.dispatch("open")},this._ws.onmessage=function(s){return y(i,void 0,void 0,function(){var u,o,l,d,c,f,h,m=this;return v(this,function(_){switch(_.label){case 0:return!((h=this._sdkState.websocket)===null||h===void 0)&&h.compression?s.data instanceof Blob?((u=new FileReader).readAsArrayBuffer(s.data),u.onloadend=function(){return y(m,void 0,void 0,function(){var E,b;return v(this,function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),[4,Lc(u.result)];case 1:return E=g.sent(),this._handleMessage(E),[3,3];case 2:return b=g.sent(),this.error(b),[3,3];case 3:return[2]}})})},[3,12]):[3,1]:[3,13];case 1:if(!(s.data instanceof ArrayBuffer))return[3,6];_.label=2;case 2:return _.trys.push([2,4,,5]),[4,Lc(new Uint8Array(s.data))];case 3:return c=_.sent(),this._handleMessage(c),[3,5];case 4:return o=_.sent(),this.error(o),[3,5];case 5:return[3,12];case 6:if(!(typeof Buffer<"u"&&s.data instanceof Buffer))return[3,11];_.label=7;case 7:return _.trys.push([7,9,,10]),l=s.data,d=l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength),[4,Lc(d)];case 8:return c=_.sent(),this._handleMessage(c),[3,10];case 9:return f=_.sent(),this.error(f),[3,10];case 10:return[3,12];case 11:typeof s.data=="string"&&this._handleMessage(s.data),_.label=12;case 12:return[3,14];case 13:this._handleMessage(s.data),_.label=14;case 14:return[2]}})})},this._ws.onerror=function(){i._logger.debug("websocket error"),i.dispatch("error",H.networkError)},this._ws.onclose=function(){i._logger.debug("websocket close"),i.dispatch("close")},this.lastActive=Date.now(),[2]}})})},t.prototype.disconnect=function(){var e=this;return new Promise(function(r){e._logger.debug("websocket disconnect"),e._ws?(e._ws.onopen=tn,e._ws.onmessage=tn,e._ws.onerror=tn,e.connectionState!==ji.CLOSED?(e._ws.onclose=function(){e.dispatch("close"),r()},e._ws.close(),e._ws=void 0):r()):r()})},t.prototype.send=function(e){if(!this._ws)throw H.connectionClosed;e.code!=="PING"?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage())},t.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e)},t}(Bs),$y=function(n){function t(e){var r=e.all,i=e.feed,a=e.custom_types,s=e.ts,u=n.call(this)||this;return u.all=r,u.feed=i,u.customTypes=a,u.ts=s,u}return w(t,n),t}(bt),N1=function(){function n(t,e){var r=e.session,i=e.sdkState,a=e.dispatcher,s=e.logger,u=e.useFetchCompat,o=u!==void 0&&u,l=this;this._ackStateMap=new Map,this._sdkState=i,this._dispatcher=a,this._logger=s,this.apiClient=new bT(t,{session:r,sdkState:i,dispatcher:a,logger:s,useFetchCompat:o}),this.websocketClient=new T1(t,{sdkState:i,dispatcher:a,logger:s}),this.websocketClient.on("message",function(d){if(d.payload.unread_cnt&&l._dispatcher.dispatch(new $y(d.payload.unread_cnt)),d.requestId){if(l._ackStateMap.has(d.requestId)){var c=l._ackStateMap.get(d.requestId);d.code!=="EROR"?c.resolve(d):c.reject(new H({code:d.payload.code,message:d.payload.message}))}}else l._dispatcher.dispatch(d)}).on("close",function(){l._ackStateMap.forEach(function(d){d.reject(H.connectionClosed)}),l._ackStateMap.clear()})}return n.prototype._sendApiRequest=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this.apiClient.send(t)];case 1:return[2,e.sent()]}})})},n.prototype._sendWebsocketRequest=function(t){return y(this,void 0,void 0,function(){var e,r,i,a=this;return v(this,function(s){if(!this._sdkState.websocket)throw H.connectionRequired;if(e=new Tr,t.ackRequired){i=function(u,o){a._ackStateMap.has(t.requestId)&&(a._ackStateMap.delete(t.requestId),r&&(clearTimeout(r),r=null),u?(a._logger.debug("fail websocket request",t.requestId,u),e.reject(u)):(a._logger.debug("receive websocket ack",t.requestId,t),a._logger.debug("receive websocket ack",o),e.resolve(o)))};try{r=setTimeout(function(){return i(H.noAckTimeout)},this._sdkState.websocket.responseTimeout),this._ackStateMap.set(t.requestId,{resolve:function(u){return i(void 0,u)},reject:function(u){return i(u)}}),this.websocketClient.send(t)}catch(u){i(u)}}else try{this.websocketClient.send(t),e.resolve()}catch(u){e.reject(u)}return[2,e.promise]})})},n.prototype.send=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return t instanceof ee?[4,this._sendApiRequest(t)]:[3,2];case 1:case 3:return[2,e.sent()];case 2:return t instanceof or?[4,this._sendWebsocketRequest(t)]:[3,4];case 4:throw H.invalidParameters}})})},n.prototype.cancel=function(t){this.apiClient.cancel(t)},n.prototype.cancelAll=function(){this.apiClient.cancelAll()},n}();(function(n){n[n.NONE=0]="NONE",n[n.INITIALIZED=1]="INITIALIZED",n[n.CONNECTING=2]="CONNECTING",n[n.CONNECTED=3]="CONNECTED",n[n.RECONNECTING=4]="RECONNECTING",n[n.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",n[n.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",n[n.LOGOUT=7]="LOGOUT"})(Wn||(Wn={}));var Ss,Ts,Kr=function(n){function t(e){var r=e.stateType,i=n.call(this)||this;return i.stateType=r,i}return w(t,n),t}(bt),Wy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return w(t,n),t}(bt),Af=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return w(t,n),t}(bt),Yy=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return w(t,n),t}(bt),f_=function(){function n(t){var e,r,i,a;this.isEnabled=(e=t.enabled)!==null&&e!==void 0&&e,this.feedChannels=(r=t.feed_channels)!==null&&r!==void 0?r:{},this.templateListToken=(i=t.template_list_token)!==null&&i!==void 0?i:null,this.settingsUpdatedAt=(a=t.settings_updated_at)!==null&&a!==void 0?a:0}return n.payloadify=function(t){return ge(Re({enabled:t.isEnabled,feed_channels:t.feedChannels,template_list_token:t.templateListToken,settings_updated_at:t.settingsUpdatedAt}))},n}(),Ip=function(n){return"sendbird@".concat(n,"/changelog_include_chat_notifications")},h_=function(){function n(t){var e;this.lastUpdatedAt=(e=t.last_updated_at)!==null&&e!==void 0?e:0}return n.payloadify=function(t){return ge(Re({last_updated_at:t.lastUpdatedAt}))},n}(),p_=function(){function n(t){var e;this.token=(e=t.template_list_token)!==null&&e!==void 0?e:""}return n.payloadify=function(t){return ge(Re({template_list_token:t.token}))},n}(),ml=function(){function n(t){t===void 0&&(t={min_stat_count:100,min_interval:10800,max_stat_count_per_request:1e3,lower_threshold:10,request_delay_range:180}),this.minStatCount=t.min_stat_count,this.minInterval=1e3*t.min_interval,this.maxStatCountPerRequest=t.max_stat_count_per_request,this.lowerThreshold=t.lower_threshold,this.requestDelayRange=1e3*t.request_delay_range}return n.payloadify=function(t){return ge(Re({min_stat_count:t.minStatCount,min_interval:t.minInterval/1e3,max_stat_count_per_request:t.maxStatCountPerRequest,lower_threshold:t.lowerThreshold,request_delay_range:t.requestDelayRange/1e3}))},n}(),Uc=function(){function n(t){t===void 0&&(t={default:{min_stat_count:100,min_interval:10800,max_stat_count_per_request:1e3,lower_threshold:10,request_delay_range:180}}),this.default=new ml(t.default),this.realTime=new ml(t.realtime)}return n.payloadify=function(t){return ge(Re({default:ml.payloadify(t.default),realtime:ml.payloadify(t.realTime)}))},n}(),m_=1048576,I1=5;(function(n){n[n.NONE=0]="NONE",n[n.INCLUDE_REPLY=1]="INCLUDE_REPLY",n[n.EXCLUDE_REPLY=2]="EXCLUDE_REPLY",n[n.INCLUDE_REPLY_TO_CHANNEL=3]="INCLUDE_REPLY_TO_CHANNEL"})(Ss||(Ss={})),function(n){n[n.NONE=0]="NONE",n[n.INCLUDE_REPLY=1]="INCLUDE_REPLY",n[n.EXCLUDE_REPLY=2]="EXCLUDE_REPLY",n[n.INCLUDE_REPLY_TO_CHANNEL=3]="INCLUDE_REPLY_TO_CHANNEL"}(Ts||(Ts={}));var __=function(){function n(t){var e,r,i,a,s,u,o,l;t===void 0&&(t={}),this.emojiHash=t.emoji_hash||"",this.uploadSizeLimit=t.file_upload_size_limit?t.file_upload_size_limit*m_:Number.MAX_SAFE_INTEGER,this.useReaction=!!t.use_reaction,this.applicationAttributes=(e=t.application_attributes)!==null&&e!==void 0?e:[],this.premiumFeatureList=(r=t.premium_feature_list)!==null&&r!==void 0?r:[],this.deviceTokenCache=this.applicationAttributes.includes("sdk_device_token_cache"),this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history"),this.multipleFilesMessageFileCountLimit=(i=t.multiple_file_send_max_size)!==null&&i!==void 0?i:5,this.allowSdkStatsUpload=(a=t.allow_sdk_log_ingestion)===null||a===void 0||a,this.unreadCountThreadingPolicy=(s=t.unread_cnt_threading_policy)!==null&&s!==void 0?s:Ss.NONE,this.lastMessageThreadingPolicy=(u=t.last_msg_threading_policy)!==null&&u!==void 0?u:Ts.NONE,this.uikitConfigInfo=new h_((o=t.uikit_config)!==null&&o!==void 0?o:{}),this.notificationInfo=t.notifications?new f_(t.notifications):null,this.messageTemplateInfo=t.message_template?new p_(t.message_template):null,this.statConfigInfo=t.log_publish_config?new Uc(t.log_publish_config):new Uc,this.disableSuperGroupMack=(l=t.disable_supergroup_mack)!==null&&l!==void 0&&l}return n.payloadify=function(t){return ge(Re({emoji_hash:t.emojiHash,file_upload_size_limit:t.uploadSizeLimit/m_,application_attributes:t.applicationAttributes,premium_feature_list:t.premiumFeatureList,use_reaction:t.useReaction,allow_sdk_log_ingestion:t.allowSdkStatsUpload,unread_cnt_threading_policy:t.unreadCountThreadingPolicy,last_msg_threading_policy:t.lastMessageThreadingPolicy,uikit_config:t.uikitConfigInfo?h_.payloadify(t.uikitConfigInfo):null,notifications:t.notificationInfo?f_.payloadify(t.notificationInfo):null,message_template:t.messageTemplateInfo?p_.payloadify(t.messageTemplateInfo):null,log_publish_config:t.statConfigInfo?Uc.payloadify(t.statConfigInfo):null,disable_supergroup_mack:t.disableSuperGroupMack}))},n}(),Vt=function(){function n(t){this._iid="",this._iid=t}return n.payloadify=function(t){return{}},n}(),A1=function(n){function t(e){var r=e.userId,i=e.metadata,a=n.call(this)||this;return a.method=J.POST,a.path="".concat(qn,"/").concat(r,"/metadata"),a.params={metadata:i},a}return w(t,n),t}(ee),M1=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metaData=r,i}return w(t,n),t}(ie),w1=function(n){function t(e){var r=e.userId,i=e.metadata,a=e.upsert,s=n.call(this)||this;return s.method=J.PUT,s.path="".concat(qn,"/").concat(r,"/metadata"),s.params={metadata:i,upsert:a},s}return w(t,n),t}(ee),O1=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metadata=r,i}return w(t,n),t}(ie),R1=function(n){function t(e){var r=e.userId,i=e.metadataKey,a=n.call(this)||this;return a.method=J.DELETE,a.path="".concat(qn,"/").concat(r,"/metadata/").concat(i),a}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var D1=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.DELETE,i.path="".concat(qn,"/").concat(r,"/metadata"),i}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var du,Au=function(n,t){var e=JSON.parse(JSON.stringify(n));return e._iid&&delete e._iid,t&&t(e),e},$a=function(n,t){var e=JSON.parse(JSON.stringify(n));return e},ne=function(n){return{do:function(t){n||t()},throw:function(t){if(!n)throw t}}};(function(n){n.ONLINE="online",n.OFFLINE="offline",n.NON_AVAILABLE="nonavailable"})(du||(du={}));var Eu,Mn=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h,m,_,E=this;return(E=n.call(this,e)||this).userId=(a=(i=r.guest_id)!==null&&i!==void 0?i:r.user_id)!==null&&a!==void 0?a:"",E.nickname=(u=(s=r.nickname)!==null&&s!==void 0?s:r.name)!==null&&u!==void 0?u:"",E.plainProfileUrl=(l=(o=r.profile_url)!==null&&o!==void 0?o:r.image)!==null&&l!==void 0?l:"",E.requireAuth=(d=r.require_auth_for_profile_image)!==null&&d!==void 0&&d,E.metaData=(c=r.metadata)!==null&&c!==void 0?c:{},E.connectionStatus=du.NON_AVAILABLE,_n(du,r.is_online)?E.connectionStatus=r.is_online:x("boolean",r.is_online)&&(E.connectionStatus=r.is_online?du.ONLINE:du.OFFLINE),E.isActive=(f=r.is_active)===null||f===void 0||f,E.lastSeenAt=(h=r.last_seen_at)!==null&&h!==void 0?h:null,E.preferredLanguages=r.preferred_languages?Be([],we(r.preferred_languages),!1):null,E.friendDiscoveryKey=(m=r.friend_discovery_key)!==null&&m!==void 0?m:null,E.friendName=(_=r.friend_name)!==null&&_!==void 0?_:null,E}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{user_id:e.userId,nickname:e.nickname,profile_url:e.plainProfileUrl,require_auth_for_profile_image:e.requireAuth,metadata:e.metaData,is_online:e.connectionStatus,is_active:e.isActive,last_seen_at:e.lastSeenAt,preferred_languages:e.preferredLanguages,friend_discovery_key:e.friendDiscoveryKey,friend_name:e.friendName})))},Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=k.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return Au(this)},t.prototype._isValidMetaData=function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map(function(r){return e[r]}).every(function(r){return x("string",r)})},t.prototype._applyMetaData=function(e,r){var i=this;r===void 0&&(r=!1),Object.keys(e).forEach(function(a){r?delete i.metaData[a]:i.metaData[a]=e[a]})},t.prototype.createMetaData=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return ne(this._isValidMetaData(e)).throw(H.invalidParameters),r=k.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new A1({userId:i.userId,metadata:e}),[4,a.send(s)];case 1:return u=l.sent(),o=u.as(M1).metaData,this._applyMetaData(o),[2,this.metaData]}})})},t.prototype.updateMetaData=function(e,r){return r===void 0&&(r=!1),y(this,void 0,void 0,function(){var i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return ne(this._isValidMetaData(e)).throw(H.invalidParameters),i=k.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new w1({userId:a.userId,metadata:e,upsert:r}),[4,s.send(u)];case 1:return o=d.sent(),l=o.as(O1).metadata,this._applyMetaData(l),[2,this.metaData]}})})},t.prototype.deleteMetaData=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return ne(x("string",e)).throw(H.invalidParameters),r=k.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new R1({userId:i.userId,metadataKey:e}),[4,a.send(s)];case 1:return o.sent(),this._applyMetaData(((u={})[e]=!0,u),!0),[2,this.metaData]}})})},t.prototype.deleteAllMetaData=function(){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new D1({userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),this.metaData={},[2]}})})},t}(Vt),Qy=function(n){function t(e){var r=e.userProfile,i=n.call(this)||this;return i.userProfile=r,i}return w(t,n),t}(bt),Mf=function(){function n(t,e){var r,i,a,s,u,o,l,d,c,f,h,m,_,E;this._iid=t,this.appInfo=new __(e),this.user=new Mn(t,e),this.connectedAt=(r=e.login_ts)!==null&&r!==void 0?r:0,this.firstConnectedAt=0,this.pingInterval=(i=e.ping_interval)!==null&&i!==void 0?i:15e3,this.pongTimeout=(a=e.pong_timeout)!==null&&a!==void 0?a:5e3,this.reconnectInterval=(u=(s=e.reconnect)===null||s===void 0?void 0:s.interval)!==null&&u!==void 0?u:3e3,this.reconnectMaxInterval=(l=(o=e.reconnect)===null||o===void 0?void 0:o.max_interval)!==null&&l!==void 0?l:6e4,this.reconnectRetryCount=(c=(d=e.reconnect)===null||d===void 0?void 0:d.retry_cnt)!==null&&c!==void 0?c:5,this.reconnectIntervalMultiple=(h=(f=e.reconnect)===null||f===void 0?void 0:f.mul)!==null&&h!==void 0?h:2,this.maxUnreadCountOnSuperGroup=(m=e.max_unread_cnt_on_super_group)!==null&&m!==void 0?m:100,this.profileImageEncryption=!!e.profile_image_encryption,this.concurrentCallLimit=(_=e.concurrent_call_limit)!==null&&_!==void 0?_:5,this.backOffDelay=(E=e.back_off_delay)!==null&&E!==void 0?E:100}return n.payloadify=function(t){return ge(Re(D(D(D({},Mn.payloadify(t.user)),__.payloadify(t.appInfo)),{login_ts:t.connectedAt,ping_interval:t.pingInterval,pong_timeout:t.pongTimeout,reconnect:{interval:t.reconnectInterval,max_interval:t.reconnectMaxInterval,retry_cnt:t.reconnectRetryCount,mul:t.reconnectIntervalMultiple},max_unread_cnt_on_super_group:t.maxUnreadCountOnSuperGroup,profile_image_encryption:t.profileImageEncryption,concurrent_call_limit:t.concurrentCallLimit,back_off_delay:t.backOffDelay})))},n.prototype.apply=function(){var t=this.reconnectInterval,e=this.reconnectMaxInterval,r=this.reconnectIntervalMultiple,i=k.of(this._iid);i.sdkState.websocket&&(i.sdkState.websocket.pingInterval=1e3*this.pingInterval,i.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,i.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,i.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(a){return a>0?1e3*Math.min(t*Math.pow(r,a-1),e):10}}),i.appInfo=this.appInfo,i.sessionManager.currentUser=this.user,i.connectedAt=this.connectedAt,this.firstConnectedAt||(i.firstConnectedAt=this.connectedAt),i.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,i.concurrentCallLimit=this.concurrentCallLimit,i.backOffDelay=this.backOffDelay,i.dispatcher.dispatch(new Qy({userProfile:this}))},n}(),Xy=function(n){function t(e){var r=e.request,i=r===void 0||r,a=e.features,s=a===void 0?{}:a,u=e.options,o=u===void 0?{}:u,l=e.statConfigInfo,d=n.call(this)||this;return d.request=i,d.features=D({localCache:!0,notification:!0},s),d.options=D({ingestion:!0},o),d.statConfigInfo=l,d}return w(t,n),t}(bt),Fl=function(n){function t(e,r,i){var a,s,u,o,l=this;return(l=n.call(this,e,r,i)||this).error=null,l.services=[],l.userProfile=new Mf(e,i),l.deviceTokenLastDeletedAt=(a=i.device_token_last_deleted_at)!==null&&a!==void 0?a:0,l.key=(s=i.key)!==null&&s!==void 0?s:"",l.ekey=(u=i.ekey)!==null&&u!==void 0?u:"",l.error=i.error?new H(i):null,l.services=(o=i.services)!==null&&o!==void 0?o:[],l}return w(t,n),t.asError=function(e){return new t("","LOGI",D({user_id:"",error:!0},e))},t.prototype.applyTo=function(e){return y(this,void 0,void 0,function(){var r,i,a;return v(this,function(s){switch(s.label){case 0:return this.error?[3,4]:(r=k.of(e))?(i=r.sessionManager,a=r.dispatcher,[4,i.login(this)]):[3,2];case 1:return s.sent(),this.userProfile.apply(),a.dispatch(new Xy({request:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),features:{localCache:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish"),notification:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_noti_stats_log_publish")},options:{ingestion:this.userProfile.appInfo.allowSdkStatsUpload},statConfigInfo:this.userProfile.appInfo.statConfigInfo})),[3,3];case 2:throw H.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}})})},t}(ft),js=function(){function n(){this.type=Wn.NONE,this.name="none"}return n.prototype.run=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){return[2]})})},n.prototype.onConnect=function(t,e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2]})})},n.prototype.onReconnect=function(t,e){return e.resetReconnectCount,y(this,void 0,void 0,function(){return v(this,function(r){return[2]})})},n.prototype.onDisconnect=function(t,e){return e.error,e.autoReconnect,e.cause,y(this,void 0,void 0,function(){return v(this,function(r){return[2]})})},n.prototype.onDisconnectWebSocket=function(t,e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2]})})},n.prototype.onLogout=function(t,e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2]})})},n}(),Wa=function(n){function t(e){e===void 0&&(e={});var r,i=this;return(i=n.call(this)||this).type=Wn.LOGOUT,i.name="logout",i._wasPreviouslyConnected=(r=e.wasPreviouslyConnected)===null||r===void 0||r,i}return w(t,n),t.prototype.run=function(e){return y(this,void 0,void 0,function(){var r,i,a=this;return v(this,function(s){switch(s.label){case 0:return r=Date.now(),i=e.sdkState.userId,[4,e.logout()];case 1:return s.sent(),[4,e.changeState(new Ap,r)];case 2:return s.sent(),this._wasPreviouslyConnected&&Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(u){return e.connectionHandlers.forEach(function(o){o.onDisconnected&&o.onDisconnected(i)}),[2]})})}),[2]}})})},t}(js),Vd=function(n){function t(){var e=n.call(this)||this;return e.type=Wn.EXTERNAL_DISCONNECTED,e.name="externaldisconnected",e}return w(t,n),t.prototype.run=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,e.disconnect()];case 1:return r.sent(),[2]}})})},t.prototype.onConnect=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,e.disconnect()];case 1:return a.sent(),[4,e.changeState(new qd({authToken:r}),i)];case 2:return a.sent(),[2]}})})},t.prototype.onReconnect=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new ld,r)];case 1:return i.sent(),[2]}})})},t.prototype.onLogout=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Wa,r)];case 1:return i.sent(),[2]}})})},t}(js),od=function(n){function t(e){var r=e.autoReconnect,i=n.call(this)||this;return i.type=Wn.INTERNAL_DISCONNECTED,i.name="internaldisconnected",i._autoReconnect=!1,i._autoReconnect=r,i}return w(t,n),t.prototype.run=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.disconnect()];case 1:return i.sent(),this._autoReconnect?[4,e.changeState(new ld,r)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onConnect=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,e.disconnect()];case 1:return a.sent(),[4,e.changeState(new qd({authToken:r}),i)];case 2:return a.sent(),[2]}})})},t.prototype.onReconnect=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new ld,r)];case 1:return i.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Vd,r)];case 1:return i.sent(),[2]}})})},t.prototype.onLogout=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Wa,r)];case 1:return i.sent(),[2]}})})},t}(js),Or=function(n){return y(void 0,void 0,void 0,function(){return v(this,function(t){return[2,new Promise(function(e){return setTimeout(e,n)})]})})},Zy=function(){function n(){}return n.prototype.calcTimeout=function(){return 0},n}(),jd=function(n,t,e){return e===void 0&&(e=new Zy),y(void 0,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:r=0,i=null,a=function(d){return i=d??new Error("Halted")},s=function(){r=0},l.label=1;case 1:if(!(t===-1||r<t))return[3,9];l.label=2;case 2:return l.trys.push([2,4,,8]),[4,n(a,s)];case 3:if(u=l.sent(),i)throw i;return[2,u];case 4:if(o=l.sent(),i)return[3,6];if(++r===t)throw o;return[4,Or(e.calcTimeout(r))];case 5:return l.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:throw"It should not happen."}})})},ld=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=Wn.RECONNECTING,e.name="reconnecting",e._callbacks=[],e}return w(t,n),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._resetConnect=void 0,this._callbacks.forEach(function(r){return r(e)})},t.prototype.run=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l=this;return v(this,function(d){switch(d.label){case 0:r=Date.now(),i=new Tr,this._callbacks.push(function(c){return c?i.reject(c):i.resolve()}),Ae(function(){return y(l,void 0,void 0,function(){return v(this,function(c){return e.connectionHandlers.forEach(function(f){f.onReconnectStarted&&f.onReconnectStarted()}),[2]})})}),d.label=1;case 1:return d.trys.push([1,4,,9]),a=e.sdkState.websocket,s=a.reconnectMaxRetry,u=a.reconnectRetryStrategy,[4,jd(function(c,f){return y(l,void 0,void 0,function(){var h;return v(this,function(m){switch(m.label){case 0:this._haltConnect=c,this._resetConnect=f,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,e.connect()];case 2:return m.sent(),[3,4];case 3:if(h=m.sent(),e.clearLoginTimer(),h instanceof H){if(h.code===Ne.CONNECTION_CANCELED)return c(h),[2];if(h.isSessionExpiredError||h.isSessionInvalidatedError)return c(h),[2]}throw h;case 4:return[2]}})})},s,u)];case 2:return d.sent(),[4,e.changeState(new Jy,r)];case 3:return d.sent(),this._flushCallbacks(),Ae(function(){return y(l,void 0,void 0,function(){return v(this,function(c){return e.connectionHandlers.forEach(function(f){f.onReconnectSucceeded&&f.onReconnectSucceeded()}),[2]})})}),[3,9];case 4:return o=d.sent(),gr(o)?[3,7]:o instanceof H?o.code===Ne.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new od({autoReconnect:!1}),r)]:[3,6];case 5:d.sent(),d.label=6;case 6:return this._flushCallbacks(o),Ae(function(){return y(l,void 0,void 0,function(){return v(this,function(c){return e.connectionHandlers.forEach(function(f){f.onReconnectFailed&&f.onReconnectFailed()}),[2]})})}),[3,8];case 7:throw o;case 8:return[3,9];case 9:return[2,i.promise]}})})},t.prototype.onConnect=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){return i=new Tr,this._halt(H.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push(function(){var s=Date.now();e.changeState(new qd({authToken:r}),s).then(function(){i.resolve()}).catch(function(u){i.reject(u)})}),[2,i.promise]})})},t.prototype.onReconnect=function(e,r){var i=r.resetReconnectCount,a=i!==void 0&&i;return y(this,void 0,void 0,function(){var s;return v(this,function(u){return s=new Tr,this._resetConnect&&a&&this._resetConnect(),this._callbacks.push(function(o){return o?s.reject(o):s.resolve()}),[2,s.promise]})})},t.prototype.onDisconnect=function(e,r){r._error;var i=r.autoReconnect,a=i===void 0||i;return y(this,void 0,void 0,function(){var s;return v(this,function(u){switch(u.label){case 0:return s=Date.now(),this._halt(H.connectionCanceled),[4,e.changeState(new od({autoReconnect:a}),s)];case 1:return u.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),this._halt(H.connectionCanceled),[4,e.changeState(new Vd,r)];case 1:return i.sent(),[2]}})})},t.prototype.onLogout=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),this._halt(H.connectionCanceled),[4,e.changeState(new Wa,r)];case 1:return i.sent(),[2]}})})},t}(js),Jy=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=Wn.CONNECTED,e.name="connected",e}return w(t,n),t.prototype.onReconnect=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.disconnect()];case 1:return i.sent(),[4,e.changeState(new ld,r)];case 2:return i.sent(),[2]}})})},t.prototype.onDisconnect=function(e,r){var i=r.autoReconnect;return y(this,void 0,void 0,function(){var a;return v(this,function(s){switch(s.label){case 0:return a=Date.now(),[4,e.changeState(new od({autoReconnect:i}),a)];case 1:return s.sent(),[2]}})})},t.prototype.onDisconnectWebSocket=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Vd,r)];case 1:return i.sent(),[2]}})})},t.prototype.onLogout=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Wa,r)];case 1:return i.sent(),[2]}})})},t}(js);(function(n){n.ExternalSetBackground="ExternalSetBackground",n.ExternalDisconnectWebSocket="ExternalDisconnectWebSocket"})(Eu||(Eu={}));var L1=function(){function n(t,e){var r=e.sdkState,i=e.cacheContext,a=e.connectionHandlers,s=e.sessionManager,u=e.websocketClient,o=e.dispatcher,l=e.logger,d=e.disableWebSocketCloseEventHandling,c=d!==void 0&&d;this._disableWebSocketCloseEventHandling=!1,this._webSocketClosedCause=null,this._logger=l,this._disableWebSocketCloseEventHandling=c,this._context=new x1(t,{sdkState:r,cacheContext:i,connectionHandlers:a,sessionManager:s,websocketClient:u,dispatcher:o,logger:l}),this._sdkState=r,this._sessionManager=s,this._websocketClient=u}return n.prototype._registerEventDispatcher=function(){var t=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh",function(){t.isConnecting||t.isConnected||(t._logger.debug("try reconnect by session key refresh"),Lt(function(){return y(t,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this.reconnect()];case 1:return e.sent(),[2]}})})}))}),this._websocketEventDispatcherContext=this._websocketClient.on("close",function(){t._sdkState.appState!=="foreground"||t._webSocketClosedCause||Lt(function(){return y(t,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this._sessionManager.isSessionKeyRefreshing?[3,2]:(this._logger.debug("try reconnect by websocket connection closed"),[4,this.reconnect()]);case 1:return e.sent(),[3,4];case 2:return[4,this.disconnectWebSocket()];case 3:e.sent(),e.label=4;case 4:return[2]}})})})}))},n.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=void 0),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=void 0)},Object.defineProperty(n.prototype,"isConnected",{get:function(){return this._context.currentState.type===Wn.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isConnecting",{get:function(){var t=this._context.currentState;return t.type===Wn.CONNECTING||t.type===Wn.RECONNECTING},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"websocketClient",{get:function(){return this._websocketClient},enumerable:!1,configurable:!0}),n.prototype.connect=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return e=this._context.currentState,this._webSocketClosedCause=null,[4,e.onConnect(this._context,t)];case 1:return r.sent(),this._registerEventDispatcher(),[2]}})})},n.prototype.reconnect=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=null,[4,t.onReconnect(this._context,{})];case 1:return e.sent(),[2]}})})},n.prototype.resetAndReconnect=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=null,[4,t.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return e.sent(),[2]}})})},n.prototype.background=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=Eu.ExternalSetBackground,[4,t.onDisconnect(this._context,{autoReconnect:!1,cause:this._webSocketClosedCause})];case 1:return e.sent(),[2]}})})},n.prototype.disconnect=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:t,autoReconnect:!0,cause:this._webSocketClosedCause})];case 1:return e.sent(),[2]}})})},n.prototype.disconnectWebSocket=function(t){return t===void 0&&(t=!1),y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return e=this._context.currentState,t&&(this._webSocketClosedCause=Eu.ExternalDisconnectWebSocket),[4,e.onDisconnectWebSocket(this._context,{cause:this._webSocketClosedCause})];case 1:return r.sent(),[2]}})})},n.prototype.logout=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return e=this._context.currentState,this._clearEventDispatcher(),[4,e.onLogout(this._context,t)];case 1:return r.sent(),[2]}})})},n}(),qd=function(n){function t(e){var r=e.authToken,i=n.call(this)||this;return i.type=Wn.CONNECTING,i.name="connecting",i._authToken="",i._callbacks=[],i._authToken=r,i}return w(t,n),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._callbacks.forEach(function(r){return r(e)})},t.prototype.run=function(e){return y(this,void 0,void 0,function(){var r,i,a,s=this;return v(this,function(u){switch(u.label){case 0:r=Date.now(),i=new Tr,this._callbacks.push(function(o){return o?i.reject(o):i.resolve()}),u.label=1;case 1:return u.trys.push([1,4,,10]),[4,jd(function(o){return y(s,void 0,void 0,function(){var l;return v(this,function(d){switch(d.label){case 0:this._haltConnect=o,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return d.sent(),[3,4];case 3:if(l=d.sent(),e.clearLoginTimer(),l instanceof H&&l.code===Ne.CONNECTION_CANCELED)return o(l),[2];throw l;case 4:return[2]}})})},e.sdkState.websocket.connectMaxRetry)];case 2:return u.sent(),[4,e.changeState(new Jy,r)];case 3:return u.sent(),Ae(function(){return y(s,void 0,void 0,function(){return v(this,function(o){return this._flushCallbacks(),e.connectionHandlers.forEach(function(l){l.onConnected&&l.onConnected(e.sdkState.userId)}),[2]})})}),[3,10];case 4:return a=u.sent(),gr(a)?[3,8]:[4,e.disconnect()];case 5:return u.sent(),a instanceof H?a.code===Ne.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new Ap,r)]:[3,7];case 6:u.sent(),u.label=7;case 7:return Ae(function(){return y(s,void 0,void 0,function(){return v(this,function(o){return this._flushCallbacks(a),[2]})})}),[3,9];case 8:throw a;case 9:return[3,10];case 10:return[2,i.promise]}})})},t.prototype.onConnect=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){return r=new Tr,this._callbacks.push(function(a){return a?r.reject(a):r.resolve()}),[2,r.promise]})})},t.prototype.onDisconnect=function(e,r){var i=r.error,a=i===void 0?null:i,s=r.autoReconnect,u=s!==void 0&&s,o=r.cause,l=o===void 0?null:o;return y(this,void 0,void 0,function(){var d;return v(this,function(c){switch(c.label){case 0:return d=Date.now(),this._halt(a??g_(l)),e.hasSession?[4,e.changeState(new od({autoReconnect:u}),d)]:[3,2];case 1:return c.sent(),[3,4];case 2:return[4,e.changeState(new Wa,d)];case 3:c.sent(),c.label=4;case 4:return[2]}})})},t.prototype.onDisconnectWebSocket=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return this._halt(g_((r==null?void 0:r.cause)||null)),i=Date.now(),e.hasSession?[4,e.changeState(new Vd,i)]:[3,2];case 1:return a.sent(),[3,4];case 2:return[4,e.changeState(new Wa,i)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},t.prototype.onLogout=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=Date.now(),this._halt(r??H.connectionCanceled),[4,e.changeState(new Wa,i)];case 1:return a.sent(),[2]}})})},t}(js);function g_(n){var t=H.connectionCanceled;if(n){var e=null;switch(n){case Eu.ExternalSetBackground:e="Connection has been canceled due to the application having externally moved to background while in ConnectingState.";break;case Eu.ExternalDisconnectWebSocket:e="Connection has been canceled because sb.disconnectWebSocket() was called while in ConnectingState."}e&&t.setDetail(e)}return t}var Ua,Ap=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=Wn.INITIALIZED,e.name="initialized",e}return w(t,n),t.prototype.onConnect=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=Date.now(),[4,e.changeState(new qd({authToken:r}),i)];case 1:return a.sent(),[2]}})})},t.prototype.onLogout=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,e.changeState(new Wa({wasPreviouslyConnected:!1}),r)];case 1:return i.sent(),[2]}})})},t}(js),U1=function(n){function t(){return n.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return w(t,n),t}(or),k1=function(){function n(t){var e=t.pingDelegate,r=t.sdkState,i=t.logger;this.pingDelegate=e,this.sdkState=r,this._logger=i}return Object.defineProperty(n.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),n.prototype.ping=function(){var t,e=this;if(!this.sdkState.websocket)throw H.connectionRequired;var r=new U1;try{var i=(t=this.sdkState.websocket.pongTimeout)!==null&&t!==void 0?t:5e3;this._pingTimeoutTimer=setTimeout(function(){e._logger.debug("pinger.ping() timeout"),e.pingDelegate.error()},i),this.pingDelegate.send(r),this._logger.debug("pinger.ping()")}catch(a){this._logger.debug("pinger.ping() error",a),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0),this.pingDelegate.error()}return r},n.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},n.prototype.refreshTimer=function(){var t,e=this;if(!this.sdkState.websocket)throw H.connectionRequired;this._logger.debug("pinger.refreshTimer()");var r=(t=this.sdkState.websocket.pingInterval)!==null&&t!==void 0?t:15e3;this.stop(),this._pingTimer=setInterval(function(){e.ping()},r)},n.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping()},n.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=void 0),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},n}(),eb=["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash","multiple_file_send_max_size","notifications","message_template"],x1=function(n){function t(e,r){var i,a=r.sdkState,s=r.cacheContext,u=r.connectionHandlers,o=r.sessionManager,l=r.websocketClient,d=r.dispatcher,c=r.logger,f=r.entryState,h=f===void 0?new Ap:f,m=this;return(m=n.call(this)||this)._stateUpdatedAt=0,m._connectingAt=0,m._connectedAt=0,m._logiReceivedAt=0,m._connectionRequestQueue=[],m._iid=e,m.sdkState=a,m.cacheContext=s,m.connectionHandlers=u,m._sessionManager=o,m._websocketClient=l,m._dispatcher=d,m._logger=c,m._currentState=h,!((i=m.sdkState.websocket)===null||i===void 0)&&i.pingerDisabled||(m._pinger=new k1({pingDelegate:{send:function(_){return m._websocketClient.send(_)},error:function(_){return m._websocketClient.error(_)}},sdkState:m.sdkState,logger:c})),m._websocketClient.on("open",function(){m._connectedAt=Date.now(),m._tryResolveConnectionRequest()}).on("message",function(_){_.code==="LOGI"&&(m.clearLoginTimer(),m._dispatcher.dispatch(_.as(Fl)))}).on("ping-refresh",function(){var _;return(_=m._pinger)===null||_===void 0?void 0:_.refreshTimer()}).on("pong",function(){var _;return(_=m._pinger)===null||_===void 0?void 0:_.pong()}).on("error",function(){var _;return(_=m._pinger)===null||_===void 0?void 0:_.stop()}).on("close",function(){m._logiProcessingTimer=setTimeout(function(){m._logiProcessingTimer=void 0,m._unresolvedLogi||m._rejectConnectionRequest(H.networkError)},500)}),m._dispatcher.on(function(_){_ instanceof Fl&&(m._unresolvedLogi=_,m._tryResolveConnectionRequest())}),m}return w(t,n),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSession",{get:function(){return this._sessionManager.session.hasSession},enumerable:!1,configurable:!0}),t.prototype.changeState=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return r>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=r,this._dispatcher.dispatch(new Kr({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return i.sent(),[2,!0];case 2:return[2,!1]}})})},t.prototype._tryResolveConnectionRequest=function(){var e;return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=this._unresolvedLogi,this._websocketClient.isOpen&&r?(this._unresolvedLogi=void 0,this._logiReceivedAt=Date.now(),r.error?[3,2]:[4,r.applyTo(this._iid)]):[3,3];case 1:return i.sent(),this._statLogConnection(),(e=this._pinger)===null||e===void 0||e.start(),this._connectionRequestQueue.forEach(function(a){return a.resolve()}),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.session.authToken=void 0,r.error.isSessionExpiredError||r.error.isSessionInvalidatedError?this._dispatcher.dispatch(new gu({reason:r.error.code,message:r.error.message})):this._logger.warn("login failed: ".concat(r.error)),this._rejectConnectionRequest(r.error),i.label=3;case 3:return[2]}})})},t.prototype._rejectConnectionRequest=function(e){var r;if((r=this._pinger)===null||r===void 0||r.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0){var i=this._connectionRequestQueue;this._connectionRequestQueue=[],i.forEach(function(a){return a.reject(e)}),this._statLogConnection(e)}},t.prototype._url=function(){var e,r=this.sdkState,i=r.appId,a=r.appVersion,s=r.userId,u=r.extensions,o=r.sendbirdRuntimeEnvironment,l=this.cacheContext.localCacheEnabled,d=this._sessionManager.session,c=(e=this.sdkState.websocket)===null||e===void 0?void 0:e.compression,f=!!(u??{}).sb_uikit,h=rd.userAgentWithExtension(u);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(ja.OS_VERSION),"&sv=").concat(encodeURIComponent(ja.SDK_VERSION),"&ai=").concat(i).concat(a?"&av=".concat(a):"").concat(d.hasSession?"":"&user_id=".concat(encodeURIComponent(s)),"&pmce=").concat(c?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(h,"&SB-SDK-User-Agent=").concat(encodeURIComponent(rd.sendbirdSdkUserAgentWithExtension(o)),"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(eb))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(l?1:0,"&include_poll_details=1").concat(f?"&uikit_config=1":"")},t.prototype._statLogConnection=function(e){var r;this._dispatcher.dispatch(new Cp(new Mt({type:_t.WEBSOCKET_CONNECT,data:{host_url:(r=this.sdkState.websocket)===null||r===void 0?void 0:r.host,success:!e,latency:this._connectedAt>0?this._connectedAt-this._connectingAt:Date.now()-this._connectingAt,logi_latency:this._logiReceivedAt>0?this._logiReceivedAt-this._connectingAt:void 0,error_code:e==null?void 0:e.code,error_description:e==null?void 0:e.message}})))},t.prototype.connect=function(e){var r;return e===void 0&&(e=""),y(this,void 0,void 0,function(){var i,a,s,u=this;return v(this,function(o){return this._logiProcessingTimer&&(clearTimeout(this._logiProcessingTimer),this._logiProcessingTimer=void 0,this._rejectConnectionRequest(H.connectionCanceled)),i=new Tr,this._connectionRequestQueue.push(i),this._connectionRequestQueue.length===1&&(this._connectingAt=Date.now(),this._connectedAt=0,this._logiReceivedAt=0,this._loginTimer=setTimeout(function(){u._loginTimer=void 0,u._rejectConnectionRequest(H.loginTimeout)},(r=this.sdkState.websocket)===null||r===void 0?void 0:r.responseTimeout),a=this._sessionManager.session,e&&(a.authToken=e,a.sessionKey=void 0),s=this._url(),a.sessionKey||a.authToken?this._websocketClient.connect(s,JSON.stringify(a.hasSession?{auth:a.sessionKey}:{token:a.authToken})):this._websocketClient.connect(s,JSON.stringify({}))),[2,i.promise]})})},t.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(Fl.asError(H.connectionRenew))},t.prototype.disconnect=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._websocketClient.disconnect()];case 1:return e.sent(),[2]}})})},t.prototype.logout=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.sdkState.userId=void 0,this._unresolvedLogi=void 0,[4,this.disconnect()];case 1:return e.sent(),[4,this._sessionManager.clear()];case 2:return e.sent(),[2]}})})},t.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=void 0)},t}(Bs),nb=function(n){function t(e){var r=e.appId,i=e.userId,a=e.includeUIKitConfig,s=a!==void 0&&a,u=e.localCacheEnabled,o=u===void 0||u,l=e.expiringSession,d=l===void 0||l,c=n.call(this)||this;return c.path="".concat(iT,"/").concat(i,"/authentication"),c.method=J.POST,c.params=ge({expiring_session:!!d,include_logi:!0,include_extra_data:String(eb),uikit_config:s,use_local_cache:o,app_id:r}),c.requireAuth=!1,c}return w(t,n),t}(ee),P1=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.logi=new Fl(e,"LOGI",r),i}return w(t,n),t}(ie);(function(n){n[n.ALL=0]="ALL",n[n.WEBSOCKET=1]="WEBSOCKET",n[n.API=2]="API"})(Ua||(Ua={}));var gt,E_,F1=[bp,nb],H1=function(){function n(t,e){var r=e.session,i=e.sdkState,a=e.dispatcher,s=e.logger,u=e.useFetchCompat,o=u!==void 0&&u,l=this;this._currentConnectionStateType=Wn.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new N1(t,{session:r,sdkState:i,dispatcher:a,logger:s,useFetchCompat:o}),this._session=r,this._logger=s,this._dispatcher=a,this._dispatcher.on(function(d){var c,f,h;if(d instanceof Kr){var m=d.stateType;switch(l._currentConnectionStateType=m,m){case Wn.CONNECTED:l._resolveLazyCallQueue();break;case Wn.INITIALIZED:case Wn.INTERNAL_DISCONNECTED:case Wn.EXTERNAL_DISCONNECTED:case Wn.LOGOUT:l._session.isRefreshing||l._rejectLazyCallQueue(!((h=l._session)===null||h===void 0)&&h.hasSession?H.connectionClosed:H.connectionRequired)}}else if(d instanceof Wy)l._session.hasChatServicePermission||l._resolveLazyCallQueue(Ua.API);else if(d instanceof Af||d instanceof Yy)l._rejectLazyCallQueue(H.connectionClosed);else if(d instanceof Ty){var _=d.request,E=d.deferred,b=d.error;try{for(var g=oe(F1),C=g.next();!C.done;C=g.next())if(_ instanceof C.value)return void E.reject(b)}catch(S){c={error:S}}finally{try{C&&!C.done&&(f=g.return)&&f.call(g)}finally{if(c)throw c.error}}l._lazyCallQueue.push({command:_,deferred:E})}})}return Object.defineProperty(n.prototype,"isReady",{get:function(){return this._currentConnectionStateType===Wn.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===Wn.CONNECTING||this._currentConnectionStateType===Wn.RECONNECTING||this._session.isRefreshing},enumerable:!1,configurable:!0}),n.prototype._classifyLazyCallQueueByScope=function(t){var e,r=[],i=[];switch(t){case Ua.ALL:e=null;break;case Ua.WEBSOCKET:e=or;break;case Ua.API:e=ee}var a=!1;return this._lazyCallQueue.forEach(function(s){!e||s.command instanceof e||(a=!0),a?i.push(s):r.push(s)}),[r,i]},n.prototype._resolveLazyCallQueue=function(t){var e=this;t===void 0&&(t=Ua.ALL);var r=we(this._classifyLazyCallQueueByScope(t),2),i=r[0],a=r[1];this._lazyCallQueue=a,i.forEach(function(s){return y(e,void 0,void 0,function(){var u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:u=s.command,o=s.deferred,(l=s.timeout)&&clearTimeout(l),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.send(u)];case 2:return d=f.sent(),o.resolve(d),[3,4];case 3:return c=f.sent(),o.reject(c),[3,4];case 4:return[2]}})})})},n.prototype._rejectLazyCallQueue=function(t,e){var r=this;e===void 0&&(e=Ua.ALL);var i=we(this._classifyLazyCallQueueByScope(e),2),a=i[0],s=i[1];this._lazyCallQueue=s,a.forEach(function(u){return y(r,void 0,void 0,function(){var o,l;return v(this,function(d){return o=u.deferred,l=u.timeout,clearTimeout(l),o.reject(t),[2]})})})},n.prototype.send=function(t){return y(this,void 0,void 0,function(){var e,r,i=this;return v(this,function(a){switch(a.label){case 0:return t instanceof or?this.isReady?(this._logger.debug("send websocket request",t),[4,this.commandRouter.send(t)]):[3,2]:[3,4];case 1:case 5:case 7:return[2,a.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",t),e=new Tr,this._lazyCallQueue.push({command:t,deferred:e,timeout:setTimeout(function(){return i.timeout(t.requestId)},1e4)}),[2,e.promise];throw this._logger.debug("fail websocket request"),H.connectionRequired;case 3:case 9:return[3,11];case 4:return t instanceof ee?this._session.hasSession?(this._logger.debug("send api request",t),[4,this.commandRouter.send(t)]):[3,6]:[3,10];case 6:return t.hasSessionKey?(this._logger.debug("send api request with tmp session key",t),[4,this.commandRouter.send(t)]):[3,8];case 8:if(this.isLazyCallActivated)return this._logger.debug("wait api request",t),e=new Tr,this._lazyCallQueue.push({command:t,deferred:e,timeout:setTimeout(function(){return i.timeout(t.requestId)},1e4)}),[2,e.promise];throw r=H.connectionRequired,this._logger.debug("fail api request",r),r;case 10:throw H.invalidCommand;case 11:return[2]}})})},n.prototype.forceSend=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this._logger.debug("send forced request",t),t instanceof or||t instanceof ee?[4,this.commandRouter.send(t)]:[3,2];case 1:return[2,e.sent()];case 2:throw H.invalidCommand}})})},n.prototype.timeout=function(t){this._logger.debug("timeout request",t);var e=this._lazyCallQueue.findIndex(function(r){return r.command.requestId===t});e>-1&&(this._lazyCallQueue[e].deferred.reject(H.connectionRequired),this._lazyCallQueue.splice(e,1))},n.prototype.cancel=function(t){this._logger.debug("cancel api request",t),this.commandRouter.cancel(t)},n.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll()},n}(),kc="sendbird@devicetokens",xc=function(){function n(t){var e=t.type,r=t.token,i=t.device_os,a=t.device_manufacturer,s=t.system_push_enabled;this.type=e,this.token=r,this.deviceOS=i,this.deviceManufacturer=a,this.systemPushEnabled=s}return n.payloadify=function(t){return ge(Re({type:t.type,token:t.token,device_os:t.deviceOS,device_manufacturer:t.deviceManufacturer,system_push_enabled:t.systemPushEnabled}))},n}(),Pc=new WeakMap,B1=function(n){function t(e){var r=e._iid,i=e.session,a=e.cacheContext,s=e.sdkState,u=e.dispatcher,o=e.requestQueue,l=e.logger,d=e.pushNotificationAckManager,c=n.call(this)||this;return c._currentConnectionStateType=Wn.INITIALIZED,c._isRefreshingAuthToken=!1,c.currentUser=null,c.session=i,c._iid=r,c._cacheContext=a,c._sdkState=s,c._dispatcher=u,c._requestQueue=o,c._logger=l,c._pushNotificationAckManager=d,c._deviceTokens=[],c._dispatcher.on(function(f){var h,m,_;if(f instanceof Kr){var E=f.stateType;c._currentConnectionStateType=E}else if(f instanceof gu&&c.handler&&!c.isSessionKeyRefreshing){if(c._currentConnectionStateType===Wn.CONNECTING)return;!((h=f.error)===null||h===void 0)&&h.isSessionInvalidatedError?c.close():(!((m=f.error)===null||m===void 0)&&m.isSessionTokenExpiredError&&c.refreshAuthToken().catch(function(b){if(gr(b)&&c._sdkState.appState==="foreground")throw b}),!((_=f.error)===null||_===void 0)&&_.isSessionKeyExpiredError&&(c._logger.debug("session expired"),c.handler.onSessionExpired&&c.handler.onSessionExpired(),c.refreshSessionKey().catch(function(b){if(gr(b)&&c._sdkState.appState==="foreground")throw b})))}}),c}return w(t,n),Object.defineProperty(t.prototype,"ekey",{get:function(){return Pc.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),t.prototype.indexOfDeviceToken=function(e,r){return this._deviceTokens.findIndex(function(i){return i.type===e&&i.token===r})},t.prototype.hasDeviceToken=function(e,r){return this.indexOfDeviceToken(e,r)>=0},t.prototype.createRefreshWebsocketCommand=function(e,r){return new gT({authToken:e,expiringSession:!0,requestId:r})},t.prototype._refreshSessionKeyByWebSocket=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return r=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(r)];case 1:if(i=o.sent(),a=i.as(vT),s=a.newKey,u=a.error)throw u;return this.session.sessionKey=s??this.session.sessionKey,[2]}})})},t.prototype._refreshSessionKeyByApi=function(e){return y(this,void 0,void 0,function(){var r,i=this;return v(this,function(a){switch(a.label){case 0:return r=new bp({userId:this._sdkState.userId,authToken:e,services:this.session.services&&this.session.services.length>0?this.session.services:void 0,expiringSession:!0}),[4,jd(function(s){return y(i,void 0,void 0,function(){var u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(r)];case 1:return u=f.sent(),o=u.as(ET),l=o.key,d=o.services,this.session.sessionKey=l,this.session.services=d,[3,3];case 2:if(c=f.sent(),!this._isSessionRelatedError(c))throw c;return s(c),[3,3];case 3:return[2]}})})},3)];case 1:return a.sent(),[2]}})})},t.prototype._refreshSessionKey=function(e,r){return r===void 0&&(r=!0),y(this,void 0,void 0,function(){var i,a;return v(this,function(s){switch(s.label){case 0:if(this._currentConnectionStateType!==Wn.CONNECTED)return[3,8];s.label=1;case 1:return s.trys.push([1,3,,8]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return s.sent(),this.complete(),[2];case 3:i=s.sent(),s.label=4;case 4:return s.trys.push([4,6,,7]),[4,this._handleSessionRefreshError(i,r)];case 5:return s.sent(),[2];case 6:return s.sent(),[3,7];case 7:return[3,8];case 8:return s.trys.push([8,10,,12]),[4,this._refreshSessionKeyByApi(e)];case 9:return s.sent(),this.complete(),[3,12];case 10:return a=s.sent(),[4,this._handleSessionRefreshError(a,r)];case 11:return s.sent(),[3,12];case 12:return[2]}})})},t.prototype._receiveNewAuthToken=function(){var e,r=this,i=new Tr;if(this._isRefreshingAuthToken=!0,this.session.sessionKey=void 0,this.session.authToken=void 0,(e=this.handler)===null||e===void 0?void 0:e.onSessionTokenRequired){var a=null,s=function(){a&&(clearTimeout(a),a=null)},u=function(l){s(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,i.resolve(l))},o=function(l){s(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,i.reject(l))};a=setTimeout(function(){return o()},1e3*this._sdkState.sessionTokenRefreshTimeout),Ae(function(){return y(r,void 0,void 0,function(){var l;return v(this,function(d){return!((l=this.handler)===null||l===void 0)&&l.onSessionTokenRequired&&this.handler.onSessionTokenRequired(u,o),[2]})})})}else i.resolve(null);return i.promise},t.prototype._handleSessionRefreshError=function(e,r){return r===void 0&&(r=!1),y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return e instanceof H&&(e.isSessionTokenExpiredError||e.code===Ne.APPLICATION_NOT_FOUND)?(this.session.authToken=void 0,r?[4,this._receiveNewAuthToken()]:[3,6]):[3,6];case 1:return(i=a.sent())?(this.session.authToken=i,[4,this._refreshSessionKey(this.session.authToken,!1)]):[3,3];case 2:return a.sent(),[3,5];case 3:return[4,this.clear()];case 4:a.sent(),a.label=5;case 5:return[2];case 6:throw e}})})},t.prototype._isSessionRelatedError=function(e){return e instanceof H&&(e.isSessionExpiredError||e.isSessionInvalidatedError)},Object.defineProperty(t.prototype,"isSessionKeyRefreshing",{get:function(){return this.session.isRefreshing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiring",{get:function(){return!!this.handler},enumerable:!1,configurable:!0}),t.prototype.authenticate=function(e,r){var i;return y(this,void 0,void 0,function(){var a,s,u;return v(this,function(o){switch(o.label){case 0:return this.session.authToken=r,a=new nb({appId:this._sdkState.appId,userId:e,includeUIKitConfig:!!((i=this._sdkState.extensions)!==null&&i!==void 0?i:{}).sb_uikit,localCacheEnabled:this._cacheContext.localCacheEnabled,expiringSession:this.isSessionExpiring}),[4,this._requestQueue.commandRouter.send(a)];case 1:return s=o.sent(),(u=s.as(P1).logi).error?[3,4]:this.session.hasChatServicePermission?[3,3]:[4,u.applyTo(this._iid)];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:throw u.error;case 5:return[2]}})})},t.prototype.login=function(e){var r;return y(this,void 0,void 0,function(){var i,a,s,u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:return i=e.key,a=e.ekey,s=e.services,u=e.userProfile,o=e.deviceTokenLastDeletedAt,l=o===void 0?0:o,this.session.sessionKey=i,this.session.services=s,Pc.set(this,a),this._deviceTokenCacheEnabled=(r=u==null?void 0:u.appInfo)===null||r===void 0?void 0:r.deviceTokenCache,d=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,d.get(kc)]:[3,5];case 1:return!(c=f.sent())||c.lastDeletedAt<l?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=l,[4,this.saveDeviceToken()]):[3,3];case 2:return f.sent(),[3,4];case 3:this._deviceTokens=c.tokens.map(function(h){return new xc(xc.payloadify(h))}),this._deviceTokenLastDeletedAt=c.lastDeletedAt,f.label=4;case 4:return[3,7];case 5:return[4,d.remove(kc)];case 6:f.sent(),f.label=7;case 7:return[2]}})})},t.prototype.complete=function(){var e=this;this.dispatch("refresh"),this._dispatcher.dispatch(new Wy),Ae(function(){return y(e,void 0,void 0,function(){var r;return v(this,function(i){return this._logger.debug("session refreshed"),!((r=this.handler)===null||r===void 0)&&r.onSessionRefreshed&&this.handler.onSessionRefreshed(),[2]})})})},t.prototype.error=function(e){var r=this;Ae(function(){return y(r,void 0,void 0,function(){var i;return v(this,function(a){return!((i=this.handler)===null||i===void 0)&&i.onSessionError&&this.handler.onSessionError(e),[2]})})})},t.prototype.close=function(){var e=this;this.dispatch("close"),this._dispatcher.dispatch(new Yy),Ae(function(){return y(e,void 0,void 0,function(){var r;return v(this,function(i){return this._logger.debug("session closed"),!((r=this.handler)===null||r===void 0)&&r.onSessionClosed&&this.handler.onSessionClosed(),[2]})})})},t.prototype.refreshAuthToken=function(){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:if(e=null,!this.isSessionExpiring||this.session.isRefreshing)return[3,9];this.session.isRefreshing=!0,i.label=1;case 1:return i.trys.push([1,7,8,9]),[4,this._receiveNewAuthToken()];case 2:return(e=i.sent())?(this._logger.debug("session refreshing.."),this.session.authToken=e,[4,this._refreshSessionKey(this.session.authToken)]):[3,4];case 3:return i.sent(),[3,6];case 4:return[4,this.clear()];case 5:i.sent(),i.label=6;case 6:return[3,9];case 7:throw i.sent(),r=e?H.sessionTokenRefreshFailed:H.sessionTokenRequestFailed,this._dispatcher.dispatch(new Af),this.error(r),this._logger.debug("refresh auth token error = ",r),r;case 8:return this.session.isRefreshing=!1,[7];case 9:return[2]}})})},t.prototype.refreshSessionKey=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:if(!this.isSessionExpiring||this.session.isRefreshing)return[3,5];this.session.isRefreshing=!0,r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,this._refreshSessionKey(this.session.authToken)];case 2:return r.sent(),[3,5];case 3:throw r.sent(),e=H.sessionTokenRefreshFailed,this._dispatcher.dispatch(new Af),this.error(e),e;case 4:return this.session.isRefreshing=!1,[7];case 5:return[2]}})})},t.prototype.setDeviceToken=function(e,r,i){if(this._deviceTokenCacheEnabled&&this.indexOfDeviceToken(e,r)<0){var a=new xc({type:e,token:r,device_os:i==null?void 0:i.deviceOS,device_manufacturer:i==null?void 0:i.deviceManufacturer,system_push_enabled:i==null?void 0:i.systemPushEnabled});return this._deviceTokens.push(a),!0}return!1},t.prototype.unsetDeviceToken=function(e,r){if(this._deviceTokenCacheEnabled){var i=this.indexOfDeviceToken(e,r);i>=0&&this._deviceTokens.splice(i,1)}},t.prototype.unsetDeviceTokens=function(e){this._deviceTokenCacheEnabled&&(this._deviceTokens=e?this._deviceTokens.filter(function(r){return r.type!==e}):[])},t.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e)},t.prototype.saveDeviceToken=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(kc,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.currentUser=null,this.session.clear(),this.close(),Pc.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),this._pushNotificationAckManager.clear(),[2]}})})},t}(Bs),tb=function(n,t){var e,r;if(n!==null&&t!==null){var i=Object.keys(n),a=Object.keys(t),s=Be([],we(new Set(Be(Be([],we(i),!1),we(a),!1))),!1),u={};try{for(var o=oe(s),l=o.next();!l.done;l=o.next()){var d=l.value,c=typeof n[d],f=typeof t[d];c==="undefined"?u[d]=t[d]:f==="undefined"?u[d]=n[d]:c!==f?u[d]=t[d]:c==="object"&&n[d]&&t[d]?u[d]=tb(n[d],t[d]):u[d]=t[d]}}catch(h){e={error:h}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return u}return t};(function(n){n[n.PENDING=0]="PENDING",n[n.COLLECT_ONLY=1]="COLLECT_ONLY",n[n.ENABLED=2]="ENABLED",n[n.DISABLED=3]="DISABLED"})(gt||(gt={})),function(n){n.DAILY="daily",n.DEFAULT="default",n.REALTIME="realtime"}(E_||(E_={}));var dd,zd=100,Mp=function(){function n(t){var e=t.deviceId,r=t.cacheContext,i=t.requestQueue;this.queue=[],this.flushWaitQueue=[],this.enabledState=gt.PENDING,this.isFlushing=!1,this._sentLogStats=[],this.deviceId=e,this.cacheContext=r,this.requestQueue=i,this.logInfo={deviceId:e,statLogs:[],generation:1,lastFlushedAt:0},this.limit=zd}return Object.defineProperty(n.prototype,"isEnabled",{get:function(){return this.enabledState===gt.ENABLED},enumerable:!1,configurable:!0}),n.prototype.init=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return this.key=t,[4,this.cacheContext.preference.get(this.key)];case 1:return(e=r.sent())&&(this.logInfo=e),[2]}})})},n.prototype._mergeQueue=function(){this.flushWaitQueue.length>0&&(this.queue=this.queue.concat(this.flushWaitQueue),this.flushWaitQueue=[])},n.prototype._isDuplicateStat=function(t){var e=this._sentLogStats.find(function(r){var i;return r.channelUrl===t.data.channel_url&&r.messageId===((i=t.data.notificationId)!==null&&i!==void 0?i:t.data.message_id)&&r.action===t.data.action});return e||this._sentLogStats.push({channelUrl:t.data.channel_url,messageId:t.data.message_id,action:t.data.action}),!!e},n.prototype._save=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return t=Be(Be([],we(this.queue),!1),we(this.flushWaitQueue),!1),[4,this.cacheContext.preference.set(this.key,{deviceId:this.logInfo.deviceId,statLogs:t.map(function(r){return Mt.payloadify(r)}),generation:this.logInfo.generation++,lastFlushedAt:this.logInfo.lastFlushedAt})];case 1:return e.sent(),[2]}})})},n.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.queue=[],this.flushWaitQueue=[],this.logInfo.generation=1,this._save(),[2]})})},n}(),Lo=function(n){function t(e){var r,i,a,s,u=e.type,o=e.data,l=e.ts,d=l===void 0?Date.now():l,c=n.call(this,{type:u,data:o,ts:d})||this;return c.date=new Date(d),c.key="".concat((r=c.date,i=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0"),"".concat(i).concat(a).concat(s)),"_").concat(u),c}return w(t,n),t}(Mt),rb=function(n){function t(e){var r=e.deviceId,i=e.statLogs,a=n.call(this)||this;return a.method=J.POST,a.path="".concat(cT),a.params={device_id:r,log_entries:i.map(function(s){return Mt.payloadify(s)})},a}return w(t,n),t}(ee),G1=function(n){function t(e){var r=e.deviceId,i=e.cacheContext,a=e.requestQueue;return n.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return w(t,n),Object.defineProperty(t.prototype,"_isSendable",{get:function(){return this.queue.length!==0&&Date.now()-this.logInfo.lastFlushedAt>=this.statConfig.minInterval},enumerable:!1,configurable:!0}),t.prototype.init=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,n.prototype.init.call(this,e+".daily")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){return new Mt({type:i.stat_type,ts:i.ts,data:i.data})}),[2]}})})},t.prototype.setConfig=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this.statConfig=e,this.statConfig.minInterval=864e5,this._mergeQueue(),r.localCacheStat?(this.enabledState=r.enabledStat?gt.ENABLED:gt.COLLECT_ONLY,[3,3]):[3,1];case 1:return this.enabledState=gt.DISABLED,[4,this.clear()];case 2:o.sent(),o.label=3;case 3:return this.isEnabled&&this._isSendable?[4,this._getUploadStats()]:[3,9];case 4:i=o.sent(),a=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),s=0,o.label=5;case 5:return s<i.length?(u=i.slice(s,1+this.statConfig.maxStatCountPerRequest),[4,Or(a)]):[3,9];case 6:return o.sent(),[4,this._flush(u)];case 7:o.sent(),o.label=8;case 8:return s+=this.statConfig.maxStatCountPerRequest,[3,5];case 9:return[2]}})})},t.prototype.put=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return this.enabledState===gt.DISABLED?[2,!0]:(r=this.enabledState===gt.PENDING||this.isFlushing?this.flushWaitQueue:this.queue,i=we(r.filter(function(o){return o instanceof Lo&&o.key===e.key}),1),(a=i[0])?a.data=tb(a.data,e.data):r.push(e),this.enabledState===gt.PENDING?[3,2]:[4,this._save()]);case 1:u.sent(),u.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this._isSendable?[4,this._getUploadStats()]:[3,5]):[3,5];case 3:return s=u.sent(),[4,this._flush(s)];case 4:return[2,u.sent()];case 5:return[2,!0]}})})},t.prototype._getUploadStats=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(r){return e=this.queue.filter(function(i){if(i instanceof Lo){var a=new Date,s=we([i.date.getFullYear(),a.getFullYear()],2),u=s[0],o=s[1];if(u<o)return!0;if(u===o){var l=we([i.date.getMonth(),a.getMonth()],2),d=l[0],c=l[1];if(d<c)return!0;if(d===c){var f=we([i.date.getDate(),a.getDate()],2);return f[0]<f[1]}}}return!1}),[2,e]})})},t.prototype._flush=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:if(r=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,u.label=1;case 1:return u.trys.push([1,4,8,9]),i=Be([],we(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new rb({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return u.sent(),this.queue=Be([],we(e),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=zd,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return u.sent(),[3,9];case 4:return(s=u.sent())instanceof H?s.code!==Ne.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return u.sent(),this.enabledState=gt.DISABLED,[3,7];case 6:s.code===Ne.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=gt.COLLECT_ONLY),u.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,u.label=11;case 11:return[2,r]}})})},t}(Mp),V1=function(n){function t(e){var r=e.deviceId,i=e.cacheContext,a=e.requestQueue;return n.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return w(t,n),t.prototype._isSendable=function(e){if(e===void 0&&(e=!1),this.queue.length<this.statConfig.lowerThreshold)return!1;if(e){if(Date.now()-this.logInfo.lastFlushedAt<this.statConfig.minInterval)return!1}else if(this.queue.length<this.statConfig.minStatCount)return!1;return!0},t.prototype._filterQueueByType=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){return[2,r?e.filter(function(a){return a.type!==_t.FEATURE_LOCALCACHE_EVENT}):e.filter(function(a){return a.type===_t.FEATURE_LOCALCACHE_EVENT})]})})},t.prototype.init=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,n.prototype.init.call(this,e+".default")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){return i.data=D({message_init_policy:"",starting_point:0},i.data),new Mt({type:i.stat_type,ts:i.ts,data:i.data})}),[2]}})})},t.prototype.setConfig=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this.statConfig=e,this._mergeQueue(),r.requestStat||r.localCacheStat?(this.enabledState=r.enabledStat?gt.ENABLED:gt.COLLECT_ONLY,i=void 0,r.requestStat||(i=!1),r.localCacheStat||(i=!0),i===void 0?[3,3]:(a=this,[4,this._filterQueueByType(this.queue,i)])):[3,4];case 1:return a.queue=o.sent(),s=this,[4,this._filterQueueByType(this.flushWaitQueue,i)];case 2:s.flushWaitQueue=o.sent(),this._save(),o.label=3;case 3:return[3,6];case 4:return this.enabledState=gt.DISABLED,[4,this.clear()];case 5:o.sent(),o.label=6;case 6:return this.isEnabled&&this._isSendable(!0)?(u=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),[4,Or(u)]):[3,9];case 7:return o.sent(),[4,this._flush(this.queue)];case 8:o.sent(),o.label=9;case 9:return[2]}})})},t.prototype.put=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return this.enabledState===gt.DISABLED?[2,!0]:((r=this.enabledState===gt.PENDING||this.isFlushing?this.flushWaitQueue:this.queue).push(e),this.enabledState===gt.PENDING?[3,2]:[4,this._save()]);case 1:i.sent(),i.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this._isSendable()?[4,this._flush(r)]:[3,4]):[3,4];case 3:return[2,i.sent()];case 4:return[2,!0]}})})},t.prototype._flush=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:if(r=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,u.label=1;case 1:return u.trys.push([1,4,8,9]),i=Be([],we(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new rb({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return u.sent(),this.queue=Be([],we(e),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=zd,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return u.sent(),[3,9];case 4:return(s=u.sent())instanceof H?s.code!==Ne.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return u.sent(),this.enabledState=gt.DISABLED,[3,7];case 6:s.code===Ne.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=gt.COLLECT_ONLY),u.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,u.label=11;case 11:return[2,r]}})})},t}(Mp),j1=function(n){function t(e){var r=e.deviceId,i=e.statLogs,a=n.call(this)||this;return a.method=J.POST,a.path="".concat(fT),a.params={device_id:r,log_entries:i.map(function(s){return Mt.payloadify(s)})},a}return w(t,n),t}(ee),q1=function(n){function t(e){var r=e.deviceId,i=e.cacheContext,a=e.requestQueue;return n.call(this,{deviceId:r,cacheContext:i,requestQueue:a})||this}return w(t,n),Object.defineProperty(t.prototype,"_isSendable",{get:function(){return this.queue.length>=this.statConfig.minStatCount&&this.queue.length>this.statConfig.lowerThreshold||this.logInfo.lastFlushedAt>0&&Date.now()-this.logInfo.lastFlushedAt>=this.statConfig.minInterval},enumerable:!1,configurable:!0}),t.prototype.init=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,n.prototype.init.call(this,e+".realtime")];case 1:return r.sent(),this.queue=this.logInfo.statLogs.map(function(i){var a;return i.data=ge(D(D({},i.data),{message_id:(a=i.data.notificationId)!==null&&a!==void 0?a:i.data.message_id,notificationId:void 0})),new Mt({type:i.stat_type,ts:i.ts,data:i.data})}),this._sentLogStats=this.queue.map(function(i){var a;return{channelUrl:i.data.channelUrl,messageId:(a=i.data.notificationId)!==null&&a!==void 0?a:i.data.message_id,action:i.data.action}}),[2]}})})},t.prototype.setConfig=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return this.statConfig=e,this._mergeQueue(),r.notificationStat?(this.enabledState=r.enabledStat?gt.ENABLED:gt.COLLECT_ONLY,[3,3]):[3,1];case 1:return this.enabledState=gt.DISABLED,[4,this.clear()];case 2:a.sent(),a.label=3;case 3:return this.isEnabled&&this._isSendable?(i=Math.max(Math.floor(Math.random()*this.statConfig.requestDelayRange),100),[4,Or(i)]):[3,6];case 4:return a.sent(),[4,this._flush(this.queue)];case 5:a.sent(),a.label=6;case 6:return[2]}})})},t.prototype.put=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return this.enabledState===gt.DISABLED?[2,!0]:(r=this.enabledState===gt.PENDING||this.isFlushing?this.flushWaitQueue:this.queue,this._isDuplicateStat(e)?[2,!0]:(r.push(e),this.enabledState===gt.PENDING?[3,2]:[4,this._save()]));case 1:i.sent(),i.label=2;case 2:return this.isEnabled?(this._mergeQueue(),this.isEnabled&&this._isSendable?[4,this._flush(r)]:[3,4]):[3,4];case 3:return[2,i.sent()];case 4:return[2,!0]}})})},t.prototype._flush=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:if(r=!0,!(e.length>0))return[3,10];if(this.isFlushing)return[3,9];this.isFlushing=!0,u.label=1;case 1:return u.trys.push([1,4,8,9]),i=Be([],we(e),!1).slice(0,Math.min(this.limit,this.statConfig.maxStatCountPerRequest)),a=new j1({deviceId:this.deviceId,statLogs:i}),[4,this.requestQueue.send(a)];case 2:return u.sent(),this.queue=Be([],we(e),!1).slice(i.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=zd,this.logInfo.lastFlushedAt=Date.now(),[4,this._save()];case 3:return u.sent(),[3,9];case 4:return(s=u.sent())instanceof H?s.code!==Ne.NON_AUTHORIZED?[3,6]:[4,this.clear()]:[3,7];case 5:return u.sent(),this.enabledState=gt.DISABLED,[3,7];case 6:s.code===Ne.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=gt.COLLECT_ONLY),u.label=7;case 7:return this.limit=this.limit+20,r=!1,[3,9];case 8:return this.isFlushing=!1,[7];case 9:return[3,11];case 10:this.isFlushing=!1,u.label=11;case 11:return[2,r]}})})},t}(Mp),z1=function(){function n(t){var e=t.cacheContext,r=t.requestQueue,i=t.dispatcher,a=t.logger;this._collectRequestStat=!0,this._collectFeatureLocalCacheStat=!0,this._collectionNotificationStat=!0,this._retryCount=0,this.deviceId=ba(),this.cacheContext=e,this.requestQueue=r,this.dispatcher=i,this.logger=a,this._dailyStatCollector=new G1({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue}),this._defaultStatCollector=new V1({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue}),this._notificationStatCollector=new q1({deviceId:this.deviceId,cacheContext:this.cacheContext,requestQueue:this.requestQueue})}return n.prototype._migration=function(){return y(this,void 0,void 0,function(){var t,e,r,i;return v(this,function(a){switch(a.label){case 0:return[4,this.cacheContext.preference.get(this.key)];case 1:return(t=a.sent())?(e=[],t.statLogs.forEach(function(s){s.stat_type===_t.FEATURE_LOCALCACHE&&e.push(new Mt({type:s.stat_type,ts:s.ts,data:s.data}))}),[4,this.cacheContext.preference.set(this.key+".daily",{deviceId:t.deviceId,statLogs:e.map(function(s){return Mt.payloadify(s)}),generation:t.generation,lastFlushedAt:t.lastFlushedAt})]):[3,6];case 2:return a.sent(),r=[],t.statLogs.forEach(function(s){s.stat_type!==_t.FEATURE_LOCALCACHE&&s.stat_type!==_t.NOTIFICATION&&(s.stat_type===_t.FEATURE_LOCALCACHE_EVENT&&(s.data=D({message_init_policy:"",starting_point:0},s.data)),r.push(new Mt({type:s.stat_type,ts:s.ts,data:s.data})))}),[4,this.cacheContext.preference.set(this.key+".default",{deviceId:t.deviceId,statLogs:r.map(function(s){return Mt.payloadify(s)}),generation:t.generation,lastFlushedAt:t.lastFlushedAt})];case 3:return a.sent(),i=[],t.statLogs.forEach(function(s){var u;s.stat_type===_t.NOTIFICATION&&(s.data=ge(D(D({},s.data),{message_id:(u=s.data.notificationId)!==null&&u!==void 0?u:s.data.message_id,notificationId:void 0})),i.push(new Mt({type:s.stat_type,ts:s.ts,data:s.data})))}),[4,this.cacheContext.preference.set(this.key+".realtime",{deviceId:t.deviceId,statLogs:i.map(function(s){return Mt.payloadify(s)}),generation:t.generation,lastFlushedAt:t.lastFlushedAt})];case 4:return a.sent(),[4,this.cacheContext.preference.remove(this.key)];case 5:a.sent(),a.label=6;case 6:return[2]}})})},n.prototype.init=function(t){return y(this,void 0,void 0,function(){var e=this;return v(this,function(r){switch(r.label){case 0:return this.key=t,[4,this._migration()];case 1:return r.sent(),[4,this._dailyStatCollector.init(this.key)];case 2:return r.sent(),[4,this._defaultStatCollector.init(this.key)];case 3:return r.sent(),[4,this._notificationStatCollector.init(this.key)];case 4:return r.sent(),this.commandEventContext||(this.commandEventContext=this.dispatcher.on(function(i){return y(e,void 0,void 0,function(){var a,s,u,o,l,d;return v(this,function(c){return i instanceof Cp?(a=i.statLog,this.put(a)):i instanceof Xy&&(s=i.request,u=i.features,o=i.options,l=i.statConfigInfo,this._retryCount=0,this._collectRequestStat=s,this._collectFeatureLocalCacheStat=u==null?void 0:u.localCache,this._collectionNotificationStat=u==null?void 0:u.notification,this._statConfig=l,this._dailyStatCollector.setConfig(this._statConfig.default,{localCacheStat:this._collectFeatureLocalCacheStat,enabledStat:o.ingestion}),this._defaultStatCollector.setConfig(this._statConfig.default,{requestStat:this._collectRequestStat,localCacheStat:this._collectFeatureLocalCacheStat,enabledStat:o.ingestion}),this._notificationStatCollector.setConfig((d=this._statConfig.realTime)!==null&&d!==void 0?d:this._statConfig.default,{notificationStat:this._collectionNotificationStat,enabledStat:o.ingestion})),[2]})})})),[2]}})})},n.prototype.put=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return e=!0,t instanceof Lo?this._collectFeatureLocalCacheStat?[4,this._dailyStatCollector.put(t)]:[3,2]:[3,3];case 1:e=r.sent(),r.label=2;case 2:return[3,13];case 3:switch(t.type){case _t.API_RESULT:case _t.WEBSOCKET_CONNECT:return[3,4];case _t.FEATURE_LOCALCACHE:case _t.FEATURE_LOCALCACHE_EVENT:return[3,7];case _t.NOTIFICATION:return[3,10]}return[3,13];case 4:return this._collectRequestStat?[4,this._defaultStatCollector.put(t)]:[3,6];case 5:e=r.sent(),r.label=6;case 6:return[3,13];case 7:return this._collectFeatureLocalCacheStat?[4,this._defaultStatCollector.put(t)]:[3,9];case 8:e=r.sent(),r.label=9;case 9:return[3,13];case 10:return this._collectionNotificationStat?[4,this._notificationStatCollector.put(t)]:[3,12];case 11:e=r.sent(),r.label=12;case 12:return[3,13];case 13:return e?this._retryCount=0:(this._retryCount++,this._retryCount>20&&(this._dailyStatCollector.enabledState=gt.COLLECT_ONLY,this._defaultStatCollector.enabledState=gt.COLLECT_ONLY,this._notificationStatCollector.enabledState=gt.COLLECT_ONLY,this.logger.debug(H.statLogUploadLimitExceededError))),[2]}})})},n.prototype.close=function(){this.commandEventContext&&(this.commandEventContext.close(),this.commandEventContext=void 0)},n}(),K1=function(){function n(t){var e=t.limit,r=e===void 0?5:e;this.workersByKey={},this.limit=r}return n.prototype.run=function(t,e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return this.workersByKey[t]||(this.workersByKey[t]=[]),this.workersByKey[t].length<this.limit?(this.workersByKey[t].push(e),[4,e()]):[3,2];case 1:return r=i.sent(),this.workersByKey[t].pop(),[2,r];case 2:throw H.tooManyRequests}})})},n.prototype.clear=function(t){this.workersByKey[t]=[]},n}();(function(n){n.DELIVERY_RECEIPT="delivery_receipt",n.PUSH_ACKNOWLEDGEMENT="push_acknowledgement"})(dd||(dd={}));var W,$1=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._pushAckedCache={},e}return w(t,n),t.prototype.isAcked=function(e,r){var i,a="".concat(e,"_").concat(r);return(i=this._pushAckedCache[a])!==null&&i!==void 0&&i},t.prototype.markAsAcked=function(e,r){var i="".concat(e,"_").concat(r);this._pushAckedCache[i]=!0},t.prototype.clear=function(){k.of(this._iid).logger.debug("clear push acked cache"),this._pushAckedCache={}},t.prototype.parseData=function(e){var r,i,a,s,u=k.of(this._iid).logger,o=e.sendbird;if(typeof o=="string")try{o=JSON.parse(o)}catch{throw u.info("push notification payload does not contain sendbird payload in JSON format."),H.malformedDataError}if(!o||typeof o!="object")throw u.info("push notification payload does not contain sendbird payload in JSON format."),H.malformedDataError;var l=(r=o.push_tracking_id)!==null&&r!==void 0?r:"",d=o.notification_message_id,c=o.notification_channel_key,f=o.notification_template_key,h=o.notification_event_deadline,m=(i=o.session_key)!==null&&i!==void 0?i:{},_=(a=m==null?void 0:m.key)!==null&&a!==void 0?a:"",E=(s=m==null?void 0:m.topics)!==null&&s!==void 0?s:[];if(typeof l!="string"||l.length===0)throw u.info("push tracking id is not available"),H.malformedDataError;if(typeof d!="string"||d.length===0)throw u.info("message id is not available"),H.malformedDataError;return{pushTrackingId:l,sessionKey:_,sessionTopics:E,messageId:d,channelKey:c,templateKey:f,notificationEventDeadline:h}},t}(Vt),fu=function(n){this.name=n.name,this._custom=n.custom,this._usedByModerationEngine=n.used_by_moderation_engine},W1=function(n){function t(){var e=n.call(this)||this;return e.method=J.GET,e.path=mT,e}return w(t,n),t}(ee),Y1=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.reportCategories=r.categories,i}return w(t,n),t}(ie),Q1=function(n){function t(e){var r=n.call(this,e)||this;return r._categories=[],r}return w(t,n),t.prototype.categories=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this._categories.length!==0?[3,2]:[4,this._fetchCategories()];case 1:e.sent(),e.label=2;case 2:return[2,this._categories]}})})},t.prototype._fetchCategories=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return e=k.of(this._iid).requestQueue,r=new W1,[4,e.send(r)];case 1:return i=u.sent(),(a=i.as(Y1).reportCategories)&&(s=this._categories).push.apply(s,Be([],we(a.map(function(o){return new fu(o)})),!1)),[2]}})})},t}(Vt),as={},k=function(){function n(t,e){var r,i,a,s,u,o,l,d,c;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!as[t]){as[t]=this;var f=(r=e.options)!==null&&r!==void 0?r:new _y,h=this.sdkState={appId:e.appId,appVersion:(i=e.appVersion)!==null&&i!==void 0?i:"",appState:"foreground",userId:void 0,extensions:{},api:{host:(a=e.apiHost)!==null&&a!==void 0?a:"https://api-".concat(e.appId,".sendbird.com")},websocket:{host:(s=e.websocketHost)!==null&&s!==void 0?s:"wss://ws-".concat(e.appId,".sendbird.com"),pingerDisabled:!!e.noPingpong,pingInterval:void 0,pongTimeout:void 0,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new Zy,responseTimeout:f.websocketResponseTimeout},sessionTokenRefreshTimeout:f.sessionTokenRefreshTimeout};this.appInfo=void 0,this.subscribedUnreadMessageCount={all:0,feed:0,customTypes:{},ts:0};var m=this.logger=e.logger;this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var _=this.cacheContext=new eT({encryption:e.encryption,store:e.store,localCacheEnabled:(u=e.localCacheEnabled)!==null&&u!==void 0&&u,localCacheConfig:(o=e.localCacheConfig)!==null&&o!==void 0?o:new Ey});this.debugMode=(l=e.debugMode)!==null&&l!==void 0&&l,this.maxSuperGroupChannelUnreadCount=ja.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=f.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=f.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=f.typingIndicatorThrottle,this.concurrentCallLimit=void 0,this.backOffDelay=void 0;var E=this.dispatcher=new rT,b=new tT;this.requestQueue=new H1(t,{session:b,sdkState:h,dispatcher:E,logger:m,useFetchCompat:e.useFetchCompat}),this.pushNotificationAckManager=new $1(t),this.sessionManager=new B1({_iid:t,session:b,cacheContext:_,sdkState:h,dispatcher:E,requestQueue:this.requestQueue,logger:m,pushNotificationAckManager:this.pushNotificationAckManager}),this.connectionManager=new L1(t,{sdkState:h,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:E,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:(d=e.disableWebSocketCloseEventHandling)!==null&&d!==void 0&&d,logger:m}),this.statManager=new z1({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:this.dispatcher,logger:m}),this.appStateToggleEnabled=(c=e.appStateToggleEnabled)===null||c===void 0||c,this.messageBackgroundSyncThrottleController=new K1({limit:5}),this.reportCategoryManager=new Q1(t)}return as[t]}return n.of=function(t){if(as[t])return as[t];throw H.lostInstance},n.clear=function(t){as[t]&&delete as[t]},n.prototype.hasExtension=function(t){return this.sdkState.extensions&&this.sdkState.extensions[t]},n}(),Kd=function(){function n(){}return n.prototype.init=function(t,e){var r=e.sdkState,i=e.dispatcher,a=e.sessionManager,s=e.requestQueue,u=e.logger;e.onlineDetector;var o=e.cacheContext;this._iid=t,this._cacheContext=o,this._sdkState=r,this._dispatcher=i,this._sessionManager=a,this._requestQueue=s,this._logger=u},n}();(function(n){n.UNKNOWN="UNKNOWN",n.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",n.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",n.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",n.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",n.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",n.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",n.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",n.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",n.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",n.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",n.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",n.EVENT_CHANNEL_BANNED="EVENT_CHANNEL_BANNED",n.EVENT_CHANNEL_UNBANNED="EVENT_CHANNEL_UNBANNED",n.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",n.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",n.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",n.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",n.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",n.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",n.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",n.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",n.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",n.EVENT_CHANNEL_METADATA_CREATED="EVENT_CHANNEL_METADATA_CREATED",n.EVENT_CHANNEL_METADATA_UPDATED="EVENT_CHANNEL_METADATA_UPDATED",n.EVENT_CHANNEL_METADATA_DELETED="EVENT_CHANNEL_METADATA_DELETED",n.EVENT_CHANNEL_METACOUNTER_CREATED="EVENT_CHANNEL_METACOUNTER_CREATED",n.EVENT_CHANNEL_METACOUNTER_UPDATED="EVENT_CHANNEL_METACOUNTER_UPDATED",n.EVENT_CHANNEL_METACOUNTER_DELETED="EVENT_CHANNEL_METACOUNTER_DELETED",n.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",n.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",n.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",n.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",n.REQUEST_CHANNEL="REQUEST_CHANNEL",n.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",n.REFRESH_CHANNEL="REFRESH_CHANNEL",n.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",n.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",n.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS",n.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",n.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",n.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",n.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",n.EVENT_MESSAGE_FEEDBACK_ADDED="EVENT_MESSAGE_FEEDBACK_ADDED",n.EVENT_MESSAGE_FEEDBACK_UPDATED="EVENT_MESSAGE_FEEDBACK_UPDATED",n.EVENT_MESSAGE_FEEDBACK_DELETED="EVENT_MESSAGE_FEEDBACK_DELETED",n.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",n.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",n.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",n.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",n.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",n.REQUEST_MESSAGE="REQUEST_MESSAGE",n.EVENT_THREAD_INFO_UPDATED="EVENT_THREADINFO_UPDATED",n.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",n.EVENT_POLL_VOTED="EVENT_POLL_VOTED",n.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",n.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",n.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",n.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",n.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",n.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",n.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",n.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",n.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",n.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",n.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"})(W||(W={}));var vu;D({},W);var la=function(n){return n.startsWith("EVENT_")||n.startsWith("LOCAL_MESSAGE_")||n===W.SYNC_MESSAGE_FILL||n===W.SYNC_MESSAGE_CHANGELOGS||n===W.SYNC_POLL_CHANGELOGS},mt=function(n){function t(e){var r=e.messages,i=e.source,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.messages=r,u.source=i,u.isWebSocketEventComing=s,u}return w(t,n),t}(bt),wp=function(n){function t(e){var r=e.messageIds,i=e.source,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.messageIds=r,u.source=i,u.isWebSocketEventComing=s,u}return w(t,n),t}(bt),ib=function(n){function t(e){var r=e.event,i=e.source,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.event=r,u.source=i,u.isWebSocketEventComing=s,u}return w(t,n),t}(bt),ab=function(n){function t(e){var r=e.event,i=e.source,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.event=r,u.source=i,u.isWebSocketEventComing=s,u}return w(t,n),t}(bt),sb=function(n){function t(e){var r=e.reqId,i=e.source,a=n.call(this)||this;return a.reqId=r,a.source=i,a}return w(t,n),t}(bt),ub=function(n){function t(e){var r=e.polls,i=e.source,a=n.call(this)||this;return a.polls=r,a.source=i,a}return w(t,n),t}(bt),Op=function(n){function t(e){var r=e.event,i=e.source,a=n.call(this)||this;return a.event=r,a.source=i,a}return w(t,n),t}(bt),$d=function(n){function t(e){var r=e.event,i=e.source,a=n.call(this)||this;return a.event=r,a.source=i,a}return w(t,n),t}(bt);(function(n){n.OPEN="open",n.CLOSED="closed"})(vu||(vu={}));var ob="removed",wf=function(n){switch(n){case"open":return vu.OPEN;case"closed":return vu.CLOSED;default:return null}},lb=function(n){return!n||!!n.text&&x("string",n.text)},Hl=function(n){function t(e,r){var i,a,s,u,o,l,d,c=this;return(c=n.call(this,e)||this).pollId=0,c.id=0,c.text=null,c.voteCount=0,c.createdBy=null,c.createdAt=0,c.updatedAt=0,c._lastVotedAt=0,c.pollId=(i=r.poll_id)!==null&&i!==void 0?i:0,c.id=(a=r.id)!==null&&a!==void 0?a:0,c.text=(s=r.text)!==null&&s!==void 0?s:null,c.voteCount=(u=r.vote_count)!==null&&u!==void 0?u:0,c.createdBy=(o=r.created_by)!==null&&o!==void 0?o:null,c.createdAt=(l=r.created_at)!==null&&l!==void 0?l:0,c.updatedAt=(d=r.updated_at)!==null&&d!==void 0?d:0,c}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{vote_count:e.voteCount,poll_id:e.pollId,text:e.text,created_at:e.createdAt,id:e.id,created_by:e.createdBy,updated_at:e.updatedAt})))},t}(Vt),gi=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h,m,_,E,b=this;return(b=n.call(this,e)||this).id=0,b.title=null,b.createdAt=0,b.updatedAt=0,b.closeAt=-1,b.status=vu.CLOSED,b.messageId=0,b.data=null,b.voterCount=-1,b.options=[],b.createdBy=null,b.allowUserSuggestion=!1,b.allowMultipleVotes=!1,b.votedPollOptionIds=[],b.id=(i=r.id)!==null&&i!==void 0?i:0,b.title=(a=r.title)!==null&&a!==void 0?a:null,b.createdAt=(s=r.created_at)!==null&&s!==void 0?s:0,b.updatedAt=(u=r.updated_at)!==null&&u!==void 0?u:0,b.closeAt=(o=r.close_at)!==null&&o!==void 0?o:-1,b.status=(l=wf(r.status))!==null&&l!==void 0?l:vu.CLOSED,b.messageId=(d=r.message_id)!==null&&d!==void 0?d:0,b.data=(c=r.data)!==null&&c!==void 0?c:null,b.voterCount=(f=r.voter_count)!==null&&f!==void 0?f:-1,b.options=r.options?r.options.map(function(g){return new Hl(b._iid,g)}):[],b.createdBy=(h=r.created_by)!==null&&h!==void 0?h:null,b.allowUserSuggestion=(m=r.allow_user_suggestion)!==null&&m!==void 0&&m,b.allowMultipleVotes=(_=r.allow_multiple_votes)!==null&&_!==void 0&&_,b.votedPollOptionIds=(E=r.voted_option_ids)!==null&&E!==void 0?E:[],b}return w(t,n),t.prototype._applyPollUpdatePayload=function(e){var r,i,a,s,u,o,l,d,c=this;this.title=(r=e.title)!==null&&r!==void 0?r:this.title,this.updatedAt=(i=e.updated_at)!==null&&i!==void 0?i:this.updatedAt,this.closeAt=(a=e.close_at)!==null&&a!==void 0?a:this.closeAt,this.status=(s=wf(e.status))!==null&&s!==void 0?s:this.status,this.data=(u=e.data)!==null&&u!==void 0?u:this.data,this.voterCount=(o=e.voter_count)!==null&&o!==void 0?o:this.voterCount,e.options&&(this.options=e.options.map(function(f){return new Hl(c._iid,f)}),this.votedPollOptionIds=e.options.filter(function(f){return f.vote_count>0}).map(function(f){return f.id})),this.allowUserSuggestion=(l=e.allow_user_suggestion)!==null&&l!==void 0?l:this.allowUserSuggestion,this.allowMultipleVotes=(d=e.allow_multiple_votes)!==null&&d!==void 0?d:this.allowMultipleVotes},t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{id:e.id,title:e.title,created_at:e.createdAt,updated_at:e.updatedAt,close_at:e.closeAt,status:e.status,message_id:e.messageId,data:e.data,voter_count:e.voterCount,options:e.options.map(function(r){return Hl.payloadify(r)}),created_by:e.createdBy,allow_user_suggestion:e.allowUserSuggestion,allow_multiple_votes:e.allowMultipleVotes,voted_option_ids:e.votedPollOptionIds})))},t.prototype.applyPollUpdateEvent=function(e){var r=e._payload.poll;return!(!r||this.id!==r.id||r.updated_at<this.updatedAt)&&(this._applyPollUpdatePayload(r),!0)},t.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return!1;var r=this.options,i=r.map(function(u){return u.id}),a=e._payload,s=Math.floor(a.ts/1e3);return a.updated_vote_counts.forEach(function(u){var o=i.indexOf(u.option_id);if(o>-1){var l=r[o];s>=l._lastVotedAt&&(l.voteCount=u.vote_count,l._lastVotedAt=s)}}),a.req_id&&a.voted_option_ids&&(this.votedPollOptionIds=a.voted_option_ids),typeof a.voter_count=="number"&&(this.voterCount=a.voter_count),!0},t.prototype.serialize=function(){return Au(this)},t}(Vt),Sa=function(){function n(t,e){var r;this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=t,this.limit=(r=e.limit)!==null&&r!==void 0?r:20}return Object.defineProperty(n.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),n.prototype._validate=function(){return x("number",this.limit)&&this.limit>0},n}(),ta=function(n){function t(e,r,i,a){var s=n.call(this,e,a)||this;return s.channelUrl=r,s.channelType=i,s}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("string",this.channelUrl)&&_n(wn,this.channelType)},t}(Sa),X1=function(n){this.pollId=0,this.messageId=0,this.pollId=n.poll_id,this.messageId=n.message_id,this._payload=n},Z1=function(n){function t(e){var r=e.title,i=e.optionTexts,a=e.data,s=e.allowUserSuggestion,u=e.allowMultipleVotes,o=e.closeAt,l=n.call(this)||this;return l.method=J.POST,l.path=ki,l.params={title:r,options:i,data:a,allow_user_suggestion:s,allow_multiple_votes:u,close_at:o},l}return w(t,n),t}(ee),J1=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new gi(e,r),i}return w(t,n),t}(ie),eN=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.pollId,s=n.call(this)||this;return s.method=J.GET,s.path="".concat(ki,"/").concat(encodeURIComponent(a)),s.params={channel_url:r,channel_type:i},s}return w(t,n),t}(ee),nN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new gi(e,r),i}return w(t,n),t}(ie),tN=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.pollId,s=e.pollOptionId,u=n.call(this)||this;return u.method=J.GET,u.path="".concat(ki,"/").concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(s)),u.params={channel_url:r,channel_type:i},u}return w(t,n),t}(ee),rN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pollOption=new Hl(e,r),i}return w(t,n),t}(ie),iN=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.timestamp,s=e.token,u=n.call(this)||this;return u.method=J.GET,u.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/polls/changelogs"),u.params=ge({change_ts:a,token:s}),u}return w(t,n),t}(ee),aN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.updatedPolls=r.updated.map(function(a){return function(s,u){return new gi(s,u)}(e,a)}),i.deletedPollIds=r.deleted.map(function(a){return a}),i.hasMore=r.has_more,i.nextToken=r.next,i}return w(t,n),t}(ie),sN={title:"",optionTexts:[],data:void 0,allowUserSuggestion:void 0,allowMultipleVotes:void 0,closeAt:-1},db=function(n){return x("string",n.title)&&(t=n.optionTexts,gn("string",t)&&t.every(function(e){return e.trim()!==""}))&&lb(n.data)&&x("boolean",n.allowUserSuggestion,!0)&&x("boolean",n.allowMultipleVotes,!0)&&x("number",n.closeAt,!0);var t},uN={channelUrl:"",channelType:wn.BASE,pollId:0,pollOptionId:0},cb=function(n){return x("string",n.channelUrl)&&n.channelUrl!==""&&_n(wn,n.channelType)&&x("number",n.pollId)&&n.pollId>0&&x("number",n.pollOptionId)&&n.pollOptionId>0},oN={channelUrl:"",channelType:wn.BASE,pollId:0},fb=function(n){return x("string",n.channelUrl)&&n.channelUrl!==""&&_n(wn,n.channelType)&&x("number",n.pollId)},v_={},cd=function(){function n(t,e){var r=e.sdkState,i=e.dispatcher,a=e.sessionManager,s=e.requestQueue,u=e.logger;this._iid=t,this._sdkState=r,this._sessionManager=a,this._requestQueue=s,this._dispatcher=i,this._logger=u,v_[t]=this}return n.of=function(t){return v_[t]},n.prototype.buildPollFromSerializedData=function(t){var e=$a(t);return new gi(this._iid,gi.payloadify(e))},n.prototype.get=function(t){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return ne(fb(t)).throw(H.invalidParameters),e=new eN(D({},t)),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(nN).poll]}})})},n.prototype.create=function(t){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return ne(db(t)).throw(H.invalidParameters),e=new Z1(D({},t)),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(J1).poll]}})})},n.prototype.getOption=function(t){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return ne(cb(t)).throw(H.invalidParameters),e=new tN(D({},t)),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(rN).pollOption]}})})},n.prototype.getPollChangeLogs=function(t,e,r,i){return i===void 0&&(i=W.SYNC_POLL_CHANGELOGS),y(this,void 0,void 0,function(){var a,s,u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:return a=new iN(Re({channelType:e,channelUrl:t,timestamp:typeof r=="number"?r:null,token:typeof r=="string"?r:null})),[4,this._requestQueue.send(a)];case 1:return s=f.sent(),u=s.as(aN),o=u.updatedPolls,l=u.deletedPollIds,d=u.hasMore,c=u.nextToken,o.length>0&&this._dispatcher.dispatch(new ub({polls:o,source:i})),[2,{updatedPolls:o,deletedPollIds:l,hasMore:d,token:c}]}})})},n}(),lN=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.token,s=e.limit,u=n.call(this)||this;return u.method=J.GET,u.path=ki,u.params={channel_url:r,channel_type:i,token:a,limit:s},u}return w(t,n),t}(ee),dN=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).polls=((i=r.polls)!==null&&i!==void 0?i:[]).map(function(s){return new gi(e,s)}),a.token=r.next,a}return w(t,n),t}(ie),hb=function(n){function t(e,r){return n.call(this,e,r.channelUrl,r.channelType,r)||this}return w(t,n),t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new lN(D(D({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(dN),s=a.polls,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),cN=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.pollId,s=e.pollOptionId,u=e.token,o=e.limit,l=n.call(this)||this;return l.method=J.GET,l.path="".concat(ki,"/").concat(encodeURIComponent(a),"/options/").concat(encodeURIComponent(s),"/voters"),l.params={channel_url:r,channel_type:i,token:u,limit:o},l}return w(t,n),t}(ee),fN=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).voters=((i=r.voters)!==null&&i!==void 0?i:[]).map(function(s){return new Mn(e,s)}),a.token=r.next,a}return w(t,n),t}(ie),pb=function(n){function t(e,r){var i=n.call(this,e,r.channelUrl,r.channelType,r)||this;return i.pollId=r.pollId,i.pollOptionId=r.pollOptionId,i}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("number",this.pollId)&&x("number",this.pollOptionId)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new cN(D(D({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(fN),s=a.voters,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),Us,Ta=function(){function n(t,e,r){var i,a;this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this._requireAuth=!1,this._iid=t,this.plainUrl=e.url,this.width=e.width,this.height=e.height,this.realWidth=(i=e.real_width)!==null&&i!==void 0?i:e.width,this.realHeight=(a=e.real_height)!==null&&a!==void 0?a:e.height,this._requireAuth=r}return n.payloadify=function(t){return ge(Re(t instanceof n?{url:t.plainUrl,width:t.width,height:t.height,real_width:t.realWidth,real_height:t.realHeight}:{url:"",width:t.maxWidth,height:t.maxHeight,real_width:0,real_height:0}))},Object.defineProperty(n.prototype,"url",{get:function(){var t=k.of(this._iid).sessionManager;return this._requireAuth&&t.ekey?"".concat(this.plainUrl,"?auth=").concat(t.ekey):this.plainUrl},enumerable:!1,configurable:!0}),n}(),fd=function(n){function t(e){var r=n.call(this)||this;if(r.method=J.POST,r.path="".concat(aT),r.params=ge({file:e.file,channel_url:e.channelUrl}),e.thumbnailSizes)for(var i=0;i<e.thumbnailSizes.length;i++){var a=e.thumbnailSizes[i],s=a.maxWidth,u=a.maxHeight;r.params["thumbnail".concat(i+1)]="".concat(s,",").concat(u)}return r.requestId=e.requestId,r}return w(t,n),t}(ee),hd=function(n){function t(e,r){var i,a,s,u,o=this;return(o=n.call(this,e,r)||this).url=r.url,o.fileSize=(i=r.file_size)!==null&&i!==void 0?i:0,o.thumbnails=(s=(a=r.thumbnails)===null||a===void 0?void 0:a.map(function(l){return new Ta(e,l,!1)}))!==null&&s!==void 0?s:[],o.requireAuth=(u=r.require_auth)!==null&&u!==void 0&&u,o}return w(t,n),t}(ie),pd=function(n){function t(e,r){var i,a,s,u,o,l=this;return(l=n.call(this,e)||this).replyCount=0,l.memberCount=0,l.lastRepliedAt=0,l.updatedAt=0,l.replyCount=(i=r.reply_count)!==null&&i!==void 0?i:0,l.memberCount=(a=r.member_count)!==null&&a!==void 0?a:0,l.mostRepliedUsers=r.most_replies&&gn("object",r.most_replies)?r.most_replies.map(function(d){return new Mn(l._iid,d)}):[],l.unreadReplyCount=(s=r.unread_message_count)!==null&&s!==void 0?s:0,l.isPushNotificationEnabled=typeof r.push_enabled=="number"?r.push_enabled>0:void 0,l.lastRepliedAt=(u=r.last_replied_at)!==null&&u!==void 0?u:0,l.updatedAt=(o=r.updated_at)!==null&&o!==void 0?o:0,l}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{reply_count:e.replyCount,unread_message_count:e.unreadReplyCount,member_count:e.memberCount,most_replies:Array.isArray(e.mostRepliedUsers)?e.mostRepliedUsers.map(function(r){return Mn.payloadify(r)}):[],push_enabled:typeof e.isPushNotificationEnabled=="boolean"?e.isPushNotificationEnabled?1:0:void 0,last_replied_at:e.lastRepliedAt,updated_at:e.updatedAt})))},Object.defineProperty(t.prototype,"_isUpdateRequired",{get:function(){return this.unreadReplyCount===void 0||this.isPushNotificationEnabled===void 0},enumerable:!1,configurable:!0}),t.prototype._updateFrom=function(e){var r,i;this.unreadReplyCount=(r=e.unreadReplyCount)!==null&&r!==void 0?r:this.unreadReplyCount,this.isPushNotificationEnabled=(i=e.isPushNotificationEnabled)!==null&&i!==void 0?i:this.isPushNotificationEnabled},t}(Vt);(function(n){n.ADD="add",n.DELETE="delete"})(Us||(Us={}));var ka,Rp=function(n){var t;this.messageId=0,this.operation=null,this.updatedAt=0;var e=x("string",n.msg_id)?parseInt(n.msg_id):n.msg_id,r=n.user_id,i=n.operation?n.operation.toLowerCase():null,a=n.reaction,s=n.updated_at,u=n.count,o=n.sampled_user_ids,l=(t=n.sampled_user_info)!==null&&t!==void 0?t:{};e&&x("string",r)&&x("string",i)&&_n(Us,i)&&x("string",a)&&a&&x("number",s)&&(this.messageId=e,this.userId=r,this.key=a,this.operation=i,this.updatedAt=s,this._count=u,this._sampledUserIds=o,this._sampledUserInfoList=l)},Fc=function(n){function t(e,r,i){var a,s=this;return(s=n.call(this,e)||this).userId=r,s.nickname=i.nickname,s.plainProfileUrl=i.profile_url,s.requireAuth=(a=i.require_auth_for_profile_image)!==null&&a!==void 0&&a,s}return w(t,n),Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=k.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.payloadify=function(e){return{nickname:e.nickname,profile_url:e.plainProfileUrl,require_auth_for_profile_image:e.requireAuth}},t}(Vt),xu=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h=this;(h=n.call(this,e)||this)._sampledUserInfoList=[],h._count=0,h._hasCurrentUserReacted=!1;var m=r.key,_=Be([],we((u=(s=r.sampled_user_ids)!==null&&s!==void 0?s:r.user_ids)!==null&&u!==void 0?u:[]),!1),E=(l=(o=r.last_ts)!==null&&o!==void 0?o:r.updated_at)!==null&&l!==void 0?l:0,b=(d=r.is_self_included)!==null&&d!==void 0?d:_.includes(k.of(e).sdkState.userId),g=(c=r.sampled_user_info)!==null&&c!==void 0?c:{};x("string",m)&&m&&gn("string",_)&&_.length>0&&x("number",E)&&(h.key=m,h._sampledUserIds=_,h._updatedAt=E,h._count=(f=r.count)!==null&&f!==void 0?f:_.length,h._hasCurrentUserReacted=b,Object.keys(g).forEach(function(I){h._sampledUserInfoList.push(new Fc(e,I,g[I]))}));var C={};try{for(var S=oe(h.sampledUserIds),A=S.next();!A.done;A=S.next())C[A.value]=h.updatedAt}catch(I){i={error:I}}finally{try{A&&!A.done&&(a=S.return)&&a.call(S)}finally{if(i)throw i.error}}return h._version=C,h}return w(t,n),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return this._count===0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userIds",{get:function(){return this._sampledUserIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sampledUserIds",{get:function(){return this._sampledUserIds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sampledUserInfoList",{get:function(){return this._sampledUserInfoList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updatedAt",{get:function(){return this._updatedAt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCurrentUserReacted",{get:function(){return this._hasCurrentUserReacted},enumerable:!1,configurable:!0}),t.payloadify=function(e){var r={};return e._sampledUserInfoList.forEach(function(i){r[i.userId]=Fc.payloadify(i)}),ge(Re({key:e.key,sampled_user_ids:e._sampledUserIds,sampled_user_info:r,count:e._count,is_self_included:e._hasCurrentUserReacted,last_ts:e._updatedAt}))},t.prototype.applyEvent=function(e){var r=this;if(e.key===this.key&&this.updatedAt<=e.updatedAt)if(e._sampledUserIds)this._sampledUserIds=e._sampledUserIds,this._sampledUserInfoList=[],Object.keys(e._sampledUserInfoList).forEach(function(a){r._sampledUserInfoList.push(new Fc(r._iid,a,e._sampledUserInfoList[a]))}),this._count=e._count,e._hasCurrentUserReacted!==void 0&&(this._hasCurrentUserReacted=e._hasCurrentUserReacted),this._updatedAt=e.updatedAt;else{if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var i=this._sampledUserIds.indexOf(e.userId);switch(e.operation){case Us.ADD:i<0&&this._sampledUserIds.push(e.userId);break;case Us.DELETE:i>=0&&this._sampledUserIds.splice(i,1)}this._count=this._sampledUserIds.length,this._version[e.userId]=e.updatedAt}this._updatedAt=Math.max(this.updatedAt,e.updatedAt)}},t}(Vt),y_=function(){function n(t){this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=t.url,t.secure_url&&(this.secureUrl=t.secure_url),t.type&&(this.type=t.type),t.width&&(this.width=t.width),t.height&&(this.height=t.height),t.alt&&(this.alt=t.alt)}return n.payloadify=function(t){var e,r;return ge(Re({url:t.url,secure_url:t.secureUrl,type:t.type,width:(e=t.width)!==null&&e!==void 0?e:0,height:(r=t.height)!==null&&r!==void 0?r:0,alt:t.alt}))},n}(),b_=function(){function n(t){this.title=null,this.url=null,this.description=null,this.defaultImage=null,t["og:title"]&&(this.title=t["og:title"]),t["og:url"]&&(this.url=t["og:url"]),t["og:description"]&&(this.description=t["og:description"]),t["og:image"]&&(this.defaultImage=new y_(t["og:image"]))}return n.payloadify=function(t){return ge(Re({"og:title":t.title,"og:url":t.url,"og:description":t.description,"og:image":t.defaultImage?y_.payloadify(t.defaultImage):null}))},n}(),Ei=function(){function n(t){var e,r;this.volume=0,this.name=(e=t.name)!==null&&e!==void 0?e:"default",this.volume=(r=t.volume)!==null&&r!==void 0?r:1}return n.prototype.serialize=function(){return{name:this.name,volume:this.volume}},n.payloadify=function(t){return ge(Re({name:t.name,volume:t.volume}))},n}();(function(n){n.GOOD="good",n.BAD="bad"})(ka||(ka={}));var ma=function(){function n(t){this.id=t.id,this.rating=t.rating,this.comment=t.comment}return n._getStatus=function(t){return t?"id"in t?"SUBMITTED":"NO_FEEDBACK":"NOT_APPLICABLE"},n._isSubmitted=function(t){return n._getStatus(t)==="SUBMITTED"},n._getPayloadByStatus=function(t){return t==="NO_FEEDBACK"?{}:null},n.payloadify=function(t){return ge(Re({id:t.id,rating:t.rating,comment:t.comment}))},n}(),yu=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).isBlockedByMe=!1,a.role=_n(ui,r.role)?r.role:ui.NONE,a.isBlockedByMe=(i=r.is_blocked_by_me)!==null&&i!==void 0&&i,a}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{role:e.role,is_blocked_by_me:e.isBlockedByMe})))},t}(Mn),Er=function(){function n(t){this.key=t.key,this.value=gn("string",t.value)?Be([],we(t.value),!1):[]}return n.payloadify=function(t){var e;return ge(Re({key:t.key,value:(e=t.value)!==null&&e!==void 0?e:[]}))},n}(),mb=function(n){switch(n){case At.BASE:return"";case At.USER:return"MESG";case At.FILE:return"FILE";case At.ADMIN:return"ADMM"}},_b=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h=this;(h=n.call(this,e)||this).channelType=wn.BASE,h.messageType=At.BASE,h.mentionType=null,h.mentionedUsers=null,h.mentionedUserIds=null,h.metaArrays=[],h.extendedMessage={},h.createdAt=0,h.updatedAt=0,h.channelUrl=r.channel_url,h.channelType=_n(wn,r.channel_type)?r.channel_type:wn.GROUP,r.channel&&(r.channel.channel_url&&(h.channelUrl=r.channel.channel_url),r.channel.channel_type&&(h.channelType=r.channel.channel_type)),h.data=(i=r.data)!==null&&i!==void 0?i:"",h.customType=(a=r.custom_type)!==null&&a!==void 0?a:"",h.mentionType=_n(lr,r.mention_type)?r.mention_type:null,h.mentionedUsers=r.mentioned_users?r.mentioned_users.map(function(g){return new Mn(h._iid,g)}):null,h.mentionedUserIds=(s=r.mentioned_user_ids)!==null&&s!==void 0?s:null,h.mentionedUsers&&!h.mentionedUserIds&&(h.mentionedUserIds=h.mentionedUsers.map(function(g){return g.userId}));var m=(u=r.metaarray)!==null&&u!==void 0?u:{},_=(o=r.metaarray_key_order)!==null&&o!==void 0?o:Object.keys(m).sort(function(g,C){return g.localeCompare(C)});h.metaArrays=[];for(var E=0;E<_.length;E++){var b=_[E];h.metaArrays.push(new Er({key:b,value:m[b]||[]}))}return r.sorted_metaarray&&(h.metaArrays=r.sorted_metaarray.map(function(g){return new Er(g)})),h.extendedMessage=(l=r.extended_message)!==null&&l!==void 0?l:{},h.extendedMessagePayload=r.extended_message_payload,h.createdAt=(c=(d=r.created_at)!==null&&d!==void 0?d:r.ts)!==null&&c!==void 0?c:0,h.updatedAt=(f=r.updated_at)!==null&&f!==void 0?f:0,h}return w(t,n),t.payloadify=function(e){var r,i;return ge(Re(D(D({},n.payloadify.call(this,e)),{channel_url:e.channelUrl,channel_type:e.channelType,type:mb(e.messageType),data:e.data,custom_type:e.customType,mention_type:e.mentionType,mentioned_user_ids:e.mentionedUserIds,mentioned_users:(r=e.mentionedUsers)===null||r===void 0?void 0:r.map(function(a){return Mn.payloadify(a)}),sorted_metaarray:(i=e.metaArrays)===null||i===void 0?void 0:i.map(function(a){return Er.payloadify(a)}),extended_message:e.extendedMessage,extended_message_payload:e.extendedMessagePayload,created_at:e.createdAt,updated_at:e.updatedAt})))},t.prototype.isIdentical=function(e){return!0},t.prototype.isEqual=function(e){return my(this,e)},t.prototype.isUserMessage=function(){return this.messageType===At.USER},t.prototype.isFileMessage=function(){return this.messageType===At.FILE&&!Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isMultipleFilesMessage=function(){return this.messageType===At.FILE&&Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isAdminMessage=function(){return this.messageType===At.ADMIN},t.prototype.serialize=function(){return Au(this)},t.prototype.getMetaArraysByKeys=function(e){return this.metaArrays.filter(function(r){return e.includes(r.key)})},t}(Vt),gb=function(n){function t(e,r){var i,a,s=this;return(s=n.call(this,e)||this).channelUrl=(i=r.channel_url)!==null&&i!==void 0?i:"",s.channelType=(a=r.channel_type)!==null&&a!==void 0?a:wn.GROUP,s.reader=new Mn(s._iid,r.user),s.readAt=r.ts,s}return w(t,n),t}(Vt),hN=function(n){function t(e){var r=e.channelUrl;return n.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:r}})||this}return w(t,n),t}(or);(function(n){function t(e){var r=n.call(this)||this,i=e.channelUrl,a=e.channelType,s=e.userId,u=e.notificationIds;return r.method=J.PUT,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/messages/mark_as_read"),r.params=ge(Re({user_id:s,message_ids:u})),r}return w(t,n),t})(ee);var Eb=function(n){function t(e,r,i){var a=n.call(this,e,"READ",i)||this;return a.readStatus=new gb(e,i),a}return w(t,n),t}(ft);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.readAt=r.ts,i.unreadMessageCount=r.unread_message_count,i}return w(t,n),t})(ie);var pN=function(n){function t(e){var r=e.channelUrl,i=e.messageId;return n.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:r,parent_message_id:i}})||this}return w(t,n),t}(or),mN=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.pushEnabled,u=n.call(this)||this;return u.method=J.PUT,u.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/thread_push"),u.params={push_enabled:s},u}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var _N=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.rating,u=e.comment,o=n.call(this)||this;return o.method=J.POST,o.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks"),o.params={rating:s,comment:u},o}return w(t,n),t}(ee),gN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.feedback=new ma(r),i}return w(t,n),t}(ie),EN=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.feedbackId,u=e.rating,o=e.comment,l=n.call(this)||this;return l.method=J.PUT,l.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks/").concat(s),l.params={rating:u,comment:o},l}return w(t,n),t}(ee),vN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.feedback=new ma(r),i}return w(t,n),t}(ie),yN=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.feedbackId,u=n.call(this)||this;return u.method=J.DELETE,u.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/feedbacks/").concat(s),u}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.feedback=new ma(r),i}w(t,n)})(ie);var ps,C_,Of=function(n){function t(e,r){var i,a,s,u,o,l=this;return(l=n.call(this,e)||this).plainUrl="",l.fileName=null,l.mimeType=null,l.fileSize=0,l.thumbnails=[],l._requireAuth=!1,l.plainUrl=(i=r.url)!==null&&i!==void 0?i:"",l.fileName=(a=r.file_name)!==null&&a!==void 0?a:null,l.mimeType=(s=r.file_type)!==null&&s!==void 0?s:null,l.fileSize=(u=r.file_size)!==null&&u!==void 0?u:0,l._requireAuth=(o=r.require_auth)!==null&&o!==void 0&&o,l.thumbnails=r.thumbnails?r.thumbnails.map(function(d){var c;return new Ta(l._iid,typeof d=="string"?{url:d,width:0,height:0}:D(D({},d),{url:((c=d.url)!==null&&c!==void 0?c:"").split("auth=")[0]}),l._requireAuth)}):[],l}return w(t,n),t.payloadify=function(e){var r;return ge(Re({url:e.plainUrl,file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:(r=e.thumbnails)===null||r===void 0?void 0:r.map(function(i){var a;return{url:((a=i.plainUrl)!==null&&a!==void 0?a:"").split("auth=")[0],width:i.width,height:i.height,real_width:i.realWidth,real_height:i.realHeight}}),require_auth:e._requireAuth}))},Object.defineProperty(t.prototype,"url",{get:function(){var e=k.of(this._iid).sessionManager;return this._requireAuth&&e.ekey?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t}(Vt),vb=function(n){var t=n.channelUrl,e=n.channelType,r=n.parentMessage;this.channelUrl=t,this.channelType=e,this.parentMessage=r};(function(n){n.NUMBER="number",n.ENUM="enum",n.TEXT="text",n.REGEX="regex",n.DECIMAL_PLACE="decimal_place"})(ps||(ps={})),function(n){n.TEXT="text",n.TEXTAREA="textarea",n.NUMBER="number",n.PHONE="phone",n.EMAIL="email",n.CHIP="chip"}(C_||(C_={}));var Ha,ii,S_=function(){function n(t,e){var r=e.id,i=e.name,a=e.items,s=e.version,u=e.is_submitted;this.messageId=t,this.id=r,this.name=i,this.items=a.map(function(o){return new T_(o)}).sort(function(o,l){return o.sortOrder-l.sortOrder}),this.version=s??1,this._isSubmitted=u}return Object.defineProperty(n.prototype,"isSubmitted",{get:function(){var t;return(t=this._isSubmitted)!==null&&t!==void 0?t:this.items.some(function(e){return Array.isArray(e.submittedValues)})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSubmittable",{get:function(){return this.items.every(function(t){return t.required?!!(Array.isArray(t.draftValues)&&t.draftValues.length>0)&&t.isValid(t.draftValues):!(Array.isArray(t.draftValues)&&t.draftValues.length>0)||t.isValid(t.draftValues)})},enumerable:!1,configurable:!0}),n.payloadify=function(t){return ge(Re({id:t.id,name:t.name,items:t.items.map(function(e){return T_.payloadify(e)}),version:t.version,is_submitted:t._isSubmitted}))},n.isMessageFormPayload=function(t){return!!(t!=null&&t.message_form)},n}(),T_=function(){function n(t){var e=t.id,r=t.name,i=t.required,a=t.sort_order,s=t.placeholder,u=t.style,o=t.item_type,l=t.validators,d=t.value,c=t.values;this.id=e,this.name=r,this.required=i,this.sortOrder=a,this.placeholder=s,Object.keys(u).length===0?this.style={layout:o}:this.style=ge({layout:u.layout,options:u.options,defaultOptions:u.default_options,resultCount:u.result_count}),c?this.submittedValues=c:d&&(this.submittedValues=[d]),this._validators=l}return n.prototype.isValid=function(t){var e=this;return t.every(function(r){var i=function(a,s){return s.every(function(u){switch(u.key){case ps.NUMBER:var o=Number(a);return!(isNaN(o)||u.min&&typeof u.min!="number"||u.max&&typeof u.max!="number"||typeof u.min=="number"&&o<u.min||typeof u.max=="number"&&o>u.max);case ps.ENUM:return typeof a=="string"&&(!(u.enums&&Array.isArray(u.enums)&&u.enums.length>0&&!u.enums.includes(a))||u.allow_other);case ps.TEXT:return!(typeof a!="string"||typeof u.min_length=="number"&&a.length<u.min_length||typeof u.max_length=="number"&&a.length>u.max_length);case ps.REGEX:return!(typeof a!="string"||u.regex&&(typeof u.regex!="string"||!new RegExp(u.regex).test(a)));case ps.DECIMAL_PLACE:return a.length!==0&&(o=Number(a),!(isNaN(o)||(!u.max_decimal_place||typeof u.max_decimal_place=="number")&&u.max_decimal_place&&!function(l,d){var c=l.toString(),f=c.indexOf(".");return f===-1||c.slice(f+1).length<=d}(o,u.max_decimal_place)));default:return!0}})}(r,e._validators);return i})},n.payloadify=function(t){return ge(Re({id:t.id,name:t.name,required:t.required,sort_order:t.sortOrder,placeholder:t.placeholder,style:ge({layout:t.style.layout,options:t.style.options,default_options:t.style.defaultOptions,result_count:t.style.resultCount}),item_type:t.style.layout,validators:t._validators,values:t.submittedValues}))},n}(),bN=function(n){function t(e){var r=n.call(this)||this;return r.method=J.POST,r.path="".concat(pT,"/").concat(e.formId,"/submit"),r.params=ge({message_id:e.messageId,items:e.items}),r}return w(t,n),t}(ee);(function(n){n.PENDING="pending",n.SENT="sent",n.FAILED="failed",n.CANCELED="canceled"})(Ha||(Ha={})),function(n){n.PENDING="pending",n.IN_QUEUE="in_queue",n.SENT="sent",n.FAILED="failed",n.CANCELED="canceled",n.REMOVED="removed"}(ii||(ii={}));var Ns,mr=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h=this;return(h=n.call(this,e,r)||this).parentMessage=null,h.silent=!1,h.isOperatorMessage=!1,h.threadInfo=null,h.reactions=[],h.appleCriticalAlertOptions=null,h.scheduledInfo=null,h.suggestedReplies=null,h.myFeedback=null,h.myFeedbackStatus="NOT_APPLICABLE",h.messageForm=null,h._isContinuousMessages=!1,h._scheduledStatus=null,h._poll=null,h.messageId=(a=(i=r.msg_id)!==null&&i!==void 0?i:r.message_id)!==null&&a!==void 0?a:0,h.parentMessageId=(s=typeof r.parent_message_id=="string"?parseInt(r.parent_message_id):r.parent_message_id)!==null&&s!==void 0?s:0,h.threadInfo=r.thread_info?new pd(h._iid,r.thread_info):null,r.reactions_summary?h.reactions=r.reactions_summary.map(function(m){return new xu(e,m)}):r.reactions?h.reactions=r.reactions.map(function(m){return new xu(e,m)}):h.reactions=[],h.ogMetaData=r.og_tag?new b_(r.og_tag):null,h.silent=(u=r.silent)!==null&&u!==void 0&&u,h.isOperatorMessage=(o=r.is_op_msg)!==null&&o!==void 0&&o,h.appleCriticalAlertOptions=r.apple_critical_alert_options?new Ei(r.apple_critical_alert_options):null,typeof r.scheduled_message_id=="number"&&typeof r.scheduled_at=="number"&&r.scheduled_status&&(h.scheduledInfo={scheduledMessageId:r.scheduled_message_id,scheduledAt:r.scheduled_at},h._scheduledStatus=r.scheduled_status),h._isContinuousMessages=(l=r.is_continuous_messages)!==null&&l!==void 0&&l,h.myFeedback=ma._isSubmitted(r.feedback)?new ma(r.feedback):null,h.myFeedbackStatus=ma._getStatus(r.feedback),h.suggestedReplies=(c=(d=r.extended_message_payload)===null||d===void 0?void 0:d.suggested_replies)!==null&&c!==void 0?c:null,h.messageForm=S_.isMessageFormPayload(r.extended_message_payload)?new S_(h.messageId,r.extended_message_payload.message_form):null,h.message=(f=r.message)!==null&&f!==void 0?f:"",h._poll=r.poll?new gi(h._iid,r.poll):null,h}return w(t,n),t.payloadify=function(e){var r,i;return ge(Re(D(D({},n.payloadify.call(this,e)),{message_id:e.messageId,parent_message_id:e.parentMessageId,thread_info:e.threadInfo?pd.payloadify(e.threadInfo):null,reactions_summary:e.reactions.map(function(a){return xu.payloadify(a)}),og_tag:e.ogMetaData?b_.payloadify(e.ogMetaData):null,silent:e.silent,is_op_msg:e.isOperatorMessage,apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,scheduled_message_id:(r=e.scheduledInfo)===null||r===void 0?void 0:r.scheduledMessageId,scheduled_at:(i=e.scheduledInfo)===null||i===void 0?void 0:i.scheduledAt,scheduled_status:e._scheduledStatus,feedback:e.myFeedback?ma.payloadify(e.myFeedback):ma._getPayloadByStatus(e.myFeedbackStatus),message:e.message,poll:e._poll?gi.payloadify(e._poll):null})))},t._getParentMessageInfoPayload=function(e){return ge(Re({type:mb(e.messageType),ts:e.createdAt,user:e.sender?yu.payloadify(e.sender):null,message:e.message,file:{url:e.plainUrl,name:e.name,type:e.type,require_auth:e.requireAuth},files:Array.isArray(e.fileInfoList)?e.fileInfoList.map(function(r){return Of.payloadify(r)}):null}))},t.prototype.isIdentical=function(e){return this.messageId===e.messageId},t.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(e.threadInfo._isUpdateRequired&&this.threadInfo&&e.threadInfo._updateFrom(this.threadInfo),this.threadInfo=e.threadInfo,!0)},t.prototype._findReactionIndex=function(e){for(var r=0;r<this.reactions.length;r++)if(this.reactions[r].key===e)return r;return-1},t.prototype.applyReactionEvent=function(e){var r=k.of(this._iid).sdkState;if(this.messageId===e.messageId)switch(e.operation){case Us.ADD:e.userId===r.userId&&(e._hasCurrentUserReacted=!0),(i=this._findReactionIndex(e.key))!==-1?this.reactions[i].applyEvent(e):e._sampledUserIds?this.reactions.push(new xu(this._iid,{key:e.key,sampled_user_ids:e._sampledUserIds,sampled_user_info:e._sampledUserInfoList,count:e._count,is_self_included:e._hasCurrentUserReacted,last_ts:e.updatedAt})):this.reactions.push(new xu(this._iid,{key:e.key,user_ids:[e.userId],updated_at:e.updatedAt}));break;case Us.DELETE:var i;(i=this._findReactionIndex(e.key))!==-1&&(e._sampledUserIds?e._count===0?this.reactions.splice(i,1):(e.userId===r.userId&&(e._hasCurrentUserReacted=!1),this.reactions[i].applyEvent(e)):(this.reactions[i].applyEvent(e),this.reactions[i].isEmpty&&this.reactions.splice(i,1)))}},t.prototype.applyParentMessage=function(e){if(!this.parentMessage)return this.parentMessage=e,!0;if(this.parentMessageId===e.messageId){var r=this.parentMessage.updatedAt;if(e.updatedAt>=r)return this.parentMessage=e,!0}return!1},t.prototype.applyPoll=function(e){return!(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt)&&(this._poll=e,!0)},Object.defineProperty(t.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),t.prototype._triggerThreadInfoUpdatedEvent=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(r){return(e=k.of(this._iid).dispatcher).dispatch(new vb({channelType:wn.GROUP,channelUrl:this.channelUrl,parentMessage:this})),e.dispatch(new mt({messages:[this],source:W.EVENT_MESSAGE_THREADINFO_UPDATED})),[2]})})},t.prototype.markThreadAsRead=function(){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=k.of(this._iid).requestQueue,r=new pN({channelUrl:this.channelUrl,messageId:this.messageId}),[4,e.send(r)];case 1:return i.sent(),this.threadInfo&&this.threadInfo.unreadReplyCount!==0?(this.threadInfo.unreadReplyCount=0,[4,this._triggerThreadInfoUpdatedEvent()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.setPushNotificationEnabled=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return r=k.of(this._iid).requestQueue,i=new mN({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,pushEnabled:e}),[4,r.send(i)];case 1:return a.sent(),this.threadInfo&&this.threadInfo.isPushNotificationEnabled!==e&&(this.threadInfo.isPushNotificationEnabled=e),[2]}})})},t.prototype.submitMessageForm=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:if(r=k.of(this._iid).requestQueue,i=null,a=null,s=this.messageForm,!e&&s){if(!s.isSubmittable)throw new H({code:Ne.INVALID_PARAMETER,message:"The form is not submittable. Please check all form items are valid before submitting."});if(s.isSubmitted)throw new H({code:Ne.INVALID_PARAMETER,message:"The form has already been submitted."});i=s.id,a=s.items.reduce(function(l,d){return l.push({form_item_id:d.id,values:Array.isArray(d.draftValues)?d.draftValues:[]}),l},[])}else e&&(i=e.formId,a=Object.entries(e.answers).reduce(function(l,d){var c=we(d,2),f=c[0],h=c[1],m=Number(f);if(Number.isNaN(m))throw new H({code:Ne.INVALID_PARAMETER,message:"Keys in answers must be numeric string."});return l.push({form_item_id:m,value:h}),l},[]));if(!i||!a)throw new H({code:Ne.INVALID_PARAMETER,message:"Missing one or more required inputs: formId, answers."});return u=new bN({messageId:this.messageId,formId:i,items:a}),[4,r.send(u)];case 1:return o.sent(),[2]}})})},t.prototype.submitFeedback=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return r=k.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new _N({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,rating:e.rating,comment:e.comment}),[4,i.send(s)];case 1:return u=l.sent(),o=u.as(gN),this.myFeedback=o.feedback,this.myFeedbackStatus="SUBMITTED",a.dispatch(new mt({messages:[this],source:W.EVENT_MESSAGE_FEEDBACK_ADDED})),[2]}})})},t.prototype.updateFeedback=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return r=k.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new EN({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:e.id,rating:e.rating,comment:e.comment}),[4,i.send(s)];case 1:return u=l.sent(),o=u.as(vN),this.myFeedback=o.feedback,this.myFeedbackStatus="SUBMITTED",a.dispatch(new mt({messages:[this],source:W.EVENT_MESSAGE_FEEDBACK_UPDATED})),[2]}})})},t.prototype.deleteFeedback=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return r=k.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new yN({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:e}),[4,i.send(s)];case 1:return u.sent(),this.myFeedback=null,this.myFeedbackStatus="NO_FEEDBACK",a.dispatch(new mt({messages:[this],source:W.EVENT_MESSAGE_FEEDBACK_DELETED})),[2]}})})},t}(_b),Dt=function(n){function t(e,r){var i,a,s,u,o=this;if((o=n.call(this,e,r)||this).reqId="",o.replyToChannel=!1,o.errorCode=0,o.sender=r.user?new yu(o._iid,r.user):r.sender_id,o.reqId=(a=(i=r.req_id)!==null&&i!==void 0?i:r.request_id)!==null&&a!==void 0?a:"",o.replyToChannel=(s=r.is_reply_to_channel)!==null&&s!==void 0&&s,r.request_state&&_n(Qn,r.request_state)&&(o.sendingStatus=r.request_state),!o.sendingStatus)if(o.messageId>0)o.sendingStatus=Qn.SUCCEEDED;else if(o.scheduledInfo)switch(r.scheduled_status&&(o._scheduledStatus=r.scheduled_status),r.scheduled_status){case ii.SENT:case ii.IN_QUEUE:o.sendingStatus=Qn.SUCCEEDED;break;case ii.PENDING:o.sendingStatus=Qn.SCHEDULED;break;case ii.FAILED:case ii.REMOVED:o.sendingStatus=Qn.FAILED;break;case ii.CANCELED:o.sendingStatus=Qn.CANCELED}else o.sendingStatus=Qn.PENDING;return o.errorCode=(u=r.error_code)!==null&&u!==void 0?u:0,o._messageToken=r.mesg_token,o}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{user:yu.payloadify(e.sender),req_id:e.reqId,is_reply_to_channel:e.replyToChannel,request_state:e.sendingStatus,error_code:e.errorCode,mesg_token:e._messageToken})))},Object.defineProperty(t.prototype,"isResendable",{get:function(){return(this.sendingStatus===Qn.FAILED||this.sendingStatus===Qn.CANCELED)&&ZS(this.errorCode)},enumerable:!1,configurable:!0}),t.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId},t}(mr),Ko={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:ur.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},Wd=function(n){return x("number",n.prevResultSize)&&x("number",n.nextResultSize)&&x("boolean",n.isInclusive)&&x("boolean",n.reverse)&&x("string",n.messageTypeFilter)&&_n(ur,n.messageTypeFilter)&&gn("string",n.customTypesFilter,!0)&&gn("string",n.senderUserIdsFilter,!0)&&x("boolean",n.includeMetaArray)&&x("boolean",n.includeReactions)&&x("boolean",n.includeParentMessageInfo)},ks=function(n){function t(e,r){var i,a,s,u=this;if((u=n.call(this,e,r)||this).translations={},u.messageType=At.ADMIN,u.translations=(i=r.translations)!==null&&i!==void 0?i:{},r.parent_message_info){var o=r.parent_message_info;u.parentMessage=dr(e,ge(Re(D(D({},o),{message_id:u.parentMessageId,channel_url:u.channelUrl,channel_type:u.channelType,file:o.file,url:(a=o.file)===null||a===void 0?void 0:a.url,require_auth:(s=o.file)===null||s===void 0?void 0:s.require_auth}))))}return u}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{translations:e.translations,parent_message_info:e.parentMessage?n._getParentMessageInfoPayload.call(this,e.parentMessage):null})))},t.prototype.getThreadedMessagesByTimestamp=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},Ko),r),ne(this.messageId>0&&x("number",e)&&Wd(i)).throw(H.invalidParameters),[4,zt.of(this._iid).getThreadedMessagesByTimestamp(this,e,i)];case 1:return[2,a.sent()]}})})},t}(mr),N_=function(){function n(t){var e,r;this.detail={},this.type=(e=t.type)!==null&&e!==void 0?e:"",this.vendor=(r=t.vendor)!==null&&r!==void 0?r:"",t.detail&&x("object",t.detail)&&!Array.isArray(t.detail)&&(this.detail=t.detail)}return n.payloadify=function(t){return ge(Re({type:t.type,vendor:t.vendor,detail:t.detail}))},n}(),I_=function(){function n(t){this.status=t.status,t.original_message_info&&(this.originalMessageInfo={createdAt:t.original_message_info.ts,messageId:t.original_message_info.id})}return n.payloadify=function(t){return ge({status:t.status,original_message_info:t.originalMessageInfo?{id:t.originalMessageInfo.messageId,ts:t.originalMessageInfo.createdAt}:void 0})},n}(),sr=function(n){function t(e,r){var i,a,s,u,o,l,d,c=this;if((c=n.call(this,e,r)||this).messageParams=null,c.mentionedMessageTemplate=void 0,c.translations={},c.translationTargetLanguages=[],c.messageSurvivalSeconds=-1,c.plugins=[],c.messageType=At.USER,c.translations=(s=r.translations)!==null&&s!==void 0?s:{},c.translationTargetLanguages=(u=r.target_langs)!==null&&u!==void 0?u:[],Object.keys(c.translations).length===0&&c.translationTargetLanguages.length>0)try{for(var f=oe(c.translationTargetLanguages),h=f.next();!h.done;h=f.next()){var m=h.value;c.translations[m]=""}}catch(E){i={error:E}}finally{try{h&&!h.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}if(c.mentionedMessageTemplate=r.mentioned_message_template,c.messageSurvivalSeconds=(o=r.message_survival_seconds)!==null&&o!==void 0?o:-1,c.plugins=r.plugins?r.plugins.map(function(E){return new N_(E)}):[],r.parent_message_info){var _=r.parent_message_info;c.parentMessage=dr(e,ge(Re(D(D({},_),{created_at:_.ts,message_id:c.parentMessageId,channel_url:c.channelUrl,channel_type:c.channelType,file:_.file,url:(l=_.file)===null||l===void 0?void 0:l.url,require_auth:(d=_.file)===null||d===void 0?void 0:d.require_auth}))))}return r.review_info&&(c.messageReviewInfo=new I_(r.review_info)),c}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{translations:e.translations,message_survival_seconds:e.messageSurvivalSeconds,mentioned_message_template:e.mentionedMessageTemplate,plugins:e.plugins.map(function(r){return N_.payloadify(r)}),parent_message_info:e.parentMessage?n._getParentMessageInfoPayload.call(this,e.parentMessage):null,review_info:e.messageReviewInfo?I_.payloadify(e.messageReviewInfo):void 0})))},t.prototype.getThreadedMessagesByTimestamp=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},Ko),r),ne(this.messageId>0&&x("number",e)&&Wd(i)).throw(H.invalidParameters),[4,zt.of(this._iid).getThreadedMessagesByTimestamp(this,e,i)];case 1:return[2,a.sent()]}})})},t}(Dt),oi=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f=this;if((f=n.call(this,e,r)||this).messageParams=null,f.fileInfoList=[],f.messageSurvivalSeconds=-1,f.messageType=At.FILE,f.data=(s=(a=(i=r.file)===null||i===void 0?void 0:i.data)!==null&&a!==void 0?a:r.custom)!==null&&s!==void 0?s:"",f.fileInfoList=(o=(u=r.files)===null||u===void 0?void 0:u.map(function(m){return new Of(e,m)}))!==null&&o!==void 0?o:[],f.messageSurvivalSeconds=(l=r.message_survival_seconds)!==null&&l!==void 0?l:-1,r.parent_message_info){var h=r.parent_message_info;f.parentMessage=dr(e,ge(Re(D(D({},h),{created_at:h.ts,message_id:f.parentMessageId,channel_url:f.channelUrl,channel_type:f.channelType,file:h.file,url:(d=h.file)===null||d===void 0?void 0:d.url,require_auth:(c=h.file)===null||c===void 0?void 0:c.require_auth}))))}return f}return w(t,n),t.prototype.getThreadedMessagesByTimestamp=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},Ko),r),ne(this.messageId>0&&x("number",e)&&Wd(i)).throw(H.invalidParameters),[4,zt.of(this._iid).getThreadedMessagesByTimestamp(this,e,i)];case 1:return[2,a.sent()]}})})},t.payloadify=function(e){var r,i,a,s,u,o;return ge(Re(D(D({},n.payloadify.call(this,e)),{file:{name:(i=(r=e.fileInfoList[0])===null||r===void 0?void 0:r.fileName)!==null&&i!==void 0?i:"",size:(s=(a=e.fileInfoList[0])===null||a===void 0?void 0:a.fileSize)!==null&&s!==void 0?s:0,type:(o=(u=e.fileInfoList[0])===null||u===void 0?void 0:u.mimeType)!==null&&o!==void 0?o:"",data:e.data},files:Array.isArray(e.fileInfoList)?e.fileInfoList.map(function(l){return Of.payloadify(l)}):null,message_survival_seconds:e.messageSurvivalSeconds,parent_message_info:e.parentMessage?n._getParentMessageInfoPayload.call(this,e.parentMessage):null})))},t._isMultipleFilesMessagePayload=function(e){var r=e.files;return Array.isArray(r)&&r.length>=2},t._isMultipleFilesMessageSerializedData=function(e){var r=e.fileInfoList;return Array.isArray(r)},t}(Dt);(function(n){n.SENT="SENT",n.READ="READ"})(Ns||(Ns={}));var xs=function(n){function t(e,r){var i,a,s=this;if((s=n.call(this,e,r)||this).notificationData=null,s.notificationId=r.notification_message_id,s.messageType=At.ADMIN,s.messageStatus=(i=r.message_status)!==null&&i!==void 0?i:Ns.SENT,s.priority=(a=r.priority)!==null&&a!==void 0?a:vf.NORMAL,s.notificationEventDeadline=r.notification_event_deadline,s.extendedMessage.sub_type===0)try{var u=JSON.parse(s.extendedMessage.sub_data),o=u.label,l=u.tags,d=l===void 0?[]:l,c=u.template_key,f=u.template_variables;s.notificationData={label:o,tags:d,templateKey:c,templateVariables:f}}catch{}return s}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{notification_message_id:e.notificationId,message_status:e.messageStatus,priority:e.priority,notification_event_deadline:e.notificationEventDeadline})))},t.prototype.isIdentical=function(e){return this.notificationId===e.notificationId},t}(_b),Rf=function(n){if(n.notificationId)return xs.payloadify(n);switch(n.messageType){case At.USER:return sr.payloadify(n);case At.FILE:return n.fileInfoList?oi.payloadify(n):Ft.payloadify(n);case At.ADMIN:return ks.payloadify(n);default:throw H.unknown}},dr=function(n,t){if(t.notification_message_id)return new xs(n,t);switch(t.type){case"MESG":return new sr(n,t);case"FILE":return oi._isMultipleFilesMessagePayload(t)?new oi(n,t):new Ft(n,t);case"ADMM":case"BRDM":return new ks(n,t);default:return null}},Ft=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h,m,_,E,b,g=this;(g=n.call(this,e,r)||this).messageParams=null,g.plainUrl="",g.requireAuth=!1,g.thumbnails=[],g.messageSurvivalSeconds=-1,g.messageType=At.FILE;var C=r.file;if(g.plainUrl=((a=(i=C==null?void 0:C.url)!==null&&i!==void 0?i:r.url)!==null&&a!==void 0?a:"").split("?auth=")[0],g.name=(u=(s=C==null?void 0:C.name)!==null&&s!==void 0?s:r.name)!==null&&u!==void 0?u:"File",g.size=(l=(o=C==null?void 0:C.size)!==null&&o!==void 0?o:r.size)!==null&&l!==void 0?l:0,g.data=(c=(d=C==null?void 0:C.data)!==null&&d!==void 0?d:r.custom)!==null&&c!==void 0?c:"",g.type=C?(f=C.type)!==null&&f!==void 0?f:"":(h=r.type)!==null&&h!==void 0?h:"",g.requireAuth=(m=r.require_auth)!==null&&m!==void 0&&m,g.thumbnails=r.thumbnails?r.thumbnails.map(function(A){var I;return new Ta(g._iid,typeof A=="string"?{url:A,width:0,height:0}:D(D({},A),{url:((I=A.url)!==null&&I!==void 0?I:"").split("auth=")[0]}),g.requireAuth)}):[],g.messageSurvivalSeconds=(_=r.message_survival_seconds)!==null&&_!==void 0?_:-1,r.parent_message_info){var S=r.parent_message_info;g.parentMessage=dr(e,ge(Re(D(D({},S),{created_at:S.ts,message_id:g.parentMessageId,channel_url:g.channelUrl,channel_type:g.channelType,file:S.file,url:(E=S.file)===null||E===void 0?void 0:E.url,require_auth:(b=S.file)===null||b===void 0?void 0:b.require_auth}))))}return g}return w(t,n),t.payloadify=function(e){var r;return ge(Re(D(D({},n.payloadify.call(this,e)),{url:e.plainUrl,require_auth:e.requireAuth,file:{name:e.name,size:e.size,type:e.type,data:e.data},thumbnails:(r=e.thumbnails)===null||r===void 0?void 0:r.map(function(i){return{url:i.plainUrl,width:i.width,height:i.height,real_width:i.realWidth,real_height:i.realHeight}}),message_survival_seconds:e.messageSurvivalSeconds,parent_message_info:e.parentMessage?n._getParentMessageInfoPayload.call(this,e.parentMessage):null})))},Object.defineProperty(t.prototype,"url",{get:function(){var e=k.of(this._iid).sessionManager;return this.requireAuth&&e.ekey?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t.prototype.getThreadedMessagesByTimestamp=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},Ko),r),ne(this.messageId>0&&x("number",e)&&Wd(i)).throw(H.invalidParameters),[4,zt.of(this._iid).getThreadedMessagesByTimestamp(this,e,i)];case 1:return[2,a.sent()]}})})},t}(Dt),md=function(n){function t(e,r){var i=r.file,a=r.fileUrl,s=r.fileName,u=r.fileSize,o=r.mimeType,l=r.thumbnailSizes,d=r._uploadedMetaData,c=r._thumbnails,f=n.call(this,e)||this;return f._plainUrl=a,f.file=i,f.fileName=s,f.fileSize=u,f.mimeType=o,f.thumbnailSizes=l,f._uploadedMetaData=d,f._thumbnails=c,f}return w(t,n),t.getPlainUrl=function(e){return e instanceof t?e._plainUrl:e.fileUrl},Object.defineProperty(t.prototype,"fileUrl",{get:function(){var e,r=k.of(this._iid).sessionManager;return this._plainUrl&&(!((e=this._uploadedMetaData)===null||e===void 0)&&e.requireAuth)&&r.ekey?"".concat(this._plainUrl,"?auth=").concat(r.ekey):this._plainUrl},set:function(e){this._plainUrl=e},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{file:this.file,fileUrl:this._plainUrl,fileName:this.fileName,fileSize:this.fileSize,mimeType:this.mimeType,thumbnailSizes:this.thumbnailSizes,_thumbnails:this._thumbnails,_uploadedMetaData:this._uploadedMetaData}},t}(Vt),CN=function(n){function t(e){var r,i,a,s,u=[];return e.mentionType===lr.USERS&&(e.mentionedUserIds?u=e.mentionedUserIds:e.mentionedUsers&&(u=e.mentionedUsers.map(function(o){return o.userId}))),n.call(this,{code:"FILE",ackRequired:!0,payload:ge(Re({channel_url:e.channelUrl,files:e.files?yb(e.files):null,url:e.url,name:(r=e.fileName)!==null&&r!==void 0?r:"",type:(i=e.mimeType)!==null&&i!==void 0?i:"",size:(a=e.fileSize)!==null&&a!==void 0?a:0,custom:e.data,custom_type:e.customType,thumbnails:(s=e._thumbnails)===null||s===void 0?void 0:s.map(function(o){return Ta.payloadify(o)}),require_auth:e.requireAuth,metaarray:e.metaArrays,mention_type:e.mentionType,mentioned_user_ids:u,push_option:e.pushNotificationDeliveryOption&&e.pushNotificationDeliveryOption!==Li.DEFAULT?e.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,silent:e.silent,reply_to_channel:e.isReplyToChannel,parent_message_id:e.parentMessageId?e.parentMessageId:null,req_id:e.reqId,poll_id:e.pollId,pin_message:e.isPinnedMessage,message:e.message}))})||this}return w(t,n),t}(or),SN=function(n){function t(e){var r,i,a=this;a=n.call(this)||this;var s=[];return e.mentionType===lr.USERS&&(e.mentionedUserIds?s=e.mentionedUserIds:e.mentionedUsers&&(s=e.mentionedUsers.map(function(u){return u.userId}))),a.method=J.POST,a.path="".concat(jn(e.channelType),"/").concat(encodeURIComponent(e.channelUrl),"/messages"),a.params=ge(Re({message_type:At.FILE,user_id:e.userId,files:e.files?yb(e.files):null,url:e.fileUrl,mention_type:e.mentionType,mentioned_user_ids:s,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,data:e.data,custom_type:e.customType,thumbnails:(r=e._thumbnails)===null||r===void 0?void 0:r.map(function(u){return Ta.payloadify(u)}),require_auth:e.requireAuth,sorted_metaarray:(i=e.metaArrays)===null||i===void 0?void 0:i.map(function(u){return Er.payloadify(u)}),push_option:e.pushNotificationDeliveryOption,parent_message_id:e.parentMessageId?e.parentMessageId:null,apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,reply_to_channel:e.isReplyToChannel,req_id:e.reqId,poll_id:e.pollId,pin_message:e.isPinnedMessage})),a}return w(t,n),t}(ee),Dp=function(n){function t(e,r,i){var a,s,u,o,l=this;(l=n.call(this,e,"FILE",i)||this).message=i.files&&i.files.length>=2?new oi(e,i):new Ft(e,i);var d=k.of(e).sdkState;return l.isMentioned=_u(l.message.mentionType,(u=(a=l.message.mentionedUserIds)!==null&&a!==void 0?a:(s=l.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(c){return c.userId}))!==null&&u!==void 0?u:[],d.userId),l.forceUpdateLastMessage=(o=i.force_update_last_message)!==null&&o!==void 0&&o,l}return w(t,n),t}(ft),TN=function(n){function t(e,r){var i,a,s,u,o=this;(o=n.call(this,e,r)||this).message=r.files&&r.files.length>=2?new oi(e,r):new Ft(e,r);var l=k.of(e).sdkState;return o.isMentioned=_u(o.message.mentionType,(s=(i=o.message.mentionedUserIds)!==null&&i!==void 0?i:(a=o.message.mentionedUsers)===null||a===void 0?void 0:a.map(function(d){return d.userId}))!==null&&s!==void 0?s:[],l.userId),o.forceUpdateLastMessage=(u=r.force_update_last_message)!==null&&u!==void 0&&u,o}return w(t,n),t}(ie);function yb(n){return n.map(function(t){var e,r;return ge(Re({url:md.getPlainUrl(t),file_name:t.fileName,file_type:t.mimeType,file_size:t.fileSize,thumbnails:(e=t._thumbnails)===null||e===void 0?void 0:e.map(function(i){return Ta.payloadify(i)}),require_auth:(r=t._uploadedMetaData)===null||r===void 0?void 0:r.requireAuth}))})}var $t;(function(n){n[n.PENDING=0]="PENDING",n[n.UPLOADING=1]="UPLOADING",n[n.UPLOADED=2]="UPLOADED",n[n.SENDING=3]="SENDING",n[n.FAILED=4]="FAILED"})($t||($t={}));var NN=function(){function n(t,e){var r=e.sdkState,i=e.dispatcher,a=e.requestQueue,s=e.onlineDetector,u=e.cacheContext,o=this;this._queueMap=new Map,this._iid=t,this._sdkState=r,this._requestQueue=a,this._cacheContext=u,this._dispatcher=i,this._dispatcher.on(function(l){l instanceof Kr&&(o._connectionState=l.stateType)}),this._onlineDetector=s}return Object.defineProperty(n.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===Wn.CONNECTED||this._connectionState===Wn.CONNECTING||this._connectionState===Wn.RECONNECTING},enumerable:!1,configurable:!0}),n.prototype._sendFileMessage=function(t,e){return y(this,void 0,void 0,function(){var r,i,a;return v(this,function(s){switch(s.label){case 0:return r=this._createSendFileMessageRequestParams(t,e),this._shouldSendThroughWebSocket?(i=new CN(r),[4,this._requestQueue.send(i)]):[3,2];case 1:return a=s.sent(),[2,a.as(Dp).message];case 2:return i=new SN(D(D({},r),{userId:this._sdkState.userId})),[4,this._requestQueue.send(i)];case 3:return a=s.sent(),[2,a.as(TN).message]}})})},n.prototype._createSendFileMessageRequestParams=function(t,e){var r=D(D({},e.params),{channelUrl:t.url,channelType:t.channelType,reqId:e.requestId,url:""});if(e.multipleFileUploadInfo){var i=e.params;r.files=i.fileInfoList}else i=e.params,r.url=i.fileUrl,r.requireAuth=i.requireAuth;return r},n.prototype._resolveMessageQueue=function(t){var e;return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c,f,h,m,_;return v(this,function(E){switch(E.label){case 0:if(!(r=this._queueMap.get(t.url)))return[3,21];if(r.isResolving)return[3,20];r.isResolving=!0,i=[],a=!0,E.label=1;case 1:E.trys.push([1,15,16,17]),s=oe(r.messageQueue),u=s.next(),E.label=2;case 2:if(u.done)return[3,14];switch(o=u.value,o.state){case $t.PENDING:case $t.UPLOADING:return[3,3];case $t.UPLOADED:return[3,4];case $t.FAILED:return[3,12]}return[3,13];case 3:return a=!1,i.push(o),[3,13];case 4:if(!a)return[3,10];E.label=5;case 5:return E.trys.push([5,8,,9]),o.state=$t.SENDING,[4,this._sendFileMessage(t,o)];case 6:return l=E.sent(),o.deferred.resolve(l),[4,Or(100)];case 7:return E.sent(),[3,9];case 8:return d=E.sent(),o.deferred.reject(d),[3,9];case 9:return[3,11];case 10:i.push(o),E.label=11;case 11:return[3,13];case 12:return c=(e=o.error)!==null&&e!==void 0?e:H.unknown,o.deferred.reject(c.code===Ne.REQUEST_CANCELED?H.fileUploadCanceled:c),[3,13];case 13:return u=s.next(),[3,2];case 14:return[3,17];case 15:return f=E.sent(),m={error:f},[3,17];case 16:try{u&&!u.done&&(_=s.return)&&_.call(s)}finally{if(m)throw m.error}return[7];case 17:return h=r.isResolveRequestPending,r.messageQueue=i,r.isResolving=!1,r.isResolveRequestPending=!1,h?[4,this._resolveMessageQueue(t)]:[3,19];case 18:E.sent(),E.label=19;case 19:return[3,21];case 20:r.isResolveRequestPending=!0,E.label=21;case 21:return[2]}})})},n.prototype._uploadNextPendingItem=function(t){var e;return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c,f;return v(this,function(h){switch(h.label){case 0:return(r=this._queueMap.get(t.url))&&(i=r.messageQueue.find(function(m){return m.state===$t.PENDING}))?i.multipleFileUploadInfo?(a=i.multipleFileUploadInfo,s=a.uploadIndex,u=a.uploadCount,o=a.requestHandler,f=i.params,l=f.fileInfoList[s],!Zt(l.file)||!((e=l._uploadedMetaData)===null||e===void 0)&&e.isUploaded?[3,2]:[4,this._tryUploadNextItemAndUpdateItemState(t,r,i)]):[3,4]:[3,9];case 1:return h.sent(),[3,3];case 2:i.state=s<u-1?$t.PENDING:$t.UPLOADED,h.label=3;case 3:return d=f.fileInfoList[s],c=i.multipleFileUploadInfo.uploadIndex++,i.multipleFileUploadInfo.isCopy||o==null||o._triggerOnFileUploaded(i.requestId,c,d,i.error),[3,7];case 4:return f=i.params,Zt(f.file)?[4,this._tryUploadNextItemAndUpdateItemState(t,r,i)]:[3,6];case 5:return h.sent(),[3,7];case 6:f.thumbnailSizes=[],i.state=$t.UPLOADED,h.label=7;case 7:return this._uploadNextPendingItem(t),[4,this._resolveMessageQueue(t)];case 8:h.sent(),h.label=9;case 9:return[2]}})})},n.prototype._tryUploadNextItemAndUpdateItemState=function(t,e,r){return y(this,void 0,void 0,function(){var i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return[4,this._onlineDetector.isOnline()];case 1:if(i=d.sent(),!k.of(this._iid).sessionManager.currentUser||!i)return r.error=H.connectionRequired,r.state=$t.FAILED,[2];if(!(e.uploadQueue.length<6))return[3,9];r.state=$t.UPLOADING,e.uploadQueue.push(r),d.label=2;case 2:return d.trys.push([2,7,,8]),r.multipleFileUploadInfo?(a=r.multipleFileUploadInfo,s=a.uploadIndex,u=a.uploadCount,o=r.params,[4,this._uploadNextFileForMultipleFilesItemAndUpdateParams(t,r,o)]):[3,4];case 3:return d.sent(),r.state=s<u-1?$t.PENDING:$t.UPLOADED,[3,6];case 4:return o=r.params,[4,this._uploadNextFileForSingleFileItemAndUpdateParams(t,r,o)];case 5:d.sent(),r.state=$t.UPLOADED,d.label=6;case 6:return[3,8];case 7:switch((l=d.sent()).code){case Ne.REQUEST_FAILED:r.error=new H({code:Ne.NETWORK_ERROR,message:"Failed to upload a file."});break;case Ne.REQUEST_CANCELED:r.error=H.fileUploadCanceled;break;default:r.error=l}return r.state=$t.FAILED,[3,8];case 8:this._dequeueUploadItem(e,r),d.label=9;case 9:return[2]}})})},n.prototype._dequeueUploadItem=function(t,e){var r=t.uploadQueue.findIndex(function(i){return i.requestId===e.requestId});r>=0&&t.uploadQueue.splice(r,1)},n.prototype._uploadNextFileForSingleFileItemAndUpdateParams=function(t,e,r){var i,a,s;return y(this,void 0,void 0,function(){var u,o,l,d,c,f,h,m,_,E;return v(this,function(b){switch(b.label){case 0:return u=new fd({file:r.file,channelUrl:t.url,thumbnailSizes:r.thumbnailSizes,requestId:e.requestId}),[4,this._requestQueue.send(u)];case 1:return o=b.sent(),l=o.as(hd),d=l.url,c=l.fileSize,f=c===void 0?r.fileSize:c,h=l.thumbnails,m=h===void 0?[]:h,_=l.requireAuth,E=_!==void 0&&_,r.fileName=(i=r.fileName)!==null&&i!==void 0?i:r.file.name,r.mimeType=(a=r.mimeType)!==null&&a!==void 0?a:r.file.type,r.fileSize=(s=r.fileSize)!==null&&s!==void 0?s:r.file.size,r.fileUrl=d,r.fileSize=f,r.requireAuth=E,r._thumbnails=m,[2]}})})},n.prototype._uploadNextFileForMultipleFilesItemAndUpdateParams=function(t,e,r){var i,a,s;return y(this,void 0,void 0,function(){var u,o,l,d,c,f,h,m,_,E,b;return v(this,function(g){switch(g.label){case 0:return u=e.multipleFileUploadInfo.uploadIndex,o=r.fileInfoList[u],l=new fd({file:o.file,channelUrl:t.url,thumbnailSizes:o.thumbnailSizes,requestId:e.requestId}),[4,this._requestQueue.send(l)];case 1:return d=g.sent(),c=d.as(hd),f=c.url,h=c.fileSize,m=h===void 0?o.fileSize:h,_=c.thumbnails,E=c.requireAuth,b=E!==void 0&&E,o.fileName=(i=o.fileName)!==null&&i!==void 0?i:o.file.name,o.mimeType=(a=o.mimeType)!==null&&a!==void 0?a:o.file.type,o.fileSize=(s=o.fileSize)!==null&&s!==void 0?s:o.file.size,o.file=void 0,o.fileUrl=f,o.fileSize=m,o._thumbnails=_,o._uploadedMetaData=D(D({},o._uploadedMetaData),{requireAuth:b,isUploaded:!0}),o instanceof md||(r.fileInfoList[u]=new md(this._iid,o)),[2]}})})},n.prototype.request=function(t,e,r,i){return i===void 0&&(i={}),y(this,void 0,void 0,function(){var a,s,u,o,l;return v(this,function(d){return this._queueMap.has(t.url)||(a={messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1},this._queueMap.set(t.url,a)),s=this._queueMap.get(t.url),u=new Tr,o={requestId:e,params:r,state:$t.PENDING,deferred:u},function(c){return"fileInfoList"in c}(r)&&(l=D({uploadIndex:0,uploadCount:r.fileInfoList.length},i),o.multipleFileUploadInfo=l),s.messageQueue.push(o),this._uploadNextPendingItem(t),[2,u.promise]})})},n.prototype.cancel=function(t,e){var r,i,a=this._queueMap.get(t.url);if(a){var s=e?[a.messageQueue.find(function(m){return m.requestId===e})]:Be([],we(a.messageQueue),!1);try{for(var u=oe(s),o=u.next();!o.done;o=u.next()){var l=o.value;if(l)switch(l.state){case $t.PENDING:if(l.state=$t.FAILED,l.error=H.requestCanceled,l.multipleFileUploadInfo&&!l.multipleFileUploadInfo.isCopy){var d=l.multipleFileUploadInfo,c=d.uploadIndex,f=d.requestHandler,h=l.params.fileInfoList[c];f==null||f._triggerOnFileUploaded(l.requestId,c,h,H.fileUploadCanceled)}this._resolveMessageQueue(t);break;case $t.UPLOADING:this._requestQueue.cancel(l.requestId),this._dispatcher.dispatch(new id({requestId:l.requestId}))}}}catch(m){r={error:m}}finally{try{o&&!o.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}else e&&(this._requestQueue.cancel(e),this._dispatcher.dispatch(new id({requestId:e})))},n}(),Df,vo={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:ur.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,replyType:Kt.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},A_=function(n){return x("number",n.prevResultSize)&&x("number",n.nextResultSize)&&x("boolean",n.isInclusive)&&x("boolean",n.reverse)&&x("string",n.messageTypeFilter)&&_n(ur,n.messageTypeFilter)&&gn("string",n.customTypesFilter,!0)&&gn("string",n.senderUserIdsFilter,!0)&&_n(Kt,n.replyType)&&x("boolean",n.includeMetaArray)&&x("boolean",n.includeReactions)&&x("boolean",n.includeParentMessageInfo)&&x("boolean",n.includeThreadInfo)&&x("boolean",n.showSubchannelMessagesOnly)},Lf={replyType:Kt.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},M_=function(n){return _n(Kt,n.replyType)&&x("boolean",n.includeReactions)&&x("boolean",n.includeMetaArray)&&x("boolean",n.includeParentMessageInfo)&&x("boolean",n.includeThreadInfo)},IN=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.includeMetaArray,u=e.includeReactions,o=e.includeThreadInfo,l=e.includeParentMessageInfo,d=n.call(this)||this;return d.method=J.GET,d.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(encodeURIComponent(a)),d.params={is_sdk:!0,with_sorted_meta_array:s,include_reactions_summary:u!=null&&u,include_thread_info:o,include_parent_message_info:l,include_poll_details:!0},d}return w(t,n),t}(ee),AN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=r?dr(e,D({},r)):null,i}return w(t,n),t}(ie),_l=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.timestamp,s=e.token,u=e.prevResultSize,o=e.nextResultSize,l=e.isInclusive,d=e.reverse,c=e.messageTypeFilter,f=e.customTypesFilter,h=e.senderUserIdsFilter,m=e.replyType,_=e.includeMetaArray,E=e.includeReactions,b=e.parentMessageId,g=e.includeThreadInfo,C=e.includeParentMessageInfo,S=e.showSubchannelMessagesOnly,A=e.checkingHasNext,I=e.checkingContinuousMessages,T=n.call(this)||this;return T.method=J.GET,T.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages"),T.params=ge(Re({is_sdk:!0,prev_limit:u,next_limit:o,include:l,reverse:d,message_ts:a,message_id:s,message_type:c??null,custom_types:f,sender_ids:h,include_reply_type:m,with_sorted_meta_array:_,include_reactions_summary:E,parent_message_id:b,include_thread_info:g,include_parent_message_info:C,show_subchannel_message_only:S,include_poll_details:!0,checking_has_next:A,checking_continuous_messages:I})),T}return w(t,n),t}(ee),gl=function(n){function t(e,r){var i=n.call(this,e,r)||this;return r.is_continuous_messages!==void 0&&(i.isContinuousMessages=r.is_continuous_messages),r.has_next!==void 0&&(i.hasNext=r.has_next),i.messages=r.messages.map(function(a){return dr(e,a)}),i}return w(t,n),t}(ie),MN=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.timestamp,s=e.token,u=e.replyType,o=e.includeMetaArray,l=e.includeReactions,d=e.includeThreadInfo,c=e.includeParentMessageInfo,f=n.call(this)||this;return f.method=J.GET,f.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/changelogs"),f.params={change_ts:a,token:s,with_sorted_meta_array:o,include_reactions_summary:l,include_thread_info:d,include_reply_type:u,include_parent_message_info:c,include_poll_details:!0},f}return w(t,n),t}(ee),wN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.updatedMessages=r.updated.map(function(a){return dr(e,a)}),i.deletedMessagesInfo=r.deleted.map(function(a){return{messageId:a.message_id,deletedAt:a.deleted_at}}),i.hasMore=r.has_more,i.nextToken=r.next,i.forceUseNextToken=r.force_use_next_token||!1,i}return w(t,n),t}(ie),ON=function(n){function t(e){var r=e.channelUrl,i=e.scheduledMessageId,a=n.call(this)||this;return a.method=J.GET,a.path="".concat(yr,"/").concat(encodeURIComponent(r),"/scheduled_messages/").concat(encodeURIComponent(i)),a.params={},a}return w(t,n),t}(ee),RN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=r?dr(e,D({},r)):null,i}return w(t,n),t}(ie);(function(n){n.MUTED="muted",n.BANNED="banned"})(Df||(Df={}));var w_=function(){function n(t){var e,r,i,a;this.restrictionType=null,_n(Df,t.restriction_type)&&(this.restrictionType=t.restriction_type),this.description=(e=t.description)!==null&&e!==void 0?e:null,this.endAt=(i=(r=t.end_at)!==null&&r!==void 0?r:t.muted_end_at)!==null&&i!==void 0?i:-1,this.remainingDuration=(a=t.remaining_duration)!==null&&a!==void 0?a:-1}return n.payloadify=function(t){return ge(Re({restriction_type:t.restrictionType,description:t.description,end_at:t.endAt,remaining_duration:t.remainingDuration}))},n}(),qs=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.restrictionInfo=new w_(r),i}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),w_.payloadify(e.restrictionInfo))))},t}(Mn),DN=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).isMuted=!1,a.isMuted=(i=r.is_muted)!==null&&i!==void 0&&i,a}return w(t,n),t}(Mn),Vr=function(){function n(){this._onPending=tn,this._onFailed=tn,this._onSucceeded=tn}return n.prototype._trigger=function(t){switch(t==null?void 0:t.sendingStatus){case Qn.PENDING:t.errorCode===0&&this._onPending(t);break;case Qn.SCHEDULED:case Qn.SUCCEEDED:this._onSucceeded(t)}},n.prototype._triggerFailed=function(t,e){switch(e==null?void 0:e.sendingStatus){case Qn.FAILED:case Qn.CANCELED:this._onFailed(t,e.scheduledInfo?null:e)}},n.prototype.onPending=function(t){return this._onPending=t,this},n.prototype.onFailed=function(t){return this._onFailed=t,this},n.prototype.onSucceeded=function(t){return this._onSucceeded=t,this},n}(),Yd={data:void 0,customType:void 0,mentionType:lr.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,metaArrays:void 0,parentMessageId:void 0,isReplyToChannel:!1,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0,isPinnedMessage:!1,pollId:void 0},Qd=function(n){return x("string",n.data,!0)&&x("string",n.customType,!0)&&_n(lr,n.mentionType)&&gn("string",n.mentionedUserIds,!0)&&gn(Mn,n.mentionedUsers,!0)&&gn(Er,n.metaArrays,!0)&&x("number",n.parentMessageId,!0)&&x("boolean",n.isReplyToChannel)&&_n(Li,n.pushNotificationDeliveryOption,!0)&&x(Ei,n.appleCriticalAlertOptions,!0)&&x("boolean",n.isPinnedMessage,!0)&&x("number",n.pollId,!0)},O_=function(n){return{isReplyToChannel:n.isReplyToChannel,pushNotificationDeliveryOption:n.pushNotificationDeliveryOption,pollId:n.pollId}},bb=D(D({},Yd),{message:"",mentionedMessageTemplate:void 0,translationTargetLanguages:void 0,extendedMessagePayload:void 0});function Cb(n){var t,e,r;return(t=n.messageParams)!==null&&t!==void 0?t:Re(D(D({},n),{mentionType:n.mentionType,mentionedUserIds:(e=n.mentionedUserIds)!==null&&e!==void 0?e:(r=n.mentionedUsers)===null||r===void 0?void 0:r.map(function(i){return i.userId}),mentionedMessageTemplate:n.mentionedMessageTemplate,translationTargetLanguages:Object.keys(n.translations),pushNotificationDeliveryOption:Li.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1}))}var Ms,Uf=function(n){var t;return ge(Re({data:n.data,customType:n.customType,mentionType:n.mentionType,mentionedUsers:n.mentionedUsers,mentionedUserIds:n.mentionedUserIds,mentionedMessageTemplate:n.mentionedMessageTemplate,metaArrays:n.metaArrays,pollId:(t=n.poll)===null||t===void 0?void 0:t.id,parentMessageId:n.parentMessageId,appleCriticalAlertOptions:n.appleCriticalAlertOptions,message:n.message,translationTargetLanguages:Object.keys(n.translations),extendedMessagePayload:n.extendedMessagePayload}))},Sb=function(n){return Qd(n)&&x("string",n.message)&&x("string",n.mentionedMessageTemplate,!0)&&gn("string",n.translationTargetLanguages,!0)&&x("object",n.extendedMessagePayload,!0)};(function(n){n.FILE="file",n.BLOB="blob",n.BLOB_LIKE_OBJECT="blobLikeObject",n.URL="url"})(Ms||(Ms={}));var Bl=function(n){return typeof window<"u"&&"Blob"in window&&typeof Blob<"u"&&n instanceof Blob},Hc=function(n){return n===Ms.BLOB||n===Ms.FILE},R_=function(n){return{file:n.file,fileKey:n.fileKey,fileType:n.fileType,isReplyToChannel:n.isReplyToChannel,pushNotificationDeliveryOption:n.pushNotificationDeliveryOption}},D_=D(D({},Yd),{file:void 0,fileKey:void 0,fileUrl:void 0,fileName:void 0,fileType:void 0,fileSize:void 0,mimeType:void 0,thumbnailSizes:void 0,requireAuth:!1,message:void 0});function Tb(n){var t,e,r,i;return(t=n.messageParams)!==null&&t!==void 0?t:Re(D(D({},n),{fileUrl:n.plainUrl,fileName:n.name,fileSize:n.size,mimeType:n.type,mentionType:n.mentionType,mentionedUserIds:(e=n.mentionedUserIds)!==null&&e!==void 0?e:(r=n.mentionedUsers)===null||r===void 0?void 0:r.map(function(a){return a.userId}),pushNotificationDeliveryOption:Li.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:(i=n.thumbnails)===null||i===void 0?void 0:i.map(function(a){return{maxWidth:a.width,maxHeight:a.height}}),requireAuth:n.requireAuth,isPinnedMessage:!1,_thumbnails:n.thumbnails,message:n.message}))}var yo,kf=function(n,t){var e,r;return n.messageParams?(!n.url&&Zt(t)&&(n.messageParams.file=t),n.messageParams):ge(Re({data:n.data,customType:n.customType,mentionType:n.mentionType,mentionedUsers:n.mentionedUsers,mentionedUserIds:n.mentionedUserIds,metaArrays:n.metaArrays,parentMessageId:n.parentMessageId,appleCriticalAlertOptions:n.appleCriticalAlertOptions,file:t,fileUrl:n.url,fileName:n.name,fileSize:n.size,mimeType:n.type,thumbnailSizes:(e=n.thumbnails)===null||e===void 0?void 0:e.map(function(i){return{maxWidth:i.width,maxHeight:i.height}}),message:n.message,pollId:(r=n.poll)===null||r===void 0?void 0:r.id}))},L_=function(n){return Qd(n)&&(Zt(n.file)||x("string",n.fileUrl))&&x("string",n.fileName,!0)&&x("string",n.mimeType,!0)&&x("number",n.fileSize,!0)&&x("string",n.message,!0)&&(n.thumbnailSizes===null||n.thumbnailSizes===void 0||Array.isArray(n.thumbnailSizes)&&n.thumbnailSizes.every(function(t){return x("object",t)&&t.maxWidth>0&&t.maxHeight>0}))},Lp={data:void 0,customType:void 0,mentionType:lr.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,metaArrays:void 0,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0},Up=function(n){return x("string",n.data,!0)&&x("string",n.customType,!0)&&_n(lr,n.mentionType)&&gn("string",n.mentionedUserIds,!0)&&gn(Mn,n.mentionedUsers,!0)&&gn(Er,n.metaArrays,!0)&&_n(Li,n.pushNotificationDeliveryOption,!0)&&x(Ei,n.appleCriticalAlertOptions,!0)},Nb=D(D({},Lp),{message:void 0,mentionedMessageTemplate:void 0,translationTargetLanguages:void 0,pollId:void 0}),Ib=function(n){return Up(n)&&x("string",n.mentionedMessageTemplate,!0)&&x("string",n.message,!0)&&gn("string",n.translationTargetLanguages,!0)&&x("number",n.pollId,!0)},LN=D({},Lp),UN=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.token,s=e.limit,u=n.call(this)||this;return u.method=J.GET,u.path="".concat(jn(i),"/").concat(encodeURIComponent(r),"/operators"),u.params={token:a,limit:s},u}return w(t,n),t}(ee),kN=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.operators=r.operators.map(function(a){return new Mn(e,a)}),i.token=r.next,i}return w(t,n),t}(ie),xN=function(n){function t(e,r,i,a){return n.call(this,e,r,i,a)||this}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,r=k.of(this._iid).requestQueue,i=new UN(D(D({},this),{channelUrl:this.channelUrl,token:this._token})),[4,r.send(i)]):[3,2]):[3,5];case 1:return a=l.sent(),s=a.as(kN),u=s.operators,o=s.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,u];case 2:return[2,e];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),PN=function(n){function t(e,r,i,a){var s,u,o,l,d,c,f,h,m,_,E=this;return(E=n.call(this,e,r,i,a)||this).reverse=!1,E.messageTypeFilter=ur.ALL,E.customTypesFilter=null,E.senderUserIdsFilter=null,E.replyType=Kt.NONE,E.includeMetaArray=!1,E.includeReactions=!1,E.includeParentMessageInfo=!1,E.includeThreadInfo=!1,E.showSubchannelMessagesOnly=!1,E._edge=Number.MAX_SAFE_INTEGER,E.reverse=(s=a.reverse)!==null&&s!==void 0&&s,E.messageTypeFilter=(u=a.messageTypeFilter)!==null&&u!==void 0?u:ur.ALL,E.customTypesFilter=(o=a.customTypesFilter)!==null&&o!==void 0?o:null,E.senderUserIdsFilter=(l=a.senderUserIdsFilter)!==null&&l!==void 0?l:null,E.replyType=(d=a.replyType)!==null&&d!==void 0?d:Kt.NONE,E.includeMetaArray=(c=a.includeMetaArray)!==null&&c!==void 0&&c,E.includeReactions=(f=a.includeReactions)!==null&&f!==void 0&&f,E.includeParentMessageInfo=(h=a.includeParentMessageInfo)!==null&&h!==void 0&&h,E.includeThreadInfo=(m=a.includeThreadInfo)!==null&&m!==void 0&&m,E.showSubchannelMessagesOnly=(_=a.showSubchannelMessagesOnly)!==null&&_!==void 0&&_,E}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("boolean",this.reverse)&&_n(ur,this.messageTypeFilter)&&_n(Kt,this.replyType)&&gn("string",this.customTypesFilter,!0)&&gn("string",this.senderUserIdsFilter,!0)&&x("boolean",this.includeMetaArray)&&x("boolean",this.includeReactions)&&x("boolean",this.includeParentMessageInfo)&&x("boolean",this.includeThreadInfo)&&x("boolean",this.showSubchannelMessagesOnly)},t.prototype.load=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,zt.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,Re({prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly}))]):[3,2]:[3,5];case 1:return e=r.sent(),this._edge=Math.min.apply(Math,Be([Number.MAX_SAFE_INTEGER],we(e.map(function(i){return i.createdAt})),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),FN=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.limit,u=e.token;return(r=n.call(this)||this).method=J.GET,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/mute"),r.params={limit:s,token:u},r}return w(t,n),t}(ee),HN=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.mutedUsers=[];var a=r.next,s=r.muted_list;return i.token=a,s&&s.length>0&&(i.mutedUsers=s.map(function(u){return new qs(e,u)})),i}return w(t,n),t}(ie),BN=function(n){function t(e,r,i,a){return n.call(this,e,r,i,a)||this}return w(t,n),t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new FN(D(D({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(HN),s=a.mutedUsers,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),GN=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.limit,u=e.token;return(r=n.call(this)||this).method=J.GET,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/ban"),r.params=ge({limit:s,token:u}),r}return w(t,n),t}(ee),VN=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.bannedUsers=[];var a=r.next,s=r.banned_list;return i.token=a,s&&s.length>0&&(i.bannedUsers=s.map(function(u){return new qs(e,u.user)})),i}return w(t,n),t}(ie),jN=function(n){function t(e,r,i,a){return n.call(this,e,r,i,a)||this}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new GN(D(D({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(VN),s=a.bannedUsers,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta);(function(n){n.SPAM="spam",n.HARASSING="harassing",n.SUSPICIOUS="suspicious",n.INAPPROPRIATE="inappropriate"})(yo||(yo={}));var qN=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.operatorUserIds;return(r=n.call(this)||this).method=J.POST,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/operators"),r.params={operator_ids:s},r}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var zN=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.operatorUserIds;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/operators"),r.params={operator_ids:s},r}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var KN=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId;return(r=n.call(this)||this).method=J.GET,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/mute/").concat(s),r}return w(t,n),t}(ee),$N=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.isMuted=!1,i.startAt=0,i.endAt=0;var a=r.is_muted,s=r.start_at,u=r.end_at,o=r.remaining_duration,l=r.description;return i.isMuted=a,i.startAt=s,i.endAt=u,i.remainingDuration=o,i.description=l,i}return w(t,n),t}(ie),U_=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.keys;return(r=n.call(this)||this).method=J.GET,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={keys:s,include_ts:!0},r}return w(t,n),t}(ee),k_=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.metadata,s=r.ts;return i.metadata=a,i.ts=s,i}return w(t,n),t}(ie),WN=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.metadata;return(r=n.call(this)||this).method=J.POST,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={metadata:s,include_ts:!0},r}return w(t,n),t}(ee),YN=function(n){function t(e,r){var i,a,s=this;return(s=n.call(this,e,r)||this).metaData=(i=r.metadata)!==null&&i!==void 0?i:{},s.ts=(a=r.ts)!==null&&a!==void 0?a:null,s}return w(t,n),t}(ie),QN=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.metadata,u=e.upsert;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={metadata:s,include_ts:!0,upsert:u!=null&&u},r}return w(t,n),t}(ee),XN=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.metadata,s=r.ts;return i.metadata=a,i.ts=s,i}return w(t,n),t}(ie),Ab=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return i.data&&(a.created=i.data.created,a.updated=i.data.updated,a.deleted=i.data.deleted),a}return w(t,n),t}(ft),ZN=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.key;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metadata/").concat(s),r.params={include_ts:!0},r}return w(t,n),t}(ee),JN=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.ts;return i.ts=a,i}return w(t,n),t}(ie),eI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metadata"),r.params={include_ts:!0},r}return w(t,n),t}(ee),nI=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.ts;return i.ts=a,i}return w(t,n),t}(ie),x_=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.keys;return(r=n.call(this)||this).method=J.GET,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={keys:s},r}return w(t,n),t}(ee),P_=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metaCounter=r,i}return w(t,n),t}(ie),tI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.metaCounter;return(r=n.call(this)||this).method=J.POST,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={metacounter:s},r}return w(t,n),t}(ee),rI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metaCounter=r,i}return w(t,n),t}(ie),Bc=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.metaCounter,u=e.upsert,o=u!==void 0&&u,l=e.mode,d=l===void 0?"set":l;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={metacounter:s,upsert:o,mode:d},r}return w(t,n),t}(ee),Gc=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.metaCounter=r,i}return w(t,n),t}(ie),Mb=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return i.data&&(a.created=i.data.created,a.updated=i.data.updated,a.deleted=i.data.deleted),a}return w(t,n),t}(ft),iI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.key;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metacounter/").concat(s),r.params={},r}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var aI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/metacounter"),r.params={},r}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var sI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId,u=e.seconds,o=e.description;return(r=n.call(this)||this).method=J.POST,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/mute"),r.params={user_id:s,seconds:u,description:o},r}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var wb=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new qs(e,i.data),a}return w(t,n),t}(ft),uI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/mute/").concat(encodeURIComponent(s)),r}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var Ob=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new qs(e,i.data),a}return w(t,n),t}(ft),oI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId,u=e.seconds,o=e.description;return(r=n.call(this)||this).method=J.POST,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/ban"),r.params=ge({user_id:s,seconds:u,description:o}),r}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var Rb=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new qs(e,i.data),i.data.member_count&&(a.memberCount=i.data.member_count),i.data.joined_member_count&&(a.joinedMemberCount=i.data.joined_member_count),a}return w(t,n),t}(ft),lI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.userId;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/ban/").concat(encodeURIComponent(s)),r}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var Db=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new qs(e,i.data),a}return w(t,n),t}(ft),F_=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.freezing;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(jn(a),"/").concat(encodeURIComponent(i),"/freeze"),r.params={freeze:s},r}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var Lb=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.freeze=i.data.freeze,a}return w(t,n),t}(ft),kp=function(n){return n instanceof fu?n._custom?"custom":n.name:n},xp=function(n){if(n instanceof fu&&n._custom)return n.name},dI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.category,u=e.userId,o=e.description;return(r=n.call(this)||this).method=J.POST,r.path="".concat(Cy(a),"/").concat(encodeURIComponent(i)),r.params=ge({report_category:kp(s),reporting_user_id:u,report_description:o,custom_report_category_name:xp(s)}),r}return w(t,n),t}(ee),cI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.category,u=e.userId,o=e.offendingUserId,l=e.description;return(r=n.call(this)||this).method=J.POST,r.path="".concat(bf,"/users/").concat(o),r.params=ge({channel_url:i,channel_type:a===wn.OPEN?"open_channels":"group_channels",report_category:kp(s),reporting_user_id:u,report_description:l,custom_report_category_name:xp(s)}),r}return w(t,n),t}(ee),fI=function(n){function t(e){var r=this,i=e.channelUrl,a=e.channelType,s=e.category,u=e.userId,o=e.offendingUserId,l=e.messageId,d=e.description;return(r=n.call(this)||this).method=J.POST,r.path="".concat(Cy(a),"/").concat(encodeURIComponent(i),"/messages/").concat(l),r.params=ge({report_category:kp(s),reporting_user_id:u,report_description:d,offending_user_id:o,custom_report_category_name:xp(s)}),r}return w(t,n),t}(ee),hI=function(n){function t(e){var r=[];return e.mentionType===lr.USERS&&(e.mentionedUserIds?r=e.mentionedUserIds:e.mentionedUsers&&(r=e.mentionedUsers.map(function(i){return i.userId}))),n.call(this,{code:"MESG",ackRequired:!0,payload:ge(Re({channel_url:e.channelUrl,message:e.message,data:e.data,custom_type:e.customType,metaarray:e.metaArrays,mention_type:e.mentionType,mentioned_user_ids:r,mentioned_message_template:e.mentionedMessageTemplate,target_langs:e.translationTargetLanguages,push_option:e.pushNotificationDeliveryOption&&e.pushNotificationDeliveryOption!==Li.DEFAULT?e.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:e.appleCriticalAlertOptions,silent:e.silent,reply_to_channel:e.isReplyToChannel,parent_message_id:e.parentMessageId?e.parentMessageId:null,req_id:e.reqId,poll_id:e.pollId,pin_message:e.isPinnedMessage,extended_message_payload:e.extendedMessagePayload}))})||this}return w(t,n),t}(or),Pp=function(n){function t(e,r,i){var a,s,u,o,l=this;(l=n.call(this,e,"MESG",i)||this).message=new sr(e,i);var d=k.of(e).sdkState;return l.isMentioned=_u(l.message.mentionType,(u=(a=l.message.mentionedUserIds)!==null&&a!==void 0?a:(s=l.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(c){return c.userId}))!==null&&u!==void 0?u:[],d.userId),l.forceUpdateLastMessage=(o=i.force_update_last_message)!==null&&o!==void 0&&o,l}return w(t,n),t}(ft),H_=function(n){function t(e){var r=null;return e.mentionType===lr.USERS&&(e.mentionedUserIds?r=e.mentionedUserIds:e.mentionedUsers&&(r=e.mentionedUsers.map(function(i){return i.userId}))),n.call(this,{code:"MEDI",ackRequired:!0,payload:ge(Re({channel_url:e.channelUrl,msg_id:e.messageId,message:e.message,data:e.data,custom_type:e.customType,metaarray:e.metaArrayParams,mention_type:e.mentionType,mentioned_user_ids:r,mentioned_message_template:e.mentionedMessageTemplate,apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,poll_id:e.pollId}))})||this}return w(t,n),t}(or),_d=function(n){function t(e,r,i){var a,s,u,o,l,d=this;(d=n.call(this,e,"MEDI",i)||this).message=new sr(e,i);var c=k.of(e).sdkState;return d.mentionCountChange=yp({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(u=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&u!==void 0?u:[]},Re({mentionType:d.message.mentionType,mentionedUserIds:(o=d.message.mentionedUserIds)!==null&&o!==void 0?o:(l=d.message.mentionedUsers)===null||l===void 0?void 0:l.map(function(f){return f.userId})}),c.userId),d}return w(t,n),t}(ft),B_=function(n){function t(e){var r=null;return e.mentionType===lr.USERS&&(e.mentionedUserIds?r=e.mentionedUserIds:e.mentionedUsers&&(r=e.mentionedUsers.map(function(i){return i.userId}))),n.call(this,{code:"FEDI",ackRequired:!0,payload:ge(Re({channel_url:e.channelUrl,msg_id:e.messageId,data:e.data,custom_type:e.customType,metaarray:e.metaArrayParams,mention_type:e.mentionType,mentioned_user_ids:r,apple_critical_alert_options:e.appleCriticalAlertOptions}))})||this}return w(t,n),t}(or),gd=function(n){function t(e,r,i){var a,s,u,o,l,d=this;(d=n.call(this,e,"FEDI",i)||this).message=new Ft(e,i);var c=k.of(e).sdkState;return d.mentionCountChange=yp({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(u=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&u!==void 0?u:[]},Re({mentionType:d.message.mentionType,mentionedUserIds:(o=d.message.mentionedUserIds)!==null&&o!==void 0?o:(l=d.message.mentionedUsers)===null||l===void 0?void 0:l.map(function(f){return f.userId})}),c.userId),d}return w(t,n),t}(ft),pI=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.reactionKey,u=n.call(this)||this;return u.method=J.POST,u.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/reactions"),u.params={reaction:s},u}return w(t,n),t}(ee),mI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.reactionEvent=new Rp(r),i}return w(t,n),t}(ie),_I=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.reactionKey,u=n.call(this)||this;return u.method=J.DELETE,u.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/reactions"),u.params={reaction:s},u}return w(t,n),t}(ee),gI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.reactionEvent=new Rp(D({},r)),i}return w(t,n),t}(ie),EI=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=e.translationTargetLanguages,u=n.call(this)||this;return u.method=J.POST,u.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(encodeURIComponent(a),"/translation"),u.params={target_langs:s},u}return w(t,n),t}(ee),vI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new sr(e,r),i}return w(t,n),t}(ie),yI=function(n){function t(e){var r,i=this;i=n.call(this)||this;var a=[];e.mentionType===lr.USERS&&(e.mentionedUserIds?a=e.mentionedUserIds:e.mentionedUsers&&(a=e.mentionedUsers.map(function(o){return o.userId})));var s=e.channelType,u=e.channelUrl;return i.method=J.POST,i.path="".concat(jn(s),"/").concat(encodeURIComponent(u),"/scheduled_messages"),i.params=ge(Re({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:mu.USER,message:e.message,custom_type:e.customType,data:e.data,mention_type:e.mentionType,mentioned_user_ids:a,sorted_metaarray:(r=e.metaArrays)===null||r===void 0?void 0:r.map(function(o){return Er.payloadify(o)}),apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,target_langs:e.translationTargetLanguages,push_option:e.pushNotificationDeliveryOption})),i}return w(t,n),t}(ee),Ub=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new sr(e,r),i}return w(t,n),t}(ie),bI=function(n){function t(e){var r,i,a=this;a=n.call(this)||this;var s=[];e.mentionType===lr.USERS&&(e.mentionedUserIds?s=e.mentionedUserIds:e.mentionedUsers&&(s=e.mentionedUsers.map(function(l){return l.userId})));var u=e.channelType,o=e.channelUrl;return a.method=J.POST,a.path="".concat(jn(u),"/").concat(encodeURIComponent(o),"/scheduled_messages"),a.params=Re({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:mu.FILE,url:e.fileUrl,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,thumbnails:(r=e._thumbnails)===null||r===void 0?void 0:r.map(function(l){return Ta.payloadify(l)}),custom_type:e.customType,data:e.data,require_auth:e.requireAuth,mention_type:e.mentionType,mentioned_user_ids:s,sorted_metaarray:(i=e.metaArrays)===null||i===void 0?void 0:i.map(function(l){return Er.payloadify(l)}),apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,push_option:e.pushNotificationDeliveryOption}),a}return w(t,n),t}(ee),CI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new Ft(e,r),i}return w(t,n),t}(ie),SI=function(n){function t(e){var r=e.pollId,i=e.title,a=e.data,s=e.allowUserSuggestion,u=e.allowMultipleVotes,o=e.closeAt,l=n.call(this)||this;return l.method=J.PUT,l.path="".concat(ki,"/").concat(encodeURIComponent(r)),l.params={title:i,data:a,allow_user_suggestion:s,allow_multiple_votes:u,close_at:o},l}return w(t,n),t}(ee),TI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new gi(e,r),i}return w(t,n),t}(ie),NI=function(n){function t(e){var r=e.pollId,i=n.call(this)||this;return i.method=J.DELETE,i.path="".concat(ki,"/").concat(encodeURIComponent(r)),i}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var II=function(n){function t(e){var r=e.pollId,i=n.call(this)||this;return i.method=J.PUT,i.path="".concat(ki,"/").concat(encodeURIComponent(r),"/close"),i}return w(t,n),t}(ee),AI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new gi(e,r),i}return w(t,n),t}(ie),MI=function(n){function t(e){var r=e.channelUrl,i=e.channelType,a=e.pollId,s=e.optionText,u=n.call(this)||this;return u.method=J.POST,u.path="".concat(ki,"/").concat(encodeURIComponent(a),"/options"),u.params={channel_url:r,channel_type:i,text:s},u}return w(t,n),t}(ee),wI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new gi(e,r),i}return w(t,n),t}(ie),OI=function(n){function t(e){var r=e.pollId,i=e.pollOptionId,a=e.optionText,s=n.call(this)||this;return s.method=J.PUT,s.path="".concat(ki,"/").concat(encodeURIComponent(r),"/options/").concat(encodeURIComponent(i)),s.params={text:a},s}return w(t,n),t}(ee),RI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.poll=new gi(e,r),i}return w(t,n),t}(ie),DI=function(n){function t(e){var r=e.pollId,i=e.pollOptionId,a=n.call(this)||this;return a.method=J.DELETE,a.path="".concat(ki,"/").concat(encodeURIComponent(r),"/options/").concat(encodeURIComponent(i)),a}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var LI=function(n){function t(e){var r=e.reqId,i=e.channelType,a=e.channelUrl,s=e.pollId,u=e.pollOptionIds;return n.call(this,{code:"VOTE",ackRequired:!0,payload:ge({req_id:r,channel_type:i===wn.OPEN?"open_channels":"group_channels",channel_url:a,poll_id:s,option_ids:u})})||this}return w(t,n),t}(or),Fp=function(n){function t(e,r,i){var a=n.call(this,e,"VOTE",i)||this;return a.event=new X1(i),a.channelUrl=i.channel_url,a.channelType=i.channel_type,a}return w(t,n),t}(ft),kb=100,xb="GroupChannel",UI="url",Pb=100,xf="Message",kI="messageId",Fb="NotificationMessage",xI="notificationId",PI="Poll",FI="pollId",HI="FeedChannel",BI="url";function GI(n){var t,e,r;return(t=n.messageParams)!==null&&t!==void 0?t:Re(D(D({},n),{isReplyToChannel:!1,mentionedUserIds:(e=n.mentionedUserIds)!==null&&e!==void 0?e:(r=n.mentionedUsers)===null||r===void 0?void 0:r.map(function(i){return i.userId}),pushNotificationDeliveryOption:Li.DEFAULT,isPinnedMessage:!1,fileInfoList:n.fileInfoList.map(function(i){var a;return{fileUrl:i.plainUrl,fileName:i.fileName,fileSize:i.fileSize,mimeType:i.mimeType,thumbnailSizes:(a=i.thumbnails)===null||a===void 0?void 0:a.map(function(s){return{maxWidth:s.width,maxHeight:s.height}}),_thumbnails:i.thumbnails,_uploadedMetaData:{requireAuth:i._requireAuth,isUploaded:!0}}})}))}var VI=D(D({},Yd),{fileInfoList:[],message:""}),jI=function(n){return(Zt(n.file)||x("string",n.fileUrl))&&x("string",n.fileName,!0)&&x("string",n.mimeType,!0)&&x("number",n.fileSize,!0)&&(n.thumbnailSizes===void 0||Array.isArray(n.thumbnailSizes)&&n.thumbnailSizes.every(function(t){return t.maxWidth>0&&t.maxHeight>0}))},Gl=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._onFileUploaded=tn,e}return w(t,n),t.prototype._triggerOnFileUploaded=function(e,r,i,a){this._onFileUploaded(e,r,i,a)},t.prototype.onFileUploaded=function(e){return this._onFileUploaded=e,this},t.prototype.onPending=function(e){return n.prototype.onPending.call(this,e),this},t.prototype.onFailed=function(e){return n.prototype.onFailed.call(this,e),this},t.prototype.onSucceeded=function(e){return n.prototype.onSucceeded.call(this,e),this},t}(Vr),qI=function(n){function t(e,r){var i=n.call(this,e)||this;return i.message=null,i.message=dr(e,r.message),i}return w(t,n),t}(Vt),zI=function(n){function t(e){var r=this,i=e.channelType,a=e.channelUrl,s=e.limit,u=e.token,o=e.includeReactions,l=e.includeMetaArray,d=e.includeParentMessageInfo,c=e.includeThreadInfo,f=e.includePollDetails;return(r=n.call(this)||this).method=J.GET,r.path="".concat(jn(i),"/").concat(encodeURIComponent(a),"/pinned_messages"),r.params=ge({limit:s,token:u,include_reactions_summary:o,with_sorted_meta_array:l,include_thread_info:c,include_parent_message_info:d,include_poll_details:f}),r}return w(t,n),t}(ee),KI=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.pinned_messages,s=r.has_more,u=r.next;return i.pinnedMessages=a.map(function(o){return new qI(e,o)}),i.hasMore=s,i.token=u,i}return w(t,n),t}(ie),$I=function(n){function t(e,r,i,a){var s=n.call(this,e,r,i,a)||this;return s.includeMetaArray=a.includeMetaArray,s.includeReactions=a.includeReactions,s.includeParentMessageInfo=a.includeParentMessageInfo,s.includeThreadInfo=a.includeThreadInfo,s.includePollDetails=a.includePollDetails,s}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("boolean",this.includeMetaArray,!0)&&x("boolean",this.includeReactions,!0)&&x("boolean",this.includeParentMessageInfo,!0)&&x("boolean",this.includeThreadInfo,!0)&&x("boolean",this.includePollDetails,!0)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new zI(D(D({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),a=i.as(KI),s=a.pinnedMessages,u=a.hasMore,o=a.token,this._token=o,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),WI=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=n.call(this)||this;return s.method=J.POST,s.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/pin"),s}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var YI=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.messageId,s=n.call(this)||this;return s.method=J.DELETE,s.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/").concat(a,"/pin"),s}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var ir,QI=2;(function(n){n.SEND="send",n.RESEND="resend",n.COPY="copy"})(ir||(ir={}));var vt,Ed=function(n){function t(e,r){var i,a,s,u,o,l,d,c=this;return(c=n.call(this,e)||this)._name="",c._createdAt=0,c.pinnedMessageIds=[],c.channelType=wn.BASE,c.coverUrl="",c.customType="",c.data="",c.isFrozen=!1,c.isEphemeral=!1,c.creator=null,c._messageCollectionLastAccessedAt=0,c._url=r.channel_url,c._name=(i=r.name)!==null&&i!==void 0?i:"",c._createdAt=1e3*r.created_at,c.coverUrl=(a=r.cover_url)!==null&&a!==void 0?a:"",c.customType=(s=r.custom_type)!==null&&s!==void 0?s:"",c.data=(u=r.data)!==null&&u!==void 0?u:"",c.isFrozen=(o=r.freeze)!==null&&o!==void 0&&o,c.isEphemeral=(l=r.is_ephemeral)!==null&&l!==void 0&&l,c.creator=r.created_by?new Mn(c._iid,r.created_by):null,r.metadata&&Object.keys(r.metadata).length>0&&r.ts?(c._cachedMetaData=new Map,Object.keys(r.metadata).forEach(function(f){c._cachedMetaData.set(f,{value:r.metadata[f],isRemoved:!1,updatedAt:r.ts})})):typeof r.metadata=="string"&&(c._cachedMetaData=new Map(Object.entries(JSON.parse(r.metadata)))),c.pinnedMessageIds=(d=r.pinned_message_ids)!==null&&d!==void 0?d:[],c}return w(t,n),Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return D(D({},this),{url:this._url,name:this._name,createdAt:this._createdAt})},t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{channel_url:e.url,name:e.name,cover_url:e.coverUrl,custom_type:e.customType,data:e.data,freeze:e.isFrozen,is_ephemeral:e.isEphemeral,created_by:e.creator?Mn.payloadify(e.creator):null,created_at:e.createdAt/1e3,metadata:e.cachedMetaData,pinned_message_ids:e.pinnedMessageIds})))},t.prototype.isGroupChannel=function(){return this.channelType===wn.GROUP},t.prototype.isOpenChannel=function(){return this.channelType===wn.OPEN},t.prototype.isFeedChannel=function(){return this.channelType===wn.FEED},Object.defineProperty(t.prototype,"cachedMetaData",{get:function(){var e={};return this._cachedMetaData&&this._cachedMetaData.forEach(function(r,i){r.isRemoved||(e[i]=r.value)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messageCollectionLastAccessedAt",{get:function(){return this._messageCollectionLastAccessedAt},enumerable:!1,configurable:!0}),t.prototype._serializeCachedMetaData=function(){return this._cachedMetaData?{cachedMetaData:JSON.stringify(Object.fromEntries(this._cachedMetaData))}:{}},t.prototype._updateMessageCollectionLastAccessedAt=function(){this._messageCollectionLastAccessedAt=Date.now()},t.prototype._update=function(e){Object.assign(this,e)},t.prototype._upsertCachedMetaData=function(e,r){var i=this;Object.keys(e).forEach(function(a){i._cachedMetaData||(i._cachedMetaData=new Map);var s=i._cachedMetaData.get(a);(!s||s.updatedAt<=r)&&i._cachedMetaData.set(a,{value:e[a],isRemoved:!1,updatedAt:r})})},t.prototype._updateCachedMetaData=function(e,r){var i=this,a=!1;return this._cachedMetaData?this._cachedMetaData.forEach(function(s,u){var o;s.updatedAt<=r&&(i._cachedMetaData.set(u,{value:(o=e[u])!==null&&o!==void 0?o:s.value,isRemoved:!e[u],updatedAt:r}),a=!0)}):(this._cachedMetaData=new Map,Object.keys(e).forEach(function(s){i._cachedMetaData.set(s,{value:e[s],isRemoved:!1,updatedAt:r})}),a=!0),{isUpdated:a}},t.prototype._removeFromCachedMetaData=function(e,r){var i=this;this._cachedMetaData&&e.forEach(function(a){var s=i._cachedMetaData.get(a);s&&s.updatedAt<r&&(s.isRemoved=!0,s.updatedAt=r)})},t.prototype._clearCachedMetaData=function(){this._cachedMetaData&&this._cachedMetaData.clear()},t.prototype._runIfHandleableWithGroupChannel=function(e){this.isGroupChannel()?e(this):this.isFeedChannel()&&e(this.groupChannel)},t.prototype._generateRequestId=function(){return"rq-".concat(ba())},t.prototype.isIdentical=function(e){return e&&this.url===e.url},t.prototype.isEqual=function(e){return my(this,e)},t.prototype.createOperatorListQuery=function(e){return e===void 0&&(e={}),new xN(this._iid,this.url,this.channelType,e)},t.prototype.createMutedUserListQuery=function(e){return e===void 0&&(e={}),new BN(this._iid,this.url,this.channelType,e)},t.prototype.createBannedUserListQuery=function(e){return e===void 0&&(e={}),new jN(this._iid,this.url,this.channelType,e)},t.prototype.createPreviousMessageListQuery=function(e){return e===void 0&&(e={}),new PN(this._iid,this.url,this.channelType,e)},t.prototype.createPinnedMessageListQuery=function(e){return e===void 0&&(e={}),new $I(this._iid,this.url,this.channelType,e)},t.prototype.addOperators=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return ne(gn("string",e)).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new qN({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.removeOperators=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return ne(gn("string",e)).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new zN({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.getMyMutedInfo=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d,c,f;return v(this,function(h){switch(h.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new KN({channelUrl:this.url,channelType:this.channelType,userId:r.userId}),[4,i.send(a)];case 1:return s=h.sent(),u=s.as($N),o=u.isMuted,l=u.startAt,d=u.endAt,c=u.remainingDuration,f=u.description,[2,{isMuted:o,startAt:l,endAt:d,remainingDuration:c,description:f}]}})})},t.prototype.getMetaData=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return ne(gn("string",e)).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new U_({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,r.send(i)];case 1:return a=l.sent(),s=a.as(k_),u=s.metadata,o=s.ts,this._upsertCachedMetaData(u,o),[2,u]}})})},t.prototype.getAllMetaData=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return e=k.of(this._iid).requestQueue,r=new U_({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(r)];case 1:return i=o.sent(),a=i.as(k_),s=a.metadata,u=a.ts,this._updateCachedMetaData(s,u),[2,s]}})})},t.prototype.createMetaData=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return r=k.of(this._iid).requestQueue,i=new WN({channelUrl:this.url,channelType:this.channelType,metadata:e}),[4,r.send(i)];case 1:return a=u.sent(),s=a.as(YN).metaData,this._upsertCachedMetaData(s,0),[2,s]}})})},t.prototype.updateMetaData=function(e,r){return r===void 0&&(r=!1),y(this,void 0,void 0,function(){var i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return i=k.of(this._iid).requestQueue,a=new QN({channelUrl:this.url,channelType:this.channelType,metadata:e,upsert:r}),[4,i.send(a)];case 1:return s=d.sent(),u=s.as(XN),o=u.metadata,l=u.ts,this._upsertCachedMetaData(o,l),[2,o]}})})},t.prototype.deleteMetaData=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(x("string",e)).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new ZN({channelUrl:this.url,channelType:this.channelType,key:e}),[4,r.send(i)];case 1:return a=u.sent(),s=a.as(JN).ts,this._removeFromCachedMetaData([e],s),[2]}})})},t.prototype.deleteAllMetaData=function(){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return e=k.of(this._iid).requestQueue,r=new eI({channelUrl:this.url,channelType:this.channelType}),[4,e.send(r)];case 1:return i=s.sent(),a=i.as(nI).ts,this._removeFromCachedMetaData(Be([],we(this._cachedMetaData.keys()),!1),a),[2]}})})},t.prototype.getMetaCounters=function(e){return y(this,void 0,void 0,function(){var r,i,a;return v(this,function(s){switch(s.label){case 0:return ne(gn("string",e)).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new x_({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(P_).metaCounter]}})})},t.prototype.getAllMetaCounters=function(){return y(this,void 0,void 0,function(){var e,r,i;return v(this,function(a){switch(a.label){case 0:return e=k.of(this._iid).requestQueue,r=new x_({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(r)];case 1:return i=a.sent(),[2,i.as(P_).metaCounter]}})})},t.prototype.createMetaCounters=function(e){return y(this,void 0,void 0,function(){var r,i,a;return v(this,function(s){switch(s.label){case 0:return r=k.of(this._iid).requestQueue,i=new tI({channelUrl:this.url,channelType:this.channelType,metaCounter:e}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(rI).metaCounter]}})})},t.prototype.updateMetaCounters=function(e,r){return r===void 0&&(r=!1),y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return i=k.of(this._iid).requestQueue,a=new Bc({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:r}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(Gc).metaCounter]}})})},t.prototype.increaseMetaCounters=function(e){return y(this,void 0,void 0,function(){var r,i,a;return v(this,function(s){switch(s.label){case 0:return r=k.of(this._iid).requestQueue,i=new Bc({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"increase"}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(Gc).metaCounter]}})})},t.prototype.decreaseMetaCounters=function(e){return y(this,void 0,void 0,function(){var r,i,a;return v(this,function(s){switch(s.label){case 0:return r=k.of(this._iid).requestQueue,i=new Bc({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"decrease"}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(Gc).metaCounter]}})})},t.prototype.deleteMetaCounter=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return ne(x("string",e)).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new iI({channelUrl:this.url,channelType:this.channelType,key:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.deleteAllMetaCounters=function(){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=k.of(this._iid).requestQueue,r=new aI({channelUrl:this.url,channelType:this.channelType}),[4,e.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.muteUser=function(e,r,i){return y(this,void 0,void 0,function(){return v(this,function(a){return[2,this.muteUserWithUserId(e.userId,r,i)]})})},t.prototype.muteUserWithUserId=function(e,r,i){return y(this,void 0,void 0,function(){var a,s;return v(this,function(u){switch(u.label){case 0:return ne(x("string",e)&&x("number",r,!0)&&x("string",i,!0)).throw(H.invalidParameters),a=k.of(this._iid).requestQueue,s=new sI({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:r,description:i}),[4,a.send(s)];case 1:return u.sent(),[2]}})})},t.prototype.unmuteUser=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2,this.unmuteUserWithUserId(e.userId)]})})},t.prototype.unmuteUserWithUserId=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return ne(x("string",e)).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new uI({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.banUser=function(e,r,i){return y(this,void 0,void 0,function(){return v(this,function(a){return[2,this.banUserWithUserId(e.userId,r,i)]})})},t.prototype.banUserWithUserId=function(e,r,i){return y(this,void 0,void 0,function(){var a,s;return v(this,function(u){switch(u.label){case 0:return ne(x("string",e)&&x("number",r,!0)&&x("string",i,!0)).throw(H.invalidParameters),a=k.of(this._iid).requestQueue,s=new oI({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:r,description:i}),[4,a.send(s)];case 1:return u.sent(),[2]}})})},t.prototype.unbanUser=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2,this.unbanUserWithUserId(e.userId)]})})},t.prototype.unbanUserWithUserId=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return ne(x("string",e)).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new lI({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.freeze=function(){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=k.of(this._iid).requestQueue,r=new F_({channelUrl:this.url,channelType:this.channelType,freezing:!0}),[4,e.send(r)];case 1:return i.sent(),this.isFrozen=!0,[2]}})})},t.prototype.unfreeze=function(){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=k.of(this._iid).requestQueue,r=new F_({channelUrl:this.url,channelType:this.channelType,freezing:!1}),[4,e.send(r)];case 1:return i.sent(),this.isFrozen=!1,[2]}})})},t.prototype.getMessagesByMessageId=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},vo),r),ne(x("number",e)&&A_(i)).throw(H.invalidParameters),[4,zt.of(this._iid).getMessagesByMessageId(this.url,this.channelType,e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getMessagesByTimestamp=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},vo),r),ne(x("number",e)&&A_(i)).throw(H.invalidParameters),[4,zt.of(this._iid).getMessagesByTimestamp(this.url,this.channelType,e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getMessageChangeLogsSinceTimestamp=function(e,r){return r===void 0&&(r={}),y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},Lf),r),ne(x("number",e)&&M_(i)).throw(H.invalidParameters),[4,zt.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getMessageChangeLogsSinceToken=function(e,r){return r===void 0&&(r={}),y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},Lf),r),ne(x("string",e)&&M_(i)).throw(H.invalidParameters),[4,zt.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,i)];case 1:return[2,a.sent()]}})})},t.prototype._createPendingSendableMessagePayload=function(e,r,i){var a,s=k.of(this._iid).sessionManager;return ge(Re({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:e.parentMessageId,data:e.data,custom_type:e.customType,mention_type:e.mentionType,sorted_metaarray:e.metaArrays?e.metaArrays.map(function(u){return Er.payloadify(u)}):null,apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,created_at:i,user:s.currentUser?yu.payloadify(s.currentUser):null,req_id:r,request_state:Qn.PENDING,mentioned_user_ids:e.mentionedUserIds,mentioned_users:(a=e.mentionedUsers)===null||a===void 0?void 0:a.map(function(u){return Mn.payloadify(u)})}))},t.prototype._createPendingUserMessage=function(e,r,i){var a,s,u={};if(e.translationTargetLanguages)try{for(var o=oe(e.translationTargetLanguages),l=o.next();!l.done;l=o.next())u[l.value]=""}catch(f){a={error:f}}finally{try{l&&!l.done&&(s=o.return)&&s.call(o)}finally{if(a)throw a.error}}var d=ge(D(D({},this._createPendingSendableMessagePayload(e,r,i)),{type:At.USER,message:e.message,translations:u,extended_message_payload:e.extendedMessagePayload})),c=new sr(this._iid,d);return c.messageParams=e,c},t.prototype._createPendingScheduledUserMessage=function(e,r,i){var a=this._createPendingUserMessage(e,r,i);return a.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},a},t.prototype._createPendingFileMessage=function(e,r,i){var a,s,u,o,l,d,c,f=ge(D(D({},this._createPendingSendableMessagePayload(e,r,i)),{type:At.FILE,url:e.fileUrl,file:{name:(a=e.fileName)!==null&&a!==void 0?a:(s=e.file)===null||s===void 0?void 0:s.name,size:(u=e.fileSize)!==null&&u!==void 0?u:(o=e.file)===null||o===void 0?void 0:o.size,type:(l=e.mimeType)!==null&&l!==void 0?l:(d=e.file)===null||d===void 0?void 0:d.type,data:e.data},thumbnails:(c=e._thumbnails)===null||c===void 0?void 0:c.map(function(m){return Ta.payloadify(m)}),message:e.message})),h=new Ft(this._iid,f);return h.messageParams=e,h},t.prototype._createPendingMultipleFilesMessage=function(e,r,i){var a=ge(D(D({},this._createPendingSendableMessagePayload(e,r,i)),{type:At.FILE,file:e.fileInfoList.length>0?{name:e.fileInfoList[0].fileName,size:e.fileInfoList[0].fileSize,type:e.fileInfoList[0].mimeType,data:e.data}:void 0,message:e.message})),s=new oi(this._iid,a);return s.messageParams=e,s},t.prototype._validateFailedFileMessageHasFile=function(e,r){var i;return!!e.url||Zt(r)||Zt((i=e.messageParams)===null||i===void 0?void 0:i.file)},t.prototype._createPendingScheduledFileMessage=function(e,r,i){var a=this._createPendingFileMessage(e,r,i);return a.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},a},t.prototype._markMessageAsFailed=function(e,r,i){i===void 0&&(i=!1),e.errorCode=r.code,r.code===Ne.REQUEST_CANCELED||r.code===Ne.FILE_UPLOAD_CANCEL_FAILED?e.sendingStatus=Qn.CANCELED:i||(e.sendingStatus=Qn.FAILED)},t.prototype.sendUserMessage=function(e){var r=D(D({},bb),e);return ne(Sb(r)).throw(H.invalidParameters),this._sendUserMessage(r)},t.prototype._sendUserMessage=function(e,r,i){var a=this;r===void 0&&(r=ir.SEND);var s=k.of(this._iid),u=s.dispatcher,o=s.requestQueue,l=i??this._generateRequestId(),d=Date.now(),c=new Vr;return Or(2).then(function(){var f=a._createPendingUserMessage(e,l,d);u.dispatch(new mt({messages:[f],source:r===ir.RESEND?W.LOCAL_MESSAGE_RESEND_STARTED:W.EVENT_MESSAGE_SENT_PENDING})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(m){return[2,c._trigger(f)]})})});var h=new hI(D(D({},e),{channelUrl:a.url,channelType:a.channelType,reqId:l}));o.send(h).then(function(m){var _=m.as(Pp).message;u.dispatch(new mt({messages:[_],source:W.EVENT_MESSAGE_SENT_SUCCESS})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(E){return[2,c._trigger(_)]})})})}).catch(function(m){if(gr(m))throw m;Or(2).then(function(){var _=a._createPendingUserMessage(e,l,d),E=k.of(a._iid).cacheContext,b=E.localCacheEnabled&&E.localCacheConfig.enableAutoResend&&nd(m.code);a._markMessageAsFailed(_,m,b),u.dispatch(new mt({messages:[_],source:_.sendingStatus===Qn.PENDING?W.REQUEST_RESEND_MESSAGE:W.EVENT_MESSAGE_SENT_FAILED})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(g){return[2,c._triggerFailed(m,_)]})})})})})}),c},t.prototype._autoResendUserMessage=function(e){return ne(e instanceof sr&&!!e.messageParams).throw(H.invalidParameters),this._sendUserMessage(e.messageParams,ir.SEND,e.reqId)},t.prototype.resendUserMessage=function(e){var r;return y(this,void 0,void 0,function(){var i,a;return v(this,function(s){return ne(e instanceof sr&&!e.scheduledInfo).throw(H.invalidParameters),i=new Tr,a=(r=e.messageParams)!==null&&r!==void 0?r:Uf(e),this._sendUserMessage(a,ir.RESEND,e.reqId).onFailed(function(u){return i.reject(u)}).onSucceeded(function(u){return i.resolve(u)}),[2,i.promise]})})},t.prototype.updateUserMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u;return v(this,function(o){switch(o.label){case 0:return i=D(D({},Nb),r),ne(x("number",e)&&Ib(i)).throw(H.invalidParameters),a=k.of(this._iid).requestQueue,s=new H_(D({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:i.metaArrays?{array:i.metaArrays,mode:"add",upsert:!0}:void 0},i)),[4,a.send(s)];case 1:return u=o.sent(),[2,u.as(_d).message]}})})},t.prototype.copyUserMessage=function(e,r){var i,a,s;return y(this,void 0,void 0,function(){var u,o;return v(this,function(l){return ne(e instanceof t&&r instanceof sr&&r.sendingStatus===Qn.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(H.invalidParameters),ne(!r.poll).throw(H.notSupportedError),u=new Tr,o=(i=r.messageParams)!==null&&i!==void 0?i:Re(D(D({},r),{mentionType:r.mentionType,mentionedUserIds:(a=r.mentionedUserIds)!==null&&a!==void 0?a:(s=r.mentionedUsers)===null||s===void 0?void 0:s.map(function(d){return d.userId}),translationTargetLanguages:Object.keys(r.translations),pushNotificationDeliveryOption:Li.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1})),e._sendUserMessage(o).onSucceeded(function(d){u.resolve(d)}).onFailed(function(d){return u.reject(d)}),[2,u.promise]})})},t.prototype.translateUserMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(e instanceof sr&&e.messageId>0&&gn("string",r)).throw(H.invalidParameters),i=k.of(this._iid).requestQueue,a=new EI({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,translationTargetLanguages:r}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(vI).message]}})})},t.prototype._createScheduledUserMessage=function(e,r){var i=this,a=k.of(this._iid).requestQueue,s=Date.now(),u=this._generateRequestId();Or(2).then(function(){var l=i._createPendingScheduledUserMessage(e,u,s);Ae(function(){return y(i,void 0,void 0,function(){return v(this,function(d){return[2,r._trigger(l)]})})})});var o=new yI(D({reqId:u,channelType:this.channelType,channelUrl:this.url},e));a.send(o).then(function(l){var d=l.as(Ub).message;Ae(function(){return y(i,void 0,void 0,function(){return v(this,function(c){return[2,r._trigger(d)]})})})}).catch(function(l){if(gr(l))throw l;Or(2).then(function(){var d=i._createPendingScheduledUserMessage(e,u,s);i._markMessageAsFailed(d,l),Ae(function(){return y(i,void 0,void 0,function(){return v(this,function(c){return[2,r._triggerFailed(l,d)]})})})})})},t.prototype.sendFileMessage=function(e){var r=D(D({},D_),e);return ne(L_(r)).throw(H.invalidParameters),this._sendFileMessage(r)},t.prototype.sendMultipleFilesMessage=function(e){var r,i=D(D({},VI),e),a=k.of(this._iid);ne(function(u,o){return o===void 0&&(o=I1),Qd(u)&&x("string",u.message,!0)&&Array.isArray(u.fileInfoList)&&u.fileInfoList.length>=2&&u.fileInfoList.length<=o&&u.fileInfoList.every(function(l){return jI(l)})}(i,(r=a.appInfo)===null||r===void 0?void 0:r.multipleFilesMessageFileCountLimit)).throw(H.invalidParameters);var s=!!e.fileInfoList.find(function(u){var o=a.appInfo.uploadSizeLimit;return u.file instanceof Blob&&u.file.size>o||u.fileSize>o});return ne(!s).throw(H.fileSizeLimitExceededError),this._sendMultipleFilesMessage(i)},t.prototype._sendFileMessage=function(e,r,i){var a=this;r===void 0&&(r=ir.SEND);var s=k.of(this._iid).dispatcher,u=zt.of(this._iid).fileMessageQueue,o=i??this._generateRequestId(),l=Date.now(),d=new Vr;return Or(2).then(function(){var c=a._createPendingFileMessage(e,o,l);s.dispatch(new mt({messages:[c],source:r===ir.RESEND?W.LOCAL_MESSAGE_RESEND_STARTED:W.EVENT_MESSAGE_SENT_PENDING})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(f){return[2,d._trigger(c)]})})}),u.request(a,o,e).then(function(f){s.dispatch(new mt({messages:[f],source:W.EVENT_MESSAGE_SENT_SUCCESS})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(h){return[2,d._trigger(f)]})})})}).catch(function(f){if(gr(f))throw f;Or(2).then(function(){var h=a._createPendingFileMessage(e,o,l),m=k.of(a._iid).cacheContext,_=m.localCacheEnabled&&m.localCacheConfig.enableAutoResend&&nd(f.code);a._markMessageAsFailed(h,f,_),s.dispatch(new mt({messages:[h],source:h.sendingStatus===Qn.PENDING?W.REQUEST_RESEND_MESSAGE:f.code===Ne.FILE_UPLOAD_CANCEL_FAILED?W.LOCAL_MESSAGE_CANCELED:W.EVENT_MESSAGE_SENT_FAILED})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(E){return[2,d._triggerFailed(f,h)]})})})})})}),d},t.prototype._autoResendFileMessage=function(e){ne(e instanceof Ft&&!!e.messageParams).throw(H.invalidParameters);var r=k.of(this._iid).logger;return r.debug("autoResendFileMessage pending",e),this._sendFileMessage(e.messageParams,ir.SEND,e.reqId).onFailed(function(i){r.debug("autoResendFileMessage failed",i)}).onSucceeded(function(i){r.debug("autoResendFileMessage success",i)})},t.prototype._sendMultipleFilesMessage=function(e,r,i){var a=this,s=k.of(this._iid).dispatcher,u=zt.of(this._iid).fileMessageQueue,o=i??this._generateRequestId(),l=Date.now(),d=new Gl;return Or(2).then(function(){var c=a._createPendingMultipleFilesMessage(e,o,l);s.dispatch(new mt({messages:[c],source:r===ir.RESEND?W.LOCAL_MESSAGE_RESEND_STARTED:W.EVENT_MESSAGE_SENT_PENDING})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(f){return[2,d._trigger(c)]})})}),u.request(a,o,e,{requestHandler:d,isCopy:r===ir.COPY}).then(function(f){s.dispatch(new mt({messages:[f],source:W.EVENT_MESSAGE_SENT_SUCCESS})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(h){return[2,d._trigger(f)]})})})}).catch(function(f){if(gr(f))throw f;Or(2).then(function(){var h=a._createPendingMultipleFilesMessage(e,o,l);a._markMessageAsFailed(h,f),s.dispatch(new mt({messages:[h],source:W.EVENT_MESSAGE_SENT_FAILED})),Ae(function(){return y(a,void 0,void 0,function(){return v(this,function(m){return[2,d._triggerFailed(f,h)]})})})})})}),d},t.prototype._createScheduledFileMessage=function(e,r,i,a){var s=this,u=k.of(this._iid).requestQueue,o=new bI(D(D({reqId:i,channelType:this.channelType,channelUrl:this.url},e),{fileUrl:e.fileUrl,requireAuth:e.requireAuth}));u.send(o).then(function(l){var d=l.as(CI).message;Ae(function(){return y(s,void 0,void 0,function(){return v(this,function(c){return[2,r._trigger(d)]})})})}).catch(function(l){if(gr(l))throw l;Or(2).then(function(){var d=s._createPendingScheduledFileMessage(e,i,a);s._markMessageAsFailed(d,l),Ae(function(){return y(s,void 0,void 0,function(){return v(this,function(c){return[2,r._triggerFailed(l,d)]})})})})})},t.prototype.sendFileMessages=function(e){var r,i;ne(e.every(function(l){return L_(D(D({},D_),l))})).throw(H.invalidParameters);var a=new Vr;try{for(var s=oe(e),u=s.next();!u.done;u=s.next()){var o=u.value;this.sendFileMessage(o).onPending(function(l){return a._trigger(l)}).onFailed(function(l,d){return a._triggerFailed(l,d)}).onSucceeded(function(l){return a._trigger(l)})}}catch(l){r={error:l}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a},t.prototype.resendFileMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){return i=this._validateFailedFileMessageHasFile(e,r),ne(e instanceof Ft&&i&&!e.scheduledInfo).throw(H.invalidParameters),a=new Tr,s=kf(e,r),this._sendFileMessage(s,ir.RESEND,e.reqId).onFailed(function(o){return a.reject(o)}).onSucceeded(function(o){return a.resolve(o)}),[2,a.promise]})})},t.prototype.resendMessage=function(e,r){var i,a;if(ne(e instanceof Dt&&!e.scheduledInfo&&e.isResendable).throw(H.invalidParameters),e.isUserMessage()){var s=(i=e.messageParams)!==null&&i!==void 0?i:Uf(e);return this._sendUserMessage(s,ir.RESEND,e.reqId)}if(e.isFileMessage()){var u=this._validateFailedFileMessageHasFile(e,r);return ne(u).throw(H.invalidParameters),s=(a=e.messageParams)!==null&&a!==void 0?a:kf(e,r),this._sendFileMessage(s,ir.RESEND,e.reqId)}if(e.isMultipleFilesMessage())throw H.channelTypeNotSupportedError},t.prototype.updateFileMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u;return v(this,function(o){switch(o.label){case 0:return i=D(D({},LN),r),ne(x("number",e)&&function(l){return Up(l)}(i)).throw(H.invalidParameters),a=k.of(this._iid).requestQueue,s=new B_(D({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:i.metaArrays?{array:i.metaArrays,mode:"add",upsert:!0}:void 0},i)),[4,a.send(s)];case 1:return u=o.sent(),[2,u.as(gd).message]}})})},t.prototype.uploadFile=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return r=k.of(this._iid).requestQueue,i=ba(),(a=new fd({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:i})).uploadProgressHandler=e.progressHandler,e.uploadStartedHandler&&e.uploadStartedHandler(i),[4,r.send(a)];case 1:return s=d.sent(),u=s.as(hd),o=u.url,l=u.thumbnails,[2,{requestId:i,url:o,thumbnails:l}]}})})},t.prototype.cancelUploadingFileMessage=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return ne(x("string",e)).throw(H.invalidParameters),zt.of(this._iid).fileMessageQueue.cancel(this,e),[2,!0]})})},t.prototype.copyFileMessage=function(e,r){var i,a,s;return y(this,void 0,void 0,function(){var u,o;return v(this,function(l){return ne(e instanceof t&&r instanceof Ft&&r.sendingStatus===Qn.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(H.invalidParameters),u=new Tr,o=Re(D(D({},r),{fileUrl:r.url,fileName:r.name,fileSize:r.size,mimeType:r.type,mentionType:r.mentionType,mentionedUserIds:(i=r.mentionedUserIds)!==null&&i!==void 0?i:(a=r.mentionedUsers)===null||a===void 0?void 0:a.map(function(d){return d.userId}),pushNotificationDeliveryOption:Li.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:(s=r.thumbnails)===null||s===void 0?void 0:s.map(function(d){return{maxWidth:d.width,maxHeight:d.height}}),requireAuth:r.requireAuth,isPinnedMessage:!1})),e._sendFileMessage(o).onSucceeded(function(d){return u.resolve(d)}).onFailed(function(d){return u.reject(d)}),[2,u.promise]})})},t.prototype.copyMessage=function(e,r){ne(e instanceof t&&r instanceof Dt&&r.sendingStatus===Qn.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(H.invalidParameters);var i=r,a=e;if(i.isUserMessage()){ne(!i.poll).throw(H.notSupportedError);var s=Cb(i);return a._sendUserMessage(s)}if(i.isFileMessage())return s=Tb(i),a._sendFileMessage(s);if(r.isMultipleFilesMessage())throw H.channelTypeNotSupportedError},t.prototype.deleteMessage=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return ne(e instanceof mr).throw(H.invalidParameters),e.messageId>0?(r=k.of(this._iid).requestQueue,i=new Ny({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,messageToken:e instanceof Dt?e._messageToken:void 0}),[4,r.send(i)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},t.prototype.addReaction=function(e,r){return y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(e instanceof mr&&e.messageId>0&&x("string",r)).throw(H.invalidParameters),i=k.of(this._iid).requestQueue,a=new pI({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:r}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(mI).reactionEvent]}})})},t.prototype.deleteReaction=function(e,r){return y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(e instanceof mr&&e.messageId>0&&x("string",r)).throw(H.invalidParameters),i=k.of(this._iid).requestQueue,a=new _I({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:r}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(gI).reactionEvent]}})})},t.prototype._updateUserMessageMetaArray=function(e,r,i,a){return y(this,void 0,void 0,function(){var s,u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:return s=k.of(this._iid),u=s.dispatcher,o=s.requestQueue,l=new H_({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:r,mode:i,upsert:a}}),[4,o.send(l)];case 1:return d=f.sent(),c=d.as(_d).message,u.dispatch(new mt({messages:[c],source:W.EVENT_MESSAGE_UPDATED})),[2,c]}})})},t.prototype._updateFileMessageMetaArray=function(e,r,i,a){return y(this,void 0,void 0,function(){var s,u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:return s=k.of(this._iid),u=s.dispatcher,o=s.requestQueue,l=new B_({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:r,mode:i,upsert:a}}),[4,o.send(l)];case 1:return d=f.sent(),c=d.as(gd).message,u.dispatch(new mt({messages:[c],source:W.EVENT_MESSAGE_UPDATED})),[2,c]}})})},t.prototype.createMessageMetaArrayKeys=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){return ne(e instanceof mr&&e.messageId>0&&gn("string",r)).throw(H.invalidParameters),i=r.map(function(s){return new Er({key:s})}),e instanceof Ft?[2,this._updateFileMessageMetaArray(e.messageId,i,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,i,"add",!0)]})})},t.prototype.deleteMessageMetaArrayKeys=function(e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){return ne(e instanceof mr&&e.messageId>0&&gn("string",r)).throw(H.invalidParameters),i=r.map(function(s){return new Er({key:s})}),e instanceof Ft?[2,this._updateFileMessageMetaArray(e.messageId,i,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,i,"remove",!0)]})})},t.prototype.addMessageMetaArrayValues=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){return ne(e instanceof mr&&e.messageId>0&&r.every(function(a){return a instanceof Er})).throw(H.invalidParameters),e instanceof Ft?[2,this._updateFileMessageMetaArray(e.messageId,r,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,r,"add",!0)]})})},t.prototype.removeMessageMetaArrayValues=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){return ne(e instanceof mr&&e.messageId>0&&r.every(function(a){return a instanceof Er})).throw(H.invalidParameters),e instanceof Ft?[2,this._updateFileMessageMetaArray(e.messageId,r,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,r,"remove",!0)]})})},t.prototype.report=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u;return v(this,function(o){switch(o.label){case 0:return ne((_n(yo,e)||e instanceof fu)&&x("string",r)).throw(H.invalidParameters),i=k.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new dI({channelUrl:this.url,channelType:this.channelType,userId:a.userId,category:e,description:r}),[4,s.send(u)];case 1:return o.sent(),[2]}})})},t.prototype.reportUser=function(e,r,i){return y(this,void 0,void 0,function(){var a,s,u,o;return v(this,function(l){switch(l.label){case 0:return ne(e instanceof Mn&&(_n(yo,r)||r instanceof fu)&&x("string",i)).throw(H.invalidParameters),a=k.of(this._iid),s=a.sdkState,u=a.requestQueue,o=new cI({channelUrl:this.url,channelType:this.channelType,userId:s.userId,offendingUserId:e.userId,category:r,description:i}),[4,u.send(o)];case 1:return l.sent(),[2]}})})},t.prototype.reportMessage=function(e,r,i){return y(this,void 0,void 0,function(){var a,s,u,o;return v(this,function(l){switch(l.label){case 0:return ne(e instanceof Dt&&(_n(yo,r)||r instanceof fu)&&x("string",i)).throw(H.invalidParameters),a=k.of(this._iid),s=a.sdkState,u=a.requestQueue,o=new fI({channelUrl:this.url,channelType:this.channelType,userId:s.userId,offendingUserId:e.sender.userId,messageId:e.messageId,category:r,description:i,messageToken:e._messageToken}),[4,u.send(o)];case 1:return l.sent(),[2]}})})},t.prototype.updatePoll=function(e,r){return y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(x("number",e)&&function(o){return x("string",o.title,!0)&&lb(o.data)&&x("boolean",o.allowUserSuggestion,!0)&&x("boolean",o.allowMultipleVotes,!0)&&x("number",o.closeAt,!0)}(r)).throw(H.invalidParameters),i=k.of(this._iid).requestQueue,a=new SI(D({pollId:e},r)),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(TI).poll]}})})},t.prototype.deletePoll=function(e){return y(this,void 0,void 0,function(){var r,i,a;return v(this,function(s){switch(s.label){case 0:return r=x("number",e),ne(r).throw(H.invalidParameters),i=k.of(this._iid).requestQueue,a=new NI({pollId:e}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},t.prototype.closePoll=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return r=x("number",e),ne(r).throw(H.invalidParameters),i=k.of(this._iid).requestQueue,a=new II({pollId:e}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(AI).poll]}})})},t.prototype.addPollOption=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u;return v(this,function(o){switch(o.label){case 0:return i=x("number",e)&&x("string",r)&&r.trim()!=="",ne(i).throw(H.invalidParameters),a=k.of(this._iid).requestQueue,s=new MI({channelUrl:this.url,channelType:this.channelType,pollId:e,optionText:r}),[4,a.send(s)];case 1:return u=o.sent(),[2,u.as(wI).poll]}})})},t.prototype.updatePollOption=function(e,r,i){return y(this,void 0,void 0,function(){var a,s,u,o;return v(this,function(l){switch(l.label){case 0:return a=x("number",e)&&x("number",r)&&x("string",i)&&i.trim()!=="",ne(a).throw(H.invalidParameters),s=k.of(this._iid).requestQueue,u=new OI({pollId:e,pollOptionId:r,optionText:i}),[4,s.send(u)];case 1:return o=l.sent(),[2,o.as(RI).poll]}})})},t.prototype.deletePollOption=function(e,r){return y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return i=x("number",e)&&x("number",r),ne(i).throw(H.invalidParameters),a=k.of(this._iid).requestQueue,s=new DI({pollId:e,pollOptionId:r}),[4,a.send(s)];case 1:return u.sent(),[2]}})})},t.prototype.votePoll=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u,o,l,d;return v(this,function(c){switch(c.label){case 0:return i=x("number",e)&&gn("number",r),ne(i).throw(H.invalidParameters),a=k.of(this._iid),s=a.requestQueue,u=a.dispatcher,o=new LI({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionIds:r}),[4,s.send(o)];case 1:return l=c.sent(),d=l.as(Fp).event,u.dispatch(new $d({event:d,source:W.EVENT_POLL_VOTED})),[2,d]}})})},t.prototype.getPollChangeLogsSinceTimestamp=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return ne(x("number",e)).throw(H.invalidParameters),[4,cd.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,r.sent()]}})})},t.prototype.getPollChangeLogsSinceToken=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return ne(x("string",e,!0)),[4,cd.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,r.sent()]}})})},t.prototype.createPollListQuery=function(e){return e===void 0&&(e=10),new hb(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:e})},t.prototype.createPollVoterListQuery=function(e,r,i){return i===void 0&&(i=20),new pb(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionId:r,limit:i})},t.prototype.pinMessage=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return ne(x("number",e)&&e>0).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new WI({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t.prototype.unpinMessage=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return ne(x("number",e)&&e>0).throw(H.invalidParameters),r=k.of(this._iid).requestQueue,i=new YI({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,r.send(i)];case 1:return a.sent(),[2]}})})},t}(Vt),Hb=function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return w(t,n),t}(function(){this.onConnected=tn,this.onReconnectStarted=tn,this.onReconnectSucceeded=tn,this.onReconnectFailed=tn,this.onDisconnected=tn}),G_=function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return w(t,n),t}(function(){this.onSessionExpired=tn,this.onSessionTokenRequired=function(n){return n(null)},this.onSessionError=tn,this.onSessionRefreshed=tn,this.onSessionClosed=tn}),XI=function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return w(t,n),t}(function(){this.onFriendsDiscovered=tn,this.onTotalUnreadMessageCountChanged=tn,this.onTotalUnreadMessageCountUpdated=tn}),ZI=function(n){function t(e){var r=e.limit,i=e.token,a=e.userIdsFilter,s=e.metaDataKeyFilter,u=e.metaDataValuesFilter,o=e.nicknameStartsWithFilter,l=n.call(this)||this;return l.method=J.GET,l.path=qn,l.params=ge({limit:r,token:i,user_ids:a,metadatakey:s,metadatavalues_in:u,nickname_startswith:o}),l}return w(t,n),t}(ee),JI=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.users=r.users.map(function(a){return new Mn(e,a)}),i.next=r.next,i}return w(t,n),t}(ie),e2=function(n){function t(e,r){var i,a,s,u=this;return(u=n.call(this,e,r)||this).userIdsFilter=null,u.metaDataKeyFilter=null,u.metaDataValuesFilter=null,u.nicknameStartsWithFilter=null,u.userIdsFilter=(i=r.userIdsFilter)!==null&&i!==void 0?i:null,u.metaDataKeyFilter=(a=r.metaDataKeyFilter)!==null&&a!==void 0?a:null,u.metaDataValuesFilter=(s=r.metaDataValuesFilter)!==null&&s!==void 0?s:null,u.nicknameStartsWithFilter=r.nicknameStartsWithFilter||null,u}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&gn("string",this.userIdsFilter,!0)&&x("string",this.metaDataKeyFilter,!0)&&gn("string",this.metaDataValuesFilter,!0)&&x("string",this.nicknameStartsWithFilter,!0)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new ZI(Re(D(D({},this),{token:this._token}))),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(JI),s=a.users,u=a.next,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(Sa),n2=function(n){function t(e){var r=e.userId,i=e.limit,a=e.token,s=e.userIdsFilter,u=n.call(this)||this;return u.method=J.GET,u.path="".concat(qn,"/").concat(r,"/block"),u.params=ge({limit:i,token:a,user_ids:s}),u}return w(t,n),t}(ee),t2=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.users=r.users.map(function(a){return new Mn(e,a)}),i.next=r.next,i}return w(t,n),t}(ie),r2=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).userIdsFilter=null,a.userIdsFilter=(i=r.userIdsFilter)!==null&&i!==void 0?i:null,a}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&gn("string",this.userIdsFilter,!0)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new n2(Re(D(D({},this),{userId:r.userId,token:this._token}))),[4,i.send(a)]):[3,2]:[3,5];case 1:return s=d.sent(),u=s.as(t2),o=u.users,l=u.next,this._token=l,this._hasNext=!!l,this._isLoading=!1,[2,o];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(Sa),i2=function(n){function t(e){var r=e.userId,i=e.limit,a=e.token,s=n.call(this)||this;return s.method=J.GET,s.path="".concat(qn,"/").concat(encodeURIComponent(r),"/friends"),s.params={limit:i,token:a},s}return w(t,n),t}(ee),a2=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.hasMore=r.has_more,i.users=r.users.map(function(a){return new Mn(e,a)}),i.next=r.next,i}return w(t,n),t}(ie),s2=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d;return v(this,function(c){switch(c.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new i2(D(D({},this),{userId:r.userId,token:this._token})),[4,i.send(a)]):[3,2]:[3,5];case 1:return s=c.sent(),u=s.as(a2),o=u.users,l=u.hasMore,d=u.next,this._token=d,this._hasNext=l,this._isLoading=!1,[2,o];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(Sa),El={},$o=function(){function n(t){var e=t.dbname,r=t.itemSizeLimit,i=r===void 0?1048576:r,a=t.cacheLimit,s=a===void 0?256:a,u=t.blockHashBase,o=u===void 0?2:u,l=t.blockHashMultiplier,d=l===void 0?10:l,c=t.blockHashConstant,f=c===void 0?11:c,h=t.transactionApplyDelay,m=h===void 0?200:h,_=t.disableLogger,E=_!==void 0&&_;return El[e]||(this.itemSizeLimit=i,this.cacheLimit=s,this.blockHashBase=o,this.blockHashMultiplier=d,this.blockHashConstant=f,this.transactionApplyDelay=m,this.disableLogger=E,El[e]=this),El[e]}return n.get=function(t){return El[t]},n}();(function(n){n[n.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",n[n.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",n[n.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",n[n.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",n[n.STORE_IS_FULL=61001003]="STORE_IS_FULL",n[n.STORE_NOT_INITIALIZED=61001004]="STORE_NOT_INITIALIZED",n[n.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",n[n.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",n[n.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",n[n.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",n[n.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",n[n.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",n[n.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",n[n.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",n[n.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",n[n.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",n[n.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",n[n.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",n[n.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",n[n.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",n[n.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",n[n.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",n[n.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",n[n.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",n[n.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",n[n.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND"})(vt||(vt={}));var Is,Zn=function(n){function t(e){var r=e.code,i=r===void 0?vt.UNKNOWN_ERROR:r,a=e.message,s=a===void 0?"Unknown error occurred.":a,u=n.call(this,s)||this;return u.code=i,Object.setPrototypeOf(u,t.prototype),u}return w(t,n),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:vt.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:vt.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:vt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:vt.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotInitialized",{get:function(){return new t({code:vt.STORE_NOT_INITIALIZED,message:"Store is not initialized."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:vt.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:vt.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:vt.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeEncryptionInvalid",{get:function(){return new t({code:vt.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:vt.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:vt.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:vt.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:vt.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:vt.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:vt.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:vt.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:vt.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:vt.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:vt.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:vt.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:vt.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:vt.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:vt.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:vt.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:vt.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),t}(Error);(function(n){n.INIT="init",n.READY="ready",n.CLOSED="closed"})(Is||(Is={}));var V_,Rr=function(n,t){if(t===void 0&&(t=new WeakMap),typeof n=="object"&&n!==null){if(t.has(n))throw Zn.circularReferenceFound;var e;return t.set(n,!0),Array.isArray(n)?e=n.map(function(r){return Rr(r,t)}):n instanceof RegExp||n instanceof Date?e=n:(e={},Object.keys(n).forEach(function(r){e[r]=Rr(n[r],t)})),t.delete(n),e}return n},ga=function(n,t){if(t==null)return 1;if(n==null)return-1;if(typeof n!=typeof t)throw Zn.compareTypesNotMatch;var e=0;switch(typeof n){case"boolean":case"number":e=n-t;break;case"string":e=n.localeCompare(t)}return e},j_=function(n,t){for(var e=0,r=0;r<n.length;r++)e=n.charCodeAt(r)+(e<<6)+(e<<16)-e;return(e>>>0)%t},vl=function(n){return new Promise(function(t){setTimeout(function(){return t()},n)})},ws=function(n,t){if(!t)return!1;if(typeof n!="function"){for(var e in n)if(["/and","&&"].includes(e)){if(n[e].some(function(o){return!ws(o,t)}))return!1}else if(["/or","||"].includes(e)){if(n[e].every(function(o){return!ws(o,t)}))return!1}else if(e==="/where"){if(!(0,n[e])(t))return!1}else{var r=e;if(typeof n[r]=="object"){var i=n[r];for(var a in i)switch(a){case"/eq":case"=":if((s=t[r])!==(u=i[a]))return!1;break;case"/neq":case"!=":if((s=t[r])===(u=i[a]))return!1;break;case"/gt":case">":var s=t[r],u=i[a];if(!(ga(s,u)>0))return!1;break;case"/gte":case">=":if(s=t[r],u=i[a],!(ga(s,u)>=0))return!1;break;case"/lt":case"<":if(s=t[r],u=i[a],!(ga(s,u)<0))return!1;break;case"/lte":case"<=":if(s=t[r],u=i[a],!(ga(s,u)<=0))return!1;break;case"/in":if(s=t[r],!(u=i[a]).includes(s))return!1;break;case"/nin":if(s=t[r],(u=i[a]).includes(s))return!1;break;case"/contain":if(s=t[r],u=i[a],!s.includes(u))return!1;break;case"/regex":if(s=t[r],!(u=i[a]).test(s))return!1;break;case"/where":if(s=t[r],!(0,i[a])(s))return!1}}else if(typeof n[r]=="function"){if(!n[r](t[r]))return!1}else if(n[r]!==t[r])return!1}return!0}return n(t)},to=function(){},q_=function(){return Promise.resolve()},u2=function(n){return n},z_=function(n,t){t()};(function(n){n[n.FORWARD=0]="FORWARD",n[n.BACKWARD=1]="BACKWARD"})(V_||(V_={}));var Os,_r,Hi,o2=function(){function n(t){var e=t.initialPrevValue,r=e===void 0?null:e,i=t.initialNextValue,a=i===void 0?null:i,s=t.iterator,u=t.map,o=u===void 0?u2:u,l=t.backward,d=l===void 0?q_:l,c=t.forward,f=c===void 0?q_:c,h=t.complete,m=h===void 0?to:h;this._prevValue=r,this._nextValue=a,this._error=null,this._map=o,this._backward=d,this._forward=f,this._iterator=s,this._complete=m}return Object.defineProperty(n.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"nextValue",{get:function(){return this._map(this._nextValue)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),n.prototype.prev=function(){return y(this,void 0,void 0,function(){var t,e,r;return v(this,function(i){switch(i.label){case 0:if(!this.hasPrevious)return[3,6];i.label=1;case 1:return i.trys.push([1,3,,4]),t=this._prevValue,e=this,[4,this._backward()];case 2:return e._prevValue=i.sent()||null,this._nextValue=t,[3,4];case 3:return r=i.sent(),this._error=r,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,i.sent()];case 6:this._complete(),i.label=7;case 7:return[2]}})})},n.prototype.next=function(){return y(this,void 0,void 0,function(){var t,e,r;return v(this,function(i){switch(i.label){case 0:if(!this.hasNext)return[3,6];i.label=1;case 1:return i.trys.push([1,3,,4]),t=this._nextValue,e=this,[4,this._forward()];case 2:return e._nextValue=i.sent()||null,this._prevValue=t,[3,4];case 3:return r=i.sent(),this._error=r,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,i.sent()];case 6:this._complete(),i.label=7;case 7:return[2]}})})},n.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete()},n}(),Pf=function(){function n(t){var e=t.condition,r=e===void 0?{}:e,i=t.backward,a=i!==void 0&&i,s=t.blockManager,u=t.indexer;this.condition=r,this.backward=a,this._blockManager=s,this._indexer=u}return n.prototype.findOptimizedStartPosition=function(){var t=this,e=["=","/eq",">",">=","/gt","/gte"],r=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var i=this._indexer.origin.length-1;if(typeof this.condition!="function")for(h=0;h<this._indexer.fields.length;h++){var a=this._indexer.fields[h],s=1;if(a[0]==="-"&&(a=a.slice(1),s=-1),this.condition[a]){if(typeof this.condition[a]=="object"){var u=s>0?r:e;for(var o in this.condition[a])if(u.includes(o)){for(var l=i;l>=0;l--)if(s*ga(this._indexer.origin[l].columnValues[h],this.condition[a][o])<=0){i=l;break}}}else for(l=i;l>=0;l--)if(s*ga(this._indexer.origin[l].columnValues[h],this.condition[a])<=0){i=l;break}}}return Math.min(i+1,this._indexer.origin.length-1)}var d=0;if(typeof this.condition!="function")for(var c=function(m){var _=f._indexer.fields[m],E=1;if(_[0]==="-"&&(_=_.slice(1),E=-1),f.condition[_]){if(typeof f.condition[_]=="object")Object.keys(f.condition[_]).forEach(function(g){if((E>0?e:r).includes(g)){for(var C=d;C<t._indexer.origin.length;C++)if(E*ga(t._indexer.origin[C].columnValues[m],t.condition[_][g])>=0){d=C;break}}});else for(var b=d;b<f._indexer.origin.length;b++)if(E*ga(f._indexer.origin[b].columnValues[m],f.condition[_])>=0){d=b;break}}},f=this,h=0;h<this._indexer.fields.length;h++)c(h);return Math.max(d-1,0)},n.prototype.each=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l=this;return v(this,function(d){switch(d.label){case 0:if(e=this.findOptimizedStartPosition(),r=0,this.backward&&this._indexer.origin[e]&&(r=this._indexer.origin[e].keys.length-1),i=function(){if(l._indexer.origin[e]){if(!l._indexer.origin[e].keys[++r]){if(!l._indexer.origin[++e])return!1;r=0}return!0}return!1},a=function(){if(l._indexer.origin[e]){if(!l._indexer.origin[e].keys[--r]){if(!l._indexer.origin[--e])return!1;r=l._indexer.origin[e].keys.length-1}return!0}return!1},s=null,!this._indexer.origin[e])return[3,4];u=this.backward?a:i,d.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[e].keys[r])];case 2:if((o=d.sent())&&ws(this.condition,o))return s=o,[3,4];d.label=3;case 3:if(u())return[3,1];d.label=4;case 4:return[4,new Promise(function(c){var f=new o2({initialNextValue:Rr(s),iterator:t,forward:function(){return y(l,void 0,void 0,function(){var h,m;return v(this,function(_){switch(_.label){case 0:h=this.backward?a:i,_.label=1;case 1:return h()?[4,this._blockManager.getFromBlock(this._indexer.origin[e].keys[r])]:[3,3];case 2:return(m=_.sent())&&ws(this.condition,m)?[2,Rr(m)]:[3,1];case 3:return[2,null]}})})},backward:function(){return y(l,void 0,void 0,function(){var h,m;return v(this,function(_){switch(_.label){case 0:h=this.backward?i:a,_.label=1;case 1:return h()?[4,this._blockManager.getFromBlock(this._indexer.origin[e].keys[r])]:[3,3];case 2:return(m=_.sent())&&ws(this.condition,m)?[2,Rr(m)]:[3,1];case 3:return[2,null]}})})},complete:c});t(f)})];case 5:return[2,d.sent()]}})})},n}(),l2=function(){function n(t){var e=t.condition,r=e===void 0?{}:e,i=t.backward,a=i!==void 0&&i,s=t.mutex,u=t.blockManager,o=t.indexer;this._mutex=s,this._iterator=new Pf({condition:r,backward:a,blockManager:u,indexer:o})}return n.prototype.fetch=function(t){return t===void 0&&(t={}),y(this,void 0,void 0,function(){var e,r,i,a,s=this;return v(this,function(u){switch(u.label){case 0:if(e=Math.max(t.offset||0,0),(r=typeof t.limit=="number"?t.limit:Number.MAX_SAFE_INTEGER)===0)return[2,[]];if(r<0)throw Zn.collectionQueryNotValid;u.label=1;case 1:return u.trys.push([1,4,,5]),i=[],[4,this._mutex.lock()];case 2:return u.sent(),[4,this._iterator.each(function(o){return y(s,void 0,void 0,function(){return v(this,function(l){return o.error?o.stop():o.hasNext?e===0?(i.push(o.nextValue),0<r&&r<=i.length?o.stop():o.next()):(e--,o.next()):o.stop(),[2]})})})];case 3:return u.sent(),this._mutex.unlock(),[2,i];case 4:throw a=u.sent(),this._mutex.unlock(),a;case 5:return[2]}})})},n.prototype.count=function(){return y(this,void 0,void 0,function(){var t,e,r=this;return v(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=0,[4,this._mutex.lock()];case 1:return i.sent(),[4,this._iterator.each(function(a){return y(r,void 0,void 0,function(){return v(this,function(s){return a.error?a.stop():a.hasNext?(t++,a.next()):a.stop(),[2]})})})];case 2:return i.sent(),this._mutex.unlock(),[2,t];case 3:throw e=i.sent(),this._mutex.unlock(),e;case 4:return[2]}})})},n}(),Hp=function(n){return"".concat("nest","@").concat(n)},Ps=function(n,t){return"".concat(Hp(n),"/").concat(t)},Vc=function(n,t){return"".concat(Ps(n,t),".metadata")},Ff=function(n,t){return"".concat(Ps(n,t),"/block.")},K_=function(n,t){return"".concat(Ps(n,t),"/blob.")},d2=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.store;this.dbname=e,this.collectionName=r,this.store=i}return n.prototype.get=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d;return v(this,function(c){switch(c.label){case 0:return[4,this.store.get(t)];case 1:return(e=c.sent())?(r=e.data,i=e.type,typeof fetch>"u"?[3,4]:[4,fetch(r)]):[3,5];case 2:return[4,c.sent().blob()];case 3:return[2,c.sent()];case 4:for(a=[],s=atob(r.split(",")[1]),u=0;u<s.length;u+=512){for(o=s.slice(u,u+512),l=new Array(o.length),d=0;d<o.length;d++)l[d]=o.charCodeAt(d);a.push(new Uint8Array(l))}return[2,new Blob(a,{type:i})];case 5:return[2,null]}})})},n.prototype.save=function(t,e){return e===void 0&&(e="".concat(Date.now())),y(this,void 0,void 0,function(){var r,i,a,s,u=this;return v(this,function(o){switch(o.label){case 0:return[4,new Promise(function(l){var d=function(f,h,m,_){return _===void 0&&(_=0),"".concat(K_(f,h)).concat(m,".").concat(_)}(u.dbname,u.collectionName,e),c=new FileReader;c.onload=function(){l({blobId:d,data:c.result,type:t.type})},c.readAsDataURL(t)})];case 1:return r=o.sent(),i=r.blobId,a=r.data,s=r.type,[4,this.store.set({key:i,value:{data:a,type:s}})];case 2:return o.sent(),[2,i]}})})},n.prototype.remove=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this.store.remove(t)];case 1:return e.sent(),[2]}})})},n.prototype.clear=function(){return y(this,void 0,void 0,function(){var t,e,r=this;return v(this,function(i){switch(i.label){case 0:return t=K_(this.dbname,this.collectionName),[4,this.store.getAllKeys()];case 1:return e=i.sent(),[4,Promise.all(e.filter(function(a){return a.startsWith(t)}).map(function(a){return y(r,void 0,void 0,function(){return v(this,function(s){switch(s.label){case 0:return[4,this.store.remove(a)];case 1:return[2,s.sent()]}})})}))];case 2:return i.sent(),[2]}})})},n}();(function(n){n[n.COMMIT=0]="COMMIT",n[n.WRITE=1]="WRITE",n[n.ERROR=2]="ERROR"})(Os||(Os={})),function(n){n.PENDING="pending",n.PERSISTENT="persistent",n.VOLATILE="volatile"}(_r||(_r={})),function(n){n[n.NO_CACHE=0]="NO_CACHE",n[n.DEFAULT=1]="DEFAULT",n[n.PERSISTENT=2]="PERSISTENT"}(Hi||(Hi={}));var bo,hr,$_=[_r.PENDING,_r.VOLATILE],yl={},Lr=function(){function n(t){var e=t.dbname,r=t.limit,i=r===void 0?256:r;return yl[e]||(this.dbname=e,this._items=[],this._limit=i,yl[e]=this),yl[e]}return n.get=function(t){return yl[t]},Object.defineProperty(n.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),n.prototype.find=function(t,e,r){return r===void 0&&(r=Hi.DEFAULT),y(this,void 0,void 0,function(){var i,a;return v(this,function(s){switch(s.label){case 0:return(i=this.get(e))?[3,2]:[4,t.get(e)];case 1:return(a=s.sent())&&(i={key:e,value:a,state:r===Hi.PERSISTENT?_r.PERSISTENT:_r.VOLATILE},this.put(i)),[3,3];case 2:r===Hi.PERSISTENT&&(i.state=_r.PERSISTENT),s.label=3;case 3:return[2,i]}})})},n.prototype.get=function(t,e){e===void 0&&(e=Hi.DEFAULT);var r=this._items.map(function(a){return a.key}).indexOf(t);if(r>-1){var i=this._items[r];return e===Hi.PERSISTENT&&(i.state=_r.PERSISTENT),e!==Hi.NO_CACHE&&this.put(i),i}return null},n.prototype.put=function(t){var e,r;if(this._limit>0){var i=this._items.map(function(c){return c.key}).indexOf(t.key);if(i>-1)$_.includes(this._items[i].state)&&$_.includes(t.state)?(this._items.splice(i,1),this._items.push(t)):(this._items[i].state=t.state,this._items[i].value=t.value);else{this._items.push(t);var a=this._items.filter(function(c){return c.state===_r.VOLATILE}),s=a.length-this._limit;if(s>0){var u=[];try{for(var o=oe(this._items),l=o.next();!l.done;l=o.next()){var d=l.value;d.state===_r.VOLATILE&&s>0?s--:u.push(d)}}catch(c){e={error:c}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this._items=u}}}},n.prototype.remove=function(t){var e=this._items.map(function(r){return r.key}).indexOf(t);e>-1&&this._items.splice(e,1)},n.prototype.clearByCondition=function(t){this._items=this._items.filter(function(e){return!t(e)})},n.prototype.clearForDatabase=function(t){this.clearByCondition(function(e){return e.key.startsWith(Hp(t))})},n.prototype.clear=function(t){t===void 0&&(t=!1),this._items=t?[]:this._items.filter(function(e){return e.state!==_r.VOLATILE})},n}(),c2=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.store;this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=e,this.collectionName=r,this.metadataKey=function(a,s){return"".concat(Ps(a,s),"/trans.metadata")}(e,r),this.recordsetKey=function(a,s){return"".concat(Ps(a,s),"/trans.recordset")}(e,r),this._store=i}return Object.defineProperty(n.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),n.prototype._getReducedRecordset=function(t){return t===void 0&&(t=[]),y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(e=r.sent()||[]).push.apply(e,Be([],we(t),!1)),[2,this._reduceRecordSet(e)]}})})},n.prototype._reduceRecordSet=function(t){for(var e=[],r={},i=t.length-1;i>=0;i--){for(var a=t[i],s=[],u=a.requests.length-1;u>=0;u--){var o=a.requests[u],l=o.data;r[l.key]||(s.unshift(o),r[l.key]=!0)}s.length>0&&(a.requests=s,e.unshift(a))}return e},n.prototype._applyRecord=function(t,e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:r=Lr.get(this.dbname),i=e.generation,a=e.requests,s=null,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this._store.setMany(a.map(function(h){return D(D({},h.data),{generation:i})}))];case 2:for(u=f.sent(),o=0;o<a.length;o++)u[o]instanceof Error&&(s||(s=u[o]),l=a[o].data,r.put(D(D({},l),{state:_r.PERSISTENT})));return[3,4];case 3:return d=f.sent(),s=d,[3,4];case 4:return s?[3,6]:(c=t.filter(function(h){return h.generation!==i}),[4,this._store.set({key:this.recordsetKey,value:c})]);case 5:return f.sent(),this._onWrite.forEach(function(h){h(a.map(function(m){return m.data}))}),[3,7];case 6:this._onError.forEach(function(h){s&&h(s)}),f.label=7;case 7:return[2]}})})},n.prototype.init=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return t=this,[4,this._store.get(this.metadataKey)];case 1:return t._metadata=l.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:e=l.sent(),l.label=3;case 3:l.trys.push([3,8,9,10]),r=oe(e),i=r.next(),l.label=4;case 4:return i.done?[3,7]:(a=i.value,[4,this._applyRecord(e,a)]);case 5:l.sent(),l.label=6;case 6:return i=r.next(),[3,4];case 7:return[3,10];case 8:return s=l.sent(),u={error:s},[3,10];case 9:try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(u)throw u.error}return[7];case 10:return[2]}})})},n.prototype.on=function(t,e,r){switch(t){case Os.COMMIT:this._onCommit.set(e,r);break;case Os.WRITE:this._onWrite.set(e,r);break;case Os.ERROR:this._onError.set(e,r)}},n.prototype.requestWrite=function(t,e){this._requests.push({data:t,options:e}),Lr.get(this.dbname).put(D({state:_r.PENDING},t))},n.prototype.requestMultipleWrite=function(t,e){var r,i,a=Lr.get(this.dbname);try{for(var s=oe(t),u=s.next();!u.done;u=s.next()){var o=u.value;this._requests.push({data:o,options:e}),a.put(D({state:_r.PENDING},o))}}catch(l){r={error:l}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},n.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return Lr.get(this.dbname).clearByCondition(function(e){return e.state===_r.PENDING}),this._requests=[],[2]})})},n.prototype.commit=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u,o,l,d,c,f,h=this;return v(this,function(m){switch(m.label){case 0:if(!((t=this._requests).length>0))return[3,4];for(e=[],r={},o=t.length-1;o>=0;o--)i=t[o],d=i.data,r[d.key]||(r[d.key]=!0,e.unshift(i));return a={generation:this.generation,requests:e},[4,this._getReducedRecordset([a])];case 1:return s=m.sent(),[4,this._store.set({key:this.recordsetKey,value:s})];case 2:return m.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata})];case 3:for(m.sent(),u=Lr.get(this.dbname),o=0;o<e.length;o++)l=e[o],d=l.data,c=l.options,u.put(D(D({},d),{state:c&&c.persistent?_r.PERSISTENT:_r.VOLATILE}));this._requests=[],this._onCommit.forEach(function(_){_(t.map(function(E){return E.data}))}),f=$o.get(this.dbname),setTimeout(function(){try{h._applyRecord(s,a)}catch(_){h._onError.forEach(function(E){return E(_)})}},f.transactionApplyDelay),m.label=4;case 4:return[2]}})})},n}(),Vl=function(){function n(t){var e=t.blockId,r=t.keyName,i=t.items,a=i===void 0?[]:i,s=t.limit;this.blockId=e,this.keyName=r,this.limit=s,this._items=Be([],we(a),!1)}return n.createFromCacheItem=function(t){return t?new n(t.value):null},Object.defineProperty(n.prototype,"isEmpty",{get:function(){return this._items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),n.prototype.serialize=function(){return{blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items}},n.prototype.getItemByKey=function(t){var e=this,r=this._items.find(function(i){var a=i[e.keyName];return t===a});return r??null},n.prototype.has=function(t){var e=this;return this._items.map(function(r){return r[e.keyName]}).includes(t)},n.prototype.add=function(t){var e=this,r=this._items.map(function(i){return i[e.keyName]}).indexOf(t[this.keyName]);return r<0?this._items.length<this.limit&&(this._items.push(t),!0):(this._items[r]=t,!0)},n.prototype.remove=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e][this.keyName]===t)return this._items.splice(e,1),!0;return!1},n.prototype.clear=function(){this._items=[]},n}(),f2=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.metadata,a=t.hashFunction,s=a===void 0?j_:a,u=t.transaction,o=t.store;this.dbname=e,this.collectionName=r,this.hashFunction=s,this.metadata=i,this._transaction=u,this._store=o}return Object.defineProperty(n.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),n.prototype.createBlockId=function(t,e){return e===void 0&&(e=this.metadata.blockLevel),r=this.dbname,i=this.collectionName,a=e,s="".concat(function(u,o,l){var d=l.base*Math.pow(l.multiplier,o)+l.constant;return(l.hashFunction||j_)(u,d)}(t,e,{hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant})),"".concat(Ff(r,i)).concat(a,".").concat(s);var r,i,a,s},n.prototype._findBlock=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:e=Lr.get(this.dbname),r=this.metadata.blockLevel,u.label=1;case 1:return r>0?(i=this.createBlockId(t,r),[4,e.find(this._store,i)]):[3,4];case 2:if((a=u.sent())&&(s=Vl.createFromCacheItem(a),s==null?void 0:s.getItemByKey(t)))return[2,s];u.label=3;case 3:return r--,[3,1];case 4:return[2,null]}})})},n.prototype.getFromBlock=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return[4,this._findBlock(t)];case 1:return[2,(e=r.sent())?e.getItemByKey(t):null]}})})},n.prototype.putToBlock=function(t,e){return y(this,void 0,void 0,function(){var r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return r=$o.get(this.dbname),i=this.createBlockId(t),a=Math.floor(this._store.itemSizeLimit/r.itemSizeLimit),[4,Lr.get(this.dbname).find(this._store,i)];case 1:return s=o.sent(),(u=s?Vl.createFromCacheItem(s):new Vl({blockId:i,keyName:this.keyName,items:[],limit:a}))!=null&&u.add(e)?(this._transaction.requestWrite({key:u.blockId,value:u.serialize()}),[2,!0]):[2,!1]}})})},n.prototype.removeFromBlock=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return[4,this._findBlock(t)];case 1:return(e=r.sent())&&e.remove(t)?(this._transaction.requestWrite({key:e.blockId,value:e.serialize()}),[2,!0]):[2,!1]}})})},n.prototype.clearAllBlocks=function(){return y(this,void 0,void 0,function(){var t,e,r;return v(this,function(i){switch(i.label){case 0:return t=Ff(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return e=i.sent(),r=e.filter(function(a){return a.startsWith(t)}),[4,this._store.removeMany(r)];case 2:return i.sent(),[4,this._transaction.clear()];case 3:return i.sent(),Lr.get(this.dbname).clearByCondition(function(a){return a.key.startsWith(t)}),[2]}})})},n}(),Ma=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.keyName,a=t.fields,s=t.transaction,u=t.store,o=this;this._origin=[],this._table=[];var l=function(d,c,f){return"".concat(Ps(d,c),"/index.").concat(f)}(e,r,a.join(">"));this.dbname=e,this.collectionName=r,this.keyName=i,this.fields=a,this.indexerKey=l,this._store=u,this._transaction=s,this._transaction.on(Os.COMMIT,this.indexerKey,function(){return o.commit()}),this._transaction.on(Os.ERROR,this.indexerKey,function(){return o.abort()})}return n.createKey=function(t){return t.join(">")},n.parseKey=function(t){return t.split(">")},n.prototype._addItem=function(t){var e=t[this.keyName],r=this.getColumnValues(t),i=we(this.indexOf(r),2),a=i[0];return i[1]?!this._table[a].keys.includes(e)&&(this._table[a].keys.push(e),!0):(this._table.splice(a,0,{columnValues:r,keys:[e]}),!0)},n.prototype._removeItem=function(t){var e=t[this.keyName],r=this.getColumnValues(t),i=we(this.indexOf(r),2),a=i[0];if(i[1]){var s=this._table[a].keys.indexOf(e);if(s>-1)return this._table[a].keys.splice(s,1),this._table[a].keys.length===0&&this._table.splice(a,1),!0}return!1},Object.defineProperty(n.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),n.prototype.getColumnValues=function(t){var e,r,i,a,s=[];try{for(var u=oe(this.fields),o=u.next();!o.done;o=u.next()){var l=o.value;if(l[0]==="-"&&(l=l.slice(1)),i=t[l],a=void 0,a=typeof i,i!==null&&a!=="undefined"&&a!=="boolean"&&a!=="number"&&a!=="string")throw Zn.indexTypesNotMatch;s.push(t[l])}}catch(d){e={error:d}}finally{try{o&&!o.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return s},n.prototype.diff=function(t,e){for(var r in this.fields){var i=this.fields[r][0]==="-"?-1:1,a=ga(t[r],e[r]);if(a!==0)return i*a}return 0},n.prototype.indexOf=function(t){if(this._table.length>0){for(var e=0,r=this._table.length-1;e<=r;){var i=Math.floor((e+r)/2),a=this.diff(t,this._table[i].columnValues);if(a>0)e=i+1;else{if(!(a<0))return[i,!0];r=i-1}}return[e,!1]}return[0,!1]},n.prototype.ensure=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u,o,l,d,c,f,h,m,_,E,b;return v(this,function(g){switch(g.label){case 0:return[4,(t=Lr.get(this.dbname)).find(this._store,this.indexerKey,Hi.PERSISTENT)];case 1:return(e=g.sent())?[3,11]:(r=Ff(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:i=g.sent(),g.label=3;case 3:g.trys.push([3,8,9,10]),a=oe(i),s=a.next(),g.label=4;case 4:return s.done?[3,7]:(u=s.value).startsWith(r)?[4,t.find(this._store,u,Hi.NO_CACHE)]:[3,6];case 5:if(o=g.sent(),l=Vl.createFromCacheItem(o))try{for(E=void 0,d=oe(l.items),c=d.next();!c.done;c=d.next())f=c.value,this._addItem(f)}catch(C){E={error:C}}finally{try{c&&!c.done&&(b=d.return)&&b.call(d)}finally{if(E)throw E.error}}g.label=6;case 6:return s=a.next(),[3,4];case 7:return[3,10];case 8:return h=g.sent(),m={error:h},[3,10];case 9:try{s&&!s.done&&(_=a.return)&&_.call(a)}finally{if(m)throw m.error}return[7];case 10:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,12];case 11:this._origin=e.value,this._table=Rr(this._origin),g.label=12;case 12:return[2]}})})},n.prototype.drop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Lr.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return t.sent(),[2]}})})},n.prototype.addItem=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){return this._addItem(t)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},n.prototype.removeItem=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){return this._removeItem(t)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},n.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]})})},n.prototype.commit=function(){this._origin=this._table,this._table=Rr(this._origin)},n.prototype.abort=function(){this._table=Rr(this._origin)},n}(),vd=function(){return typeof document<"u"&&typeof navigator<"u"&&navigator.product!=="ReactNative"},W_=function(){var n=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(n+16*Math.random())%16|0;return n=Math.floor(n/16),(t==="x"?e:3&e|8).toString(16)})};(function(n){n[n.PROCESSING=0]="PROCESSING",n[n.DONE=1]="DONE"})(bo||(bo={})),function(n){n.NEWNODE="newnode",n.REMOVENODE="removenode",n.CLAIM_HOST="claimhost",n.SYNC_HOST="synchost",n.REQUEST_LOCK="requestlock",n.ACQUIRE_LOCK="acquirelock",n.RELEASE_LOCK="releaselock"}(hr||(hr={}));var Si,jc={},Bp=function(){function n(t,e){e===void 0&&(e={});var r=this;return this._state=bo.PROCESSING,this._queue=[],this._activationQueue=[],jc[t]&&!e.forceCreate||(this.nodeId=W_(),this.key=t,vd()&&(e.startAsInvisible?this.registerNode():document.visibilityState==="visible"?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",function(){document.visibilityState==="visible"&&r.claimHost()}),window.addEventListener("message",function(i){var a,s,u=i.data;if(u!=null&&u.isNestDbMessage){var o=u.nodeId,l=u.requestId,d=u.key,c=u.op,f=u.data;if(o!==r.nodeId&&d===r.key)switch(c){case hr.NEWNODE:r._sendSync();break;case hr.CLAIM_HOST:r._sendSync(),r._hostId=o;break;case hr.SYNC_HOST:if(!r.isInSync){r._activationTimeout&&clearTimeout(r._activationTimeout);var h=f,m=h.currentItemRequestId,_=h.queue,E=function(S){var A=r._queue.findIndex(function(I){return I.requestId===S.requestId});A<0&&r._requestLock({isNestDbMessage:!0,nodeId:S.nodeId,requestId:S.requestId,key:r.key,op:hr.REQUEST_LOCK,ts:S.ts})};try{for(var b=oe(_),g=b.next();!g.done;g=b.next())E(g.value)}catch(S){a={error:S}}finally{try{g&&!g.done&&(s=b.return)&&s.call(b)}finally{if(a)throw a.error}}r._currentItem=r._queue.find(function(S){return S.requestId===m}),r._completeSync()}break;case hr.REMOVENODE:r._queue=r._queue.filter(function(S){return S.nodeId!==u.nodeId}),r._currentItem&&r._currentItem.nodeId===u.nodeId&&(r._currentItem=void 0,r._acquire(r._queue[0]));break;case hr.REQUEST_LOCK:r._requestLock(u);break;case hr.ACQUIRE_LOCK:var C=r._queue.find(function(S){return S.requestId===l});r._acquire(C);break;case hr.RELEASE_LOCK:r._release(l)}}}),window.addEventListener("beforeunload",function(){r._send(hr.REMOVENODE)})),jc[t]=this),jc[t]}return Object.defineProperty(n.prototype,"locked",{get:function(){return!!this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isHost",{get:function(){return this._hostId===this.nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isInSync",{get:function(){return this._state==bo.DONE},enumerable:!1,configurable:!0}),n.prototype._send=function(t,e){var r;e===void 0&&(e={});var i={isNestDbMessage:!0,nodeId:this.nodeId,requestId:(r=e==null?void 0:e.requestId)!==null&&r!==void 0?r:W_(),key:this.key,op:t,data:e.data,ts:Date.now()};return vd()&&window.postMessage(i,"*"),i},n.prototype._acquire=function(t){t?(this._currentItem=t,this._currentItem.onAcquired&&this._currentItem.onAcquired(t.requestId)):this._currentItem=void 0},n.prototype._release=function(t){if(this._currentItem&&this._currentItem.requestId===t){var e=this._currentItem;this._currentItem=void 0,e.nodeId===this.nodeId&&this._send(hr.RELEASE_LOCK,{requestId:e.requestId});var r=this._queue.findIndex(function(i){return i.requestId===t});r>-1&&this._queue.splice(r,1),e.onReleased&&e.onReleased(t)}},n.prototype._requestLock=function(t){var e=this;return new Promise(function(r){for(var i={nodeId:t.nodeId,requestId:t.requestId,ts:t.ts,onAcquired:function(u){e.isHost&&e._send(hr.ACQUIRE_LOCK,{requestId:u}),r()},onReleased:function(){e._acquire(e._queue[0])}},a=!1,s=0;s<e._queue.length;s++)if(e._queue[s].ts>i.ts){e._queue.splice(s,0,i),a=!0;break}a||e._queue.push(i),e._currentItem||e._acquire(e._queue[0])})},n.prototype._sendSync=function(){var t;this.isHost&&this._send(hr.SYNC_HOST,{data:{currentItemRequestId:(t=this._currentItem)===null||t===void 0?void 0:t.requestId,queue:this._queue.map(function(e){return{nodeId:e.nodeId,requestId:e.requestId,ts:e.ts}})}})},n.prototype._waitUntilSyncCompleted=function(){return y(this,void 0,void 0,function(){var t=this;return v(this,function(e){return this.isHost&&!this.isInSync?[2,new Promise(function(r){t._activationQueue.push(r)})]:[2]})})},n.prototype._waitSync=function(){var t=this;this.isInSync||(this._activationTimeout=setTimeout(function(){t._completeSync()},8))},n.prototype._completeSync=function(){this.isInSync||(this._state=bo.DONE,this._activationQueue.forEach(function(t){return t()}),this._activationQueue=[])},n.prototype.registerNode=function(){this._send(hr.NEWNODE),this._waitSync()},n.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(hr.CLAIM_HOST),this._waitSync()},n.prototype.lock=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return[4,this._waitUntilSyncCompleted()];case 1:return e.sent(),t=this._send(hr.REQUEST_LOCK),[4,this._requestLock(t)];case 2:return e.sent(),[2]}})})},n.prototype.unlock=function(){var t;!((t=this._currentItem)===null||t===void 0)&&t.requestId&&this._release(this._currentItem.requestId)},n}(),qc=function(){function n(t){var e=t.dbname,r=t.collectionName,i=t.keyName,a=t.keyHash,s=t.indexes,u=t.store,o=this;this._state=Is.INIT,this._indexers=[],this.dbname=e,this.name=r,this.keyName=i,this.indexes=Be([[i]],we(s.filter(function(l){return Ma.createKey(l)!==o.keyName})),!1),this._keyHash=a,this._store=u,this._mutex=new Bp(function(l,d){return"".concat(Ps(l,d),".lock")}(e,r)),this._blobContainer=new d2({dbname:e,collectionName:r,store:u}),this._transaction=new c2({dbname:e,collectionName:r,store:u})}return n.metadataOf=function(t,e,r){return y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=Vc(t,e),[4,r.get(i)];case 1:return[2,a.sent()]}})})},Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isReady",{get:function(){return this._state===Is.READY},enumerable:!1,configurable:!0}),n.prototype.init=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u,o,l,d,c,f,h,m,_=this;return v(this,function(E){switch(E.label){case 0:return[4,this._mutex.lock()];case 1:E.sent(),E.label=2;case 2:return E.trys.push([2,9,,10]),t=$o.get(this.dbname),[4,n.metadataOf(this.dbname,this.name,this._store)];case 3:return e=E.sent(),this._metadata=e||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:E.sent(),this._blockManager=new f2({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=Be([],we(this.indexes),!1),i=[],a=r.map(function(b){return Ma.createKey(b)}),s=e?e.indexes.map(function(b){return Ma.createKey(b)}):[];try{for(u=oe(s),o=u.next();!o.done;o=u.next())l=o.value,a.includes(l)||i.push(Ma.parseKey(l))}catch(b){h={error:b}}finally{try{o&&!o.done&&(m=u.return)&&m.call(u)}finally{if(h)throw h.error}}return(d=[]).push.apply(d,Be([],we(r.map(function(b){var g=new Ma({dbname:_.dbname,collectionName:_.name,keyName:_.keyName,fields:b,transaction:_._transaction,store:_._store});return _._indexers.push(g),g.ensure()})),!1)),d.push.apply(d,Be([],we(i.map(function(b){return new Ma({dbname:_.dbname,collectionName:_.name,keyName:_.keyName,fields:b,transaction:_._transaction,store:_._store}).drop()})),!1)),[4,Promise.all(d)];case 5:return E.sent(),[4,this._transaction.commit()];case 6:return E.sent(),a.sort().join(",")===s.sort().join(",")?[3,8]:(c=Vc(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:c,value:this._metadata})]);case 7:E.sent(),E.label=8;case 8:return this._state=Is.READY,this._mutex.unlock(),[3,10];case 9:throw f=E.sent(),this._mutex.unlock(),f;case 10:return[2]}})})},n.prototype.close=function(){this._state=Is.CLOSED},n.prototype._hasPropertyOfKeyName=function(t){var e=t[this.keyName];return typeof e=="string"&&!!e},n.prototype._getIndexerBy=function(t){var e,r;t===void 0&&(t=null),t||(t=[this.keyName]);var i=Ma.createKey(t);try{for(var a=oe(this._indexers),s=a.next();!s.done;s=a.next()){var u=s.value;if(i===Ma.createKey(u.fields))return u}}catch(o){e={error:o}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}throw Zn.indexTableIsRequired},n.prototype._upgradeBlockLevel=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return t=Vc(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:t,value:this._metadata})];case 1:return e.sent(),[2]}})})},n.prototype._requestInsert=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return e=t[this.keyName],[4,this._blockManager.getFromBlock(e)];case 1:return o.sent()?[3,13]:[4,this._blockManager.putToBlock(e,t)];case 2:return o.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return o.sent(),[4,this._blockManager.putToBlock(e,t)];case 4:o.sent(),o.label=5;case 5:o.trys.push([5,10,11,12]),r=oe(this._indexers),i=r.next(),o.label=6;case 6:return i.done?[3,9]:[4,i.value.addItem(t)];case 7:o.sent(),o.label=8;case 8:return i=r.next(),[3,6];case 9:return[3,12];case 10:return a=o.sent(),s={error:a},[3,12];case 11:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}return[7];case 12:return[3,14];case 13:throw Zn.collectionInsertDuplicate;case 14:return[2]}})})},n.prototype._requestUpsert=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d,c,f,h,m;return v(this,function(_){switch(_.label){case 0:return e=t[this.keyName],[4,this._blockManager.getFromBlock(e)];case 1:return(r=_.sent())?[3,13]:[4,this._blockManager.putToBlock(e,t)];case 2:return _.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return _.sent(),[4,this._blockManager.putToBlock(e,t)];case 4:_.sent(),_.label=5;case 5:_.trys.push([5,10,11,12]),i=oe(this._indexers),a=i.next(),_.label=6;case 6:return a.done?[3,9]:[4,(l=a.value).addItem(t)];case 7:_.sent(),_.label=8;case 8:return a=i.next(),[3,6];case 9:return[3,12];case 10:return s=_.sent(),c={error:s},[3,12];case 11:try{a&&!a.done&&(f=i.return)&&f.call(i)}finally{if(c)throw c.error}return[7];case 12:return[3,23];case 13:return[4,this._blockManager.putToBlock(e,t)];case 14:_.sent(),_.label=15;case 15:_.trys.push([15,21,22,23]),u=oe(this._indexers),o=u.next(),_.label=16;case 16:return o.done?[3,20]:(l=o.value).diff(l.getColumnValues(r),l.getColumnValues(t))===0?[3,19]:[4,l.removeItem(r)];case 17:return _.sent(),[4,l.addItem(t)];case 18:_.sent(),_.label=19;case 19:return o=u.next(),[3,16];case 20:return[3,23];case 21:return d=_.sent(),h={error:d},[3,23];case 22:try{o&&!o.done&&(m=u.return)&&m.call(u)}finally{if(h)throw h.error}return[7];case 23:return[2]}})})},n.prototype._requestUpdate=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return e=t[this.keyName],[4,this._blockManager.getFromBlock(e)];case 1:return(r=d.sent())?[4,this._blockManager.putToBlock(e,t)]:[3,11];case 2:d.sent(),d.label=3;case 3:d.trys.push([3,9,10,11]),i=oe(this._indexers),a=i.next(),d.label=4;case 4:return a.done?[3,8]:(s=a.value).diff(s.getColumnValues(r),s.getColumnValues(t))===0?[3,7]:[4,s.removeItem(r)];case 5:return d.sent(),[4,s.addItem(t)];case 6:d.sent(),d.label=7;case 7:return a=i.next(),[3,4];case 8:return[3,11];case 9:return u=d.sent(),o={error:u},[3,11];case 10:try{a&&!a.done&&(l=i.return)&&l.call(i)}finally{if(o)throw o.error}return[7];case 11:return[2]}})})},n.prototype._requestRemove=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return[4,this._blockManager.getFromBlock(t)];case 1:return(e=o.sent())?[4,this._blockManager.removeFromBlock(t)]:[3,10];case 2:o.sent(),o.label=3;case 3:o.trys.push([3,8,9,10]),r=oe(this._indexers),i=r.next(),o.label=4;case 4:return i.done?[3,7]:[4,i.value.removeItem(e)];case 5:o.sent(),o.label=6;case 6:return i=r.next(),[3,4];case 7:return[3,10];case 8:return a=o.sent(),s={error:a},[3,10];case 9:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}return[7];case 10:return[2]}})})},n.prototype._requestClear=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a;return v(this,function(s){switch(s.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:s.sent(),s.label=2;case 2:s.trys.push([2,7,8,9]),t=oe(this._indexers),e=t.next(),s.label=3;case 3:return e.done?[3,6]:[4,e.value.clear()];case 4:s.sent(),s.label=5;case 5:return e=t.next(),[3,3];case 6:return[3,9];case 7:return r=s.sent(),i={error:r},[3,9];case 8:try{e&&!e.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}return[7];case 9:return[2]}})})},n.prototype.getByKey=function(t){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,6];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(t)];case 3:return e=i.sent(),this._mutex.unlock(),[2,Rr(e)];case 4:throw r=i.sent(),this._mutex.unlock(),r;case 5:return[3,7];case 6:throw Zn.collectionNotReady;case 7:return[2]}})})},n.prototype.query=function(t){if(t===void 0&&(t={}),this.isReady)return new l2({condition:t.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(t.index),backward:!!t.backward});throw Zn.collectionNotReady},n.prototype.insertOne=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(t))throw Zn.collectionKeyNotGiven;return[4,this._requestInsert(Rr(t))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,t];case 5:return e=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw Zn.collectionNotReady;case 9:return[2]}})})},n.prototype.insertMany=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l=this;return v(this,function(d){switch(d.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:d.sent(),d.label=2;case 2:if(d.trys.push([2,12,,14]),t.some(function(c){return!l._hasPropertyOfKeyName(c)}))throw Zn.collectionKeyNotGiven;d.label=3;case 3:d.trys.push([3,8,9,10]),e=oe(t),r=e.next(),d.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._requestInsert(Rr(i))]);case 5:d.sent(),d.label=6;case 6:return r=e.next(),[3,4];case 7:return[3,10];case 8:return a=d.sent(),u={error:a},[3,10];case 9:try{r&&!r.done&&(o=e.return)&&o.call(e)}finally{if(u)throw u.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return d.sent(),this._mutex.unlock(),[2,t];case 12:return s=d.sent(),[4,this._transaction.clear()];case 13:throw d.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw Zn.collectionNotReady;case 16:return[2]}})})},n.prototype.upsertOne=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(t))throw Zn.collectionKeyNotGiven;return[4,this._requestUpsert(Rr(t))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,t];case 5:return e=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw Zn.collectionNotReady;case 9:return[2]}})})},n.prototype.upsertMany=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l=this;return v(this,function(d){switch(d.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:d.sent(),d.label=2;case 2:if(d.trys.push([2,12,,14]),t.some(function(c){return!l._hasPropertyOfKeyName(c)}))throw Zn.collectionKeyNotGiven;d.label=3;case 3:d.trys.push([3,8,9,10]),e=oe(t),r=e.next(),d.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._requestUpsert(Rr(i))]);case 5:d.sent(),d.label=6;case 6:return r=e.next(),[3,4];case 7:return[3,10];case 8:return a=d.sent(),u={error:a},[3,10];case 9:try{r&&!r.done&&(o=e.return)&&o.call(e)}finally{if(u)throw u.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return d.sent(),this._mutex.unlock(),[2,t];case 12:return s=d.sent(),[4,this._transaction.clear()];case 13:throw d.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw Zn.collectionNotReady;case 16:return[2]}})})},n.prototype.update=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:if(r.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(t))throw Zn.collectionKeyNotGiven;return[4,this._requestUpdate(Rr(t))];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[2,t];case 5:return e=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw Zn.collectionNotReady;case 9:return[2]}})})},n.prototype.updateIf=function(t,e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b=this;return v(this,function(g){switch(g.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,16];case 1:g.sent(),g.label=2;case 2:return g.trys.push([2,13,,15]),r=t.where,i=r===void 0?{}:r,a=t.index,s=a===void 0?null:a,u=t.backward,o=u!==void 0&&u,l=[],[4,new Pf({condition:i,blockManager:this._blockManager,backward:o,indexer:this._getIndexerBy(s)}).each(function(C){return y(b,void 0,void 0,function(){var S;return v(this,function(A){if(C.error)throw C.stop(),C.error;return C.hasNext?(S=C.nextValue,ws(i,S)&&e.set&&(typeof e.set!="function"?Object.keys(e.set).forEach(function(I){var T;S[I]=(T=e.set)===null||T===void 0?void 0:T[I]}):e.set(S),l.push(S)),C.next()):C.stop(),[2]})})})];case 3:g.sent(),g.label=4;case 4:g.trys.push([4,9,10,11]),d=oe(l),c=d.next(),g.label=5;case 5:return c.done?[3,8]:(f=c.value,[4,this._requestUpdate(Rr(f))]);case 6:g.sent(),g.label=7;case 7:return c=d.next(),[3,5];case 8:return[3,11];case 9:return h=g.sent(),_={error:h},[3,11];case 10:try{c&&!c.done&&(E=d.return)&&E.call(d)}finally{if(_)throw _.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return g.sent(),this._mutex.unlock(),[2,l];case 13:return m=g.sent(),[4,this._transaction.clear()];case 14:throw g.sent(),this._mutex.unlock(),m;case 15:return[3,17];case 16:throw this._transaction.clear(),Zn.collectionNotReady;case 17:return[2]}})})},n.prototype.remove=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,5,,7]),[4,this._requestRemove(t)];case 3:return r.sent(),[4,this._transaction.commit()];case 4:return r.sent(),this._mutex.unlock(),[3,7];case 5:return e=r.sent(),[4,this._transaction.clear()];case 6:throw r.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw Zn.collectionNotReady;case 9:return[2]}})})},n.prototype.removeIf=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d,c,f,h,m,_,E=this;return v(this,function(b){switch(b.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:b.sent(),b.label=2;case 2:return b.trys.push([2,13,,14]),e=t.where,r=e===void 0?{}:e,i=t.index,a=i===void 0?null:i,s=t.backward,u=s!==void 0&&s,o=[],[4,new Pf({condition:r,blockManager:this._blockManager,backward:u,indexer:this._getIndexerBy(a)}).each(function(g){return y(E,void 0,void 0,function(){var C,S;return v(this,function(A){if(g.error)throw g.stop(),g.error;return g.hasNext?(C=g.nextValue,ws(r,C)&&(S=C[this.keyName],o.push(S)),g.next()):g.stop(),[2]})})})];case 3:b.sent(),b.label=4;case 4:b.trys.push([4,9,10,11]),l=oe(o),d=l.next(),b.label=5;case 5:return d.done?[3,8]:(c=d.value,[4,this._requestRemove(c)]);case 6:b.sent(),b.label=7;case 7:return d=l.next(),[3,5];case 8:return[3,11];case 9:return f=b.sent(),m={error:f},[3,11];case 10:try{d&&!d.done&&(_=l.return)&&_.call(l)}finally{if(m)throw m.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return b.sent(),this._mutex.unlock(),[2,o];case 13:throw h=b.sent(),this._mutex.unlock(),h;case 14:return[3,16];case 15:throw this._transaction.clear(),Zn.collectionNotReady;case 16:return[2]}})})},n.prototype.clear=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:e.sent(),e.label=2;case 2:return e.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return e.sent(),[4,this._transaction.commit()];case 4:return e.sent(),this._mutex.unlock(),[3,7];case 5:return t=e.sent(),[4,this._transaction.clear()];case 6:throw e.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Zn.collectionNotReady;case 9:return[2]}})})},n.prototype.getBlob=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._blobContainer.get(t)];case 1:return[2,e.sent()]}})})},n.prototype.saveBlob=function(t,e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._blobContainer.save(t,e)];case 1:return[2,r.sent()]}})})},n.prototype.removeBlob=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._blobContainer.remove(t)];case 1:return e.sent(),[2]}})})},n.prototype.removeAllBlobs=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this._blobContainer.clear()];case 1:return t.sent(),[2]}})})},n}(),zc="[NESTDB]",bl=!0,os=function(){function n(){}return n.off=function(){bl=!1},n.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];bl&&console.log.apply(console,Be(["".concat(zc,"[LOG]")],we(t),!1))},n.warning=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];bl&&console.warn.apply(console,Be(["".concat(zc,"[WARNING]")],we(t),!1))},n.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];bl&&console.error.apply(console,Be(["".concat(zc,"[ERROR]")],we(t),!1))},n}(),h2=[{},{a:700400,n:"error"}],Xd=function(){function n(t){var e,r,i;this.encryption=(e=t.encryption)!==null&&e!==void 0?e:gy,this.itemSizeLimit=(r=t.itemSizeLimit)!==null&&r!==void 0?r:4194304,this.metadataBuffer=(i=t.metadataBuffer)!==null&&i!==void 0?i:256}return Object.defineProperty(n.prototype,"_encryptionCheckKey",{get:function(){return"".concat(this.dbname,".encrypt")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_reservedKeys",{get:function(){return[this._encryptionCheckKey]},enumerable:!1,configurable:!0}),n.prototype._getRawKey=function(t,e){return e===void 0&&(e=""),"".concat(t).concat(e)},n.prototype._generateShardPostfixArray=function(t){return t===void 0&&(t=1),Be([],we(Array(t).keys()),!1)},n.prototype._shardify=function(t){var e=this,r=t.key,i=t.value,a=JSON.stringify(this.encryption.encrypt(i)),s=Math.ceil(a.length/this.adjustedItemSizeLimit);return this._generateShardPostfixArray(s).map(function(u){var o={key:e._getRawKey(r,".".concat(u)),data:a.substring(u*e.adjustedItemSizeLimit,(u+1)*e.adjustedItemSizeLimit)};return u===0&&(o.metadata={shards:s}),o})},n.prototype._resetIfEncryptionChanged=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u,o,l,d=this;return v(this,function(c){switch(c.label){case 0:return[4,this.get(this._encryptionCheckKey)];case 1:if(t=c.sent(),e={encrypted:h2.map(function(f){var h;return(h=d.encryption)===null||h===void 0?void 0:h.encrypt(f)})},!t)return[3,8];if(!t.encrypted||!Array.isArray(t.encrypted))return[3,6];for(a in r=t.encrypted,i=[],r)i.push(a);s=0,c.label=2;case 2:return s<i.length?(a=i[s])in r?(u=a,o=JSON.stringify(t.encrypted[u]),l=JSON.stringify(e.encrypted[u]),o===l?[3,4]:(os.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this.clear()])):[3,4]:[3,5];case 3:return c.sent(),[3,5];case 4:return s++,[3,2];case 5:return[3,8];case 6:return[4,this.clear()];case 7:c.sent(),c.label=8;case 8:return[4,this.set({key:this._encryptionCheckKey,value:e})];case 9:return c.sent(),[2]}})})},Object.defineProperty(n.prototype,"adjustedItemSizeLimit",{get:function(){return Math.max(this.itemSizeLimit-this.metadataBuffer,4)},enumerable:!1,configurable:!0}),n.prototype.usage=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return t=0,[4,this._getAllRawKeys()];case 1:e=d.sent(),d.label=2;case 2:d.trys.push([2,7,8,9]),r=oe(e),i=r.next(),d.label=3;case 3:return i.done?[3,6]:(a=i.value,[4,this._getRaw(a)]);case 4:(s=d.sent())&&(t+=JSON.stringify(s).length),d.label=5;case 5:return i=r.next(),[3,3];case 6:return[3,9];case 7:return u=d.sent(),o={error:u},[3,9];case 8:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}return[7];case 9:return[2,t]}})})},n.prototype.getAllKeys=function(){return y(this,void 0,void 0,function(){var t=this;return v(this,function(e){switch(e.label){case 0:return[4,this._getAllRawKeys()];case 1:return[2,e.sent().filter(function(r){return r.endsWith(".0")}).map(function(r){return r.replace(/\.0$/,"")}).filter(function(r){return!t._reservedKeys.includes(r)})]}})})},n.prototype.get=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o=this;return v(this,function(l){switch(l.label){case 0:return e=this._getRawKey(t,".0"),[4,this._getRaw(e)];case 1:if(!(r=l.sent()))return[3,7];l.label=2;case 2:return l.trys.push([2,6,,7]),i=r.data,(a=r.metadata)!=null&&a.shards&&a.shards>1?[4,Promise.all(this._generateShardPostfixArray(a==null?void 0:a.shards).map(function(d){return y(o,void 0,void 0,function(){var c,f;return v(this,function(h){switch(h.label){case 0:return d>0?(c=this._getRawKey(t,".".concat(d)),[4,this._getRaw(c)]):[3,2];case 1:if(!(f=h.sent()))throw Zn.storeBrokenIntegrity;return[2,f.data];case 2:return[2,i]}})})}))]:[3,4];case 3:return u=l.sent(),[3,5];case 4:u=[i],l.label=5;case 5:return s=u,[2,this.encryption.decrypt(JSON.parse(s.join("")))];case 6:return l.sent(),[2,null];case 7:return[2,null]}})})},n.prototype.set=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return e=this._shardify(t),[4,this._setRaw(e)];case 1:return r.sent(),[2,D({},t.value)]}})})},n.prototype.setMany=function(t){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(i){switch(i.label){case 0:return e=[],[4,this._setRaw(e.concat.apply(e,Be([],we(t.map(function(a){return r._shardify(a)})),!1)))];case 1:return i.sent(),[2,t.map(function(a){return a.value})]}})})},n.prototype.remove=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u=this;return v(this,function(o){switch(o.label){case 0:return e=this._getRawKey(t,".0"),[4,this._getRaw(e)];case 1:return(r=o.sent())?(i=r.metadata,a=this._generateShardPostfixArray(i==null?void 0:i.shards).map(function(l){return u._getRawKey(t,".".concat(l))}),[4,this._removeRaw(a)]):[3,3];case 2:return o.sent(),(s=Lr.get(this.dbname))==null||s.remove(t),[2,!0];case 3:return[2,!1]}})})},n.prototype.removeMany=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d,c,f=this;return v(this,function(h){switch(h.label){case 0:e=Lr.get(this.dbname),r=[],i=function(m){var _,E,b;return v(this,function(g){switch(g.label){case 0:return _=a._getRawKey(m,".0"),[4,a._getRaw(_)];case 1:return(E=g.sent())&&(b=E.metadata,r.push.apply(r,Be([],we(a._generateShardPostfixArray(b==null?void 0:b.shards).map(function(C){return f._getRawKey(m,".".concat(C))})),!1))),e==null||e.remove(m),[2]}})},a=this,h.label=1;case 1:h.trys.push([1,6,7,8]),s=oe(t),u=s.next(),h.label=2;case 2:return u.done?[3,5]:(o=u.value,[5,i(o)]);case 3:h.sent(),h.label=4;case 4:return u=s.next(),[3,2];case 5:return[3,8];case 6:return l=h.sent(),d={error:l},[3,8];case 7:try{u&&!u.done&&(c=s.return)&&c.call(s)}finally{if(d)throw d.error}return[7];case 8:return r.length>0?[4,this._removeRaw(r)]:[3,10];case 9:h.sent(),h.label=10;case 10:return[2,t]}})})},n.prototype.clear=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){return(t=Lr.get(this.dbname))==null||t.clearForDatabase(this.dbname),[2]})})},n}(),Ar={},ms=function(n){function t(e){e===void 0&&(e={});var r,i=this;i=n.call(this,D(D({},e),{itemSizeLimit:(r=e.itemSizeLimit)!==null&&r!==void 0?r:4194304}))||this;var a=e.delay,s=a===void 0?1:a;return i.delay=s,i.observer={},i}return w(t,n),Object.defineProperty(t.prototype,"rawData",{get:function(){return Ar[this.dbname]},set:function(e){Ar[this.dbname]=e},enumerable:!1,configurable:!0}),t.prototype._getAllRawKeys=function(){return y(this,void 0,void 0,function(){return v(this,function(e){if(Ar[this.dbname])return[2,Object.keys(Ar[this.dbname])];throw Zn.storeNotAvailable})})},t.prototype._getRaw=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return Ar[this.dbname]?[4,vl(this.delay)]:[3,2];case 1:return r.sent(),[2,Ar[this.dbname][e]?D({key:e},Ar[this.dbname][e]):null];case 2:throw Zn.storeNotAvailable}})})},t.prototype._setRaw=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d;return v(this,function(c){switch(c.label){case 0:return Ar[this.dbname]?[4,vl(this.delay)]:[3,2];case 1:c.sent();try{for(r=oe(e),i=r.next();!i.done;i=r.next())a=i.value,s=a.key,u=a.data,o=a.metadata,Ar[this.dbname][s]=Object.freeze({data:u,metadata:o})}catch(f){l={error:f}}finally{try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(l)throw l.error}}return[3,3];case 2:throw Zn.storeNotAvailable;case 3:return[2]}})})},t.prototype._removeRaw=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return Ar[this.dbname]?[4,vl(this.delay)]:[3,2];case 1:o.sent();try{for(r=oe(e),i=r.next();!i.done;i=r.next())a=i.value,Ar[this.dbname][a]&&delete Ar[this.dbname][a]}catch(l){s={error:l}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}return[3,3];case 2:throw Zn.storeNotAvailable;case 3:return[2]}})})},t.prototype.observe=function(e,r,i){var a=this;this.observer[e]||(this.observer[e]={}),r.forEach(function(s){return a.observer[e][s]=i})},t.prototype.checkAvailability=function(){return y(this,void 0,void 0,function(){return v(this,function(e){return[2]})})},t.prototype.init=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return this.dbname=e,Ar[this.dbname]||(Ar[this.dbname]={}),[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},t.prototype.set=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){if((r=this.observer[e.key])&&typeof r.set=="function"&&(i=r.set()))throw i;return[2,n.prototype.set.call(this,e)]})})},t.prototype.setMany=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){try{for(r=oe(e),i=r.next();!i.done;i=r.next())if(a=i.value,(s=this.observer[a.key])&&typeof s.set=="function"&&(u=s.set()))throw u}catch(c){o={error:c}}finally{try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(o)throw o.error}}return[2,n.prototype.setMany.call(this,e)]})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,n.prototype.clear.call(this)];case 1:return e.sent(),[4,vl(this.delay)];case 2:return e.sent(),Ar[this.dbname]={},[2]}})})},t}(Xd),Y_="NestDBStore";(function(n){n[n.UNINITIALIZED=0]="UNINITIALIZED",n[n.OPENING=1]="OPENING",n[n.OPEN=2]="OPEN",n[n.CLOSED=3]="CLOSED"})(Si||(Si={}));var Bi,p2=function(n){function t(e){e===void 0&&(e={});var r,i=this;return(i=n.call(this,D(D({},e),{itemSizeLimit:(r=e.itemSizeLimit)!==null&&r!==void 0?r:104857600}))||this)._storeName=Y_,i._state=Si.UNINITIALIZED,i._openJobQueue=[],i._window=typeof window<"u"?window:void 0,i._indexedDb=i._window?i._window.indexedDB||i._window.mozIndexedDB||i._window.webkitIndexedDB||i._window.msIndexedDB:void 0,i}return w(t,n),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.isTransactionInactiveError=function(e){return e instanceof Error&&e.message.includes("The transaction is inactive")},t.prototype._putToObjectStore=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){return[2,new Promise(function(a,s){var u=e.put(r);u.addEventListener("success",function(o){a(o.target.result)}),u.addEventListener("error",function(){s("Failed to write.")})})]})})},t.prototype._deleteFromObjectStore=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){return[2,new Promise(function(a,s){var u=e.delete(r);u.addEventListener("success",function(){return a(r)}),u.addEventListener("error",function(o){return s(o.target.error)})})]})})},t.prototype._openDatabase=function(e){var r=this;return new Promise(function(i,a){if(r._indexedDb){r._state=Si.OPENING;var s=r._indexedDb.open(e);s.addEventListener("upgradeneeded",function(u){u.target.result.createObjectStore(Y_,{keyPath:"key"})}),s.addEventListener("success",function(u){r._state=Si.OPEN,r._database=u.target.result,r._openJobQueue.forEach(function(o){return o()}),r._openJobQueue=[],r._database.onclose=function(){r._database=void 0,r._state=Si.OPENING,setTimeout(function(){r._openDatabase(e)},5)},i(r._database)}),s.addEventListener("error",function(u){r._state=Si.UNINITIALIZED,a(u.target.error)})}else a(Zn.storeNotAvailable)})},t.prototype._getObjectStore=function(e){return y(this,void 0,void 0,function(){var r=this;return v(this,function(i){switch(i.label){case 0:return this._database?[2,this._database.transaction(this._storeName,e).objectStore(this._storeName)]:[3,1];case 1:switch(this._state){case Si.UNINITIALIZED:case Si.OPEN:return[3,2];case Si.OPENING:case Si.CLOSED:return[3,3]}return[3,4];case 2:throw Zn.storeNotInitialized;case 3:return[2,new Promise(function(a){r._openJobQueue.push(function(){return a(r._getObjectStore(e))})})];case 4:return[4,this._getObjectStore(e)];case 5:return[2,i.sent()]}})})},t.prototype._getAllRawKeys=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return e=r.sent(),[4,new Promise(function(i,a){var s=e.getAllKeys();s.addEventListener("success",function(u){i(u.target.result)}),s.addEventListener("error",function(u){return a(u.target.error)})})];case 2:return[2,r.sent()]}})})},t.prototype._getRaw=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return r=i.sent(),[4,new Promise(function(a,s){var u=r.get(e);u.addEventListener("success",function(o){var l;a((l=o==null?void 0:o.target)===null||l===void 0?void 0:l.result)}),u.addEventListener("error",function(o){return s(o.target.error)})})];case 2:return[2,i.sent()]}})})},t.prototype._setRaw=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c=this;return v(this,function(f){switch(f.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:r=f.sent(),f.label=2;case 2:return f.trys.push([2,4,,15]),[4,Promise.all(e.map(function(h){return c._putToObjectStore(r,h)}))];case 3:return f.sent(),[3,15];case 4:if(i=f.sent(),!this.isTransactionInactiveError(i))return[3,13];f.label=5;case 5:f.trys.push([5,10,11,12]),a=oe(e),s=a.next(),f.label=6;case 6:return s.done?[3,9]:(u=s.value,[4,this._putToObjectStore(r,u)]);case 7:f.sent(),f.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return o=f.sent(),l={error:o},[3,12];case 11:try{s&&!s.done&&(d=a.return)&&d.call(a)}finally{if(l)throw l.error}return[7];case 12:return[3,14];case 13:throw i;case 14:return[3,15];case 15:return[2]}})})},t.prototype._removeRaw=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c=this;return v(this,function(f){switch(f.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:r=f.sent(),f.label=2;case 2:return f.trys.push([2,4,,15]),[4,Promise.all(e.map(function(h){return c._deleteFromObjectStore(r,h)}))];case 3:return f.sent(),[3,15];case 4:if(i=f.sent(),!this.isTransactionInactiveError(i))return[3,13];f.label=5;case 5:f.trys.push([5,10,11,12]),a=oe(e),s=a.next(),f.label=6;case 6:return s.done?[3,9]:(u=s.value,[4,this._deleteFromObjectStore(r,u)]);case 7:f.sent(),f.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return o=f.sent(),l={error:o},[3,12];case 11:try{s&&!s.done&&(d=a.return)&&d.call(a)}finally{if(l)throw l.error}return[7];case 12:return[3,14];case 13:throw i;case 14:return[3,15];case 15:return[2]}})})},t.prototype._triggerDatabaseClose=function(){this._database&&this._database.onclose&&this._database.onclose(new Event("dummy"))},t.prototype.checkAvailability=function(){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(i){switch(i.label){case 0:if(!((e=typeof window<"u"?window:null)!=null&&e.indexedDB||e!=null&&e.mozIndexedDB||e!=null&&e.webkitIndexedDB||e!=null&&e.msIndexedDB))return[3,6];if(this._indexedDb=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,!this._window||!vd())return[3,4];if(!(vd()&&navigator.userAgent&&navigator.userAgent.includes("Edge/")))return[3,1];if(!this._window.indexedDB&&(e.PointerEvent||e.MSPointerEvent))throw Zn.storeNotAvailableInPrivateBrowsing;return[3,3];case 1:return[4,new Promise(function(a,s){if(r._indexedDb)try{var u=r._indexedDb.open("_testMozilla");u.onerror=function(){return s(Zn.storeNotAvailableInPrivateBrowsing)},u.onsuccess=function(o){if(o.target.result.close(),r._indexedDb){var l=r._indexedDb.deleteDatabase("_testMozilla");l.onerror=function(){return a()},l.onsuccess=function(){return a()}}else s(Zn.storeNotAvailable)}}catch{s(Zn.storeNotAvailableInPrivateBrowsing)}else s(Zn.storeNotAvailable)})];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:throw Zn.storeNotAvailable;case 5:return[3,7];case 6:throw Zn.storeNotAvailable;case 7:return[2]}})})},t.prototype.init=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return this.dbname=e,[4,this.checkAvailability()];case 1:return r.sent(),[4,this._openDatabase(e)];case 2:return r.sent(),[4,this._resetIfEncryptionChanged()];case 3:return r.sent(),[2]}})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return[4,n.prototype.clear.call(this)];case 1:return r.sent(),[4,this._getObjectStore("readwrite")];case 2:return e=r.sent(),[4,new Promise(function(i,a){var s=e.clear();s.addEventListener("success",function(){return i()}),s.addEventListener("error",function(u){return a(u.target.error)})})];case 3:return[2,r.sent()]}})})},t}(Xd),m2=function(n){function t(e){var r=this,i=e.AsyncStorage,a=e.itemSizeLimit,s=a===void 0?2097152:a,u=WS(e,["AsyncStorage","itemSizeLimit"]);return(r=n.call(this,D(D({},u),{itemSizeLimit:s}))||this)._asyncStorage=i,r}return w(t,n),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.getAllKeys()];case 1:return e=i.sent(),[2,e.filter(function(a){return r._isBelonging(a)}).map(function(a){return a.substring("".concat(r.dbname,"/").length)})]}})})},t.prototype._getRaw=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return[2,(r=i.sent())?JSON.parse(r):null]}})})},t.prototype._setRaw=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:r=[];try{for(i=oe(e),a=i.next();!a.done;a=i.next())s=a.value,u=s.key,s.data.length<=this.adjustedItemSizeLimit&&r.push([this._getActualKey(u),JSON.stringify(s)])}catch(c){o={error:c}}finally{try{a&&!a.done&&(l=i.return)&&l.call(i)}finally{if(o)throw o.error}}return[4,this._asyncStorage.multiSet(r)];case 1:return d.sent(),[2]}})})},t.prototype._removeRaw=function(e){return y(this,void 0,void 0,function(){var r=this;return v(this,function(i){switch(i.label){case 0:return[4,this._asyncStorage.multiRemove(e.map(function(a){return r._getActualKey(a)}))];case 1:return i.sent(),[2]}})})},t.prototype.checkAvailability=function(){return y(this,void 0,void 0,function(){return v(this,function(e){if(!this._asyncStorage)throw Zn.storeNotAvailable;return[2]})})},t.prototype.init=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return[4,n.prototype.clear.call(this)];case 1:return r.sent(),[4,this.getAllKeys()];case 2:return e=r.sent(),[4,this.removeMany(e)];case 3:return r.sent(),[2]}})})},t}(Xd),_2=function(n){function t(e){var r,i=this;return(i=n.call(this,D(D({},e),{itemSizeLimit:(r=e.itemSizeLimit)!==null&&r!==void 0?r:6291456}))||this)._mmkv=e.MMKV,i}return w(t,n),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(i){switch(i.label){case 0:return[4,this._mmkv.getAllKeys()];case 1:return e=i.sent(),[2,e.filter(function(a){return r._isBelonging(a)}).map(function(a){return a.substring("".concat(r.dbname,"/").length)})]}})})},t.prototype._getRaw=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return[4,this._mmkv.getString(this._getActualKey(e))];case 1:return[2,(r=i.sent())?JSON.parse(r):null]}})})},t.prototype._setRaw=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){try{for(r=oe(e),i=r.next();!i.done;i=r.next())a=i.value,s=a.key,a.data.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(s),JSON.stringify(a))}catch(d){u={error:d}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(u)throw u.error}}return[2]})})},t.prototype._removeRaw=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u;return v(this,function(o){try{for(r=oe(e),i=r.next();!i.done;i=r.next())a=i.value,this._mmkv.delete(this._getActualKey(a))}catch(l){s={error:l}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}return[2]})})},t.prototype.checkAvailability=function(){return y(this,void 0,void 0,function(){return v(this,function(e){if(!this._mmkv)throw Zn.storeNotAvailable;return[2]})})},t.prototype.init=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return r.sent(),[2]}})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:return[4,n.prototype.clear.call(this)];case 1:return r.sent(),[4,this.getAllKeys()];case 2:return e=r.sent(),[4,this.removeMany(e)];case 3:return r.sent(),[2]}})})},t}(Xd);(function(n){n.INIT="INIT",n.OPENING="OPENING",n.OPENED="OPENED",n.CLOSED="CLOSED"})(Bi||(Bi={}));var fa,g2=function(){function n(t){var e=t.name,r=t.version,i=t.store,a=t.config;this.name=e,this._version=r,this._state=Bi.INIT,this._config=a||new $o({dbname:e}),this._store=i,this._event={success:to,error:to,storeReplaced:to,upgrade:z_},this._collections=new Map,this._globalMutex=new Bp("".concat(this.name,".lock")),this._config.disableLogger&&os.off(),new Lr({dbname:e,limit:this._config.cacheLimit})}return Object.defineProperty(n.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),n.prototype._initializeCollection=function(t,e){var r;return y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return a=this._collections.get(t),e?(i=new qc({dbname:this.name,collectionName:t,keyName:e.keyName,indexes:(r=e.index)!==null&&r!==void 0?r:[[e.keyName]],store:this._store}),[3,3]):[3,1];case 1:return a&&a.state===Is.READY?[3,3]:[4,qc.metadataOf(this.name,t,this._store)];case 2:(s=u.sent())&&(i=new qc({dbname:this.name,collectionName:t,keyName:s.keyName,indexes:s.indexes,store:this._store})),u.label=3;case 3:return i?(this._collections.set(t,i),[4,i.init()]):[3,5];case 4:u.sent(),u.label=5;case 5:return[2]}})})},n.prototype.estimateUsage=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,(e=this._store,y(void 0,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,e.usage()];case 1:return[2,r.sent()]}})}))];case 1:return[2,t.sent()]}var e})})},n.prototype.commitSchema=function(t){return y(this,void 0,void 0,function(){var e=this;return v(this,function(r){switch(r.label){case 0:return this._state!==Bi.OPENING?[3,2]:[4,Promise.all(t.map(function(i){return y(e,void 0,void 0,function(){return v(this,function(a){switch(a.label){case 0:return[4,this._initializeCollection(i.collectionName,i)];case 1:return a.sent(),[2]}})})}))];case 1:return r.sent(),[3,3];case 2:throw Zn.databaseSchemaNotOnUpgrade;case 3:return[2]}})})},n.prototype.open=function(){var t;return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d,c,f=this;return v(this,function(h){switch(h.label){case 0:return[4,this._globalMutex.lock()];case 1:if(h.sent(),this._state===Bi.OPENED)return[3,20];this._state=Bi.OPENING,h.label=2;case 2:return h.trys.push([2,13,,20]),[4,this._store.init(this.name)];case 3:return h.sent(),m=this.name,e="".concat(Hp(m),".metadata"),r={version:0,collectionNames:[]},[4,this._store.get(e)];case 4:i=(t=h.sent())!==null&&t!==void 0?t:r,h.label=5;case 5:h.trys.push([5,10,11,12]),a=oe(i.collectionNames),s=a.next(),h.label=6;case 6:return s.done?[3,9]:(u=s.value,[4,this._initializeCollection(u)]);case 7:h.sent(),h.label=8;case 8:return s=a.next(),[3,6];case 9:return[3,12];case 10:return o=h.sent(),d={error:o},[3,12];case 11:try{s&&!s.done&&(c=a.return)&&c.call(a)}finally{if(d)throw d.error}return[7];case 12:return[2,new Promise(function(_,E){var b=function(C){i.version<f._version?f._event.upgrade(i.version,function(S){return y(f,void 0,void 0,function(){var A;return v(this,function(I){switch(I.label){case 0:if(S)return[3,5];i.version++,i.collectionNames=Array.from(this._collections.keys()),I.label=1;case 1:return I.trys.push([1,3,,4]),[4,this._store.set({key:e,value:i})];case 2:return I.sent(),C({continued:!0}),[3,4];case 3:return A=I.sent(),C({continued:!1,err:A}),[3,4];case 4:return[3,6];case 5:C({continued:!1,err:S}),I.label=6;case 6:return[2]}})})}):C({continued:!1})},g=function(C){var S=C.continued,A=S!==void 0&&S,I=C.err,T=I===void 0?null:I;A?setTimeout(function(){return b(g)},10):T?(os.error(T.message),f._globalMutex.unlock(),f._event.error(T),E(T)):Promise.all(i.collectionNames.map(function(M){return f._initializeCollection(M)})).then(function(){f._state=Bi.OPENED,f._globalMutex.unlock(),f._event.success(),_()}).catch(function(M){os.error(M.message),f._globalMutex.unlock(),f._event.error(M),E(M)})};b(g)})];case 13:switch(l=h.sent(),l.code){case vt.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,14];case vt.STORE_NOT_AVAILABLE:return[3,16]}return[3,18];case 14:return os.warning("Access to the local storage is not allowed. Switched to MemoryStore automatically."),this._store=new ms({}),this._globalMutex.unlock(),this._event.error(l),this._event.storeReplaced(this._store),[4,this.open()];case 15:return h.sent(),[3,19];case 16:return os.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new ms({}),this._globalMutex.unlock(),this._event.error(l),this._event.storeReplaced(this._store),[4,this.open()];case 17:return h.sent(),[3,19];case 18:throw os.error(l.message),this._globalMutex.unlock(),this._event.error(l),l;case 19:return[3,20];case 20:return[2]}var m})})},n.prototype.close=function(){this._collections.forEach(function(t){return t.close()}),this._state=Bi.CLOSED},n.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Promise.all(Array.from(this._collections.values()).map(function(e){return e.clear()}))];case 1:return t.sent(),[2]}})})},n.prototype.reset=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return(t=Lr.get(this.name))&&t.clearForDatabase(this.name),[4,this._store.clear()];case 1:return e.sent(),[2]}})})},n.prototype.on=function(t,e){this._event[t]=e},n.prototype.off=function(t){typeof this._event[t]=="function"&&(t==="upgrade"?this._event[t]=z_:this._event[t]=to)},n.prototype.collection=function(t){var e=this._collections.get(t);if(e)return e;throw Zn.collectionNotReady},n}();(function(n){n[n.VERBOSE=0]="VERBOSE",n[n.DEBUG=1]="DEBUG",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.NONE=5]="NONE"})(fa||(fa={}));var rr,E2=function(){function n(){this.level=fa.WARN}return n.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=fa.VERBOSE&&console.log.apply(console,Be(["[verbose]"],we(t),!1))},n.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=fa.DEBUG&&console.log.apply(console,Be(["[debug]"],we(t),!1))},n.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=fa.INFO&&console.log.apply(console,Be(["[info]"],we(t),!1))},n.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=fa.WARN&&console.warn.apply(console,Be(["[warn]"],we(t),!1))},n.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.level<=fa.ERROR&&console.error.apply(console,Be(["[error]"],we(t),!1))},n}(),Xa=function(){function n(t){var e,r,i,a;this.messageTypeFilter=(e=t==null?void 0:t.messageTypeFilter)!==null&&e!==void 0?e:ur.ALL,this.customTypesFilter=(r=t==null?void 0:t.customTypesFilter)!==null&&r!==void 0?r:null,this.senderUserIdsFilter=(i=t==null?void 0:t.senderUserIdsFilter)!==null&&i!==void 0?i:null,this.replyType=(a=t==null?void 0:t.replyType)!==null&&a!==void 0?a:Kt.NONE}return n.prototype.clone=function(){var t=new n,e=JSON.parse(JSON.stringify(this));return Object.keys(e).forEach(function(r){t[r]=e[r]}),t},n.prototype.match=function(t){switch(this.messageTypeFilter){case ur.USER:if(t.messageType!==At.USER)return!1;break;case ur.FILE:if(t.messageType!==At.FILE)return!1;break;case ur.ADMIN:if(t.messageType!==At.ADMIN)return!1}if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(t.customType)||this.senderUserIdsFilter&&this.senderUserIdsFilter.length>0&&(!(t instanceof Dt)||!this.senderUserIdsFilter.includes(t.sender.userId)))return!1;if(t instanceof mr)switch(this.replyType){case Kt.NONE:if(t.parentMessageId>0)return!1;break;case Kt.ONLY_REPLY_TO_CHANNEL:if(t instanceof Dt&&t.parentMessageId>0&&!t.replyToChannel)return!1}return!0},n}();(function(n){n.CHANNEL_LATEST="channel_latest",n.NEWEST_CHILD_MESSAGE="newest_child_message"})(rr||(rr={}));var Co,zi=function(n){switch(n){case rr.CHANNEL_LATEST:return["channelUrl","-createdAt","-messageId"];case rr.NEWEST_CHILD_MESSAGE:return["channelUrl","-parentMessageId","-createdAt","-messageId"]}},v2=function(){return["channelUrl","-createdAt","-notificationId"]},y2=D(D({},bb),{scheduledAt:void 0}),b2=function(n){return Sb(n)&&x("number",n.scheduledAt,!0)},C2=D(D({},Yd),{scheduledAt:0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),S2=function(n){return Qd(n)&&x("number",n.scheduledAt)&&(Zt(n.file)||x("string",n.fileUrl))&&x("string",n.fileName,!0)&&x("string",n.mimeType,!0)&&x("number",n.fileSize,!0)&&(n.thumbnailSizes===null||n.thumbnailSizes===void 0||n.thumbnailSizes.every(function(t){return x("object",t)&&t.maxWidth>0&&t.maxHeight>0}))},Bb="UnsentMessage",T2="reqId",Cl={},Fs=function(n){function t(e){var r=n.call(this,e)||this;return r._mutex=new Bp("unsendmessagecache.lock"),Cl[e]=r,r}return w(t,n),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return k.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,r){return r===void 0&&(r=!1),Cl[e]&&!r||(Cl[e]=new t(e)),Cl[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb,r=e==null?void 0:e.collection(Bb);if(!r)throw H.databaseError;return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){if(e.messageId>0)throw H.invalidParameters;var r,i=D({},e.serialize());return e instanceof sr?(e.messageParams&&(i.messageParams=O_(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(i.scheduledInfo.scheduledMessageParams=(r=e.scheduledInfo.scheduledMessageParams,D(D({},O_(r)),{scheduledAt:r.scheduledAt})))):e instanceof Ft?(e.messageParams&&(i.messageParams=R_(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(i.scheduledInfo.scheduledMessageParams=function(a){return D(D({},R_(a)),{scheduledAt:a.scheduledAt})}(e.scheduledInfo.scheduledMessageParams))):e instanceof oi&&e.messageParams&&(i.messageParams=function(a){return ge({fileInfoList:a.fileInfoList,isReplyToChannel:a.isReplyToChannel,pushNotificationDeliveryOption:a.pushNotificationDeliveryOption})}(e.messageParams)),i},t.prototype._deserialize=function(e){return e=D(D({},e),{messageId:parseInt(e.messageId)}),zt.of(this._iid).buildMessageFromSerializedData(e)},t.prototype._deserializeWithMessageCreateParams=function(e){var r,i,a;return y(this,void 0,void 0,function(){var s,u,o,l,d,c,f=this;return v(this,function(h){switch(h.label){case 0:return s=zt.of(this._iid),u=this._deserialize(e),e.messageParams?u instanceof sr?(l=e.messageParams,u.messageParams=s.buildUserMessageCreateParamsFromSerializedData(l,u),[3,6]):[3,1]:[3,6];case 1:return u instanceof Ft?(l=e.messageParams).fileKey&&typeof l.fileKey=="string"&&Hc((r=l.fileType)!==null&&r!==void 0?r:"")?(o=l,[4,this.collection.getBlob(l.fileKey)]):[3,3]:[3,4];case 2:o.file=(i=h.sent())!==null&&i!==void 0?i:void 0,h.label=3;case 3:return u.messageParams=s.buildFileMessageCreateParamsFromSerializedData(l,u),[3,6];case 4:return u instanceof oi&&(l=e.messageParams)&&l.fileInfoList?(u.messageParams=s.buildMultipleFilesMessageCreateParamsFromSerializedData(l,u),[4,Promise.all(u.messageParams.fileInfoList.map(function(m){return y(f,void 0,void 0,function(){var _,E,b,g,C;return v(this,function(S){switch(S.label){case 0:return typeof((E=m._uploadedMetaData)===null||E===void 0?void 0:E.fileKey)=="string"&&Hc((g=(b=m._uploadedMetaData)===null||b===void 0?void 0:b.fileType)!==null&&g!==void 0?g:"")?(_=m,[4,this.collection.getBlob(m._uploadedMetaData.fileKey)]):[3,2];case 1:_.file=(C=S.sent())!==null&&C!==void 0?C:void 0,S.label=2;case 2:return[2]}})})}))]):[3,6];case 5:h.sent(),h.label=6;case 6:return u.scheduledInfo&&e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams?u instanceof sr?(d=e.scheduledInfo.scheduledMessageParams,u.scheduledInfo.scheduledMessageParams=s.buildScheduledUserMessageCreateParamsFromSerializedData(d,u),[3,10]):[3,7]:[3,10];case 7:return u instanceof Ft?(d=e.scheduledInfo.scheduledMessageParams).fileKey&&typeof d.fileKey=="string"&&typeof d.fileType=="string"&&Hc(d.fileType)?(c=d,[4,this.collection.getBlob(d.fileKey)]):[3,9]:[3,10];case 8:c.file=(a=h.sent())!==null&&a!==void 0?a:void 0,h.label=9;case 9:u.scheduledInfo.scheduledMessageParams=s.buildScheduledFileMessageCreateParamsFromSerializedData(d,u),h.label=10;case 10:return[2,u]}})})},t.prototype._getFileInfoBlobKey=function(e,r){return"".concat(e,".").concat(r)},t.prototype.get=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(r=i.sent())return[2,this._deserializeWithMessageCreateParams(r)];i.label=2;case 2:return[2,void 0]}})})},t.prototype.fetch=function(e){var r=e.channelUrl,i=e.filter,a=i===void 0?new Xa:i,s=e.order,u=s===void 0?rr.CHANNEL_LATEST:s,o=e.sendingStatus,l=e.backward,d=l!==void 0&&l,c=e.parentMessageId;return y(this,void 0,void 0,function(){var f,h,m,_,E=this;return v(this,function(b){switch(b.label){case 0:return this.localCacheEnabled?(f=zi(u),h={"/where":function(g){return!!(u!==rr.NEWEST_CHILD_MESSAGE||c&&g.parentMessageId!==0&&g.parentMessageId===c)&&a.match(E._deserialize(g))}},r&&(h.channelUrl=r),o&&(h.sendingStatus=o),m={where:h,index:f,backward:d},[4,this.collection.query(m)]):[3,3];case 1:return[4,b.sent().fetch({})];case 2:return _=b.sent(),[2,Promise.all(_.map(function(g){return y(E,void 0,void 0,function(){return v(this,function(C){switch(C.label){case 0:return[4,this._deserializeWithMessageCreateParams(g)];case 1:return[2,C.sent()]}})})}))];case 3:return[2,[]]}})})},t.prototype.getAllChildMessages=function(e,r){return r===void 0&&(r=new Xa),y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return[4,this.fetch({filter:r,order:rr.NEWEST_CHILD_MESSAGE,channelUrl:e.channelUrl,backward:!1,parentMessageId:e.messageId})];case 1:return[2,i.sent()]}})})},t.prototype.upsert=function(e){return y(this,void 0,void 0,function(){var r=this;return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(a){return y(r,void 0,void 0,function(){var s;return v(this,function(u){switch(u.label){case 0:return a instanceof Ft||a instanceof oi?[4,this._mutex.lock()]:[3,4];case 1:return u.sent(),[4,this.saveBlob(a)];case 2:return u.sent(),[4,this._mutex.unlock()];case 3:u.sent(),u.label=4;case 4:return s=this._serialize(a),[4,this.collection.upsertOne(s)];case 5:return u.sent(),[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.upsertChildMessages=function(e){return y(this,void 0,void 0,function(){var r=this;return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(a){return y(r,void 0,void 0,function(){var s;return v(this,function(u){switch(u.label){case 0:return s=[],a.threadInfo&&a.threadInfo.replyCount>0?[4,this.getAllChildMessages(a)]:[3,2];case 1:s=u.sent(),u.label=2;case 2:return s.length>0?(s.forEach(function(o){return o.applyParentMessage(a)}),[4,this.upsert(s)]):[3,4];case 3:u.sent(),u.label=4;case 4:return[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.remove=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:if(!this.localCacheEnabled)return[3,8];l.label=1;case 1:l.trys.push([1,6,7,8]),r=oe(e),i=r.next(),l.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove(a)]);case 3:l.sent(),l.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=l.sent(),u={error:s},[3,8];case 7:try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(u)throw u.error}return[7];case 8:return[2]}})})},t.prototype.removeMessagesOfChannel=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e}})]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.saveBlob=function(e){return y(this,void 0,void 0,function(){var r,i,a,s=this;return v(this,function(u){switch(u.label){case 0:return e instanceof Ft?e.messageParams&&(a=e.messageParams).file&&Bl(a.file)?[4,this.collection.saveBlob(a.file,e.reqId)]:[3,2]:[3,5];case 1:i=u.sent(),a.fileKey=i,a.fileType=Ms.BLOB,u.label=2;case 2:return e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(r=e.scheduledInfo.scheduledMessageParams).file&&Bl(r.file)?[4,this.collection.saveBlob(r.file,e.reqId)]:[3,4];case 3:i=u.sent(),r.fileKey=i,r.fileType=Ms.BLOB,u.label=4;case 4:return[3,7];case 5:return e instanceof oi&&(a=e.messageParams)&&a.fileInfoList&&Array.isArray(a.fileInfoList)?[4,Promise.all(a.fileInfoList.map(function(o,l){return y(s,void 0,void 0,function(){var d;return v(this,function(c){switch(c.label){case 0:return o.file&&Bl(o.file)?[4,this.collection.saveBlob(o.file,this._getFileInfoBlobKey(e.reqId,l))]:[3,2];case 1:d=c.sent(),o._uploadedMetaData||(o._uploadedMetaData={}),o._uploadedMetaData.fileKey=d,o._uploadedMetaData.fileType=Ms.BLOB,c.label=2;case 2:return[2]}})})}))]:[3,7];case 6:u.sent(),u.label=7;case 7:return[2]}})})},t}(Vt),Sl={},hu=function(n){function t(e){var r=n.call(this,e)||this;return Sl[e]=r,r}return w(t,n),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return k.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return k.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return Fs.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,r){return r===void 0&&(r=!1),Sl[e]&&!r||(Sl[e]=new t(e)),Sl[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return ne(!!e).throw(H.databaseError),e.collection(xf)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return D(D({},e.serialize()),{messageId:"".concat(e.messageId)})},t.prototype._deserialize=function(e){return e=D(D({},e),{messageId:parseInt(e.messageId)}),zt.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(r=i.sent())return[2,this._deserialize(r)];i.label=2;case 2:return[2,void 0]}})})},t.prototype.fetch=function(e){var r=e.channelUrl,i=e.token,a=e.limit,s=a===void 0?100:a,u=e.filter,o=u===void 0?new Xa:u,l=e.order,d=l===void 0?rr.CHANNEL_LATEST:l,c=e.backward,f=c!==void 0&&c,h=e.parentMessageId,m=e.isPollOnly,_=m!==void 0&&m,E=e.exactMatch,b=E!==void 0&&E,g=e.inclusive,C=g===void 0||g;return y(this,void 0,void 0,function(){var S,A,I,T=this;return v(this,function(M){switch(M.label){case 0:return this.localCacheEnabled?(S=zi(d),A={where:{channelUrl:r,"/where":function(O){if(i!=null&&i!=="")switch(d){case rr.CHANNEL_LATEST:if(b&&O.createdAt!==i)return!1;if(f){if(C&&O.createdAt<i||!C&&O.createdAt<=i)return!1}else if(C&&O.createdAt>i||!C&&O.createdAt>=i)return!1;break;case rr.NEWEST_CHILD_MESSAGE:if(!h||O.parentMessageId===0||O.parentMessageId!==h)return!1}return!(_&&!O._poll)&&o.match(T._deserialize(O))}},index:S,backward:f},[4,this.collection.query(A)]):[3,3];case 1:return[4,M.sent().fetch({limit:s??void 0})];case 2:return I=M.sent(),[2,Promise.all(I.map(function(O){return y(T,void 0,void 0,function(){return v(this,function(R){return[2,this._deserialize(O)]})})}))];case 3:return[2,[]]}})})},t.prototype.getAllChildMessages=function(e,r){return r===void 0&&(r=new Xa),y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return[4,this.fetch({channelUrl:e.channelUrl,token:Date.now(),limit:null,backward:!1,filter:r,order:rr.NEWEST_CHILD_MESSAGE,parentMessageId:e.messageId})];case 1:return[2,i.sent()]}})})},t.prototype.upsert=function(e){var r;return y(this,void 0,void 0,function(){var i,a,s,u,o,l,d,c,f=this;return v(this,function(h){switch(h.label){case 0:return this.localCacheEnabled?[4,this.saveBlobs(e)]:[3,13];case 1:h.sent(),h.label=2;case 2:h.trys.push([2,7,8,9]),i=oe(e),a=i.next(),h.label=3;case 3:return a.done?[3,6]:(s=a.value,!((r=s.threadInfo)===null||r===void 0)&&r._isUpdateRequired?[4,this.get(s.messageId)]:[3,5]);case 4:(u=h.sent())!=null&&u.threadInfo&&s.threadInfo._updateFrom(u.threadInfo),h.label=5;case 5:return a=i.next(),[3,3];case 6:return[3,9];case 7:return o=h.sent(),d={error:o},[3,9];case 8:try{a&&!a.done&&(c=i.return)&&c.call(i)}finally{if(d)throw d.error}return[7];case 9:return l=e.map(function(m){return f._serialize(m)}),[4,this.collection.upsertMany(l)];case 10:return h.sent(),[4,this.upsertChildMessages(e)];case 11:return h.sent(),[4,this._unsentMessageCache.upsertChildMessages(e)];case 12:h.sent(),h.label=13;case 13:return[2]}})})},t.prototype.upsertChildMessages=function(e){return y(this,void 0,void 0,function(){var r=this;return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map(function(a){return y(r,void 0,void 0,function(){var s,u;return v(this,function(o){switch(o.label){case 0:return s=[],!((u=a.threadInfo)===null||u===void 0)&&u.replyCount&&a.threadInfo.replyCount>0?[4,this.getAllChildMessages(a)]:[3,2];case 1:s=o.sent(),o.label=2;case 2:return s.length>0?(s.forEach(function(l){return l.applyParentMessage(a)}),[4,this.upsert(s)]):[3,4];case 3:o.sent(),o.label=4;case 4:return[2]}})})}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.remove=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:if(!this.localCacheEnabled)return[3,8];l.label=1;case 1:l.trys.push([1,6,7,8]),r=oe(e),i=r.next(),l.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove("".concat(a))]);case 3:l.sent(),l.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=l.sent(),u={error:s},[3,8];case 7:try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(u)throw u.error}return[7];case 8:return[2]}})})},t.prototype.removeMessagesOfChannel=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:zi(rr.CHANNEL_LATEST)})]:[3,6];case 1:return i.sent(),[4,(r=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:i.sent(),i.label=6;case 6:return[2]}})})},t.prototype.removeUnderOffset=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":r}},index:zi(rr.CHANNEL_LATEST)})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.countBetween=function(e,r,i){return y(this,void 0,void 0,function(){var a,s=this;return v(this,function(u){switch(u.label){case 0:return this.localCacheEnabled?(a=zi(rr.CHANNEL_LATEST),[4,this.collection.query({where:{channelUrl:e,"/where":function(o){var l=s._deserialize(o);return i.includes(l.createdAt)&&r.match(l)}},index:a}).count()]):[3,2];case 1:return[2,u.sent()];case 2:return[2,0]}})})},t.prototype.saveBlobs=function(e){return y(this,void 0,void 0,function(){var r=this;return v(this,function(i){switch(i.label){case 0:return[4,Promise.all(e.map(function(a){return y(r,void 0,void 0,function(){var s,u;return v(this,function(o){switch(o.label){case 0:return a instanceof Ft&&a.messageParams&&(s=a.messageParams).file&&Bl(s.file)?[4,this.collection.saveBlob(s.file,a.reqId)]:[3,2];case 1:u=o.sent(),s.fileKey=u,o.label=2;case 2:return[2]}})})}))];case 1:return i.sent(),[2]}})})},t.prototype._getGroupChannelPreferenceSize=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return r=0,[4,(i=this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 1:return a=l.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 2:return s=l.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 3:return u=l.sent(),[4,i.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 4:return o=l.sent(),a&&(r+=JSON.stringify(a).length),s&&(r+=JSON.stringify(s).length),u&&(r+=JSON.stringify(u).length),o&&(r+=JSON.stringify(o).length),[2,r]}})})},t}(Vt),Tl={},N2=function(n){function t(e){var r=n.call(this,e)||this;return Tl[e]=r,r}return w(t,n),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return k.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return k.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,r){return r===void 0&&(r=!1),Tl[e]&&!r||(Tl[e]=new t(e)),Tl[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return ne(!!e).throw(H.databaseError),e.collection(Fb)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return D({},e.serialize())},t.prototype._deserialize=function(e){return zt.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(r=i.sent())return[2,this._deserialize(r)];i.label=2;case 2:return[2,void 0]}})})},t.prototype.fetch=function(e){var r=e.channelUrl,i=e.token,a=e.limit,s=a===void 0?100:a,u=e.filter,o=u===void 0?new Xa:u,l=e.backward,d=l!==void 0&&l,c=e.exactMatch,f=c!==void 0&&c,h=e.inclusive,m=h===void 0||h;return y(this,void 0,void 0,function(){var _,E=this;return v(this,function(b){switch(b.label){case 0:return this.localCacheEnabled?(_={where:{channelUrl:r,"/where":function(g){if(i){if(f&&g.createdAt!==i)return!1;if(d){if(m&&g.createdAt<i||!m&&g.createdAt<=i)return!1}else if(m&&g.createdAt>i||!m&&g.createdAt>=i)return!1}return o.match(E._deserialize(g))}},index:["channelUrl","-createdAt","-notificationId"],backward:d},[4,this.collection.query(_)]):[3,3];case 1:return[4,b.sent().fetch({limit:s??void 0})];case 2:return[2,b.sent().map(function(g){return E._deserialize(g)})];case 3:return[2,[]]}})})},t.prototype.upsert=function(e){return y(this,void 0,void 0,function(){var r,i=this;return v(this,function(a){switch(a.label){case 0:return this.localCacheEnabled?(r=e.map(function(s){return i._serialize(s)}),[4,this.collection.upsertMany(r)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},t.prototype.remove=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:if(!this.localCacheEnabled)return[3,8];l.label=1;case 1:l.trys.push([1,6,7,8]),r=oe(e),i=r.next(),l.label=2;case 2:return i.done?[3,5]:(a=i.value,[4,this.collection.remove(a)]);case 3:l.sent(),l.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s=l.sent(),u={error:s},[3,8];case 7:try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(u)throw u.error}return[7];case 8:return[2]}})})},t.prototype.markAsReadByTimestamp=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,messageStatus:Ns.SENT,createdAt:{"<":r}}},{set:{messageStatus:Ns.READ}})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.markAsReadByMessageIds=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,notificationId:{"/in":r},messageStatus:Ns.SENT}},{set:{messageStatus:Ns.READ}})]:[3,2];case 1:return[2,i.sent().length];case 2:return[2,0]}})})},t.prototype.removeMessagesOfChannel=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:["channelUrl","-createdAt","-notificationId"]})]:[3,6];case 1:return i.sent(),[4,(r=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return i.sent(),[4,r.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:i.sent(),i.label=6;case 6:return[2]}})})},t.prototype.removeUnderOffset=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":r}},index:zi(rr.CHANNEL_LATEST)})]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.countBetween=function(e,r,i){return y(this,void 0,void 0,function(){var a,s=this;return v(this,function(u){switch(u.label){case 0:return this.localCacheEnabled?(a=["channelUrl","-createdAt","-notificationId"],[4,this.collection.query({where:{channelUrl:e,"/where":function(o){var l=s._deserialize(o);return i.includes(l.createdAt)&&r.match(l)}},index:a}).count()]):[3,2];case 1:return[2,u.sent()];case 2:return[2,0]}})})},t}(Vt),Pu={},Gb=function(n){function t(e){var r=n.call(this,e)||this;return r._observers=new Map,r._dispatcherContext=r._dispatcher.on(function(i){return y(r,void 0,void 0,function(){var a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M=this;return v(this,function(O){switch(O.label){case 0:return i instanceof mt?(a=i.messages,T=i.source,d=i.isWebSocketEventComing,s=a.filter(function(R){return R instanceof mr&&R.channelType!==wn.OPEN&&R.messageId>0}),u=a.filter(function(R){return R instanceof mr&&R.channelType!==wn.OPEN&&R.messageId===0}),o=a.filter(function(R){return R instanceof xs}),s.length>0?[4,Lt(function(){return y(M,void 0,void 0,function(){return v(this,function(R){switch(R.label){case 0:return[4,this._messageCache.upsert(s)];case 1:return R.sent(),[4,this._unsentMessageCache.remove(s.map(function(U){return U instanceof Dt?U.reqId:null}).filter(function(U){return U!==null}))];case 2:return R.sent(),[2]}})})})]:[3,2]):[3,7];case 1:O.sent(),d||this._broadcastUpdateEvent(s,T),O.label=2;case 2:return u.length>0?[4,Lt(function(){return y(M,void 0,void 0,function(){return v(this,function(R){switch(R.label){case 0:return[4,this._unsentMessageCache.upsert(u)];case 1:return R.sent(),[2]}})})})]:[3,4];case 3:O.sent(),d||this._broadcastUpdateEvent(u,T),O.label=4;case 4:return o.length>0?[4,Lt(function(){return y(M,void 0,void 0,function(){return v(this,function(R){switch(R.label){case 0:return[4,this._notificationCache.upsert(o)];case 1:return R.sent(),[2]}})})})]:[3,6];case 5:O.sent(),d||this._broadcastUpdateEvent(o,T),O.label=6;case 6:return[3,24];case 7:return i instanceof wp?(l=i.messageIds,T=i.source,d=i.isWebSocketEventComing,c=l.filter(function(R){return typeof R=="number"}),f=l.filter(function(R){return typeof R=="string"}),[4,Lt(function(){return y(M,void 0,void 0,function(){return v(this,function(R){switch(R.label){case 0:return c.length>0?[4,this._messageCache.remove(c)]:[3,2];case 1:R.sent(),R.label=2;case 2:return f.length>0?[4,this._notificationCache.remove(f)]:[3,4];case 3:R.sent(),R.label=4;case 4:return[2]}})})})]):[3,9];case 8:return O.sent(),d||this._broadcastRemoveEvent(l,T),[3,24];case 9:return i instanceof sb?(h=i.reqId,T=i.source,[4,Lt(function(){return y(M,void 0,void 0,function(){return v(this,function(R){switch(R.label){case 0:return[4,this._unsentMessageCache.remove([h])];case 1:return R.sent(),[2]}})})})]):[3,11];case 10:return O.sent(),this._broadcastRemoveUnsentEvent(h,T),[3,24];case 11:return i instanceof ub?(m=i.polls,T=i.source,this._cacheContext.localCacheEnabled?(_=m.map(function(R){return R.messageId}),[4,Promise.all(_.map(function(R){return M._messageCache.get(R)}))]):[3,14]):[3,15];case 12:return(E=O.sent().filter(function(R){return R})).length>0&&m.forEach(function(R){var U=E.find(function(P){return P.messageId===R.messageId});U&&U.applyPoll(R)}),[4,Lt(function(){return y(M,void 0,void 0,function(){return v(this,function(R){switch(R.label){case 0:return[4,this._messageCache.upsert(E)];case 1:return[2,R.sent()]}})})})];case 13:O.sent(),O.label=14;case 14:return this._broadcastPollChangeLogEvent(m,T),[3,24];case 15:return i instanceof Op?(b=i.event,T=i.source,[4,this._messageCache.get(b.messageId)]):[3,19];case 16:return(g=O.sent())&&g.isUserMessage()&&g.poll&&g.poll.applyPollUpdateEvent(b)?[4,Lt(function(){return y(M,void 0,void 0,function(){return v(this,function(R){switch(R.label){case 0:return[4,this._messageCache.upsert([g])];case 1:return[2,R.sent()]}})})})]:[3,18];case 17:O.sent(),O.label=18;case 18:return this._broadcastPollUpdateEvent(b,T),[3,24];case 19:return i instanceof $d?(C=i.event,T=i.source,[4,this._messageCache.get(C.messageId)]):[3,23];case 20:return(S=O.sent())&&S.isUserMessage()&&S.poll&&S.poll.applyPollVoteEvent(C)?[4,Lt(function(){return y(M,void 0,void 0,function(){return v(this,function(R){switch(R.label){case 0:return[4,this._messageCache.upsert([S])];case 1:return[2,R.sent()]}})})})]:[3,22];case 21:O.sent(),O.label=22;case 22:return this._broadcastPollVoteEvent(C,T),[3,24];case 23:i instanceof ib?(A=i.event,T=i.source,A.messageId>0&&this._broadcastReactionUpdateEvent(A,T)):i instanceof ab&&(I=i.event,T=i.source,this._broadcastThreadUpdateEvent(I,T)),O.label=24;case 24:return[2]}})})}),r}return w(t,n),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return k.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dispatcher",{get:function(){return k.of(this._iid).dispatcher},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return hu.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return Fs.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_notificationCache",{get:function(){return N2.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,r){var i;return r===void 0&&(r=!1),Pu[e]&&!r||(Pu[e]&&((i=Pu[e]._dispatcherContext)===null||i===void 0||i.close()),Pu[e]=new t(e)),Pu[e]},t.prototype._broadcastUpdateEvent=function(e,r){var i,a;try{for(var s=oe(this._observers.values()),u=s.next();!u.done;u=s.next()){var o=u.value;o.onUpdate&&o.onUpdate(e,r)}}catch(l){i={error:l}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastPollChangeLogEvent=function(e,r){var i,a;try{for(var s=oe(this._observers.values()),u=s.next();!u.done;u=s.next()){var o=u.value;o.onPollChangeLogUpdate&&o.onPollChangeLogUpdate(e,r)}}catch(l){i={error:l}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastPollUpdateEvent=function(e,r){var i,a;try{for(var s=oe(this._observers.values()),u=s.next();!u.done;u=s.next()){var o=u.value;o.onPollUpdate&&o.onPollUpdate(e,r)}}catch(l){i={error:l}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastPollVoteEvent=function(e,r){var i,a;try{for(var s=oe(this._observers.values()),u=s.next();!u.done;u=s.next()){var o=u.value;o.onPollVote&&o.onPollVote(e,r)}}catch(l){i={error:l}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastRemoveEvent=function(e,r){var i,a;try{for(var s=oe(this._observers.values()),u=s.next();!u.done;u=s.next()){var o=u.value;o.onRemove&&o.onRemove(e,r)}}catch(l){i={error:l}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastRemoveUnsentEvent=function(e,r){var i,a;try{for(var s=oe(this._observers.values()),u=s.next();!u.done;u=s.next()){var o=u.value;o.onRemoveUnsent&&o.onRemoveUnsent(e,r)}}catch(l){i={error:l}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastReactionUpdateEvent=function(e,r){var i,a;try{for(var s=oe(this._observers.values()),u=s.next();!u.done;u=s.next()){var o=u.value;o.onReactionUpdate&&o.onReactionUpdate(e,r)}}catch(l){i={error:l}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype._broadcastThreadUpdateEvent=function(e,r){var i,a;try{for(var s=oe(this._observers.values()),u=s.next();!u.done;u=s.next()){var o=u.value;o.onThreadInfoUpdate&&o.onThreadInfoUpdate(e,r)}}catch(l){i={error:l}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype.subscribe=function(e,r){this._observers.set(e,r)},t.prototype.unsubscribe=function(e){this._observers.delete(e)},t.prototype.unsubscribeAll=function(){this._observers.clear()},t}(Vt),I2=function(n){function t(e){var r=this,i=e.reverse,a=i!==void 0&&i,s=e.limit,u=s===void 0?20:s,o=e.keys,l=e.token;return(r=n.call(this)||this).method=J.GET,r.path="".concat(by),r.params=ge({token:l,limit:u,reverse:a,order:yf.UPDATED_AT,show_ui_template:!0,show_color_variables:!0,keys:o}),r}return w(t,n),t}(ee),A2=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.next,s=r.has_more,u=s!==void 0&&s,o=r.templates;return i.nextToken=a,i.hasMore=u,i.templates=o.map(function(l){return{template:JSON.stringify(l)}}),i}return w(t,n),t}(ie),M2=function(n){function t(e){var r=this,i=e.key;return(r=n.call(this)||this).method=J.GET,r.path="".concat(by,"/").concat(i),r}return w(t,n),t}(ee),w2=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.template=JSON.stringify(r),i}return w(t,n),t}(ie),Q_={},zt=function(){function n(t,e){var r=e.sdkState,i=e.dispatcher,a=e.requestQueue,s=e.onlineDetector,u=e.cacheContext;this._iid=t,this._sdkState=r,this._requestQueue=a,this._dispatcher=i,this._cacheContext=u,hu.of(t),Fs.of(t),Gb.of(t),this.fileMessageQueue=new NN(t,{sdkState:r,dispatcher:i,requestQueue:a,onlineDetector:s,cacheContext:u}),Q_[t]=this}return n.of=function(t){return Q_[t]},n.prototype.buildMessageFromSerializedData=function(t){var e=$a(t);if(e.notificationId)return new xs(this._iid,xs.payloadify(e));switch(e.messageType){case At.USER:return new sr(this._iid,sr.payloadify(e));case At.FILE:return oi._isMultipleFilesMessageSerializedData(e)?new oi(this._iid,oi.payloadify(e)):new Ft(this._iid,Ft.payloadify(e));case At.ADMIN:return new ks(this._iid,ks.payloadify(e))}throw H.invalidParameters},n.prototype.buildUserMessageCreateParamsFromSerializedData=function(t,e){return ge(Re({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUserIds:e.mentionedUserIds,mentionedUsers:e.mentionedUsers,mentionedMessageTemplate:e.mentionedMessageTemplate,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,isReplyToChannel:t.isReplyToChannel,pushNotificationDeliveryOption:t.pushNotificationDeliveryOption,appleCriticalAlertOptions:e.appleCriticalAlertOptions,reqId:e.reqId,message:e.message,translationTargetLanguages:Object.keys(e.translations),pollId:t.pollId}))},n.prototype.buildFileMessageCreateParamsFromSerializedData=function(t,e){var r;return ge(Re({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUserIds:e.mentionedUserIds,mentionedUsers:e.mentionedUsers,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,isReplyToChannel:t.isReplyToChannel,pushNotificationDeliveryOption:t.pushNotificationDeliveryOption,appleCriticalAlertOptions:e.appleCriticalAlertOptions,reqId:e.reqId,file:t.file,fileKey:t.fileKey,fileUrl:e.plainUrl,fileName:e.name,fileSize:e.size,mimeType:e.type,thumbnailSizes:(r=e.thumbnails)===null||r===void 0?void 0:r.map(function(i){return{maxWidth:i.width,maxHeight:i.height}}),fileType:t.fileType,requireAuth:e.requireAuth}))},n.prototype.buildMultipleFilesMessageCreateParamsFromSerializedData=function(t,e){var r=this;return ge({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUserIds:e.mentionedUserIds,mentionedUsers:e.mentionedUsers,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,isReplyToChannel:t.isReplyToChannel,pushNotificationDeliveryOption:t.pushNotificationDeliveryOption,appleCriticalAlertOptions:e.appleCriticalAlertOptions,reqId:e.reqId,fileInfoList:t.fileInfoList.map(function(i){return new md(r._iid,i)})})},n.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(t,e){return D(D({},this.buildUserMessageCreateParamsFromSerializedData(t,e)),{scheduledAt:t.scheduledAt})},n.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(t,e){return D(D({},this.buildFileMessageCreateParamsFromSerializedData(t,e)),{scheduledAt:t.scheduledAt})},n.prototype.buildSenderFromSerializedData=function(t){var e=$a(t);return new yu(this._iid,yu.payloadify(e))},n.prototype.getMessage=function(t){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=new IN(t),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(AN).message]}})})},n.prototype.getScheduledMessage=function(t){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=new ON(t),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,r.as(RN).message]}})})},n.prototype.getMessagesByMessageId=function(t,e,r,i,a){return a===void 0&&(a=W.REQUEST_MESSAGE),y(this,void 0,void 0,function(){var s,u,o;return v(this,function(l){switch(l.label){case 0:return s=new _l(D(D({channelType:e,channelUrl:t,token:String(r)},vo),i)),[4,this._requestQueue.send(s)];case 1:return u=l.sent(),o=u.as(gl).messages,this._dispatcher.dispatch(new mt({messages:o,source:a})),[2,o]}})})},n.prototype.getMessagesByTimestamp=function(t,e,r,i,a){return a===void 0&&(a=W.REQUEST_MESSAGE),y(this,void 0,void 0,function(){var s,u,o;return v(this,function(l){switch(l.label){case 0:return s=new _l(D(D({channelType:e,channelUrl:t,timestamp:r},vo),i)),[4,this._requestQueue.send(s)];case 1:return u=l.sent(),o=u.as(gl).messages,this._dispatcher.dispatch(new mt({messages:o,source:a})),[2,o]}})})},n.prototype._getMessagesByTimestampForCollection=function(t,e,r,i,a,s,u){return a===void 0&&(a=W.REQUEST_MESSAGE),y(this,void 0,void 0,function(){var o,l,d,c,f,h;return v(this,function(m){switch(m.label){case 0:return o=new _l(D(D(D({channelType:e,channelUrl:t,timestamp:r},vo),i),{checkingHasNext:s,checkingContinuousMessages:u})),[4,this._requestQueue.send(o)];case 1:return l=m.sent(),d=l.as(gl),c=d.messages,f=d.isContinuousMessages,h=d.hasNext,this._dispatcher.dispatch(new mt({messages:c,source:a})),[2,{messages:c,isContinuousMessages:f,hasNext:h}]}})})},n.prototype.getThreadedMessagesByTimestamp=function(t,e,r,i){return i===void 0&&(i=W.REQUEST_THREADED_MESSAGE),y(this,void 0,void 0,function(){var a,s,u,o;return v(this,function(l){switch(l.label){case 0:return a=new _l(D(D(D({channelUrl:t.channelUrl,channelType:t.channelType,timestamp:e},Ko),r),{replyType:Kt.ALL,parentMessageId:t.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(a)];case 1:return s=l.sent(),u=s.as(gl).messages,(o=u.slice(1)).forEach(function(d){d.parentMessage=t}),this._dispatcher.dispatch(new mt({messages:o,source:i})),[2,{parentMessage:u[0],threadedMessages:o}]}})})},n.prototype.getMessageTemplatesByToken=function(t,e){return e===void 0&&(e={}),y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return r=new I2(D({token:t},e)),[4,this._requestQueue.send(r)];case 1:return i=l.sent(),a=i.as(A2),s=a.hasMore,u=a.nextToken,o=a.templates,[2,{hasMore:s,token:u,templates:o}]}})})},n.prototype.getMessageTemplate=function(t){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=new M2({key:t}),[4,this._requestQueue.send(e)];case 1:return r=i.sent(),[2,{template:r.as(w2).template}]}})})},n.prototype.getMessageChangelogs=function(t,e,r,i,a){return a===void 0&&(a=W.REQUEST_MESSAGE_CHANGELOGS),y(this,void 0,void 0,function(){var s,u,o,l,d,c,f,h,m;return v(this,function(_){switch(_.label){case 0:return s=new MN(ge(Re(D(D({channelType:e,channelUrl:t,timestamp:typeof r=="number"?r:null,token:typeof r=="string"?r:null},Lf),i)))),[4,this._requestQueue.send(s)];case 1:return u=_.sent(),o=u.as(wN),l=o.updatedMessages,d=o.deletedMessagesInfo,c=o.hasMore,f=o.nextToken,h=o.forceUseNextToken,m=d.map(function(E){return E.messageId}),l.length>0&&this._dispatcher.dispatch(new mt({messages:l,source:a})),m.length>0&&this._dispatcher.dispatch(new wp({messageIds:m,source:a})),[2,{updatedMessages:l,deletedMessageIds:m,hasMore:c,token:f,forceUseNextToken:h}]}})})},n}(),Vb=function(n){function t(e,r){var i=n.call(this,e)||this;i.targetMessageId=0;var a=r.thread_info,s=r.parent_message_id,u=r.channel_url,o=r.channel_type;return a&&x("object",a)&&x("number",s)&&x("string",u)&&x("string",o)&&(i.threadInfo=new pd(e,a),i.targetMessageId=s,i.channelUrl=u,i.channelType=o),i}return w(t,n),t}(Vt),O2={channelUrl:"",channelType:wn.BASE,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},R2=function(n){function t(e){var r=e.channelCustomType,i=e.keyword,a=e.limit,s=e.reverse,u=e.exactMatch,o=e.channelUrl,l=e.order,d=e.messageTimestampFrom,c=e.messageTimestampTo,f=e.advancedQuery,h=e.targetFields,m=e.nextToken,_=n.call(this)||this;return _.method=J.GET,_.path="".concat(oT,"/messages"),_.params={custom_type:r,query:i,limit:a,reverse:s,exact_match:u,channel_url:o,message_ts_from:d,message_ts_to:c,sort_field:l,advanced_query:f,target_fields:h,after:m},_}return w(t,n),t}(ee),D2=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.messages=r.results.map(function(a){return dr(e,a)}),i.hasNext=r.has_next,i.nextToken=r.end_cursor,i.totalCount=r.total_count,i}return w(t,n),t}(ie);(function(n){n.SCORE="score",n.TIMESTAMP="ts"})(Co||(Co={}));var L2=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h=this;return(h=n.call(this,e,r)||this).keyword="",h.reverse=!1,h.exactMatch=!1,h.channelUrl="",h.channelCustomType="",h.messageTimestampFrom=null,h.messageTimestampTo=null,h.order=Co.SCORE,h.advancedQuery=!1,h.targetFields=null,h._nextToken="",h.totalCount=-1,h.keyword=r.keyword,h.reverse=(i=r.reverse)!==null&&i!==void 0&&i,h.exactMatch=(a=r.exactMatch)!==null&&a!==void 0&&a,h.channelUrl=(s=r.channelUrl)!==null&&s!==void 0?s:"",h.channelCustomType=(u=r.channelCustomType)!==null&&u!==void 0?u:"",h.messageTimestampFrom=(o=r.messageTimestampFrom)!==null&&o!==void 0?o:null,h.messageTimestampTo=(l=r.messageTimestampTo)!==null&&l!==void 0?l:null,h.order=(d=r.order)!==null&&d!==void 0?d:Co.SCORE,h.advancedQuery=(c=r.advancedQuery)!==null&&c!==void 0&&c,h.targetFields=(f=r.targetFields)!==null&&f!==void 0?f:null,h}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("string",this.keyword)&&this.keyword.length>0&&x("boolean",this.reverse)&&x("boolean",this.exactMatch)&&x("string",this.channelUrl)&&x("string",this.channelCustomType)&&(x("number",this.messageTimestampFrom)||this.messageTimestampFrom===null)&&(x("number",this.messageTimestampTo)||this.messageTimestampTo===null)&&_n(Co,this.order)&&x("boolean",this.advancedQuery)&&gn("string",this.targetFields,!0)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new R2(Re(D(D({},this),{nextToken:this._nextToken?this._nextToken:null}))),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=d.sent(),a=i.as(D2),s=a.messages,u=a.hasNext,o=a.nextToken,l=a.totalCount,this._nextToken=o,this._hasNext=u,this._isLoading=!1,this.totalCount=l,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(Sa),U2=function(n){function t(e){var r=e.channelType,i=e.channelUrl,a=e.limit,s=e.token,u=n.call(this)||this;return u.method=J.GET,u.path="".concat(jn(r),"/").concat(encodeURIComponent(i),"/messages/parent_thread_message"),u.params=ge(Re({limit:a,token:s})),u}return w(t,n),t}(ee),k2=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.next,i.messages=r.messages.map(function(a){return dr(e,a)}),i}return w(t,n),t}(ie),x2=function(n){function t(e,r,i,a){var s=n.call(this,e,r,i,a)||this;return s._edge="",s}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.load=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new U2({channelType:this.channelType,channelUrl:this.channelUrl,token:this._edge,limit:this.limit}),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(k2),s=a.messages,u=a.token,this._edge=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),P2={channelUrl:"",scheduledMessageId:0},F2={reverse:!1,limit:20},H2=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.name="message",e}return w(t,n),t.prototype.init=function(e,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,u=r.requestQueue,o=r.logger,l=r.onlineDetector,d=r.cacheContext;n.prototype.init.call(this,e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:o,onlineDetector:l,cacheContext:d}),this._manager=new zt(e,{sdkState:i,dispatcher:a,requestQueue:u,onlineDetector:l,cacheContext:d})},t.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e)},t.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e)},t.prototype.getMessage=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return r=D(D({},O2),e),ne(function(s){return x("string",s.channelUrl)&&_n(wn,s.channelType)&&x("number",s.messageId)&&x("boolean",s.includeReactions,!0)&&x("boolean",s.includeMetaArray,!0)&&x("boolean",s.includeParentMessageInfo,!0)&&x("boolean",s.includeThreadInfo,!0)}(r)).throw(H.invalidParameters),[4,this._manager.getMessage(r)];case 1:if((i=a.sent())instanceof mr||i instanceof xs||i===null)return[2,i];throw"Unknown message type is given."}})})},t.prototype.getScheduledMessage=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){return r=D(D({},P2),e),ne(function(a){return x("string",a.channelUrl)&&a.channelUrl!==""&&x("number",a.scheduledMessageId)&&a.scheduledMessageId>0}(r)).throw(H.invalidParameters),[2,this._manager.getScheduledMessage(r)]})})},t.prototype.getMessageTemplatesByToken=function(e,r){return r===void 0&&(r={}),y(this,void 0,void 0,function(){var i;return v(this,function(a){return i=D(D({},F2),r),ne(x("string",e,!0)&&function(s){return x("boolean",s.reverse,!0)&&x("number",s.limit,!0)&&gn("string",s.keys,!0)}(i)).throw(H.invalidParameters),[2,this._manager.getMessageTemplatesByToken(e,i)]})})},t.prototype.getMessageTemplate=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return ne(x("string",e)).throw(H.invalidParameters),[2,this._manager.getMessageTemplate(e)]})})},t}(Kd),B2=function(n,t){this.pollId=0,this.messageId=0,this.pollId=t.poll.id,this.messageId=t.poll.message_id,this._iid=n,this._payload=t},G2=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.name="poll",e}return w(t,n),t.prototype.init=function(e,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,u=r.requestQueue,o=r.logger,l=r.onlineDetector,d=r.cacheContext;n.prototype.init.call(this,e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:o,onlineDetector:l,cacheContext:d}),this._manager=new cd(e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:o,onlineDetector:l,cacheContext:d})},t.prototype.create=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){return r=D(D({},sN),e),ne(db(r)).throw(H.invalidParameters),[2,this._manager.create(r)]})})},t.prototype.get=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){return r=D(D({},oN),e),ne(fb(r)).throw(H.invalidParameters),[2,this._manager.get(r)]})})},t.prototype.getOption=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){return r=D(D({},uN),e),ne(cb(r)).throw(H.invalidParameters),[2,this._manager.getOption(r)]})})},t.prototype.buildPollFromSerializedData=function(e){return this._manager.buildPollFromSerializedData(e)},t}(Kd),Et,So,Hf;(function(n){n.LATEST_LAST_MESSAGE="latest_last_message",n.CHRONOLOGICAL="chronological",n.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",n.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"})(Et||(Et={})),function(n){n.CHRONOLOGICAL="chronological",n.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",n.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"}(So||(So={})),function(n){n.CREATED_AT="created_at",n.SCHEDULED_AT="scheduled_at"}(Hf||(Hf={}));var Uo,jl=function(n){switch(n){case Et.LATEST_LAST_MESSAGE:return["-lastMessageUpdatedAt","-createdAt","syncIndex"];case Et.CHRONOLOGICAL:return["-createdAt","syncIndex"];case Et.CHANNEL_NAME_ALPHABETICAL:return["name"];default:return["-lastMessageUpdatedAt","-createdAt","syncIndex"]}},jb=function(n){function t(e){var r=e.message,i=n.call(this)||this;return i.message=r,i}return w(t,n),t}(bt),X_={},ro=function(){function n(t,e){var r=e.localCacheEnabled,i=e.enableAutoResend,a=e.dispatcher,s=e.sdkState,u=e.logger,o=this;this._iid=t,X_[t]=this,this._localCacheEnabled=r,this._enableAutoResend=i,this._isProcessingAutoResend=!1,this._autoResendQueue=[],this._dispatcher=a,this._logger=u,this._sdkState=s,this._localCacheEnabled&&a.on(function(l){if(l instanceof Kr)switch(l.stateType){case Wn.CONNECTED:o._isProcessingAutoResend||o.processAutoResendRegisteredPendingMessages().then(function(){return o._processNextAutoResend()});break;case Wn.INTERNAL_DISCONNECTED:case Wn.EXTERNAL_DISCONNECTED:o._isProcessingAutoResend=!1}})}return n.of=function(t){return X_[t]},n.prototype.processNonAutoResendRegisteredPendingMessages=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return this._enableAutoResend?[4,this._fetchAllCachedPendingMessages()]:[2];case 1:t=u.sent();try{for(e=oe(t),r=e.next();!r.done;r=e.next())(i=r.value).errorCode===0&&(this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ",i.reqId),i.sendingStatus=Qn.FAILED,i.errorCode=Ne.ACK_TIMEOUT,this._dispatcher.dispatch(new mt({messages:[i],source:W.LOCAL_MESSAGE_FAILED})))}catch(o){a={error:o}}finally{try{r&&!r.done&&(s=e.return)&&s.call(e)}finally{if(a)throw a.error}}return[2]}})})},n.prototype.processAutoResendRegisteredPendingMessages=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:t=l.sent();try{for(e=oe(t),r=e.next();!r.done;r=e.next())i=r.value,this._enableAutoResend&&i.errorCode&&nd(i.errorCode)&&(a=new Date().getTime(),s=i.createdAt+2592e5,this._enableAutoResend&&a<=s?this._autoResendQueue.map(function(d){return d.reqId}).indexOf(i.reqId)<0&&this._autoResendQueue.push(i):(this._logger.debug("auto-resend registered pending messaged expired. expiration date: ",new Date(s).toLocaleString()),i.sendingStatus=Qn.FAILED,this._dispatcher.dispatch(new mt({messages:[i],source:W.LOCAL_MESSAGE_FAILED}))))}catch(d){u={error:d}}finally{try{r&&!r.done&&(o=e.return)&&o.call(e)}finally{if(u)throw u.error}}return[2]}})})},n.prototype.completeCurrentAndProcessNextAutoResend=function(t){if(this._localCacheEnabled&&this._enableAutoResend&&(t.sendingStatus===Qn.SUCCEEDED||t.sendingStatus===Qn.FAILED&&!nd(t.errorCode))){var e=this.indexOf(t);e>=0&&this._autoResendQueue.splice(e,1),e===0&&this._processNextAutoResend()}},n.prototype._fetchAllCachedPendingMessages=function(){return y(this,void 0,void 0,function(){var t,e;return v(this,function(r){switch(r.label){case 0:return t=Fs.of(this._iid),(e=new Xa).replyType=Kt.ALL,[4,t.fetch({sendingStatus:Qn.PENDING,backward:!0,filter:e})];case 1:return[2,r.sent()]}})})},n.prototype.indexOf=function(t){return this._autoResendQueue.length>0?this._autoResendQueue.map(function(e){return e.reqId}).indexOf(t.reqId):-1},n.prototype._isNotInQueue=function(t){return this._autoResendQueue.map(function(e){return e.reqId}).indexOf(t.reqId)===-1},n.prototype._processNextAutoResend=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){if(this._localCacheEnabled&&this._enableAutoResend&&this._sdkState.appState==="foreground")try{this._autoResendQueue.length>0?(this._isProcessingAutoResend||(this._logger.debug("auto-resend queue started."),this._isProcessingAutoResend=!0),t=this._autoResendQueue[0],this._dispatcher.dispatch(new jb({message:t})),this._logger.debug("processing auto-resend for message request id: ",t.reqId)):(this._logger.debug("auto-resend queue finished."),this._isProcessingAutoResend=!1)}catch(r){this._logger.warn("process auto-resend error: ",r),this._isProcessingAutoResend=!1}return[2]})})},n}();(function(n){n[n.USER_BLOCK=20001]="USER_BLOCK",n[n.USER_UNBLOCK=2e4]="USER_UNBLOCK",n[n.FRIEND_DISCOVERED=20900]="FRIEND_DISCOVERED"})(Uo||(Uo={}));var yd=function(){function n(t){this.category=t.cat,this.data=t.data}return n.getDataAsUserBlockEvent=function(t,e){var r=e.data,i=r.blocker,a=r.blockee;return{blocker:new Mn(t,i),blockee:new Mn(t,a)}},n.getDataAsFriendDiscoveredEvent=function(t,e){var r=e.data.friend_discoveries;return{friendDiscoveries:Array.isArray(r)?r.map(function(i){return new Mn(t,i)}):[]}},n}(),qb=function(n){function t(e,r){var i=r.userId,a=n.call(this)||this;return a._iid=e,a.userId=i,a}return w(t,n),t}(bt),zb=function(n){function t(){return n.call(this)||this}return w(t,n),t}(bt),Kb=function(n){function t(e,r,i){var a=n.call(this,e,"USEV",i)||this;return a.event=new yd(i),a}return w(t,n),t}(ft),V2=function(n){return["-lastMessageUpdatedAt","-createdAt","syncIndex"]},Z_=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return w(t,n),t}(bt),$b=function(n){this.key=n.key,this.url=n.url},Wb=function(n){this.id=n.id,this.name=n.name,this.url=n.url,this.emojis=n.emojis?n.emojis.map(function(t){return new $b(t)}):[]},Yb=function(n){this.emojiHash=n.emoji_hash||"",this.emojiCategories=n.emoji_categories?n.emoji_categories.map(function(t){return new Wb(t)}):[]},j2={profileImage:void 0,profileUrl:void 0,nickname:void 0},J_=function(n){return function(t,e){return y(void 0,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:switch(t){case 1:case 2:case 3:case 4:return[3,1];case 5:return[3,2];case 6:return[3,4]}return[3,11];case 1:return e(),[3,12];case 2:return[4,n.reset()];case 3:return u.sent(),e(),[3,12];case 4:return u.trys.push([4,9,,10]),r=function(o){return{v2:function(){return y(void 0,void 0,void 0,function(){return v(this,function(l){switch(l.label){case 0:return[4,o.commitSchema([{collectionName:xb,keyName:UI,index:[jl(Et.LATEST_LAST_MESSAGE),jl(Et.CHRONOLOGICAL),jl(Et.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:xf,keyName:kI,index:[zi(rr.CHANNEL_LATEST),zi(rr.NEWEST_CHILD_MESSAGE)]},{collectionName:Bb,keyName:T2,index:[zi(rr.CHANNEL_LATEST),zi(rr.NEWEST_CHILD_MESSAGE)]},{collectionName:PI,keyName:FI}])];case 1:return[2,l.sent()]}})})},v3:function(){return y(void 0,void 0,void 0,function(){return v(this,function(l){switch(l.label){case 0:return[4,o.commitSchema([{collectionName:HI,keyName:BI,index:[V2()]}])];case 1:return[2,l.sent()]}})})},v4:function(){return y(void 0,void 0,void 0,function(){return v(this,function(l){switch(l.label){case 0:return[4,o.commitSchema([{collectionName:Fb,keyName:xI,index:[v2()]}])];case 1:return[2,l.sent()]}})})}}}(n),i=r.v2,a=r.v3,s=r.v4,[4,i()];case 5:return u.sent(),[4,a()];case 6:return u.sent(),[4,s()];case 7:return u.sent(),[4,n.collection(xf).removeIf({where:{channelType:wn.OPEN}})];case 8:case 9:return u.sent(),[3,10];case 10:return e(),[3,12];case 11:e(),u.label=12;case 12:return[2]}})})}},q2=function(){return typeof document<"u"?document.visibilityState:"visible"},z2=function(n){function t(e){var r=e.getVisibilityState,i=r===void 0?q2:r,a=e.initialState,s=a===void 0?"visible":a,u=e.isEnabled,o=u===void 0||u,l=e.pauseCheckDelay,d=l===void 0?3e4:l,c=n.call(this)||this;return c._pauseCheckDelay=3e4,c._currentState="visible",c._getVisibilityState=i,c._pauseCheckDelay=d,c._currentState=s,c._isEnabled=o,c._boundToggleState=c._toggleState.bind(c),c}return w(t,n),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAvailable",{get:function(){return typeof window<"u"&&!!window.addEventListener&&!!window.removeEventListener},enumerable:!1,configurable:!0}),t.prototype._toggleState=function(){var e=this,r=this._getVisibilityState();r!=="hidden"?this._currentState==="hidden"&&(this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=void 0),this.dispatch("resume")):this._currentState!=="hidden"&&(this._pauseDelayTimer=setTimeout(function(){e._pauseDelayTimer=void 0,e.dispatch("pause")},this._pauseCheckDelay)),this._currentState=r},t.prototype.start=function(){this._isEnabled&&this.isAvailable&&(this._boundToggleState=this._toggleState.bind(this),window.addEventListener("visibilitychange",this._boundToggleState,{capture:!0}))},t.prototype.stop=function(){this._isEnabled&&this.isAvailable&&this._boundToggleState&&window.removeEventListener("visibilitychange",this._boundToggleState,{capture:!0})},t}(Bs),K2=function(){function n(t){var e=t.logger,r=t.connectionDelegate,i=r===void 0?null:r,a=this;this._onlineWorker=function(){var s;return(s=a.connectionDelegate)===null||s===void 0?void 0:s.reconnect()},this._offlineWorker=function(){var s;return(s=a.connectionDelegate)===null||s===void 0?void 0:s.disconnect()},this.unsubscribes=[],this._onlineListener=function(s){if(a.isAvailableOnWeb)return window.addEventListener("online",s),function(){return window.removeEventListener("online",s,!1)}},this._offlineListener=function(s){if(a.isAvailableOnWeb)return window.addEventListener("offline",s),function(){return window.removeEventListener("offline",s,!1)}},this.logger=e,i&&(this.connectionDelegate=i)}return Object.defineProperty(n.prototype,"isAvailableOnWeb",{get:function(){return typeof window<"u"&&!!window.addEventListener&&"ononline"in window&&"onoffline"in window&&typeof navigator<"u"&&navigator.onLine!==void 0},enumerable:!1,configurable:!0}),n.prototype.setOnlineListener=function(t){t&&typeof t=="function"&&(this._onlineListener=t)},n.prototype.setOfflineListener=function(t){t&&typeof t=="function"&&(this._offlineListener=t)},n.prototype.start=function(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)]},n.prototype.stop=function(){var t=this;this.unsubscribes.forEach(function(e){try{e==null||e()}catch(r){t.logger.warn(r.message)}}),this.unsubscribes=[]},n.prototype.isOnline=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.isAvailableOnWeb?[2,navigator.onLine]:[2,new Promise(function(e){fetch("https://www.google.com",{method:J.GET,mode:"no-cors"}).then(function(){return e(!0)}).catch(function(){return e(!1)})})]})})},n}(),eg=function(n){function t(e){var r=e.userId,i=e.nickname,a=e.profileUrl,s=e.profileImage,u=e.preferredLanguages,o=n.call(this)||this;return o.method=J.PUT,o.path="".concat(qn,"/").concat(encodeURIComponent(r)),o.params=ge(Re({nickname:i,profile_url:a,profile_file:s,preferred_languages:u})),o}return w(t,n),t}(ee),ng=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.user=new Mn(e,D({},r)),i}return w(t,n),t}(ie),$2=function(n){function t(e){var r=e.userId,i=e.token,a=e.deviceOS,s=e.deviceManufacturer,u=e.systemPushEnabled,o=n.call(this)||this;return o.method=J.POST,o.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/apns"),o.params=ge({apns_device_token:i,always_push:!0,device_os:a,device_manufacturer:s,system_push_enabled:u}),o}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.token,i.type=r.type?Qt[r.type.toLowerCase()]:Qt.UNKNOWN,i.user=new Mn(e,r.user),i}w(t,n)})(ie);var W2=function(n){function t(e){var r=e.userId,i=e.token,a=e.deviceOS,s=e.deviceManufacturer,u=e.systemPushEnabled,o=n.call(this)||this;return o.method=J.POST,o.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/gcm"),o.params=ge({gcm_reg_token:i,always_push:!0,device_os:a,device_manufacturer:s,system_push_enabled:u}),o}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.token,i.type=r.type?Qt[r.type.toLowerCase()]:Qt.UNKNOWN,i.user=new Mn(e,r.user),i}w(t,n)})(ie);var Y2=function(n){function t(e){var r=e.userId,i=e.token,a=n.call(this)||this;return a.method=J.DELETE,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/apns/").concat(encodeURIComponent(i)),a}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.token,i.user=new Mn(e,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}w(t,n)})(ie);var Q2=function(n){function t(e){var r=e.userId,i=e.token,a=n.call(this)||this;return a.method=J.DELETE,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/gcm/").concat(encodeURIComponent(i)),a}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.token=r.token,i.user=new Mn(e,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}w(t,n)})(ie);var X2=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.DELETE,i.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/apns"),i}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.type=r.type?Qt[r.type.toLowerCase()]:Qt.UNKNOWN,i.user=new Mn(e,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}w(t,n)})(ie);var Z2=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.DELETE,i.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/gcm"),i}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.type=r.type?Qt[r.type.toLowerCase()]:Qt.UNKNOWN,i.user=new Mn(e,r.user),i.lastDeletedAt=r.device_token_last_deleted_at,i}w(t,n)})(ie);var J2=function(n){function t(e){var r=e.userId,i=e.type,a=e.token,s=e.ts,u=n.call(this)||this;return u.method=J.GET,u.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/").concat(encodeURIComponent(i),"/device_tokens"),u.params={created_ts:s,token:a},u}return w(t,n),t}(ee),eA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTokens={type:r.type?Qt[r.type.toLowerCase()]:Qt.UNKNOWN,deviceTokens:r.device_tokens,hasMore:r.has_more,token:r.token},i}return w(t,n),t}(ie),nA=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(qn,"/").concat(encodeURIComponent(r),"/channel_invitation_preference"),i}return w(t,n),t}(ee),tA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.autoAccept=r.auto_accept,i}return w(t,n),t}(ie),rA=function(n){function t(e){var r=e.userId,i=e.willAutoAccept,a=n.call(this)||this;return a.method=J.PUT,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/channel_invitation_preference"),a.params={auto_accept:i},a}return w(t,n),t}(ee),iA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.autoAccept=r.auto_accept,i}return w(t,n),t}(ie),aA=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push_preference"),i}return w(t,n),t}(ee),sA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.preference={doNotDisturbOn:r.do_not_disturb,startHour:r.start_hour,startMin:r.start_min,endHour:r.end_hour,endMin:r.end_min,timezone:r.timezone},i}return w(t,n),t}(ie),uA=function(n){function t(e){var r=e.userId,i=e.doNotDisturbOn,a=e.startHour,s=e.startMin,u=e.endHour,o=e.endMin,l=e.timezone,d=n.call(this)||this;return d.method=J.PUT,d.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push_preference"),d.params={do_not_disturb:i,start_hour:a,start_min:s,end_hour:u,end_min:o,timezone:l},d}return w(t,n),t}(ee),oA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.preference={doNotDisturbOn:r.do_not_disturb,startHour:r.start_hour,startMin:r.start_min,endHour:r.end_hour,endMin:r.end_min,timezone:r.timezone},i}return w(t,n),t}(ie),lA=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push_preference"),i}return w(t,n),t}(ee),dA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.snoozePeriod={isSnoozeOn:r.snooze_enabled},typeof r.snooze_start_ts=="number"&&(i.snoozePeriod.startTs=r.snooze_start_ts),typeof r.snooze_end_ts=="number"&&(i.snoozePeriod.endTs=r.snooze_end_ts),i}return w(t,n),t}(ie),cA=function(n){function t(e){var r=e.userId,i=e.snoozeOn,a=e.startTs,s=e.endTs,u=n.call(this)||this;return u.method=J.PUT,u.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push_preference"),u.params={snooze_enabled:i,snooze_start_ts:a,snooze_end_ts:s},u}return w(t,n),t}(ee),fA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.snoozePeriod={isSnoozeOn:r.snooze_enabled},typeof r.snooze_start_ts=="number"&&(i.snoozePeriod.startTs=r.snooze_start_ts),typeof r.snooze_end_ts=="number"&&(i.snoozePeriod.endTs=r.snooze_end_ts),i}return w(t,n),t}(ie),hA=function(n){function t(e){var r=e.userId,i=e.blockedUserId,a=n.call(this)||this;return a.method=J.POST,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/block"),a.params={target_id:i},a}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.user=new Mn(e,r),i}w(t,n)})(ie);var pA=function(n){function t(e){var r=e.userId,i=e.unblockedUserId,a=n.call(this)||this;return a.method=J.DELETE,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/block/").concat(encodeURIComponent(i)),a}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var mA=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push_preference"),i}return w(t,n),t}(ee),_A=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTriggerOption=r.push_trigger_option,i}return w(t,n),t}(ie),gA=function(n){function t(e){var r=e.userId,i=e.pushTriggerOption,a=n.call(this)||this;return a.method=J.PUT,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push_preference"),a.params={push_trigger_option:i},a}return w(t,n),t}(ee),EA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTriggerOption=r.push_trigger_option,i}return w(t,n),t}(ie),vA=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/template"),i}return w(t,n),t}(ee),yA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.name=r.name,i}return w(t,n),t}(ie),bA=function(n){function t(e){var r=e.userId,i=e.templateName,a=n.call(this)||this;return a.method=J.PUT,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push/template"),a.params={name:i},a}return w(t,n),t}(ee),CA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.name=r.name,i}return w(t,n),t}(ie),SA=function(n){function t(e){var r=e.userId,i=e.token,a=n.call(this)||this;return a.method=J.GET,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/friends/changelogs"),a.params={token:i},a}return w(t,n),t}(ee),TA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.changelogs={addedUsers:r.added.map(function(a){return new Mn(e,a)}),updatedUsers:r.updated.map(function(a){return new Mn(e,a)}),deletedUserIds:r.deleted,hasMore:r.has_more,token:r.next},i}return w(t,n),t}(ie),NA=function(n){function t(e){var r=e.userId,i=e.discoveries,a=n.call(this)||this;return a.method=J.PUT,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/friend_discoveries"),a.params={friend_discoveries:i.map(function(s){return{friend_discovery_key:s.friendDiscoveryKey,friend_name:s.friendName}})},a}return w(t,n),t}(ee),IA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.friendDiscoveryRequestId=r.friend_discovery_request_id,i}return w(t,n),t}(ie),AA=function(n){function t(e){var r=e.userId,i=e.discoveryKeys,a=n.call(this)||this;return a.method=J.DELETE,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/friend_discoveries"),a.params={friend_discovery_keys:i},a}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var MA=function(n){function t(e){var r=e.userId,i=e.userIds,a=n.call(this)||this;return a.method=J.POST,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/friends"),a.params={user_ids:i},a}return w(t,n),t}(ee),wA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.users=r.users.map(function(a){return new Mn(e,a)}),i}return w(t,n),t}(ie),OA=function(n){function t(e){var r=e.userId,i=e.userIds,a=n.call(this)||this;return a.method=J.DELETE,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/friends"),a.params={user_ids:i},a}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var RA=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(qn,"/").concat(r,"/allow_friend_discovery"),i.params={},i}return w(t,n),t}(ee),DA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.allowFriendDiscovery=r.allow_friend_discovery,i}return w(t,n),t}(ie),LA=function(n){function t(e){var r=e.userId,i=e.allowFriendDiscovery,a=n.call(this)||this;return a.method=J.PUT,a.path="".concat(qn,"/").concat(r,"/allow_friend_discovery"),a.params={allow_friend_discovery:i},a}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var bd,UA=function(n){function t(){var e=n.call(this)||this;return e.method=J.GET,e.path=vy,e}return w(t,n),t}(ee),kA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.emojiContainer=new Yb(r),i}return w(t,n),t}(ie),xA=function(n){function t(e){var r=e.categoryId,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(vy,"/").concat(r),i}return w(t,n),t}(ee),PA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.emojiCategory=new Wb(r),i}return w(t,n),t}(ie),FA=function(n){function t(e){var r=e.key,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(lT,"/").concat(r),i}return w(t,n),t}(ee),HA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.emoji=new $b(r),i}return w(t,n),t}(ie),BA=function(n){function t(){var e=n.call(this)||this;return e.method=J.GET,e.path="".concat(dT),e}return w(t,n),t}(ee),GA=function(n){function t(e,r){var i,a=this,s=r??{};return(a=n.call(this,e,r)||this).uikitConfiguration={string:JSON.stringify(s),json:s},a.updatedAt=(i=r==null?void 0:r.updated_at)!==null&&i!==void 0?i:0,a}return w(t,n),t}(ie);(function(n){n.DELIVERED="DELIVERED",n.CLICKED="CLICKED"})(bd||(bd={}));var Fu,tg=function(n){function t(e){var r=e.deviceToken,i=e.pushTrackingId,a=e.messageId,s=e.allowedPushNotification,u=e.channelKey,o=e.templateKey,l=e.eventType,d=e.notificationEventDeadline,c=n.call(this)||this;return c.method=J.POST,c.path=hT,c.params=ge({device_token:r,push_tracking_id:i,message_id:a,allowed_push_notification:s,channel_key:u,template_key:o,event_type:l,notification_event_deadline:d}),c}return w(t,n),t}(ee),Qb=function(){function n(t,e,r){var i=this;this._storeInitialized=!1,this._iid=t,this.options=e;var a=k.of(t),s=a.sdkState,u=a.cacheContext,o=a.dispatcher,l=a.sessionManager,d=a.requestQueue,c=a.logger,f=a.userEventHandlers,h=a.appStateToggleEnabled;this._onlineDetector=new K2({logger:c,connectionDelegate:{reconnect:function(){return y(i,void 0,void 0,function(){var _,E,b,g,C,S;return v(this,function(A){switch(A.label){case 0:if(_=k.of(t),E=_.sdkState,b=_.connectionManager,(g=_.sessionManager).session.hasSession)return[3,5];A.label=1;case 1:return A.trys.push([1,3,,4]),[4,b.connect(g.session.authToken)];case 2:return A.sent(),[3,4];case 3:if(C=A.sent(),gr(C))throw C;return c.debug("connect failed by reconnect event = ",C),[3,4];case 4:return[3,9];case 5:if(E.appState!=="foreground")return[3,9];A.label=6;case 6:return A.trys.push([6,8,,9]),[4,b.resetAndReconnect()];case 7:return A.sent(),[3,9];case 8:if(S=A.sent(),gr(S))throw S;return c.debug("resetAndReconnect failed by reconnect event = ",S),[3,9];case 9:return o.dispatch(new Z_),[2]}})})},disconnect:function(){Lt(function(){return y(i,void 0,void 0,function(){return v(this,function(_){switch(_.label){case 0:return[4,k.of(t).connectionManager.disconnect()];case 1:return _.sent(),[2]}})})})}}});var m=new ro(t,{localCacheEnabled:u.localCacheEnabled,enableAutoResend:u.localCacheConfig.enableAutoResend,dispatcher:o,sdkState:s,logger:c});r.forEach(function(_){_.init(t,{sdkState:s,cacheContext:u,dispatcher:o,sessionManager:l,requestQueue:d,logger:c,onlineDetector:i._onlineDetector}),i[_.name]=_}),this._appStateChangeDetector=new z2({isEnabled:h}),this._appStateChangeDetector.on("resume",function(){c.debug("the page resumes from freeze"),i.setForegroundState()}).on("pause",function(){c.debug("the page freezes"),i.setBackgroundState()}),o.on(function(_){var E;if(_ instanceof Kr)_.stateType===Wn.CONNECTED&&m.processNonAutoResendRegisteredPendingMessages();else if(_ instanceof ft){if(_.code==="USEV"){var b=_.as(Kb).event;if(b.category===Uo.FRIEND_DISCOVERED){var g=yd.getDataAsFriendDiscoveredEvent(t,b).friendDiscoveries;Ae(function(){return y(i,void 0,void 0,function(){return v(this,function(I){return[2,f.forEach(function(T){T.onFriendsDiscovered&&T.onFriendsDiscovered(g)})]})})})}}}else if(_ instanceof $y){var C=k.of(i._iid).subscribedUnreadMessageCount,S=!1,A=_.ts;typeof A=="number"&&A>C.ts&&(C.all!==_.all&&(S=!0),C.all=_.all>=0?_.all:0,_.customTypes&&Object.keys(_.customTypes).forEach(function(I){C.customTypes[I]!==_.customTypes[I]&&(S=!0),C.customTypes[I]=_.customTypes[I]}),S=S&&C.ts>0,C.ts=A),S&&Ae(function(){return y(i,void 0,void 0,function(){return v(this,function(I){return[2,f.forEach(function(T){T.onTotalUnreadMessageCountChanged&&T.onTotalUnreadMessageCountChanged({groupChannelCount:C.all,feedChannelCount:C.feed,customTypeUnreadCount:C.customTypes}),T.onTotalUnreadMessageCountUpdated&&T.onTotalUnreadMessageCountUpdated(C.all,C.customTypes)})]})})})}else _ instanceof Qy?(u.preference.set(i._getUserProfileCacheKey(s.userId),Mf.payloadify(_.userProfile)),!((E=_.userProfile.appInfo.notificationInfo)===null||E===void 0)&&E.isEnabled&&u.preference.set(Ip(i.appId),{value:!0})):_ instanceof gu&&_.error&&_.error.isSessionInvalidatedError&&(c.debug("session revoked."),i._internalDisconnect(_.error))})}return n.init=function(t){var e=t.appId,r=t.appVersion,i=t.modules,a=i===void 0?[]:i,s=t.options,u=s===void 0?new _y:s,o=t.debugMode,l=o!==void 0&&o,d=t.customApiHost,c=t.customWebSocketHost,f=t.newInstance,h=f!==void 0&&f,m=t.logLevel,_=t.localCacheEnabled,E=_!==void 0&&_,b=t.localCacheConfig,g=b===void 0?new Ey:b,C=t.localCacheEncryption,S=t.useAsyncStorageStore,A=S===void 0?null:S,I=t.useMMKVStorageStore,T=I===void 0?null:I,M=t.appStateToggleEnabled,O=M===void 0||M;if(!Fu||h){var R="su-".concat(ba()),U=C??{encrypt:function(V){return V},decrypt:function(V){return V}},P=new E2;P.level=m??fa.WARN;var L=new ms({encryption:U});l||(Sf()?T?L=new _2({MMKV:T,encryption:U}):A&&(L=new m2({AsyncStorage:A,encryption:U}),P.warn("AsyncStorage store is deprecated due to the small size limit. Please use MMKVStorage store instead.")):L=new p2({encryption:U})),new k(R,{appId:e,appVersion:r,options:u,apiHost:d??"https://api-".concat(e,".sendbird.com"),websocketHost:c??"wss://ws-".concat(e,".sendbird.com"),store:L,encryption:U,logger:P,localCacheEnabled:E,localCacheConfig:g,debugMode:l,appStateToggleEnabled:O});var F=[new H2,new G2],B=new n(R,u,Be(Be([],we(a),!1),we(F),!1));return Fu||(Fu=B),B}return Fu},Object.defineProperty(n,"instance",{get:function(){return Fu},enumerable:!1,configurable:!0}),Object.defineProperty(n,"version",{get:function(){return py},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"appId",{get:function(){return k.of(this._iid).sdkState.appId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"appInfo",{get:function(){var t=k.of(this._iid).appInfo;return t??null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"appVersion",{get:function(){var t;return(t=k.of(this._iid).sdkState.appVersion)!==null&&t!==void 0?t:""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"debugMode",{get:function(){return!!k.of(this._iid).debugMode},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"logLevel",{get:function(){return k.of(this._iid).logger.level},set:function(t){k.of(this._iid).logger.level=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isCacheEnabled",{get:function(){return k.of(this._iid).cacheContext.localCacheEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localCacheConfig",{get:function(){var t=k.of(this._iid).cacheContext;return t.localCacheEnabled?t.localCacheConfig:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ekey",{get:function(){return k.of(this._iid).sessionManager.ekey},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentUser",{get:function(){var t;return(t=k.of(this._iid).sessionManager.currentUser)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"connectionState",{get:function(){var t=k.of(this._iid).connectionManager;return t.isConnected?ji.OPEN:t.isConnecting?ji.CONNECTING:ji.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastConnectedAt",{get:function(){var t=k.of(this._iid),e=t.connectedAt;return t.connectionManager.isConnected?e:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fcmPushToken",{get:function(){var t;return(t=this._fcmPushToken)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"apnsPushToken",{get:function(){var t;return(t=this._apnsPushToken)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),n.prototype._getNestDBVersion=function(){return 7},n.prototype._getPreferenceVersion=function(){return 8},n.prototype._getPreferenceCacheKey=function(t){return"sendbird@".concat(this.appId,"/").concat(t,".pref")},n.prototype._getUserProfileCacheKey=function(t){return"sendbird@".concat(this.appId,"/").concat(t,".profile")},n.prototype._internalDisconnect=function(t){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return e=k.of(this._iid),r=e.connectionManager,i=e.sdkState,a=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),a.cancelAll(),[4,r.logout(t)];case 1:return s.sent(),[4,this.clearCachedData()];case 2:return s.sent(),i.appState="foreground",[2]}})})},n.prototype.getMemoryStoreForDebugging=function(){var t=k.of(this._iid),e=t.debugMode,r=t.cacheContext;if(e)return r.store instanceof ms?r.store:null;throw H.debugModeRequired},n.prototype.addExtension=function(t,e){var r=k.of(this._iid).sdkState;["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(t)>-1&&r.extensions&&(r.extensions[t]=e)},n.prototype.addSendbirdExtensions=function(t,e,r){var i,a,s=k.of(this._iid),u=s.logger,o=s.sdkState,l=new RegExp(yT);if(t.length===0)return u.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."),!1;if(t.find(function(_){return!l.test(_.version)}))return u.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."),!1;if(r)try{for(var d=oe(Object.entries(r)),c=d.next();!c.done;c=d.next()){var f=we(c.value,2),h=f[0],m=f[1];if(/&|=/.test(h)||/&|=/.test(m))return u.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."),!1}}catch(_){i={error:_}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}return o.sendbirdRuntimeEnvironment={sendbirdExtensions:t,deviceOS:e,customData:r},!0},n.prototype.setOnlineListener=function(t){this._onlineDetector.setOnlineListener(t)},n.prototype.setOfflineListener=function(t){this._onlineDetector.setOfflineListener(t)},n.prototype._safeInitializeStore=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:e=k.of(this._iid).cacheContext,r.label=1;case 1:return r.trys.push([1,3,,5]),[4,e.store.init(t)];case 2:return r.sent(),this._storeInitialized=!0,[3,5];case 3:return r.sent(),e.replaceStore(new ms),[4,this._safeInitializeStore(t)];case 4:return r.sent(),[3,5];case 5:return[2]}})})},n.prototype.setLocaleForChatbot=function(t){var e=k.of(this._iid).sdkState,r=function(i){return i.replace(/[^a-zA-Z-_.]/g,"")}(t.trim());r&&(e.localeForChatbot=r)},n.prototype.initializeCache=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d;return v(this,function(c){switch(c.label){case 0:if(e=k.of(this._iid),r=e.sdkState,i=e.cacheContext,a=e.dispatcher,s=e.logger,r.userId&&r.userId===t)return[3,13];u="sendbird@".concat(r.appId,"/").concat(t,".db"),c.label=1;case 1:return c.trys.push([1,9,11,13]),i.localCacheEnabled?i.nestdb&&i.nestdb.state!==Bi.CLOSED&&i.nestdb.name===u?[3,3]:(o="sendbird@".concat(r.appId,"/").concat(t,".db"),(l=i.nestdb=new g2({name:o,version:this._getNestDBVersion(),store:i.store,config:new $o({dbname:o,itemSizeLimit:61440})})).on("upgrade",J_(l)),l.on("storeReplaced",function(f){i.replaceStore(f),i.localCacheEnabled=!1,l.on("upgrade",J_(l))}),[4,l.open()]):[3,6];case 2:return c.sent(),this._storeInitialized=!0,a.dispatch(new qb(this._iid,{userId:t})),[3,5];case 3:return[4,this._safeInitializeStore(u)];case 4:c.sent(),c.label=5;case 5:return r.userId=t,[3,8];case 6:return[4,this._safeInitializeStore(u)];case 7:c.sent(),r.userId=t,c.label=8;case 8:return[3,13];case 9:return d=c.sent(),s.warn("Nest DB Open Failed. ",d),i.store instanceof ms||(i.replaceStore(new ms),i.localCacheEnabled=!1),[4,this._safeInitializeStore(u)];case 10:throw c.sent(),r.userId=t,H.databaseError;case 11:return[4,this._setupPreference(t)];case 12:return c.sent(),[7];case 13:return[2]}})})},n.prototype.getCacheDataSize=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return(t=k.of(this._iid).cacheContext).localCacheEnabled&&t.nestdb?[4,t.nestdb.estimateUsage()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,0]}})})},n.prototype.clearCachedData=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return(t=k.of(this._iid).cacheContext).localCacheEnabled&&t.nestdb?[4,t.nestdb.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this._storeInitialized?[4,t.preference.clear()]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}})})},n.prototype.clearCachedMessages=function(t){return y(this,void 0,void 0,function(){var e,r,i=this;return v(this,function(a){switch(a.label){case 0:return ne(gn("string",t)).throw(H.invalidParameters),e=hu.of(this._iid),r=Fs.of(this._iid),e&&r?[4,Promise.all(t.map(function(s){return y(i,void 0,void 0,function(){return v(this,function(u){switch(u.label){case 0:return[4,e.removeMessagesOfChannel(s)];case 1:return u.sent(),[4,r.removeMessagesOfChannel(s)];case 2:return u.sent(),[2]}})})}))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},n.prototype._setupPreference=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.cacheContext,a=e.statManager,[4,i.preference.init(this._getPreferenceCacheKey(t),this._getPreferenceVersion())];case 1:return u.sent(),[4,i.preference.get(this._getUserProfileCacheKey(t))];case 2:return(s=u.sent())&&new Mf(this._iid,s).apply(),[4,a.init("sendbird@".concat(r.appId,"/").concat(t,".statlog"))];case 3:return u.sent(),[2]}})})},n.prototype._ready=function(t,e,r){return r===void 0&&(r={}),y(this,void 0,void 0,function(){var i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return ne(x("string",t)&&x("string",e,!0)).throw(H.invalidParameters),i=k.of(this._iid),a=i.sdkState,s=i.cacheContext,u=i.connectionManager,o=r.errorForOtherUser,a.userId&&a.userId!==t?o?[3,2]:[4,u.logout()]:[3,3];case 1:return d.sent(),[3,3];case 2:throw o;case 3:return d.trys.push([3,5,,6]),[4,this.initializeCache(t)];case 4:return d.sent(),k.of(this._iid).dispatcher.dispatch(new zb),[3,6];case 5:return d.sent(),l=k.of(this._iid).logger,s.localCacheEnabled=!1,l.warn("Cache initialization failed - cache is not available."),[3,6];case 6:return[2]}})})},n.prototype.authenticateFeed=function(t,e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this.authenticate(t,e)];case 1:return[2,r.sent()]}})})},n.prototype.authenticate=function(t,e,r){var i;return r===void 0&&(r=ed.SESSION_TOKEN),y(this,void 0,void 0,function(){var a,s,u;return v(this,function(o){switch(o.label){case 0:return a=k.of(this._iid),s=a.sessionManager,u=a.connectionManager,[4,this._ready(t,e,{errorForOtherUser:u.isConnected?H.alreadyConnectedAsAnotherUser:void 0})];case 1:return o.sent(),!((i=s.session.services)===null||i===void 0)&&i.includes(td.CHAT)?[3,3]:(s.handler||e&&r!==ed.ACCESS_TOKEN||this.setSessionHandler(new G_),[4,s.authenticate(t,e)]);case 2:o.sent(),o.label=3;case 3:return[2,this.currentUser]}})})},n.prototype.connect=function(t,e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._ready(t,e)];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,,4,5]),[4,k.of(this._iid).connectionManager.connect(e)];case 3:return r.sent(),[3,5];case 4:return this._onlineDetector.start(),this._appStateChangeDetector.start(),[7];case 5:return[2,this.currentUser]}})})},n.prototype.reconnect=function(){var t=k.of(this._iid),e=t.connectionManager,r=t.sdkState,i=t.sessionManager.session.hasSession;return i&&(this._appStateChangeDetector.start(),this._onlineDetector.start(),e.resetAndReconnect().then(function(){r.appState="foreground"}).catch(function(){})),i},n.prototype.disconnect=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this._internalDisconnect()];case 1:return t.sent(),[2]}})})},n.prototype.disconnectWebSocket=function(){return y(this,void 0,void 0,function(){var t,e,r;return v(this,function(i){switch(i.label){case 0:return t=k.of(this._iid),e=t.connectionManager,r=t.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),r.cancelAll(),[4,e.disconnectWebSocket(!0)];case 1:return i.sent(),[2]}})})},n.prototype.setBackgroundState=function(){var t=k.of(this._iid),e=t.connectionManager,r=t.sdkState,i=t.logger;r.appState==="foreground"&&(r.appState="background",i.debug("going background state"),e.background().catch(function(a){i.debug("setBackgroundState error = ",a)}))},n.prototype.setForegroundState=function(){var t=k.of(this._iid),e=t.connectionManager,r=t.sdkState,i=t.dispatcher,a=t.logger;r.appState==="background"&&(r.appState="foreground",a.debug("going foreground state"),e.resetAndReconnect().catch(function(s){a.debug("setForgroundState error = ",s)}),i.dispatch(new Z_))},n.prototype.setSessionHandler=function(t){ne(t instanceof G_).throw(H.invalidParameters),k.of(this._iid).sessionManager.handler=t},n.prototype.addUserEventHandler=function(t,e){ne(x("string",t)&&e instanceof XI).throw(H.invalidParameters),k.of(this._iid).userEventHandlers.set(t,e)},n.prototype.removeUserEventHandler=function(t){k.of(this._iid).userEventHandlers.delete(t)},n.prototype.removeAllUserEventHandler=function(){k.of(this._iid).userEventHandlers.clear()},n.prototype.addConnectionHandler=function(t,e){ne(x("string",t)&&e instanceof Hb).throw(H.invalidParameters),k.of(this._iid).connectionHandlers.set(t,e)},n.prototype.removeConnectionHandler=function(t){k.of(this._iid).connectionHandlers.delete(t)},n.prototype.removeAllConnectionHandler=function(){k.of(this._iid).connectionHandlers.clear()},n.prototype.createApplicationUserListQuery=function(t){return t===void 0&&(t={}),new e2(this._iid,t)},n.prototype.createBlockedUserListQuery=function(t){return t===void 0&&(t={}),new r2(this._iid,t)},n.prototype.createFriendListQuery=function(t){return t===void 0&&(t={}),new s2(this._iid,t)},n.prototype.createMessageSearchQuery=function(t){return new L2(this._iid,t)},n.prototype.createPollListQuery=function(t){return new hb(this._iid,D({},t))},n.prototype.createPollVoterListQuery=function(t){return new pb(this._iid,D({},t))},n.prototype.buildUserFromSerializedData=function(t){var e=$a(t);return new Mn(this._iid,Mn.payloadify(e))},n.prototype.updateCurrentUserInfo=function(t){return t===void 0&&(t={}),y(this,void 0,void 0,function(){var e,r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return e=D(D({},j2),t),ne(function(d){return Zt(d.profileImage,!0)&&x("string",d.profileUrl,!0)&&x("string",d.nickname,!0)}(e)).throw(H.invalidParameters),this.currentUser?(r=k.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new eg(D({userId:i.userId},e)),[4,a.send(s)]):[3,2];case 1:return u=l.sent(),o=u.as(ng).user,this.currentUser&&(e.nickname&&(this.currentUser.nickname=o.nickname),(e.profileUrl||e.profileImage)&&(this.currentUser.plainProfileUrl=o.profileUrl)),[2,o];case 2:throw H.connectionRequired}})})},n.prototype.updateCurrentUserInfoWithPreferredLanguages=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return ne(gn("string",t)).throw(H.invalidParameters),this.currentUser?(e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new eg({userId:r.userId,preferredLanguages:t}),[4,i.send(a)]):[3,2];case 1:return s=o.sent(),u=s.as(ng).user,this.currentUser&&(this.currentUser.preferredLanguages=u.preferredLanguages),[2,u];case 2:throw H.connectionRequired}})})},n.prototype.registerFCMPushTokenForCurrentUser=function(t,e){var r,i;return y(this,void 0,void 0,function(){var a,s,u,o,l,d,c=this;return v(this,function(f){switch(f.label){case 0:if(ne(x("string",t)&&x("string",e==null?void 0:e.deviceManufacturer,!0)).throw(H.invalidParameters),e!=null&&e.deviceOS&&ne(_n(Fa,e.deviceOS.platform,!0)&&x("string",e.deviceOS.version,!0)).throw(H.invalidParameters),!this.currentUser)return[3,6];a={deviceOS:"".concat(((r=e==null?void 0:e.deviceOS)===null||r===void 0?void 0:r.platform)||Fa.ANDROID,"-").concat(((i=e==null?void 0:e.deviceOS)===null||i===void 0?void 0:i.version)||"unknown"),deviceManufacturer:e==null?void 0:e.deviceManufacturer,systemPushEnabled:e==null?void 0:e.systemPushEnabled},f.label=1;case 1:return f.trys.push([1,4,,5]),s=k.of(this._iid),u=s.sessionManager,o=s.sdkState,l=s.requestQueue,u.hasDeviceToken(Qt.FCM,t)?[2,Cr.SUCCESS]:(d=new W2({userId:o.userId,token:t,deviceOS:a.deviceOS,deviceManufacturer:a.deviceManufacturer,systemPushEnabled:a.systemPushEnabled}),[4,l.send(d)]);case 2:return f.sent(),[4,Lt(function(){return y(c,void 0,void 0,function(){return v(this,function(h){switch(h.label){case 0:return u.setDeviceToken(Qt.FCM,t,a),[4,u.saveDeviceToken()];case 1:return h.sent(),[2]}})})})];case 3:return f.sent(),this._fcmPushToken="",[2,Cr.SUCCESS];case 4:return f.sent(),[2,Cr.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=t,[2,Cr.PENDING];case 7:return[2]}})})},n.prototype.unregisterFCMPushTokenForCurrentUser=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o=this;return v(this,function(l){switch(l.label){case 0:if(ne(x("string",t)).throw(H.invalidParameters),!this.currentUser)return[3,6];l.label=1;case 1:return l.trys.push([1,4,,5]),e=k.of(this._iid),r=e.sessionManager,i=e.sdkState,a=e.requestQueue,s=new Q2({userId:i.userId,token:t}),[4,a.send(s)];case 2:return u=l.sent().lastDeletedAt,[4,Lt(function(){return y(o,void 0,void 0,function(){return v(this,function(d){switch(d.label){case 0:return r.unsetDeviceToken(Qt.FCM,t),r.setDeviceTokenDeletedAt(u),[4,r.saveDeviceToken()];case 1:return d.sent(),[2]}})})})];case 3:return l.sent(),this._fcmPushToken="",[2,Cr.SUCCESS];case 4:return l.sent(),[2,Cr.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=t,[2,Cr.PENDING];case 7:return[2]}})})},n.prototype.unregisterFCMPushTokenAllForCurrentUser=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u=this;return v(this,function(o){switch(o.label){case 0:return this.currentUser?(t=k.of(this._iid),e=t.sessionManager,r=t.sdkState,i=t.requestQueue,a=new Z2({userId:r.userId}),[4,i.send(a)]):[3,3];case 1:return s=o.sent().lastDeletedAt,[4,Lt(function(){return y(u,void 0,void 0,function(){return v(this,function(l){switch(l.label){case 0:return e.unsetDeviceTokens(Qt.FCM),e.setDeviceTokenDeletedAt(s),[4,e.saveDeviceToken()];case 1:return l.sent(),[2]}})})})];case 2:o.sent(),o.label=3;case 3:return[2]}})})},n.prototype.registerAPNSPushTokenForCurrentUser=function(t,e){var r,i;return y(this,void 0,void 0,function(){var a,s,u,o,l,d,c=this;return v(this,function(f){switch(f.label){case 0:if(ne(x("string",t)&&x("string",e==null?void 0:e.deviceManufacturer,!0)).throw(H.invalidParameters),e!=null&&e.deviceOS&&ne(_n(Fa,e.deviceOS.platform,!0)&&x("string",e.deviceOS.version,!0)).throw(H.invalidParameters),!this.currentUser)return[3,6];a={deviceOS:"".concat(((r=e==null?void 0:e.deviceOS)===null||r===void 0?void 0:r.platform)||Fa.IOS,"-").concat(((i=e==null?void 0:e.deviceOS)===null||i===void 0?void 0:i.version)||"unknown"),deviceManufacturer:e==null?void 0:e.deviceManufacturer,systemPushEnabled:e==null?void 0:e.systemPushEnabled},f.label=1;case 1:return f.trys.push([1,4,,5]),s=k.of(this._iid),u=s.sessionManager,o=s.sdkState,l=s.requestQueue,u.hasDeviceToken(Qt.APNS,t)?[2,Cr.SUCCESS]:(d=new $2({userId:o.userId,token:t,deviceOS:a.deviceOS,deviceManufacturer:a.deviceManufacturer,systemPushEnabled:a.systemPushEnabled}),[4,l.send(d)]);case 2:return f.sent(),[4,Lt(function(){return y(c,void 0,void 0,function(){return v(this,function(h){switch(h.label){case 0:return u.setDeviceToken(Qt.APNS,t,a),[4,u.saveDeviceToken()];case 1:return h.sent(),[2]}})})})];case 3:return f.sent(),this._apnsPushToken="",[2,Cr.SUCCESS];case 4:return f.sent(),[2,Cr.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=t,[2,Cr.PENDING];case 7:return[2]}})})},n.prototype.unregisterAPNSPushTokenForCurrentUser=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o=this;return v(this,function(l){switch(l.label){case 0:if(ne(x("string",t)).throw(H.invalidParameters),!this.currentUser)return[3,6];l.label=1;case 1:return l.trys.push([1,4,,5]),e=k.of(this._iid),r=e.sessionManager,i=e.sdkState,a=e.requestQueue,s=new Y2({userId:i.userId,token:t}),[4,a.send(s)];case 2:return u=l.sent().lastDeletedAt,[4,Lt(function(){return y(o,void 0,void 0,function(){return v(this,function(d){switch(d.label){case 0:return r.unsetDeviceToken(Qt.APNS,t),r.setDeviceTokenDeletedAt(u),[4,r.saveDeviceToken()];case 1:return d.sent(),[2]}})})})];case 3:return l.sent(),this._apnsPushToken="",[2,Cr.SUCCESS];case 4:return l.sent(),[2,Cr.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=t,[2,Cr.PENDING];case 7:return[2]}})})},n.prototype.unregisterAPNSPushTokenAllForCurrentUser=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a,s,u=this;return v(this,function(o){switch(o.label){case 0:return this.currentUser?(t=k.of(this._iid),e=t.sessionManager,r=t.sdkState,i=t.requestQueue,a=new X2({userId:r.userId}),[4,i.send(a)]):[3,3];case 1:return s=o.sent().lastDeletedAt,[4,Lt(function(){return y(u,void 0,void 0,function(){return v(this,function(l){switch(l.label){case 0:return e.unsetDeviceTokens(Qt.APNS),e.setDeviceTokenDeletedAt(s),[4,e.saveDeviceToken()];case 1:return l.sent(),[2]}})})})];case 2:o.sent(),o.label=3;case 3:return[2]}})})},n.prototype.markPushNotificationAsDelivered=function(t,e){var r;return e===void 0&&(e=!0),y(this,void 0,void 0,function(){var i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I;return v(this,function(T){switch(T.label){case 0:if(i=k.of(this._iid),a=i.logger,s=i.sessionManager,u=i.requestQueue,o=i.pushNotificationAckManager,a.debug("markPushNotificationAsDelivered:",t),l=bd.DELIVERED,d=o.parseData(t),c=d.pushTrackingId,f=d.sessionTopics,h=d.sessionKey,m=d.messageId,_=d.channelKey,E=d.templateKey,b=d.notificationEventDeadline,!h||!f.includes(dd.PUSH_ACKNOWLEDGEMENT))throw a.info("Can't use markPushNotificationAsDelivered() feature."),H.malformedDataError;if(o.isAcked(c,l))return a.info("already delivered push notification:",c),[2];g=!!_,C=e&&g,S=(r=s.deviceTokens[0])===null||r===void 0?void 0:r.token,A=new tg({deviceToken:S??"",pushTrackingId:c,eventType:l,messageId:m,channelKey:_,templateKey:E,notificationEventDeadline:b,allowedPushNotification:C}),h&&(A.headers["Session-Key"]=h),T.label=1;case 1:return T.trys.push([1,3,,4]),[4,u.send(A)];case 2:return T.sent(),o.markAsAcked(c,l),[3,4];case 3:throw I=T.sent(),a.debug("failed to mark push notification as delivered. push tracking id: ".concat(c,". error: ").concat(I)),I;case 4:return[2]}})})},n.prototype.markPushNotificationAsClicked=function(t){var e;return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C;return v(this,function(S){switch(S.label){case 0:if(r=k.of(this._iid),i=r.logger,a=r.sessionManager,s=r.requestQueue,u=r.pushNotificationAckManager,i.debug("markPushNotificationAsClicked:",t),o=bd.CLICKED,l=u.parseData(t),d=l.pushTrackingId,c=l.sessionTopics,f=l.sessionKey,h=l.messageId,m=l.channelKey,_=l.templateKey,E=l.notificationEventDeadline,!f||!c.includes(dd.PUSH_ACKNOWLEDGEMENT))throw i.info("Can't use markPushNotificationAsClicked() feature."),H.malformedDataError;if(u.isAcked(d,o))return i.info("already clicked push notification:",d),[2];b=(e=a.deviceTokens[0])===null||e===void 0?void 0:e.token,g=new tg({deviceToken:b??"",pushTrackingId:d,eventType:o,messageId:h,channelKey:m,templateKey:_,notificationEventDeadline:E}),f&&(g.headers["Session-Key"]=f),S.label=1;case 1:return S.trys.push([1,3,,4]),[4,s.send(g)];case 2:return S.sent(),u.markAsAcked(d,o),[3,4];case 3:throw C=S.sent(),i.debug("failed to mark push notification as clicked. push tracking id: ".concat(d,". error: ").concat(C)),C;case 4:return[2]}})})},n.prototype.getChannelInvitationPreference=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a;return v(this,function(s){switch(s.label){case 0:return t=k.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new nA({userId:e.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,{autoAccept:a.as(tA).autoAccept}]}})})},n.prototype.setChannelInvitationPreference=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(x("boolean",t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new rA({userId:r.userId,willAutoAccept:t}),[4,i.send(a)];case 1:return s=u.sent(),[2,{autoAccept:s.as(iA).autoAccept}]}})})},n.prototype.getDoNotDisturb=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a;return v(this,function(s){switch(s.label){case 0:return t=k.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new aA({userId:e.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(sA).preference]}})})},n.prototype.setDoNotDisturb=function(t,e,r,i,a,s){return e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=""),y(this,void 0,void 0,function(){var u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:return ne(x("boolean",t)&&x("number",e)&&x("number",r)&&x("number",i)&&x("number",a)&&x("string",s)).throw(H.invalidParameters),u=k.of(this._iid),o=u.sdkState,l=u.requestQueue,d=new uA({userId:o.userId,doNotDisturbOn:t,startHour:e,startMin:r,endHour:i,endMin:a,timezone:s}),[4,l.send(d)];case 1:return c=f.sent(),[2,c.as(oA).preference]}})})},n.prototype.getSnoozePeriod=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a;return v(this,function(s){switch(s.label){case 0:return t=k.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new lA({userId:e.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(dA).snoozePeriod]}})})},n.prototype.setSnoozePeriod=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=0),y(this,void 0,void 0,function(){var i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return ne(x("boolean",t)&&x("number",e)&&x("number",r)).throw(H.invalidParameters),i=k.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new cA({userId:a.userId,snoozeOn:t,startTs:e,endTs:r}),[4,s.send(u)];case 1:return o=l.sent(),[2,o.as(fA).snoozePeriod]}})})},n.prototype.getMyPushTokensByToken=function(t,e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c,f,h,m;return v(this,function(_){switch(_.label){case 0:return ne(x("string",t)&&_n(Qt,e)).throw(H.invalidParameters),r=k.of(this._iid),i=r.sdkState,a=r.requestQueue,s=r.sessionManager,u=new J2({userId:i.userId,type:e,token:t}),[4,a.send(u)];case 1:o=_.sent(),l=o.as(eA).pushTokens;try{for(d=oe(l.deviceTokens),c=d.next();!c.done;c=d.next())f=c.value,s.setDeviceToken(l.type,f)}catch(E){h={error:E}}finally{try{c&&!c.done&&(m=d.return)&&m.call(d)}finally{if(h)throw h.error}}return[4,s.saveDeviceToken()];case 2:return _.sent(),[2,l]}})})},n.prototype.getPushTriggerOption=function(){return y(this,void 0,void 0,function(){var t,e,r,i;return v(this,function(a){switch(a.label){case 0:return t=k.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new mA({userId:e.userId}),[4,r.send(i)];case 1:return[2,a.sent().as(_A).pushTriggerOption]}})})},n.prototype.setPushTriggerOption=function(t){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return ne(_n(ys,t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new gA({userId:r.userId,pushTriggerOption:t}),[4,i.send(a)];case 1:return[2,s.sent().as(EA).pushTriggerOption]}})})},n.prototype.getPushTemplate=function(){return y(this,void 0,void 0,function(){var t,e,r,i;return v(this,function(a){switch(a.label){case 0:return t=k.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new vA({userId:e.userId}),[4,r.send(i)];case 1:return[2,a.sent().as(yA).name]}})})},n.prototype.setPushTemplate=function(t){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return ne(_n(Ef,t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new bA({userId:r.userId,templateName:t}),[4,i.send(a)];case 1:return[2,s.sent().as(CA).name]}})})},n.prototype.blockUser=function(t){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return ne(t instanceof Mn||x("string",t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new hA({userId:r.userId,blockedUserId:t instanceof Mn?t.userId:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.blockUserWithUserId=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){return[2,this.blockUser(t)]})})},n.prototype.unblockUser=function(t){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return ne(t instanceof Mn||x("string",t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new pA({userId:r.userId,unblockedUserId:t instanceof Mn?t.userId:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.unblockUserWithUserId=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){return[2,this.unblockUser(t)]})})},n.prototype.getFriendChangeLogsByToken=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(x("string",t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new SA({userId:r.userId,token:t}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(TA).changelogs]}})})},n.prototype.getAllowFriendDiscovery=function(){return y(this,void 0,void 0,function(){var t,e,r,i,a;return v(this,function(s){switch(s.label){case 0:return t=k.of(this._iid),e=t.sdkState,r=t.requestQueue,i=new RA({userId:e.userId}),[4,r.send(i)];case 1:return a=s.sent(),[2,a.as(DA).allowFriendDiscovery]}})})},n.prototype.setAllowFriendDiscovery=function(t){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return ne(x("boolean",t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new LA({userId:r.userId,allowFriendDiscovery:t}),[4,i.send(a)];case 1:return s.sent(),[2,t]}})})},n.prototype.uploadFriendDiscoveries=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new NA({userId:r.userId,discoveries:t}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(IA).friendDiscoveryRequestId]}})})},n.prototype.deleteFriendDiscovery=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){return[2,this.deleteFriendDiscoveries([t])]})})},n.prototype.deleteFriendDiscoveries=function(t){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return ne(gn("string",t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new AA({userId:r.userId,discoveryKeys:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.addFriends=function(t){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(gn("string",t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new MA({userId:r.userId,userIds:t}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(wA).users]}})})},n.prototype.deleteFriend=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){return[2,this.deleteFriends([t])]})})},n.prototype.deleteFriends=function(t){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return ne(gn("string",t)).throw(H.invalidParameters),e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new OA({userId:r.userId,userIds:t}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},n.prototype.getAllEmoji=function(){return y(this,void 0,void 0,function(){var t,e,r;return v(this,function(i){switch(i.label){case 0:return t=k.of(this._iid).requestQueue,e=new UA,[4,t.send(e)];case 1:return r=i.sent(),[2,r.as(kA).emojiContainer]}})})},n.prototype.getEmojiCategory=function(t){return y(this,void 0,void 0,function(){var e,r,i;return v(this,function(a){switch(a.label){case 0:return e=k.of(this._iid).requestQueue,r=new xA({categoryId:t}),[4,e.send(r)];case 1:return i=a.sent(),[2,i.as(PA).emojiCategory]}})})},n.prototype.getEmoji=function(t){return y(this,void 0,void 0,function(){var e,r,i;return v(this,function(a){switch(a.label){case 0:return e=k.of(this._iid).requestQueue,r=new FA({key:t}),[4,e.send(r)];case 1:return i=a.sent(),[2,i.as(HA).emoji]}})})},n.prototype.getUIKitConfiguration=function(){return y(this,void 0,void 0,function(){var t,e,r,i;return v(this,function(a){switch(a.label){case 0:return t=k.of(this._iid),ne(t.hasExtension("sb_uikit")).throw(H.notSupportedError),e=t.requestQueue,r=new BA,[4,e.send(r)];case 1:return i=a.sent(),[2,i.as(GA).uikitConfiguration]}})})},n.prototype.getReportCategoryInfoList=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,k.of(this._iid).reportCategoryManager.categories()];case 1:return[2,t.sent()]}})})},n}(),Xn;(function(n){n[n.NONE=0]="NONE",n[n.CHANNEL_ENTER=10102]="CHANNEL_ENTER",n[n.CHANNEL_EXIT=10103]="CHANNEL_EXIT",n[n.USER_CHANNEL_MUTE=10201]="USER_CHANNEL_MUTE",n[n.USER_CHANNEL_UNMUTE=10200]="USER_CHANNEL_UNMUTE",n[n.USER_CHANNEL_BAN=10601]="USER_CHANNEL_BAN",n[n.USER_CHANNEL_UNBAN=10600]="USER_CHANNEL_UNBAN",n[n.CHANNEL_FREEZE=10701]="CHANNEL_FREEZE",n[n.CHANNEL_UNFREEZE=10700]="CHANNEL_UNFREEZE",n[n.TYPING_START=10900]="TYPING_START",n[n.TYPING_END=10901]="TYPING_END",n[n.CHANNEL_JOIN=1e4]="CHANNEL_JOIN",n[n.CHANNEL_LEAVE=10001]="CHANNEL_LEAVE",n[n.CHANNEL_OPERATOR_UPDATE=10002]="CHANNEL_OPERATOR_UPDATE",n[n.CHANNEL_INVITE=10020]="CHANNEL_INVITE",n[n.CHANNEL_ACCEPT_INVITE=10021]="CHANNEL_ACCEPT_INVITE",n[n.CHANNEL_DECLINE_INVITE=10022]="CHANNEL_DECLINE_INVITE",n[n.CHANNEL_PROP_CHANGED=11e3]="CHANNEL_PROP_CHANGED",n[n.CHANNEL_DELETED=12e3]="CHANNEL_DELETED",n[n.CHANNEL_META_DATA_CHANGED=11100]="CHANNEL_META_DATA_CHANGED",n[n.CHANNEL_META_COUNTERS_CHANGED=11200]="CHANNEL_META_COUNTERS_CHANGED",n[n.CHANNEL_HIDE=13e3]="CHANNEL_HIDE",n[n.CHANNEL_UNHIDE=13001]="CHANNEL_UNHIDE",n[n.PINNED_MESSAGE_CHANGED=11300]="PINNED_MESSAGE_CHANGED"})(Xn||(Xn={}));var VA=function(){function n(t){var e;this.channelUrl=t.channel_url,this.channelType=t.channel_type,this.category=t.cat,this.data=(e=t.data)!==null&&e!==void 0?e:{},this.ts=t.ts}return Object.defineProperty(n.prototype,"isGroupChannelEvent",{get:function(){return this.channelType===wn.GROUP},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isOpenChannelEvent",{get:function(){return this.channelType===wn.OPEN},enumerable:!1,configurable:!0}),n}(),Na=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.event=new VA(i),a}return w(t,n),t}(ft),Xb=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this,s=i.data.operators,u=s===void 0?[]:s;return a.operators=u.map(function(o){return new Mn(a._iid,o)}),a}return w(t,n),t}(Na),Zb=function(n){function t(e,r,i){var a,s=this;return(s=n.call(this,e,"SYEV",i)||this).pinnedMessageIds=[],s.latestPinnedMessage=null,s.ts=0,i.data&&(s.pinnedMessageIds=(a=i.data.pinned_message_ids)!==null&&a!==void 0?a:[],s.latestPinnedMessage=i.data.latest_pinned_message?dr(e,D({},i.data.latest_pinned_message)):null),s.ts=i.ts,s}return w(t,n),t}(ft),Jb=function(n){function t(e,r){var i=n.call(this,e)||this;return i._logger=r.logger,i._sdkState=r.sdkState,i._sessionManager=r.sessionManager,i._requestQueue=r.requestQueue,i._dispatcher=r.dispatcher,i._cacheContext=r.cacheContext,i._channelType=r.channelType,i}return w(t,n),Object.defineProperty(t.prototype,"_messageBroadcast",{get:function(){return Gb.of(this._iid)},enumerable:!1,configurable:!0}),t.prototype.subscribeMessageEvent=function(e,r){this._messageBroadcast.subscribe(e,r)},t.prototype.unsubscribeMessageEvent=function(e){this._messageBroadcast.unsubscribe(e)},t.prototype.getMessageFromCache=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2,null]})})},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,r,i){return y(this,void 0,void 0,function(){return v(this,function(a){return[2,[]]})})},t.prototype.getMessagesFromCache=function(e,r,i,a,s,u){return y(this,void 0,void 0,function(){return v(this,function(o){return[2,[]]})})},t.prototype.getPollMessagesFromCache=function(e,r,i,a){return y(this,void 0,void 0,function(){return v(this,function(s){return[2,[]]})})},t.prototype.getCachedMessageCountBetween=function(e,r,i,a){return y(this,void 0,void 0,function(){return v(this,function(s){return[2,0]})})},t.prototype.getUnsentMessagesFromCache=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){return[2,[]]})})},t.prototype.removeFailedMessageFromCache=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2]})})},t}(Vt),eC=function(n){function t(e,r,i){var a,s,u,o,l=this;(l=n.call(this,e,"ADMM",i)||this).message=new ks(e,i);var d=k.of(e).sdkState;return l.isMentioned=_u(l.message.mentionType,(u=(a=l.message.mentionedUserIds)!==null&&a!==void 0?a:(s=l.message.mentionedUsers)===null||s===void 0?void 0:s.map(function(c){return c.userId}))!==null&&u!==void 0?u:[],d.userId),l.forceUpdateLastMessage=(o=i.force_update_last_message)!==null&&o!==void 0&&o,l}return w(t,n),t}(ft),nC=function(n){function t(e,r,i){var a,s,u,o,l,d=this;(d=n.call(this,e,"AEDI",i)||this).message=new ks(e,i);var c=k.of(e).sdkState;return d.mentionCountChange=yp({mentionType:(a=i.old_values)===null||a===void 0?void 0:a.mention_type,mentionedUserIds:(u=(s=i.old_values)===null||s===void 0?void 0:s.mentioned_user_ids)!==null&&u!==void 0?u:[]},Re({mentionType:d.message.mentionType,mentionedUserIds:(o=d.message.mentionedUserIds)!==null&&o!==void 0?o:(l=d.message.mentionedUsers)===null||l===void 0?void 0:l.map(function(f){return f.userId})}),c.userId),d}return w(t,n),t}(ft),tC=function(n){function t(e,r,i){var a=n.call(this,e,"MRCT",i)||this;return a.channelUrl=i.channel_url,a.channelType=i.channel_type,a.event=new Rp(i),a}return w(t,n),t}(ft),rC=function(n){function t(e,r,i){var a=n.call(this,e,"MTHD",i)||this;return a.event=new Vb(e,i),a}return w(t,n),t}(ft),iC=function(n){function t(e,r,i){var a=n.call(this,e,"MCNT",i)||this;return a.groupChannelMemberCounts=i.group_channels.map(function(s){return{channelUrl:s.channel_url,memberCount:s.member_count,joinedMemberCount:s.joined_member_count,updatedAt:s.ts}}),a.openChannelMemberCounts=i.open_channels.map(function(s){return{channelUrl:s.channel_url,participantCount:s.participant_count,updatedAt:s.ts}}),a}return w(t,n),t}(ft),aC=function(n){function t(e,r,i){var a=n.call(this,e,"PEDI",i)||this;return a.event=new B2(e,i),a.status=wf(i.poll.status)||i.poll.status,a.channelUrl=i.channel_url,a.channelType=i.channel_type,a}return w(t,n),t}(ft),Rt;(function(n){n.NONE="none",n.JOINED="joined",n.INVITED="invited",n.LEFT="left"})(Rt||(Rt={}));var Yi,Dr,Ur,Ya,Mi,Cd,Ea,ko,ai=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.state=null,i.role=null,i.isMuted=!1,i.isBlockedByMe=!1,i.isBlockingMe=!1,i.state=_n(Rt,r.state)?r.state:null,i.role=_n(ui,r.role)?r.role:null,typeof r.is_muted=="boolean"&&(i.isMuted=r.is_muted),typeof r.is_blocked_by_me=="boolean"&&(i.isBlockedByMe=r.is_blocked_by_me),typeof r.is_blocking_me=="boolean"&&(i.isBlockingMe=r.is_blocking_me),i}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{state:e.state,role:e.role,is_muted:e.isMuted,is_blocked_by_me:e.isBlockedByMe,is_blocking_me:e.isBlockingMe})))},t}(qs),jA=function(n){function t(e,r){var i,a,s=this;return(s=n.call(this,e)||this).channelUrl=(i=r.channel_url)!==null&&i!==void 0?i:"",s.channelType=(a=r.channel_type)!==null&&a!==void 0?a:wn.GROUP,s.member=new Mn(s._iid,r.user),s.deliveryAt=r.ts,s}return w(t,n),t}(Vt);(function(n){n.ALL="all",n.PUBLIC="public",n.PRIVATE="private"})(Yi||(Yi={})),function(n){n.ALL="all",n.JOINED="joined_only",n.INVITED="invited_only",n.INVITED_BY_FRIEND="invited_by_friend",n.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Dr||(Dr={})),function(n){n.ALL="all",n.SUPER="super",n.NON_SUPER="nonsuper",n.BROADCAST_ONLY="broadcast_only",n.EXCLUSIVE_ONLY="exclusive_only"}(Ur||(Ur={})),function(n){n.ALL="all",n.UNREAD_MESSAGE="unread_message"}(Ya||(Ya={})),function(n){n.ALL="all",n.UNHIDDEN="unhidden_only",n.HIDDEN="hidden_only",n.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",n.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Mi||(Mi={})),function(n){n.ALL="all",n.OPERATOR="operator",n.NONOPERATOR="nonoperator"}(Cd||(Cd={})),function(n){n.AND="AND",n.OR="OR"}(Ea||(Ea={})),function(n){n.MEMBER_NICKNAME="member_nickname",n.CHANNEL_NAME="channel_name"}(ko||(ko={}));var yt,sC=function(){function n(t){var e,r,i,a,s,u,o,l,d,c,f,h,m,_,E;this._searchFilter=null,this._userIdsFilter=null,this.includeEmpty=(e=t==null?void 0:t.includeEmpty)!==null&&e!==void 0&&e,this.nicknameContainsFilter=(r=t==null?void 0:t.nicknameContainsFilter)!==null&&r!==void 0?r:null,this.nicknameStartsWithFilter=(i=t==null?void 0:t.nicknameStartsWithFilter)!==null&&i!==void 0?i:null,this.nicknameExactMatchFilter=(a=t==null?void 0:t.nicknameExactMatchFilter)!==null&&a!==void 0?a:null,this.channelNameContainsFilter=(s=t==null?void 0:t.channelNameContainsFilter)!==null&&s!==void 0?s:"",this.myMemberStateFilter=(u=t==null?void 0:t.myMemberStateFilter)!==null&&u!==void 0?u:Dr.ALL,this.customTypesFilter=(o=t==null?void 0:t.customTypesFilter)!==null&&o!==void 0?o:null,this.channelUrlsFilter=(l=t==null?void 0:t.channelUrlsFilter)!==null&&l!==void 0?l:null,this.superChannelFilter=(d=t==null?void 0:t.superChannelFilter)!==null&&d!==void 0?d:Ur.ALL,this.publicChannelFilter=(c=t==null?void 0:t.publicChannelFilter)!==null&&c!==void 0?c:Yi.ALL,this.customTypeStartsWithFilter=(f=t==null?void 0:t.customTypeStartsWithFilter)!==null&&f!==void 0?f:null,this.unreadChannelFilter=(h=t==null?void 0:t.unreadChannelFilter)!==null&&h!==void 0?h:Ya.ALL,this.hiddenChannelFilter=(m=t==null?void 0:t.hiddenChannelFilter)!==null&&m!==void 0?m:Mi.UNHIDDEN,this.includeFrozen=(_=t==null?void 0:t.includeFrozen)===null||_===void 0||_,t!=null&&t.createdAfter&&(this.createdAfter=t.createdAfter),t!=null&&t.createdBefore&&(this.createdBefore=t.createdBefore),this.includeMetaData=(E=t==null?void 0:t.includeMetaData)===null||E===void 0||E}return n.prototype._isFriend=function(t){return!(!t||!t.friendDiscoveryKey&&!t.friendName)},Object.defineProperty(n.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),n.prototype.setSearchFilter=function(t,e){Array.isArray(t)&&t.length!==0&&typeof e=="string"&&e&&(this._searchFilter={query:e,fields:t})},Object.defineProperty(n.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),n.prototype.setUserIdsFilter=function(t,e,r){r===void 0&&(r=Ea.AND),this._userIdsFilter={userIds:t,includeMode:e,queryType:r}},n.prototype.clone=function(){var t,e=new n;this.searchFilter&&e.setSearchFilter(this.searchFilter.fields,(t=this.searchFilter.query)!==null&&t!==void 0?t:void 0),this.userIdsFilter&&e.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var r=JSON.parse(JSON.stringify(this));return Object.keys(r).forEach(function(i){e[i]=r[i]}),e},n.prototype.match=function(t,e){if(this._searchFilter){var r=this._searchFilter,i=r.query,a=r.fields;if(i&&a&&a.length>0&&!a.some(function(m){switch(m){case ko.CHANNEL_NAME:return t.name.toLowerCase().includes(i.toLowerCase());case ko.MEMBER_NICKNAME:return t.members.some(function(_){return _.nickname.toLowerCase().includes(i.toLowerCase())});default:return!0}}))return!1}if(this._userIdsFilter){var s=this._userIdsFilter,u=s.userIds,o=s.includeMode,l=s.queryType,d=t.members.map(function(m){return m.userId});if(o){if(u.length>0)switch(l){case Ea.AND:if(u.some(function(m){return!d.includes(m)}))return!1;break;case Ea.OR:if(u.every(function(m){return!d.includes(m)}))return!1}}else if(u.includes(e)||u.push(e),t.members.length>u.length||!JS(u,d))return!1}if(!this.includeEmpty&&!t.lastMessage||!this.includeFrozen&&t.isFrozen||this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(t.customType)||this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(t.customType)||this.channelNameContainsFilter&&!t.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var c=this.nicknameContainsFilter.toLowerCase();if(!t.members.some(function(m){return m.userId!==e&&m.nickname.toLowerCase().includes(c)}))return!1}if(this.nicknameStartsWithFilter){var f=this.nicknameStartsWithFilter.toLowerCase();if(!t.members.some(function(m){return m.userId!==e&&m.nickname.toLowerCase().startsWith(f)}))return!1}if(this.nicknameExactMatchFilter){var h=this.nicknameExactMatchFilter.toLowerCase();if(!t.members.some(function(m){return m.userId!==e&&m.nickname.toLowerCase()!=h}))return!1}if(this.channelUrlsFilter&&this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(t.url))return!1;if(this.myMemberStateFilter)switch(this.myMemberStateFilter){case Dr.ALL:if(t.myMemberState==="none")return!1;break;case Dr.JOINED:if(t.myMemberState!=="joined")return!1;break;case Dr.INVITED:if(t.myMemberState!=="invited")return!1;break;case Dr.INVITED_BY_FRIEND:if(t.myMemberState!=="invited"||!this._isFriend(t.inviter))return!1;break;case Dr.INVITED_BY_NON_FRIEND:if(t.myMemberState!=="invited"||this._isFriend(t.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case Mi.UNHIDDEN:if(t.isHidden||t.hiddenState!=="unhidden")return!1;break;case Mi.HIDDEN:if(!t.isHidden)return!1;break;case Mi.HIDDEN_ALLOW_AUTO_UNHIDE:if(!t.isHidden||t.hiddenState!=="hidden_allow_auto_unhide")return!1;break;case Mi.HIDDEN_PREVENT_AUTO_UNHIDE:if(!t.isHidden||t.hiddenState!=="hidden_prevent_auto_unhide")return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===Ya.UNREAD_MESSAGE&&t.unreadMessageCount===0)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case Yi.PUBLIC:if(!t.isPublic)return!1;break;case Yi.PRIVATE:if(t.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case Ur.SUPER:if(!t.isSuper)return!1;break;case Ur.NON_SUPER:if(t.isSuper)return!1}return!(this.createdAfter&&t.createdAt<this.createdAfter)&&!(this.createdBefore&&t.createdAt>this.createdBefore)},n}(),qA=function(n){function t(e,r){var i=r.sdkState,a=r.cacheContext,s=n.call(this,e)||this;return s._channels=new Map,s._sdkState=i,s._cacheContext=a,s}return w(t,n),Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return ne(!!e).throw(H.databaseError),e.collection(xb)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e,r){return r===void 0&&(r=0),D(D({},e.serialize()),{lastMessageUpdatedAt:e.lastMessage?e.lastMessage.createdAt:0,syncIndex:r})},t.prototype._deserialize=function(e){return Yt.of(this._iid).buildGroupChannelFromSerializedData(e)},Object.defineProperty(t.prototype,"channels",{get:function(){return Be([],we(this._channels.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.isCachedInMemory=function(e){return this._channels.has(e)},t.prototype.filterOffsetChanged=function(e){var r=this;return e.filter(function(i){if(r._channels.has(i.url))return r._channels.get(i.url).messageOffsetTimestamp<i.messageOffsetTimestamp})},t.prototype.get=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:return this._channels.has(e)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(r=a.sent())return i=this._deserialize(r),this._channels.set(e,i),[2,i];a.label=2;case 2:return[2,void 0];case 3:return[2,this._channels.get(e)]}})})},t.prototype.fetch=function(e){var r=e.token,i=e.limit,a=i===void 0?kb:i,s=e.backward,u=s!==void 0&&s,o=e.filter,l=o===void 0?new sC:o,d=e.order,c=d===void 0?Et.LATEST_LAST_MESSAGE:d,f=e.borderlineChannelUrl;return y(this,void 0,void 0,function(){var h,m,_,E,b,g=this;return v(this,function(C){switch(C.label){case 0:return this.localCacheEnabled?(h=!!f,m=jl(c),_={where:function(S){if(r)switch(c){case Et.CHANNEL_NAME_ALPHABETICAL:if(!u&&S.name.localeCompare(r)<0||u&&S.name.localeCompare(r)>0)return!1;break;case Et.CHRONOLOGICAL:if(!u&&S.createdAt>r||u&&S.createdAt<r)return!1;break;case Et.LATEST_LAST_MESSAGE:if(!u&&S.lastMessageUpdatedAt>r||u&&S.lastMessageUpdatedAt<r)return!1}return h&&f&&f===S.url?(h=!1,!1):!h&&l.match(g._deserialize(S),g._sdkState.userId)},index:m,backward:u},[4,this.collection.query(_)]):[3,3];case 1:return[4,C.sent().fetch({limit:a})];case 2:return E=C.sent(),(b=E.map(function(S){return g._deserialize(S)})).forEach(function(S){!l.includeMetaData&&S.cachedMetaData&&S._clearCachedMetaData(),g._channels.has(S.url)||g._channels.set(S.url,S)}),[2,b];case 3:return[2,[]]}})})},t.prototype.upsert=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u=this;return v(this,function(o){switch(o.label){case 0:if(i=[],e.forEach(function(l){if(u._channels.has(l.url)){var d=u._channels.get(l.url);d._pinnedMessagesUpdatedAt<l._pinnedMessagesUpdatedAt&&(d._pinnedMessagesUpdatedAt=l._pinnedMessagesUpdatedAt),d._messageCollectionLastAccessedAt>l._messageCollectionLastAccessedAt&&(l._messageCollectionLastAccessedAt=d._messageCollectionLastAccessedAt),l.cachedMetaData instanceof Map&&l.cachedMetaData.size>0&&r&&(d._updateCachedMetaData(l.cachedMetaData,r).isUpdated||Object.assign(l,{_cachedMetaData:d.cachedMetaData})),d._update(l),i.push(d)}else u._channels.set(l.url,l),i.push(l)}),!this.localCacheEnabled)return[3,2];for(a=[],s=0;s<i.length;s++)a.push(this._serialize(i[s],s));return[4,this.collection.upsertMany(a)];case 1:o.sent(),o.label=2;case 2:return[2,i]}})})},t.prototype.remove=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),r=oe(e),i=r.next(),l.label=1;case 1:return i.done?[3,4]:(a=i.value,this._channels.delete(a),this.localCacheEnabled?[4,this.collection.remove(a)]:[3,3]);case 2:l.sent(),l.label=3;case 3:return i=r.next(),[3,1];case 4:return[3,7];case 5:return s=l.sent(),u={error:s},[3,7];case 6:try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(u)throw u.error}return[7];case 7:return[2]}})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.clearMemoryCache=function(){this._channels.clear()},t.prototype._setBlockStateOfAllChannels=function(e,r,i){return y(this,void 0,void 0,function(){var a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T;return v(this,function(M){switch(M.label){case 0:if(a=[],e===this._sdkState.userId)try{for(s=oe(this._channels.values()),u=s.next();!u.done;u=s.next()){f=u.value;try{for(g=void 0,o=oe(f.members),l=o.next();!l.done;l=o.next())if((_=l.value).userId===r){_.isBlockedByMe=i,a.push(f);break}}catch(O){g={error:O}}finally{try{l&&!l.done&&(C=o.return)&&C.call(o)}finally{if(g)throw g.error}}}}catch(O){E={error:O}}finally{try{u&&!u.done&&(b=s.return)&&b.call(s)}finally{if(E)throw E.error}}else if(r===this._sdkState.userId)try{for(d=oe(this._channels.values()),c=d.next();!c.done;c=d.next()){f=c.value;try{for(I=void 0,h=oe(f.members),m=h.next();!m.done;m=h.next())if((_=m.value).userId===e){_.isBlockingMe=i,a.push(f);break}}catch(O){I={error:O}}finally{try{m&&!m.done&&(T=h.return)&&T.call(h)}finally{if(I)throw I.error}}}}catch(O){S={error:O}}finally{try{c&&!c.done&&(A=d.return)&&A.call(d)}finally{if(S)throw S.error}}return a.length>0?[4,this.upsert(a)]:[3,2];case 1:M.sent(),M.label=2;case 2:return[2]}})})},t.prototype.block=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return[4,this._setBlockStateOfAllChannels(e,r,!0)];case 1:return i.sent(),[2]}})})},t.prototype.unblock=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return[4,this._setBlockStateOfAllChannels(e,r,!1)];case 1:return i.sent(),[2]}})})},t.prototype.markAsRead=function(e,r){return r===void 0&&(r=Be([],we(this._channels.keys()),!1)),y(this,void 0,void 0,function(){var i,a,s,u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:i=[],f.label=1;case 1:f.trys.push([1,6,7,8]),a=oe(r),s=a.next(),f.label=2;case 2:return s.done?[3,5]:(u=s.value,[4,this.get(u)]);case 3:(o=f.sent())!=null&&o._updateUnreadMemberState(this._sdkState.userId,e)&&(o._updateUnreadCount(0,0),i.push(o)),f.label=4;case 4:return s=a.next(),[3,2];case 5:return[3,8];case 6:return l=f.sent(),d={error:l},[3,8];case 7:try{s&&!s.done&&(c=a.return)&&c.call(a)}finally{if(d)throw d.error}return[7];case 8:return i.length>0?[4,this.upsert(i)]:[3,10];case 9:f.sent(),f.label=10;case 10:return[2]}})})},t}(Vt),ql={invitedUserIds:void 0,channelUrl:void 0,coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isSuper:void 0,isBroadcast:void 0,isExclusive:void 0,isPublic:void 0,isDiscoverable:void 0,isStrict:void 0,isEphemeral:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},Bf=function(n){return gn("string",n.invitedUserIds,!0)&&x("string",n.channelUrl,!0)&&x("string",n.coverUrl,!0)&&(Zt(n.coverImage)||x("string",n.coverImage,!0))&&x("boolean",n.isDistinct,!0)&&x("boolean",n.isSuper,!0)&&x("boolean",n.isBroadcast,!0)&&x("boolean",n.isExclusive,!0)&&x("boolean",n.isPublic,!0)&&x("boolean",n.isStrict,!0)&&x("boolean",n.isDiscoverable,!0)&&x("boolean",n.isEphemeral,!0)&&x("string",n.accessCode,!0)&&x("string",n.name,!0)&&x("string",n.data,!0)&&x("string",n.customType,!0)&&gn("string",n.operatorUserIds,!0)&&x("number",n.messageSurvivalSeconds,!0)},Sd={customTypes:void 0,includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,includeChatNotification:!1},Gf=function(n){return gn("string",n.customTypes,!0)&&x("boolean",n.includeEmpty,!0)&&x("boolean",n.includeFrozen,!0)&&x("boolean",n.includeMetaData,!0)&&x("boolean",n.includeChatNotification,!0)},uC={myMemberStateFilter:Dr.ALL},oC=function(n){return _n(Dr,n.myMemberStateFilter)};(function(n){n.GROUP_CHANNEL_UNREAD_MENTION_COUNT="group_channel_unread_mention_count",n.NONSUPER_UNREAD_MENTION_COUNT="non_super_group_channel_unread_mention_count",n.SUPER_UNREAD_MENTION_COUNT="super_group_channel_unread_mention_count",n.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT="group_channel_unread_message_count",n.NONSUPER_UNREAD_MESSAGE_COUNT="non_super_group_channel_unread_message_count",n.SUPER_UNREAD_MESSAGE_COUNT="super_group_channel_unread_message_count",n.GROUP_CHANNEL_INVITATION_COUNT="group_channel_invitation_count",n.NONSUPER_INVITATION_COUNT="non_super_group_channel_invitation_count",n.SUPER_INVITATION_COUNT="super_group_channel_invitation_count"})(yt||(yt={}));var zA={keys:[yt.GROUP_CHANNEL_UNREAD_MENTION_COUNT,yt.NONSUPER_UNREAD_MENTION_COUNT,yt.SUPER_UNREAD_MENTION_COUNT,yt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT,yt.NONSUPER_UNREAD_MESSAGE_COUNT,yt.SUPER_UNREAD_MESSAGE_COUNT,yt.GROUP_CHANNEL_INVITATION_COUNT,yt.NONSUPER_INVITATION_COUNT,yt.SUPER_INVITATION_COUNT],customTypeFilters:void 0,customTypesFilter:void 0},KA={channelCustomTypesFilter:void 0,superChannelFilter:Ur.ALL},$A=function(n){return gn("string",n.channelCustomTypesFilter,!0)&&_n(Ur,n.superChannelFilter)},WA={channelUrl:void 0,scheduledStatus:void 0,messageTypeFilter:ur.ALL};D({},W);var zl=function(n){return n.startsWith("EVENT_")||n===W.SYNC_CHANNEL_CHANGELOGS||n===W.REFRESH_CHANNEL},An=function(n){function t(e){var r=e.channels,i=e.context,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=e.ts,o=n.call(this)||this;return o.channels=r,o.context=i,o.isWebSocketEventComing=s,o.ts=u,o}return w(t,n),t}(bt),sa=function(n){function t(e){var r=e.channelUrls,i=e.context,a=e.isWebSocketEventComing,s=a!==void 0&&a,u=n.call(this)||this;return u.channelUrls=r,u.context=i,u.isWebSocketEventComing=s,u}return w(t,n),t}(bt),YA=function(){function n(t){var e=t.groupChannelCache,r=t.messageCache,i=t.unsentMessageCache,a=t.dispatcher,s=this;this._observers=new Map,a.on(function(u){return y(s,void 0,void 0,function(){var o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R=this;return v(this,function(U){switch(U.label){case 0:if(!(u instanceof An))return[3,19];if(o=u.channels,S=u.context,A=u.isWebSocketEventComing,l=o.filter(function(P){return P instanceof ci}),S.source!==W.EVENT_CHANNEL_RESET_HISTORY&&S.source!==W.EVENT_CHANNEL_HIDDEN)return[3,9];U.label=1;case 1:U.trys.push([1,6,7,8]),d=oe(l),c=d.next(),U.label=2;case 2:return c.done?[3,5]:(E=c.value,[4,r.removeUnderOffset(E.url,E.messageOffsetTimestamp)]);case 3:U.sent(),U.label=4;case 4:return c=d.next(),[3,2];case 5:return[3,8];case 6:return f=U.sent(),I={error:f},[3,8];case 7:try{c&&!c.done&&(T=d.return)&&T.call(d)}finally{if(I)throw I.error}return[7];case 8:return[3,17];case 9:h=e.filterOffsetChanged(l),U.label=10;case 10:U.trys.push([10,15,16,17]),m=oe(h),_=m.next(),U.label=11;case 11:return _.done?[3,14]:(E=_.value,[4,r.removeUnderOffset(E.url,E.messageOffsetTimestamp)]);case 12:U.sent(),U.label=13;case 13:return _=m.next(),[3,11];case 14:return[3,17];case 15:return b=U.sent(),M={error:b},[3,17];case 16:try{_&&!_.done&&(O=m.return)&&O.call(m)}finally{if(M)throw M.error}return[7];case 17:return[4,e.upsert(l,u.ts)];case 18:return g=U.sent(),A||this._broadcastUpdateEvent(g,S),[3,24];case 19:return u instanceof sa?(C=u.channelUrls,S=u.context,A=u.isWebSocketEventComing,[4,e.remove(C)]):[3,22];case 20:return U.sent(),[4,Lt(function(){return y(R,void 0,void 0,function(){var P,L,F,B,V,K;return v(this,function($){switch($.label){case 0:$.trys.push([0,6,7,8]),P=oe(C),L=P.next(),$.label=1;case 1:return L.done?[3,5]:(F=L.value,[4,r.removeMessagesOfChannel(F)]);case 2:return $.sent(),[4,i.removeMessagesOfChannel(F)];case 3:$.sent(),$.label=4;case 4:return L=P.next(),[3,1];case 5:return[3,8];case 6:return B=$.sent(),V={error:B},[3,8];case 7:try{L&&!L.done&&(K=P.return)&&K.call(P)}finally{if(V)throw V.error}return[7];case 8:return[2]}})})})];case 21:return U.sent(),A||this._broadcastRemoveEvent(C,S),[3,24];case 22:return u instanceof qb?[4,e.fetch({token:Number.MAX_SAFE_INTEGER,limit:Number.MAX_SAFE_INTEGER})]:[3,24];case 23:U.sent(),U.label=24;case 24:return[2]}})})})}return n.prototype._broadcastUpdateEvent=function(t,e){var r,i;try{for(var a=oe(this._observers.values()),s=a.next();!s.done;s=a.next()){var u=s.value;u.onUpdate&&u.onUpdate(t,e)}}catch(o){r={error:o}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},n.prototype._broadcastRemoveEvent=function(t,e){var r,i;try{for(var a=oe(this._observers.values()),s=a.next();!s.done;s=a.next()){var u=s.value;u.onRemove&&u.onRemove(t,e)}}catch(o){r={error:o}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},n.prototype.subscribe=function(t,e){this._observers.set(t,e)},n.prototype.unsubscribe=function(t){this._observers.delete(t)},n.prototype.unsubscribeAll=function(){this._observers.clear()},n}(),QA=function(n){function t(e){var r=e.userId,i=e.ts,a=e.token,s=e.filter,u=e.includeChatNotification,o=u!==void 0&&u,l=n.call(this)||this,d=D(D({},Sd),s),c=d.customTypes,f=d.includeEmpty,h=d.includeFrozen;return l.method=J.GET,l.path="".concat(qn,"/").concat(encodeURIComponent(r),"/my_group_channels/changelogs"),l.params=ge(Re({show_delivery_receipt:!0,show_member:!0,show_read_receipt:!0,change_ts:i||null,token:a,custom_types:c,show_empty:f,show_frozen:h,include_chat_notification:o})),l}return w(t,n),t}(ee),XA=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.updatedChannels=r.updated.map(function(a){return new ci(e,Object.assign(a,{ts:r.ts}))}),i.deletedChannelUrls=r.deleted,i.hasMore=r.has_more,i.token=r.next,i.ts=r.ts,i}return w(t,n),t}(ie),Vf=function(n){function t(e){var r=e.channelUrl,i=e.isInternalCall,a=e.showLatestMessage,s=n.call(this)||this;return s.method=J.GET,s.path="".concat(i?sT:yr,"/").concat(encodeURIComponent(r)),s.params={show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_latest_message:a!=null&&a},s}return w(t,n),t}(ee),jf=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new ci(e,r),i}return w(t,n),t}(ie),Xs={includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,includeChatNotification:!1,channelUrlsFilter:void 0,customTypesFilter:void 0,customTypeStartsWithFilter:void 0,nicknameContainsFilter:void 0,nicknameStartsWithFilter:void 0,nicknameExactMatchFilter:void 0,channelNameContainsFilter:void 0,myMemberStateFilter:Dr.ALL,unreadChannelFilter:Ya.ALL,superChannelFilter:Ur.ALL,publicChannelFilter:Yi.ALL,hiddenChannelFilter:Mi.ALL,userIdsFilter:{userIds:[],includeMode:!0,queryType:Ea.AND},searchFilter:{query:void 0,fields:[]},metadataKey:void 0,metadataValues:void 0,metadataOrderKeyFilter:void 0,metadataValueStartsWith:void 0,order:Et.LATEST_LAST_MESSAGE,createdAfter:void 0,createdBefore:void 0},ZA=function(n){function t(e){var r=this,i=e.userId,a=e.token,s=e.limit,u=e.order,o=e.includeEmpty,l=e.myMemberStateFilter,d=e.superChannelFilter,c=e.publicChannelFilter,f=e.unreadChannelFilter,h=e.nicknameContainsFilter,m=e.nicknameStartsWithFilter,_=e.nicknameExactMatchFilter,E=e.channelNameContainsFilter,b=e.channelUrlsFilter,g=e.customTypesFilter,C=e.customTypeStartsWithFilter,S=e.hiddenChannelFilter,A=e.metadataOrderKeyFilter,I=e.metadataKey,T=e.metadataValues,M=e.metadataValueStartsWith,O=e.includeFrozen,R=e.includeMetaData,U=e.searchFilter,P=e.userIdsFilter,L=e.includeChatNotification,F=L!==void 0&&L,B=e.includeLeftChannel,V=B!==void 0&&B,K=e.createdAfter,$=e.createdBefore;return(r=n.call(this)||this).method=J.GET,r.path="".concat(qn,"/").concat(encodeURIComponent(i),"/my_group_channels"),r.params=ge({token:a,limit:s,order:u??Xs.order,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:o??Xs.includeEmpty,member_state_filter:l??Xs.myMemberStateFilter,super_mode:d??Xs.superChannelFilter,public_mode:c??Xs.publicChannelFilter,unread_filter:f??Xs.unreadChannelFilter,members_nickname_contains:h,members_nickname_startswith:m,members_nickname:_,name_contains:E,channel_urls:b,custom_types:g,custom_type_startswith:C,hidden_mode:S,metadata_order_key:A,metadata_key:I,metadata_values:T,metadata_value_startswith:M,show_frozen:O,show_metadata:R,include_chat_notification:F,include_left_channel:V,created_after:K,created_before:$}),U&&U.query&&U.fields&&(r.params.search_query=U.query,r.params.search_fields=U.fields),P&&P.userIds&&P.userIds.length>0&&(P.includeMode?(r.params.members_include_in=P.userIds,r.params.query_type=P.queryType.toUpperCase()):r.params.members_exactly_in=P.userIds),r}return w(t,n),t}(ee),JA=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.channels=[];var a=r.next,s=r.channels,u=r.ts;return i.token=a,s&&s.length>0&&(i.channels=s.map(function(o){return o.ts=u,new ci(e,o)})),i.ts=u??0,i}return w(t,n),t}(ie),eM=function(n){function t(e){var r=e.userId,i=e.filter,a=n.call(this)||this,s=i.myMemberStateFilter;return a.method=J.GET,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/group_channel_count"),a.params={state:s??Dr.ALL},a}return w(t,n),t}(ee),nM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.groupChannelCount=r.group_channel_count,i}return w(t,n),t}(ie),tM=function(n){function t(e){var r=e.userId,i=e.filter,a=n.call(this)||this,s=i.keys,u=i.customTypeFilters,o=i.customTypesFilter;return a.method=J.GET,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/unread_item_count"),a.params=ge({item_keys:s,custom_types:o??u}),a}return w(t,n),t}(ee),rM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return typeof r[yt.GROUP_CHANNEL_UNREAD_MENTION_COUNT]=="number"&&(i.groupChannelUnreadMentionCount=r[yt.GROUP_CHANNEL_UNREAD_MENTION_COUNT]),typeof r[yt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]=="number"&&(i.groupChannelUnreadMessageCount=r[yt.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]),typeof r[yt.GROUP_CHANNEL_INVITATION_COUNT]=="number"&&(i.groupChannelInvitationCount=r[yt.GROUP_CHANNEL_INVITATION_COUNT]),typeof r[yt.SUPER_UNREAD_MENTION_COUNT]=="number"&&(i.superGroupChannelUnreadMentionCount=r[yt.SUPER_UNREAD_MENTION_COUNT]),typeof r[yt.SUPER_UNREAD_MESSAGE_COUNT]=="number"&&(i.superGroupChannelUnreadMessageCount=r[yt.SUPER_UNREAD_MESSAGE_COUNT]),typeof r[yt.SUPER_INVITATION_COUNT]=="number"&&(i.superGroupChannelInvitationCount=r[yt.SUPER_INVITATION_COUNT]),typeof r[yt.NONSUPER_UNREAD_MENTION_COUNT]=="number"&&(i.nonSuperGroupChannelUnreadMentionCount=r[yt.NONSUPER_UNREAD_MENTION_COUNT]),typeof r[yt.NONSUPER_UNREAD_MESSAGE_COUNT]=="number"&&(i.nonSuperGroupChannelUnreadMessageCount=r[yt.NONSUPER_UNREAD_MESSAGE_COUNT]),typeof r[yt.NONSUPER_INVITATION_COUNT]=="number"&&(i.nonSuperGroupChannelInvitationCount=r[yt.NONSUPER_INVITATION_COUNT]),i}return w(t,n),t}(ie),iM=function(n){function t(e){var r=e.userId,i=n.call(this)||this;return i.method=J.GET,i.path="".concat(qn,"/").concat(encodeURIComponent(r),"/unread_channel_count"),i}return w(t,n),t}(ee),aM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.unreadCount=r.unread_count,i}return w(t,n),t}(ie),sM=function(n){function t(e){var r=e.userId,i=e.filter,a=e.includeFeedChannel,s=a!==void 0&&a,u=n.call(this)||this,o=i.channelCustomTypesFilter,l=i.superChannelFilter;return u.method=J.GET,u.path="".concat(qn,"/").concat(encodeURIComponent(r),"/unread_message_count"),u.params={super_mode:l??Ur.ALL,custom_types:o,include_feed_channel:s},u}return w(t,n),t}(ee),uM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.unreadCount=r.unread_count,i.unreadFeedCount=r.unread_feed_count,i}return w(t,n),t}(ie),oM=function(n){function t(e){var r=e.channelUrl,i=e.scheduledStatus,a=e.messageTypeFilter,s=n.call(this)||this;return s.method=J.GET,s.path="".concat(yy,"/count"),s.params={channel_url:r,status:dM(i)},a&&(s.params.message_type=a),s}return w(t,n),t}(ee),lM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.count=r.count,i}return w(t,n),t}(ie),dM=function(n){if(!n)return[];var t=[];return n.forEach(function(e){switch(e){case Ha.PENDING:t.push(ii.PENDING);break;case Ha.SENT:t.push(ii.IN_QUEUE),t.push(ii.SENT);break;case Ha.CANCELED:t.push(ii.CANCELED);break;case Ha.FAILED:t.push(ii.FAILED)}}),t},cM=function(n){function t(e){var r=this,i=e.userId,a=e.channelUrl,s=e.coverUrl,u=e.coverImage,o=e.isDistinct,l=e.isSuper,d=e.isBroadcast,c=e.isPublic,f=e.isExclusive,h=e.isDiscoverable,m=e.isStrict,_=e.isEphemeral,E=e.accessCode,b=e.name,g=e.data,C=e.customType,S=e.messageSurvivalSeconds,A=e.invitedUserIds,I=e.operatorUserIds;return(r=n.call(this)||this).method=J.POST,r.path=yr,r.params=ge({user_ids:Be([i],we(A??[]),!1).filter(function(T,M,O){return M===O.indexOf(T)}),channel_url:a,cover_url:s,cover_file:u,is_distinct:o,is_super:l,is_broadcast:d,is_exclusive:f,is_public:c,is_discoverable:h,strict:m,is_ephemeral:_,access_code:E,name:b,data:g,custom_type:C,operator_ids:I,message_survival_seconds:S}),r}return w(t,n),t}(ee),fM=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this).channel=new ci(e,r),a.isCreated=(i=r.is_created)===null||i===void 0||i,a}return w(t,n),t}(ie),rg=function(n){function t(e){var r=e.userId,i=e.channelUrls,a=n.call(this)||this;return a.method=J.PUT,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/mark_as_read_all"),a.params={channel_urls:i},a}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var hM=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId,s=e.accessCode;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/join"),r.params={user_id:a,access_code:s},r}return w(t,n),t}(ee),pM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new ci(e,r),i}return w(t,n),t}(ie),mM=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this,s=i.data,u=s.member_count,o=u===void 0?0:u,l=s.joined_member_count,d=l===void 0?0:l,c=s.users,f=c===void 0?null:c;return a.memberCount=o,a.joinedMemberCount=d,a.members=Array.isArray(f)?f.map(function(h){return new ai(e,h)}):[new ai(e,i.data)],a}return w(t,n),t}(Na),_M=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId,s=e.shouldRemoveOperatorStatus;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/leave"),r.params={user_id:a,should_remove_operator_status:s},r}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var gM=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this,s=i.data,u=s.member_count,o=u===void 0?0:u,l=s.joined_member_count,d=l===void 0?0:l;return a.memberCount=o,a.joinedMemberCount=d,a.member=new ai(a._iid,i.data),a}return w(t,n),t}(Na),EM=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userIds;return(r=n.call(this)||this).method=J.POST,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/invite"),r.params={user_ids:a},r}return w(t,n),t}(ee),vM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new ci(e,r),i}return w(t,n),t}(ie),yM=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this;a.inviter=null;var s=i.data,u=s.member_count,o=u===void 0?0:u,l=s.joined_member_count,d=l===void 0?0:l,c=s.inviter,f=s.invitees,h=f===void 0?[]:f;return a.memberCount=o,a.joinedMemberCount=d,c&&Object.keys(c).length>0&&(a.inviter=new Mn(e,c)),a.invitees=h.map(function(m){return new ai(e,m)}),a}return w(t,n),t}(Na),bM=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/decline"),r.params={user_id:a},r}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new ci(e,r),i.channel.myMemberState=Rt.NONE,i}w(t,n)})(ie);var CM=function(n){function t(e,r,i){var a=n.call(this,e,r,i)||this,s=i.data,u=s.member_count,o=s.joined_member_count,l=s.inviter,d=s.invitee;return a.memberCount=u??0,a.joinedMemberCount=o??0,a.inviter=new Mn(e,l),a.invitee=new ai(e,d),a}return w(t,n),t}(Na),qf={hidePreviousMessages:!1,allowAutoUnhide:!0},SM=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId,s=e.hidePreviousMessages,u=e.allowAutoUnhide;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/hide"),r.params={user_id:a,hide_previous_messages:s??qf.hidePreviousMessages,allow_auto_unhide:u??qf.allowAutoUnhide},r}return w(t,n),t}(ee),TM=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.ts_message_offset;return i.messageOffsetTimestamp=a,i}return w(t,n),t}(ie),NM=function(n){function t(e,r,i){var a,s,u,o=this;return(o=n.call(this,e,"SYEV",i)||this).allowAutoUnhide=null,o.hidePreviousMessages=null,o.messageOffsetTimestamp=null,i.data&&(o.allowAutoUnhide=(a=i.data.allow_auto_unhide)!==null&&a!==void 0?a:null,o.hidePreviousMessages=(s=i.data.hide_previous_messages)!==null&&s!==void 0?s:null),o.messageOffsetTimestamp=(u=i.ts_message_offset)!==null&&u!==void 0?u:null,o}return w(t,n),t}(ft),IM=function(n){function t(e){var r=e.channelUrl,i=e.time;return n.call(this,{code:"TPST",ackRequired:!1,payload:{channel_url:r,time:i}})||this}return w(t,n),t}(or),AM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new Mn(e,i.data),a}return w(t,n),t}(ft),MM=function(n){function t(e){var r=e.channelUrl,i=e.time;return n.call(this,{code:"TPEN",ackRequired:!1,payload:{channel_url:r,time:i}})||this}return w(t,n),t}(or),wM=function(n){function t(e,r,i){var a=n.call(this,e,"SYEV",i)||this;return a.user=new Mn(e,i.data),a}return w(t,n),t}(ft),OM=function(n){function t(e){var r=e.channelUrl,i=e.messageId;return n.call(this,{code:"MACK",ackRequired:!1,payload:{channel_url:r,msg_id:i}})||this}return w(t,n),t}(or),lC=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R,U=this;return(U=n.call(this,e,r)||this).includeEmpty=!1,U.includeFrozen=!0,U.includeMetaData=!0,U.includeChatNotification=!1,U.channelUrlsFilter=null,U.customTypesFilter=null,U.customTypeStartsWithFilter=null,U.nicknameContainsFilter=null,U.nicknameStartsWithFilter=null,U.nicknameExactMatchFilter=null,U.channelNameContainsFilter="",U.myMemberStateFilter=Dr.ALL,U.unreadChannelFilter=Ya.ALL,U.superChannelFilter=Ur.ALL,U.publicChannelFilter=Yi.ALL,U.hiddenChannelFilter=Mi.UNHIDDEN,U.searchFilter={fields:[],query:null},U.userIdsFilter={userIds:[],includeMode:!0,queryType:Ea.AND},U.metadataKey=null,U.metadataValues=null,U.metadataOrderKeyFilter=null,U.metadataValueStartsWith=null,U.order=Et.LATEST_LAST_MESSAGE,U.includeEmpty=(i=r.includeEmpty)!==null&&i!==void 0&&i,U.includeFrozen=(a=r.includeFrozen)===null||a===void 0||a,U.includeMetaData=(s=r.includeMetaData)===null||s===void 0||s,U.includeChatNotification=(u=r.includeChatNotification)!==null&&u!==void 0&&u,U.channelUrlsFilter=(o=r.channelUrlsFilter)!==null&&o!==void 0?o:null,U.customTypesFilter=(l=r.customTypesFilter)!==null&&l!==void 0?l:null,U.customTypeStartsWithFilter=(d=r.customTypeStartsWithFilter)!==null&&d!==void 0?d:"",U.nicknameContainsFilter=(c=r.nicknameContainsFilter)!==null&&c!==void 0?c:null,U.nicknameStartsWithFilter=(f=r.nicknameStartsWithFilter)!==null&&f!==void 0?f:null,U.nicknameExactMatchFilter=(h=r.nicknameExactMatchFilter)!==null&&h!==void 0?h:null,U.channelNameContainsFilter=(m=r.channelNameContainsFilter)!==null&&m!==void 0?m:"",U.myMemberStateFilter=(_=r.myMemberStateFilter)!==null&&_!==void 0?_:Dr.ALL,U.unreadChannelFilter=(E=r.unreadChannelFilter)!==null&&E!==void 0?E:Ya.ALL,U.superChannelFilter=(b=r.superChannelFilter)!==null&&b!==void 0?b:Ur.ALL,U.publicChannelFilter=(g=r.publicChannelFilter)!==null&&g!==void 0?g:Yi.ALL,U.hiddenChannelFilter=(C=r.hiddenChannelFilter)!==null&&C!==void 0?C:Mi.UNHIDDEN,U.searchFilter=(S=r.searchFilter)!==null&&S!==void 0?S:{fields:[],query:null},U.userIdsFilter=(A=r.userIdsFilter)!==null&&A!==void 0?A:{userIds:[],includeMode:!0,queryType:Ea.AND},U.metadataKey=(I=r.metadataKey)!==null&&I!==void 0?I:null,U.metadataValues=(T=r.metadataValues)!==null&&T!==void 0?T:null,U.metadataOrderKeyFilter=(M=r.metadataOrderKeyFilter)!==null&&M!==void 0?M:null,U.metadataValueStartsWith=(O=r.metadataValueStartsWith)!==null&&O!==void 0?O:null,U.order=(R=r.order)!==null&&R!==void 0?R:Et.LATEST_LAST_MESSAGE,r.createdAfter&&(U.createdAfter=r.createdAfter),r.createdBefore&&(U.createdBefore=r.createdBefore),U}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("boolean",this.includeEmpty)&&x("boolean",this.includeFrozen)&&x("boolean",this.includeMetaData)&&x("string",this.channelNameContainsFilter)&&gn("string",this.channelUrlsFilter,!0)&&gn("string",this.customTypesFilter,!0)&&x("string",this.customTypeStartsWithFilter)&&x("string",this.nicknameContainsFilter,!0)&&x("string",this.nicknameStartsWithFilter,!0)&&x("string",this.nicknameExactMatchFilter,!0)&&_n(Dr,this.myMemberStateFilter)&&_n(Ur,this.superChannelFilter)&&_n(Yi,this.publicChannelFilter)&&_n(Ya,this.unreadChannelFilter)&&_n(Mi,this.hiddenChannelFilter)&&gn(ko,this.searchFilter.fields)&&x("string",this.searchFilter.query,!0)&&gn("string",this.userIdsFilter.userIds)&&x("boolean",this.userIdsFilter.includeMode)&&_n(Ea,this.userIdsFilter.queryType)&&_n(Et,this.order)&&x("string",this.metadataOrderKeyFilter,!0)&&x("string",this.metadataKey,!0)&&gn("string",this.metadataValues,!0)&&x("string",this.metadataValueStartsWith,!0)&&Hm(this.createdAfter,!0)&&Hm(this.createdBefore,!0)},t.prototype.serialize=function(){return Au(this)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i;return v(this,function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,Yt.of(this._iid).getMyGroupChannels(this._token,Re(D({},this)),this.limit,W.REQUEST_CHANNEL,!0)]):[3,2]:[3,5];case 1:return e=a.sent(),r=e.channels,i=e.token,this._token=i,this._hasNext=!!i,this._isLoading=!1,[2,r];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(Sa),RM=function(n){function t(e){var r=e.channelUrl,i=e.userId,a=n.call(this)||this;return a.method=J.PUT,a.path="".concat(yr,"/").concat(encodeURIComponent(r),"/messages/mark_as_delivered"),a.params=ge({user_id:i}),a}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var da,DM=function(n){function t(e,r,i){var a=n.call(this,e,"DLVR",i)||this;return a.channelUrl=i.channel_url,a.deliveredStateUpdate=i.updated,a}return w(t,n),t}(ft),qi=function(){function n(t){var e=t.top,r=e===void 0?Number.MAX_SAFE_INTEGER:e,i=t.bottom,a=i===void 0?0:i;this.top=r,this.bottom=a}return n.prototype.includes=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.every(function(i){return t.top<=i&&i<=t.bottom})},n.prototype.overlap=function(t){return this.includes(t.top)||this.includes(t.bottom)},n.prototype.intersect=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.some(function(i){return t.top<=i&&i<=t.bottom})},n.prototype.extends=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.top=Math.min.apply(Math,Be([this.top],we(t),!1)),this.bottom=Math.max.apply(Math,Be([this.bottom],we(t),!1))},n}(),ss={},Yt=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,D(D({},r),{channelType:wn.GROUP}))||this)._leftChannels=new Map,a._markAsReadAllLastSentAt=0,a._forceDisableMack=(i=r.forceDisableMack)!==null&&i!==void 0&&i,a._groupChannelHandlers=new Map,a._groupChannelCache=new qA(a._iid,{sdkState:r.sdkState,cacheContext:r.cacheContext}),a._groupChannelBroadcast=new YA({dispatcher:r.dispatcher,groupChannelCache:a._groupChannelCache,messageCache:hu.of(a._iid),unsentMessageCache:Fs.of(a._iid)}),setInterval(function(){var s,u,o=function(c){c.invalidateTypingStatus()&&(a._dispatcher.dispatch(new An({channels:[c],context:{source:W.EVENT_CHANNEL_TYPING_STATUS_UPDATE}})),a._groupChannelHandlers.forEach(function(f){f.onTypingStatusUpdated&&f.onTypingStatusUpdated(c)}))};try{for(var l=oe(a._groupChannelCache.channels),d=l.next();!d.done;d=l.next())o(d.value)}catch(c){s={error:c}}finally{try{d&&!d.done&&(u=l.return)&&u.call(l)}finally{if(s)throw s.error}}},1e3),a._dispatcher.on(function(s){s instanceof ft?a._handleEvent(s).catch(function(u){if(gr(u)&&a._sdkState.appState==="foreground")throw u}):s instanceof jb?y(a,void 0,void 0,function(){var u,o;return v(this,function(l){switch(l.label){case 0:return u=s.message,[4,this.getChannelFromCache(u.channelUrl)];case 1:return(o=l.sent())&&!o.isFrozen?[3,3]:[4,this.getChannelWithoutCache(u.channelUrl,!0)];case 2:o=l.sent(),l.label=3;case 3:return o.isFrozen||(u instanceof sr?o._autoResendUserMessage(u):u instanceof Ft&&o._autoResendFileMessage(u)),[2]}})}):s instanceof zb?a.reduceDBSize():s instanceof vb&&y(a,void 0,void 0,function(){var u,o,l,d,c,f=this;return v(this,function(h){switch(h.label){case 0:return u=s.channelUrl,o=s.channelType,l=s.parentMessage,d=new Vb(this._iid,{channel_type:wn.GROUP,channel_url:u,parent_message_id:l.messageId,thread_info:pd.payloadify(l.threadInfo)}),o!==wn.GROUP?[3,2]:[4,this.getChannel(u,!0)];case 1:c=h.sent(),Ae(function(){return y(f,void 0,void 0,function(){var m,_,E,b,g;return v(this,function(C){try{for(m=oe(this._groupChannelHandlers.values()),_=m.next();!_.done;_=m.next())(E=_.value).onThreadInfoUpdated&&E.onThreadInfoUpdated(c,d)}catch(S){b={error:S}}finally{try{_&&!_.done&&(g=m.return)&&g.call(m)}finally{if(b)throw b.error}}return[2]})})}),h.label=2;case 2:return[2]}})})}),ss[e]||(ss[e]=a),a}return w(t,n),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return hu.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return Fs.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e){return ss[e]||(ss[e]=new t(e,k.of(e))),ss[e]},t.clear=function(e){ss[e]&&delete ss[e]},Object.defineProperty(t.prototype,"handlers",{get:function(){return Be([],we(this._groupChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.buildGroupChannelFromSerializedData=function(e){var r=$a(e);return new ci(this._iid,ci.payloadify(r))},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){var r=$a(e);return new lC(this._iid,r)},t.prototype.buildMemberFromSerializedData=function(e){var r=$a(e);return new ai(this._iid,ai.payloadify(r))},t.prototype.getChannelFromCache=function(e){var r;return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return[4,this._groupChannelCache.get(e)];case 1:return[2,(r=i.sent())!==null&&r!==void 0?r:null]}})})},t.prototype.getChannelsFromCache=function(e,r,i,a,s){return y(this,void 0,void 0,function(){return v(this,function(u){switch(u.label){case 0:return[4,this._groupChannelCache.fetch({token:e,filter:r,order:i,limit:a,borderlineChannelUrl:s})];case 1:return[2,u.sent()]}})})},t.prototype.upsertChannelsToCache=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._groupChannelCache.upsert(e)];case 1:return[2,r.sent()]}})})},t.prototype.removeChannelsFromCache=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._groupChannelCache.remove(e)];case 1:return r.sent(),[2]}})})},t.prototype.clearChannelsFromCache=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._groupChannelCache.clear()];case 1:return e.sent(),[2]}})})},t.prototype.reduceDBSize=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d,c,f,h,m,_,E;return v(this,function(b){switch(b.label){case 0:return e=hu.of(this._iid),r=k.of(this._iid).cacheContext,i=r.localCacheConfig,a=r.nestdb,r.localCacheEnabled&&a&&a.state==Bi.OPENED?(s=1024*i.maxSize*1024,[4,a.estimateUsage()]):[2];case 1:if((u=b.sent())<s)return[2];o=[],l=this._groupChannelCache.channels,d={},m=0,b.label=2;case 2:return m<l.length?[4,this.getMessagesFromCache(l[m].url,0,"prev",new Xa)]:[3,5];case 3:c=b.sent(),d[l[m].url]=JSON.stringify(c).length,f=new nT({channel:l[m],cachedMessageCount:c.length}),o.push(f),b.label=4;case 4:return m++,[3,2];case 5:h=o.sort(i.clearOrderComparator),m=0,b.label=6;case 6:return m<h.length?[4,e.removeMessagesOfChannel(h[m].channel.url)]:[3,10];case 7:return b.sent(),[4,e._getGroupChannelPreferenceSize(h[m].channel.url)];case 8:if(_=b.sent(),E=d[h[m].channel.url]+_,(u-=E)<s)return[3,10];b.label=9;case 9:return m++,[3,6];case 10:return[2]}})})},t.prototype._isSuperGroupMackDisabled=function(e){var r=k.of(this._iid).appInfo;return!(!e.isSuper||e.isBroadcast||!(r!=null&&r.disableSuperGroupMack))},t.prototype._handleEvent=function(e){var r,i;return y(this,void 0,void 0,function(){var a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R,U,P,L,F,B,V,K,$,q,se,Y,ce,X,Se,te,be,xe,Pe,vn,on,je,Xe,sn,un,En,rn,qe,Je,ln,dn,ve,De,Ye,en,fn,Fe,Nn,nn,_e,zn,Rn,bn,Ge,cn,On,Ln,In,et,Gn,Cn,mn,ze,ue,Q,Te,He,$e,Ee,fe,We,yn,Yn,Sn,rt,Ct,pe,Le,ae,Qe,an,Tn,xn,it,lt,Ie,j,le,ke,Un,Kn,ut,dt,jt,Ht,Ve,kn,Pn,Dn,$r,br,hi,Ys,is,il,Ru,Du,Lu,Aa,al,oc,Dm,Lm,lc,dc,cc,sl,ul,fc,hc,Um,pc,km,mc,xm,_c,Pm,gc,Fm,nt=this;return v(this,function(Bn){switch(Bn.label){case 0:switch(Bn.trys.push([0,80,,81]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"READ":return[3,10];case"DLVR":return[3,13];case"MRCT":return[3,15];case"MTHD":return[3,19];case"MCNT":return[3,23];case"PEDI":return[3,32];case"VOTE":return[3,35];case"SYEV":return[3,38];case"USEV":return[3,78]}return[3,79];case 1:return f=null,e.code==="MESG"?f=e.as(Pp):e.code==="FILE"?f=e.as(Dp):e.code!=="ADMM"&&e.code!="BRDM"||(f=e.as(eC)),f?(a=f.message,s=f.isMentioned,u=f.forceUpdateLastMessage,a.channelType!==wn.GROUP?[3,3]:(V=this._groupChannelCache.isCachedInMemory(a.channelUrl),R=a instanceof Dt&&a.sender.userId===this._sdkState.userId,[4,this.getChannel(a.channelUrl,!0)])):[3,3];case 2:if(o=Bn.sent(),l=k.of(this._iid).useMemberInfoInMessage,this._forceDisableMack||this._isSuperGroupMackDisabled(o)||a instanceof ks||R||Lt(function(){return y(nt,void 0,void 0,function(){var Z;return v(this,function(z){switch(z.label){case 0:return Z=new OM(a),[4,this._requestQueue.send(Z)];case 1:return z.sent(),[2]}})})}),a instanceof Dt){try{for(d=oe(o.members),c=d.next();!c.done;c=d.next())if((Tn=c.value).userId===a.sender.userId){l||(a.sender.nickname=Tn.nickname,a.sender.plainProfileUrl=Tn.plainProfileUrl,a.sender.metaData=Tn.metaData,a.sender.isBlockedByMe=Tn.isBlockedByMe);break}}catch(Z){hc={error:Z}}finally{try{c&&!c.done&&(Um=d.return)&&Um.call(d)}finally{if(hc)throw hc.error}}!l&&s&&((r=a.mentionedUsers)===null||r===void 0||r.forEach(function(Z){var z,hn;try{for(var Ke=oe(o.members),pn=Ke.next();!pn.done;pn=Ke.next()){var Ot=pn.value;if(Z.userId===Ot.userId){Z.nickname=Ot.nickname,Z.plainProfileUrl=Ot.plainProfileUrl,Z.metaData=Ot.metaData;break}}}catch(at){z={error:at}}finally{try{pn&&!pn.done&&(hn=Ke.return)&&hn.call(Ke)}finally{if(z)throw z.error}}})),R&&(g=this._sessionManager.currentUser)&&(g.nickname=a.sender.nickname,g.plainProfileUrl=a.sender.plainProfileUrl,g.metaData=a.sender.metaData)}a.silent&&!R||(o.isEphemeral||V)&&(o._updateLastMessage(a),R||o._shouldUpdateUnreadCountWith(a)&&o._updateUnreadCount(o.unreadMessageCount+1,o.unreadMentionCount+(s?1:0))),u&&o._updateLastMessage(a),this._dispatcher.dispatch(new An({channels:[o],context:{source:W.EVENT_MESSAGE_RECEIVED}})),a.silent&&!R||Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onChannelChanged&&hn.onChannelChanged(o)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),this._dispatcher.dispatch(new mt({messages:[a],source:W.EVENT_MESSAGE_RECEIVED})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onMessageReceived&&hn.onMessageReceived(o,a),s&&hn.onMentionReceived&&hn.onMentionReceived(o,a)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),Bn.label=3;case 3:return[3,79];case 4:return f=null,e.code==="MEDI"?f=e.as(_d):e.code==="FEDI"?f=e.as(gd):e.code==="AEDI"&&(f=e.as(nC)),f?(h=f.message,m=f.mentionCountChange,h.threadInfo&&(h.threadInfo.unreadReplyCount=void 0),h.channelType!==wn.GROUP?[3,6]:(V=this._groupChannelCache.isCachedInMemory(h.channelUrl),[4,this.getChannel(h.channelUrl,!0)])):[3,6];case 5:_=Bn.sent(),R=h instanceof Dt&&h.sender.userId===this._sdkState.userId,E=!1,R?(b=h.sender,(g=this._sessionManager.currentUser)&&(g.nickname=b.nickname,g.plainProfileUrl=b.plainProfileUrl,g.metaData=b.metaData)):_.isReadMessage(h)||m!==0&&!h.silent&&V&&(_._updateUnreadCount(_.unreadMessageCount,_.unreadMentionCount+m),E=!0),_._updateLastMessage(h)?E=!0:!((i=_.lastMessage)===null||i===void 0)&&i.isIdentical(h)&&(V?_._updateLastMessage(h)&&(E=!0):E=!0),C=!1,_.lastPinnedMessage&&_.lastPinnedMessage.messageId===h.messageId&&(_.lastPinnedMessage=h,E=!0,C=!0),E&&(this._dispatcher.dispatch(new An({channels:[_],context:{source:C?W.EVENT_PINNED_MESSAGE_UPDATED:W.EVENT_MESSAGE_UPDATED}})),h.silent&&!R||Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onChannelChanged&&hn.onChannelChanged(_)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),C&&Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onPinnedMessageUpdated&&hn.onPinnedMessageUpdated(_)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})})),this._dispatcher.dispatch(new mt({messages:[h],source:W.EVENT_MESSAGE_UPDATED})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onMessageUpdated&&hn.onMessageUpdated(_,h),m>0&&hn.onMentionReceived&&hn.onMentionReceived(_,h)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),Bn.label=6;case 6:return[3,79];case 7:return S=e.as(Iy),Je=S.channelUrl,ln=S.channelType,A=S.messageId,I=S.silent,T=S.messageCreatedAt,M=S.senderId,ln!==wn.GROUP?[3,9]:[4,this.getChannel(Je,!0)];case 8:O=Bn.sent(),R=M===this._sdkState.userId,I||R||T>0&&O.myLastRead<T&&O.unreadMessageCount>0&&O._updateUnreadCount(O.unreadMessageCount-1,0),this._dispatcher.dispatch(new wp({messageIds:[A],source:W.EVENT_MESSAGE_DELETED})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onMessageDeleted&&hn.onMessageDeleted(O,A)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),Bn.label=9;case 9:return[3,79];case 10:return(U=e.as(Eb).readStatus).channelType!==wn.GROUP?[3,12]:(V=this._groupChannelCache.isCachedInMemory(U.channelUrl),[4,this.getChannel(U.channelUrl,!0)]);case 11:P=Bn.sent(),V&&P._updateUnreadMemberState(U.reader.userId,U.readAt),U.reader.userId===this._sdkState.userId?V?(P.unreadMessageCount>0||P.unreadMentionCount>0)&&(P._updateUnreadCount(0,0),this._dispatcher.dispatch(new An({channels:[P],context:{source:W.EVENT_CHANNEL_READ}})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onChannelChanged&&hn.onChannelChanged(P)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})})):P.unreadMessageCount!==0&&P.unreadMentionCount!==0||(this._dispatcher.dispatch(new An({channels:[P],context:{source:W.EVENT_CHANNEL_READ}})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onChannelChanged&&hn.onChannelChanged(P)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})})):(this._dispatcher.dispatch(new An({channels:[P],context:{source:W.EVENT_CHANNEL_READ}})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onUnreadMemberStatusUpdated&&hn.onUnreadMemberStatusUpdated(P)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})})),Bn.label=12;case 12:return[3,79];case 13:return L=e.as(DM),Je=L.channelUrl,F=L.deliveredStateUpdate,B=F===void 0?{}:F,V=this._groupChannelCache.isCachedInMemory(Je),[4,this.getChannel(Je,!0)];case 14:return K=Bn.sent(),V&&Object.keys(B).forEach(function(Z){K._updateUndeliveredMemberState(Z,B[Z])}),Object.keys(B).some(function(Z){return Z!==nt._sdkState.userId})&&(this._dispatcher.dispatch(new An({channels:[K],context:{source:W.EVENT_CHANNEL_DELIVERED}})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onUndeliveredMemberStatusUpdated&&hn.onUndeliveredMemberStatusUpdated(K)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})})),[3,79];case 15:return $=e.as(tC),Je=$.channelUrl,ln=$.channelType,q=$.event,ln!==wn.GROUP?[3,18]:[4,this.getChannel(Je,!0)];case 16:return se=Bn.sent(),[4,this.getMessageFromCache(q.messageId)];case 17:(X=Bn.sent())?X instanceof mr&&(X.applyReactionEvent(q),this._dispatcher.dispatch(new mt({messages:[X],source:W.EVENT_MESSAGE_REACTION_UPDATED}))):this._dispatcher.dispatch(new ib({event:q,source:W.EVENT_MESSAGE_REACTION_UPDATED})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onReactionUpdated&&hn.onReactionUpdated(se,q)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),Bn.label=18;case 18:return[3,79];case 19:return(Y=e.as(rC).event).channelType!==wn.GROUP?[3,22]:[4,this.getChannel(Y.channelUrl,!0)];case 20:return ce=Bn.sent(),[4,this.getMessageFromCache(Y.targetMessageId)];case 21:(X=Bn.sent())?X instanceof mr&&(X.applyThreadInfoUpdateEvent(Y),this._dispatcher.dispatch(new mt({messages:[X],source:W.EVENT_MESSAGE_THREADINFO_UPDATED}))):this._dispatcher.dispatch(new ab({event:Y,source:W.EVENT_MESSAGE_THREADINFO_UPDATED})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onThreadInfoUpdated&&hn.onThreadInfoUpdated(ce,Y)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),Bn.label=22;case 22:return[3,79];case 23:Se=e.as(iC).groupChannelMemberCounts,te=[],Bn.label=24;case 24:Bn.trys.push([24,29,30,31]),be=oe(Se),xe=be.next(),Bn.label=25;case 25:return xe.done?[3,28]:(Pe=xe.value,Je=Pe.channelUrl,fe=Pe.memberCount,We=Pe.joinedMemberCount,vn=Pe.updatedAt,[4,this.getChannelFromCache(Je)]);case 26:(on=Bn.sent())&&on._setLatestMemberCount(fe,We,vn)&&te.push(on),Bn.label=27;case 27:return xe=be.next(),[3,25];case 28:return[3,31];case 29:return je=Bn.sent(),pc={error:je},[3,31];case 30:try{xe&&!xe.done&&(km=be.return)&&km.call(be)}finally{if(pc)throw pc.error}return[7];case 31:return te.length>0&&(this._dispatcher.dispatch(new An({channels:te,context:{source:W.EVENT_CHANNEL_MEMBER_COUNT_UPDATED}})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onChannelMemberCountChanged&&hn.onChannelMemberCountChanged(te)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})})),[3,79];case 32:return Xe=e.as(aC),sn=Xe.event,un=Xe.status,Je=Xe.channelUrl,ln=Xe.channelType,Je&&ln===wn.GROUP?[4,this.getChannel(Je,!0)]:[3,34];case 33:En=Bn.sent(),this._dispatcher.dispatch(new Op({event:sn,source:W.EVENT_POLL_UPDATED})),Ae(un===ob?function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onPollDeleted&&hn.onPollDeleted(En,sn.pollId)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}:function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onPollUpdated&&hn.onPollUpdated(En,sn)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),Bn.label=34;case 34:return[3,79];case 35:return rn=e.as(Fp),qe=rn.event,Je=rn.channelUrl,ln=rn.channelType,Je&&ln===wn.GROUP?[4,this.getChannel(Je,!0)]:[3,37];case 36:dn=Bn.sent(),this._dispatcher.dispatch(new $d({event:qe,source:W.EVENT_POLL_VOTED})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onPollVoted&&hn.onPollVoted(dn,qe)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),Bn.label=37;case 37:return[3,79];case 38:if(!(ve=e.as(Na).event).isGroupChannelEvent)return[3,77];switch(ve.category){case Xn.CHANNEL_JOIN:return[3,39];case Xn.CHANNEL_LEAVE:return[3,41];case Xn.CHANNEL_OPERATOR_UPDATE:return[3,45];case Xn.CHANNEL_INVITE:return[3,47];case Xn.CHANNEL_DECLINE_INVITE:return[3,49];case Xn.TYPING_START:case Xn.TYPING_END:return[3,51];case Xn.USER_CHANNEL_MUTE:case Xn.USER_CHANNEL_UNMUTE:return[3,53];case Xn.USER_CHANNEL_BAN:return[3,55];case Xn.USER_CHANNEL_UNBAN:return[3,59];case Xn.CHANNEL_FREEZE:case Xn.CHANNEL_UNFREEZE:return[3,61];case Xn.CHANNEL_HIDE:return[3,63];case Xn.CHANNEL_UNHIDE:return[3,65];case Xn.CHANNEL_DELETED:return[3,67];case Xn.CHANNEL_PROP_CHANGED:return[3,69];case Xn.CHANNEL_META_DATA_CHANGED:return[3,71];case Xn.CHANNEL_META_COUNTERS_CHANGED:return[3,73];case Xn.PINNED_MESSAGE_CHANGED:return[3,75]}return[3,77];case 39:return[4,this.getChannel(ve.channelUrl,!0)];case 40:return De=Bn.sent(),Ye=e.as(mM),en=Ye.memberCount,fn=Ye.joinedMemberCount,Fe=Ye.members,Nn=!1,Fe.forEach(function(Z){De.isExclusive||De.isSuper||De.isBroadcast?Nn=Nn||De._setLatestMemberCount(en,fn,ve.ts):(Z.state=Rt.JOINED,De.addMember(Z,ve.ts),nt._updateJoinedMemberCount(De)),Z.userId===nt._sdkState.userId&&(De.myMemberState=Rt.JOINED)}),this._dispatcher.dispatch(new An({channels:[De],context:{source:W.EVENT_CHANNEL_JOINED,users:Fe}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){var hn,Ke;try{for(var pn=oe(Fe),Ot=pn.next();!Ot.done;Ot=pn.next()){var at=Ot.value;z.onUserJoined&&z.onUserJoined(De,at)}}catch(qS){hn={error:qS}}finally{try{Ot&&!Ot.done&&(Ke=pn.return)&&Ke.call(pn)}finally{if(hn)throw hn.error}}De.isBroadcast&&Nn&&z.onChannelMemberCountChanged&&z.onChannelMemberCountChanged([De])}),[2]})})}),[3,77];case 41:return(xn=this._leftChannels.get(ve.channelUrl))?(_e=xn.channel,[3,44]):[3,42];case 42:return[4,this.getChannel(ve.channelUrl,!0)];case 43:_e=Bn.sent(),Bn.label=44;case 44:return nn=_e,zn=e.as(gM),fe=zn.memberCount,We=zn.joinedMemberCount,Rn=zn.member,bn=!1,Ge=k.of(this._iid).appInfo,nn.isExclusive||nn.isSuper||nn.isBroadcast?bn=nn._setLatestMemberCount(fe,We,ve.ts):(Ge!=null&&Ge.enabledChannelMemberShipHistory?((cn=nn.members.find(function(Z){return Z.userId===Rn.userId}))&&(cn.state=Rt.LEFT),nn.memberCount=fe):nn.removeMember(Rn),this._updateJoinedMemberCount(nn)),Rn.userId===this._sdkState.userId?(nn.myMemberState=Rt.NONE,nn.invitedAt=0,nn.joinedAt=0,nn._updateUnreadCount(0,0),nn.isPublic?this._dispatcher.dispatch(new An({channels:[nn],context:{source:W.EVENT_CHANNEL_LEFT,user:Rn}})):(this._markAsLeave(nn),this._dispatcher.dispatch(new sa({channelUrls:[nn.url],context:{source:W.EVENT_CHANNEL_LEFT,user:Rn}})))):this._dispatcher.dispatch(new An({channels:[nn],context:{source:W.EVENT_CHANNEL_LEFT,user:Rn}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onUserLeft&&z.onUserLeft(nn,Rn),nn.isBroadcast&&bn&&z.onChannelMemberCountChanged&&z.onChannelMemberCountChanged([nn])}),[2]})})}),[3,77];case 45:return[4,this.getChannel(ve.channelUrl,!0)];case 46:On=Bn.sent(),Ln=e.as(Xb).operators,In=Ln.map(function(Z){return Z.userId});try{for(et=oe(On.members),Gn=et.next();!Gn.done;Gn=et.next())(Tn=Gn.value).role=In.includes(Tn.userId)?ui.OPERATOR:ui.NONE}catch(Z){mc={error:Z}}finally{try{Gn&&!Gn.done&&(xm=et.return)&&xm.call(et)}finally{if(mc)throw mc.error}}return On.myRole=In.includes(this._sdkState.userId)?ui.OPERATOR:ui.NONE,this._dispatcher.dispatch(new An({channels:[On],context:{source:W.EVENT_CHANNEL_OPERATOR_UPDATED,operators:Ln}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onOperatorUpdated&&z.onOperatorUpdated(On,Ln)}),[2]})})}),[3,77];case 47:return[4,this.getChannel(ve.channelUrl,!0)];case 48:Cn=Bn.sent(),mn=e.as(yM),fe=mn.memberCount,We=mn.joinedMemberCount,ze=mn.inviter,(ue=mn.invitees).forEach(function(Z){return Z.state=Rt.INVITED});try{for(Q=oe(ue),Te=Q.next();!Te.done;Te=Q.next())He=Te.value,Cn.isExclusive||Cn.isSuper||Cn.isBroadcast?Cn._setLatestMemberCount(fe,We,ve.ts):Cn.addMember(He,ve.ts),this._sdkState.userId===He.userId&&(Cn.hiddenState=ni.UNHIDDEN,Cn.myMemberState!==Rt.JOINED&&(Cn.myMemberState=Rt.INVITED),Cn.invitedAt=ve.ts)}catch(Z){_c={error:Z}}finally{try{Te&&!Te.done&&(Pm=Q.return)&&Pm.call(Q)}finally{if(_c)throw _c.error}}return this._dispatcher.dispatch(new An({channels:[Cn],context:{source:W.EVENT_CHANNEL_INVITED,inviter:ze,invitees:ue}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onUserReceivedInvitation&&z.onUserReceivedInvitation(Cn,ze,ue)}),[2]})})}),[3,77];case 49:return[4,this.getChannel(ve.channelUrl,!0)];case 50:return $e=Bn.sent(),Ee=e.as(CM),fe=Ee.memberCount,We=Ee.joinedMemberCount,yn=Ee.inviter,Yn=Ee.invitee,$e.isExclusive||$e.isSuper||$e.isBroadcast?$e._setLatestMemberCount(fe,We,ve.ts):$e.removeMember(Yn),this._sdkState.userId===Yn.userId?($e.invitedAt=0,$e.myMemberState=Rt.NONE,$e.isPublic?this._dispatcher.dispatch(new An({channels:[$e],context:{source:W.EVENT_CHANNEL_DECLINED_INVITE,inviter:yn,invitee:Yn}})):this._dispatcher.dispatch(new sa({channelUrls:[$e.url],context:{source:W.EVENT_CHANNEL_DECLINED_INVITE,inviter:yn,invitee:Yn}}))):this._dispatcher.dispatch(new An({channels:[$e],context:{source:W.EVENT_CHANNEL_DECLINED_INVITE,inviter:yn,invitee:Yn}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onUserDeclinedInvitation&&z.onUserDeclinedInvitation($e,yn,Yn)}),[2]})})}),[3,77];case 51:return[4,this.getChannel(ve.channelUrl,!0)];case 52:return Sn=Bn.sent(),rt=ve.category===Xn.TYPING_START,Ct=e.as(rt?AM:wM).user,Sn._updateTypingStatus(Ct,rt?ve.ts:0),this._dispatcher.dispatch(new An({channels:[Sn],context:{source:W.EVENT_CHANNEL_TYPING_STATUS_UPDATE}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onTypingStatusUpdated&&z.onTypingStatusUpdated(Sn)}),[2]})})}),[3,77];case 53:return[4,this.getChannel(ve.channelUrl,!0)];case 54:pe=Bn.sent(),Le=ve.category===Xn.USER_CHANNEL_MUTE,(ae=e.as(Le?wb:Ob).user).userId===this._sdkState.userId&&(pe.myMutedState=Le?Ai.MUTED:Ai.UNMUTED,pe._myMutedRemainingTime=ae.restrictionInfo.remainingDuration);try{for(Qe=oe(pe.members),an=Qe.next();!an.done;an=Qe.next())if((Tn=an.value).userId===ae.userId){Tn.isMuted=Le;break}}catch(Z){gc={error:Z}}finally{try{an&&!an.done&&(Fm=Qe.return)&&Fm.call(Qe)}finally{if(gc)throw gc.error}}return this._dispatcher.dispatch(new An({channels:[pe],context:{source:Le?W.EVENT_CHANNEL_MUTED:W.EVENT_CHANNEL_UNMUTED,user:ae}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){Le?z.onUserMuted&&z.onUserMuted(pe,ae):z.onUserUnmuted&&z.onUserUnmuted(pe,ae)}),[2]})})}),[3,77];case 55:return(xn=this._leftChannels.get(ve.channelUrl))?(lt=xn.channel,[3,58]):[3,56];case 56:return[4,this.getChannel(ve.channelUrl,!0)];case 57:lt=Bn.sent(),Bn.label=58;case 58:return it=lt,this._markAsLeave(it),Ie=e.as(Rb).user,Ie.userId===this._sdkState.userId&&this._dispatcher.dispatch(new sa({channelUrls:[it.url],context:{source:W.EVENT_CHANNEL_BANNED,user:Ie}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onUserBanned&&z.onUserBanned(it,Ie)}),[2]})})}),[3,77];case 59:return[4,this.getChannel(ve.channelUrl,!0)];case 60:return j=Bn.sent(),le=e.as(Db).user,le.userId===this._sdkState.userId&&this._dispatcher.dispatch(new sa({channelUrls:[j.url],context:{source:W.EVENT_CHANNEL_UNBANNED,user:le}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onUserUnbanned&&z.onUserUnbanned(j,le)}),[2]})})}),[3,77];case 61:return[4,this.getChannel(ve.channelUrl,!0)];case 62:return ke=Bn.sent(),Un=e.as(Lb).freeze,ke.isFrozen=Un,this._dispatcher.dispatch(new An({channels:[ke],context:{source:Un?W.EVENT_CHANNEL_FROZEN:W.EVENT_CHANNEL_UNFROZEN}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){Un?z.onChannelFrozen&&z.onChannelFrozen(ke):z.onChannelUnfrozen&&z.onChannelUnfrozen(ke)}),[2]})})}),[3,77];case 63:return[4,this.getChannel(ve.channelUrl,!0)];case 64:return Kn=Bn.sent(),ut=e.as(NM),dt=ut.allowAutoUnhide,jt=ut.hidePreviousMessages,Ht=ut.messageOffsetTimestamp,dt!==null&&(Kn.hiddenState=dt?ni.HIDDEN_ALLOW_AUTO_UNHIDE:ni.HIDDEN_PREVENT_AUTO_UNHIDE),jt!==null&&jt&&Kn._updateUnreadCount(0,0),Ht!==null&&(Kn.messageOffsetTimestamp=Ht),this._dispatcher.dispatch(new An({channels:[Kn],context:{source:W.EVENT_CHANNEL_HIDDEN}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onChannelHidden&&z.onChannelHidden(Kn)}),[2]})})}),[3,77];case 65:return[4,this.getChannel(ve.channelUrl,!0)];case 66:return(Ve=Bn.sent()).hiddenState=ni.UNHIDDEN,this._dispatcher.dispatch(new An({channels:[Ve],context:{source:W.EVENT_CHANNEL_UNHIDDEN}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onChannelChanged&&z.onChannelChanged(Ve)}),[2]})})}),[3,77];case 67:return[4,this.getChannel(ve.channelUrl,!0)];case 68:return kn=Bn.sent(),this._dispatcher.dispatch(new sa({channelUrls:[ve.channelUrl],context:{source:W.EVENT_CHANNEL_DELETED}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onChannelDeleted&&z.onChannelDeleted(kn.url,kn.channelType)}),[2]})})}),[3,77];case 69:return[4,this.getChannelWithoutCache(ve.channelUrl,!0)];case 70:return Pn=Bn.sent(),this._dispatcher.dispatch(new An({channels:[Pn],context:{source:W.EVENT_CHANNEL_UPDATED}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onChannelChanged&&z.onChannelChanged(Pn)}),[2]})})}),[3,77];case 71:return[4,this.getChannel(ve.channelUrl,!0)];case 72:return Dn=Bn.sent(),$r=e.as(Ab),br=$r.created,hi=$r.updated,Ys=$r.deleted,br&&(Dn._upsertCachedMetaData(br,ve.ts),this._dispatcher.dispatch(new An({channels:[Dn],context:{source:W.EVENT_CHANNEL_METADATA_CREATED,metaData:br},ts:ve.ts}))),hi&&(Dn._upsertCachedMetaData(hi,ve.ts),this._dispatcher.dispatch(new An({channels:[Dn],context:{source:W.EVENT_CHANNEL_METADATA_UPDATED,metaData:hi},ts:ve.ts}))),Ys&&(Dn._removeFromCachedMetaData(Ys,ve.ts),this._dispatcher.dispatch(new An({channels:[Dn],context:{source:W.EVENT_CHANNEL_METADATA_DELETED,metaDataKeys:Ys},ts:ve.ts}))),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){br&&z.onMetaDataCreated&&z.onMetaDataCreated(Dn,br),hi&&z.onMetaDataUpdated&&z.onMetaDataUpdated(Dn,hi),Ys&&z.onMetaDataDeleted&&z.onMetaDataDeleted(Dn,Ys)}),[2]})})}),[3,77];case 73:return[4,this.getChannel(ve.channelUrl,!0)];case 74:return is=Bn.sent(),il=e.as(Mb),Ru=il.created,Du=il.updated,Lu=il.deleted,Ru&&this._dispatcher.dispatch(new An({channels:[is],context:{source:W.EVENT_CHANNEL_METACOUNTER_CREATED,metaCounters:Ru}})),Du&&this._dispatcher.dispatch(new An({channels:[is],context:{source:W.EVENT_CHANNEL_METACOUNTER_UPDATED,metaCounters:Du}})),Lu&&this._dispatcher.dispatch(new An({channels:[is],context:{source:W.EVENT_CHANNEL_METACOUNTER_DELETED,metaCounterKeys:Lu}})),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){Ru&&z.onMetaCounterCreated&&z.onMetaCounterCreated(is,Ru),Du&&z.onMetaCounterUpdated&&z.onMetaCounterUpdated(is,Du),Lu&&z.onMetaCounterDeleted&&z.onMetaCounterDeleted(is,Lu)}),[2]})})}),[3,77];case 75:return[4,this.getChannel(ve.channelUrl,!0)];case 76:return Aa=Bn.sent(),al=e.as(Zb),oc=al.pinnedMessageIds,Dm=al.latestPinnedMessage,(Lm=al.ts)>Aa._pinnedMessagesUpdatedAt&&(Aa.pinnedMessageIds=oc??[],Aa.lastPinnedMessage=Dm,Aa._pinnedMessagesUpdatedAt=Lm,this._dispatcher.dispatch(new An({channels:[Aa],context:{source:W.EVENT_PINNED_MESSAGE_UPDATED}})),Ae(function(){return y(nt,void 0,void 0,function(){var Z,z,hn,Ke,pn;return v(this,function(Ot){try{for(Z=oe(this._groupChannelHandlers.values()),z=Z.next();!z.done;z=Z.next())(hn=z.value).onChannelChanged&&hn.onChannelChanged(Aa)}catch(at){Ke={error:at}}finally{try{z&&!z.done&&(pn=Z.return)&&pn.call(Z)}finally{if(Ke)throw Ke.error}}return[2]})})}),Ae(function(){return y(nt,void 0,void 0,function(){return v(this,function(Z){return this._groupChannelHandlers.forEach(function(z){z.onPinnedMessageUpdated&&z.onPinnedMessageUpdated(Aa)}),[2]})})})),[3,77];case 77:return[3,79];case 78:switch((lc=e.as(Kb).event).category){case Uo.USER_BLOCK:dc=yd.getDataAsUserBlockEvent(this._iid,lc),sl=dc.blocker,ul=dc.blockee,this._groupChannelCache.block(sl.userId,ul.userId);break;case Uo.USER_UNBLOCK:cc=yd.getDataAsUserBlockEvent(this._iid,lc),sl=cc.blocker,ul=cc.blockee,this._groupChannelCache.unblock(sl.userId,ul.userId)}return[3,79];case 79:return[3,81];case 80:if(fc=Bn.sent(),gr(fc))throw fc;return[3,81];case 81:return[2]}})})},t.prototype._markAsLeave=function(e){var r,i=this,a=(r=this._leftChannels.get(e.url))!==null&&r!==void 0?r:{channel:e,ref:0};a.ref++,this._leftChannels.set(e.url,a),setTimeout(function(){a.ref--,a.ref===0&&i._leftChannels.delete(e.url)},1e4)},t.prototype.addHandler=function(e,r){this._groupChannelHandlers.set(e,r)},t.prototype.removeHandler=function(e){this._groupChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._groupChannelHandlers.clear()},t.prototype.subscribeChannelEvent=function(e,r){this._groupChannelBroadcast.subscribe(e,r)},t.prototype.unsubscribeChannelEvent=function(e){this._groupChannelBroadcast.unsubscribe(e)},t.prototype._updateJoinedMemberCount=function(e){e.joinedMemberCount=e.members.filter(function(r){return r.state===Rt.JOINED}).length},t.prototype.getChannel=function(e,r){return r===void 0&&(r=!1),y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:ne(x("string",e)).throw(H.invalidParameters),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(i=a.sent())?[2,i]:[3,4];case 3:return a.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,r)];case 5:return[2,a.sent()]}})})},t.prototype.getChannelWithoutCache=function(e,r){return r===void 0&&(r=!1),y(this,void 0,void 0,function(){var i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return ne(x("string",e)).throw(H.invalidParameters),i=new Vf({channelUrl:e,isInternalCall:r}),[4,this._requestQueue.send(i)];case 1:switch(a=l.sent(),s=a.as(jf).channel,u=s.unreadMessageCount,o=s.unreadMentionCount,s.myCountPreference){case ei.UNREAD_MESSAGE_COUNT_ONLY:o=0;break;case ei.UNREAD_MENTION_COUNT_ONLY:u=0;break;case ei.OFF:u=0,o=0}return s._updateUnreadCount(u,o),[4,this.upsertChannelsToCache([s])];case 2:return[2,l.sent()[0]]}})})},t.prototype.refreshChannel=function(e,r,i,a){return r===void 0&&(r=!0),i===void 0&&(i=W.REFRESH_CHANNEL),a===void 0&&(a=!1),y(this,void 0,void 0,function(){var s,u,o,l,d;return v(this,function(c){switch(c.label){case 0:return c.trys.push([0,5,,6]),s=new Vf({channelUrl:e,isInternalCall:r,showLatestMessage:a}),[4,this._requestQueue.send(s)];case 1:return u=c.sent(),(o=u.as(jf).channel).myMemberState!==Rt.NONE?[3,2]:(this._dispatcher.dispatch(new sa({channelUrls:[o.url],context:{source:i}})),[3,4]);case 2:return[4,this.upsertChannelsToCache([o])];case 3:l=c.sent(),this._dispatcher.dispatch(new An({channels:l,context:{source:i}})),c.label=4;case 4:return[3,6];case 5:return(d=c.sent()).code!==Ne.NON_AUTHORIZED&&d.code!==Ne.NOT_FOUND_IN_DATABASE||this._dispatcher.dispatch(new sa({channelUrls:[e],context:{source:i}})),[3,6];case 6:return[2]}})})},t.prototype.getMyGroupChannels=function(e,r,i,a,s){return a===void 0&&(a=W.REQUEST_CHANNEL),s===void 0&&(s=!1),y(this,void 0,void 0,function(){var u,o,l,d,c,f,h,m,_;return v(this,function(E){switch(E.label){case 0:return r.createdAfter&&(r.createdAfter=Math.floor(r.createdAfter/1e3)),r.createdBefore&&(r.createdBefore=Math.floor(r.createdBefore/1e3)),u=!1,s&&(o=k.of(this._iid),l=o.appInfo,(d=o.cacheContext)&&!d.localCacheEnabled&&(l!=null&&l.enabledChannelMemberShipHistory)&&(l!=null&&l.applicationAttributes.includes("left_user_view_support"))&&(u=!0)),c=new ZA(D(D({},r),{userId:this._sdkState.userId,token:e,limit:i,includeLeftChannel:s&&u})),[4,this._requestQueue.send(c)];case 1:return f=E.sent(),h=f.as(JA),m=h.channels,_=h.token,this._dispatcher.dispatch(new An({channels:m,context:{source:a}})),[2,{channels:m,token:_}]}})})},t.prototype.getMyGroupChannelChangeLogs=function(e,r,i){return i===void 0&&(i=W.REQUEST_CHANNEL_CHANGELOGS),y(this,void 0,void 0,function(){var a,s,u,o,l,d,c,f;return v(this,function(h){switch(h.label){case 0:return a=D(D({},Sd),r),ne((x("string",e)||x("number",e))&&Gf(a)).throw(H.invalidParameters),s=new QA(Re({userId:this._sdkState.userId,ts:typeof e=="number"?e:null,token:typeof e=="string"?e:null,filter:a})),[4,this._requestQueue.send(s)];case 1:return u=h.sent(),o=u.as(XA),l=o.updatedChannels,d=o.deletedChannelUrls,c=o.hasMore,f=o.ts,l.length>0&&this._dispatcher.dispatch(new An({channels:l,context:{source:i},ts:f})),d.length>0&&this._dispatcher.dispatch(new sa({channelUrls:d,context:{source:i}})),[2,{updatedChannels:l,deletedChannelUrls:d,hasMore:c,token:o.token}]}})})},t.prototype.getGroupChannelCount=function(e){return y(this,void 0,void 0,function(){var r,i,a;return v(this,function(s){switch(s.label){case 0:return r=D(D({},uC),e),ne(oC(r)).throw(H.invalidParameters),i=new eM({userId:this._sdkState.userId,filter:r}),[4,this._requestQueue.send(i)];case 1:return a=s.sent(),[2,a.as(nM).groupChannelCount]}})})},t.prototype.getUnreadItemCount=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g;return v(this,function(C){switch(C.label){case 0:return r=D(D({},zA),e),ne(function(S){return gn(yt,S.keys)&&gn("string",S.customTypeFilters,!0)&&gn("string",S.customTypesFilter,!0)}(r)).throw(H.invalidParameters),i=k.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new tM({userId:a.userId,filter:r}),[4,s.send(u)];case 1:return o=C.sent(),l=o.as(rM),d=l.groupChannelUnreadMentionCount,c=l.groupChannelUnreadMessageCount,f=l.groupChannelInvitationCount,h=l.superGroupChannelUnreadMentionCount,m=l.superGroupChannelUnreadMessageCount,_=l.superGroupChannelInvitationCount,E=l.nonSuperGroupChannelUnreadMentionCount,b=l.nonSuperGroupChannelUnreadMessageCount,g=l.nonSuperGroupChannelInvitationCount,[2,ge({groupChannelUnreadMentionCount:d,groupChannelUnreadMessageCount:c,groupChannelInvitationCount:f,superGroupChannelUnreadMentionCount:h,superGroupChannelUnreadMessageCount:m,superGroupChannelInvitationCount:_,nonSuperGroupChannelUnreadMentionCount:E,nonSuperGroupChannelUnreadMessageCount:b,nonSuperGroupChannelInvitationCount:g})]}})})},t.prototype.getTotalUnreadChannelCount=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new iM({userId:r.userId}),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(aM).unreadCount]}})})},t.prototype.getTotalUnreadMessageCount=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return r=D(D({},KA),e),ne($A(r)).throw(H.invalidParameters),i=k.of(this._iid),a=i.sdkState,s=i.requestQueue,u=new sM({userId:a.userId,filter:r}),[4,s.send(u)];case 1:return o=l.sent(),[2,o.as(uM).unreadCount]}})})},t.prototype.getTotalScheduledMessageCount=function(e){return e===void 0&&(e={}),y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return r=D(D({},WA),e),ne(function(o){return x("string",o.channelUrl,!0)&&gn(Ha,o.scheduledStatus,!0)&&_n(ur,o.messageTypeFilter)}(r)).throw(H.invalidParameters),i=k.of(this._iid).requestQueue,a=new oM(r),[4,i.send(a)];case 1:return s=u.sent(),[2,s.as(lM).count]}})})},t.prototype.getSubscribedTotalUnreadMessageCount=function(){var e=k.of(this._iid).subscribedUnreadMessageCount;return e.all>=0?e.all:0},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){var e=0,r=k.of(this._iid).subscribedUnreadMessageCount;return Object.keys(r.customTypes).forEach(function(i){e+=r.customTypes[i]}),e},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){var r;return(r=k.of(this._iid).subscribedUnreadMessageCount.customTypes[e])!==null&&r!==void 0?r:0},t.prototype.createChannel=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return r=D(D({},ql),e),ne(Bf(r)).throw(H.invalidParameters),r.isPublic||(r.accessCode=void 0),i=new cM(D({userId:this._sdkState.userId},r)),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),s=a.as(fM).channel,[4,this.upsertChannelsToCache([s])];case 2:return u.sent(),[2,s]}})})},t.prototype.markAsReadAll=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return e=Date.now(),ne(e-this._markAsReadAllLastSentAt>=1e3).throw(H.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=e,r=new rg({userId:this._sdkState.userId}),[4,this._requestQueue.send(r)];case 1:d.sent(),i=this._groupChannelCache.channels;try{for(a=oe(i),s=a.next();!s.done;s=a.next())(u=s.value)._updateUnreadMemberState(this._sdkState.userId,e),u._updateUnreadCount(0,0)}catch(c){o={error:c}}finally{try{s&&!s.done&&(l=a.return)&&l.call(a)}finally{if(o)throw o.error}}return i.length>0?[4,this.upsertChannelsToCache(i)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[2]}})})},t.prototype.markAsReadWithChannelUrls=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c;return v(this,function(f){switch(f.label){case 0:return r=Date.now(),ne(gn("string",e)&&r-this._markAsReadAllLastSentAt>=1e3).throw(H.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=r,i=new rg({userId:this._sdkState.userId,channelUrls:e}),[4,this._requestQueue.send(i)];case 1:f.sent(),a=this._groupChannelCache.channels,s=[];try{for(u=oe(a),o=u.next();!o.done;o=u.next())l=o.value,e.includes(l.url)&&(l._updateUnreadMemberState(this._sdkState.userId,r),l._updateUnreadCount(0,0),s.push(l))}catch(h){d={error:h}}finally{try{o&&!o.done&&(c=u.return)&&c.call(u)}finally{if(d)throw d.error}}return s.length>0?[4,this.upsertChannelsToCache(s)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[2]}})})},t.prototype.markAsDelivered=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this.getChannel(e)];case 1:return[4,r.sent().markAsDelivered()];case 2:return r.sent(),[2]}})})},t.prototype.getMessageFromCache=function(e){var r;return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return[4,this._messageCache.get(e)];case 1:return[2,(r=i.sent())!==null&&r!==void 0?r:null]}})})},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,r,i){return y(this,void 0,void 0,function(){return v(this,function(a){switch(a.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:r,filter:i,exactMatch:!0})];case 1:return[2,a.sent()]}})})},t.prototype.getMessagesFromCache=function(e,r,i,a,s,u){return s===void 0&&(s=Pb),u===void 0&&(u=!0),y(this,void 0,void 0,function(){return v(this,function(o){switch(o.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:r,limit:s,filter:a,backward:i==="next",inclusive:u})];case 1:return[2,o.sent()]}})})},t.prototype.getPollMessagesFromCache=function(e,r,i,a){return y(this,void 0,void 0,function(){return v(this,function(s){switch(s.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:r,limit:a,filter:i,backward:!1,isPollOnly:!0})];case 1:return[2,s.sent()]}})})},t.prototype.getCachedMessageCountBetween=function(e,r,i,a){return y(this,void 0,void 0,function(){return v(this,function(s){switch(s.label){case 0:return[4,this._messageCache.countBetween(e,r,new qi({top:i,bottom:a}))];case 1:return[2,s.sent()]}})})},t.prototype.getUnsentMessagesFromCache=function(e,r){return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return[4,this._unsentMessageCache.fetch({channelUrl:e,filter:r})];case 1:return[2,i.sent()]}})})},t.prototype.removeFailedMessageFromCache=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._unsentMessageCache.remove([e])];case 1:return r.sent(),[2]}})})},t}(Jb),Qr=function(n,t){return t instanceof Dt?n.findIndex(function(e){return e instanceof Dt&&t.isIdentical(e)}):n.findIndex(function(e){return e.isIdentical(t)})},Hu=function(n,t){return n.findIndex(function(e){return e instanceof mr?e.messageId===t:e instanceof xs?e.notificationId===t:void 0})},Kc=function(n,t){if(n.length>0){for(var e=0,r=n.length-1,i=Math.floor((e+r)/2);e<r;){var a=n[i].createdAt-t.createdAt;if(a>0)r=i,i=Math.floor((e+r)/2);else{if(!(a<0))return i;e=i+1,i=Math.floor((e+r)/2)}}return n[i].createdAt>t.createdAt?i:i+1}return n.length};(function(n){n[n.IDLE=0]="IDLE",n[n.RUNNING=1]="RUNNING",n[n.END=2]="END"})(da||(da={}));var zf,Za=function(n){function t(e,r,i,a){var s=n.call(this)||this;return s._state=da.IDLE,s._retryCount=0,s._retryLimit=3,s.priority=0,s._worker=r,s}return w(t,n),Object.defineProperty(t.prototype,"isIdle",{get:function(){return this._state===da.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._state===da.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDone",{get:function(){return this._state===da.END},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),t.prototype._run=function(e){return y(this,void 0,void 0,function(){var r,i;return v(this,function(a){switch(a.label){case 0:if(!this.isRunning)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._worker(e)];case 2:return r=a.sent(),this._retryCount=0,this.dispatch("progress",r),r.hasNext?this._run(r.nextToken):this.end(),[3,4];case 3:return i=a.sent(),this.dispatch("error",i),this._retryCount<this._retryLimit?(this._retryCount++,this._run(e)):this.stop(),[3,4];case 4:return[2]}})})},t.prototype.start=function(e){this.isIdle&&(this._state=da.RUNNING,this._run(e))},t.prototype.stop=function(){this._state=da.IDLE,this.dispatch("stop")},t.prototype.end=function(){this._state=da.END,this.dispatch("end")},t}(Bs),bi={},LM=function(){function n(t){var e=t._iid,r=t.channel,i=t.limit,a=i===void 0?100:i,s=this;this.ref=0,this._iid=e,this._channel=r,this._limit=a,this._prevSyncLoopCount=0;var u,o,l=k.of(this._iid),d=l.sdkState,c=l.cacheContext,f=l.dispatcher,h=l.logger,m=l.statManager,_=l.messageBackgroundSyncThrottleController;this._metadataKey=(u=d.userId,o=r.url,"sendbird:".concat(u,"@groupchannel/").concat(o,"/message/sync.meta"));var E=function(b,g){return"sendbird:".concat(b,"@groupchannel/").concat(g,"/message/sync")}(d.userId,r.url);this._prevSync=new Za(E,function(b){return y(s,void 0,void 0,function(){var g=this;return v(this,function(C){switch(C.label){case 0:return[4,_.run("message-background-sync-".concat(r.url,"-prev"),function(){return y(g,void 0,void 0,function(){var S,A,I,T,M,O,R,U,P,L,F,B;return v(this,function(V){switch(V.label){case 0:return S={hasNext:!0,nextToken:0},this._prevSyncLoopCount++,[4,this.loadMetadata()];case 1:if(V.sent(),h.debug("message background prev sync from",(O=this._metadata)===null||O===void 0?void 0:O.range.top),(R=this._metadata)===null||R===void 0?void 0:R.previousComplete)return[3,10];V.label=2;case 2:return V.trys.push([2,5,8,9]),[4,zt.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,!((P=(U=this._metadata)===null||U===void 0?void 0:U.range)===null||P===void 0)&&P.top?this._metadata.range.top:b,{prevResultSize:this._limit,nextResultSize:0,replyType:Kt.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0,isInclusive:!0},W.SYNC_MESSAGE_BACKGROUND)];case 3:return(A=V.sent()).length>0&&(I=A.map(function(K){return K.createdAt}),!((L=this._metadata)===null||L===void 0)&&(M=L.range).intersect.apply(M,Be([],we(I),!1))?this.extendRange(A):this._metadata={range:new qi({top:Math.min.apply(Math,Be([],we(I),!1)),bottom:Math.max.apply(Math,Be([],we(I),!1))}),previousComplete:!1}),S.hasNext=A.length>=this._limit&&this._prevSyncLoopCount<1,this._metadata&&(S.nextToken=this._metadata.range.top,this._metadata.previousComplete=A.length<this._limit),h.debug("message background prev sync progress",S),[4,this.saveMetadata()];case 4:return V.sent(),[3,9];case 5:return T=V.sent(),h.debug("message background prev sync error",T),T instanceof H&&T.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:V.sent(),V.label=7;case 7:throw T;case 8:return m.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:r.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:(B=(F=c.localCacheConfig)===null||F===void 0?void 0:F.maxSize)!==null&&B!==void 0?B:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 9:return[3,11];case 10:S.hasNext=!1,V.label=11;case 11:return[2,S]}})})})];case 1:return[2,C.sent()]}})})}),this._nextSync=new Za(E,function(b){return y(s,void 0,void 0,function(){var g=this;return v(this,function(C){switch(C.label){case 0:return[4,_.run("message-background-sync-".concat(r.url,"-next"),function(){return y(g,void 0,void 0,function(){var S,A,I,T,M,O,R,U,P,L,F;return v(this,function(B){switch(B.label){case 0:return S={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:B.sent(),h.debug("message background next sync from",(O=this._metadata)===null||O===void 0?void 0:O.range.bottom),B.label=2;case 2:return B.trys.push([2,5,6,7]),[4,zt.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,!((U=(R=this._metadata)===null||R===void 0?void 0:R.range)===null||U===void 0)&&U.bottom?this._metadata.range.bottom:b,{prevResultSize:0,nextResultSize:this._limit,replyType:Kt.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0,isInclusive:!0},W.SYNC_MESSAGE_BACKGROUND)];case 3:return(A=B.sent()).length>0&&(I=A.map(function(V){return V.createdAt}),!((P=this._metadata)===null||P===void 0)&&(M=P.range).intersect.apply(M,Be([],we(I),!1))?this.extendRange(A):this._metadata={range:new qi({top:Math.min.apply(Math,Be([],we(I),!1)),bottom:Math.max.apply(Math,Be([],we(I),!1))}),previousComplete:!1}),S.hasNext=A.length>=this._limit,this._metadata&&(S.nextToken=this._metadata.range.bottom),h.debug("message background next sync progress",S),[4,this.saveMetadata()];case 4:return B.sent(),[3,7];case 5:throw T=B.sent(),h.debug("message background next sync error",T),T;case 6:return m.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:r.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:(F=(L=c.localCacheConfig)===null||L===void 0?void 0:L.maxSize)!==null&&F!==void 0?F:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[2,S]}})})})];case 1:return[2,C.sent()]}})})}),this._connectionEventContext=f.on(function(b){b instanceof Kr&&(b.stateType===Wn.CONNECTED?s.resume():s.pause())})}return n.of=function(t,e){return bi[t]||(bi[t]={}),bi[t][e.url]||(bi[t][e.url]=new n({_iid:t,channel:e})),bi[t][e.url].ref++,bi[t][e.url]},n.clear=function(t,e){bi[t]&&bi[t][e]&&(bi[t][e].close(),delete bi[t])},Object.defineProperty(n.prototype,"range",{get:function(){var t,e;return(e=(t=this._metadata)===null||t===void 0?void 0:t.range)!==null&&e!==void 0?e:new qi({})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"previousComplete",{get:function(){var t;return!!(!((t=this._metadata)===null||t===void 0)&&t.previousComplete)},enumerable:!1,configurable:!0}),n.prototype.isWrappingMessages=function(t){var e;return(e=this.range)===null||e===void 0?void 0:e.includes.apply(e,Be([],we(t.map(function(r){return r.createdAt})),!1))},n.prototype.extendRange=function(t){var e;this._metadata&&(e=this._metadata.range).extends.apply(e,Be([],we(t.map(function(r){return r.createdAt})),!1))},n.prototype.loadMetadata=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return this._metadata?[3,2]:[4,k.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:t=e.sent(),this._metadata=t?{range:new qi(t.range),previousComplete:t.previousComplete}:{range:new qi({}),previousComplete:!1},e.label=2;case 2:return[2,this._metadata]}})})},n.prototype.saveMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._metadata?[4,k.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype.clearMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,k.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.resume=function(t){var e,r,i,a;t===void 0&&(t=Date.now());var s=k.of(this._iid),u=s.logger,o=s.sessionManager;s.cacheContext.localCacheEnabled&&o.session.hasSession&&(u.debug("message background sync resume()"),this._prevSyncLoopCount=0,this._metadata&&this._metadata.previousComplete||this._prevSync.start((r=(e=this._metadata)===null||e===void 0?void 0:e.range.top)!==null&&r!==void 0?r:t),this._nextSync.start((a=(i=this._metadata)===null||i===void 0?void 0:i.range.bottom)!==null&&a!==void 0?a:t))},n.prototype.pause=function(){k.of(this._iid).logger.debug("message background sync stop()"),this._prevSync.stop(),this._nextSync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete bi[this._iid][this._channel.url])},n}(),Ci={},UM=function(){function n(t){var e=t._iid,r=t.channel,i=t.includeParams,a=this;this.ref=0,this._iid=e,this._channel=r,this._includeParams=i;var s,u,o=k.of(this._iid),l=o.logger,d=o.sdkState,c=o.dispatcher;this._metadataKey=(s=d.userId,u=r.url,"sendbird:".concat(s,"@groupchannel/").concat(u,"/message/changelogs.meta"));var f=function(h,m){return"sendbird:".concat(h,"@groupchannel/").concat(m,"/message/changelogs")}(d.userId,this._channel.url);this._sync=new Za(f,function(){return y(a,void 0,void 0,function(){var h,m,_,E,b,g,C,S,A;return v(this,function(I){switch(I.label){case 0:return h={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:I.sent(),l.debug("message changelog sync from",(A=this._metadata)===null||A===void 0?void 0:A.token),I.label=2;case 2:return I.trys.push([2,5,,8]),[4,zt.of(this._iid).getMessageChangelogs(this._channel.url,this._channel.channelType,this._metadata.token,D({replyType:Kt.ALL},this._includeParams),W.SYNC_MESSAGE_CHANGELOGS)];case 3:return m=I.sent(),_=m.updatedMessages,E=m.deletedMessageIds,b=m.hasMore,g=m.token,C=m.forceUseNextToken,h.hasNext=b,h.nextToken=g,_.length>0||E.length>0?this._metadata&&(this._metadata.token=g):C&&this._metadata&&(this._metadata.token=g),l.debug("message changelog sync progress",h),[4,this.saveMetadata()];case 4:return I.sent(),[3,8];case 5:return S=I.sent(),l.debug("message changelog sync error",S),S instanceof H&&S.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:I.sent(),I.label=7;case 7:throw S;case 8:return[2,h]}})})}),this._connectionEventContext=c.on(function(h){h instanceof Kr&&(h.stateType===Wn.CONNECTED?a.resume():a.pause())})}return n.of=function(t,e,r){return Ci[t]||(Ci[t]={}),Ci[t][e.url]||(Ci[t][e.url]=new n({_iid:t,channel:e,includeParams:r})),Ci[t][e.url].ref++,Ci[t][e.url]},n.clear=function(t,e){Ci[t]&&Ci[t][e]&&(Ci[t][e].close(),delete Ci[t])},n.prototype.loadMetadata=function(){return y(this,void 0,void 0,function(){var t,e,r,i;return v(this,function(a){switch(a.label){case 0:return this._metadata?[3,2]:(t=k.of(this._iid),e=t.cacheContext,r=t.firstConnectedAt,[4,e.preference.get(this._metadataKey)]);case 1:i=a.sent(),this._metadata={token:i?i.token:r},a.label=2;case 2:return[2,this._metadata]}})})},n.prototype.saveMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._metadata?[4,k.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype.clearMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,k.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.resume=function(){var t=k.of(this._iid),e=t.logger;t.sessionManager.session.hasSession&&(e.debug("message changelog sync resume()"),this._sync.start(0))},n.prototype.pause=function(){k.of(this._iid).logger.debug("message changelog sync pause()"),this._sync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Ci[this._iid][this._channel.url])},n}(),us={},kM=function(){function n(t){var e=t._iid,r=t.channel,i=t.hasPollMessage,a=this;this.ref=0,this._iid=e,this._channel=r;var s,u,o=k.of(this._iid),l=o.logger,d=o.sdkState,c=o.dispatcher;this._metadataKey=(s=d.userId,u=r.url,"sendbird:".concat(s,"@groupchannel/").concat(u,"/poll/changelogs.meta"));var f=function(h,m){return"sendbird:".concat(h,"@groupchannel/").concat(m,"/poll/changelogs")}(d.userId,this._channel.url);this._sync=new Za(f,function(){return y(a,void 0,void 0,function(){var h,m,_,E,b,g,C,S;return v(this,function(A){switch(A.label){case 0:return h={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:return A.sent(),l.debug("poll changelog sync from",(S=this._metadata)===null||S===void 0?void 0:S.token),(m=!this._metadata||!this._metadata.token)?[4,i()]:[3,3];case 2:m=!A.sent(),A.label=3;case 3:if(m)return[2,{hasNext:!1,nextToken:0}];this._metadata||(_=k.of(this._iid).firstConnectedAt,this._metadata={token:_}),A.label=4;case 4:return A.trys.push([4,7,,10]),[4,cd.of(this._iid).getPollChangeLogs(this._channel.url,this._channel.channelType,this._metadata.token)];case 5:return E=A.sent(),b=E.hasMore,g=E.token,h.hasNext=b,h.nextToken=g,this._metadata.token=g,l.debug("poll changelog sync progress",h),[4,this.saveMetadata()];case 6:return A.sent(),[3,10];case 7:return C=A.sent(),l.debug("poll changelog sync error",C),C instanceof H&&C.isInvalidTokenError?[4,this.clearMetadata()]:[3,9];case 8:A.sent(),A.label=9;case 9:throw C;case 10:return[2,h]}})})}),this._connectionEventContext=c.on(function(h){h instanceof Kr&&(h.stateType===Wn.CONNECTED?a.resume():a.pause())})}return n.of=function(t,e,r){return us[t]||(us[t]={}),us[t][e.url]||(us[t][e.url]=new n({_iid:t,channel:e,hasPollMessage:r})),us[t][e.url].ref++,us[t][e.url]},n.prototype.loadMetadata=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return this._metadata?[3,2]:[4,k.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:t=e.sent(),this._metadata=t?{token:t.token}:void 0,e.label=2;case 2:return[2]}})})},n.prototype.saveMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._metadata?[4,k.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},n.prototype.clearMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,k.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.resume=function(){k.of(this._iid).logger.debug("poll changelog sync resume()"),this._sync.start(0)},n.prototype.pause=function(){k.of(this._iid).logger.debug("poll changelog sync pause()"),this._sync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete us[this._iid][this._channel.url])},n}(),xM=function(n){function t(e){var r,i,a,s,u,o,l,d,c,f,h=this;return(h=n.call(this)||this).method=J.GET,h.path="".concat(jn(e.channelType),"/").concat(e.channelUrl,"/messages_gap"),h.params=ge({prev_start_ts:e.prevStart,prev_end_ts:e.prevEnd,prev_cache_count:e.prevCount,next_start_ts:e.nextStart,next_end_ts:e.nextEnd,next_cache_count:e.nextCount,huge_gap_threshold:(r=e.threshold)!==null&&r!==void 0?r:null,reverse:!0,custom_types:(i=e.customTypes)!==null&&i!==void 0?i:["*"],message_type:(a=e.messageType)!==null&&a!==void 0?a:null,include_reply_type:(s=e.replyType)!==null&&s!==void 0?s:Kt.NONE,include_reactions_summary:(u=e.includeReactions)===null||u===void 0||u,include_meta_array:(o=e.includeMetaArray)===null||o===void 0||o,include_thread_info:(l=e.includeThreadInfo)===null||l===void 0||l,include_parent_message_info:(d=e.includeParentMessageInfo)===null||d===void 0||d,with_sorted_meta_array:(c=e.includeMetaArray)===null||c===void 0||c,show_subchannel_messages_only:(f=e.showSubchannelMessagesOnly)!==null&&f!==void 0&&f,include_poll_details:!0,checking_continuous_messages:e.checkingContinuousMessages}),h}return w(t,n),t}(ee),PM=function(n){function t(e,r){var i,a,s,u,o,l,d=this;return(d=n.call(this,e,r)||this).isHugeGap=r.is_huge_gap,d.prevMessages=((i=r.prev_messages)!==null&&i!==void 0?i:[]).map(function(c){return dr(e,c)}),d.prevHasMore=(a=r.prev_hasmore)!==null&&a!==void 0&&a,d.isContinuousPrevMessages=(s=r.is_continuous_prev_messages)!==null&&s!==void 0&&s,d.nextMessages=((u=r.next_messages)!==null&&u!==void 0?u:[]).map(function(c){return dr(e,c)}),d.nextHasmore=(o=r.next_hasmore)!==null&&o!==void 0&&o,d.isContinuousNextMessages=(l=r.is_continuous_next_messages)!==null&&l!==void 0&&l,d}return w(t,n),t}(ie),ig={includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeParentMessageInfo:!0};(function(n){n.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api"})(zf||(zf={}));var To,No,Io,FM=function(){function n(){this._onCacheResult=tn,this._onApiResult=tn}return n.prototype._invokeResponse=function(t,e,r){var i=this;Ae(function(){return y(i,void 0,void 0,function(){return v(this,function(a){switch(t){case"local":this._onCacheResult(e,r);break;case"remote":this._onApiResult(e,r)}return[2]})})})},n.prototype.onCacheResult=function(t){return this._onCacheResult=t,this},n.prototype.onApiResult=function(t){return this._onApiResult=t,this},n}(),HM=function(){function n(t,e){var r=e.filter,i=e.startingPoint,a=e.limit,s=e.prevResultLimit,u=e.nextResultLimit,o=e.channel,l=e.channelManager,d=e.disableBackgroundSync,c=d!==void 0&&d,f=this;this._messages=[],this._unsentMessages=[],this._isLoadingPrevious=!1,this._isLoadingNext=!1,this._iid=t,this._key="mc-".concat(ba()),this._isDisposed=!1,this.filter=r??new Xa,this._channel=o,this._syncRange=new qi({}),this._hasPrevious=!0,this._hasNext=!0,this._startingPoint=typeof i=="number"&&Number.isFinite(i)?i:Number.MAX_SAFE_INTEGER,this._limit=a||Pb,this._prevResultLimit=s??Math.floor(this._limit/2),this._nextResultLimit=u??Math.floor(this._limit/2),this._channelManager=l;var h=k.of(this._iid).statManager;this._channelManager.subscribeChannelEvent(this._key,{onUpdate:function(g,C){var S=C.source,A=g.findIndex(function(I){return I.isIdentical(f.channel)});A>=0&&(f._replaceChannelOfCollection(g[A]),f.channel._runIfHandleableWithGroupChannel(function(I){switch(S){case W.EVENT_CHANNEL_UPDATED:for(var T=!1,M=0;M<f._messages.length;M++)if(f._messages[M].createdAt>=I.messageOffsetTimestamp){T=!0;var O=M;if(O>0){var R=f._messages.splice(0,O);f._removeMessagesFromView(R.map(function(L){return f.keyOf(L)}),W.EVENT_MESSAGE_OFFSET_UPDATED)}break}!T&&f._messages.length>0&&f._removeMessagesFromView(f._messages.map(function(L){return f.keyOf(L)}),W.EVENT_MESSAGE_OFFSET_UPDATED);break;case W.EVENT_CHANNEL_UNMUTED:var U=k.of(f._iid).sdkState,P=C.user;U.userId===P.userId&&f._clearCheckMyMutedTimer();break;case W.EVENT_CHANNEL_MUTED:U=k.of(f._iid).sdkState,P=C.user,U.userId===P.userId&&I._myMutedRemainingTime!==-1&&f._startCheckMyMutedTimer(I._myMutedRemainingTime);break;case W.EVENT_CHANNEL_LEFT:I.isPublic&&f._clearCheckMyMutedTimer()}Ae(function(){return y(f,void 0,void 0,function(){var L;return v(this,function(F){return zl(S)&&(!((L=this._handler)===null||L===void 0)&&L.onChannelUpdated)&&this._handler.onChannelUpdated(C,this.channel),[2]})})})}),f._postprocessChannelUpdateEvent(g[A],S))},onRemove:function(g,C){var S=g.indexOf(f.channel.url);S>=0&&f._channel._runIfHandleableWithGroupChannel(function(A){A.myMemberState=Rt.NONE,f._clearCheckMyMutedTimer(),Ae(function(){return y(f,void 0,void 0,function(){var I;return v(this,function(T){return!((I=this._handler)===null||I===void 0)&&I.onChannelDeleted&&this._handler.onChannelDeleted(C,this.channel.url),[2]})})}),f._postprocessChannelRemoveEvent(g[S])})}}),this._channelManager.subscribeMessageEvent(this._key,{onUpdate:function(g,C){var S,A,I=[],T=[];try{for(var M=oe(g),O=M.next();!O.done;O=M.next()){var R=O.value;R.channelUrl===f._channel.url&&(f.filter.match(R)?I.push(R):T.push(f.keyOf(R)))}}catch(U){S={error:U}}finally{try{O&&!O.done&&(A=M.return)&&A.call(M)}finally{if(S)throw S.error}}if(la(C)){if(I.length>0)switch(C){case W.LOCAL_MESSAGE_CANCELED:case W.LOCAL_MESSAGE_RESEND_STARTED:case W.EVENT_MESSAGE_SENT_FAILED:case W.EVENT_MESSAGE_SENT_SUCCESS:case W.EVENT_MESSAGE_UPDATED:case W.EVENT_MESSAGE_THREADINFO_UPDATED:case W.EVENT_MESSAGE_REACTION_UPDATED:case W.EVENT_MESSAGE_FEEDBACK_ADDED:case W.EVENT_MESSAGE_FEEDBACK_UPDATED:case W.EVENT_MESSAGE_FEEDBACK_DELETED:case W.SYNC_MESSAGE_CHANGELOGS:f._updateMessagesToView(I,C);break;case W.EVENT_MESSAGE_SENT_PENDING:f._addMessagesToView(I,C);break;case W.EVENT_MESSAGE_RECEIVED:f.hasNext||f._addMessagesToView(I,C);break;case W.SYNC_MESSAGE_FILL:f._addMessagesToView(I,C)}T.length>0&&f._removeMessagesFromView(T,C)}f._postprocessMessageUpdateEvent(g,C)},onRemove:function(g,C){f._removeMessagesFromView(g,C),f._postprocessMessageRemoveEvent(g)},onRemoveUnsent:function(g,C){f._removeUnsentMessageFromView(g,C)},onPollChangeLogUpdate:function(g,C){f._updatePollsToView(g,C)},onPollUpdate:function(g,C){f._applyPollUpdateEventToView(g,C)},onPollVote:function(g,C){f._applyPollVoteEventToView(g,C)},onReactionUpdate:function(g,C){f._applyReactionEventToView(g,C)},onThreadInfoUpdate:function(g,C){f._applyThreadInfoEventToView(g,C)}});var m=k.of(this._iid),_=m.cacheContext,E=m.dispatcher,b=m.messageBackgroundSyncThrottleController;this._channel._updateMessageCollectionLastAccessedAt(),E.dispatch(new An({channels:[this._channel],context:{source:W.CHANNEL_LASTACCESSEDAT_UPDATED}})),this._backgroundSync=LM.of(this._iid,this._channel),!c&&this._shouldStartBackgroundSync()&&this._backgroundSync.resume(this._startingPoint),this._changelogSync=UM.of(this._iid,this._channel,this.changelogIncludeParams),this._changelogSync.resume(),this._pollChangelogSync=kM.of(this._iid,this._channel,this._hasPollMessage.bind(this)),this._pollChangelogSync.resume(),this._prevFill=new Za(this._key,function(g){return y(f,void 0,void 0,function(){var C=this;return v(this,function(S){switch(S.label){case 0:return[4,b.run("message-fill-sync-".concat(o.url,"-prev"),function(){return y(C,void 0,void 0,function(){var A,I,T,M,O,R,U;return v(this,function(P){switch(P.label){case 0:return[4,this._getRemoteMessages(g,{prevLimit:this._prevResultLimit,source:W.SYNC_MESSAGE_FILL,checkingContinuousMessages:_.localCacheEnabled})];case 1:return A=P.sent(),I=A.messages,T=A.isContinuousMessages,I.length>0?(M=Math.min.apply(Math,Be([],we(I.map(function(L){return L.createdAt})),!1)),this._syncRange.extends(M),T&&((O=this._backgroundSync)===null||O===void 0||O.range.extends(M)),[2,{hasNext:I.length>=this._prevResultLimit&&this.viewTop<M,nextToken:this._syncRange.top}]):(_.localCacheEnabled&&h.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(U=(R=_.localCacheConfig)===null||R===void 0?void 0:R.maxSize)!==null&&U!==void 0?U:0,use_local_cache:_.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}})})})];case 1:return[2,S.sent()]}})})}),this._nextFill=new Za(this._key,function(g){return y(f,void 0,void 0,function(){var C=this;return v(this,function(S){switch(S.label){case 0:return[4,b.run("message-fill-sync-".concat(o.url,"-next"),function(){return y(C,void 0,void 0,function(){var A,I,T,M,O,R,U,P;return v(this,function(L){switch(L.label){case 0:return[4,this._getRemoteMessages(g,{nextLimit:this._nextResultLimit,source:W.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:_.localCacheEnabled})];case 1:return A=L.sent(),I=A.messages,T=A.isContinuousMessages,M=A.hasNext,I.length>0?(O=Math.max.apply(Math,Be([],we(I.map(function(F){return F.createdAt})),!1)),this._syncRange.extends(O),T&&((R=this._backgroundSync)===null||R===void 0||R.range.extends(O)),[2,{hasNext:M,nextToken:this._syncRange.bottom}]):(_.localCacheEnabled&&h.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(P=(U=_.localCacheConfig)===null||U===void 0?void 0:U.maxSize)!==null&&P!==void 0?P:0,use_local_cache:_.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}})})})];case 1:return[2,S.sent()]}})})}),this._connectionEventContext=E.on(function(g){if(g instanceof Kr)switch(g.stateType){case Wn.CONNECTED:Lt(function(){return y(f,void 0,void 0,function(){return v(this,function(C){return this._activate(),[2]})})});break;case Wn.LOGOUT:f.dispose();break;default:f._clearCheckMyMutedTimer(),f._prevFill.stop(),f._nextFill.stop()}})}return n.prototype.keyOf=function(t){return 0},Object.defineProperty(n.prototype,"changelogIncludeParams",{get:function(){return{includeReactions:!0,includeThreadInfo:!0,includeMetaArray:!0,includeParentMessageInfo:!0}},enumerable:!1,configurable:!0}),n.prototype._postprocessChannelUpdateEvent=function(t,e){},n.prototype._postprocessChannelRemoveEvent=function(t){},n.prototype._postprocessMessageUpdateEvent=function(t,e){},n.prototype._postprocessMessageRemoveEvent=function(t){},Object.defineProperty(n.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"succeededMessages",{get:function(){return Be([],we(this._messages),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"failedMessages",{get:function(){return this._unsentMessages.filter(function(t){return t.sendingStatus===Qn.FAILED})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pendingMessages",{get:function(){return this._unsentMessages.filter(function(t){return t.sendingStatus===Qn.PENDING})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewTop",{get:function(){return Math.min.apply(Math,Be(Be([],we(this._messages.map(function(t){return t.createdAt})),!1),[Number.MAX_SAFE_INTEGER],!1))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewBottom",{get:function(){return Math.max.apply(Math,Be(Be([],we(this._messages.map(function(t){return t.createdAt})),!1),[0],!1))},enumerable:!1,configurable:!0}),n.prototype._activate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return k.of(this._iid).logger.debug("check huge gap"),this._checkHugeGap(),[4,this._refreshChannel(W.SYNC_CHANNEL_CHANGELOGS)];case 1:return t.sent(),[2]}})})},n.prototype._replaceChannelOfCollection=function(t){this._channel.isGroupChannel()?this._channel=t:this._channel.isFeedChannel()&&(this._channel._groupChannel=t._groupChannel)},n.prototype._shouldStartBackgroundSync=function(){var t=k.of(this._iid).cacheContext;return this.channel.isGroupChannel()?t.localCacheEnabled&&!this.channel.isSuper:t.localCacheEnabled},n.prototype._setBaseMessageCollectionHandler=function(t){this._handler=t},n.prototype._filterUnderOffsetMessage=function(t){return t},n.prototype._updateChildMessagesInView=function(t){var e=[];return this._messages.forEach(function(r){r instanceof mr&&r.parentMessageId===t.messageId&&r.applyParentMessage(t)&&e.push(r)}),e},n.prototype._updatePollsToView=function(t,e){var r,i,a=this,s=[];try{for(var u=oe(t),o=u.next();!o.done;o=u.next()){var l=o.value,d=Hu(this._messages,l.messageId);if(d>=0){var c=this._messages[d];c.isUserMessage()&&c.applyPoll(l),s.push(c)}}}catch(f){r={error:f}}finally{try{o&&!o.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return s.length>0&&la(e)&&Ae(function(){return y(a,void 0,void 0,function(){var f,h,m;return v(this,function(_){return f={source:e},s.length>0&&((m=(h=this._handler).onMessagesUpdated)===null||m===void 0||m.call(h,f,this.channel,s)),[2]})})}),s},n.prototype._applyPollUpdateEventToView=function(t,e){var r=this,i=Hu(this._messages,t.messageId);if(i>=0){var a=this._messages[i];a&&a.isUserMessage()&&a.poll&&a.poll.applyPollUpdateEvent(t)&&la(e)&&Ae(function(){return y(r,void 0,void 0,function(){var s,u,o;return v(this,function(l){return s={source:e},(o=(u=this._handler)===null||u===void 0?void 0:u.onMessagesUpdated)===null||o===void 0||o.call(u,s,this.channel,[a]),[2]})})})}},n.prototype._applyPollVoteEventToView=function(t,e){var r=this,i=Hu(this._messages,t.messageId);if(i>=0){var a=this._messages[i];a&&a.isUserMessage()&&a.poll&&a.poll.applyPollVoteEvent(t)&&la(e)&&Ae(function(){return y(r,void 0,void 0,function(){var s,u,o;return v(this,function(l){return s={source:e},(o=(u=this._handler)===null||u===void 0?void 0:u.onMessagesUpdated)===null||o===void 0||o.call(u,s,this.channel,[a]),[2]})})})}},n.prototype._applyReactionEventToView=function(t,e){var r=this,i=Hu(this._messages,t.messageId);if(i>=0){var a=this._messages[i];a&&(a.isUserMessage()||a.isFileMessage()||a.isMultipleFilesMessage())&&la(e)&&(a.applyReactionEvent(t),Ae(function(){return y(r,void 0,void 0,function(){var s,u,o;return v(this,function(l){return s={source:e},(o=(u=this._handler)===null||u===void 0?void 0:u.onMessagesUpdated)===null||o===void 0||o.call(u,s,this.channel,[a]),[2]})})}))}},n.prototype._applyThreadInfoEventToView=function(t,e){var r=this,i=Hu(this._messages,t.targetMessageId);if(i>=0){var a=this._messages[i];a&&(a.isUserMessage()||a.isFileMessage()||a.isMultipleFilesMessage())&&la(e)&&(a.applyThreadInfoUpdateEvent(t),Ae(function(){return y(r,void 0,void 0,function(){var s,u,o;return v(this,function(l){return s={source:e},(o=(u=this._handler)===null||u===void 0?void 0:u.onMessagesUpdated)===null||o===void 0||o.call(u,s,this.channel,[a]),[2]})})}))}},n.prototype._removeMessagesFromView=function(t,e){var r,i,a=this,s=[],u=[],o=function(f){var h=l._messages.findIndex(function(_){return a.keyOf(_)===f});if(h>=0){var m=l._messages[h];s.push(l.keyOf(m)),u.push(m),l._messages.splice(h,1)}},l=this;try{for(var d=oe(t),c=d.next();!c.done;c=d.next())o(c.value)}catch(f){r={error:f}}finally{try{c&&!c.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}return la(e)&&u.length>0&&Ae(function(){return y(a,void 0,void 0,function(){var f,h,m;return v(this,function(_){return f={source:e},(m=(h=this._handler)===null||h===void 0?void 0:h.onMessagesDeleted)===null||m===void 0||m.call(h,f,this.channel,s,u),[2]})})}),s},n.prototype._removeUnsentMessageFromView=function(t,e){var r=this._unsentMessages.findIndex(function(i){return i.reqId===t});r>=0&&this._unsentMessages.splice(r,1)},n.prototype._getLocalMessages=function(t,e){var r=e.prevLimit,i=r===void 0?0:r,a=e.nextLimit,s=a===void 0?0:a,u=e.inclusive,o=u===void 0||u;return y(this,void 0,void 0,function(){var l,d,c,f,h;return v(this,function(m){switch(m.label){case 0:return l=[],o?[4,this._channelManager.getExactlyMatchingMessagesForTokenFromCache(this._channel.url,t,this.filter)]:[3,2];case 1:l=m.sent(),m.label=2;case 2:return i>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,t,"prev",this.filter,i,!1)]:[3,4];case 3:return c=m.sent(),[3,5];case 4:c=[],m.label=5;case 5:return d=c,s>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,t,"next",this.filter,s,!1)]:[3,7];case 6:return h=m.sent(),[3,8];case 7:h=[],m.label=8;case 8:return f=h,[2,{messages:Be(Be(Be([],we(l),!1),we(d),!1),we(f),!1).sort(function(_,E){return E.createdAt-_.createdAt}),prevMessagesCount:d.length,nextMessagesCount:f.length}]}})})},n.prototype._getRemoteMessages=function(t,e){var r=e.prevLimit,i=r===void 0?0:r,a=e.nextLimit,s=a===void 0?0:a,u=e.source,o=u===void 0?W.REQUEST_MESSAGE:u,l=e.reverse,d=l!==void 0&&l,c=e.checkingHasNext,f=c!==void 0&&c,h=e.checkingContinuousMessages,m=h!==void 0&&h;return y(this,void 0,void 0,function(){var _,E;return v(this,function(b){switch(b.label){case 0:return _=zt.of(this._iid),i>0||s>0?[4,_._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,t,Re(D(D(D({},this.filter),ig),{isInclusive:!0,reverse:d,prevResultSize:i,nextResultSize:s})),o,f,m)]:[3,2];case 1:return E=b.sent(),[3,3];case 2:E={messages:[],isContinuousMessages:!1},b.label=3;case 3:return[2,E]}})})},n.prototype._checkHugeGap=function(){var t,e,r,i,a;return y(this,void 0,void 0,function(){var s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R,U,P,L,F,B=this;return v(this,function(V){switch(V.label){case 0:return s=k.of(this._iid),u=s.dispatcher,o=s.requestQueue,l=s.cacheContext,d=s.statManager,c=s.logger,this._messages.length>0?(f=this._syncRange.top,h=this.viewTop,m=this._syncRange.bottom,_=this.hasNext?this.viewBottom:Number.MAX_SAFE_INTEGER,[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,h,f)]):[3,8];case 1:return E=V.sent(),[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,m,_)];case 2:b=V.sent(),V.label=3;case 3:return V.trys.push([3,5,6,7]),[4,jd(function(){return y(B,void 0,void 0,function(){var K,$,q,se,Y,ce,X,Se,te,be,xe,Pe,vn,on,je,Xe,sn,un=this;return v(this,function(En){switch(En.label){case 0:return K=new xM(D(D({channelUrl:this._channel.url,channelType:this._channel.channelType,prevStart:h,prevEnd:f,prevCount:E,nextStart:m,nextEnd:_,nextCount:b,checkingContinuousMessages:l.localCacheEnabled},this.filter),ig)),[4,o.send(K)];case 1:return $=En.sent(),q=$.as(PM),se=q.isHugeGap,Y=q.prevMessages,ce=Y===void 0?[]:Y,X=q.prevHasMore,Se=q.isContinuousPrevMessages,te=q.nextMessages,be=te===void 0?[]:te,xe=q.nextHasmore,Pe=q.isContinuousNextMessages,se?Ae(function(){return y(un,void 0,void 0,function(){var rn;return v(this,function(qe){return!((rn=this._handler)===null||rn===void 0)&&rn.onHugeGapDetected&&this._handler.onHugeGapDetected(),[2]})})}):(vn=this.viewTop,on=this.viewBottom,je=Math.min.apply(Math,Be([Number.MAX_SAFE_INTEGER,vn],we(ce.map(function(rn){return rn.createdAt})),!1)),Xe=Math.max.apply(Math,Be([0,on],we(be.map(function(rn){return rn.createdAt})),!1)),u.dispatch(new mt({messages:ce,source:W.SYNC_MESSAGE_FILL})),u.dispatch(new mt({messages:be,source:W.SYNC_MESSAGE_FILL})),this._syncRange.extends(je,Xe),(Se||Pe)&&((sn=this._backgroundSync)===null||sn===void 0||sn.range.extends(je,Xe)),X&&this._prevFill.start(je),xe&&this._nextFill.start(Xe)),[2]}})})},1)];case 4:return V.sent(),[3,7];case 5:return g=V.sent(),c.debug("Failed HugeGap Check ",g),[3,7];case 6:return l.localCacheEnabled&&d.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(e=(t=l.localCacheConfig)===null||t===void 0?void 0:t.maxSize)!==null&&e!==void 0?e:0,use_local_cache:l.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[3,13];case 8:C=Date.now(),V.label=9;case 9:return V.trys.push([9,11,12,13]),[4,this._getRemoteMessages(C,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,source:W.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:l.localCacheEnabled})];case 10:if(S=V.sent(),A=S.messages,I=S.isContinuousMessages,T=S.hasNext,A.length>0){for(M=A.map(function(K){return K.createdAt}),O=0,R=0,U=0;U<M.length;U++)(P=M[U])<=C?O++:P>=C&&R++;this._hasPrevious=O>=this._prevResultLimit,this._hasNext=T??R>=this._nextResultLimit,(F=this._syncRange).extends.apply(F,Be([],we(M),!1)),I&&((r=this._backgroundSync)===null||r===void 0||r.range.extends(this._syncRange.top,this._syncRange.bottom)),this._addMessagesToView(A,W.SYNC_MESSAGE_FILL)}else this._hasPrevious=!1,this._hasNext=!1;return[3,13];case 11:return(L=V.sent())instanceof H&&L.code===Ne.NOT_FOUND_IN_DATABASE&&(this._hasPrevious=!1,this._hasNext=!1),[3,13];case 12:return l.localCacheEnabled&&d.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:(a=(i=l.localCacheConfig)===null||i===void 0?void 0:i.maxSize)!==null&&a!==void 0?a:0,use_local_cache:l.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 13:return[2]}})})},n.prototype._loadUnsentMessages=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return t=this,[4,this._channelManager.getUnsentMessagesFromCache(this._channel.url,this.filter)];case 1:return t._unsentMessages=e.sent(),[2]}})})},n.prototype._hasPollMessage=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this._channelManager.getPollMessagesFromCache(this._channel.url,Date.now()+6e5,this.filter,1)];case 1:return t.sent().length>0?[2,!0]:[2,!1]}})})},n.prototype._refreshChannel=function(t,e){return e===void 0&&(e=!1),y(this,void 0,void 0,function(){var r,i,a=this;return v(this,function(s){switch(s.label){case 0:r=k.of(this._iid).logger,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._channelManager.refreshChannel(this.channel.url,!0,t,e)];case 2:return s.sent(),this.channel._runIfHandleableWithGroupChannel(function(u){u.myMutedState===Ai.MUTED&&Lt(function(){return y(a,void 0,void 0,function(){var o;return v(this,function(l){switch(l.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(o=l.sent()).isMuted&&o.remainingDuration!==-1&&this._startCheckMyMutedTimer(o.remainingDuration),[2]}})})})}),[3,4];case 3:return i=s.sent(),r.warn("Failed to refresh channel",i),[3,4];case 4:return[2]}})})},n.prototype._startCheckMyMutedTimer=function(t){var e=this;this._clearCheckMyMutedTimer(),this._checkMyMutedStateTimer=setTimeout(function(){return y(e,void 0,void 0,function(){var r,i,a,s=this;return v(this,function(u){switch(u.label){case 0:this._checkMyMutedStateTimer=void 0,r=!0,u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,this._channel.getMyMutedInfo()];case 2:return i=u.sent(),r=!i.isMuted,[3,5];case 3:return u.sent(),r=!0,[3,5];case 4:return r&&(a=k.of(this._iid).sessionManager,this.channel._runIfHandleableWithGroupChannel(function(o){var l,d;o.myMutedState=Ai.UNMUTED;var c={source:W.EVENT_CHANNEL_UNMUTED,user:a.currentUser};(d=(l=s._handler)===null||l===void 0?void 0:l.onChannelUpdated)===null||d===void 0||d.call(l,c,s.channel)})),[7];case 5:return[2]}})})},t+1e3)},n.prototype._clearCheckMyMutedTimer=function(){this._checkMyMutedStateTimer&&(clearTimeout(this._checkMyMutedStateTimer),this._checkMyMutedStateTimer=void 0)},n.prototype._setHasNextAndHasPrevious=function(t,e){for(var r=t.map(function(o){return o.createdAt}),i=0,a=0,s=0;s<r.length;s++){var u=r[s];u<this._startingPoint?i++:u>this._startingPoint&&a++}this._hasPrevious=i>=this._prevResultLimit,this._hasNext=e??a>=this._nextResultLimit},n.prototype.initialize=function(t){var e=this,r=new FM;this._messages=[],this._unsentMessages=[],this._syncRange=new qi({}),this._hasNext=!0,this._hasPrevious=!0;var i=[],a={messages:[],prevMessagesCount:0,nextMessagesCount:0};return Ae(function(){return y(e,void 0,void 0,function(){var s,u,o,l,d,c=this;return v(this,function(f){switch(f.label){case 0:return[4,(d=this._backgroundSync)===null||d===void 0?void 0:d.loadMetadata()];case 1:return s=f.sent(),u=k.of(this._iid),o=u.cacheContext,l=u.statManager,t===zf.CACHE_AND_REPLACE_BY_API&&this._getLocalMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit}).then(function(h){return y(c,void 0,void 0,function(){return v(this,function(m){switch(m.label){case 0:return a=h,i=this._filterUnderOffsetMessage(a.messages),this._addMessagesToView(i,W.REQUEST_MESSAGE),[4,this._loadUnsentMessages()];case 1:return m.sent(),r._invokeResponse("local",null,i),[2]}})})}).catch(function(h){if(gr(h))throw h;r._invokeResponse("local",h,null)}).finally(function(){return y(c,void 0,void 0,function(){var h,m,_,E,b,g,C,S=this;return v(this,function(A){switch(A.label){case 0:return h=k.of(this._iid).cacheContext,m=!0,_=!0,E=!1,h.localCacheEnabled&&i.length>0&&(b=s.range).includes.apply(b,Be([],we(i.map(function(I){return I.createdAt})),!1))&&(!s.previousComplete&&a.prevMessagesCount<this._prevResultLimit?_=!0:this._startingPoint>s.range.bottom||a.nextMessagesCount<this._nextResultLimit?E=!0:_=!1),[4,this._refreshChannel(W.REFRESH_CHANNEL,E)];case 1:return A.sent(),E&&this._channel._runIfHandleableWithGroupChannel(function(I){var T=Math.max.apply(Math,Be([],we(i.map(function(M){return M.createdAt})),!1));I._latestMessageInfo&&T>=I._latestMessageInfo.createdAt&&(_=!1)}),_?(m=!1,this._getRemoteMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:h.localCacheEnabled}).then(function(I){var T,M,O,R=I.messages,U=I.isContinuousMessages,P=I.hasNext,L=S._filterUnderOffsetMessage(R);S._messages=[],L.length>0?(S._setHasNextAndHasPrevious(L,P),(T=S._syncRange).extends.apply(T,Be([],we(L.map(function(F){return F.createdAt})),!1)),U&&(!((M=S._backgroundSync)===null||M===void 0)&&M.range.overlap(S._syncRange))&&((O=S._backgroundSync)===null||O===void 0||O.range.extends(S._syncRange.top,S._syncRange.bottom)),S._addMessagesToView(L,W.REQUEST_MESSAGE)):(S._hasPrevious=!1,S._hasNext=!1),r._invokeResponse("remote",null,L)}).catch(function(I){if(gr(I))throw I;r._invokeResponse("remote",I,null)})):(this._setHasNextAndHasPrevious(i),r._invokeResponse("remote",null,i)),h.localCacheEnabled&&l.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"initial_load",event:m?"cache_hit":"cache_miss",max_db_size:(C=(g=h.localCacheConfig)===null||g===void 0?void 0:g.maxSize)!==null&&C!==void 0?C:0,message_init_policy:t,use_local_cache:h.localCacheEnabled,collection_id:this._key}})),[2]}})})}),l.put(new Lo({type:_t.FEATURE_LOCALCACHE,data:{use_local_cache:o.localCacheEnabled,collection_interface:{message_init_policy:t,message:!0}}})),[2]}})})}),r},n.prototype.loadPrevious=function(){var t,e,r;return y(this,void 0,void 0,function(){var i,a,s,u,o,l,d,c,f=this;return v(this,function(h){switch(h.label){case 0:if(this._isDisposed)throw new H({code:Ne.COLLECTION_DISPOSED,message:"Collection has been disposed."});return i=k.of(this._iid),a=i.cacheContext,s=i.statManager,u=i.logger,this._hasPrevious?this._isLoadingPrevious?(u.warn("Messages are already fetching."),[2,[]]):(this._isLoadingPrevious=!0,o=this.viewTop,l=[],[4,Lt(function(){return y(f,void 0,void 0,function(){var m;return v(this,function(_){switch(_.label){case 0:return[4,this._getLocalMessages(o,{prevLimit:this._prevResultLimit,inclusive:!1})];case 1:return m=_.sent(),l=this._filterUnderOffsetMessage(m.messages),[2]}})})})]):[2,[]];case 1:return h.sent(),d=l.length>=this._prevResultLimit,a.localCacheEnabled&&s.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:d?"cache_hit":"cache_miss",max_db_size:(e=(t=a.localCacheConfig)===null||t===void 0?void 0:t.maxSize)!==null&&e!==void 0?e:0,use_local_cache:a.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),d&&(!((r=this._backgroundSync)===null||r===void 0)&&r.isWrappingMessages(l))?[3,3]:(c=!1,[4,Lt(function(){return y(f,void 0,void 0,function(){var m,_,E,b,g,C,S,A=this;return v(this,function(I){switch(I.label){case 0:return m=k.of(this._iid).cacheContext,[4,this._getRemoteMessages(o,{prevLimit:this._prevResultLimit,reverse:!0,checkingContinuousMessages:m.localCacheEnabled})];case 1:return _=I.sent(),(l=this._filterUnderOffsetMessage(_.messages)).length>0&&((E=this._syncRange).extends.apply(E,Be([],we(l.map(function(T){return T.createdAt})),!1)),!((b=this._backgroundSync)===null||b===void 0)&&b.range.overlap(this._syncRange)&&_.isContinuousMessages&&(c=!0,(g=this._backgroundSync)===null||g===void 0||g.range.extends(this._syncRange.top))),l=l.filter(function(T){return Qr(A._messages,T)<0}),this._hasPrevious=l.length>=this._prevResultLimit,c&&s.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:"cache_fetch",max_db_size:(S=(C=m.localCacheConfig)===null||C===void 0?void 0:C.maxSize)!==null&&S!==void 0?S:0,use_local_cache:m.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}})})})]);case 2:return h.sent(),this._addMessagesToView(l,W.REQUEST_MESSAGE),[3,4];case 3:this._hasPrevious=l.length>=this._prevResultLimit,l.length>0&&this._addMessagesToView(l,W.REQUEST_MESSAGE),h.label=4;case 4:return this._isLoadingPrevious=!1,[2,l]}})})},n.prototype.loadNext=function(){var t,e,r;return y(this,void 0,void 0,function(){var i,a,s,u,o,l,d,c,f=this;return v(this,function(h){switch(h.label){case 0:if(this._isDisposed)throw new H({code:Ne.COLLECTION_DISPOSED,message:"Collection has been disposed."});return i=k.of(this._iid),a=i.cacheContext,s=i.statManager,u=i.logger,this._hasNext?this._isLoadingNext?(u.warn("Messages are already fetching."),[2,[]]):(this._isLoadingNext=!0,o=this.viewBottom,l=[],[4,Lt(function(){return y(f,void 0,void 0,function(){var m;return v(this,function(_){switch(_.label){case 0:return[4,this._getLocalMessages(o,{nextLimit:this._nextResultLimit,inclusive:!1})];case 1:return m=_.sent(),l=this._filterUnderOffsetMessage(m.messages),[2]}})})})]):[2,[]];case 1:return h.sent(),d=l.length>=this._nextResultLimit,a.localCacheEnabled&&s.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:d?"cache_hit":"cache_miss",max_db_size:(e=(t=a.localCacheConfig)===null||t===void 0?void 0:t.maxSize)!==null&&e!==void 0?e:0,use_local_cache:a.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),d&&(!((r=this._backgroundSync)===null||r===void 0)&&r.isWrappingMessages(l))?[3,3]:(c=!1,[4,Lt(function(){return y(f,void 0,void 0,function(){var m,_,E,b,g,C,S,A,I=this;return v(this,function(T){switch(T.label){case 0:return m=k.of(this._iid).cacheContext,[4,this._getRemoteMessages(o,{nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:m.localCacheEnabled})];case 1:return _=T.sent(),(l=this._filterUnderOffsetMessage(_.messages)).length>0&&((E=this._syncRange).extends.apply(E,Be([],we(l.map(function(M){return M.createdAt})),!1)),!((b=this._backgroundSync)===null||b===void 0)&&b.range.overlap(this._syncRange)&&_.isContinuousMessages&&(c=!0,(g=this._backgroundSync)===null||g===void 0||g.range.extends(this._syncRange.bottom))),l=l.filter(function(M){return Qr(I._messages,M)<0}),this._hasNext=(C=_.hasNext)!==null&&C!==void 0?C:l.length>=this._nextResultLimit,c&&s.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:"cache_fetch",max_db_size:(A=(S=m.localCacheConfig)===null||S===void 0?void 0:S.maxSize)!==null&&A!==void 0?A:0,use_local_cache:m.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}})})})]);case 2:return h.sent(),this._addMessagesToView(l,W.REQUEST_MESSAGE),[3,4];case 3:this._hasNext=l.length>=this._nextResultLimit,l.length>0&&this._addMessagesToView(l,W.REQUEST_MESSAGE),h.label=4;case 4:return this._isLoadingNext=!1,[2,l]}})})},n.prototype.removeFailedMessage=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(r){switch(r.label){case 0:if(this._isDisposed)throw new H({code:Ne.COLLECTION_DISPOSED,message:"Collection has been disposed."});return[4,this._channelManager.removeFailedMessageFromCache(t)];case 1:return r.sent(),(e=this._unsentMessages.findIndex(function(i){return i.reqId===t}))>-1&&this._unsentMessages.splice(e,1),[2]}})})},n.prototype.dispose=function(){var t,e,r,i=this;if(!this._isDisposed){this._isDisposed=!0;var a=k.of(this._iid),s=a.cacheContext,u=a.dispatcher;this._messages=[],this._clearCheckMyMutedTimer(),this._channel._runIfHandleableWithGroupChannel(function(o){o.myMemberState!==Rt.NONE&&(i._channel._updateMessageCollectionLastAccessedAt(),u.dispatch(new An({channels:[i._channel],context:{source:W.CHANNEL_LASTACCESSEDAT_UPDATED}})))}),s.localCacheEnabled&&(this._prevFill.stop(),this._nextFill.stop()),(t=this._backgroundSync)===null||t===void 0||t.close(),(e=this._changelogSync)===null||e===void 0||e.close(),(r=this._pollChangelogSync)===null||r===void 0||r.close(),this._channelManager.unsubscribeChannelEvent(this._key),this._channelManager.unsubscribeMessageEvent(this._key),this._connectionEventContext&&this._connectionEventContext.close()}},n}(),BM=function(n){function t(e,r){return n.call(this,e,D(D({},r),{channelManager:Yt.of(e)}))||this}return w(t,n),t.prototype.keyOf=function(e){return e.messageId},t.prototype.initialize=function(e){return n.prototype.initialize.call(this,e)},t.prototype.setMessageCollectionHandler=function(e){this._setBaseMessageCollectionHandler(e)},t.prototype._addMessagesToView=function(e,r){var i,a,s=this,u=this._filterUnderOffsetMessage(e),o=[],l=[];try{for(var d=oe(u),c=d.next();!c.done;c=d.next()){var f=c.value;if(r===W.SYNC_MESSAGE_FILL)if(f.messageId>0){if((E=Qr(this._messages,f))<0){Qr(this._unsentMessages,f)<0&&o.push(f);var h=Kc(this._messages,f);this._messages.splice(h,0,f)}}else f instanceof Dt&&(E=Qr(this._unsentMessages,f))<0&&Qr(this._messages,f)<0&&(this._unsentMessages.push(f),o.push(f));else if(f.messageId>0){if((E=Qr(this._messages,f))<0){var m=Qr(this._unsentMessages,f);m<0?o.push(f):(this._unsentMessages.splice(m,1),l.push(f)),h=Kc(this._messages,f),this._messages.splice(h,0,f)}else l.push(f),this._messages[E]=f;if(f.updatedAt>0){var _=this._updateChildMessagesInView(f);l.push.apply(l,Be([],we(_),!1))}}else if(f instanceof Dt){var E;(E=Qr(this._unsentMessages,f))<0?Qr(this._messages,f)<0&&(this._unsentMessages.push(f),o.push(f)):(l.push(f),this._unsentMessages[E]=f)}}}catch(b){i={error:b}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}la(r)&&Ae(function(){return y(s,void 0,void 0,function(){var b,g,C,S,A;return v(this,function(I){return b={source:r},o.length>0&&((C=(g=this._handler)===null||g===void 0?void 0:g.onMessagesAdded)===null||C===void 0||C.call(g,b,this.channel,o)),l.length>0&&((A=(S=this._handler)===null||S===void 0?void 0:S.onMessagesUpdated)===null||A===void 0||A.call(S,b,this.channel,l)),[2]})})})},t.prototype._updateMessagesToView=function(e,r){var i,a,s=this,u=[],o=[],l=[];try{for(var d=oe(e),c=d.next();!c.done;c=d.next()){var f,h=c.value;if(h.messageId>0)if((f=Qr(this._messages,h))>=0)o.push(h),this._messages[f]=h;else{var m=Qr(this._unsentMessages,h);if(m>=0){var _=we(this._unsentMessages.splice(m,1),1)[0];if(this.hasNext&&_)l.push(_);else{o.push(h);var E=Kc(this._messages,h);this._messages.splice(E,0,h)}}else{var b=this._messages.map(function(g){return g.createdAt});(h.createdAt<Math.min.apply(Math,Be([],we(b),!1))&&!this._hasPrevious||h.createdAt>Math.max.apply(Math,Be([],we(b),!1))&&!this._hasNext)&&u.push(h)}}else h instanceof Dt&&(f=Qr(this._unsentMessages,h))>=0&&(o.push(h),this._unsentMessages[f]=h)}}catch(g){i={error:g}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}return la(r)&&Ae(function(){return y(s,void 0,void 0,function(){var g,C,S,A,I;return v(this,function(T){return g={source:r},o.length>0?(S=(C=this._handler)===null||C===void 0?void 0:C.onMessagesUpdated)===null||S===void 0||S.call(C,g,this.channel,o):l.length>0?(I=(A=this._handler)===null||A===void 0?void 0:A.onMessagesDeleted)===null||I===void 0||I.call(A,g,this.channel,[],l):u.length>0&&this._addMessagesToView(u,r),[2]})})}),o},t}(HM),GM={coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isPublic:void 0,isDiscoverable:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},VM=function(n){function t(e){var r=this,i=e.channelUrl,a=e.token,s=e.limit,u=e.order,o=e.mutedMemberFilter,l=e.memberStateFilter,d=e.nicknameStartsWithFilter,c=e.operatorFilter;return(r=n.call(this)||this).method=J.GET,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/members"),r.params={token:a,limit:s,order:u,muted_member_filter:o,member_state_filter:l,nickname_startswith:d,operator_filter:c,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0},r}return w(t,n),t}(ee),jM=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.members=[];var a=r.next,s=r.members;return i.token=a,s&&s.length>0&&(i.members=s.map(function(u){return new ai(e,u)})),i}return w(t,n),t}(ie);(function(n){n.ALL="all",n.MUTED="muted",n.UNMUTED="unmuted"})(To||(To={})),function(n){n.MEMBER_NICKNAME_ALPHABETICAL="member_nickname_alphabetical",n.OPERATOR_THEN_MEMBER_ALPHABETICAL="operator_then_member_alphabetical"}(No||(No={})),function(n){n.ALL="all",n.JOINED="joined_only",n.INVITED="invited_only",n.INVITED_BY_FRIEND="invited_by_friend",n.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(Io||(Io={}));var qM=function(n){function t(e,r,i){var a,s,u,o,l=this;return(l=n.call(this,e,r,wn.GROUP,i)||this).mutedMemberFilter=To.ALL,l.memberStateFilter=Io.ALL,l.nicknameStartsWithFilter=null,l.operatorFilter=Cd.ALL,l.order=No.MEMBER_NICKNAME_ALPHABETICAL,l.mutedMemberFilter=(a=i.mutedMemberFilter)!==null&&a!==void 0?a:To.ALL,l.memberStateFilter=(s=i.memberStateFilter)!==null&&s!==void 0?s:Io.ALL,l.nicknameStartsWithFilter=(u=i.nicknameStartsWithFilter)!==null&&u!==void 0?u:null,l.order=(o=i.order)!==null&&o!==void 0?o:No.MEMBER_NICKNAME_ALPHABETICAL,l}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&_n(To,this.mutedMemberFilter)&&_n(Io,this.memberStateFilter)&&(x("string",this.nicknameStartsWithFilter)||this.nicknameStartsWithFilter===null)&&_n(Cd,this.operatorFilter)&&_n(No,this.order)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new VM(Re(D(D({},this),{token:this._token}))),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(jM),s=a.members,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),zM=function(n){function t(e){var r=this,i=e.channelUrl,a=e.userId,s=e.accessCode;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/accept"),r.params={user_id:a,access_code:s},r}return w(t,n),t}(ee),KM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new ci(e,r),i.channel.myMemberState=Rt.JOINED,i}return w(t,n),t}(ie),$M=function(n){function t(e){var r=this,i=e.channelUrl,a=e.isDistinct,s=e.isPublic,u=e.isDiscoverable,o=e.coverUrl,l=e.coverImage,d=e.accessCode,c=e.name,f=e.data,h=e.customType,m=e.operatorUserIds,_=e.messageSurvivalSeconds;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(yr,"/").concat(encodeURIComponent(i)),r.params=ge({is_distinct:a,is_public:s,is_discoverable:u,name:c,data:f,custom_type:h,cover_url:o,cover_file:l,access_code:d,operator_ids:m,message_survival_seconds:_}),r}return w(t,n),t}(ee),WM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new ci(e,r),i}return w(t,n),t}(ie),YM=function(n){function t(e){var r=this,i=e.channelUrl;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(yr,"/").concat(encodeURIComponent(i)),r}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var QM=function(n){function t(e){var r=this,i=e.channelUrl;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/hide"),r}return w(t,n),t}(ee);(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}w(t,n)})(ie);var XM=function(n){function t(e){var r=e.userId,i=e.channelUrl,a=e.countPreference,s=n.call(this)||this;return s.method=J.PUT,s.path="".concat(qn,"/").concat(encodeURIComponent(r),"/count_preference/").concat(encodeURIComponent(i)),s.params={count_preference:a},s}return w(t,n),t}(ee),ZM=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.countPreference=r.count_preference,i}return w(t,n),t}(ie),JM=function(n){function t(e){var r=this,i=e.channelUrl,a=e.locale;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(yr,"/").concat(encodeURIComponent(i),"/reset_user_history"),r.params=ge({locale:a}),r}return w(t,n),t}(ee),ew=function(n){function t(e,r){var i=n.call(this,e,r)||this,a=r.ts_message_offset;return i.messageOffsetTimestamp=a,i}return w(t,n),t}(ie),nw=D(D({},Lp),{scheduledAt:void 0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),tw=D(D({},Nb),{scheduledAt:void 0}),rw=function(n){function t(e){var r,i,a=this;a=n.call(this)||this;var s=[];e.mentionType===lr.USERS&&(e.mentionedUserIds?s=e.mentionedUserIds:e.mentionedUsers&&(s=e.mentionedUsers.map(function(d){return d.userId})));var u=e.channelType,o=e.channelUrl,l=e.scheduledMessageId;return a.method=J.PUT,a.path="".concat(jn(u),"/").concat(encodeURIComponent(o),"/scheduled_messages/").concat(encodeURIComponent(l)),a.params=ge(Re({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:mu.FILE,url:e.fileUrl,file_name:e.fileName,file_size:e.fileSize,file_type:e.mimeType,thumbnails:(r=e._thumbnails)===null||r===void 0?void 0:r.map(function(d){return Ta.payloadify(d)}),custom_type:e.customType,data:e.data,require_auth:e.requireAuth,mention_type:e.mentionType,mentioned_user_ids:s,sorted_metaarray:(i=e.metaArrays)===null||i===void 0?void 0:i.map(function(d){return Er.payloadify(d)}),apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,push_option:e.pushNotificationDeliveryOption})),a}return w(t,n),t}(ee),iw=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new Ft(e,r),i}return w(t,n),t}(ie),aw=function(n){function t(e){var r,i=this;i=n.call(this)||this;var a=[];e.mentionType===lr.USERS&&(e.mentionedUserIds?a=e.mentionedUserIds:e.mentionedUsers&&(a=e.mentionedUsers.map(function(l){return l.userId})));var s=e.channelType,u=e.channelUrl,o=e.scheduledMessageId;return i.method=J.PUT,i.path="".concat(jn(s),"/").concat(encodeURIComponent(u),"/scheduled_messages/").concat(encodeURIComponent(o)),i.params=ge(Re({req_id:e.reqId,scheduled_at:e.scheduledAt,message_type:mu.USER,message:e.message,custom_type:e.customType,data:e.data,mention_type:e.mentionType,mentioned_user_ids:a,sorted_metaarray:(r=e.metaArrays)===null||r===void 0?void 0:r.map(function(l){return Er.payloadify(l)}),apple_critical_alert_options:e.appleCriticalAlertOptions?Ei.payloadify(e.appleCriticalAlertOptions):null,target_langs:e.translationTargetLanguages,push_option:e.pushNotificationDeliveryOption})),i}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.message=new sr(e,r),i}w(t,n)})(ie);var ei,ni,sw=function(n){function t(e){var r=n.call(this)||this,i=e.channelType,a=e.channelUrl,s=e.scheduledMessageId;return r.method=J.DELETE,r.path="".concat(jn(i),"/").concat(encodeURIComponent(a),"/scheduled_messages/").concat(encodeURIComponent(s)),r}return w(t,n),t}(ee),uw=function(n){function t(e){var r=n.call(this)||this,i=e.channelType,a=e.channelUrl,s=e.scheduledMessageId;return r.method=J.POST,r.path="".concat(jn(i),"/").concat(encodeURIComponent(a),"/scheduled_messages/").concat(encodeURIComponent(s),"/send_now"),r}return w(t,n),t}(ee),ow=function(n){function t(e){var r=e.userId,i=e.channelUrl,a=e.pushTriggerOption,s=n.call(this)||this;return s.method=J.PUT,s.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push_preference/").concat(encodeURIComponent(i)),s.params={push_trigger_option:a},s}return w(t,n),t}(ee),lw=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTriggerOption=r.push_trigger_option,i.enabled=r.enable,i}return w(t,n),t}(ie),dw=function(n){function t(e){var r=e.userId,i=e.channelUrl,a=n.call(this)||this;return a.method=J.GET,a.path="".concat(qn,"/").concat(encodeURIComponent(r),"/push_preference/").concat(encodeURIComponent(i)),a}return w(t,n),t}(ee),cw=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.pushTriggerOption=r.push_trigger_option,i.enabled=r.enable,i}return w(t,n),t}(ie);(function(n){n.ALL="all",n.UNREAD_MESSAGE_COUNT_ONLY="unread_message_count_only",n.UNREAD_MENTION_COUNT_ONLY="unread_mention_count_only",n.OFF="off"})(ei||(ei={})),function(n){n.UNHIDDEN="unhidden",n.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",n.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(ni||(ni={}));var ci=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M=this;return(M=n.call(this,e,r)||this)._unreadMemberStateMap=new Map,M._undeliveredMemberStateMap=new Map,M._typingStatus=new Map,M._lastMemberCountUpdated=0,M._typingStarted=0,M._typingEnded=0,M._hasBotInfo={general:!1,ai:!1},M.isDistinct=!1,M.isSuper=!1,M.isBroadcast=!1,M.isExclusive=!1,M.isPublic=!1,M.isDiscoverable=!0,M.isChatNotification=!1,M.isAccessCodeRequired=!1,M.isPushEnabled=!1,M.unreadMessageCount=0,M.unreadMentionCount=0,M.totalUnreadReplyCount=0,M.members=[],M.memberCount=0,M.joinedMemberCount=0,M.hiddenState=ni.UNHIDDEN,M.lastMessage=null,M.messageOffsetTimestamp=0,M.messageSurvivalSeconds=-1,M.myMemberState=Rt.NONE,M.myRole=ui.NONE,M.myMutedState=Ai.UNMUTED,M.myLastRead=0,M.myCountPreference=ei.ALL,M.myPushTriggerOption=ys.DEFAULT,M.inviter=null,M.invitedAt=0,M.joinedAt=0,M.lastPinnedMessage=null,M._latestMessageInfo=null,M._pinnedMessagesUpdatedAt=0,M._myMutedRemainingTime=-1,M.channelType=wn.GROUP,M.isDistinct=(a=r.is_distinct)!==null&&a!==void 0&&a,M.isSuper=(s=r.is_super)!==null&&s!==void 0&&s,M.isBroadcast=(u=r.is_broadcast)!==null&&u!==void 0&&u,M.isExclusive=(o=r.is_exclusive)!==null&&o!==void 0&&o,M.isPublic=(l=r.is_public)!==null&&l!==void 0&&l,M.isDiscoverable=(d=r.is_discoverable)!==null&&d!==void 0?d:M.isPublic,M.isChatNotification=(c=r.is_chat_notification)!==null&&c!==void 0&&c,M.isAccessCodeRequired=(f=r.is_access_code_required)!==null&&f!==void 0&&f,M.isPushEnabled=(h=r.is_push_enabled)!==null&&h!==void 0&&h,Array.isArray(r.members)&&(i=M.members).push.apply(i,Be([],we(r.members.map(function(O){return new ai(M._iid,O)})),!1)),M.memberCount=(m=r.member_count)!==null&&m!==void 0?m:0,M.joinedMemberCount=(_=r.joined_member_count)!==null&&_!==void 0?_:0,M.hiddenState=_n(ni,r.hidden_state)?r.hidden_state:ni.UNHIDDEN,M.messageOffsetTimestamp=(E=r.ts_message_offset)!==null&&E!==void 0?E:0,M.messageSurvivalSeconds=(b=r.message_survival_seconds)!==null&&b!==void 0?b:-1,M.lastMessage=r.last_message?dr(M._iid,D({channel_type:M.channelType},r.last_message)):null,r.read_receipt&&Object.keys(r.read_receipt).forEach(function(O){x("number",r.read_receipt[O])&&M._updateUnreadMemberState(O,r.read_receipt[O])}),r.delivery_receipt&&Object.keys(r.delivery_receipt).forEach(function(O){x("number",r.delivery_receipt[O])&&M._updateUndeliveredMemberState(O,r.delivery_receipt[O])}),M.myMemberState=_n(Rt,r.member_state)?r.member_state:Rt.NONE,M.myRole=_n(ui,r.my_role)?r.my_role:ui.NONE,_n(Ai,r.is_muted)?M.myMutedState=r.is_muted:x("boolean",r.is_muted)?M.myMutedState=r.is_muted?Ai.MUTED:Ai.UNMUTED:M.myMutedState=Ai.UNMUTED,M.myCountPreference=_n(ei,r.count_preference)?r.count_preference:ei.ALL,M.myPushTriggerOption=_n(ys,r.push_trigger_option)?r.push_trigger_option:ys.ALL,M.myLastRead=(g=r.user_last_read)!==null&&g!==void 0?g:0,M.inviter=r.inviter?new Mn(M._iid,r.inviter):null,M.invitedAt=(C=r.invited_at)!==null&&C!==void 0?C:0,M.joinedAt=(S=r.joined_ts)!==null&&S!==void 0?S:0,M._updateUnreadCount((A=r.unread_message_count)!==null&&A!==void 0?A:0,(I=r.unread_mention_count)!==null&&I!==void 0?I:0),M.totalUnreadReplyCount=(T=r.total_unread_thread_message_count)!==null&&T!==void 0?T:0,M.lastPinnedMessage=r.latest_pinned_message?dr(M._iid,D({channel_type:M.channelType},r.latest_pinned_message)):null,r.latest_message&&(M._latestMessageInfo={messageId:r.latest_message.message_id,createdAt:r.latest_message.created_at}),M._hasBotInfo={general:!!r.has_bot,ai:!!r.has_ai_bot},M}return w(t,n),Object.defineProperty(t.prototype,"isHidden",{get:function(){return this.hiddenState!==ni.UNHIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTyping",{get:function(){return this._typingStatus.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUnreadMemberState",{get:function(){var e,r,i={};try{for(var a=oe(this._unreadMemberStateMap),s=a.next();!s.done;s=a.next()){var u=we(s.value,2),o=u[0],l=u[1];i[o]=l}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUndeliveredMemberState",{get:function(){var e,r,i={};try{for(var a=oe(this._undeliveredMemberStateMap),s=a.next();!s.done;s=a.next()){var u=we(s.value,2),o=u[0],l=u[1];i[o]=l}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBot",{get:function(){return this._hasBotInfo.general},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasAiBot",{get:function(){return this._hasBotInfo.ai},enumerable:!1,configurable:!0}),t.payloadify=function(e){return ge(Re(D(D({},n.payloadify.call(this,e)),{is_access_code_required:e.isAccessCodeRequired,is_distinct:e.isDistinct,is_super:e.isSuper,is_broadcast:e.isBroadcast,is_exclusive:e.isExclusive,is_public:e.isPublic,is_discoverable:e.isDiscoverable,is_muted:e.myMutedState,is_push_enabled:e.isPushEnabled,unread_message_count:e.unreadMessageCount,unread_mention_count:e.unreadMentionCount,total_unread_thread_message_count:e.totalUnreadReplyCount,push_trigger_option:e.myPushTriggerOption,count_preference:e.myCountPreference,hidden_state:e.hiddenState,member_count:e.memberCount,joined_member_count:e.joinedMemberCount,member_state:e.myMemberState,my_role:e.myRole,user_last_read:e.myLastRead,ts_message_offset:e.messageOffsetTimestamp,message_survival_seconds:e.messageSurvivalSeconds,read_receipt:e.cachedUnreadMemberState,delivery_receipt:e.cachedUndeliveredMemberState,members:e.members.map(function(r){return ai.payloadify(r)}),last_message:e.lastMessage?Rf(e.lastMessage):null,inviter:e.inviter?Mn.payloadify(e.inviter):null,invited_at:e.invitedAt,joined_ts:e.joinedAt,latest_pinned_message:e.lastPinnedMessage?Rf(e.lastPinnedMessage):null,latest_message:e._latestMessageInfo?{message_id:e._latestMessageInfo.messageId,created_at:e._latestMessageInfo.createdAt}:null,has_bot:e.hasBot,has_ai_bot:e.hasAiBot})))},t.prototype._shouldUpdateLastMessageWith=function(e){if(e.silent)return!1;var r=k.of(this._iid).appInfo;switch(r==null?void 0:r.lastMessageThreadingPolicy){case Ts.NONE:case Ts.INCLUDE_REPLY:break;case Ts.EXCLUDE_REPLY:if(e.parentMessageId>0)return!1;break;case Ts.INCLUDE_REPLY_TO_CHANNEL:if(e instanceof Dt&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!this.lastMessage||this.lastMessage.createdAt<e.createdAt||this.lastMessage.createdAt===e.createdAt&&this.lastMessage.messageId===e.messageId&&this.lastMessage.updatedAt<e.updatedAt},t.prototype._tryUpdateLastMessageAndCallEvents=function(e,r){var i=k.of(this._iid).dispatcher,a=Yt.of(this._iid);this._updateLastMessage(r),a.handlers.map(function(s){s.onChannelChanged&&s.onChannelChanged(e)}),i.dispatch(new An({channels:[e],context:{source:W.EVENT_MESSAGE_SENT}}))},t.prototype._shouldUpdateUnreadCountWith=function(e){var r=k.of(this._iid).appInfo;switch(r==null?void 0:r.unreadCountThreadingPolicy){case Ss.NONE:case Ss.INCLUDE_REPLY:break;case Ss.EXCLUDE_REPLY:if(e.parentMessageId>0)return!1;break;case Ss.INCLUDE_REPLY_TO_CHANNEL:if(e instanceof Dt&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!0},t.prototype._updateLastMessage=function(e){return!!this._shouldUpdateLastMessageWith(e)&&(this.lastMessage=e,!0)},t.prototype._updateUnreadCount=function(e,r){if(typeof e=="number"&&e>=0)if(this.myCountPreference===ei.ALL||this.myCountPreference===ei.UNREAD_MESSAGE_COUNT_ONLY)if(this.isExclusive||this.isSuper||this.isBroadcast){var i=k.of(this._iid).maxSuperGroupChannelUnreadCount;this.unreadMessageCount=i&&e>=i?i:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;else this.unreadMessageCount=0;typeof r=="number"&&r>=0&&(this.myCountPreference===ei.ALL||this.myCountPreference===ei.UNREAD_MENTION_COUNT_ONLY)?this.unreadMentionCount=r:this.unreadMentionCount=0},t.prototype._updateUnreadMemberState=function(e,r){var i=this._unreadMemberStateMap.get(e);return(!i||i<r)&&(this._unreadMemberStateMap.set(e,r),k.of(this._iid).sdkState.userId===e&&(this.myLastRead=r),!0)},t.prototype._updateUndeliveredMemberState=function(e,r){var i=this._undeliveredMemberStateMap.get(e);return(!i||i<r)&&(this._undeliveredMemberStateMap.set(e,r),!0)},t.prototype._updateTypingStatus=function(e,r){r===void 0&&(r=new Date().getTime()),r>0?this._typingStatus.set(e.userId,{user:e,ts:r}):this._typingStatus.delete(e.userId)},t.prototype._clearTypingStatus=function(){this._typingStatus.clear(),this._typingStarted=0,this._typingEnded=0},t.prototype._setLatestMemberCount=function(e,r,i){var a=!1;return i>=this._lastMemberCountUpdated&&(this._lastMemberCountUpdated=i,a=e!==this.memberCount||r!==this.joinedMemberCount,this.memberCount=e,this.joinedMemberCount=r),a},t.prototype.isReadMessage=function(e){var r=k.of(this._iid).sdkState,i=this._unreadMemberStateMap.get(r.userId);return!!i&&i>=e.createdAt},t.prototype.serialize=function(){var e=this;return Au(this,function(r){r.cachedUnreadMemberState=e.cachedUnreadMemberState,r.cachedUndeliveredMemberState=e.cachedUndeliveredMemberState,Object.assign(r,e._serializeCachedMetaData())})},t.prototype.createMessageCollection=function(e){return e===void 0&&(e={}),new BM(this._iid,D(D({},e),{channel:this}))},t.prototype.createMemberListQuery=function(e){return e===void 0&&(e={}),new qM(this._iid,this.url,e)},t.prototype.createThreadedParentMessageListQuery=function(e){return e===void 0&&(e={}),new x2(this._iid,this.url,this.channelType,e)},t.prototype.addMember=function(e,r){if(r===void 0&&(r=0),!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var i=this.members.findIndex(function(s){return s.userId===e.userId});if(i>-1){var a=this.members[i];a.state===Rt.JOINED&&(e.state=a.state),this.members.splice(i,1),this.memberCount--}this.members.push(e),this.memberCount++,this._updateUnreadMemberState(e.userId,r),this._updateUndeliveredMemberState(e.userId,r)}},t.prototype.removeMember=function(e){if(!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var r=e instanceof ai?e.userId:e,i=this.members.findIndex(function(a){return a.userId===r});if(i>-1)return this.members.splice(i,1),this.memberCount--,!0}return!1},t.prototype.getUnreadMemberCount=function(e){var r,i;if(e instanceof Dt&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var a=k.of(this._iid).sdkState,s=e.createdAt,u=0;try{for(var o=oe(this.members),l=o.next();!l.done;l=o.next()){var d=l.value;a.userId!==d.userId&&d.state===Rt.JOINED&&e.sender.userId!==d.userId&&(this.cachedUnreadMemberState[d.userId]||0)<s&&u++}}catch(c){r={error:c}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return u}return 0},t.prototype.getUndeliveredMemberCount=function(e){var r,i;if(e instanceof Dt&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var a=k.of(this._iid).sdkState,s=e.createdAt,u=0;try{for(var o=oe(this.members),l=o.next();!l.done;l=o.next()){var d=l.value;a.userId!==d.userId&&d.state===Rt.JOINED&&e.sender.userId!==d.userId&&(this.cachedUndeliveredMemberState[d.userId]||0)<s&&u++}}catch(c){r={error:c}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return u}return 0},t.prototype.getReadMembers=function(e,r){var i=this;r===void 0&&(r=!1);var a=k.of(this._iid).sdkState;if(!a.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var s=e instanceof Dt?e.sender:null,u=[];return this.members.forEach(function(o){if(r||o.userId!==a.userId&&o.userId!==(s==null?void 0:s.userId)){var l=i._unreadMemberStateMap.get(o.userId);l&&l>=e.createdAt&&u.push(o)}}),u},t.prototype.getUnreadMembers=function(e,r){var i=this;r===void 0&&(r=!1);var a=k.of(this._iid).sdkState;if(!a.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var s=e instanceof Dt?e.sender:null,u=[];return this.members.forEach(function(o){if(r||o.userId!==a.userId&&o.userId!==(s==null?void 0:s.userId)){var l=i._unreadMemberStateMap.get(o.userId);l&&l<e.createdAt&&u.push(o)}}),u},t.prototype.getReadStatus=function(e){var r=this;e===void 0&&(e=!1);var i=k.of(this._iid).sdkState;if(!i.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var a={};return this.members.forEach(function(s){if(e||s.userId!==i.userId){var u=r._unreadMemberStateMap.get(s.userId);a[s.userId]=new gb(r._iid,{channel_url:r.url,channel_type:r.channelType,user:ai.payloadify(s),ts:u??0})}}),a},t.prototype.getDeliveryStatus=function(e){var r=this;e===void 0&&(e=!0);var i=k.of(this._iid).sdkState;if(!i.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var a={};return this.members.forEach(function(s){if(e||s.userId!==i.userId){var u=r._undeliveredMemberStateMap.get(s.userId);a[s.userId]=new jA(r._iid,{channel_url:r.url,channel_type:r.channelType,user:ai.payloadify(s),ts:u??0})}}),a},t.prototype.getTypingUsers=function(){var e=[];return this._typingStatus.forEach(function(r){var i=r.user;e.push(i)}),e},t.prototype.invalidateTypingStatus=function(){var e=this,r=k.of(this._iid).typingIndicatorInvalidateTime,i=Date.now(),a=!1;return this._typingStatus.forEach(function(s,u){var o=s.ts;i-o>=r&&(e._typingStatus.delete(u),a=!0)}),a},t.prototype.refresh=function(){return y(this,void 0,void 0,function(){return v(this,function(e){return[2,this._refresh()]})})},t.prototype._refresh=function(e){return e===void 0&&(e=!1),y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return r=k.of(this._iid),i=r.requestQueue,a=r.dispatcher,s=new Vf({channelUrl:this.url}),[4,i.send(s)];case 1:return u=l.sent(),o=u.as(jf).channel,this._update(o),e||a.dispatch(new An({channels:[o],context:{source:W.REFRESH_CHANNEL}})),[2,this]}})})},t.prototype.freeze=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,n.prototype.freeze.call(this)];case 1:return e.sent(),k.of(this._iid).dispatcher.dispatch(new An({channels:[this],context:{source:W.EVENT_CHANNEL_FROZEN},isWebSocketEventComing:!0})),[2]}})})},t.prototype.unfreeze=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,n.prototype.unfreeze.call(this)];case 1:return e.sent(),k.of(this._iid).dispatcher.dispatch(new An({channels:[this],context:{source:W.EVENT_CHANNEL_UNFROZEN},isWebSocketEventComing:!0})),[2]}})})},t.prototype.updateChannel=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return r=D(D({},GM),e),ne(function(c){return x("string",c.coverUrl,!0)&&(Zt(c.coverImage)||x("string",c.coverImage,!0))&&x("boolean",c.isDistinct,!0)&&x("boolean",c.isPublic,!0)&&x("boolean",c.isDiscoverable,!0)&&x("string",c.accessCode,!0)&&x("string",c.name,!0)&&x("string",c.data,!0)&&x("string",c.customType,!0)&&gn("string",c.operatorUserIds,!0)&&x("number",c.messageSurvivalSeconds,!0)}(r)).throw(H.invalidParameters),i=k.of(this._iid),a=i.dispatcher,s=i.requestQueue,u=new $M(D({channelUrl:this.url},r)),[4,s.send(u)];case 1:return o=d.sent(),l=o.as(WM).channel,this._update(l),a.dispatch(new An({channels:[l],context:{source:W.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.invite=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return ne(e.every(function(i){return i instanceof Mn})).throw(H.invalidParameters),[2,this.inviteWithUserIds(e.map(function(i){return i.userId}))]})})},t.prototype.inviteWithUserIds=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return ne(gn("string",e)).throw(H.invalidParameters),r=k.of(this._iid),i=r.dispatcher,a=r.requestQueue,s=r.sessionManager,u=new EM({channelUrl:this.url,userIds:e}),[4,a.send(u)];case 1:return o=d.sent(),l=o.as(vM).channel,this._update(l),i.dispatch(new An({channels:[l],context:{source:W.EVENT_CHANNEL_INVITED,inviter:s.currentUser,invitees:[]},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.join=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return ne(x("string",e,!0)).throw(H.invalidParameters),r=k.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,u=new hM({channelUrl:this.url,userId:a.userId,accessCode:e}),[4,s.send(u)];case 1:return o=d.sent(),(l=o.as(pM).channel).myMemberState=this.myMemberState=Rt.JOINED,this._update(l),i.dispatch(new An({channels:[l],context:{source:W.EVENT_CHANNEL_JOINED,users:[]},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.leave=function(e){return e===void 0&&(e=!1),y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return r=k.of(this._iid),i=r.sdkState,a=r.requestQueue,s=new _M({channelUrl:this.url,userId:i.userId,shouldRemoveOperatorStatus:e}),[4,a.send(s)];case 1:return u.sent(),this.myMemberState=Rt.NONE,[2]}})})},t.prototype.acceptInvitation=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return ne(x("string",e,!0)).throw(H.invalidParameters),r=k.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,u=new zM({channelUrl:this.url,userId:a.userId,accessCode:e}),[4,s.send(u)];case 1:return o=d.sent(),(l=o.as(KM).channel).myMemberState=this.myMemberState=Rt.JOINED,this._update(l),i.dispatch(new An({channels:[l],context:{source:W.EVENT_CHANNEL_ACCEPTED_INVITE},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.declineInvitation=function(){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new bM({channelUrl:this.url,userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),this.myMemberState=Rt.NONE,[2,this]}})})},t.prototype.sendUserMessage=function(e){var r=this,i=new Vr,a=k.of(this._iid).dispatcher,s=ro.of(this._iid);return n.prototype.sendUserMessage.call(this,e).onPending(function(u){s.completeCurrentAndProcessNextAutoResend(u),i._trigger(u)}).onFailed(function(u,o){o&&s.completeCurrentAndProcessNextAutoResend(o),i._triggerFailed(u,o)}).onSucceeded(function(u){s.completeCurrentAndProcessNextAutoResend(u),r._updateLastMessage(u),Yt.of(r._iid).handlers.map(function(o){o.onChannelChanged&&o.onChannelChanged(r)}),a.dispatch(new An({channels:[r],context:{source:W.EVENT_MESSAGE_SENT}})),i._trigger(u)}),i},t.prototype.updateUserMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u,o=this;return v(this,function(l){switch(l.label){case 0:return i=k.of(this._iid).dispatcher,[4,n.prototype.updateUserMessage.call(this,e,r)];case 1:return a=l.sent(),s=this._updateLastMessage(a),u=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===a.messageId&&(this.lastPinnedMessage=a,s=!0,u=!0),s&&(Yt.of(this._iid).handlers.map(function(d){d.onChannelChanged&&d.onChannelChanged(o)}),i.dispatch(new An({channels:[this],context:{source:u?W.EVENT_PINNED_MESSAGE_UPDATED:W.EVENT_MESSAGE_UPDATED}}))),u&&Yt.of(this._iid).handlers.map(function(d){d.onPinnedMessageUpdated&&d.onPinnedMessageUpdated(o)}),i.dispatch(new mt({messages:[a],source:W.EVENT_MESSAGE_UPDATED})),[2,a]}})})},t.prototype._autoResendUserMessage=function(e){var r=this,i=new Vr,a=k.of(this._iid).dispatcher,s=ro.of(this._iid);return n.prototype._autoResendUserMessage.call(this,e).onPending(function(u){s.completeCurrentAndProcessNextAutoResend(u),i._trigger(u)}).onFailed(function(u,o){s.completeCurrentAndProcessNextAutoResend(o),i._triggerFailed(u,o)}).onSucceeded(function(u){var o=Yt.of(r._iid);s.completeCurrentAndProcessNextAutoResend(u),r._updateLastMessage(u),o.handlers.map(function(l){l.onChannelChanged&&l.onChannelChanged(r)}),a.dispatch(new An({channels:[r],context:{source:W.EVENT_MESSAGE_SENT}})),i._trigger(u)}),i},t.prototype.sendFileMessage=function(e){var r=this,i=new Vr,a=k.of(this._iid).dispatcher,s=ro.of(this._iid);return n.prototype.sendFileMessage.call(this,e).onPending(function(u){s.completeCurrentAndProcessNextAutoResend(u),i._trigger(u)}).onFailed(function(u,o){o&&s.completeCurrentAndProcessNextAutoResend(o),i._triggerFailed(u,o)}).onSucceeded(function(u){var o=Yt.of(r._iid);s.completeCurrentAndProcessNextAutoResend(u),r._updateLastMessage(u),o.handlers.map(function(l){l.onChannelChanged&&l.onChannelChanged(r)}),a.dispatch(new An({channels:[r],context:{source:W.EVENT_MESSAGE_SENT}})),i._trigger(u)}),i},t.prototype.sendMultipleFilesMessage=function(e){var r=this,i=new Gl,a=k.of(this._iid).dispatcher;return n.prototype.sendMultipleFilesMessage.call(this,e).onPending(function(s){i._trigger(s)}).onFailed(function(s,u){i._triggerFailed(s,u)}).onSucceeded(function(s){var u=Yt.of(r._iid);r._updateLastMessage(s),u.handlers.map(function(o){o.onChannelChanged&&o.onChannelChanged(r)}),a.dispatch(new An({channels:[r],context:{source:W.EVENT_MESSAGE_SENT}})),i._trigger(s)}).onFileUploaded(function(s,u,o,l){i._triggerOnFileUploaded(s,u,o,l)}),i},t.prototype.updateFileMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u,o=this;return v(this,function(l){switch(l.label){case 0:return i=k.of(this._iid).dispatcher,[4,n.prototype.updateFileMessage.call(this,e,r)];case 1:return a=l.sent(),s=this._updateLastMessage(a),u=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===a.messageId&&(this.lastPinnedMessage=a,s=!0,u=!0),s&&(Yt.of(this._iid).handlers.map(function(d){d.onChannelChanged&&d.onChannelChanged(o)}),i.dispatch(new An({channels:[this],context:{source:u?W.EVENT_PINNED_MESSAGE_UPDATED:W.EVENT_MESSAGE_UPDATED}}))),u&&Yt.of(this._iid).handlers.map(function(d){d.onPinnedMessageUpdated&&d.onPinnedMessageUpdated(o)}),i.dispatch(new mt({messages:[a],source:W.EVENT_MESSAGE_UPDATED})),[2,a]}})})},t.prototype._autoResendFileMessage=function(e){var r=this,i=new Vr,a=k.of(this._iid).dispatcher,s=ro.of(this._iid);return n.prototype._autoResendFileMessage.call(this,e).onPending(function(u){s.completeCurrentAndProcessNextAutoResend(u),i._trigger(u)}).onFailed(function(u,o){s.completeCurrentAndProcessNextAutoResend(o),i._triggerFailed(u,o)}).onSucceeded(function(u){var o=Yt.of(r._iid);s.completeCurrentAndProcessNextAutoResend(u),r._updateLastMessage(u),o.handlers.map(function(l){l.onChannelChanged&&l.onChannelChanged(r)}),a.dispatch(new An({channels:[r],context:{source:W.EVENT_MESSAGE_SENT}})),i._trigger(u)}),i},t.prototype.deleteMessage=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,n.prototype.deleteMessage.call(this,e)];case 1:return r.sent(),e.messageId===0&&e instanceof Dt&&k.of(this._iid).dispatcher.dispatch(new sb({reqId:e.reqId,source:W.EVENT_MESSAGE_DELETED})),[2]}})})},t.prototype.hide=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d;return v(this,function(c){switch(c.label){case 0:return r=D(D({},qf),e),ne(function(f){return x("boolean",f.hidePreviousMessages,!0)&&x("boolean",f.allowAutoUnhide,!0)}(r)).throw(H.invalidParameters),i=k.of(this._iid),a=i.dispatcher,s=i.sdkState,u=i.requestQueue,o=new SM(D({channelUrl:this.url,userId:s.userId},r)),[4,u.send(o)];case 1:return l=c.sent(),d=l.as(TM).messageOffsetTimestamp,this.hiddenState=r.allowAutoUnhide?ni.HIDDEN_ALLOW_AUTO_UNHIDE:ni.HIDDEN_PREVENT_AUTO_UNHIDE,r.hidePreviousMessages&&this._updateUnreadCount(0,0),d&&(this.messageOffsetTimestamp=d),a.dispatch(new An({channels:[this],context:{source:W.EVENT_CHANNEL_HIDDEN},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.unhide=function(){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return e=k.of(this._iid),r=e.dispatcher,i=e.requestQueue,a=new QM({channelUrl:this.url}),[4,i.send(a)];case 1:return s.sent(),this.hiddenState=ni.UNHIDDEN,r.dispatch(new An({channels:[this],context:{source:W.EVENT_CHANNEL_UNHIDDEN},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype.delete=function(){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=k.of(this._iid).requestQueue,r=new YM({channelUrl:this.url}),[4,e.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.markAsRead=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l=this;return v(this,function(d){switch(d.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.dispatcher,a=e.requestQueue,s=new hN({channelUrl:this.url}),[4,a.send(s)];case 1:return u=d.sent(),o=u.as(Eb).readStatus,this._updateUnreadMemberState(r.userId,o.readAt),(this.unreadMessageCount>0||this.unreadMentionCount>0)&&(this._updateUnreadCount(0,0),Yt.of(this._iid).handlers.map(function(c){c.onChannelChanged&&c.onChannelChanged(l)})),i.dispatch(new An({channels:[this],context:{source:W.EVENT_CHANNEL_READ}})),[2]}})})},t.prototype.markAsDelivered=function(){return y(this,void 0,void 0,function(){var e,r,i,a;return v(this,function(s){switch(s.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new RM({channelUrl:this.url,userId:r.userId}),[4,i.send(a)];case 1:return s.sent(),[2]}})})},t.prototype.startTyping=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return e=k.of(this._iid),r=e.requestQueue,i=e.typingIndicatorThrottle,(a=new Date().getTime())-this._typingStarted>=i?(this._typingStarted=a,this._typingEnded=0,s=new IM({channelUrl:this.url,time:this._typingStarted}),[4,r.send(s)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}})})},t.prototype.endTyping=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s;return v(this,function(u){switch(u.label){case 0:return e=k.of(this._iid),r=e.requestQueue,i=e.typingIndicatorThrottle,(a=new Date().getTime())-this._typingEnded>=i?(this._typingStarted=0,this._typingEnded=a,s=new MM({channelUrl:this.url,time:this._typingStarted}),[4,r.send(s)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}})})},t.prototype.createScheduledUserMessage=function(e){e=D(D({},y2),e),ne(b2(e)).throw(H.invalidParameters);var r=new Vr;return this._createScheduledUserMessage(e,r),r},t.prototype.updateScheduledUserMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u;return v(this,function(o){switch(o.label){case 0:return i=D(D({},tw),r),ne(function(l){return Ib(l)&&x("number",l.scheduledAt,!0)}(i)).throw(H.invalidParameters),a=k.of(this._iid).requestQueue,s=new aw(D({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},i)),[4,a.send(s)];case 1:return u=o.sent(),[2,u.as(Ub).message]}})})},t.prototype.createScheduledFileMessage=function(e){var r=this;e=D(D({},C2),e),ne(S2(e)).throw(H.invalidParameters);var i=Date.now(),a=this._generateRequestId(),s=new Vr;return Or(QI).then(function(){var u=r._createPendingScheduledFileMessage(e,a,i);Ae(function(){return y(r,void 0,void 0,function(){return v(this,function(o){return[2,s._trigger(u)]})})})}),Zt(e.file)?this._uploadFileAndUpdateParams(e).then(function(){return r._createScheduledFileMessage(e,s,a,i)}):this._createScheduledFileMessage(e,s,a,i),s},t.prototype.updateScheduledFileMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return i=D(D({},nw),r),ne(function(o){return Up(o)&&x("number",o.scheduledAt,!0)&&(Zt(o.file)||x("string",o.fileUrl))&&x("string",o.fileName,!0)&&x("string",o.mimeType,!0)&&x("number",o.fileSize,!0)&&(o.thumbnailSizes===null||o.thumbnailSizes===void 0||o.thumbnailSizes.every(function(l){return x("object",l)&&l.maxWidth>0&&l.maxHeight>0}))}(i)).throw(H.invalidParameters),Zt(i.file)?[4,this._uploadFileAndUpdateParams(i)]:[3,2];case 1:u.sent(),u.label=2;case 2:return a=new rw(D({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},i)),[4,k.of(this._iid).requestQueue.send(a)];case 3:return s=u.sent(),[2,s.as(iw).message]}})})},t.prototype.cancelScheduledMessage=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=new sw({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,k.of(this._iid).requestQueue.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.sendScheduledMessageNow=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){switch(i.label){case 0:return r=new uw({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,k.of(this._iid).requestQueue.send(r)];case 1:return i.sent(),[2]}})})},t.prototype.getMyPushTriggerOption=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return e=k.of(this._iid),r=e.sdkState,i=e.requestQueue,a=new dw({userId:r.userId,channelUrl:this.url}),[4,i.send(a)];case 1:return s=o.sent(),u=s.as(cw).pushTriggerOption,this.myPushTriggerOption=u,[2,u]}})})},t.prototype.setMyPushTriggerOption=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return ne(_n(ys,e)).throw(H.invalidParameters),r=k.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,u=new ow({userId:a.userId,channelUrl:this.url,pushTriggerOption:e}),[4,s.send(u)];case 1:return o=d.sent(),l=o.as(lw).pushTriggerOption,this.myPushTriggerOption=l,i.dispatch(new An({channels:[this],context:{source:W.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,l]}})})},t.prototype.setMyCountPreference=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l;return v(this,function(d){switch(d.label){case 0:return ne(_n(ei,e)).throw(H.invalidParameters),r=k.of(this._iid),i=r.dispatcher,a=r.sdkState,s=r.requestQueue,u=new XM({channelUrl:this.url,userId:a.userId,countPreference:e}),[4,s.send(u)];case 1:return o=d.sent(),l=o.as(ZM).countPreference,this.myCountPreference=l,this._updateUnreadCount(this.unreadMessageCount,this.unreadMentionCount),i.dispatch(new An({channels:[this],context:{source:W.EVENT_CHANNEL_UPDATED},isWebSocketEventComing:!0})),[2,l]}})})},t.prototype.resetMyHistory=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return e=k.of(this._iid),r=e.dispatcher,i=e.requestQueue,a=e.sdkState,s=new JM({channelUrl:this.url,locale:a.localeForChatbot}),[4,i.send(s)];case 1:return u=l.sent(),o=u.as(ew).messageOffsetTimestamp,this.messageOffsetTimestamp=o,this.lastMessage&&this.lastMessage.createdAt<o&&(this.lastMessage=null),this._updateUnreadCount(0,0),this.totalUnreadReplyCount=0,r.dispatch(new An({channels:[this],context:{source:W.EVENT_CHANNEL_RESET_HISTORY},isWebSocketEventComing:!0})),[2,this]}})})},t.prototype._uploadFileAndUpdateParams=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c,f;return v(this,function(h){switch(h.label){case 0:return Zt(e.file)?(r=k.of(this._iid).requestQueue,i=new fd({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:this._generateRequestId()}),[4,r.send(i)]):[3,2];case 1:a=h.sent(),s=a.as(hd),u=s.url,o=s.fileSize,l=o===void 0?e.fileSize:o,d=s.thumbnails,c=s.requireAuth,f=c!==void 0&&c,e.fileUrl=u,e.fileSize=l,e.requireAuth=f,e._thumbnails=d,h.label=2;case 2:return[2]}})})},t.prototype.resendMessage=function(e,r){var i,a=this;if(ne(e instanceof Dt&&!e.scheduledInfo&&e.isResendable).throw(H.invalidParameters),e.isUserMessage()){var s=(i=e.messageParams)!==null&&i!==void 0?i:Uf(e),u=new Vr;return this._sendUserMessage(s,ir.RESEND,e.reqId).onPending(function(c){u._trigger(c)}).onFailed(function(c,f){u._triggerFailed(c,f)}).onSucceeded(function(c){a._tryUpdateLastMessageAndCallEvents(a,c),u._trigger(c)}),u}if(e.isFileMessage()){var o=this._validateFailedFileMessageHasFile(e,r);ne(o).throw(H.invalidParameters),s=kf(e,r);var l=new Vr;return this._sendFileMessage(s,ir.RESEND,e.reqId).onPending(function(c){l._trigger(c)}).onFailed(function(c,f){l._triggerFailed(c,f)}).onSucceeded(function(c){a._tryUpdateLastMessageAndCallEvents(a,c),l._trigger(c)}),l}if(e.isMultipleFilesMessage()){s=e.messageParams;var d=new Gl;return this._sendMultipleFilesMessage(s,ir.RESEND,e.reqId).onPending(function(c){d._trigger(c)}).onFailed(function(c,f){d._triggerFailed(c,f)}).onSucceeded(function(c){a._tryUpdateLastMessageAndCallEvents(a,c),d._trigger(c)}).onFileUploaded(function(c,f,h,m){d._triggerOnFileUploaded(c,f,h,m)}),d}},t.prototype.copyMessage=function(e,r){var i=this;if(ne(e instanceof Ed&&r instanceof Dt&&r.sendingStatus===Qn.SUCCEEDED&&this.url===r.channelUrl&&!r.scheduledInfo).throw(H.invalidParameters),r.isUserMessage()){ne(!r.poll).throw(H.notSupportedError);var a=Cb(r),s=new Vr;return e._sendUserMessage(a).onPending(function(l){s._trigger(l)}).onFailed(function(l,d){s._triggerFailed(l,d)}).onSucceeded(function(l){e.isGroupChannel()&&i._tryUpdateLastMessageAndCallEvents(e,l),s._trigger(l)}),s}if(r.isFileMessage()){a=Tb(r);var u=new Vr;return e._sendFileMessage(a).onPending(function(l){u._trigger(l)}).onFailed(function(l,d){u._triggerFailed(l,d)}).onSucceeded(function(l){e.isGroupChannel()&&i._tryUpdateLastMessageAndCallEvents(e,l),u._trigger(l)}),u}if(r.isMultipleFilesMessage()){if(e.isGroupChannel()){a=GI(r);var o=new Gl;return e._sendMultipleFilesMessage(a,ir.COPY).onPending(function(l){o._trigger(l)}).onFailed(function(l,d){o._triggerFailed(l,d)}).onSucceeded(function(l){i._tryUpdateLastMessageAndCallEvents(e,l),o._trigger(l)}).onFileUploaded(function(l,d,c,f){o._triggerOnFileUploaded(l,d,c,f)}),o}throw H.channelTypeNotSupportedError}},t}(Ed),dC=function(){this.onUserMuted=tn,this.onUserUnmuted=tn,this.onUserBanned=tn,this.onUserUnbanned=tn,this.onChannelChanged=tn,this.onChannelDeleted=tn,this.onChannelFrozen=tn,this.onChannelUnfrozen=tn,this.onOperatorUpdated=tn,this.onChannelMemberCountChanged=tn,this.onMetaDataCreated=tn,this.onMetaDataUpdated=tn,this.onMetaDataDeleted=tn,this.onMetaCounterCreated=tn,this.onMetaCounterUpdated=tn,this.onMetaCounterDeleted=tn,this.onMessageReceived=tn,this.onMessageUpdated=tn,this.onMessageDeleted=tn,this.onMentionReceived=tn,this.onReactionUpdated=tn,this.onThreadInfoUpdated=tn},Ao,wa={},fw=function(){function n(t){var e=t._iid,r=t.limit,i=r===void 0?100:r,a=this;this.ref=0,this._iid=e,this._limit=i;var s,u=k.of(this._iid),o=u.sdkState,l=u.dispatcher,d=u.logger,c=u.cacheContext,f=u.statManager;this._metadataKey=(s=o.userId,"sendbird:".concat(s,"@groupchannel/sync.meta"));var h=function(m){return"sendbird:".concat(m,"@groupchannel/sync")}(o.userId);this._sync=new Za(h,function(){return y(a,void 0,void 0,function(){var m,_,E,b,g,C,S,A,I,T,M,O,R,U,P,L;return v(this,function(F){switch(F.label){case 0:return m={hasNext:!0,nextToken:""},[4,this.loadMetadata()];case 1:if(F.sent(),d.debug("channel background sync from",(I=this._metadata)===null||I===void 0?void 0:I.token),(T=this._metadata)===null||T===void 0?void 0:T.completed)return[3,14];_={includeEmpty:!0,includeMetaData:!0,order:Et.CHRONOLOGICAL},F.label=2;case 2:if(F.trys.push([2,9,12,13]),_.order!==Et.LATEST_LAST_MESSAGE)return[3,6];F.label=3;case 3:return F.trys.push([3,5,,6]),[4,c.preference.get(Ip(o.appId))];case 4:return E=F.sent(),_.includeChatNotification=!!E,[3,6];case 5:return F.sent(),_.includeChatNotification=!1,[3,6];case 6:return[4,Yt.of(this._iid).getMyGroupChannels((O=(M=this._metadata)===null||M===void 0?void 0:M.token)!==null&&O!==void 0?O:"",_,this._limit,W.SYNC_CHANNEL_BACKGROUND)];case 7:return b=F.sent(),g=b.channels,C=b.token,m.hasNext=g.length>=this._limit&&!!C,m.nextToken=C,this._metadata&&(this._metadata.token=C,(A=this._metadata.range).extends.apply(A,Be([],we(g.map(function(B){return B.createdAt})),!1)),this._metadata.completed=!m.hasNext),d.debug("channel background sync progress",m),[4,this.saveMetadata()];case 8:return F.sent(),[3,13];case 9:return S=F.sent(),d.debug("channel background sync error",S),S instanceof H&&S.isInvalidTokenError?[4,this.clearMetaData()]:[3,11];case 10:F.sent(),F.label=11;case 11:throw S;case 12:return f.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:"",measured_on:"channel_back_sync",event:"cache_fetch",max_db_size:(U=(R=c.localCacheConfig)===null||R===void 0?void 0:R.maxSize)!==null&&U!==void 0?U:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:(L=(P=_.order)===null||P===void 0?void 0:P.toString())!==null&&L!==void 0?L:"",collection_id:o.userId}})),[7];case 13:return[3,15];case 14:m.hasNext=!1,m.nextToken="",F.label=15;case 15:return[2,m]}})})}),this._connectionEventContext=l.on(function(m){m instanceof Kr&&(m.stateType===Wn.CONNECTED?a.resume():a.pause())})}return n.of=function(t){return wa[t]||(wa[t]=new n({_iid:t})),wa[t].ref++,wa[t]},n.clear=function(t){wa[t]&&(wa[t].close(),delete wa[t])},Object.defineProperty(n.prototype,"range",{get:function(){var t,e;return(e=(t=this._metadata)===null||t===void 0?void 0:t.range)!==null&&e!==void 0?e:new qi({})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"completed",{get:function(){var t;return!!(!((t=this._metadata)===null||t===void 0)&&t.completed)},enumerable:!1,configurable:!0}),n.prototype.loadMetadata=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:return this._metadata?[3,2]:[4,k.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:t=e.sent(),this._metadata={token:t?t.token:"",range:new qi(t?t.range:{top:Number.MAX_SAFE_INTEGER,bottom:0}),completed:!!t&&t.completed},e.label=2;case 2:return[2,this._metadata]}})})},n.prototype.saveMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._metadata?[4,k.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype.clearMetaData=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,k.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.resume=function(){var t,e,r=k.of(this._iid),i=r.logger;r.sessionManager.session.hasSession&&(i.debug("channel background sync resume()"),this._sync.start((e=(t=this._metadata)===null||t===void 0?void 0:t.token)!==null&&e!==void 0?e:""))},n.prototype.pause=function(){k.of(this._iid).logger.debug("channel background sync stop()"),this._sync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete wa[this._iid])},n}(),Oa={},hw=function(){function n(t){var e=t._iid,r=this;this.ref=0,this._iid=e;var i,a=k.of(this._iid),s=a.logger,u=a.sdkState,o=a.dispatcher,l=a.cacheContext,d=a.statManager;this._metadataKey=(i=u.userId,"sendbird:".concat(i,"@groupchannel/changelogs.meta")),this._subscribers=new Bs;var c=function(f){return"sendbird:".concat(f,"@groupchannel/changelogs")}(u.userId);this._sync=new Za(c,function(){return y(r,void 0,void 0,function(){var f,h,m,_,E,b,g,C,S,A,I,T;return v(this,function(M){switch(M.label){case 0:return f={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:M.sent(),s.debug("channel changelog sync from",(A=this._metadata)===null||A===void 0?void 0:A.token),M.label=2;case 2:M.trys.push([2,9,,12]),h={includeEmpty:!0,includeMetaData:!0},M.label=3;case 3:return M.trys.push([3,5,,6]),[4,l.preference.get(Ip(u.appId))];case 4:return m=M.sent(),h.includeChatNotification=!!m,[3,6];case 5:return M.sent(),h.includeChatNotification=!1,[3,6];case 6:return[4,Yt.of(this._iid).getMyGroupChannelChangeLogs((T=(I=this._metadata)===null||I===void 0?void 0:I.token)!==null&&T!==void 0?T:"",h,W.SYNC_CHANNEL_CHANGELOGS)];case 7:return _=M.sent(),E=_.updatedChannels,b=_.deletedChannelUrls,g=_.hasMore,C=_.token,this._subscribers.dispatch("progress",{updatedChannels:E,deletedChannelUrls:b,hasMore:g,token:C}),f.hasNext=g,f.nextToken=C,this._metadata&&(this._metadata.token=C),s.debug("channel changelog sync progress",f),[4,this.saveMetadata()];case 8:return M.sent(),l.localCacheEnabled&&d.put(new Mt({type:_t.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:"",measured_on:"channel_change_log_sync",event:E.length>0||b.length>0?"cache_miss":"cache_hit",max_db_size:E.length,use_local_cache:l.localCacheEnabled,starting_point:0,message_init_policy:b.length.toString(),collection_id:u.userId}})),[3,12];case 9:return S=M.sent(),s.debug("channel changelog sync error",S),S instanceof H&&S.isInvalidTokenError?[4,this.clearMetadata()]:[3,11];case 10:M.sent(),M.label=11;case 11:throw S;case 12:return[2,f]}})})}),this._sync.on("stop",function(){r._subscribers.dispatch("pause")}),this._connectionEventContext=o.on(function(f){f instanceof Kr&&(f.stateType===Wn.CONNECTED?r.resume():r.pause())})}return n.of=function(t){return Oa[t]||(Oa[t]=new n({_iid:t})),Oa[t].ref++,Oa[t]},n.clear=function(t){Oa[t]&&(Oa[t].close(),delete Oa[t])},Object.defineProperty(n.prototype,"isRunning",{get:function(){return this._sync.isRunning},enumerable:!1,configurable:!0}),n.prototype.loadMetadata=function(){return y(this,void 0,void 0,function(){var t,e,r,i;return v(this,function(a){switch(a.label){case 0:return this._metadata?[3,2]:(t=k.of(this._iid),e=t.cacheContext,r=t.firstConnectedAt,[4,e.preference.get(this._metadataKey)]);case 1:i=a.sent(),this._metadata={token:i?i.token:r},a.label=2;case 2:return[2,this._metadata]}})})},n.prototype.saveMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._metadata?[4,k.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return t.sent(),[2,!0];case 2:return[2,!1]}})})},n.prototype.clearMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,k.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return t.sent(),this._metadata=void 0,[2]}})})},n.prototype.on=function(t,e){return this._subscribers.on(t,e)},n.prototype.resume=function(){k.of(this._iid).sessionManager.session.hasSession&&this._sync.start(0)},n.prototype.pause=function(){this._sync.stop()},n.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Oa[this._iid])},n}(),Kl=function(n,t){return n.findIndex(function(e){return e.isIdentical(t)})},ag=function(n,t,e){if(n.length>0){for(var r=Kl(n,t),i=0,a=n.length-1,s=Math.floor((i+a)/2);i<a;){var u=sg(n[s],t,e);if(u>0)a=s,s=Math.floor((i+a)/2);else{if(!(u<0))return{place:s,oldPosition:r};i=s+1,s=Math.floor((i+a)/2)}}return{place:sg(n[s],t,e)>=0?s:s+1,oldPosition:r}}return{place:n.length,oldPosition:-1}},sg=function(n,t,e){switch(e){case Et.LATEST_LAST_MESSAGE:return n.lastMessage&&t.lastMessage?(r=t.lastMessage.createdAt-n.lastMessage.createdAt)===0?t.createdAt-n.createdAt:r:n.lastMessage?-1:t.lastMessage?1:t.createdAt-n.createdAt;case Et.CHRONOLOGICAL:return t.createdAt-n.createdAt;case Et.CHANNEL_NAME_ALPHABETICAL:var r;return(r=n.name.localeCompare(t.name))===0?n.createdAt-t.createdAt:r;default:return 0}},pw=function(){function n(t,e){var r=e.filter,i=r===void 0?new sC:r,a=e.order,s=a===void 0?Et.LATEST_LAST_MESSAGE:a,u=e.limit,o=u===void 0?kb:u,l=e.includeChangesOnInitialLoad,d=l!==void 0&&l,c=this;this.channels=[],this._isInitialized=!1,this._iid=t,this._key="gcc-".concat(ba()),this._isDisposed=!1,this._isGetRemoteChannelsSucceeded=!0,this._includeChangesOnInitialLoad=d,this.filter=i,this.order=s,this._hasMore=!0,this._token="",this._limit=o;var f=k.of(this._iid),h=f.sdkState,m=f.cacheContext,_=f.dispatcher;m.localCacheEnabled&&(this._backgroundSync=fw.of(t),this._backgroundSync.resume()),this._changelogSync=hw.of(t),this._changelogSync.resume(),Yt.of(this._iid).subscribeChannelEvent(this._key,{onUpdate:function(E,b){var g=b.source;if(zl(g)){var C=E.filter(function(A){return c.filter.match(A,h.userId)}),S=E.filter(function(A){return!c.filter.match(A,h.userId)}).map(function(A){return A.url});C.length>0&&c._addChannelsToView(C,b),S.length>0&&c._removeChannelsFromView(S,b)}},onRemove:function(E,b){c._removeChannelsFromView(E,b)}}),_.on(function(E){E instanceof Kr&&(E.stateType===Wn.CONNECTED?c._isGetRemoteChannelsSucceeded||y(c,void 0,void 0,function(){return v(this,function(b){switch(b.label){case 0:return[4,this._revokeLoadMore()];case 1:return b.sent(),[2]}})}):E.stateType===Wn.LOGOUT&&c.dispose())})}return Object.defineProperty(n.prototype,"hasMore",{get:function(){return!this._isDisposed&&this._hasMore},enumerable:!1,configurable:!0}),n.prototype.setGroupChannelCollectionHandler=function(t){this._handler=t},n.prototype._addChannelsToView=function(t,e,r){var i,a,s,u,o=this;r===void 0&&(r=!1);var l=[],d=[],c=[];try{for(var f=oe(t),h=f.next();!h.done;h=f.next()){var m=h.value,_=Kl(this.channels,m);_>=0&&this.channels.splice(_,1);var E=ag(this.channels,m,this.order).place;if(_<0)E===this.channels.length?!r&&this._hasMore||(l.push(m),this.channels.push(m)):(l.push(m),this.channels.splice(E,0,m));else switch(e.source){case W.EVENT_CHANNEL_UPDATED:case W.EVENT_MESSAGE_RECEIVED:case W.SYNC_CHANNEL_CHANGELOGS:case W.EVENT_MESSAGE_SENT:this.order===Et.CHANNEL_NAME_ALPHABETICAL&&this._hasMore&&E===this.channels.length?c.push(m):(this.channels.splice(E,0,m),d.push(m));break;default:this.channels.splice(E,0,m),d.push(m)}}}catch(S){i={error:S}}finally{try{h&&!h.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}if(c.length>0)try{for(var b=oe(c),g=b.next();!g.done;g=b.next()){m=g.value;var C=Kl(this.channels,m);C!==-1&&this.channels.splice(C,1)}}catch(S){s={error:S}}finally{try{g&&!g.done&&(u=b.return)&&u.call(b)}finally{if(s)throw s.error}}zl(e.source)&&Ae(function(){return y(o,void 0,void 0,function(){var S,A,I;return v(this,function(T){return l.length>0&&(!((S=this._handler)===null||S===void 0)&&S.onChannelsAdded)&&this._handler.onChannelsAdded(e,l),d.length>0&&(!((A=this._handler)===null||A===void 0)&&A.onChannelsUpdated)&&this._handler.onChannelsUpdated(e,d),c.length>0&&(!((I=this._handler)===null||I===void 0)&&I.onChannelsDeleted)&&this._handler.onChannelsDeleted(e,c.map(function(M){return M.url})),[2]})})})},n.prototype._removeChannelsFromView=function(t,e){var r,i,a=this,s=[],u=function(c){var f=o.channels.findIndex(function(h){return h.url===c});f>=0&&(s.push(o.channels[f].url),o.channels.splice(f,1))},o=this;try{for(var l=oe(t),d=l.next();!d.done;d=l.next())u(d.value)}catch(c){r={error:c}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return zl(e.source)&&s.length>0&&Ae(function(){return y(a,void 0,void 0,function(){var c;return v(this,function(f){return!((c=this._handler)===null||c===void 0)&&c.onChannelsDeleted&&this._handler.onChannelsDeleted(e,s),[2]})})}),s},n.prototype._getLocalChannels=function(){return y(this,void 0,void 0,function(){var t,e;return v(this,function(r){switch(r.label){case 0:return t=Yt.of(this._iid),e=this.channels.length>0?function(i,a){var s,u,o,l;switch(a){case Et.LATEST_LAST_MESSAGE:return(u=(s=i.lastMessage)===null||s===void 0?void 0:s.createdAt)!==null&&u!==void 0?u:i.createdAt;case Et.CHRONOLOGICAL:return i.createdAt;case Et.CHANNEL_NAME_ALPHABETICAL:return i.name;default:return(l=(o=i.lastMessage)===null||o===void 0?void 0:o.createdAt)!==null&&l!==void 0?l:i.createdAt}}(this.channels[this.channels.length-1],this.order):null,[4,t.getChannelsFromCache(e,this.filter,this.order,this._limit,e?this.channels[this.channels.length-1].url:void 0)];case 1:return[2,r.sent()]}})})},n.prototype._getRemoteChannels=function(){return y(this,void 0,void 0,function(){var t,e,r;return v(this,function(i){switch(i.label){case 0:return[4,Yt.of(this._iid).getMyGroupChannels(this._token,Re(D(D({},this.filter),{userIdsFilter:this.filter.userIdsFilter,searchFilter:this.filter.searchFilter,order:this.order})),this._limit)];case 1:return t=i.sent(),e=t.channels,r=t.token,this._token=r,this._hasMore=!!r,[2,e]}})})},n.prototype._revokeLoadMore=function(){return y(this,void 0,void 0,function(){var t;return v(this,function(e){switch(e.label){case 0:if(this._isDisposed)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._getRemoteChannels()];case 2:return t=e.sent(),this._isGetRemoteChannelsSucceeded=!0,this._addChannelsToView(t,{source:W.REQUEST_CHANNEL},!0),[3,4];case 3:return e.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,4];case 4:return[2]}})})},n.prototype.loadMore=function(){var t;return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A=this;return v(this,function(I){switch(I.label){case 0:if(this._isDisposed)throw new H({code:Ne.COLLECTION_DISPOSED,message:"Collection has been disposed."});return e=null,this._includeChangesOnInitialLoad&&this.channels.length===0&&this._changelogSync.isRunning?[4,new Promise(function(T){A._changelogSyncSubscriberContext=A._changelogSync.on("progress",function(M){return T(M)}).on("pause",function(){return T(null)})})]:[3,2];case 1:e=I.sent(),(t=this._changelogSyncSubscriberContext)===null||t===void 0||t.close(),I.label=2;case 2:return r=k.of(this._iid),i=r.cacheContext,a=r.connectionManager,s=r.statManager,this._isInitialized?[3,5]:(this._isInitialized=!0,i.localCacheEnabled?[4,this._backgroundSync.loadMetadata()]:[3,4]);case 3:I.sent(),I.label=4;case 4:s.put(new Lo({type:_t.FEATURE_LOCALCACHE,data:{use_local_cache:i.localCacheEnabled,collection_interface:{group_channel:!0}}})),I.label=5;case 5:return u=[],this._hasMore?!i.localCacheEnabled||a.isConnected&&!this._backgroundSync.completed?[3,7]:[4,Lt(function(){return y(A,void 0,void 0,function(){return v(this,function(T){switch(T.label){case 0:return[4,this._getLocalChannels()];case 1:return u=T.sent(),[2]}})})})]:[3,11];case 6:return I.sent(),this._hasMore=u.length>=this._limit,[3,10];case 7:return I.trys.push([7,9,,10]),[4,this._getRemoteChannels()];case 8:return u=I.sent(),this._isGetRemoteChannelsSucceeded=!0,[3,10];case 9:return I.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,10];case 10:this._addChannelsToView(u,{source:W.REQUEST_CHANNEL},!0),I.label=11;case 11:if(e){try{for(o=oe(e.updatedChannels),l=o.next();!l.done;l=o.next())d=l.value,(E=Kl(u,d))>=0?u[E]=d:(c=ag(u,d,this.order).place,u.splice(c,0,d))}catch(T){b={error:T}}finally{try{l&&!l.done&&(g=o.return)&&g.call(o)}finally{if(b)throw b.error}}f=u.map(function(T){return T.url});try{for(h=oe(e.deletedChannelUrls),m=h.next();!m.done;m=h.next())_=m.value,(E=f.indexOf(_))>=0&&(u.splice(E,1),f.splice(E,1))}catch(T){C={error:T}}finally{try{m&&!m.done&&(S=h.return)&&S.call(h)}finally{if(C)throw C.error}}}return[2,u]}})})},n.prototype.dispose=function(){var t,e,r;this._isDisposed||(this._isDisposed=!0,this.channels.length>0&&this.channels.splice(0,this.channels.length),(t=this._backgroundSync)===null||t===void 0||t.close(),(e=this._changelogSync)===null||e===void 0||e.close(),(r=this._changelogSyncSubscriberContext)===null||r===void 0||r.close(),Yt.of(this._iid).unsubscribeChannelEvent(this._key))},n}(),mw=function(n){function t(e){var r=this,i=e.token,a=e.limit,s=e.order,u=e.includeEmpty,o=e.membershipFilter,l=e.channelNameContainsFilter,d=e.channelUrlsFilter,c=e.customTypesFilter,f=e.customTypeStartsWithFilter,h=e.superChannelFilter,m=e.metadataOrderKeyFilter,_=e.metadataKey,E=e.metadataValues,b=e.metadataValueStartsWith,g=e.includeFrozen,C=e.includeMetaData;return(r=n.call(this)||this).method=J.GET,r.path=yr,r.params=ge(Re({token:i,limit:a,order:s,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:u,public_mode:Yi.PUBLIC,public_membership_mode:o,name_contains:l,channel_urls:d,custom_types:c,custom_type_startswith:f,super_mode:h,metadata_order_key:m,metadata_key:_,metadata_values:E,metadata_value_startswith:b,show_frozen:g,show_metadata:C})),r}return w(t,n),t}(ee),_w=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.channels=[];var a=r.next,s=r.channels,u=r.ts;return i.token=a,s&&s.length>0&&(i.channels=s.map(function(o){return o.ts=u,new ci(e,o)})),i.ts=typeof u=="number"?u:0,i}return w(t,n),t}(ie);(function(n){n.ALL="all",n.JOINED="joined"})(Ao||(Ao={}));var gw=function(n){function t(e,r){var i,a,s,u,o,l,d,c,f,h,m,_,E,b,g=this;return(g=n.call(this,e,r)||this).includeEmpty=!1,g.includeFrozen=!0,g.includeMetaData=!0,g.channelUrlsFilter=null,g.customTypesFilter=null,g.customTypeStartsWithFilter=null,g.channelNameContainsFilter=null,g.membershipFilter=Ao.ALL,g.superChannelFilter=Ur.ALL,g.metadataKey=null,g.metadataValues=null,g.metadataOrderKeyFilter=null,g.metadataValueStartsWith=null,g.order=So.CHRONOLOGICAL,g.includeEmpty=(i=r.includeEmpty)!==null&&i!==void 0&&i,g.includeFrozen=(a=r.includeFrozen)===null||a===void 0||a,g.includeMetaData=(s=r.includeMetaData)===null||s===void 0||s,g.channelUrlsFilter=(u=r.channelUrlsFilter)!==null&&u!==void 0?u:null,g.customTypesFilter=(o=r.customTypesFilter)!==null&&o!==void 0?o:null,g.customTypeStartsWithFilter=(l=r.customTypeStartsWithFilter)!==null&&l!==void 0?l:null,g.channelNameContainsFilter=(d=r.channelNameContainsFilter)!==null&&d!==void 0?d:null,g.membershipFilter=(c=r.membershipFilter)!==null&&c!==void 0?c:Ao.ALL,g.superChannelFilter=(f=r.superChannelFilter)!==null&&f!==void 0?f:Ur.ALL,g.metadataKey=(h=r.metadataKey)!==null&&h!==void 0?h:null,g.metadataValues=(m=r.metadataValues)!==null&&m!==void 0?m:null,g.metadataOrderKeyFilter=(_=r.metadataOrderKeyFilter)!==null&&_!==void 0?_:null,g.metadataValueStartsWith=(E=r.metadataValueStartsWith)!==null&&E!==void 0?E:null,g.order=(b=r.order)!==null&&b!==void 0?b:So.CHRONOLOGICAL,g}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("boolean",this.includeEmpty)&&x("boolean",this.includeFrozen)&&x("boolean",this.includeMetaData)&&x("string",this.channelNameContainsFilter,!0)&&gn("string",this.channelUrlsFilter,!0)&&gn("string",this.customTypesFilter,!0)&&x("string",this.customTypeStartsWithFilter,!0)&&_n(Ao,this.membershipFilter)&&_n(Ur,this.superChannelFilter)&&_n(So,this.order)&&x("string",this.metadataOrderKeyFilter,!0)&&x("string",this.metadataKey,!0)&&gn("string",this.metadataValues,!0)&&x("string",this.metadataValueStartsWith,!0)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,r=k.of(this._iid).requestQueue,i=new mw(Re(D(D({},this),{token:this._token}))),[4,r.send(i)]):[3,2]):[3,5];case 1:return a=l.sent(),s=a.as(_w),u=s.channels,o=s.token,this._token=o,this._hasNext=!!o,this._isLoading=!1,[2,u];case 2:return[2,e];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(Sa),Wo=function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return w(t,n),t}(function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.onUserJoined=tn,e.onUserLeft=tn,e.onUserReceivedInvitation=tn,e.onUserDeclinedInvitation=tn,e.onChannelHidden=tn,e.onUnreadMemberStatusUpdated=tn,e.onUndeliveredMemberStatusUpdated=tn,e.onTypingStatusUpdated=tn,e.onPollUpdated=tn,e.onPollVoted=tn,e.onPollDeleted=tn,e.onPinnedMessageUpdated=tn,e}return w(t,n),t}(dC)),Ew=function(n){function t(e){var r=this,i=e.token,a=e.limit,s=e.order,u=e.reverse,o=e.channelUrl,l=e.messageTypeFilter,d=e.scheduledStatus;return(r=n.call(this)||this).method=J.GET,r.path="".concat(yy),r.params=ge(Re({token:i,limit:a,reverse:u,channel_url:o,order:s,message_type:l,status:d})),r}return w(t,n),t}(ee),vw=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.scheduledMessages=[];var a=r.next,s=r.scheduled_messages;return i.token=a,i.scheduledMessages=s.map(function(u){return dr(e,u)}),i}return w(t,n),t}(ie),yw=function(n){function t(e,r){var i,a,s,u,o,l=this;return(l=n.call(this,e,r)||this).channelUrl=null,l.order=null,l.reverse=!1,l.scheduledStatus=null,l.messageTypeFilter=ur.ALL,l.channelUrl=(i=r.channelUrl)!==null&&i!==void 0?i:null,l.order=(a=r.order)!==null&&a!==void 0?a:null,l.reverse=(s=r.reverse)!==null&&s!==void 0&&s,l.scheduledStatus=(u=r.scheduledStatus)!==null&&u!==void 0?u:null,l.messageTypeFilter=(o=r.messageTypeFilter)!==null&&o!==void 0?o:ur.ALL,l}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("string",this.channelUrl,!0)&&(_n(Hf,this.order)||this.order===null)&&x("boolean",this.reverse)&&(gn(Ha,this.scheduledStatus)||this.scheduledStatus===null)&&_n(ur,this.messageTypeFilter)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new Ew(Re(D(D({},this),{token:this._token}))),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(vw),s=a.scheduledMessages,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(Sa),cC=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.name="groupChannel",e}return w(t,n),t.prototype.init=function(e,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,u=r.requestQueue,o=r.logger,l=r.onlineDetector,d=r.cacheContext;n.prototype.init.call(this,e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:o,onlineDetector:l,cacheContext:d}),this._manager=new Yt(e,{sdkState:i,cacheContext:d,dispatcher:a,sessionManager:s,requestQueue:u,logger:o})},t.prototype.createGroupChannelCollection=function(e){return e===void 0&&(e={}),new pw(this._iid,e)},t.prototype.createMyGroupChannelListQuery=function(e){return e===void 0&&(e={}),new lC(this._iid,e)},t.prototype.createPublicGroupChannelListQuery=function(e){return e===void 0&&(e={}),new gw(this._iid,e)},t.prototype.createScheduledMessageListQuery=function(e){return e===void 0&&(e={}),new yw(this._iid,e)},t.prototype.addGroupChannelHandler=function(e,r){ne(x("string",e)&&r instanceof Wo).throw(H.invalidParameters),this._manager.addHandler(e,r)},t.prototype.removeGroupChannelHandler=function(e){ne(x("string",e)).throw(H.invalidParameters),this._manager.removeHandler(e)},t.prototype.removeAllGroupChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildGroupChannelFromSerializedData=function(e){return this._manager.buildGroupChannelFromSerializedData(e)},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){return this._manager.buildGroupChannelListQueryFromSerializedData(e)},t.prototype.buildMemberFromSerializedData=function(e){return this._manager.buildMemberFromSerializedData(e)},t.prototype.getChannel=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return ne(x("string",e)).throw(H.invalidParameters),[2,this._manager.getChannel(e)]})})},t.prototype.getChannelWithoutCache=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return ne(x("string",e)).throw(H.invalidParameters),[2,this._manager.getChannelWithoutCache(e)]})})},t.prototype.getMyGroupChannelChangeLogsByToken=function(e,r){return r===void 0&&(r={}),y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},Sd),r),ne(x("string",e)&&Gf(i)).throw(H.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getMyGroupChannelChangeLogsByTimestamp=function(e,r){return r===void 0&&(r={}),y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:return i=D(D({},Sd),r),ne(x("number",e)&&Gf(i)).throw(H.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,i)];case 1:return[2,a.sent()]}})})},t.prototype.getGroupChannelCount=function(e){return y(this,void 0,void 0,function(){var r;return v(this,function(i){return r=D(D({},uC),e),ne(oC(r)).throw(H.invalidParameters),[2,this._manager.getGroupChannelCount(r)]})})},t.prototype.getUnreadItemCount=function(e){return e===void 0&&(e={}),y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._manager.getUnreadItemCount(e)];case 1:return[2,r.sent()]}})})},t.prototype.getTotalUnreadChannelCount=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,this._manager.getTotalUnreadChannelCount()];case 1:return[2,e.sent()]}})})},t.prototype.getTotalUnreadMessageCount=function(e){return e===void 0&&(e={}),y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._manager.getTotalUnreadMessageCount(e)];case 1:return[2,r.sent()]}})})},t.prototype.getTotalScheduledMessageCount=function(e){return e===void 0&&(e={}),y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._manager.getTotalScheduledMessageCount(e)];case 1:return[2,r.sent()]}})})},t.prototype.getSubscribedTotalUnreadMessageCount=function(){return this._manager.getSubscribedTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){return this._manager.getSubscribedCustomTypeUnreadMessageCount(e)},t.prototype.createChannel=function(e){return e===void 0&&(e={}),y(this,void 0,void 0,function(){var r;return v(this,function(i){return r=D(D({},ql),e),ne(Bf(r)).throw(H.invalidParameters),[2,this._manager.createChannel(r)]})})},t.prototype.createDistinctChannelIfNotExist=function(e){return e===void 0&&(e={}),y(this,void 0,void 0,function(){var r;return v(this,function(i){return r=D(D({},ql),e),ne(Bf(r)).throw(H.invalidParameters),r&&(r.isDistinct=!0),[2,this.createChannel(r)]})})},t.prototype.createChannelWithUserIds=function(e,r,i,a,s,u){return r===void 0&&(r=!1),s===void 0&&(s=""),u===void 0&&(u=""),y(this,void 0,void 0,function(){var o;return v(this,function(l){return o=D(D({},ql),{invitedUserIds:e,isDistinct:r,name:i,data:s,customType:u}),typeof a=="string"?o.coverUrl=a:o.coverImage=a,[2,this.createChannel(o)]})})},t.prototype.markAsReadAll=function(){return y(this,void 0,void 0,function(){return v(this,function(e){return this._manager.markAsReadAll(),[2]})})},t.prototype.markAsReadWithChannelUrls=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return ne(gn("string",e)).throw(H.invalidParameters),this._manager.markAsReadWithChannelUrls(e),[2]})})},t.prototype.markAsDelivered=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return ne(x("string",e)).throw(H.invalidParameters),[4,this.getChannel(e)];case 1:return[4,r.sent().markAsDelivered()];case 2:return r.sent(),[2]}})})},t}(Kd),Kf=function(n,t){return Kf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},Kf(n,t)};function fC(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Kf(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var G=function(){return G=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},G.apply(this,arguments)};function bw(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e}function Nt(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function u(d){try{l(r.next(d))}catch(c){s(c)}}function o(d){try{l(r.throw(d))}catch(c){s(c)}}function l(d){d.done?a(d.value):i(d.value).then(u,o)}l((r=r.apply(n,t||[])).next())})}function It(n,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=u(0),s.throw=u(1),s.return=u(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(l){return function(d){return o([l,d])}}function o(l){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(e=0)),e;)try{if(r=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return e.label++,{value:l[1],done:!1};case 5:e.label++,i=l[1],l=[0];continue;case 7:l=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){e=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){e.label=l[1];break}if(l[0]===6&&e.label<a[1]){e.label=a[1],a=l;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(l);break}a[2]&&e.ops.pop(),e.trys.pop();continue}l=t.call(n,e)}catch(d){l=[6,d],i=0}finally{r=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ce(n,t,e){if(e||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return n.concat(a||Array.prototype.slice.call(t))}const Bu={reactions:"reactions",message_search_v3:"message_search_v3",enable_og_tag:"enable_og_tag",enable_message_threading:"enable_message_threading",allow_broadcast_channel:"allow_broadcast_channel",allow_super_group_channel:"allow_super_group_channel"};Et.LATEST_LAST_MESSAGE;function Yo(n){const t=N.useRef(n);return t.current=n,N.useCallback((...e)=>t.current(...e),[t])}function Vn(n){return typeof n=="boolean"}function Zs(n,t){return t.includes(n)}function Cw(n){return n instanceof Set}function Sw(n,t){return Object.prototype.toString.call(n)===Object.prototype.toString.call(t)}function $f(n){if(typeof n!="object"||n===null)return n;if(Array.isArray(n))return n.map(e=>$f(e));const t={};return Object.keys(n).forEach(e=>{const r=e.replace(/_\w/g,i=>i[1].toUpperCase());t[r]=$f(n[e])}),t}function hC(n,t){const e=Object.assign({},n);return Object.keys(t).forEach(r=>{Object.prototype.hasOwnProperty.call(e,r)&&Sw(e[r],t[r])&&(typeof t[r]=="object"&&!Array.isArray(t[r])?e[r]=hC(e[r],t[r]):e[r]=t[r])}),e}const Gp=()=>({common:{enableUsingDefaultUserProfile:!1},groupChannel:{channel:{enableMention:!1,enableOgtag:!0,enableReactions:!0,enableReactionsSupergroup:!1,enableTypingIndicator:!0,enableVoiceMessage:!1,input:{camera:{enablePhoto:!0,enableVideo:!0},enableDocument:!0,gallery:{enablePhoto:!0,enableVideo:!0}},replyType:"quote_reply",threadReplySelectType:"thread",typingIndicatorTypes:new Set(["text"]),enableFeedback:!1,enableSuggestedReplies:!1,showSuggestedRepliesFor:"last_message_only",suggestedRepliesDirection:"vertical",enableMarkdownForUserMessage:!1,enableFormTypeMessage:!1},channelList:{enableMessageReceiptStatus:!1,enableTypingIndicator:!1},setting:{enableMessageSearch:!1}},openChannel:{channel:{enableOgtag:!0,input:{camera:{enablePhoto:!0,enableVideo:!0},enableDocument:!0,gallery:{enablePhoto:!0,enableVideo:!0}}}}});function Tw(n){return delete n.groupChannel.channel.typingIndicatorTypes,delete n.groupChannel.channel.enableFeedback,delete n.groupChannel.channel.enableSuggestedReplies,delete n.groupChannel.channel.showSuggestedRepliesFor,delete n.groupChannel.channel.suggestedRepliesDirection,delete n.groupChannel.channel.enableMarkdownForUserMessage,delete n.groupChannel.channel.enableFormTypeMessage,n}const pC=()=>{const n=Gp();return Tw(n)},ug=Gp(),Nw=pC();var Td=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function u(d){try{l(r.next(d))}catch(c){s(c)}}function o(d){try{l(r.throw(d))}catch(c){s(c)}}function l(d){d.done?a(d.value):i(d.value).then(u,o)}l((r=r.apply(n,t||[])).next())})};const Wf={items:{},getItem(n){var t;return Td(this,void 0,void 0,function*(){return(t=Wf.items[n])!==null&&t!==void 0?t:null})},setItem(n,t){return Td(this,void 0,void 0,function*(){Wf.items[n]=t})}};class Iw{constructor(t){this.storage=t??Wf}init(t){return this.key=`sbu@${t}.uikitConfiguration`,this.get()}get safeKey(){if(!this.key)throw new Error("Please UIKitConfigManager.init() first");return this.key}update(t){return Td(this,void 0,void 0,function*(){const e=yield this.get(),r={updatedAt:t.updatedAt,configuration:hC(e.configuration,t.configuration)};return yield this.storage.setItem(this.safeKey,JSON.stringify(r)),r})}get(){return Td(this,void 0,void 0,function*(){const t={updatedAt:0,configuration:Nw};try{const e=yield this.storage.getItem(this.safeKey);return e?JSON.parse(e):t}catch{return t}})}}function Aw(n,t,e){var r,i;e.common&&Vn((r=e.common)===null||r===void 0?void 0:r.enableUsingDefaultUserProfile)&&(n.enableUsingDefaultUserProfile=e.common.enableUsingDefaultUserProfile),t.common&&Vn((i=t.common)===null||i===void 0?void 0:i.enableUsingDefaultUserProfile)&&(n.enableUsingDefaultUserProfile=t.common.enableUsingDefaultUserProfile)}function Mw(n,t,e){ww(n,t,e),Ow(n,t,e),Rw(n,t,e),Dw(n,t,e)}function ww(n,t,e){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R,U,P,L,F,B,V,K,$,q,se,Y,ce,X,Se,te,be,xe,Pe,vn,on,je,Xe,sn,un,En,rn,qe,Je,ln,dn,ve,De,Ye,en,fn,Fe,Nn,nn,_e,zn,Rn,bn,Ge,cn,On,Ln,In,et,Gn,Cn,mn,ze,ue,Q,Te,He,$e,Ee,fe,We,yn,Yn,Sn,rt,Ct,pe,Le,ae,Qe,an,Tn,xn,it,lt,Ie,j,le,ke,Un,Kn,ut,dt,jt,Ht,Ve,kn,Pn;!((r=e.groupChannel)===null||r===void 0)&&r.channel&&Vn((a=(i=e.groupChannel)===null||i===void 0?void 0:i.channel)===null||a===void 0?void 0:a.enableOgtag)&&(n.channel.enableOgtag=e.groupChannel.channel.enableOgtag),!((s=t.groupChannel)===null||s===void 0)&&s.channel&&Vn((o=(u=t.groupChannel)===null||u===void 0?void 0:u.channel)===null||o===void 0?void 0:o.enableOgtag)&&(n.channel.enableOgtag=(d=(l=t.groupChannel)===null||l===void 0?void 0:l.channel)===null||d===void 0?void 0:d.enableOgtag),!((c=e.groupChannel)===null||c===void 0)&&c.channel&&Vn((h=(f=e.groupChannel)===null||f===void 0?void 0:f.channel)===null||h===void 0?void 0:h.enableTypingIndicator)&&(n.channel.enableTypingIndicator=(_=(m=e.groupChannel)===null||m===void 0?void 0:m.channel)===null||_===void 0?void 0:_.enableTypingIndicator),!((E=t.groupChannel)===null||E===void 0)&&E.channel&&Vn((g=(b=t.groupChannel)===null||b===void 0?void 0:b.channel)===null||g===void 0?void 0:g.enableTypingIndicator)&&(n.channel.enableTypingIndicator=(S=(C=t.groupChannel)===null||C===void 0?void 0:C.channel)===null||S===void 0?void 0:S.enableTypingIndicator),!((A=e.groupChannel)===null||A===void 0)&&A.channel&&Vn((T=(I=e.groupChannel)===null||I===void 0?void 0:I.channel)===null||T===void 0?void 0:T.enableReactions)&&(n.channel.enableReactions=(O=(M=e.groupChannel)===null||M===void 0?void 0:M.channel)===null||O===void 0?void 0:O.enableReactions),!((R=t.groupChannel)===null||R===void 0)&&R.channel&&Vn((P=(U=t.groupChannel)===null||U===void 0?void 0:U.channel)===null||P===void 0?void 0:P.enableReactions)&&(n.channel.enableReactions=(F=(L=t.groupChannel)===null||L===void 0?void 0:L.channel)===null||F===void 0?void 0:F.enableReactions),!((B=e.groupChannel)===null||B===void 0)&&B.channel&&Vn((K=(V=e.groupChannel)===null||V===void 0?void 0:V.channel)===null||K===void 0?void 0:K.enableReactionsSupergroup)&&(n.channel.enableReactionsSupergroup=(q=($=e.groupChannel)===null||$===void 0?void 0:$.channel)===null||q===void 0?void 0:q.enableReactionsSupergroup),!((se=t.groupChannel)===null||se===void 0)&&se.channel&&Vn((ce=(Y=t.groupChannel)===null||Y===void 0?void 0:Y.channel)===null||ce===void 0?void 0:ce.enableReactionsSupergroup)&&console.warn("Currently, EnableReactionsSupergroup feature is turned off by default. If you wish to use this feature, contact us: https://dashboard.sendbird.com/settings/contact_us?category=feedback_and_feature_requests&product=UIKit"),!((X=e.groupChannel)===null||X===void 0)&&X.channel&&Vn((te=(Se=e.groupChannel)===null||Se===void 0?void 0:Se.channel)===null||te===void 0?void 0:te.enableMention)&&(n.channel.enableMention=(xe=(be=e.groupChannel)===null||be===void 0?void 0:be.channel)===null||xe===void 0?void 0:xe.enableMention),!((Pe=t.groupChannel)===null||Pe===void 0)&&Pe.channel&&Vn((on=(vn=t.groupChannel)===null||vn===void 0?void 0:vn.channel)===null||on===void 0?void 0:on.enableMention)&&(n.channel.enableMention=(Xe=(je=t.groupChannel)===null||je===void 0?void 0:je.channel)===null||Xe===void 0?void 0:Xe.enableMention),!((sn=e.groupChannel)===null||sn===void 0)&&sn.channel&&Zs((En=(un=e.groupChannel)===null||un===void 0?void 0:un.channel)===null||En===void 0?void 0:En.replyType,["none","quote_reply","thread"])&&(n.channel.replyType=(qe=(rn=e.groupChannel)===null||rn===void 0?void 0:rn.channel)===null||qe===void 0?void 0:qe.replyType),!((Je=t.groupChannel)===null||Je===void 0)&&Je.channel&&Zs((dn=(ln=t.groupChannel)===null||ln===void 0?void 0:ln.channel)===null||dn===void 0?void 0:dn.replyType,["none","quote_reply","thread"])&&(n.channel.replyType=(De=(ve=t.groupChannel)===null||ve===void 0?void 0:ve.channel)===null||De===void 0?void 0:De.replyType),!((Ye=e.groupChannel)===null||Ye===void 0)&&Ye.channel&&Zs((fn=(en=e.groupChannel)===null||en===void 0?void 0:en.channel)===null||fn===void 0?void 0:fn.threadReplySelectType,["thread","parent"])&&(n.channel.threadReplySelectType=(Nn=(Fe=e.groupChannel)===null||Fe===void 0?void 0:Fe.channel)===null||Nn===void 0?void 0:Nn.threadReplySelectType),!((nn=t.groupChannel)===null||nn===void 0)&&nn.channel&&Zs((zn=(_e=t.groupChannel)===null||_e===void 0?void 0:_e.channel)===null||zn===void 0?void 0:zn.threadReplySelectType,["thread","parent"])&&(n.channel.threadReplySelectType=(bn=(Rn=t.groupChannel)===null||Rn===void 0?void 0:Rn.channel)===null||bn===void 0?void 0:bn.threadReplySelectType),!((Ge=e.groupChannel)===null||Ge===void 0)&&Ge.channel&&Vn((On=(cn=e.groupChannel)===null||cn===void 0?void 0:cn.channel)===null||On===void 0?void 0:On.enableVoiceMessage)&&(n.channel.enableVoiceMessage=(In=(Ln=e.groupChannel)===null||Ln===void 0?void 0:Ln.channel)===null||In===void 0?void 0:In.enableVoiceMessage),!((et=t.groupChannel)===null||et===void 0)&&et.channel&&Vn((Cn=(Gn=t.groupChannel)===null||Gn===void 0?void 0:Gn.channel)===null||Cn===void 0?void 0:Cn.enableVoiceMessage)&&(n.channel.enableVoiceMessage=(ze=(mn=t.groupChannel)===null||mn===void 0?void 0:mn.channel)===null||ze===void 0?void 0:ze.enableVoiceMessage),!((ue=t.groupChannel)===null||ue===void 0)&&ue.channel&&Cw((Te=(Q=t.groupChannel)===null||Q===void 0?void 0:Q.channel)===null||Te===void 0?void 0:Te.typingIndicatorTypes)&&(n.channel.typingIndicatorTypes=($e=(He=t.groupChannel)===null||He===void 0?void 0:He.channel)===null||$e===void 0?void 0:$e.typingIndicatorTypes),!((Ee=t.groupChannel)===null||Ee===void 0)&&Ee.channel&&Vn((We=(fe=t.groupChannel)===null||fe===void 0?void 0:fe.channel)===null||We===void 0?void 0:We.enableFeedback)&&(n.channel.enableFeedback=(Yn=(yn=t.groupChannel)===null||yn===void 0?void 0:yn.channel)===null||Yn===void 0?void 0:Yn.enableFeedback),!((Sn=t.groupChannel)===null||Sn===void 0)&&Sn.channel&&Vn((Ct=(rt=t.groupChannel)===null||rt===void 0?void 0:rt.channel)===null||Ct===void 0?void 0:Ct.enableSuggestedReplies)&&(n.channel.enableSuggestedReplies=(Le=(pe=t.groupChannel)===null||pe===void 0?void 0:pe.channel)===null||Le===void 0?void 0:Le.enableSuggestedReplies),!((ae=t.groupChannel)===null||ae===void 0)&&ae.channel&&Zs((an=(Qe=t.groupChannel)===null||Qe===void 0?void 0:Qe.channel)===null||an===void 0?void 0:an.showSuggestedRepliesFor,["all_messages","last_message_only"])&&(n.channel.showSuggestedRepliesFor=(xn=(Tn=t.groupChannel)===null||Tn===void 0?void 0:Tn.channel)===null||xn===void 0?void 0:xn.showSuggestedRepliesFor),!((it=t.groupChannel)===null||it===void 0)&&it.channel&&Zs((Ie=(lt=t.groupChannel)===null||lt===void 0?void 0:lt.channel)===null||Ie===void 0?void 0:Ie.suggestedRepliesDirection,["vertical","horizontal"])&&(n.channel.suggestedRepliesDirection=(le=(j=t.groupChannel)===null||j===void 0?void 0:j.channel)===null||le===void 0?void 0:le.suggestedRepliesDirection),!((ke=t.groupChannel)===null||ke===void 0)&&ke.channel&&Vn((Kn=(Un=t.groupChannel)===null||Un===void 0?void 0:Un.channel)===null||Kn===void 0?void 0:Kn.enableMarkdownForUserMessage)&&(n.channel.enableMarkdownForUserMessage=(dt=(ut=t.groupChannel)===null||ut===void 0?void 0:ut.channel)===null||dt===void 0?void 0:dt.enableMarkdownForUserMessage),!((jt=t.groupChannel)===null||jt===void 0)&&jt.channel&&Vn((Ve=(Ht=t.groupChannel)===null||Ht===void 0?void 0:Ht.channel)===null||Ve===void 0?void 0:Ve.enableFormTypeMessage)&&(n.channel.enableFormTypeMessage=(Pn=(kn=t.groupChannel)===null||kn===void 0?void 0:kn.channel)===null||Pn===void 0?void 0:Pn.enableFormTypeMessage)}function Ow(n,t,e){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R,U,P,L,F,B,V,K,$,q,se,Y,ce,X,Se,te,be,xe,Pe,vn,on,je,Xe,sn,un,En,rn,qe,Je,ln,dn,ve,De,Ye,en,fn,Fe,Nn,nn,_e,zn,Rn,bn,Ge,cn,On,Ln,In,et,Gn,Cn,mn,ze,ue,Q,Te,He,$e,Ee,fe,We,yn,Yn,Sn,rt,Ct,pe,Le,ae,Qe,an,Tn,xn,it,lt,Ie,j,le,ke,Un,Kn;!((i=(r=e.groupChannel)===null||r===void 0?void 0:r.channel)===null||i===void 0)&&i.input&&Vn((u=(s=(a=e.groupChannel)===null||a===void 0?void 0:a.channel)===null||s===void 0?void 0:s.input)===null||u===void 0?void 0:u.enableDocument)&&(n.channel.input.enableDocument=(d=(l=(o=e.groupChannel)===null||o===void 0?void 0:o.channel)===null||l===void 0?void 0:l.input)===null||d===void 0?void 0:d.enableDocument),!((f=(c=t.groupChannel)===null||c===void 0?void 0:c.channel)===null||f===void 0)&&f.input&&Vn((_=(m=(h=t.groupChannel)===null||h===void 0?void 0:h.channel)===null||m===void 0?void 0:m.input)===null||_===void 0?void 0:_.enableDocument)&&(n.channel.input.enableDocument=(g=(b=(E=t.groupChannel)===null||E===void 0?void 0:E.channel)===null||b===void 0?void 0:b.input)===null||g===void 0?void 0:g.enableDocument),!((A=(S=(C=e.groupChannel)===null||C===void 0?void 0:C.channel)===null||S===void 0?void 0:S.input)===null||A===void 0)&&A.camera&&Vn((O=(M=(T=(I=e.groupChannel)===null||I===void 0?void 0:I.channel)===null||T===void 0?void 0:T.input)===null||M===void 0?void 0:M.camera)===null||O===void 0?void 0:O.enablePhoto)&&(n.channel.input.camera.enablePhoto=(L=(P=(U=(R=e.groupChannel)===null||R===void 0?void 0:R.channel)===null||U===void 0?void 0:U.input)===null||P===void 0?void 0:P.camera)===null||L===void 0?void 0:L.enablePhoto),!((V=(B=(F=t.groupChannel)===null||F===void 0?void 0:F.channel)===null||B===void 0?void 0:B.input)===null||V===void 0)&&V.camera&&Vn((se=(q=($=(K=t.groupChannel)===null||K===void 0?void 0:K.channel)===null||$===void 0?void 0:$.input)===null||q===void 0?void 0:q.camera)===null||se===void 0?void 0:se.enablePhoto)&&(n.channel.input.camera.enablePhoto=(Se=(X=(ce=(Y=t.groupChannel)===null||Y===void 0?void 0:Y.channel)===null||ce===void 0?void 0:ce.input)===null||X===void 0?void 0:X.camera)===null||Se===void 0?void 0:Se.enablePhoto),!((xe=(be=(te=e.groupChannel)===null||te===void 0?void 0:te.channel)===null||be===void 0?void 0:be.input)===null||xe===void 0)&&xe.camera&&Vn((je=(on=(vn=(Pe=e.groupChannel)===null||Pe===void 0?void 0:Pe.channel)===null||vn===void 0?void 0:vn.input)===null||on===void 0?void 0:on.camera)===null||je===void 0?void 0:je.enableVideo)&&(n.channel.input.camera.enableVideo=(En=(un=(sn=(Xe=e.groupChannel)===null||Xe===void 0?void 0:Xe.channel)===null||sn===void 0?void 0:sn.input)===null||un===void 0?void 0:un.camera)===null||En===void 0?void 0:En.enableVideo),!((Je=(qe=(rn=t.groupChannel)===null||rn===void 0?void 0:rn.channel)===null||qe===void 0?void 0:qe.input)===null||Je===void 0)&&Je.camera&&Vn((De=(ve=(dn=(ln=t.groupChannel)===null||ln===void 0?void 0:ln.channel)===null||dn===void 0?void 0:dn.input)===null||ve===void 0?void 0:ve.camera)===null||De===void 0?void 0:De.enableVideo)&&(n.channel.input.camera.enableVideo=(Fe=(fn=(en=(Ye=t.groupChannel)===null||Ye===void 0?void 0:Ye.channel)===null||en===void 0?void 0:en.input)===null||fn===void 0?void 0:fn.camera)===null||Fe===void 0?void 0:Fe.enableVideo),!((_e=(nn=(Nn=e.groupChannel)===null||Nn===void 0?void 0:Nn.channel)===null||nn===void 0?void 0:nn.input)===null||_e===void 0)&&_e.gallery&&Vn((Ge=(bn=(Rn=(zn=e.groupChannel)===null||zn===void 0?void 0:zn.channel)===null||Rn===void 0?void 0:Rn.input)===null||bn===void 0?void 0:bn.gallery)===null||Ge===void 0?void 0:Ge.enablePhoto)&&(n.channel.input.gallery.enablePhoto=(In=(Ln=(On=(cn=e.groupChannel)===null||cn===void 0?void 0:cn.channel)===null||On===void 0?void 0:On.input)===null||Ln===void 0?void 0:Ln.gallery)===null||In===void 0?void 0:In.enablePhoto),!((Cn=(Gn=(et=t.groupChannel)===null||et===void 0?void 0:et.channel)===null||Gn===void 0?void 0:Gn.input)===null||Cn===void 0)&&Cn.gallery&&Vn((Q=(ue=(ze=(mn=t.groupChannel)===null||mn===void 0?void 0:mn.channel)===null||ze===void 0?void 0:ze.input)===null||ue===void 0?void 0:ue.gallery)===null||Q===void 0?void 0:Q.enablePhoto)&&(n.channel.input.gallery.enablePhoto=(Ee=($e=(He=(Te=t.groupChannel)===null||Te===void 0?void 0:Te.channel)===null||He===void 0?void 0:He.input)===null||$e===void 0?void 0:$e.gallery)===null||Ee===void 0?void 0:Ee.enablePhoto),!((yn=(We=(fe=e.groupChannel)===null||fe===void 0?void 0:fe.channel)===null||We===void 0?void 0:We.input)===null||yn===void 0)&&yn.gallery&&Vn((Ct=(rt=(Sn=(Yn=e.groupChannel)===null||Yn===void 0?void 0:Yn.channel)===null||Sn===void 0?void 0:Sn.input)===null||rt===void 0?void 0:rt.gallery)===null||Ct===void 0?void 0:Ct.enableVideo)&&(n.channel.input.gallery.enableVideo=(Qe=(ae=(Le=(pe=e.groupChannel)===null||pe===void 0?void 0:pe.channel)===null||Le===void 0?void 0:Le.input)===null||ae===void 0?void 0:ae.gallery)===null||Qe===void 0?void 0:Qe.enableVideo),!((xn=(Tn=(an=t.groupChannel)===null||an===void 0?void 0:an.channel)===null||Tn===void 0?void 0:Tn.input)===null||xn===void 0)&&xn.gallery&&Vn((j=(Ie=(lt=(it=t.groupChannel)===null||it===void 0?void 0:it.channel)===null||lt===void 0?void 0:lt.input)===null||Ie===void 0?void 0:Ie.gallery)===null||j===void 0?void 0:j.enableVideo)&&(n.channel.input.gallery.enableVideo=(Kn=(Un=(ke=(le=t.groupChannel)===null||le===void 0?void 0:le.channel)===null||ke===void 0?void 0:ke.input)===null||Un===void 0?void 0:Un.gallery)===null||Kn===void 0?void 0:Kn.enableVideo)}function Rw(n,t,e){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S;!((r=e.groupChannel)===null||r===void 0)&&r.channelList&&Vn((a=(i=e.groupChannel)===null||i===void 0?void 0:i.channelList)===null||a===void 0?void 0:a.enableTypingIndicator)&&(n.channelList.enableTypingIndicator=e.groupChannel.channelList.enableTypingIndicator),!((s=t.groupChannel)===null||s===void 0)&&s.channelList&&Vn((o=(u=t.groupChannel)===null||u===void 0?void 0:u.channelList)===null||o===void 0?void 0:o.enableTypingIndicator)&&(n.channelList.enableTypingIndicator=(d=(l=t.groupChannel)===null||l===void 0?void 0:l.channelList)===null||d===void 0?void 0:d.enableTypingIndicator),!((c=e.groupChannel)===null||c===void 0)&&c.channelList&&Vn((h=(f=e.groupChannel)===null||f===void 0?void 0:f.channelList)===null||h===void 0?void 0:h.enableMessageReceiptStatus)&&(n.channelList.enableMessageReceiptStatus=(_=(m=e.groupChannel)===null||m===void 0?void 0:m.channelList)===null||_===void 0?void 0:_.enableMessageReceiptStatus),!((E=t.groupChannel)===null||E===void 0)&&E.channelList&&Vn((g=(b=t.groupChannel)===null||b===void 0?void 0:b.channelList)===null||g===void 0?void 0:g.enableMessageReceiptStatus)&&(n.channelList.enableMessageReceiptStatus=(S=(C=t.groupChannel)===null||C===void 0?void 0:C.channelList)===null||S===void 0?void 0:S.enableMessageReceiptStatus)}function Dw(n,t,e){var r,i,a,s,u,o,l,d;!((r=e.groupChannel)===null||r===void 0)&&r.setting&&Vn((a=(i=e.groupChannel)===null||i===void 0?void 0:i.setting)===null||a===void 0?void 0:a.enableMessageSearch)&&(n.setting.enableMessageSearch=e.groupChannel.setting.enableMessageSearch),!((s=t.groupChannel)===null||s===void 0)&&s.setting&&Vn((o=(u=t.groupChannel)===null||u===void 0?void 0:u.setting)===null||o===void 0?void 0:o.enableMessageSearch)&&(n.setting.enableMessageSearch=(d=(l=t.groupChannel)===null||l===void 0?void 0:l.setting)===null||d===void 0?void 0:d.enableMessageSearch)}function Lw(n,t,e){Uw(n,t,e),kw(n,t,e)}function Uw(n,t,e){var r,i,a,s,u,o,l,d;!((r=e.openChannel)===null||r===void 0)&&r.channel&&Vn((a=(i=e.openChannel)===null||i===void 0?void 0:i.channel)===null||a===void 0?void 0:a.enableOgtag)&&(n.channel.enableOgtag=e.openChannel.channel.enableOgtag),!((s=t.openChannel)===null||s===void 0)&&s.channel&&Vn((o=(u=t.openChannel)===null||u===void 0?void 0:u.channel)===null||o===void 0?void 0:o.enableOgtag)&&(n.channel.enableOgtag=(d=(l=t.openChannel)===null||l===void 0?void 0:l.channel)===null||d===void 0?void 0:d.enableOgtag)}function kw(n,t,e){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R,U,P,L,F,B,V,K,$,q,se,Y,ce,X,Se,te,be,xe,Pe,vn,on,je,Xe,sn,un,En,rn,qe,Je,ln,dn,ve,De,Ye,en,fn,Fe,Nn,nn,_e,zn,Rn,bn,Ge,cn,On,Ln,In,et,Gn,Cn,mn,ze,ue,Q,Te,He,$e,Ee,fe,We,yn,Yn,Sn,rt,Ct,pe,Le,ae,Qe,an,Tn,xn,it,lt,Ie,j,le,ke,Un,Kn;!((i=(r=e.openChannel)===null||r===void 0?void 0:r.channel)===null||i===void 0)&&i.input&&Vn((u=(s=(a=e.openChannel)===null||a===void 0?void 0:a.channel)===null||s===void 0?void 0:s.input)===null||u===void 0?void 0:u.enableDocument)&&(n.channel.input.enableDocument=(d=(l=(o=e.openChannel)===null||o===void 0?void 0:o.channel)===null||l===void 0?void 0:l.input)===null||d===void 0?void 0:d.enableDocument),!((f=(c=t.openChannel)===null||c===void 0?void 0:c.channel)===null||f===void 0)&&f.input&&Vn((_=(m=(h=t.openChannel)===null||h===void 0?void 0:h.channel)===null||m===void 0?void 0:m.input)===null||_===void 0?void 0:_.enableDocument)&&(n.channel.input.enableDocument=(g=(b=(E=t.openChannel)===null||E===void 0?void 0:E.channel)===null||b===void 0?void 0:b.input)===null||g===void 0?void 0:g.enableDocument),!((A=(S=(C=e.openChannel)===null||C===void 0?void 0:C.channel)===null||S===void 0?void 0:S.input)===null||A===void 0)&&A.camera&&Vn((O=(M=(T=(I=e.openChannel)===null||I===void 0?void 0:I.channel)===null||T===void 0?void 0:T.input)===null||M===void 0?void 0:M.camera)===null||O===void 0?void 0:O.enablePhoto)&&(n.channel.input.camera.enablePhoto=(L=(P=(U=(R=e.openChannel)===null||R===void 0?void 0:R.channel)===null||U===void 0?void 0:U.input)===null||P===void 0?void 0:P.camera)===null||L===void 0?void 0:L.enablePhoto),!((V=(B=(F=t.openChannel)===null||F===void 0?void 0:F.channel)===null||B===void 0?void 0:B.input)===null||V===void 0)&&V.camera&&Vn((se=(q=($=(K=t.openChannel)===null||K===void 0?void 0:K.channel)===null||$===void 0?void 0:$.input)===null||q===void 0?void 0:q.camera)===null||se===void 0?void 0:se.enablePhoto)&&(n.channel.input.camera.enablePhoto=(Se=(X=(ce=(Y=t.openChannel)===null||Y===void 0?void 0:Y.channel)===null||ce===void 0?void 0:ce.input)===null||X===void 0?void 0:X.camera)===null||Se===void 0?void 0:Se.enablePhoto),!((xe=(be=(te=e.openChannel)===null||te===void 0?void 0:te.channel)===null||be===void 0?void 0:be.input)===null||xe===void 0)&&xe.camera&&Vn((je=(on=(vn=(Pe=e.openChannel)===null||Pe===void 0?void 0:Pe.channel)===null||vn===void 0?void 0:vn.input)===null||on===void 0?void 0:on.camera)===null||je===void 0?void 0:je.enableVideo)&&(n.channel.input.camera.enableVideo=(En=(un=(sn=(Xe=e.openChannel)===null||Xe===void 0?void 0:Xe.channel)===null||sn===void 0?void 0:sn.input)===null||un===void 0?void 0:un.camera)===null||En===void 0?void 0:En.enableVideo),!((Je=(qe=(rn=t.openChannel)===null||rn===void 0?void 0:rn.channel)===null||qe===void 0?void 0:qe.input)===null||Je===void 0)&&Je.camera&&Vn((De=(ve=(dn=(ln=t.openChannel)===null||ln===void 0?void 0:ln.channel)===null||dn===void 0?void 0:dn.input)===null||ve===void 0?void 0:ve.camera)===null||De===void 0?void 0:De.enableVideo)&&(n.channel.input.camera.enableVideo=(Fe=(fn=(en=(Ye=t.openChannel)===null||Ye===void 0?void 0:Ye.channel)===null||en===void 0?void 0:en.input)===null||fn===void 0?void 0:fn.camera)===null||Fe===void 0?void 0:Fe.enableVideo),!((_e=(nn=(Nn=e.openChannel)===null||Nn===void 0?void 0:Nn.channel)===null||nn===void 0?void 0:nn.input)===null||_e===void 0)&&_e.gallery&&Vn((Ge=(bn=(Rn=(zn=e.openChannel)===null||zn===void 0?void 0:zn.channel)===null||Rn===void 0?void 0:Rn.input)===null||bn===void 0?void 0:bn.gallery)===null||Ge===void 0?void 0:Ge.enablePhoto)&&(n.channel.input.gallery.enablePhoto=(In=(Ln=(On=(cn=e.openChannel)===null||cn===void 0?void 0:cn.channel)===null||On===void 0?void 0:On.input)===null||Ln===void 0?void 0:Ln.gallery)===null||In===void 0?void 0:In.enablePhoto),!((Cn=(Gn=(et=t.openChannel)===null||et===void 0?void 0:et.channel)===null||Gn===void 0?void 0:Gn.input)===null||Cn===void 0)&&Cn.gallery&&Vn((Q=(ue=(ze=(mn=t.openChannel)===null||mn===void 0?void 0:mn.channel)===null||ze===void 0?void 0:ze.input)===null||ue===void 0?void 0:ue.gallery)===null||Q===void 0?void 0:Q.enablePhoto)&&(n.channel.input.gallery.enablePhoto=(Ee=($e=(He=(Te=t.openChannel)===null||Te===void 0?void 0:Te.channel)===null||He===void 0?void 0:He.input)===null||$e===void 0?void 0:$e.gallery)===null||Ee===void 0?void 0:Ee.enablePhoto),!((yn=(We=(fe=e.openChannel)===null||fe===void 0?void 0:fe.channel)===null||We===void 0?void 0:We.input)===null||yn===void 0)&&yn.gallery&&Vn((Ct=(rt=(Sn=(Yn=e.openChannel)===null||Yn===void 0?void 0:Yn.channel)===null||Sn===void 0?void 0:Sn.input)===null||rt===void 0?void 0:rt.gallery)===null||Ct===void 0?void 0:Ct.enableVideo)&&(n.channel.input.gallery.enableVideo=(Qe=(ae=(Le=(pe=e.openChannel)===null||pe===void 0?void 0:pe.channel)===null||Le===void 0?void 0:Le.input)===null||ae===void 0?void 0:ae.gallery)===null||Qe===void 0?void 0:Qe.enableVideo),!((xn=(Tn=(an=t.openChannel)===null||an===void 0?void 0:an.channel)===null||Tn===void 0?void 0:Tn.input)===null||xn===void 0)&&xn.gallery&&Vn((j=(Ie=(lt=(it=t.openChannel)===null||it===void 0?void 0:it.channel)===null||lt===void 0?void 0:lt.input)===null||Ie===void 0?void 0:Ie.gallery)===null||j===void 0?void 0:j.enableVideo)&&(n.channel.input.gallery.enableVideo=(Kn=(Un=(ke=(le=t.openChannel)===null||le===void 0?void 0:le.channel)===null||ke===void 0?void 0:ke.input)===null||Un===void 0?void 0:Un.gallery)===null||Kn===void 0?void 0:Kn.enableVideo)}function xw(n,t){const e=Gp();return Aw(e.common,n,t),Mw(e.groupChannel,n,t),Lw(e.openChannel,n,t),e}function Pw(n){return typeof n=="object"&&"configuration"in n&&"updated_at"in n}var Fw=function(n,t,e,r){function i(a){return a instanceof e?a:new e(function(s){s(a)})}return new(e||(e=Promise))(function(a,s){function u(d){try{l(r.next(d))}catch(c){s(c)}}function o(d){try{l(r.throw(d))}catch(c){s(c)}}function l(d){d.done?a(d.value):i(d.value).then(u,o)}l((r=r.apply(n,t||[])).next())})};function Gu(n){var t,e;return(e=(t=n.appInfo)===null||t===void 0?void 0:t.applicationAttributes)!==null&&e!==void 0?e:[]}const mC=N.createContext({initDashboardConfigs:()=>Promise.resolve(),configs:ug,configsWithAppAttr:()=>ug}),Hw=({storage:n,children:t,localConfigs:e={}})=>{const[r,i]=N.useState(pC),[a]=N.useState(()=>new Iw(n)),s=N.useCallback(l=>Fw(void 0,void 0,void 0,function*(){const d=yield a.init(l.appId);if(l.appInfo&&l.appInfo.uikitConfigInfo.lastUpdatedAt===d.updatedAt)i(d.configuration);else try{const c=yield l.getUIKitConfiguration();if(Pw(c.json)){const f=$f(c.json),h=yield a.update(f);i(h.configuration)}}catch{i(d.configuration)}}),[a]),u=xw(e,r),o=Yo(l=>({groupChannel:{channel:{get enableReactions(){return u.groupChannel.channel.enableReactions&&Gu(l).includes(Bu.reactions)},get enableReactionsSupergroup(){return u.groupChannel.channel.enableReactionsSupergroup&&Gu(l).includes(Bu.reactions)},get enableOgtag(){return u.groupChannel.channel.enableOgtag&&Gu(l).includes(Bu.enable_og_tag)}},setting:{get enableMessageSearch(){return u.groupChannel.setting.enableMessageSearch&&Gu(l).includes(Bu.message_search_v3)}}},openChannel:{channel:{get enableOgtag(){return u.openChannel.channel.enableOgtag&&Gu(l).includes(Bu.enable_og_tag)}}}}));return p.createElement(mC.Provider,{value:{initDashboardConfigs:s,configs:u,configsWithAppAttr:o}},t)},Bw=()=>N.useContext(mC);var _C=p.createContext(null),Tt;(function(n){n.NONE="NONE",n.PENDING="PENDING",n.SENT="SENT",n.FAILED="FAILED",n.DELIVERED="DELIVERED",n.READ="READ"})(Tt||(Tt={}));var gC=function(n,t){var e,r,i,a,s;if(!t||!("sendingStatus"in t))return Tt.NONE;if(t.sendingStatus==="pending")return Tt.PENDING;if(t.sendingStatus==="failed")return Tt.FAILED;if(!((e=n==null?void 0:n.isGroupChannel)===null||e===void 0)&&e.call(n)){if(((i=(r=n).getUnreadMemberCount)===null||i===void 0?void 0:i.call(r,t))===0)return Tt.READ;if(((s=(a=n).getUndeliveredMemberCount)===null||s===void 0?void 0:s.call(a,t))===0)return Tt.DELIVERED}return t.sendingStatus==="succeeded"?Tt.SENT:Tt.NONE},Gw=function(n){return/iPhone|iPad|iPod/i.test(n)},Vw=function(n){return/WebKit/i.test(n)},jw=function(n){return/Chrome/i.test(n)},Vp=function(n){return!jw(n)&&/Safari/i.test(n)},og=function(n){return Gw(n)&&(Vw(n)||Vp(n))};function Nd(n){"@babel/helpers - typeof";return Nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nd(n)}function xt(n,t){if(t.length<n)throw new TypeError(n+" argument"+(n>1?"s":"")+" required, but only "+t.length+" present")}function xr(n){xt(1,arguments);var t=Object.prototype.toString.call(n);return n instanceof Date||Nd(n)==="object"&&t==="[object Date]"?new Date(n.getTime()):typeof n=="number"||t==="[object Number]"?new Date(n):((typeof n=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var Ba=10,bu=100,EC=100,$c=250,vC=1e3,qw=6e5,zw=12e3,BP=11025,lg=["audio/webm","audio/mp4","audio/mpeg","audio/ogg"],$l="sendbird-voice-player-provider-root",Yf="sendbird-global-audio-player-id",Id="Voice_message.mp3",Kw="Voice_message.m4a",Rs="audio/mp3;sbu_type=voice",$w="audio/x-m4a;sbu_type=voice",Ww="KEY_VOICE_MESSAGE_DURATION",Yw="KEY_INTERNAL_MESSAGE_TYPE",Qw="voice/mp3",yC="delivery_receipt",Nl="32px",Xw=10,Zw=25*1024*1024,Wc="sendbird_message_templates_token_key",Js="sendbird_message_templates_key",Qo="message_template",Ui=Symbol("@ts-pattern/matcher"),Ad="@ts-pattern/anonymous-select-key",Qf=function(n){return!!(n&&typeof n=="object")},Wl=function(n){return n&&!!n[Ui]},zs=function n(t,e,r){if(Qf(t)){if(Wl(t)){var i=t[Ui]().match(e),a=i.matched,s=i.selections;return a&&s&&Object.keys(s).forEach(function(o){return r(o,s[o])}),a}if(!Qf(e))return!1;if(Array.isArray(t))return!!Array.isArray(e)&&t.length===e.length&&t.every(function(o,l){return n(o,e[l],r)});if(t instanceof Map)return e instanceof Map&&Array.from(t.keys()).every(function(o){return n(t.get(o),e.get(o),r)});if(t instanceof Set){if(!(e instanceof Set))return!1;if(t.size===0)return e.size===0;if(t.size===1){var u=Array.from(t.values())[0];return Wl(u)?Array.from(e.values()).every(function(o){return n(u,o,r)}):e.has(u)}return Array.from(t.values()).every(function(o){return e.has(o)})}return Object.keys(t).every(function(o){var l,d=t[o];return(o in e||Wl(l=d)&&l[Ui]().matcherType==="optional")&&n(d,e[o],r)})}return Object.is(e,t)},Ja=function n(t){var e,r,i;return Qf(t)?Wl(t)?(e=(r=(i=t[Ui]()).getSelectionKeys)==null?void 0:r.call(i))!=null?e:[]:Array.isArray(t)?xo(t,n):xo(Object.values(t),n):[]},xo=function(n,t){return n.reduce(function(e,r){return e.concat(t(r))},[])};function dg(n){var t;return(t={})[Ui]=function(){return{match:function(e){var r={},i=function(a,s){r[a]=s};return e===void 0?(Ja(n).forEach(function(a){return i(a,void 0)}),{matched:!0,selections:r}):{matched:zs(n,e,i),selections:r}},getSelectionKeys:function(){return Ja(n)},matcherType:"optional"}},t}function cg(n){var t;return(t={})[Ui]=function(){return{match:function(e){if(!Array.isArray(e))return{matched:!1};var r={};if(e.length===0)return Ja(n).forEach(function(a){r[a]=[]}),{matched:!0,selections:r};var i=function(a,s){r[a]=(r[a]||[]).concat([s])};return{matched:e.every(function(a){return zs(n,a,i)}),selections:r}},getSelectionKeys:function(){return Ja(n)}}},t}function fg(){var n,t=[].slice.call(arguments);return(n={})[Ui]=function(){return{match:function(e){var r={},i=function(a,s){r[a]=s};return{matched:t.every(function(a){return zs(a,e,i)}),selections:r}},getSelectionKeys:function(){return xo(t,Ja)},matcherType:"and"}},n}function hg(){var n,t=[].slice.call(arguments);return(n={})[Ui]=function(){return{match:function(e){var r={},i=function(a,s){r[a]=s};return xo(t,Ja).forEach(function(a){return i(a,void 0)}),{matched:t.some(function(a){return zs(a,e,i)}),selections:r}},getSelectionKeys:function(){return xo(t,Ja)},matcherType:"or"}},n}function pg(n){var t;return(t={})[Ui]=function(){return{match:function(e){return{matched:!zs(n,e,function(){})}},getSelectionKeys:function(){return[]},matcherType:"not"}},t}function Qi(n){var t;return(t={})[Ui]=function(){return{match:function(e){return{matched:!!n(e)}}}},t}function mg(){var n,t=[].slice.call(arguments),e=typeof t[0]=="string"?t[0]:void 0,r=t.length===2?t[1]:typeof t[0]=="string"?void 0:t[0];return(n={})[Ui]=function(){return{match:function(i){var a,s=((a={})[e??Ad]=i,a);return{matched:r===void 0||zs(r,i,function(u,o){s[u]=o}),selections:s}},getSelectionKeys:function(){return[e??Ad].concat(r===void 0?[]:Ja(r))}}},n}var bC=Qi(function(n){return!0}),Jw=bC,eO=Qi(function(n){return typeof n=="string"}),nO=Qi(function(n){return typeof n=="number"}),tO=Qi(function(n){return typeof n=="boolean"}),rO=Qi(function(n){return typeof n=="bigint"}),iO=Qi(function(n){return typeof n=="symbol"}),aO=Qi(function(n){return n==null}),Xf={__proto__:null,optional:dg,array:cg,intersection:fg,union:hg,not:pg,when:Qi,select:mg,any:bC,_:Jw,string:eO,number:nO,boolean:tO,bigint:rO,symbol:iO,nullish:aO,instanceOf:function(n){return Qi(function(t){return function(e){return e instanceof t}}(n))},typed:function(){return{array:cg,optional:dg,intersection:fg,union:hg,not:pg,select:mg,when:Qi}}};function cr(n){return new sO(n,[])}var sO=function(){function n(e,r){this.value=void 0,this.cases=void 0,this.value=e,this.cases=r}var t=n.prototype;return t.with=function(){var e=[].slice.call(arguments),r=e[e.length-1],i=[e[0]],a=[];return e.length===3&&typeof e[1]=="function"?(i.push(e[0]),a.push(e[1])):e.length>2&&i.push.apply(i,e.slice(1,e.length-1)),new n(this.value,this.cases.concat([{match:function(s){var u={},o=!!(i.some(function(l){return zs(l,s,function(d,c){u[d]=c})})&&a.every(function(l){return l(s)}));return{matched:o,value:o&&Object.keys(u).length?Ad in u?u[Ad]:u:s}},handler:r}]))},t.when=function(e,r){return new n(this.value,this.cases.concat([{match:function(i){return{matched:!!e(i),value:i}},handler:r}]))},t.otherwise=function(e){return new n(this.value,this.cases.concat([{match:function(r){return{matched:!0,value:r}},handler:e}])).run()},t.exhaustive=function(){return this.run()},t.run=function(){for(var e=this.value,r=void 0,i=0;i<this.cases.length;i++){var a=this.cases[i],s=a.match(this.value);if(s.matched){e=s.value,r=a.handler;break}}if(!r){var u;try{u=JSON.stringify(this.value)}catch{u=this.value}throw new Error("Pattern matching error: no pattern matches value "+u)}return r(e,this.value)},n}();function _g(n){xt(1,arguments);var t=xr(n);return t.setMilliseconds(0),t}function uO(n,t){xt(2,arguments);var e=_g(n),r=_g(t);return e.getTime()===r.getTime()}var Yc,Pa={IMAGE:["image/jpeg","image/jpg","image/png","image/gif","image/svg+xml","image/webp","image/bmp"],VIDEO:["video/mpeg","video/ogg","video/webm","video/mp4"],AUDIO:["audio/aac","audio/midi","audio/x-midi","audio/mpeg","audio/ogg","audio/opus","audio/wav","audio/webm","audio/3gpp","audio/3gpp2","audio/mp3"],DOCUMENT:["text/plain","text/css","text/csv","text/html","text/calendar","text/javascript","text/xml","text/x-log","video/quicktime"],APPLICATION:["application/x-abiword","application/x-freearc","application/vnd.amazon.ebook","application/octet-stream","application/x-bzip","application/x-bzip2","application/x-cdf","application/x-csh","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-fontobject","application/epub+zip","application/gzip","application/java-archive","application/json","application/ld+json","application/vnd.apple.installer+xml","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.text","application/ogg","application/pdf","application/x-httpd-php","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.rar","application/rtf","application/x-sh","application/x-tar","application/vnd.visio","application/xhtml+xml","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/xml","application/vnd.mozilla.xul+xml","application/zip","application/x-7z-compressed"],ARCHIVE:["application/zip","application/x-rar-compressed","application/x-7z-compressed","application/x-tar","application/gzip","application/x-bzip","application/x-bzip2","application/x-xz","application/x-iso9660-image"]},Vu={IMAGE:[".apng",".avif",".gif",".jpg",".jpeg",".jfif",".pjpeg",".pjp",".png",".svg",".webp",".bmp",".ico",".cur",".tif",".tiff",".heic",".heif"],VIDEO:[".mp4",".webm",".ogv",".3gp",".3g2",".avi",".mov",".wmv",".mpg",".mpeg",".m4v",".mkv"],AUDIO:[".aac",".midi",".mp3",".oga",".opus",".wav",".weba",".3gp",".3g2"],DOCUMENT:[".txt",".log",".csv",".rtf",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx"],ARCHIVE:[".zip",".rar",".7z",".tar",".gz",".bz2",".xz",".iso"]},oO=function(n){if(Array.isArray(n)&&n.length>0){var t=n.reduce(function(e,r){var i=r.toLowerCase();switch(i){case"image":{e.push.apply(e,Ce(Ce([],Pa.IMAGE,!1),Vu.IMAGE,!1));break}case"video":{e.push.apply(e,Ce(Ce([],Pa.VIDEO,!1),Vu.VIDEO,!1));break}case"audio":{e.push.apply(e,Ce(Ce([],Pa.AUDIO,!1),Vu.AUDIO,!1));break}case"archive":{e.push.apply(e,Ce(Ce([],Pa.ARCHIVE,!1),Vu.ARCHIVE,!1));break}default:{e.push(r);break}}return e},[]);return Array.from(new Set(t)).join(",")}return Ce(Ce([],Object.values(Pa).flat(),!0),Object.values(Vu).flat(),!0).join(",")},Fi={ADMIN:"ADMIN",TEXT:"TEXT",FILE:"FILE",MULTIPLE_FILES:"MULTIPLE_FILES",THUMBNAIL:"THUMBNAIL",OG:"OG",UNKNOWN:"UNKNOWN"},_s={IMAGE:"IMAGE",AUDIO:"AUDIO",VIDEO:"VIDEO",GIF:"GIF",VOICE:"VOICE",OTHERS:"OTHERS"},gg=function(n){return n===""||n===null},lO=function(n){return n==="video/quicktime"},dO=function(n){return Vp(navigator.userAgent)&&lO(n)},Ia=function(n){return Pa.IMAGE.indexOf(n)>=0},es=function(n){return Pa.VIDEO.indexOf(n)>=0||dO(n)},Ks=function(n){return n==="image/gif"},Po=function(n){return Ia(n)||es(n)},jp=function(n){return Pa.AUDIO.indexOf(n)>=0},cO=function(){return G({},_s)},CC=function(n){return Ks(n)?_s.GIF:Ia(n)?_s.IMAGE:es(n)?_s.VIDEO:jp(n)?_s.AUDIO:_s.OTHERS},Fo=function(n){return n.sendingStatus==="succeeded"},Eg=function(n,t){return gC(n,t)===Tt.READ},li=function(n){return(n==null?void 0:n.sendingStatus)==="failed"},Oi=function(n){return(n==null?void 0:n.sendingStatus)==="pending"},fO=function(n){return n===Tt.SENT||n===Tt.DELIVERED||n===Tt.READ},SC=function(n){return n&&(n.isAdminMessage&&typeof n.isAdminMessage=="function"?n.isAdminMessage():(n==null?void 0:n.messageType)==="admin")},Pr=function(n){return n&&(n.isUserMessage&&typeof n.isUserMessage=="function"?n.isUserMessage():(n==null?void 0:n.messageType)==="user")},Ir=function(n){return!!n&&(n.isFileMessage&&typeof n.isFileMessage=="function"?n.isFileMessage():(n==null?void 0:n.messageType)==="file")},kr=function(n){return n&&(n.isMultipleFilesMessage&&typeof n.isMultipleFilesMessage=="function"?n.isMultipleFilesMessage():n.messageType==="file"&&Object.prototype.hasOwnProperty.call(n,"fileInfoList"))},TC=function(n){return!!n.parentMessageId&&!!n.parentMessage},NC=function(n){return!!n.messageForm},Md=function(n){var t;return!!(n&&(!((t=n.extendedMessagePayload)===null||t===void 0)&&t[Qo]))},IC=function(n){var t=n.type;return!(t&&!AC[t])},AC={default:"default"},hO=(Yc={},Yc[AC.default]="ui_container_type__default",Yc),qp=function(n){return!n||!Pr(n)?!1:!!n.ogMetaData&&!!(n.ogMetaData.url||n.ogMetaData.title||n.ogMetaData.description||n.ogMetaData.defaultImage)},pO=function(n){return Pr(n)},ts=function(n){return!n||!Ir(n)?!1:Po(n.type)},MC=function(n){return!n||!Ir(n)?!1:ts(n)&&Ia(n.type)},pu=function(n){return!n||!Ir(n)?!1:ts(n)&&es(n.type)},Zf=function(n){return!n||!Ir(n)?!1:ts(n)&&Ks(n.type)},mO=function(n){return!n||!Ir(n)?!1:jp(n.type)},_O=function(n){return n?!!n.mimeType&&(Ia(n.mimeType)||Ks(n.mimeType)):!1},gO=function(n){return/^audio\//.test(n)},wC=function(n){return/^voice\//.test(n)},Ji=function(n){var t,e,r,i;if(!n||!Ir(n)||!n.type)return!1;var a=n.type.split(";"),s=a[0],u=a[1];if(!gO(s))return!1;if(u){var o=u.split("="),l=o[0],d=o[1];return l==="sbu_type"&&d==="voice"}return wC((i=(r=(e=(t=n==null?void 0:n.metaArrays)===null||t===void 0?void 0:t.find(function(c){return c.key==="KEY_INTERNAL_MESSAGE_TYPE"}))===null||e===void 0?void 0:e.value)===null||r===void 0?void 0:r[0])!==null&&i!==void 0?i:"")},OC=function(n){return Pr(n)&&(n==null?void 0:n.updatedAt)>0},EO=function(){return G({},Fi)},zp=function(n){return SC(n)?Fi.ADMIN:Pr(n)?qp(n)?Fi.OG:Fi.TEXT:kr(n)?Fi.MULTIPLE_FILES:Ir(n)?ts(n)?Fi.THUMBNAIL:Ji(n)?_s.VOICE:Fi.FILE:Fi.UNKNOWN},vO=function(n,t){return Array.isArray(t)?Ce(Ce([],n,!0),t,!0):(n.push(t),n)},Br=function(n){return Array.isArray(n)?n.reduce(vO,[]).join(" "):n},RC=function(n,t){return t.userIds.some(function(e){return e===n})},yO=function(n,t,e,r){var i="";return RC(t,n)&&(i=n.userIds.length===1?r.TOOLTIP__YOU:r.TOOLTIP__AND_YOU),"".concat(n.userIds.filter(function(a){return a!==t}).map(function(a){return e.get(a)||r.TOOLTIP__UNKNOWN_USER}).join(", ")).concat(i)};function DC(n){var t;return n!=null&&n.extendedMessagePayload&&Array.isArray((t=n==null?void 0:n.extendedMessagePayload)===null||t===void 0?void 0:t.suggested_replies)?n.extendedMessagePayload.suggested_replies:[]}var LC=function(n,t){if(t||(t=40),n==null)return"";if(n.length<=t)return n;var e="...",r=e.length,i=t-r,a=Math.ceil(i/2),s=Math.floor(i/2);return n.substr(0,a)+e+n.substr(n.length-s)},Kp=function(n){if(window.clipboardData&&window.clipboardData.setData)return window.clipboardData.setData("Text",n);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var t=document.createElement("textarea");t.textContent=n,t.style.position="fixed",document.body.appendChild(t),t.select();try{return document.execCommand("copy")}catch{return!1}finally{document.body.removeChild(t)}}return!1},$p=function(n){var t;return(t=n==null?void 0:n.emojiCategories)===null||t===void 0?void 0:t.map(function(e){return e.emojis}).reduce(function(e,r){return e.concat(r)},[])},bO=function(n){var t,e=new Map;return(t=n==null?void 0:n.emojiCategories)===null||t===void 0||t.forEach(function(r){var i;(i=r==null?void 0:r.emojis)===null||i===void 0||i.forEach(function(a){a&&a.key&&e.set(a.key,a)})}),e},Yl=function(n,t){var e;return t?((e=n==null?void 0:n.emojiCategories)===null||e===void 0?void 0:e.filter(function(r){return t.includes(r.id)}).flatMap(function(r){return r.emojis}))||[]:$p(n)},CO=function(n){return function(t){var e=t.key;return e===n}},SO=function(n,t){var e,r,i=CO(t??"");return((r=(e=n==null?void 0:n.emojiCategories.find(function(a){return a.emojis.some(i)}))===null||e===void 0?void 0:e.emojis.find(i))===null||r===void 0?void 0:r.url)||""},TO=function(n){return(n==null?void 0:n.friendName)||(n==null?void 0:n.nickname)||(n==null?void 0:n.userId)},NO=function(n){return(n==null?void 0:n.sender)&&TO(n==null?void 0:n.sender)},IO=function(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(var e=Ce([],n,!0).sort(),r=Ce([],t,!0).sort(),i=0;i<e.length;++i)if(e[i]!==r[i])return!1;return!0},vg=function(n){return n?!!(n.friendDiscoveryKey||n.friendName):!1},yg=function(n,t){var e,r,i,a,s=n.customTypesFilter,u=s===void 0?[]:s;if(n!=null&&n.messageTypeFilter&&n.messageTypeFilter!==t.messageType)return!1;if((u==null?void 0:u.length)>0){var o=u.filter(function(d){return d!=="*"});if(o.length>0&&!o.includes(t.customType))return!1}if(n!=null&&n.senderUserIdsFilter&&((e=n==null?void 0:n.senderUserIdsFilter)===null||e===void 0?void 0:e.length)>0)if(!((r=t==null?void 0:t.isUserMessage)===null||r===void 0)&&r.call(t)||!((i=t==null?void 0:t.isFileMessage)===null||i===void 0)&&i.call(t)){var l=t.sender||t._sender;if(!(!((a=n==null?void 0:n.senderUserIdsFilter)===null||a===void 0)&&a.includes(l==null?void 0:l.userId)))return!1}else return!1;return!(!(n!=null&&n.includeParentMessageInfo)&&(t!=null&&t.parentMessageId||t!=null&&t.parentMessage))},eu=function(n,t,e){var r,i,a,s,u,o,l,d=n.includeEmpty,c=n.includeFrozen,f=n.searchFilter,h=n.userIdsFilter,m=n.customTypesFilter,_=n.channelUrlsFilter,E=n.customTypeStartsWithFilter,b=n.channelNameContainsFilter,g=n.nicknameContainsFilter,C=n.myMemberStateFilter,S=n.hiddenChannelFilter,A=n.unreadChannelFilter,I=n.publicChannelFilter,T=n.superChannelFilter,M=n.metadataKey,O=M===void 0?"":M,R=n.metadataValues,U=R===void 0?["a","b"]:R,P=n.metadataValueStartsWith;if(!d&&(t==null?void 0:t.lastMessage)===null)return!1;if(f!=null&&f.query&&((i=(r=f==null?void 0:f.fields)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0){var L=f.query,F=f.fields;if(L&&F&&F.length>0&&!F.some(function(X){var Se,te;switch(X){case"channel_name":return(Se=t==null?void 0:t.name)===null||Se===void 0?void 0:Se.toLowerCase().includes(L.toLowerCase());case"member_nickname":return(te=t==null?void 0:t.members)===null||te===void 0?void 0:te.some(function(be){return be.nickname.toLowerCase().includes(L.toLowerCase())});default:return!0}}))return!1}if(((a=h==null?void 0:h.userIds)===null||a===void 0?void 0:a.length)>0){var B=h.includeMode,V=h.queryType,K=h.userIds,$=(s=t==null?void 0:t.members)===null||s===void 0?void 0:s.map(function(X){return X.userId});if(B){if(K.length>0)switch(V){case"AND":{if(K.some(function(X){return!$.includes(X)}))return!1;break}case"OR":{if(K.every(function(X){return!$.includes(X)}))return!1;break}}}else if(K.includes(e)||K.push(e),((u=t==null?void 0:t.members)===null||u===void 0?void 0:u.length)>K.length||!IO(K,$))return!1}if(d===!1&&(t==null?void 0:t.lastMessage)===null||c===!1&&(t==null?void 0:t.isFrozen)===!0||m&&!m.includes(t==null?void 0:t.customType)||E&&!new RegExp("^".concat(E)).test(t==null?void 0:t.customType)||b&&!(!((o=t==null?void 0:t.name)===null||o===void 0)&&o.toLowerCase().includes(b.toLowerCase())))return!1;if(g){var q=g.toLowerCase();if(!((l=t==null?void 0:t.members)===null||l===void 0)&&l.every(function(X){return!X.nickname.toLowerCase().includes(q)}))return!1}if(_&&!_.includes(t==null?void 0:t.url))return!1;if(C)switch(C){case"joined_only":if((t==null?void 0:t.myMemberState)!=="joined")return!1;break;case"invited_only":if((t==null?void 0:t.myMemberState)!=="invited")return!1;break;case"invited_by_friend":if((t==null?void 0:t.myMemberState)!=="invited"||!vg(t==null?void 0:t.inviter))return!1;break;case"invited_by_non_friend":if((t==null?void 0:t.myMemberState)!=="invited"||vg(t==null?void 0:t.inviter))return!1;break}if(S)switch(S){case"unhidden_only":if(t!=null&&t.isHidden||(t==null?void 0:t.hiddenState)!=="unhidden")return!1;break;case"hidden_only":if(!(t!=null&&t.isHidden))return!1;break;case"hidden_allow_auto_unhide":if(!(t!=null&&t.isHidden)||(t==null?void 0:t.hiddenState)!=="hidden_allow_auto_unhide")return!1;break;case"hidden_prevent_auto_unhide":if(!(t!=null&&t.isHidden)||(t==null?void 0:t.hiddenState)!=="hidden_prevent_auto_unhide")return!1;break}if(A)switch(A){case"unread_message":if((t==null?void 0:t.unreadMessageCount)===0)return!1;break}if(I)switch(I){case"public":if(!(t!=null&&t.isPublic))return!1;break;case"private":if(t!=null&&t.isPublic)return!1;break}if(T)switch(T){case"super":if(!(t!=null&&t.isSuper))return!1;break;case"nonsuper":if(t!=null&&t.isSuper)return!1;break}var se=t.cachedMetaData,Y=se===void 0?{}:se;if(O&&(U||P)){var ce=Y[O];if(!ce||U&&!U.every(function(X){return ce.includes(X)})||P&&!ce.startsWith(P))return!1}return!0},AO=function(n,t){var e=cr(t).with(Et.CHANNEL_NAME_ALPHABETICAL,function(){return function(r,i){return r.name.localeCompare(i.name)}}).with(Et.CHRONOLOGICAL,function(){return function(r,i){return i.createdAt-r.createdAt}}).otherwise(function(){return function(r,i){var a,s,u,o;return((s=(a=i.lastMessage)===null||a===void 0?void 0:a.createdAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER)-((o=(u=r.lastMessage)===null||u===void 0?void 0:u.createdAt)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER)}});return n.sort(e)},nu=function(n,t,e){var r=Ce([],n,!0),i=r.findIndex(function(a){return a.url===t.url});return i!==-1?r[i]=t:r.push(t),AO(r,e??Et.LATEST_LAST_MESSAGE)},bg;(function(n){n.normal="normal",n.mention="mention",n.url="url"})(bg||(bg={}));var MO=function(n,t){if(Array.isArray(n)&&Array.isArray(t)&&n.length===t.length){for(var e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}return!1},Xo=function(n){return!!n&&"sender"in n},wO=function(n){return uO(n.createdAt,n.invitedAt)&&!n.lastMessage},OO=function(n,t){return t?"ltr":n},RO="Group Channel",DO="AI Chatbot Widget Channel",UC=function(n){return!(n!=null&&n.name)||n.name===RO||n.name===DO},ot=function(){},Zo=function(n){var t={};return Object.entries(n).forEach(function(e){var r=e[0],i=e[1];i!=null&&(t[r]=i)}),t};function Wp(n){var t=n;t&&(!t.startsWith("http://")&&!t.startsWith("https://")&&(t="https://"+t),window.open(t,"_blank","noopener,noreferrer"))}function Fn(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return n.filter(Boolean).join(" ")}var LO={en:{MESSAGE_STATUS__YESTERDAY:"Yesterday",CHANNEL__MESSAGE_LIST__NOTIFICATION__NEW_MESSAGE:"new message(s) since",CHANNEL__MESSAGE_LIST__NOTIFICATION__ON:"on",CHANNEL_PREVIEW_MOBILE_LEAVE:"Leave channel",CHANNEL_SETTING__HEADER__TITLE:"Channel information",CHANNEL_SETTING__PROFILE__EDIT:"Edit",CHANNEL_SETTING__MEMBERS__TITLE:"Members",CHANNEL_SETTING__MEMBERS__SEE_ALL_MEMBERS:"All members",CHANNEL_SETTING__MEMBERS__INVITE_MEMBER:"Invite users",CHANNEL_SETTING__MEMBERS__YOU:" (You)",CHANNEL_SETTING__MEMBERS__SELECT_TITLE:"Select members",CHANNEL_SETTING__MEMBERS__OPERATOR:"Operator",CHANNEL_SETTING__LEAVE_CHANNEL__TITLE:"Leave channel",CHANNEL_SETTING__OPERATORS__TITLE:"Operators",CHANNEL_SETTING__OPERATORS__TITLE_ALL:"All operators",CHANNEL_SETTING__OPERATORS__TITLE_ADD:"Add operator",CHANNEL_SETTING__OPERATORS__ADD_BUTTON:"Add",CHANNEL_SETTING__MUTED_MEMBERS__TITLE:"Muted members",CHANNEL_SETTING__MUTED_MEMBERS__TITLE_ALL:"All muted members",CHANNEL_SETTING__NO_UNMUTED:"No muted members yet",CHANNEL_SETTING__BANNED_MEMBERS__TITLE:"Banned users",CHANNEL_SETTING__FREEZE_CHANNEL:"Freeze Channel",CHANNEL_SETTING__MODERATION__REGISTER_AS_OPERATOR:"Register as operator",CHANNEL_SETTING__MODERATION__UNREGISTER_OPERATOR:"Unregister operator",CHANNEL_SETTING__MODERATION__MUTE:"Mute",CHANNEL_SETTING__MODERATION__UNMUTE:"Unmute",CHANNEL_SETTING__MODERATION__BAN:"Ban",CHANNEL_SETTING__MODERATION__UNBAN:"Unban",CHANNEL_SETTING__MODERATION__EMPTY_BAN:"No banned members yet",CHANNEL_SETTING__MODERATION__ALL_BAN:"All banned members",OPEN_CHANNEL_CONVERSATION__TITLE_PARTICIPANTS:"participants",OPEN_CHANNEL_CONVERSATION__SELECT_PARTICIPANTS:"Select participants",OPEN_CHANNEL_LIST__TITLE:"Channels",CREATE_OPEN_CHANNEL_LIST__TITLE:"New channel profile",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__IMG_SECTION:"Channel image",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__IMG_UPLOAD:"Upload",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__TEXT_SECTION:"Channel name",CREATE_OPEN_CHANNEL_LIST__SUBTITLE__TEXT_PLACE_HOLDER:"Enter channel name",CREATE_OPEN_CHANNEL_LIST__SUBMIT:"Create",OPEN_CHANNEL_SETTINGS__OPERATOR_TITLE:"Channel Information",OPEN_CHANNEL_SETTINGS__OPERATOR_URL:"URL",OPEN_CHANNEL_SETTINGS__PARTICIPANTS_ACCORDION_TITLE:"Participants",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_PANEL:"Delete channel",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_TITLE:"Delete channel?",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_CONTEXT:"Once deleted, this channel can't be restored.",OPEN_CHANNEL_SETTINGS__DELETE_CHANNEL_SUBMIT:"Delete",OPEN_CHANNEL_SETTINGS__OPERATORS_TITLE:"Operators",OPEN_CHANNEL_SETTINGS__OPERATORS__TITLE_ADD:"Add operator",OPEN_CHANNEL_SETTINGS__OPERATORS__TITLE_ALL:"All operators",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__TITLE:"Muted participants",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__TITLE_ALL:"All muted participants",OPEN_CHANNEL_SETTINGS__MUTED_MEMBERS__NO_ONE:"No muted participants yet",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__TITLE:"Banned users",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__TITLE_ALL:"All banned users",OPEN_CHANNEL_SETTINGS__BANNED_MEMBERS__NO_ONE:"No banned users yet",OPEN_CHANNEL_SETTINGS__MEMBERS__YOU:" (You)",OPEN_CHANNEL_SETTINGS__MEMBERS__OPERATOR:"Operator",OPEN_CHANNEL_SETTINGS__PARTICIPANTS_TITLE:"Participants",OPEN_CHANNEL_SETTINGS__EMPTY_LIST:"No participants yet",OPEN_CHANNEL_SETTINGS__SEE_ALL:"See all participants",OPEN_CHANNEL_SETTINGS__ALL_PARTICIPANTS_TITLE:"All participants",OPEN_CHANNEL_SETTINGS__NO_TITLE:"(No title)",OPEN_CHANNEL_SETTING__MODERATION__REGISTER_AS_OPERATOR:"Register as operator",OPEN_CHANNEL_SETTING__MODERATION__UNREGISTER_OPERATOR:"Unregister operator",OPEN_CHANNEL_SETTING__MODERATION__MUTE:"Mute",OPEN_CHANNEL_SETTING__MODERATION__UNMUTE:"Unmute",OPEN_CHANNEL_SETTING__MODERATION__BAN:"Ban",OPEN_CHANNEL_SETTING__MODERATION__UNBAN:"Unban",TRYING_TO_CONNECT:"Trying to connect…",TYPING_INDICATOR__IS_TYPING:"is typing...",TYPING_INDICATOR__AND:"and",TYPING_INDICATOR__ARE_TYPING:"are typing...",TYPING_INDICATOR__MULTIPLE_TYPING:"Several people are typing...",CHANNEL_FROZEN:"Channel frozen",PLACE_HOLDER__NO_CHANNEL:"No channels",PLACE_HOLDER__WRONG:"Something went wrong",PLACE_HOLDER__RETRY_TO_CONNECT:"Retry",PLACE_HOLDER__NO_MESSAGES:"No messages",TOOLTIP__AND_YOU:", and you",TOOLTIP__YOU:"you",TOOLTIP__UNKNOWN_USER:"(no name)",UNKNOWN__UNKNOWN_MESSAGE_TYPE:"(Unknown message type)",UNKNOWN__CANNOT_READ_MESSAGE:"Cannot read this message.",UNKNOWN__TEMPLATE_ERROR:"(Template error)",FORM_VERSION_ERROR:"Form type messages are not available in this version.",UNKNOWN__CANNOT_READ_TEMPLATE:"Cannot read this template.",MESSAGE_EDITED:"(edited)",MODAL__DELETE_MESSAGE__TITLE:"Delete this message?",MODAL__CHANNEL_INFORMATION__TITLE:"Edit channel information",MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE:"Channel image",MODAL__CHANNEL_INFORMATION__UPLOAD:"Upload",MODAL__CHANNEL_INFORMATION__CHANNEL_NAME:"Channel name",MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER:"Enter name",MODAL__INVITE_MEMBER__TITLE:"Invite member",MODAL__INVITE_MEMBER__SELECTED:"selected",MODAL__CHOOSE_CHANNEL_TYPE__TITLE:"New channel",MODAL__CHOOSE_CHANNEL_TYPE__GROUP:"Group",MODAL__CHOOSE_CHANNEL_TYPE__SUPER_GROUP:"Super group",MODAL__CHOOSE_CHANNEL_TYPE__BROADCAST:"Broadcast",MODAL__CREATE_CHANNEL__TITLE:"New channel",MODAL__CREATE_CHANNEL__GROUP:"Group",MODAL__CREATE_CHANNEL__SUPER:"Super group",MODAL__CREATE_CHANNEL__BROADCAST:"Broadcast",MODAL__CREATE_CHANNEL__SELECTED:"selected",MODAL__LEAVE_CHANNEL__TITLE:"Leave this channel?",MODAL__LEAVE_CHANNEL__FOOTER:"Leave",MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED:"You're muted by the operator.",MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN:"Channel is frozen.",USER_PROFILE__MESSAGE:"Message",USER_PROFILE__USER_ID:"User ID",EDIT_PROFILE__TITLE:"My profile",EDIT_PROFILE__IMAGE_LABEL:"Profile image",EDIT_PROFILE__IMAGE_UPLOAD:"Upload",EDIT_PROFILE__NICKNAME_LABEL:"Nickname",EDIT_PROFILE__NICKNAME_PLACEHOLDER:"Enter your nickname",EDIT_PROFILE__USERID_LABEL:"User ID",EDIT_PROFILE__THEME_LABEL:"Dark theme",MESSAGE_INPUT__PLACE_HOLDER:"Enter message",MESSAGE_INPUT__PLACE_HOLDER__DISABLED:"Chat is unavailable in this channel",MESSAGE_INPUT__PLACE_HOLDER__SUGGESTED_REPLIES:"Please choose one from above",MESSAGE_INPUT__PLACE_HOLDER__MESSAGE_FORM:"Please fill out the message form.",MESSAGE_INPUT__PLACE_HOLDER__FROZEN:"Chat is unavailable in this channel",MESSAGE_INPUT__PLACE_HOLDER__MUTED:"Chat is unavailable because you're muted",MESSAGE_INPUT__PLACE_HOLDER__MUTED_SHORT:"You're muted",MESSAGE_INPUT__QUOTE_REPLY__PLACE_HOLDER:"Reply to message",BUTTON__SUBMIT:"Submit",BUTTON__CANCEL:"Cancel",BUTTON__DELETE:"Delete",BUTTON__SAVE:"Save",BUTTON__CREATE:"Create",BUTTON__INVITE:"Invite",BUTTON__OK:"OK",BADGE__OVER:"+",NO_TITLE:"No title",NO_NAME:"(No name)",NO_MEMBERS:"(No members)",LABEL__OPERATOR:"Operator",MESSAGE_MENU__COPY:"Copy",MESSAGE_MENU__REPLY:"Reply",MESSAGE_MENU__THREAD:"Reply in thread",MESSAGE_MENU__OPEN_IN_CHANNEL:"Open in channel",MESSAGE_MENU__EDIT:"Edit",MESSAGE_MENU__RESEND:"Resend",MESSAGE_MENU__DELETE:"Delete",MESSAGE_MENU__SAVE:"Save",CONTEXT_MENU_DROPDOWN__COPY:"Copy",CONTEXT_MENU_DROPDOWN__EDIT:"Edit",CONTEXT_MENU_DROPDOWN__RESEND:"Resend",CONTEXT_MENU_DROPDOWN__DELETE:"Delete",CONTEXT_MENU_DROPDOWN__SAVE:"Save",SEARCH:"Search",SEARCH_IN_CHANNEL:"Search in channel",SEARCH_IN:"Search in",SEARCHING:"Searching for messages...",NO_SEARCHED_MESSAGE:"No results found.",QUOTE_MESSAGE_INPUT__REPLY_TO:"Reply to",QUOTE_MESSAGE_INPUT__FILE_TYPE_IMAGE:"Photo",QUOTE_MESSAGE_INPUT__FILE_TYPE_GIF:"GIF",QUOTE_MESSAGE_INPUT__FILE_TYPE__VIDEO:"Video",QUOTED_MESSAGE__REPLIED_TO:"replied to",QUOTED_MESSAGE__CURRENT_USER:"You",QUOTED_MESSAGE__UNAVAILABLE:"Message unavailable",THREAD__HEADER_TITLE:"Thread",CHANNEL__THREAD_REPLY:"reply",CHANNEL__THREAD_REPLIES:"replies",CHANNEL__THREAD_OVER_MAX:"99+",THREAD__THREAD_REPLY:"reply",THREAD__THREAD_REPLIES:"replies",THREAD__INPUT__REPLY_TO_THREAD:"Reply to thread",THREAD__INPUT__REPLY_IN_THREAD:"Reply in thread",MENTION_NAME__NO_NAME:"(No name)",MENTION_COUNT__OVER_LIMIT:"You can mention up to %d times at a time.",UI__FILE_VIEWER__UNSUPPORT:"Unsupported message",VOICE_RECORDING_PERMISSION_DENIED:`You cannot record the voice since
        voice recording is not permitted in your device system setting`,VOICE_MESSAGE:"Voice Message",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GIF:"GIF",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO:"Photo",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VIDEO:"Video",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_AUDIO:"Audio",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VOICE_MESSAGE:"Voice message",CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GENERAL:"File",CHANNEL_PREVIEW_LAST_MESSAGE_TEMPLATE_MESSAGE:"Message",DATE_FORMAT__MESSAGE_LIST__NOTIFICATION__UNREAD_SINCE:"p 'on' MMM dd",DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR:"MMMM dd, yyyy",DATE_FORMAT__THREAD_LIST__DATE_SEPARATOR:"MMM dd, yyyy",DATE_FORMAT__MESSAGE_CREATED_AT:"p",DATE_FORMAT__UNREAD_SINCE:"p MMM dd",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__TODAY:"p",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__THIS_YEAR:"MMM d",DATE_FORMAT__LAST_MESSAGE_CREATED_AT__PREVIOUS_YEAR:"yyyy/M/d",FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT:"Up to %d files can be attached.",FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT:"The maximum size per file is %d MB.",FEEDBACK_LIKE:"Like",FEEDBACK_DISLIKE:"Dislike",EDIT_COMMENT:"Edit comment",REMOVE_FEEDBACK:"Remove Feedback",FEEDBACK_MODAL_TITLE:"Provide additional feedback (optional)",FEEDBACK_CONTENT_PLACEHOLDER:"Leave a comment",BUTTON__REMOVE_FEEDBACK:"Remove feedback",FEEDBACK_FAILED_SUBMIT:"Couldn’t submit. Try again.",FEEDBACK_FAILED_SAVE:"Couldn’t save. Try again.",FEEDBACK_FAILED_DELETE:"Couldn’t delete. Try again.",FORM_ITEM_REQUIRED:"This field is required",FORM_ITEM_INVALID:"Please check the value",FORM_ITEM_OPTIONAL_EMPTY:"No Response"}},Yp=function(n){return LO[n]},UO={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},kO=function(t,e,r){var i,a=UO[t];return typeof a=="string"?i=a:e===1?i=a.one:i=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function Qc(n){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.width?String(t.width):n.defaultWidth,r=n.formats[e]||n.formats[n.defaultWidth];return r}}var xO={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},PO={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},FO={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},HO={date:Qc({formats:xO,defaultWidth:"full"}),time:Qc({formats:PO,defaultWidth:"full"}),dateTime:Qc({formats:FO,defaultWidth:"full"})},BO={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},GO=function(t,e,r,i){return BO[t]};function ju(n){return function(t,e){var r=e!=null&&e.context?String(e.context):"standalone",i;if(r==="formatting"&&n.formattingValues){var a=n.defaultFormattingWidth||n.defaultWidth,s=e!=null&&e.width?String(e.width):a;i=n.formattingValues[s]||n.formattingValues[a]}else{var u=n.defaultWidth,o=e!=null&&e.width?String(e.width):n.defaultWidth;i=n.values[o]||n.values[u]}var l=n.argumentCallback?n.argumentCallback(t):t;return i[l]}}var VO={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},jO={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},qO={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},zO={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},KO={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},$O={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},WO=function(t,e){var r=Number(t),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},YO={ordinalNumber:WO,era:ju({values:VO,defaultWidth:"wide"}),quarter:ju({values:jO,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:ju({values:qO,defaultWidth:"wide"}),day:ju({values:zO,defaultWidth:"wide"}),dayPeriod:ju({values:KO,defaultWidth:"wide",formattingValues:$O,defaultFormattingWidth:"wide"})};function qu(n){return function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.width,i=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],a=t.match(i);if(!a)return null;var s=a[0],u=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],o=Array.isArray(u)?XO(u,function(c){return c.test(s)}):QO(u,function(c){return c.test(s)}),l;l=n.valueCallback?n.valueCallback(o):o,l=e.valueCallback?e.valueCallback(l):l;var d=t.slice(s.length);return{value:l,rest:d}}}function QO(n,t){for(var e in n)if(n.hasOwnProperty(e)&&t(n[e]))return e}function XO(n,t){for(var e=0;e<n.length;e++)if(t(n[e]))return e}function ZO(n){return function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.match(n.matchPattern);if(!r)return null;var i=r[0],a=t.match(n.parsePattern);if(!a)return null;var s=n.valueCallback?n.valueCallback(a[0]):a[0];s=e.valueCallback?e.valueCallback(s):s;var u=t.slice(i.length);return{value:s,rest:u}}}var JO=/^(\d+)(th|st|nd|rd)?/i,e3=/\d+/i,n3={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},t3={any:[/^b/i,/^(a|c)/i]},r3={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},i3={any:[/1/i,/2/i,/3/i,/4/i]},a3={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},s3={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},u3={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},o3={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},l3={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},d3={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},c3={ordinalNumber:ZO({matchPattern:JO,parsePattern:e3,valueCallback:function(t){return parseInt(t,10)}}),era:qu({matchPatterns:n3,defaultMatchWidth:"wide",parsePatterns:t3,defaultParseWidth:"any"}),quarter:qu({matchPatterns:r3,defaultMatchWidth:"wide",parsePatterns:i3,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:qu({matchPatterns:a3,defaultMatchWidth:"wide",parsePatterns:s3,defaultParseWidth:"any"}),day:qu({matchPatterns:u3,defaultMatchWidth:"wide",parsePatterns:o3,defaultParseWidth:"any"}),dayPeriod:qu({matchPatterns:l3,defaultMatchWidth:"any",parsePatterns:d3,defaultParseWidth:"any"})},kC={code:"en-US",formatDistance:kO,formatLong:HO,formatRelative:GO,localize:YO,match:c3,options:{weekStartsOn:0,firstWeekContainsDate:1}},xC={stringSet:Yp("en"),dateLocale:kC},wt=p.createContext(xC),f3=function(n){var t=n.children;return p.createElement(wt.Provider,{value:G(G({},xC),n)},t)},$n=function(){var n=p.useContext(wt);if(!n)throw new Error("`useLocalization` hook must be used within `SendbirdProvider` that includes `LocalizationProvider`.");return n},h3=!1,PC="sendbird--mobile-mode",FC=p.createContext({breakpoint:h3,isMobile:!1}),Cg=function(){try{var n=document.querySelector("body");n==null||n.classList.add(PC)}catch{}},Sg=function(){try{var n=document.querySelector("body");n==null||n.classList.remove(PC)}catch{}},p3=function(n){var t=n.children,e=n.logger,r=(n==null?void 0:n.breakpoint)||!1,i=N.useState(!1),a=i[0],s=i[1];return N.useEffect(function(){var u,o=function(){var l;if(typeof r=="boolean")s(r),r?Cg():Sg();else{var d=window.matchMedia("(max-width: ".concat(r,")"));(l=e==null?void 0:e.info)===null||l===void 0||l.call(e,"MediaQueryProvider: Screensize updated to ".concat(r)),d.matches?(s(!0),Cg()):(s(!1),Sg())}};return o(),window.addEventListener("resize",o),(u=e==null?void 0:e.info)===null||u===void 0||u.call(e,"MediaQueryProvider: addEventListener",{updateSize:o}),function(){var l;window.removeEventListener("resize",o),(l=e==null?void 0:e.info)===null||l===void 0||l.call(e,"MediaQueryProvider: removeEventListener",{updateSize:o})}},[r]),p.createElement(FC.Provider,{value:{breakpoint:r,isMobile:a}},t)},Nr=function(){return p.useContext(FC)},va=p.forwardRef(function(n,t){var e=n.className,r=e===void 0?"":e,i=n.children,a=n.disabled,s=a===void 0?!1:a,u=n.width,o=u===void 0?"56px":u,l=n.height,d=l===void 0?"56px":l,c=n.type,f=c===void 0?"button":c,h=n.style,m=h===void 0?{}:h,_=n.onBlur,E=_===void 0?function(){}:_,b=n.onClick,g=b===void 0?function(){}:b,C=n.testID,S=N.useState(!1),A=S[0],I=S[1];return p.createElement("button",{"data-testid":C,className:Ce(Ce([],Array.isArray(r)?r:[r],!0),["sendbird-iconbutton",A?"sendbird-iconbutton--pressed":""],!1).join(" "),disabled:s,ref:t,type:f,style:G(G({},m),{height:d,width:o}),onClick:function(T){s||(I(!0),g==null||g(T))},onBlur:function(T){I(!1),E==null||E(T)}},p.createElement("span",{className:"sendbird-iconbutton__inner"},i))}),Wr={H_1:"H_1",H_2:"H_2",SUBTITLE_1:"SUBTITLE_1",SUBTITLE_2:"SUBTITLE_2",BODY_1:"BODY_1",BODY_2:"BODY_2",BUTTON_1:"BUTTON_1",BUTTON_2:"BUTTON_2",BUTTON_3:"BUTTON_3",CAPTION_1:"CAPTION_1",CAPTION_2:"CAPTION_2",CAPTION_3:"CAPTION_3"},Yr={ONBACKGROUND_1:"ONBACKGROUND_1",ONBACKGROUND_2:"ONBACKGROUND_2",ONBACKGROUND_3:"ONBACKGROUND_3",ONBACKGROUND_4:"ONBACKGROUND_4",ONCONTENT_1:"ONCONTENT_1",ONCONTENT_2:"ONCONTENT_2",ONCONTENT_3:"ONCONTENT_3",ONCONTENT_INVERSE_1:"ONCONTENT_INVERSE_1",ONCONTENT_INVERSE_3:"ONCONTENT_INVERSE_3",PRIMARY:"PRIMARY",ERROR:"ERROR",SECONDARY_3:"SECONDARY_3"};function m3(n){switch(n){case Wr.H_1:return"sendbird-label--h-1";case Wr.H_2:return"sendbird-label--h-2";case Wr.SUBTITLE_1:return"sendbird-label--subtitle-1";case Wr.SUBTITLE_2:return"sendbird-label--subtitle-2";case Wr.BODY_1:return"sendbird-label--body-1";case Wr.BODY_2:return"sendbird-label--body-2";case Wr.BUTTON_1:return"sendbird-label--button-1";case Wr.BUTTON_2:return"sendbird-label--button-2";case Wr.BUTTON_3:return"sendbird-label--button-3";case Wr.CAPTION_1:return"sendbird-label--caption-1";case Wr.CAPTION_2:return"sendbird-label--caption-2";case Wr.CAPTION_3:return"sendbird-label--caption-3";default:return""}}function HC(n){switch(n){case Yr.ONBACKGROUND_1:return"sendbird-label--color-onbackground-1";case Yr.ONBACKGROUND_2:return"sendbird-label--color-onbackground-2";case Yr.ONBACKGROUND_3:return"sendbird-label--color-onbackground-3";case Yr.ONBACKGROUND_4:return"sendbird-label--color-onbackground-4";case Yr.ONCONTENT_1:return"sendbird-label--color-oncontent-1";case Yr.ONCONTENT_2:return"sendbird-label--color-oncontent-2";case Yr.ONCONTENT_3:return"sendbird-label--color-oncontent-3";case Yr.ONCONTENT_INVERSE_1:return"sendbird-label--color-oncontent-inverse-1";case Yr.ONCONTENT_INVERSE_3:return"sendbird-label--color-oncontent-inverse-3";case Yr.PRIMARY:return"sendbird-label--color-primary";case Yr.ERROR:return"sendbird-label--color-error";case Yr.SECONDARY_3:return"sendbird-label--color-secondary-3";default:return""}}var me=N.forwardRef(function(n,t){var e=n.className,r=e===void 0?[]:e,i=n.type,a=n.color,s=n.children,u=s===void 0?null:s,o=n.testID;return p.createElement("span",{className:Ce(Ce([],Array.isArray(r)?r:[r],!0),["sendbird-label",m3(i),HC(a)],!1).join(" "),ref:t,"data-testid":o},u)}),he=Wr,re=Yr,$s=Yp("en"),kt;(function(n){n.PRIMARY="PRIMARY",n.SECONDARY="SECONDARY",n.DANGER="DANGER",n.DISABLED="DISABLED",n.WARNING="WARNING"})(kt||(kt={}));var ns;(function(n){n.BIG="BIG",n.SMALL="SMALL"})(ns||(ns={}));function _3(n){switch(n){case kt.PRIMARY:return"sendbird-button--primary";case kt.SECONDARY:return"sendbird-button--secondary";case kt.DANGER:return"sendbird-button--danger";case kt.DISABLED:return"sendbird-button--disabled";case kt.WARNING:return"sendbird-button--warning";default:return""}}function g3(n){switch(n){case ns.BIG:return"sendbird-button--big";case ns.SMALL:return"sendbird-button--small";default:return""}}function Ri(n){var t=n.className,e=n.type,r=e===void 0?kt.PRIMARY:e,i=n.size,a=i===void 0?ns.BIG:i,s=n.children,u=s===void 0?"Button":s,o=n.disabled,l=o===void 0?!1:o,d=n.onClick,c=d===void 0?function(){}:d,f=n.labelType,h=f===void 0?he.BUTTON_1:f,m=n.labelColor,_=m===void 0?re.ONCONTENT_1:m,E=Ce(Ce([],Array.isArray(t)?t:[t],!0),["sendbird-button",l?"sendbird-button__disabled":"",_3(r),g3(a)],!1).join(" ");return p.createElement("button",{className:E,type:"button",onClick:c,disabled:l},p.createElement(me,{className:"sendbird-button__text",type:h,color:_},u))}var de={ADD:"ADD",ARROW_LEFT:"ARROW_LEFT",ATTACH:"ATTACH",AUDIO_ON_LINED:"AUDIO_ON_LINED",BAN:"BAN",BROADCAST:"BROADCAST",CAMERA:"CAMERA",CHANNELS:"CHANNELS",CHAT:"CHAT",CHAT_FILLED:"CHAT_FILLED",CHEVRON_DOWN:"CHEVRON_DOWN",CHEVRON_RIGHT:"CHEVRON_RIGHT",CLOSE:"CLOSE",COLLAPSE:"COLLAPSE",COPY:"COPY",CREATE:"CREATE",DELETE:"DELETE",DISCONNECTED:"DISCONNECTED",DOCUMENT:"DOCUMENT",DONE:"DONE",DONE_ALL:"DONE_ALL",DOWNLOAD:"DOWNLOAD",EDIT:"EDIT",EMOJI_MORE:"EMOJI_MORE",ERROR:"ERROR",EXPAND:"EXPAND",FILE_AUDIO:"FILE_AUDIO",FILE_DOCUMENT:"FILE_DOCUMENT",FREEZE:"FREEZE",GIF:"GIF",INFO:"INFO",LEAVE:"LEAVE",MEMBERS:"MEMBERS",MESSAGE:"MESSAGE",MODERATIONS:"MODERATIONS",MORE:"MORE",MUTE:"MUTE",NOTIFICATIONS:"NOTIFICATIONS",NOTIFICATIONS_OFF_FILLED:"NOTIFICATIONS_OFF_FILLED",OPERATOR:"OPERATOR",PHOTO:"PHOTO",PLAY:"PLAY",PLUS:"PLUS",QUESTION:"QUESTION",REFRESH:"REFRESH",REPLY:"REPLY",REMOVE:"REMOVE",SEARCH:"SEARCH",SEND:"SEND",SETTINGS_FILLED:"SETTINGS_FILLED",SLIDE_LEFT:"SLIDE_LEFT",SPINNER:"SPINNER",SUPERGROUP:"SUPERGROUP",THREAD:"THREAD",THUMBNAIL_NONE:"THUMBNAIL_NONE",TOGGLE_OFF:"TOGGLE_OFF",TOGGLE_ON:"TOGGLE_ON",USER:"USER",FEEDBACK_LIKE:"FEEDBACK_LIKE",FEEDBACK_DISLIKE:"FEEDBACK_DISLIKE"},er={DEFAULT:"DEFAULT",PRIMARY:"PRIMARY",PRIMARY_2:"PRIMARY_2",SECONDARY:"SECONDARY",SECONDARY_2:"SECONDARY_2",CONTENT:"CONTENT",CONTENT_INVERSE:"CONTENT_INVERSE",CONTENT_INVERSE_3:"CONTENT_INVERSE_3",WHITE:"WHITE",GRAY:"GRAY",THUMBNAIL_ICON:"THUMBNAIL_ICON",SENT:"SENT",READ:"READ",ON_BACKGROUND_1:"ON_BACKGROUND_1",ON_BACKGROUND_2:"ON_BACKGROUND_2",ON_BACKGROUND_3:"ON_BACKGROUND_3",ON_BACKGROUND_4:"ON_BACKGROUND_4",BACKGROUND_3:"BACKGROUND_3",ERROR:"ERROR"};function E3(n){switch(n){case er.PRIMARY:return"sendbird-icon-color--primary";case er.PRIMARY_2:return"sendbird-icon-color--primary-2";case er.SECONDARY:return"sendbird-icon-color--secondary";case er.SECONDARY_2:return"sendbird-icon-color--secondary-2";case er.CONTENT:return"sendbird-icon-color--content";case er.CONTENT_INVERSE:return"sendbird-icon-color--content-inverse";case er.CONTENT_INVERSE_3:return"sendbird-icon-color--content-inverse-3";case er.WHITE:return"sendbird-icon-color--white";case er.GRAY:return"sendbird-icon-color--gray";case er.THUMBNAIL_ICON:return"sendbird-icon-color--thumbnail-icon";case er.SENT:return"sendbird-icon-color--sent";case er.READ:return"sendbird-icon-color--read";case er.ON_BACKGROUND_1:return"sendbird-icon-color--on-background-1";case er.ON_BACKGROUND_2:return"sendbird-icon-color--on-background-2";case er.ON_BACKGROUND_3:return"sendbird-icon-color--on-background-3";case er.ON_BACKGROUND_4:return"sendbird-icon-color--on-background-4";case er.BACKGROUND_3:return"sendbird-icon-color--background-3";case er.ERROR:return"sendbird-icon-color--error";default:return""}}function v3(n){switch(n){case de.ADD:return"sendbird-icon-add";case de.ARROW_LEFT:return"sendbird-icon-arrow-left";case de.ATTACH:return"sendbird-icon-attach";case de.AUDIO_ON_LINED:return"sendbird-icon-audio-on-lined";case de.BAN:return"sendbird-icon-ban";case de.BROADCAST:return"sendbird-icon-broadcast";case de.CAMERA:return"sendbird-icon-camera";case de.CHANNELS:return"sendbird-icon-channels";case de.CHAT:return"sendbird-icon-chat";case de.CHAT_FILLED:return"sendbird-icon-chat-filled";case de.CHEVRON_DOWN:return"sendbird-icon-chevron-down";case de.CHEVRON_RIGHT:return"sendbird-icon-chevron-right";case de.CLOSE:return"sendbird-icon-close";case de.COLLAPSE:return"sendbird-icon-collapse";case de.COPY:return"sendbird-icon-copy";case de.CREATE:return"sendbird-icon-create";case de.DELETE:return"sendbird-icon-delete";case de.DISCONNECTED:return"sendbird-icon-disconnected";case de.DOCUMENT:return"sendbird-icon-document";case de.DONE:return"sendbird-icon-done";case de.DONE_ALL:return"sendbird-icon-done-all";case de.DOWNLOAD:return"sendbird-icon-down-load";case de.EDIT:return"sendbird-icon-edit";case de.EMOJI_MORE:return"sendbird-icon-emoji-more";case de.ERROR:return"sendbird-icon-error";case de.EXPAND:return"sendbird-icon-expand";case de.FILE_AUDIO:return"sendbird-icon-file-audio";case de.FILE_DOCUMENT:return"sendbird-icon-file-document";case de.FREEZE:return"sendbird-icon-freeze";case de.GIF:return"sendbird-icon-gif";case de.INFO:return"sendbird-icon-info";case de.LEAVE:return"sendbird-icon-leave";case de.MEMBERS:return"sendbird-icon-members";case de.MESSAGE:return"sendbird-icon-message";case de.MODERATIONS:return"sendbird-icon-moderations";case de.MORE:return"sendbird-icon-more";case de.MUTE:return"sendbird-icon-mute";case de.NOTIFICATIONS:return"sendbird-icon-notifications";case de.NOTIFICATIONS_OFF_FILLED:return"sendbird-icon-notifications-off-filled";case de.OPERATOR:return"sendbird-icon-operator";case de.PHOTO:return"sendbird-icon-photo";case de.PLAY:return"sendbird-icon-play";case de.PLUS:return"sendbird-iconn-plus";case de.QUESTION:return"sendbird-icon-question";case de.REFRESH:return"sendbird-icon-refresh";case de.REMOVE:return"sendbird-icon-remove";case de.REPLY:return"sendbird-icon-reply";case de.SEARCH:return"sendbird-icon-search";case de.SEND:return"sendbird-icon-send";case de.SETTINGS_FILLED:return"sendbird-icon-settings-filled";case de.SPINNER:return"sendbird-icon-spinner";case de.SUPERGROUP:return"sendbird-icon-supergroup";case de.THREAD:return"sendbird-icon-thread";case de.THUMBNAIL_NONE:return"sendbird-icon-thumbnail-none";case de.TOGGLE_OFF:return"sendbird-icon-toggle-off";case de.TOGGLE_ON:return"sendbird-icon-toggle-on";case de.USER:return"sendbird-icon-user";case de.FEEDBACK_LIKE:return"sendbird-icon-feedback-like";case de.FEEDBACK_DISLIKE:return"sendbird-icon-feedback-dislike";default:return"sendbird-icon-unknown"}}var Tg;function Jf(){return Jf=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Jf.apply(null,arguments)}const y3=n=>N.createElement("svg",Jf({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Tg||(Tg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M50.667 5.333a8 8 0 0 1 8 8v37.334a8 8 0 0 1-8 8H13.333a8 8 0 0 1-8-8V13.333a8 8 0 0 1 8-8zm0 5.334H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334a2.667 2.667 0 0 0 2.666 2.666h37.334a2.667 2.667 0 0 0 2.666-2.666V13.333a2.667 2.667 0 0 0-2.666-2.666m-18.667 8a2.667 2.667 0 0 1 2.649 2.355l.018.311v8h8a2.667 2.667 0 0 1 .311 5.316l-.311.018h-8v8a2.667 2.667 0 0 1-5.316.311l-.018-.311v-8h-8a2.667 2.667 0 0 1-.311-5.316l.311-.018h8v-8A2.667 2.667 0 0 1 32 18.667",className:"icon-add_svg__fill"})));var Ng;function eh(){return eh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},eh.apply(null,arguments)}const b3=n=>N.createElement("svg",eh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Ng||(Ng=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M33.886 8.781a2.67 2.67 0 0 1 .221 3.52l-.221.251-16.78 16.781H56a2.667 2.667 0 0 1 .311 5.316l-.311.018-38.895-.001 16.78 16.782a2.666 2.666 0 0 1 .222 3.52l-.221.251a2.67 2.67 0 0 1-3.52.222l-.252-.222L8.781 33.886a2.67 2.67 0 0 1-.222-3.52l.222-.252L30.114 8.781a2.67 2.67 0 0 1 3.772 0",className:"icon-arrow-left_svg__fill"})));var Ig;function nh(){return nh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},nh.apply(null,arguments)}const C3=n=>N.createElement("svg",nh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Ig||(Ig=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m55.334 28.926-24.506 23.34c-5.222 4.973-13.74 4.973-18.962 0-5.149-4.903-5.149-12.797 0-17.7l24.506-23.34c3.138-2.988 8.278-2.988 11.416 0 3.064 2.919 3.064 7.594 0 10.513L23.255 45.077c-1.055 1.005-2.815 1.005-3.87.001-.98-.933-.98-2.39 0-3.325l22.64-21.535a2.667 2.667 0 0 0-3.676-3.864L15.709 37.89a7.58 7.58 0 0 0-.001 11.05c3.113 2.966 8.11 2.966 11.224 0l24.533-23.338c5.272-5.021 5.272-13.217 0-18.238-5.197-4.95-13.573-4.95-18.77 0L8.187 30.704c-7.356 7.005-7.356 18.419 0 25.424 7.281 6.935 19.036 6.935 26.318 0l24.506-23.34a2.666 2.666 0 1 0-3.678-3.862z",className:"icon-attach_svg__fill"})));var Ag,Mg;function th(){return th=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},th.apply(null,arguments)}const S3=n=>N.createElement("svg",th({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 64 64"},n),Ag||(Ag=N.createElement("g",{clipPath:"url(#icon-audio-on-lined_svg__a)"},N.createElement("path",{d:"M32 0C26.11 0 21.333 4.776 21.333 10.667V32c0 5.891 4.776 10.667 10.667 10.667S42.667 37.89 42.667 32V10.667C42.667 4.776 37.89 0 32 0m-5.333 10.667a5.333 5.333 0 0 1 10.666 0V32a5.333 5.333 0 0 1-10.666 0z",className:"icon-audio-on-lined_svg__fill",clipRule:"evenodd"}),N.createElement("path",{d:"M16 26.667a2.667 2.667 0 1 0-5.333 0V32c0 10.879 8.143 19.856 18.666 21.168v5.499h-8a2.667 2.667 0 0 0 0 5.333h21.334a2.667 2.667 0 1 0 0-5.333h-8v-5.499C45.19 51.856 53.333 42.88 53.333 32v-5.333a2.667 2.667 0 1 0-5.333 0V32c0 8.837-7.163 16-16 16s-16-7.163-16-16z",className:"icon-audio-on-lined_svg__fill"}))),Mg||(Mg=N.createElement("defs",null,N.createElement("clipPath",{id:"icon-audio-on-lined_svg__a"},N.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"})))));var wg;function rh(){return rh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},rh.apply(null,arguments)}const T3=n=>N.createElement("svg",rh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),wg||(wg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8m12.333 21.333a1 1 0 0 1 1 1v3.334a1 1 0 0 1-1 1H19.667a1 1 0 0 1-1-1v-3.334a1 1 0 0 1 1-1z",className:"icon-ban_svg__fill"})));var Og;function ih(){return ih=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ih.apply(null,arguments)}const N3=n=>N.createElement("svg",ih({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Og||(Og=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M58.545 5.498q.121.389.122.796v46.079a2.666 2.666 0 0 1-3.462 2.546l-17.951-5.61c-.645 5.273-5.14 9.358-10.587 9.358C20.776 58.667 16 53.89 16 48v-5.334h-5.333a8 8 0 0 1-7.997-7.75l-.003-.25V24a8 8 0 0 1 8-8H16L55.205 3.749a2.665 2.665 0 0 1 3.34 1.75zM21.333 44.587V48a5.333 5.333 0 0 0 10.652.398L32 47.92zm32-34.667-32 9.997v18.83l32 9.997zM16 21.333h-5.333a2.67 2.67 0 0 0-2.65 2.356L8 24v10.667a2.667 2.667 0 0 0 2.667 2.666H16z",className:"icon-broadcast_svg__fill"})));var Rg;function ah(){return ah=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ah.apply(null,arguments)}const I3=n=>N.createElement("svg",ah({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Rg||(Rg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M40 5.333c.892 0 1.724.446 2.219 1.188l4.541 6.812H56a8 8 0 0 1 7.986 7.53l.014.47v29.334a8 8 0 0 1-8 8H8a8 8 0 0 1-8-8V21.333a8 8 0 0 1 8-8h9.237l4.544-6.812a2.67 2.67 0 0 1 1.888-1.167l.331-.02zm-1.43 5.334H25.428l-4.542 6.812a2.66 2.66 0 0 1-1.887 1.167l-.331.02H8a2.67 2.67 0 0 0-2.667 2.667v29.334A2.667 2.667 0 0 0 8 53.333h48a2.667 2.667 0 0 0 2.667-2.666V21.333A2.667 2.667 0 0 0 56 18.667H45.333a2.67 2.67 0 0 1-2.218-1.188zM32 21.333c7.364 0 13.333 5.97 13.333 13.334S39.363 48 32 48s-13.333-5.97-13.333-13.333S24.637 21.333 32 21.333m0 5.334a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-camera_svg__fill"})));var Dg;function sh(){return sh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},sh.apply(null,arguments)}const A3=n=>N.createElement("svg",sh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Dg||(Dg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m42.65 5.333.311.017a2.666 2.666 0 0 1 2.373 2.633l-.017.311-1.45 13.04h9.466a2.667 2.667 0 0 1 .311 5.315l-.31.018H43.271l-1.184 10.666h11.245a2.667 2.667 0 0 1 .312 5.316l-.31.018H41.495l-1.512 13.627a2.667 2.667 0 0 1-5.318-.277l.017-.311 1.448-13.04H25.496l-1.512 13.628a2.667 2.667 0 0 1-5.318-.277l.017-.311 1.448-13.04h-9.464a2.667 2.667 0 0 1-.311-5.315l.31-.018h10.057l1.186-10.667H10.667a2.667 2.667 0 0 1-.311-5.315l.31-.018h11.835l1.515-13.627a2.67 2.67 0 0 1 2.634-2.373l.311.017a2.666 2.666 0 0 1 2.373 2.633l-.017.311-1.45 13.04H38.5l1.515-13.628a2.67 2.67 0 0 1 2.634-2.373zm-5.927 32 1.186-10.667H27.272l-1.184 10.667z",className:"icon-channels_svg__fill"})));var Lg;function uh(){return uh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},uh.apply(null,arguments)}const M3=n=>N.createElement("svg",uh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Lg||(Lg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8",className:"icon-chat_svg__fill"})));var Ug;function oh(){return oh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},oh.apply(null,arguments)}const w3=n=>N.createElement("svg",oh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Ug||(Ug=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667",className:"icon-chat-filled_svg__fill"})));var kg;function lh(){return lh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},lh.apply(null,arguments)}const O3=n=>N.createElement("svg",lh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),kg||(kg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16.121 21.879a3 3 0 0 0-4.242 0 3 3 0 0 0 0 4.242l18 18a3 3 0 0 0 4.242 0l18-18a3 3 0 0 0 0-4.242 3 3 0 0 0-4.242 0L32 37.757z",className:"icon-chevron-down_svg__fill"})));var xg;function dh(){return dh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},dh.apply(null,arguments)}const R3=n=>N.createElement("svg",dh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),xg||(xg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M22.114 46.114a2.668 2.668 0 0 0 3.772 3.772l16-16a2.67 2.67 0 0 0 0-3.772l-16-16a2.668 2.668 0 0 0-3.772 3.772L36.23 32z",className:"icon-chevron-right_svg__fill"})));var Pg;function ch(){return ch=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ch.apply(null,arguments)}const D3=n=>N.createElement("svg",ch({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Pg||(Pg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M52.552 11.448a2.666 2.666 0 0 1 .222 3.52l-.222.251-16.781 16.78 16.781 16.782a2.665 2.665 0 0 1 0 3.771 2.666 2.666 0 0 1-3.52.222l-.251-.222L32 35.771 15.219 52.552a2.665 2.665 0 0 1-3.771 0 2.666 2.666 0 0 1-.222-3.52l.222-.251L28.228 32l-16.78-16.781a2.665 2.665 0 0 1 0-3.771 2.666 2.666 0 0 1 3.52-.222l.251.222 16.78 16.78 16.782-16.78a2.665 2.665 0 0 1 3.771 0",className:"icon-close_svg__fill"})));var Fg;function fh(){return fh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},fh.apply(null,arguments)}const L3=n=>N.createElement("svg",fh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Fg||(Fg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16 8a2.667 2.667 0 0 0-2.649 2.356l-.018.31v42.667a2.667 2.667 0 0 0 5.316.311l.018-.31V34.666h25.56l-6.113 6.114a2.67 2.67 0 0 0-.221 3.52l.221.251a2.666 2.666 0 0 0 3.52.222l.252-.222 10.666-10.666a2.666 2.666 0 0 0 .222-3.52l-.222-.252-10.666-10.666a2.666 2.666 0 0 0-3.993 3.52l.221.251 6.113 6.114h-25.56V10.667A2.667 2.667 0 0 0 16 8",className:"icon-collapse_svg__fill"})));var Hg;function hh(){return hh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},hh.apply(null,arguments)}const U3=n=>N.createElement("svg",hh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Hg||(Hg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M53.333 21.333a8 8 0 0 1 8 8v24a8 8 0 0 1-8 8h-24a8 8 0 0 1-8-8v-24a8 8 0 0 1 8-8zm0 5.334h-24a2.667 2.667 0 0 0-2.666 2.666v24A2.667 2.667 0 0 0 29.333 56h24A2.667 2.667 0 0 0 56 53.333v-24a2.667 2.667 0 0 0-2.667-2.666m-18.666-24a8 8 0 0 1 7.986 7.53l.014.47v2.666a2.667 2.667 0 0 1-5.316.311l-.018-.31v-2.667a2.67 2.67 0 0 0-2.355-2.65L34.667 8h-24a2.67 2.67 0 0 0-2.65 2.356l-.017.31v24a2.67 2.67 0 0 0 2.356 2.65l.31.017h2.667a2.667 2.667 0 0 1 .311 5.316l-.31.018h-2.667a8 8 0 0 1-7.987-7.53l-.013-.47v-24c0-4.26 3.33-7.743 7.53-7.987l.47-.013z",className:"icon-copy_svg__fill"})));var Bg;function ph(){return ph=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ph.apply(null,arguments)}const k3=n=>N.createElement("svg",ph({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Bg||(Bg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8m2.667 16v5.333H40c3.556 0 3.556 5.334 0 5.334h-5.333V40c0 3.556-5.334 3.556-5.334 0v-5.333H24c-3.556 0-3.556-5.334 0-5.334h5.333V24c0-3.556 5.334-3.556 5.334 0",className:"icon-create_svg__fill"})));var Gg;function mh(){return mh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},mh.apply(null,arguments)}const x3=n=>N.createElement("svg",mh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Gg||(Gg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M37.333 2.667c4.26 0 7.743 3.33 7.987 7.53l.013.47v2.666H56a2.667 2.667 0 0 1 .311 5.316l-.311.018h-2.668l.001 34.666c0 4.26-3.33 7.743-7.53 7.987l-.47.013H18.667a8 8 0 0 1-7.987-7.53l-.013-.47V18.667H8a2.667 2.667 0 0 1-.311-5.316L8 13.333h10.666v-2.666a8 8 0 0 1 7.53-7.987l.47-.013zm10.666 16H16v34.666a2.67 2.67 0 0 0 2.356 2.65l.31.017h26.667a2.67 2.67 0 0 0 2.65-2.356l.017-.31zm-21.332 8a2.667 2.667 0 0 1 2.648 2.355l.018.311v16a2.667 2.667 0 0 1-5.316.311l-.017-.31v-16a2.667 2.667 0 0 1 2.667-2.667m10.666 0a2.67 2.67 0 0 1 2.65 2.355l.017.311v16a2.667 2.667 0 0 1-5.315.311l-.018-.31v-16a2.667 2.667 0 0 1 2.666-2.667m0-18.667H26.667a2.67 2.67 0 0 0-2.65 2.356l-.017.31v2.667h16v-2.666a2.67 2.67 0 0 0-2.356-2.65L37.334 8z",className:"icon-delete_svg__fill"})));var Vg;function _h(){return _h=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},_h.apply(null,arguments)}const P3=n=>N.createElement("svg",_h({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Vg||(Vg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m54.534 6.069-.248.217-9.736 9.735-.04.04-9.573 9.573q-.226.178-.405.404L6.286 54.286a2.423 2.423 0 0 0 3.18 3.645l.248-.217 13.374-13.373a2.42 2.42 0 0 0 1.88-.401 12.12 12.12 0 0 1 14.04 0 2.424 2.424 0 1 0 2.808-3.952 16.95 16.95 0 0 0-11.303-3.072l6.743-6.744a24.1 24.1 0 0 1 10.159 5.021 2.424 2.424 0 0 0 3.11-3.719 29 29 0 0 0-9.34-5.23l5.633-5.634a36.2 36.2 0 0 1 9.225 5.934 2.425 2.425 0 0 0 3.211-3.633 41 41 0 0 0-8.796-5.941l7.256-7.256a2.423 2.423 0 0 0-3.18-3.645m-35.04 21.474a29 29 0 0 0-6.032 3.942 2.424 2.424 0 0 0 3.137 3.697 24 24 0 0 1 5.022-3.282 2.425 2.425 0 0 0-2.127-4.357M4.748 22.909a2.424 2.424 0 0 0 3.207 3.636 36.36 36.36 0 0 1 26.978-8.977 2.424 2.424 0 0 0 .389-4.832A41.2 41.2 0 0 0 4.748 22.909",className:"icon-disconnected_svg__fill"})));var jg;function gh(){return gh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},gh.apply(null,arguments)}const F3=n=>N.createElement("svg",gh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),jg||(jg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M37.333 2.667a3 3 0 0 1 .274.014l.085.01.058.008q.07.01.141.026l.029.007q.075.016.146.037l.034.01q.357.107.663.303l.034.022q.053.034.104.072l.057.043q.045.033.085.068.091.075.176.16l-.126-.117q.075.065.143.135L55.21 19.438q.07.07.134.143l.035.04q.04.047.076.096l.04.054.07.1.024.038c.16.253.279.535.347.836l.01.048q.014.064.024.13l.006.048.007.051.004.041q.014.135.014.27v32a8 8 0 0 1-8 8H16a8 8 0 0 1-8-8V10.667a8 8 0 0 1 8-8zM34.666 8H16a2.667 2.667 0 0 0-2.667 2.667v42.666A2.667 2.667 0 0 0 16 56h32a2.667 2.667 0 0 0 2.667-2.667L50.666 24H37.333a2.667 2.667 0 0 1-2.648-2.356l-.018-.31zm12.227 10.667-6.894-6.894.001 6.894z",className:"icon-document_svg__fill"})));var qg;function Eh(){return Eh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Eh.apply(null,arguments)}const H3=n=>N.createElement("svg",Eh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),qg||(qg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M12.552 31.448a2.665 2.665 0 1 0-3.771 3.771l13.333 13.333a2.666 2.666 0 0 0 3.772 0L55.219 19.22a2.667 2.667 0 0 0-3.771-3.771L24 42.895z",className:"icon-done_svg__fill"})));var zg;function vh(){return vh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},vh.apply(null,arguments)}const B3=n=>N.createElement("svg",vh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),zg||(zg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M5.886 31.448 19.219 44.78a2.667 2.667 0 0 1-3.771 3.771L2.114 35.22a2.667 2.667 0 0 1 3.772-3.771zm52.228-16a2.666 2.666 0 1 1 3.772 3.771L32.552 48.552a2.665 2.665 0 0 1-3.771 0L15.448 35.22a2.665 2.665 0 0 1 0-3.771 2.665 2.665 0 0 1 3.771 0l11.448 11.447zm-9.562 0a2.665 2.665 0 0 1 0 3.771L32.556 35.215a2.665 2.665 0 0 1-3.771 0 2.664 2.664 0 0 1 0-3.77L44.78 15.447a2.665 2.665 0 0 1 3.771 0z",className:"icon-done-all_svg__fill"})));var Kg;function yh(){return yh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},yh.apply(null,arguments)}const G3=n=>N.createElement("svg",yh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Kg||(Kg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M56 42.667a2.667 2.667 0 0 1 2.649 2.355l.018.311v8c0 4.26-3.33 7.743-7.53 7.987l-.47.013H13.333a8 8 0 0 1-7.986-7.53l-.014-.47v-8a2.667 2.667 0 0 1 5.316-.311l.018.311v8a2.67 2.67 0 0 0 2.355 2.65l.311.017h37.334a2.667 2.667 0 0 0 2.648-2.356l.018-.31v-8A2.667 2.667 0 0 1 56 42.667m-36.552-8.781a2.666 2.666 0 0 1 3.52-3.993l.251.221 6.114 6.114V5.333a2.667 2.667 0 0 1 5.316-.311l.018.311v30.894l6.114-6.113a2.67 2.67 0 0 1 3.52-.221l.251.221a2.666 2.666 0 0 1 .222 3.52l-.222.252-10.658 10.657a2 2 0 0 1-.135.128l.127-.119a3 3 0 0 1-.195.176l-.056.045-.086.064-.056.04-.086.056-.06.036-.081.046-.079.04a3 3 0 0 1-.14.065l-.09.036q-.034.014-.067.025l-.09.03-.063.019q-.064.018-.13.034l-.013.003-.144.028-.064.01q-.045.008-.092.012l-.084.008-.103.006-.069.002h-.095q-.042 0-.082-.003l.139.003q-.126 0-.249-.011l-.061-.007-.092-.012-.09-.015-.118-.025-.04-.01a3 3 0 0 1-.34-.11l-.015-.006q-.074-.03-.145-.063l-.042-.02L30.71 45l-.067-.039q-.045-.026-.087-.054l-.062-.041q-.045-.03-.088-.063l-.04-.03-.008-.007a3 3 0 0 1-.251-.223z",className:"icon-download_svg__fill"})));var $g;function bh(){return bh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},bh.apply(null,arguments)}const V3=n=>N.createElement("svg",bh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 65 65"},n),$g||($g=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M56 56a2.667 2.667 0 0 1 .311 5.315l-.311.018H8a2.667 2.667 0 0 1-.311-5.316L8 56zM35.448 3.448a2.665 2.665 0 0 1 3.771 0l10.667 10.666a2.67 2.67 0 0 1 0 3.772L20.552 47.219c-.5.5-1.178.781-1.885.781H8a2.667 2.667 0 0 1-2.667-2.667V34.667c0-.708.281-1.386.781-1.886zm1.885 5.659L10.667 35.77v6.896h6.89L44.227 16z",className:"icon-edit_svg__fill"})));var Wg;function Ch(){return Ch=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ch.apply(null,arguments)}const j3=n=>N.createElement("svg",Ch({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Wg||(Wg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32.097 3.22c2.65 0 5.255.357 7.763 1.054a2.134 2.134 0 0 1-1.144 4.111 24.7 24.7 0 0 0-6.619-.899c-13.603 0-24.63 11.027-24.63 24.63s11.027 24.63 24.63 24.63 24.63-11.027 24.63-24.63c0-2.227-.295-4.413-.87-6.518a2.13 2.13 0 0 1 1.494-2.62 2.13 2.13 0 0 1 2.62 1.494 29 29 0 0 1 1.023 7.644c0 15.96-12.938 28.897-28.897 28.897-15.96 0-28.897-12.937-28.897-28.897S16.138 3.22 32.097 3.22m10.705 34.792a2.133 2.133 0 0 1 2.024 2.808c-1.873 5.623-6.937 9.488-12.729 9.488s-10.856-3.865-12.73-9.488a2.134 2.134 0 0 1 1.875-2.803l.15-.005zm-3.477 4.266H24.867l.294.382c1.539 1.887 3.718 3.113 6.115 3.342l.314.024.507.015c2.617 0 5.037-1.188 6.743-3.151l.193-.23zM21.392 21.954c1.087 0 1.985.814 2.116 1.866l.017.267v5.353a2.133 2.133 0 0 1-4.25.268l-.017-.268v-5.353c0-1.178.955-2.133 2.134-2.133m21.41 0c1.088 0 1.985.814 2.117 1.866l.017.267v5.353a2.133 2.133 0 0 1-4.25.268l-.017-.268v-5.353c0-1.178.955-2.133 2.133-2.133M54.853 0a.8.8 0 0 1 .8.8v7.786h7.76a.8.8 0 0 1 .8.8v2.667a.8.8 0 0 1-.8.8h-7.76v7.758a.8.8 0 0 1-.8.8h-2.666a.8.8 0 0 1-.8-.8v-7.758h-7.785a.8.8 0 0 1-.8-.8V9.387a.8.8 0 0 1 .8-.8l7.784-.001V.8a.8.8 0 0 1 .8-.8z",className:"icon-emoji-more_svg__fill"})));var Yg;function Sh(){return Sh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Sh.apply(null,arguments)}const q3=n=>N.createElement("svg",Sh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Yg||(Yg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 5.06a8 8 0 0 1 6.561 3.424l.287.439 22.608 37.744a8 8 0 0 1 .022 7.962 8 8 0 0 1-6.356 4.014l-.535.024H9.384a8 8 0 0 1-6.862-4.038 8.01 8.01 0 0 1-.226-7.493l.27-.506L25.16 8.91A8 8 0 0 1 32 5.06m0 5.333c-.816 0-1.58.372-2.076.99l-.196.28-22.565 37.67a2.67 2.67 0 0 0 1.909 3.973l.341.027h45.144a2.67 2.67 0 0 0 2.45-3.659l-.148-.304L34.28 11.676A2.67 2.67 0 0 0 32 10.393m0 32.274A2.667 2.667 0 1 1 32 48a2.667 2.667 0 0 1 0-5.333m0-21.334a2.667 2.667 0 0 1 2.649 2.356l.018.311v10.667a2.667 2.667 0 0 1-5.316.311l-.018-.311V24A2.667 2.667 0 0 1 32 21.333",className:"icon-error_svg__fill"})));var Qg;function Th(){return Th=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Th.apply(null,arguments)}const z3=n=>N.createElement("svg",Th({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Qg||(Qg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M48 8a2.667 2.667 0 0 1 2.649 2.356l.018.31V32l-.001.027v21.306a2.667 2.667 0 0 1-5.315.311l-.018-.31V34.665H19.772l6.114 6.115a2.67 2.67 0 0 1 .221 3.52l-.221.251a2.666 2.666 0 0 1-3.52.222l-.252-.222-10.666-10.666a2.666 2.666 0 0 1-.222-3.52l.222-.252 10.666-10.666a2.666 2.666 0 0 1 3.993 3.52l-.221.251-6.113 6.114h25.56V10.667A2.667 2.667 0 0 1 48 8",className:"icon-expand_svg__fill"})));var Xg;function Nh(){return Nh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Nh.apply(null,arguments)}const K3=n=>N.createElement("svg",Nh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Xg||(Xg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M30.52 12.51c1.685-1.226 4.139-.103 4.139 1.893v35.194c0 1.996-2.454 3.119-4.138 1.893l-12.45-9.909H7.898c-1.416 0-2.564-1.074-2.564-2.399V24.818c0-1.325 1.148-2.4 2.564-2.4h10.175zm20.427.163c10.293 10.667 10.293 27.987 0 38.654a2.137 2.137 0 0 1-3.156-.047c-.86-.942-.84-2.448.044-3.364 8.49-8.799 8.49-23.033 0-31.832-.884-.916-.904-2.422-.044-3.364a2.137 2.137 0 0 1 3.156-.047m-8.492 8.799c5.597 5.8 5.597 15.231 0 21.031a2.136 2.136 0 0 1-3.156-.046c-.86-.942-.84-2.448.044-3.364 3.794-3.932 3.794-10.279 0-14.211-.884-.916-.904-2.422-.044-3.363a2.136 2.136 0 0 1 3.156-.047",className:"icon-file-audio_svg__fill"})));var Zg;function Ih(){return Ih=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ih.apply(null,arguments)}const $3=n=>N.createElement("svg",Ih({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Zg||(Zg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M39.414 6.4a2.4 2.4 0 0 1 1.71.701l12.642 12.75c.407.41.634.953.634 1.516v29.765c0 3.542-4.342 6.468-8 6.468H16.16c-3.658 0-6.4-2.926-6.4-6.468L9.6 12.868c0-3.542 2.902-6.468 6.56-6.468zm3.331 35.173-21.49.027-.147.005c-1.066.08-1.908 1.014-1.908 2.155 0 1.193.92 2.16 2.055 2.16l21.49-.027.147-.005c1.066-.08 1.908-1.014 1.908-2.155 0-1.193-.92-2.16-2.055-2.16m0-8.533-21.49.027-.147.005c-1.066.08-1.908 1.014-1.908 2.155 0 1.193.92 2.16 2.055 2.16l21.49-.027.147-.005c1.066-.08 1.908-1.014 1.908-2.155 0-1.193-.92-2.16-2.055-2.16m-11.807-8.507h-9.6l-.153.006a2.15 2.15 0 0 0-1.985 2.154c0 1.193.957 2.16 2.138 2.16h9.6l.152-.005a2.15 2.15 0 0 0 1.985-2.155c0-1.193-.957-2.16-2.137-2.16",className:"icon-file-document_svg__fill"})));var Jg;function Ah(){return Ah=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ah.apply(null,arguments)}const W3=n=>N.createElement("svg",Ah({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),Jg||(Jg=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m41.636 3.226.251.222a2.67 2.67 0 0 1 .222 3.52l-.222.251-7.219 7.218V27.38l11.209-6.472 2.643-9.86a2.667 2.667 0 0 1 5.218 1.051l-.067.329-2.237 8.35 8.352 2.24a2.67 2.67 0 0 1 1.952 2.938l-.067.328a2.67 2.67 0 0 1-2.937 1.952l-.329-.066-9.861-2.643L37.334 32l11.209 6.47 9.862-2.64.329-.067a2.67 2.67 0 0 1 2.937 1.952l.067.328a2.67 2.67 0 0 1-1.952 2.938l-8.353 2.237 2.238 8.353.067.329a2.666 2.666 0 0 1-5.218 1.052l-2.643-9.861-11.209-6.472v12.944l7.219 7.218a2.667 2.667 0 0 1-3.52 3.993l-.251-.222L32 54.437l-6.114 6.115a2.666 2.666 0 0 1-3.52.222l-.251-.222a2.666 2.666 0 0 1-.222-3.52l.222-.251 7.218-7.22V36.62l-11.209 6.47-2.642 9.863a2.666 2.666 0 0 1-5.218-1.052l.067-.329 2.236-8.351-8.35-2.24a2.665 2.665 0 0 1-1.953-2.937l.067-.328a2.665 2.665 0 0 1 2.937-1.952l.329.066 9.861 2.642L26.667 32l-11.209-6.472-9.86 2.643-.329.066a2.665 2.665 0 0 1-2.937-1.952l-.067-.328a2.67 2.67 0 0 1 1.952-2.938l8.35-2.239-2.235-8.351-.067-.329a2.667 2.667 0 0 1 5.218-1.052l2.642 9.862 11.209 6.47V14.439L22.116 7.22a2.665 2.665 0 0 1 0-3.771 2.666 2.666 0 0 1 3.52-.222l.251.222 6.114 6.112 6.115-6.112a2.666 2.666 0 0 1 3.52-.222z",className:"icon-freeze_svg__fill"})));var eE;function Mh(){return Mh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Mh.apply(null,arguments)}const Y3=n=>N.createElement("svg",Mh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),eE||(eE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M16.664 45.333q3.233 0 5.89-.953 2.658-.954 4.113-2.683V31.34h-10.29v3.94h4.902v4.474q-1.292 1.284-4.327 1.283-3.017 0-4.58-2.085-1.561-2.085-1.562-6.168v-1.657q.018-4.047 1.455-6.097t4.184-2.05q2.155 0 3.385 1.034t1.59 3.262h5.243q-.486-4.206-3.107-6.408t-7.273-2.201q-3.34 0-5.827 1.506t-3.807 4.35q-1.32 2.843-1.32 6.728v1.765q.036 3.78 1.428 6.578 1.392 2.797 3.95 4.269 2.56 1.47 5.953 1.47m20.67 0V18.667H32v26.666h5.333zm10.396 0V34.436h9.721v-4.432H47.73v-6.887h10.937v-4.45h-16v26.666z",className:"icon-gif_svg__fill"})));var nE;function wh(){return wh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},wh.apply(null,arguments)}const Q3=n=>N.createElement("svg",wh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),nE||(nE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32s10.745 24 24 24 24-10.745 24-24S45.255 8 32 8m1.667 21.333a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1h-3.334a1 1 0 0 1-1-1v-14a1 1 0 0 1 1-1zm-1.667-8a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334",className:"icon-info_svg__fill"})));var tE;function Oh(){return Oh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Oh.apply(null,arguments)}const X3=n=>N.createElement("svg",Oh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),tE||(tE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 5.333a2.667 2.667 0 0 1 .311 5.316l-.311.018H10.667a2.67 2.67 0 0 0-2.65 2.355L8 13.333v37.334a2.667 2.667 0 0 0 2.356 2.648l.31.018H32a2.667 2.667 0 0 1 .311 5.316l-.311.018H10.667a8 8 0 0 1-7.987-7.53l-.013-.47V13.333a8 8 0 0 1 7.53-7.986l.47-.014zm17.634 13.893.252.222 10.666 10.666a2.666 2.666 0 0 1 .222 3.52l-.222.252-10.666 10.666a2.666 2.666 0 0 1-3.993-3.52l.221-.251 4.78-4.782L20 36a2.667 2.667 0 0 1-.311-5.315l.311-.018h33.56l-7.446-7.448a2.67 2.67 0 0 1-.221-3.52l.221-.251a2.666 2.666 0 0 1 3.52-.222",className:"icon-leave_svg__fill"})));var rE;function Rh(){return Rh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Rh.apply(null,arguments)}const Z3=n=>N.createElement("svg",Rh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),rE||(rE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 0 1-5.315.311L42.667 56v-5.333c0-4.26-3.33-7.743-7.53-7.987l-.47-.013H13.333a8 8 0 0 0-7.986 7.53l-.014.47V56a2.667 2.667 0 0 1-5.316.311L0 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013zM54 37.765a13.33 13.33 0 0 1 9.986 12.297l.014.605V56a2.667 2.667 0 0 1-5.315.311L58.667 56v-5.331a8 8 0 0 0-6-7.74A2.667 2.667 0 1 1 54 37.765M24 5.333c7.364 0 13.333 5.97 13.333 13.334S31.363 32 24 32s-13.333-5.97-13.333-13.333S16.637 5.333 24 5.333m19.328.43a13.333 13.333 0 0 1 0 25.834 2.667 2.667 0 1 1-1.323-5.167 8 8 0 0 0 0-15.5 2.667 2.667 0 1 1 1.323-5.167M24 10.667a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-members_svg__fill"})));var iE;function Dh(){return Dh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Dh.apply(null,arguments)}const J3=n=>N.createElement("svg",Dh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),iE||(iE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333c-4.455 0-8.679-.993-12.461-2.77l-1.753.58q-8.947 2.868-12.504 1.981-4.198-1.047-1.657-3.663 1.757-2.094 2.928-5.234.934-2.502-.737-7A29.15 29.15 0 0 1 2.666 32C2.667 15.8 15.8 2.667 32 2.667M32 8C18.745 8 8 18.745 8 32c0 3.5.747 6.88 2.168 9.978l.405.837.137.271.106.285c1.517 4.085 1.89 7.622.734 10.72l-.382.972-.192.433.235-.05a62 62 0 0 0 4.886-1.363l1.721-.568 2.04-.696 1.95.917A23.9 23.9 0 0 0 32 56c13.255 0 24-10.745 24-24S45.255 8 32 8M18.667 29.333a2.667 2.667 0 1 1-.001 5.333 2.667 2.667 0 0 1 .001-5.333m13.333 0a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334m13.333 0a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334",className:"icon-message_svg__fill"})));var aE;function Lh(){return Lh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Lh.apply(null,arguments)}const eR=n=>N.createElement("svg",Lh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),aE||(aE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M18.667 34.667a2.667 2.667 0 0 1 .311 5.316l-.311.017h-5.334v16a2.667 2.667 0 0 1-5.316.311L8 56V40H2.667a2.667 2.667 0 0 1-.311-5.315l.31-.018h16zM32 29.333a2.667 2.667 0 0 1 2.649 2.356l.018.311v24a2.667 2.667 0 0 1-5.316.311L29.333 56V32A2.667 2.667 0 0 1 32 29.333M61.333 40a2.667 2.667 0 0 1 .311 5.315l-.31.018h-5.335L56 56a2.667 2.667 0 0 1-5.315.311L50.667 56l-.001-10.668-5.333.001a2.667 2.667 0 0 1-.311-5.316l.311-.017zm-8-34.667a2.67 2.67 0 0 1 2.65 2.356L56 8v24a2.667 2.667 0 0 1-5.315.311L50.667 32V8a2.667 2.667 0 0 1 2.666-2.667m-42.666 0a2.667 2.667 0 0 1 2.648 2.356l.018.311v18.667a2.667 2.667 0 0 1-5.316.311L8 26.667V8a2.667 2.667 0 0 1 2.667-2.667m21.333 0a2.667 2.667 0 0 1 2.649 2.356l.018.311-.001 10.666H40a2.668 2.668 0 0 1 .311 5.317L40 24H24a2.667 2.667 0 0 1-.311-5.315l.311-.018h5.333V8A2.667 2.667 0 0 1 32 5.333",className:"icon-moderations_svg__fill"})));var sE;function Uh(){return Uh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Uh.apply(null,arguments)}const nR=n=>N.createElement("svg",Uh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),sE||(sE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 45.333a5.333 5.333 0 1 1 0 10.666 5.333 5.333 0 0 1 0-10.666M32 28a5.333 5.333 0 1 1 0 10.668A5.333 5.333 0 0 1 32 28m0-17.333c2.946 0 5.333 2.387 5.333 5.333S34.946 21.333 32 21.333 26.667 18.946 26.667 16s2.387-5.333 5.333-5.333",className:"icon-more_svg__fill"})));var uE;function kh(){return kh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},kh.apply(null,arguments)}const tR=n=>N.createElement("svg",kh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),uE||(uE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m55.62 19.616.067.123A26.55 26.55 0 0 1 58.667 32c0 4.326-1.03 8.41-2.864 12.025q-1.518 4.089-.67 6.363 1.066 2.855 2.662 4.758 2.31 2.379-1.506 3.33-3.135.782-10.879-1.646l-.488-.155-1.594-.527A26.6 26.6 0 0 1 32 58.667a26.55 26.55 0 0 1-12.326-3.014l-.059-.03 4-4A21.2 21.2 0 0 0 32 53.333c2.993 0 5.89-.614 8.562-1.786l.498-.226 1.925-.905 3.613 1.196.695.219q1.093.337 2.054.595l.472.125.485.121-.167-.42-.2-.594c-.814-2.685-.484-5.681.713-9.065l.154-.425.106-.284.528-1.084a21.2 21.2 0 0 0 1.895-8.8 21.2 21.2 0 0 0-1.71-8.385zm2.266-13.502a2.67 2.67 0 0 1 .221 3.52l-.221.252-48 48a2.668 2.668 0 0 1-3.993-3.52l.221-.252 5.238-5.237a26.56 26.56 0 0 1-6.015-16.412L5.333 32C5.333 17.272 17.273 5.333 32 5.333a26.55 26.55 0 0 1 16.877 6.02l5.237-5.239a2.67 2.67 0 0 1 3.772 0M32 10.667c-11.782 0-21.333 9.55-21.333 21.333 0 4.836 1.614 9.401 4.48 13.084l29.936-29.938A21.25 21.25 0 0 0 32 10.666z",className:"icon-mute_svg__fill"})));var oE;function xh(){return xh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},xh.apply(null,arguments)}const rR=n=>N.createElement("svg",xh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),oE||(oE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.613 53.333c2.056 0 3.338 2.227 2.307 4.005a8 8 0 0 1-13.84 0c-.98-1.689.129-3.783 2.004-3.988l.303-.017zM32 2.667c11.56 0 20.972 9.194 21.323 20.669l.01.664v13.333a5.334 5.334 0 0 0 4.936 5.319l.753.033c2.963.318 3.077 4.616.342 5.24l-.342.056-.355.019H5.333l-.355-.019c-3.082-.33-3.082-4.965 0-5.296l.753-.033a5.335 5.335 0 0 0 4.92-4.9l.016-.419V24c0-11.782 9.55-21.333 21.333-21.333M32 8c-8.636 0-15.674 6.842-15.989 15.4L16 24v13.333c0 1.562-.336 3.046-.939 4.383l-.275.564-.218.387h34.861l-.215-.387a10.6 10.6 0 0 1-1.146-3.74l-.055-.674-.013-.533V24c0-8.837-7.163-16-16-16",className:"icon-notifications_svg__fill"})));var lE;function Ph(){return Ph=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ph.apply(null,arguments)}const iR=n=>N.createElement("svg",Ph({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),lE||(lE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.613 53.333c2.056 0 3.338 2.227 2.307 4.005a8 8 0 0 1-13.84 0c-.98-1.689.129-3.783 2.004-3.988l.303-.017zM32 2.667c7.173 0 13.52 3.54 17.387 8.97l5.686-5.687a2.105 2.105 0 0 1 2.85-.117l.127.117a2.105 2.105 0 0 1 0 2.977L8.927 58.05c-.78.781-2.023.82-2.85.117l-.127-.117a2.105 2.105 0 0 1 0-2.977L13.023 48h-7.69l-.355-.019c-3.082-.33-3.082-4.965 0-5.296l.753-.033a5.335 5.335 0 0 0 4.92-4.9l.016-.419V24c0-11.782 9.55-21.333 21.333-21.333m20.85 16.795c.271 1.253.433 2.548.473 3.874l.01.664v13.333a5.334 5.334 0 0 0 4.936 5.319l.753.033c2.963.318 3.077 4.616.342 5.24l-.342.056-.355.019H24.31z",className:"icon-notifications-off-filled_svg__fill"})));var dE;function Fh(){return Fh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Fh.apply(null,arguments)}const aR=n=>N.createElement("svg",Fh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),dE||(dE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M29.83 6.45a2.667 2.667 0 0 1 4.34 0l11.697 16.374L57 13.918c1.88-1.504 4.573.054 4.32 2.35l-.047.29-8 37.334A2.666 2.666 0 0 1 50.666 56H13.333a2.666 2.666 0 0 1-2.607-2.108l-8-37.333c-.525-2.452 2.315-4.207 4.273-2.641l11.132 8.906zM32 12.587l-11.163 15.63a2.667 2.667 0 0 1-3.836.532l-7.497-5.997 5.984 27.915h33.021l5.984-27.915L47 28.749a2.667 2.667 0 0 1-3.632-.281l-.204-.251zM32 32a5.333 5.333 0 1 1 0 10.668A5.333 5.333 0 0 1 32 32",className:"icon-operator_svg__fill"})));var cE;function Hh(){return Hh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Hh.apply(null,arguments)}const sR=n=>N.createElement("svg",Hh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),cE||(cE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M50.667 5.333a8 8 0 0 1 8 8v37.334a8 8 0 0 1-8 8H13.333a8 8 0 0 1-8-8V13.333a8 8 0 0 1 8-8zm-8 25.107L19.77 53.332l30.896.001a2.667 2.667 0 0 0 2.661-2.498l.005-.168v-9.564L42.666 30.44zm8-19.773H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334c0 1.143.72 2.119 1.731 2.498L40.781 24.78a2.67 2.67 0 0 1 3.52-.222l.251.222 8.78 8.78.001-20.228a2.667 2.667 0 0 0-2.498-2.661zm-28 5.333a6.666 6.666 0 1 1 0 13.333 6.666 6.666 0 0 1 0-13.333m0 5.333a1.334 1.334 0 1 0 0 2.667 1.334 1.334 0 0 0 0-2.667",className:"icon-photo_svg__fill"})));var fE;function Bh(){return Bh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Bh.apply(null,arguments)}const uR=n=>N.createElement("svg",Bh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),fE||(fE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M51.908 34.75c1.9-1.233 1.896-3.26.013-4.514L19.376 8.577c-1.893-1.26-3.404-.391-3.376 1.968l.522 42.888c.028 2.347 1.596 3.247 3.493 2.016z",className:"icon-play_svg__fill"})));var hE;function Gh(){return Gh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Gh.apply(null,arguments)}const oR=n=>N.createElement("svg",Gh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),hE||(hE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 29.333h18.666c3.556 0 3.556 5.334 0 5.334H34.667v18.666c0 3.556-5.334 3.556-5.334 0V34.667H10.667c-3.556 0-3.556-5.334 0-5.334h18.666V10.667c0-3.556 5.334-3.556 5.334 0z",className:"icon-plus_svg__fill"})));var pE;function Vh(){return Vh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Vh.apply(null,arguments)}const lR=n=>N.createElement("svg",Vh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),pE||(pE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 61.333C15.8 61.333 2.667 48.2 2.667 32S15.8 2.667 32 2.667 61.333 15.8 61.333 32 48.2 61.333 32 61.333M32 56c13.255 0 24-10.745 24-24S45.255 8 32 8 8 18.745 8 32s10.745 24 24 24m2.213-18.63a2.667 2.667 0 1 1-5.333 0v-2.69c0-1.148.734-2.168 1.823-2.53.173-.058.532-.195 1.01-.407.809-.36 1.616-.79 2.354-1.282 1.835-1.223 2.813-2.528 2.813-3.786a5.333 5.333 0 0 0-10.364-1.777 2.667 2.667 0 0 1-5.032-1.77 10.668 10.668 0 0 1 20.729 3.551c0 3.413-2.022 6.109-5.187 8.22a21 21 0 0 1-2.813 1.578zm-5.333 7.523a2.667 2.667 0 1 1 5.333 0v.44a2.667 2.667 0 1 1-5.333 0v-.44",className:"icon-question_svg__fill"})));var mE;function jh(){return jh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},jh.apply(null,arguments)}const dR=n=>N.createElement("svg",jh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),mE||(mE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"m46.14 14.43.562.537 6.631 6.167v-7.8a2.67 2.67 0 0 1 2.356-2.65l.311-.017a2.667 2.667 0 0 1 2.649 2.355l.018.311v16a2.67 2.67 0 0 1-2.356 2.65L56 32H40a2.667 2.667 0 0 1-.311-5.315l.311-.018h11.452l-8.44-7.85c-5.964-5.893-15.168-7.182-22.563-3.156-7.38 4.018-11.172 12.357-9.314 20.455 1.859 8.107 8.935 14.032 17.362 14.518 8.43.487 16.162-4.585 18.967-12.426a2.667 2.667 0 0 1 5.022 1.797C48.88 50.082 38.973 56.582 28.19 55.959c-10.785-.623-19.862-8.222-22.254-18.65C3.542 26.872 8.426 16.135 17.9 10.977c9.227-5.024 20.65-3.579 28.241 3.453z",className:"icon-refresh_svg__fill"})));var _E;function qh(){return qh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},qh.apply(null,arguments)}const cR=n=>N.createElement("svg",qh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),_E||(_E=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667C48.2 2.667 61.333 15.8 61.333 32S48.2 61.333 32 61.333 2.667 48.2 2.667 32 15.8 2.667 32 2.667m9.886 19.447a2.67 2.67 0 0 0-3.772 0L32 28.23l-6.114-6.115-.134-.124a2.667 2.667 0 0 0-3.638.124l-.124.134a2.667 2.667 0 0 0 .124 3.638L28.23 32l-6.115 6.114-.124.134a2.667 2.667 0 0 0 .124 3.638l.134.124a2.667 2.667 0 0 0 3.638-.124L32 35.77l6.114 6.115.134.124a2.667 2.667 0 0 0 3.638-.124l.124-.134a2.667 2.667 0 0 0-.124-3.638L35.77 32l6.115-6.114.124-.134a2.667 2.667 0 0 0-.124-3.638z",className:"icon-remove_svg__fill"})));var gE;function zh(){return zh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},zh.apply(null,arguments)}const fR=n=>N.createElement("svg",zh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 12"},n),gE||(gE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M11.774 10.5c.062 0 .12-.025.164-.07a.22.22 0 0 0 .062-.164c-.069-1.447-.495-2.678-1.268-3.66-.618-.785-1.455-1.409-2.49-1.855a9.3 9.3 0 0 0-2.406-.655 10 10 0 0 0-.862-.078V2.225a.23.23 0 0 0-.128-.203.23.23 0 0 0-.24.028L.084 5.692A.22.22 0 0 0 0 5.865c0 .068.03.132.082.175l4.523 3.737c.067.056.16.068.24.03a.22.22 0 0 0 .13-.202v-1.95c1.134-.08 2.178.003 3.107.25a6.4 6.4 0 0 1 2.087.96c1.018.724 1.398 1.5 1.401 1.507a.23.23 0 0 0 .204.128",className:"icon-reply-filled_svg__fill"})));var EE;function Kh(){return Kh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Kh.apply(null,arguments)}const hR=n=>N.createElement("svg",Kh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),EE||(EE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M26.667 48C14.885 48 5.333 38.449 5.333 26.667S14.885 5.333 26.667 5.333 48 14.885 48 26.667c0 4.93-1.672 9.469-4.48 13.081l13.67 13.67a2.668 2.668 0 0 1-3.772 3.772l-13.67-13.67A21.24 21.24 0 0 1 26.667 48m0-5.333c8.836 0 16-7.164 16-16s-7.164-16-16-16-16 7.163-16 16 7.163 16 16 16",className:"icon-search_svg__fill"})));var vE;function $h(){return $h=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},$h.apply(null,arguments)}const pR=n=>N.createElement("svg",$h({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),vE||(vE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M59.795 29.43 7.329 2.979C4.691 1.802 1.76 4.153 2.932 6.798l6.925 18.609a2 2 0 0 0 1.544 1.275l32.273 5.394L11.4 37.47a2 2 0 0 0-1.544 1.275L2.932 57.353c-.879 2.645 1.76 4.997 4.397 3.527l52.466-26.453c2.051-.882 2.051-3.82 0-4.996z",className:"icon-send_svg__fill"})));var yE;function Wh(){return Wh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Wh.apply(null,arguments)}const mR=n=>N.createElement("svg",Wh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),yE||(yE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 2.667A5.33 5.33 0 0 1 37.333 8v.24A4.4 4.4 0 0 0 40 12.267a4.4 4.4 0 0 0 4.853-.88l.16-.16a5.33 5.33 0 0 1 7.547 0 5.333 5.333 0 0 1 0 7.546l-.16.16a4.4 4.4 0 0 0-.88 4.854V24a4.4 4.4 0 0 0 4.027 2.667H56c2.946 0 5.333 2.387 5.333 5.333S58.946 37.333 56 37.333h-.24A4.4 4.4 0 0 0 51.733 40a4.4 4.4 0 0 0 .88 4.853l.16.16a5.33 5.33 0 0 1 0 7.547 5.333 5.333 0 0 1-7.546 0l-.16-.16a4.4 4.4 0 0 0-4.854-.88 4.4 4.4 0 0 0-2.666 4.027V56a5.333 5.333 0 0 1-10.667 0v-.24A4.4 4.4 0 0 0 24 51.733a4.4 4.4 0 0 0-4.853.88l-.16.16a5.33 5.33 0 0 1-7.547 0 5.333 5.333 0 0 1 0-7.546l.16-.16a4.4 4.4 0 0 0 .88-4.854 4.4 4.4 0 0 0-4.027-2.666H8A5.333 5.333 0 0 1 8 26.88h.24A4.4 4.4 0 0 0 12.267 24a4.4 4.4 0 0 0-.88-4.853l-.16-.16a5.33 5.33 0 0 1 0-7.547 5.333 5.333 0 0 1 7.546 0l.16.16a4.4 4.4 0 0 0 4.854.88H24a4.4 4.4 0 0 0 2.667-4.027V8A5.33 5.33 0 0 1 32 2.667M32 24a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-settings-filled_svg__fill"})));var bE;function Yh(){return Yh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Yh.apply(null,arguments)}const _R=n=>N.createElement("svg",Yh({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 32 32"},n),bE||(bE=N.createElement("path",{d:"M21.943 24.39a1.333 1.333 0 0 1-1.886 1.886l-9.333-9.333a1.333 1.333 0 0 1 0-1.886l9.333-9.333a1.333 1.333 0 1 1 1.886 1.885L13.553 16z",className:"icon-slide-left_svg__fill",clipRule:"evenodd"})));var CE;function Qh(){return Qh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Qh.apply(null,arguments)}const gR=n=>N.createElement("svg",Qh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),CE||(CE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M32 61.333C48.2 61.333 61.333 48.2 61.333 32S48.2 2.667 32 2.667 2.667 15.8 2.667 32a2.838 2.838 0 1 0 5.678 0C8.344 18.935 18.934 8.344 32 8.344c13.065 0 23.656 10.591 23.656 23.656S45.065 55.656 32 55.656a2.838 2.838 0 1 0 0 5.677",className:"icon-spinner_svg__fill"})));var SE;function Xh(){return Xh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Xh.apply(null,arguments)}const ER=n=>N.createElement("svg",Xh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),SE||(SE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M36.889 43.013c6.608 0 12.121 4.685 12.43 10.734l.014.537V58a2.667 2.667 0 0 1-5.316.311L44 58v-3.716c0-3.07-2.87-5.718-6.636-5.925l-.475-.013H27.11c-3.838 0-6.86 2.525-7.096 5.557l-.015.381V58a2.667 2.667 0 0 1-5.315.311L14.667 58v-3.716c0-6.126 5.324-10.986 11.864-11.26l.58-.011zm18.578-17.291q.401 0 .784.118c4.632 1.426 7.518 4.801 7.736 9.688l.013.594v12.8a2.667 2.667 0 0 1-5.315.311l-.018-.311V36.124c-.002-2.595-1.163-4.171-3.528-5.034l-.104-.037-2.502.002a2.667 2.667 0 0 1-2.648-2.356l-.018-.31a2.67 2.67 0 0 1 2.355-2.65l.311-.017zm-44 0 .31.018a2.666 2.666 0 0 1 2.356 2.648l-.018.311a2.666 2.666 0 0 1-2.648 2.356l-2.51-.002-.119.042c-2.246.85-3.503 2.574-3.505 5.147v12.68l-.018.31A2.666 2.666 0 0 1 0 48.922V36.24l.014-.591c.225-4.874 3.203-8.415 7.712-9.809q.384-.117.788-.118zM32 19.958c5.512 0 10 4.409 10 9.871s-4.488 9.872-10 9.872-10-4.41-10-9.872 4.488-9.871 10-9.871m0 5.333c-2.588 0-4.667 2.043-4.667 4.538s2.08 4.538 4.667 4.538c2.588 0 4.667-2.042 4.667-4.538 0-2.495-2.08-4.538-4.667-4.538M17.333 2.667c5.513 0 10 4.409 10 9.871s-4.487 9.871-10 9.871c-5.512 0-10-4.409-10-9.871s4.488-9.871 10-9.871m29.334 0c5.512 0 10 4.409 10 9.871s-4.488 9.871-10 9.871c-5.513 0-10-4.409-10-9.871s4.487-9.871 10-9.871M17.333 8c-2.587 0-4.666 2.042-4.666 4.538s2.079 4.538 4.666 4.538S22 15.034 22 12.538 19.921 8 17.333 8m29.334 0C44.079 8 42 10.042 42 12.538s2.079 4.538 4.667 4.538 4.666-2.042 4.666-4.538S49.254 8 46.667 8",className:"icon-supergroup_svg__fill"})));var TE,NE;function Zh(){return Zh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Zh.apply(null,arguments)}const vR=n=>N.createElement("svg",Zh({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 64 64"},n),TE||(TE=N.createElement("path",{d:"M38.824 25.895a2.95 2.95 0 0 1 4.16-.074L57.1 39.378a2.92 2.92 0 0 1 .002 4.213L42.985 57.177a2.95 2.95 0 0 1-4.158-.07 2.92 2.92 0 0 1 .07-4.14l11.928-11.48-11.926-11.451a2.92 2.92 0 0 1-.075-4.14",className:"icon-thread_svg__fill",clipRule:"evenodd"})),NE||(NE=N.createElement("path",{d:"M8.866 6c1.583 0 2.866 1.216 2.866 2.716V25.5c0 7.672 6.846 14.068 15.475 14.068h22.927c1.583 0 2.866 1.216 2.866 2.716S51.717 45 50.134 45H27.207C15.604 45 6 36.35 6 25.5V8.716C6 7.216 7.283 6 8.866 6",className:"icon-thread_svg__fill",clipRule:"evenodd"})));var IE;function Jh(){return Jh=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Jh.apply(null,arguments)}const yR=n=>N.createElement("svg",Jh({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),IE||(IE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M34.667 5.333a2.667 2.667 0 0 1 0 5.334H13.333a2.667 2.667 0 0 0-2.666 2.666v37.334c0 1.143.72 2.118 1.73 2.497l28.384-28.383a2.667 2.667 0 0 1 3.771 0l8.781 8.78v-4.228a2.667 2.667 0 0 1 2.498-2.661l.169-.005a2.667 2.667 0 0 1 2.667 2.666v21.334a8 8 0 0 1-8 8H13.33a8 8 0 0 1-7.998-8V13.333a8 8 0 0 1 8-8zm8 25.105L19.77 53.333h30.897a2.667 2.667 0 0 0 2.661-2.498l.005-.168v-9.563zM22.667 16a6.666 6.666 0 1 1 0 13.333 6.666 6.666 0 0 1 0-13.333m0 5.333a1.334 1.334 0 1 0 0 2.667 1.334 1.334 0 0 0 0-2.667M56.78 3.448a2.665 2.665 0 0 1 3.771 0 2.665 2.665 0 0 1 0 3.771l-4.782 4.78 4.782 4.782c.998.998 1.04 2.59.125 3.638l-.125.133a2.665 2.665 0 0 1-3.771 0l-4.782-4.781-4.78 4.781a2.667 2.667 0 0 1-3.638.125l-.133-.125a2.665 2.665 0 0 1 0-3.771L48.228 12l-4.78-4.781a2.667 2.667 0 0 1-.125-3.638l.125-.133a2.665 2.665 0 0 1 3.771 0l4.78 4.78z",className:"icon-thumbnail-none_svg__fill"})));var AE;function ep(){return ep=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ep.apply(null,arguments)}const bR=n=>N.createElement("svg",ep({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 88 48"},n),AE||(AE=N.createElement("g",{fill:"none",fillRule:"evenodd"},N.createElement("rect",{width:80,height:40,x:4,y:4,fill:"#000",className:"icon-toggleoff_svg__fill",rx:20}),N.createElement("circle",{cx:24,cy:24,r:12,fill:"#FFF"}),N.createElement("path",{fill:"#FFF",d:"M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992z"}),N.createElement("path",{fill:"#000",d:"M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0m0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4z",className:"icon-toggleoff_svg__fill"}))));var ME;function np(){return np=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},np.apply(null,arguments)}const CR=n=>N.createElement("svg",np({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 88 48"},n),ME||(ME=N.createElement("g",{fill:"none",fillRule:"evenodd"},N.createElement("rect",{width:80,height:40,x:4,y:4,fill:"#000",className:"icon-toggleon_svg__fill",rx:20}),N.createElement("circle",{cx:64,cy:24,r:12,fill:"#FFF"}),N.createElement("path",{fill:"#FFF",d:"M64 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4zm0 2H24C14.059 6 6 14.059 6 24c0 9.764 7.774 17.712 17.47 17.992L24 42h40c9.941 0 18-8.059 18-18 0-9.764-7.774-17.712-17.47-17.992z"}),N.createElement("path",{fill:"#000",d:"M64 0H24C10.745 0 0 10.745 0 24s10.745 24 24 24h40c13.255 0 24-10.745 24-24S77.255 0 64 0m0 4c11.046 0 20 8.954 20 20s-8.954 20-20 20H24C12.954 44 4 35.046 4 24S12.954 4 24 4z",className:"icon-toggleon_svg__fill"}))));var wE;function tp(){return tp=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},tp.apply(null,arguments)}const SR=n=>N.createElement("svg",tp({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},n),wE||(wE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M42.667 37.333c7.17 0 13.018 5.66 13.32 12.755l.013.579V56a2.667 2.667 0 0 1-5.315.311L50.667 56v-5.333c0-4.26-3.33-7.743-7.53-7.987l-.47-.013H21.333a8 8 0 0 0-7.986 7.53l-.014.47V56a2.667 2.667 0 0 1-5.316.311L8 56v-5.333c0-7.17 5.66-13.019 12.755-13.321l.578-.013zM32 5.333c7.364 0 13.333 5.97 13.333 13.334S39.363 32 32 32s-13.333-5.97-13.333-13.333S24.637 5.333 32 5.333m0 5.334a8 8 0 1 0 0 16 8 8 0 0 0 0-16",className:"icon-user_svg__fill"})));var OE;function rp(){return rp=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},rp.apply(null,arguments)}const TR=n=>N.createElement("svg",rp({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},n),OE||(OE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M12.346 5.336v-.001c.405-.523 1.182-.524 1.58-.037.162.2.25.443.25.69v3.678c0 .518.42.938.938.938H18.6c.359 0 .7.179.911.488l.001.001.369.548.003.004c.174.256.226.583.134.895l-1.532 5.316c-.131.459-.559.782-1.044.782h-7.075c-.3 0-.593-.127-.8-.345l-1.13-1.222v-6.647zm-4.73 3.078 3.245-4.223.002-.002c1.125-1.456 3.339-1.521 4.517-.075.421.52.671 1.177.671 1.874v2.74h2.55c.99 0 1.908.496 2.462 1.31l.002.004.368.547.002.002a2.93 2.93 0 0 1 .382 2.475v.003l-1.528 5.302a2.96 2.96 0 0 1-2.847 2.142h-7.075a2.99 2.99 0 0 1-2.166-.935l-.007-.007-.066-.072a2.13 2.13 0 0 1-1.821 1.025H4.192a2.13 2.13 0 0 1-2.13-2.13v-8.3a2.13 2.13 0 0 1 2.13-2.13h2.115c.493 0 .948.168 1.31.45m-3.678 1.68c0-.141.114-.255.254-.255h2.115c.14 0 .254.114.254.255v8.3c0 .14-.114.255-.254.255H4.192a.255.255 0 0 1-.255-.255z",clipRule:"evenodd"})));var RE;function ip(){return ip=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},ip.apply(null,arguments)}const NR=n=>N.createElement("svg",ip({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},n),RE||(RE=N.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M11.654 18.664v.001c-.405.523-1.182.524-1.58.037-.162-.2-.25-.444-.25-.69v-3.678a.94.94 0 0 0-.938-.938H5.4c-.359 0-.7-.179-.911-.488l-.001-.001-.369-.548-.003-.004a1.05 1.05 0 0 1-.134-.895l1.532-5.316c.131-.459.559-.782 1.044-.782h7.075c.3 0 .593.127.8.345l1.13 1.222v6.647zm4.73-3.078-3.245 4.223-.002.002c-1.125 1.456-3.339 1.521-4.517.075a2.98 2.98 0 0 1-.671-1.874v-2.74h-2.55c-.99 0-1.908-.496-2.462-1.31l-.002-.004-.368-.547-.002-.002a2.93 2.93 0 0 1-.382-2.475v-.003L3.711 5.63a2.96 2.96 0 0 1 2.847-2.142h7.075c.823 0 1.608.345 2.166.935l.007.007.066.072a2.13 2.13 0 0 1 1.821-1.025h2.115a2.13 2.13 0 0 1 2.13 2.13v8.3a2.13 2.13 0 0 1-2.13 2.13h-2.115a2.12 2.12 0 0 1-1.31-.45m3.678-1.68c0 .141-.114.255-.254.255h-2.115a.255.255 0 0 1-.255-.255v-8.3c0-.14.115-.255.255-.255h2.115c.14 0 .255.114.255.255z",clipRule:"evenodd"})));function IR(n){switch(n){case de.ADD:return p.createElement(y3,null);case de.ARROW_LEFT:return p.createElement(b3,null);case de.ATTACH:return p.createElement(C3,null);case de.AUDIO_ON_LINED:return p.createElement(S3,null);case de.BAN:return p.createElement(T3,null);case de.BROADCAST:return p.createElement(N3,null);case de.CAMERA:return p.createElement(I3,null);case de.CHANNELS:return p.createElement(A3,null);case de.CHAT:return p.createElement(M3,null);case de.CHAT_FILLED:return p.createElement(w3,null);case de.CHEVRON_DOWN:return p.createElement(O3,null);case de.CHEVRON_RIGHT:return p.createElement(R3,null);case de.CLOSE:return p.createElement(D3,null);case de.COLLAPSE:return p.createElement(L3,null);case de.COPY:return p.createElement(U3,null);case de.CREATE:return p.createElement(k3,null);case de.DELETE:return p.createElement(x3,null);case de.DISCONNECTED:return p.createElement(P3,null);case de.DOCUMENT:return p.createElement(F3,null);case de.DONE:return p.createElement(H3,null);case de.DONE_ALL:return p.createElement(B3,null);case de.DOWNLOAD:return p.createElement(G3,null);case de.EDIT:return p.createElement(V3,null);case de.EMOJI_MORE:return p.createElement(j3,null);case de.ERROR:return p.createElement(q3,null);case de.EXPAND:return p.createElement(z3,null);case de.FILE_AUDIO:return p.createElement(K3,null);case de.FILE_DOCUMENT:return p.createElement($3,null);case de.FREEZE:return p.createElement(W3,null);case de.GIF:return p.createElement(Y3,null);case de.INFO:return p.createElement(Q3,null);case de.LEAVE:return p.createElement(X3,null);case de.MEMBERS:return p.createElement(Z3,null);case de.MESSAGE:return p.createElement(J3,null);case de.MODERATIONS:return p.createElement(eR,null);case de.MORE:return p.createElement(nR,null);case de.MUTE:return p.createElement(tR,null);case de.NOTIFICATIONS:return p.createElement(rR,null);case de.NOTIFICATIONS_OFF_FILLED:return p.createElement(iR,null);case de.OPERATOR:return p.createElement(aR,null);case de.PHOTO:return p.createElement(sR,null);case de.PLAY:return p.createElement(uR,null);case de.PLUS:return p.createElement(oR,null);case de.QUESTION:return p.createElement(lR,null);case de.REFRESH:return p.createElement(dR,null);case de.REMOVE:return p.createElement(cR,null);case de.REPLY:return p.createElement(fR,null);case de.SEARCH:return p.createElement(hR,null);case de.SEND:return p.createElement(pR,null);case de.SETTINGS_FILLED:return p.createElement(mR,null);case de.SLIDE_LEFT:return p.createElement(_R,null);case de.SPINNER:return p.createElement(gR,null);case de.SUPERGROUP:return p.createElement(ER,null);case de.THREAD:return p.createElement(vR,null);case de.THUMBNAIL_NONE:return p.createElement(yR,null);case de.TOGGLE_OFF:return p.createElement(bR,null);case de.TOGGLE_ON:return p.createElement(CR,null);case de.USER:return p.createElement(SR,null);case de.FEEDBACK_LIKE:return p.createElement(TR,null);case de.FEEDBACK_DISLIKE:return p.createElement(NR,null);default:return"icon"}}function Ue(n){var t=n.className,e=t===void 0?"":t,r=n.type,i=n.fillColor,a=i===void 0?er.DEFAULT:i,s=n.width,u=s===void 0?26:s,o=n.height,l=o===void 0?26:o,d=n.onClick,c=d===void 0?ot:d,f=n.children,h=f===void 0?null:f,m=n.testID,_={width:typeof u=="string"?u:"".concat(u,"px"),minWidth:typeof u=="string"?u:"".concat(u,"px"),height:typeof l=="string"?l:"".concat(l,"px"),minHeight:typeof l=="string"?l:"".concat(l,"px")};return p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-icon",v3(r),E3(a)],!1).join(" "),"data-testid":m,role:"button",onClick:c,onKeyDown:c,tabIndex:0,style:_},h||IR(r))}var ye=de,Me=er;/*!
 * css-vars-ponyfill
 * v2.4.9
 * https://jhildenbiddle.github.io/css-vars-ponyfill/
 * (c) 2018-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function jr(){return jr=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},jr.apply(this,arguments)}/*!
 * get-css-data
 * v2.1.0
 * https://github.com/jhildenbiddle/get-css-data
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function DE(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={mimeType:t.mimeType||null,onBeforeSend:t.onBeforeSend||Function.prototype,onSuccess:t.onSuccess||Function.prototype,onError:t.onError||Function.prototype,onComplete:t.onComplete||Function.prototype},r=Array.isArray(n)?n:[n],i=Array.apply(null,Array(r.length)).map(function(l){return null});function a(l){var d=typeof l=="string",c=d&&l.trim().charAt(0)==="<";return d&&!c}function s(l,d){e.onError(l,r[d],d)}function u(l,d){var c=e.onSuccess(l,r[d],d);l=c===!1?"":c||l,i[d]=l,i.indexOf(null)===-1&&e.onComplete(i)}var o=document.createElement("a");r.forEach(function(l,d){o.setAttribute("href",l),o.href=String(o.href);var c=!!(document.all&&!window.atob),f=c&&o.host.split(":")[0]!==location.host.split(":")[0];if(f){var h=o.protocol===location.protocol;if(h){var m=new XDomainRequest;m.open("GET",l),m.timeout=0,m.onprogress=Function.prototype,m.ontimeout=Function.prototype,m.onload=function(){var E=m.responseText;a(E)?u(E,d):s(m,d)},m.onerror=function(E){s(m,d)},setTimeout(function(){m.send()},0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(l,")")),s(null,d)}else{var _=new XMLHttpRequest;_.open("GET",l),e.mimeType&&_.overrideMimeType&&_.overrideMimeType(e.mimeType),e.onBeforeSend(_,l,d),_.onreadystatechange=function(){if(_.readyState===4){var E=_.responseText;_.status<400&&a(E)||_.status===0&&a(E)?u(E,d):s(_,d)}},_.send()}})}/**
 * Gets CSS data from <style> and <link> nodes (including @imports), then
 * returns data in order processed by DOM. Allows specifying nodes to
 * include/exclude and filtering CSS data using RegEx.
 *
 * @preserve
 * @param {object}   [options] The options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes.
 * @param {string}   [options.include] CSS selector matching <link> and <style>
 *                   nodes to include
 * @param {string}   [options.exclude] CSS selector matching <link> and <style>
 *                   nodes to exclude
 * @param {object}   [options.filter] Regular expression used to filter node CSS
 *                   data. Each block of CSS data is tested against the filter,
 *                   and only matching data is included.
 * @param {boolean}  [options.skipDisabled=true] Determines if disabled
 *                   stylesheets will be skipped while collecting CSS data.
 * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
 *                   collected from a stylesheet's runtime values instead of its
 *                   text content. This is required to get accurate CSS data
 *                   when a stylesheet has been modified using the deleteRule()
 *                   or insertRule() methods because these modifications will
 *                   not be reflected in the stylesheet's text content.
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments.
 * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
 *                   1) CSS text, 2) source node reference, and 3) the source
 *                   URL as arguments.
 * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
 *                   object for inspection, 2) soure node reference, and 3) the
 *                   source URL that failed (either a <link> href or an @import)
 *                   as arguments
 * @param {function} [options.onComplete] Callback after all nodes have been
 *                   processed. Passes 1) concatenated CSS text, 2) an array of
 *                   CSS text in DOM order, and 3) an array of nodes in DOM
 *                   order as arguments.
 *
 * @example
 *
 *   getCssData({
 *     rootElement : document,
 *     include     : 'style,link[rel="stylesheet"]',
 *     exclude     : '[href="skip.css"]',
 *     filter      : /red/,
 *     skipDisabled: true,
 *     useCSSOM    : false,
 *     onBeforeSend(xhr, node, url) {
 *       // ...
 *     }
 *     onSuccess(cssText, node, url) {
 *       // ...
 *     }
 *     onError(xhr, node, url) {
 *       // ...
 *     },
 *     onComplete(cssText, cssArray, nodeArray) {
 *       // ...
 *     }
 *   });
 */function LE(n){var t={cssComments:/\/\*[\s\S]+?\*\//g,cssImports:/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g},e={rootElement:n.rootElement||document,include:n.include||'style,link[rel="stylesheet"]',exclude:n.exclude||null,filter:n.filter||null,skipDisabled:n.skipDisabled!==!1,useCSSOM:n.useCSSOM||!1,onBeforeSend:n.onBeforeSend||Function.prototype,onSuccess:n.onSuccess||Function.prototype,onError:n.onError||Function.prototype,onComplete:n.onComplete||Function.prototype},r=Array.apply(null,e.rootElement.querySelectorAll(e.include)).filter(function(l){return!AR(l,e.exclude)}),i=Array.apply(null,Array(r.length)).map(function(l){return null});function a(){var l=i.indexOf(null)===-1;if(l){i.reduce(function(c,f,h){return f===""&&c.push(h),c},[]).reverse().forEach(function(c){return[r,i].forEach(function(f){return f.splice(c,1)})});var d=i.join("");e.onComplete(d,i,r)}}function s(l,d,c,f){var h=e.onSuccess(l,c,f);l=h!==void 0&&!h?"":h||l,o(l,c,f,function(m,_){i[d]===null&&(_.forEach(function(E){return e.onError(E.xhr,c,E.url)}),!e.filter||e.filter.test(m)?i[d]=m:i[d]="",a())})}function u(l,d){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],f={};return f.rules=(l.replace(t.cssComments,"").match(t.cssImports)||[]).filter(function(h){return c.indexOf(h)===-1}),f.urls=f.rules.map(function(h){return h.replace(t.cssImports,"$1")}),f.absoluteUrls=f.urls.map(function(h){return Xc(h,d)}),f.absoluteRules=f.rules.map(function(h,m){var _=f.urls[m],E=Xc(f.absoluteUrls[m],d);return h.replace(_,E)}),f}function o(l,d,c,f){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],m=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[],_=u(l,c,m);_.rules.length?DE(_.absoluteUrls,{onBeforeSend:function(b,g,C){e.onBeforeSend(b,d,g)},onSuccess:function(b,g,C){var S=e.onSuccess(b,d,g);b=S===!1?"":S||b;var A=u(b,g,m);return A.rules.forEach(function(I,T){b=b.replace(I,A.absoluteRules[T])}),b},onError:function(b,g,C){h.push({xhr:b,url:g}),m.push(_.rules[C]),o(l,d,c,f,h,m)},onComplete:function(b){b.forEach(function(g,C){l=l.replace(_.rules[C],g)}),o(l,d,c,f,h,m)}}):f(l,h)}r.length?r.forEach(function(l,d){var c=l.getAttribute("href"),f=l.getAttribute("rel"),h=l.nodeName.toLowerCase()==="link"&&c&&f&&f.toLowerCase().indexOf("stylesheet")!==-1,m=e.skipDisabled===!1?!1:l.disabled,_=l.nodeName.toLowerCase()==="style";if(h&&!m){var E=c.indexOf("data:text/css")!==-1;if(E){var b=decodeURIComponent(c.substring(c.indexOf(",")+1));e.useCSSOM&&(b=Array.apply(null,l.sheet.cssRules).map(function(C){return C.cssText}).join("")),s(b,d,l,location.href)}else DE(c,{mimeType:"text/css",onBeforeSend:function(S,A,I){e.onBeforeSend(S,l,A)},onSuccess:function(S,A,I){var T=Xc(c);s(S,d,l,T)},onError:function(S,A,I){i[d]="",e.onError(S,l,A),a()}})}else if(_&&!m){var g=l.textContent;e.useCSSOM&&(g=Array.apply(null,l.sheet.cssRules).map(function(C){return C.cssText}).join("")),s(g,d,l,location.href)}else i[d]="",a()}):e.onComplete("",[])}function Xc(n,t){var e=document.implementation.createHTMLDocument(""),r=e.createElement("base"),i=e.createElement("a");return e.head.appendChild(r),e.body.appendChild(i),r.href=t||document.baseURI||(document.querySelector("base")||{}).href||location.href,i.href=n,i.href}function AR(n,t){var e=n.matches||n.matchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return e.call(n,t)}var BC=GC;function GC(n,t,e){n instanceof RegExp&&(n=UE(n,e)),t instanceof RegExp&&(t=UE(t,e));var r=VC(n,t,e);return r&&{start:r[0],end:r[1],pre:e.slice(0,r[0]),body:e.slice(r[0]+n.length,r[1]),post:e.slice(r[1]+t.length)}}function UE(n,t){var e=t.match(n);return e?e[0]:null}GC.range=VC;function VC(n,t,e){var r,i,a,s,u,o=e.indexOf(n),l=e.indexOf(t,o+1),d=o;if(o>=0&&l>0){if(n===t)return[o,l];for(r=[],a=e.length;d>=0&&!u;)d==o?(r.push(d),o=e.indexOf(n,d+1)):r.length==1?u=[r.pop(),l]:(i=r.pop(),i<a&&(a=i,s=l),l=e.indexOf(t,d+1)),d=o<l&&o>=0?o:l;r.length&&(u=[a,s])}return u}function Qp(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={preserveStatic:!0,removeComments:!1},r=jr({},e,t),i=[];function a(L){throw new Error("CSS parse error: ".concat(L))}function s(L){var F=L.exec(n);if(F)return n=n.slice(F[0].length),F}function u(){return s(/^{\s*/)}function o(){return s(/^}/)}function l(){s(/^\s*/)}function d(){if(l(),!(n[0]!=="/"||n[1]!=="*")){for(var L=2;n[L]&&(n[L]!=="*"||n[L+1]!=="/");)L++;if(!n[L])return a("end of comment is missing");var F=n.slice(2,L);return n=n.slice(L+2),{type:"comment",comment:F}}}function c(){for(var L=[],F;F=d();)L.push(F);return r.removeComments?[]:L}function f(){for(l();n[0]==="}";)a("extra closing bracket");var L=s(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(L){var F=L[0].trim(),B,V=/\/\*/.test(F);V&&(F=F.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var K=/["']\w*,\w*["']/.test(F);K&&(F=F.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(q){return q.replace(/,/g,"‌")}));var $=/,/.test(F);return $?B=F.split(/\s*(?![^(]*\)),\s*/):B=[F],K&&(B=B.map(function(q){return q.replace(/\u200C/g,",")})),B}}function h(){if(n[0]==="@")return R();s(/^([;\s]*)+/);var L=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,F=s(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(F){if(F=F[0].trim(),!s(/^:\s*/))return a("property missing ':'");var B=s(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),V={type:"declaration",property:F.replace(L,""),value:B?B[0].replace(L,"").trim():""};return s(/^[;\s]*/),V}}function m(){if(!u())return a("missing '{'");for(var L,F=c();L=h();)F.push(L),F=F.concat(c());return o()?F:a("missing '}'")}function _(){l();for(var L=[],F;F=s(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)L.push(F[1]),s(/^,\s*/);if(L.length)return{type:"keyframe",values:L,declarations:m()}}function E(){var L=s(/^@([-\w]+)?keyframes\s*/);if(L){var F=L[1];if(L=s(/^([-\w]+)\s*/),!L)return a("@keyframes missing name");var B=L[1];if(!u())return a("@keyframes missing '{'");for(var V,K=c();V=_();)K.push(V),K=K.concat(c());return o()?{type:"keyframes",name:B,vendor:F,keyframes:K}:a("@keyframes missing '}'")}}function b(){var L=s(/^@page */);if(L){var F=f()||[];return{type:"page",selectors:F,declarations:m()}}}function g(){var L=s(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(L){var F="".concat(L[1],"-").concat(L[2])+(L[3]?"-".concat(L[3]):"");return{type:"page-margin-box",name:F,declarations:m()}}}function C(){var L=s(/^@font-face\s*/);if(L)return{type:"font-face",declarations:m()}}function S(){var L=s(/^@supports *([^{]+)/);if(L)return{type:"supports",supports:L[1].trim(),rules:P()}}function A(){var L=s(/^@host\s*/);if(L)return{type:"host",rules:P()}}function I(){var L=s(/^@media([^{]+)*/);if(L)return{type:"media",media:(L[1]||"").trim(),rules:P()}}function T(){var L=s(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(L)return{type:"custom-media",name:L[1].trim(),media:L[2].trim()}}function M(){var L=s(/^@([-\w]+)?document *([^{]+)/);if(L)return{type:"document",document:L[2].trim(),vendor:L[1]?L[1].trim():null,rules:P()}}function O(){var L=s(/^@(import|charset|namespace)\s*([^;]+);/);if(L)return{type:L[1],name:L[2].trim()}}function R(){if(l(),n[0]==="@"){var L=O()||C()||I()||E()||S()||M()||T()||A()||b()||g();if(L&&!r.preserveStatic){var F=!1;if(L.declarations)F=L.declarations.some(function(V){return/var\(/.test(V.value)});else{var B=L.keyframes||L.rules||[];F=B.some(function(V){return(V.declarations||[]).some(function(K){return/var\(/.test(K.value)})})}return F?L:{}}return L}}function U(){if(!r.preserveStatic){var L=BC("{","}",n);if(L){var F=/:(?:root|host)(?![.:#(])/.test(L.pre)&&/--\S*\s*:/.test(L.body),B=/var\(/.test(L.body);if(!F&&!B)return n=n.slice(L.end+1),{}}}var V=f()||[],K=r.preserveStatic?m():m().filter(function($){var q=V.some(function(Y){return/:(?:root|host)(?![.:#(])/.test(Y)})&&/^--\S/.test($.property),se=/var\(/.test($.value);return q||se});return V.length||a("selector missing"),{type:"rule",selectors:V,declarations:K}}function P(L){if(!L&&!u())return a("missing '{'");for(var F,B=c();n.length&&(L||n[0]!=="}")&&(F=R()||U());)F.type&&B.push(F),B=B.concat(c());return!L&&!o()?a("missing '}'"):B}return{type:"stylesheet",stylesheet:{rules:P(!0),errors:i}}}function kE(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={parseHost:!1,store:{},onWarning:function(){}},r=jr({},e,t),i=new RegExp(":".concat(r.parseHost?"host":"root","$"));return typeof n=="string"&&(n=Qp(n,r)),n.stylesheet.rules.forEach(function(a){a.type!=="rule"||!a.selectors.some(function(s){return i.test(s)})||a.declarations.forEach(function(s,u){var o=s.property,l=s.value;o&&o.indexOf("--")===0&&(r.store[o]=l)})}),r.store}function jC(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",e=arguments.length>2?arguments[2]:void 0,r={charset:function(s){return"@charset "+s.name+";"},comment:function(s){return s.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+s.comment+"*/":""},"custom-media":function(s){return"@custom-media "+s.name+" "+s.media+";"},declaration:function(s){return s.property+":"+s.value+";"},document:function(s){return"@"+(s.vendor||"")+"document "+s.document+"{"+i(s.rules)+"}"},"font-face":function(s){return"@font-face{"+i(s.declarations)+"}"},host:function(s){return"@host{"+i(s.rules)+"}"},import:function(s){return"@import "+s.name+";"},keyframe:function(s){return s.values.join(",")+"{"+i(s.declarations)+"}"},keyframes:function(s){return"@"+(s.vendor||"")+"keyframes "+s.name+"{"+i(s.keyframes)+"}"},media:function(s){return"@media "+s.media+"{"+i(s.rules)+"}"},namespace:function(s){return"@namespace "+s.name+";"},page:function(s){return"@page "+(s.selectors.length?s.selectors.join(", "):"")+"{"+i(s.declarations)+"}"},"page-margin-box":function(s){return"@"+s.name+"{"+i(s.declarations)+"}"},rule:function(s){var u=s.declarations;if(u.length)return s.selectors.join(",")+"{"+i(u)+"}"},supports:function(s){return"@supports "+s.supports+"{"+i(s.rules)+"}"}};function i(a){for(var s="",u=0;u<a.length;u++){var o=a[u];e&&e(o);var l=r[o.type](o);l&&(s+=l,l.length&&o.selectors&&(s+=t))}return s}return i(n.stylesheet.rules)}function qC(n,t){n.rules.forEach(function(e){if(e.rules){qC(e,t);return}if(e.keyframes){e.keyframes.forEach(function(r){r.type==="keyframe"&&t(r.declarations,e)});return}e.declarations&&t(e.declarations,n)})}var MR="--",wR="var";function OR(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},r=jr({},e,t);return typeof n=="string"&&(n=Qp(n,r)),qC(n.stylesheet,function(i,a){for(var s=0;s<i.length;s++){var u=i[s],o=u.type,l=u.property,d=u.value;if(o==="declaration"){if(!r.preserveVars&&l&&l.indexOf(MR)===0){i.splice(s,1),s--;continue}if(d.indexOf(wR+"(")!==-1){var c=io(d,r);c!==u.value&&(c=RR(c),r.preserveVars?(i.splice(s,0,{type:o,property:l,value:c}),s++):u.value=c)}}}}),jC(n)}function RR(n){var t=/calc\(([^)]+)\)/g;return(n.match(t)||[]).forEach(function(e){var r="calc".concat(e.split("calc").join(""));n=n.replace(e,r)}),n}function io(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;if(n.indexOf("var(")===-1)return n;var r=BC("(",")",n);function i(s){var u=s.split(",")[0].replace(/[\s\n\t]/g,""),o=(s.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],l=Object.prototype.hasOwnProperty.call(t.variables,u)?String(t.variables[u]):void 0,d=l||(o?String(o):void 0),c=e||s;return l||t.onWarning('variable "'.concat(u,'" is undefined')),d&&d!=="undefined"&&d.length>0?io(d,t,c):"var(".concat(c,")")}if(r)if(r.pre.slice(-3)==="var"){var a=r.body.trim().length===0;return a?(t.onWarning("var() must contain a non-whitespace string"),n):r.pre.slice(0,-3)+i(r.body)+io(r.post,t)}else return r.pre+"(".concat(io(r.body,t),")")+io(r.post,t);else return n.indexOf("var(")!==-1&&t.onWarning('missing closing ")" in the value "'.concat(n,'"')),n}var Zd=typeof window<"u",xE=Zd&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),gs={group:0,job:0},Il={rootElement:Zd?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},Gi={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},Wt={dom:{},job:{},user:{}},Ql=!1,si=null,ao=0,ap=null,sp=!1;/**
 * Fetches, parses, and transforms CSS custom properties from specified
 * <style> and <link> elements into static values, then appends a new <style>
 * element with static values to the DOM to provide CSS custom property
 * compatibility for legacy browsers. Also provides a single interface for
 * live updates of runtime values in both modern and legacy browsers.
 *
 * @preserve
 * @param {object}   [options] Options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes
 * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
 *                   and <style> nodes will be processed.
 * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
 *                   matching <link re="stylesheet"> and <style> nodes to
 *                   process
 * @param {string}   [options.exclude] CSS selector matching <link
 *                   rel="stylehseet"> and <style> nodes to exclude from those
 *                   matches by options.include
 * @param {object}   [options.variables] A map of custom property name/value
 *                   pairs. Property names can omit or include the leading
 *                   double-hyphen (—), and values specified will override
 *                   previous values
 * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
 *                   only generate legacy-compatible CSS in browsers that lack
 *                   native support (i.e., legacy browsers)
 * @param {boolean}  [options.preserveStatic=true] Determines if CSS
 *                   declarations that do not reference a custom property will
 *                   be preserved in the transformed CSS
 * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
 *                   property declarations will be preserved in the transformed
 *                   CSS
 * @param {boolean}  [options.silent=false] Determines if warning and error
 *                   messages will be displayed on the console
 * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
 *                   update the DOM after processing CSS custom properties
 * @param {boolean}  [options.updateURLs=true] Determines if relative url()
 *                   paths will be converted to absolute urls in external CSS
 * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
 *                   be created that will execute the ponyfill when a <link> or
 *                   <style> DOM mutation is observed
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments
 * @param {function} [options.onError] Callback after a CSS parsing error has
 *                   occurred or an XHR request has failed. Passes 1) an error
 *                   message, and 2) source node reference, 3) xhr, and 4 url as
 *                   arguments.
 * @param {function} [options.onWarning] Callback after each CSS parsing warning
 *                   has occurred. Passes 1) a warning message as an argument.
 * @param {function} [options.onSuccess] Callback after CSS data has been
 *                   collected from each node and before CSS custom properties
 *                   have been transformed. Allows modifying the CSS data before
 *                   it is transformed by returning any string value (or false
 *                   to skip). Passes 1) CSS text, 2) source node reference, and
 *                   3) the source URL as arguments.
 * @param {function} [options.onComplete] Callback after all CSS has been
 *                   processed, legacy-compatible CSS has been generated, and
 *                   (optionally) the DOM has been updated. Passes 1) a CSS
 *                   string with CSS variable values resolved, 2) an array of
 *                   output <style> node references that have been appended to
 *                   the DOM, 3) an object containing all custom properies names
 *                   and values, and 4) the ponyfill execution time in
 *                   milliseconds.
 * @param {function} [options.onFinally] Callback in modern and legacy browsers
 *                   after the ponyfill has finished all tasks. Passes 1) a
 *                   boolean indicating if the last ponyfill call resulted in a
 *                   style change, 2) a boolean indicating if the current
 *                   browser provides native support for CSS custom properties,
 *                   and 3) the ponyfill execution time in milliseconds.
 * @example
 *
 *   cssVars({
 *     rootElement   : document,
 *     shadowDOM     : false,
 *     include       : 'style,link[rel="stylesheet"]',
 *     exclude       : '',
 *     variables     : {},
 *     onlyLegacy    : true,
 *     preserveStatic: true,
 *     preserveVars  : false,
 *     silent        : false,
 *     updateDOM     : true,
 *     updateURLs    : true,
 *     watch         : false,
 *     onBeforeSend(xhr, node, url) {},
 *     onError(message, node, xhr, url) {},
 *     onWarning(message) {},
 *     onSuccess(cssText, node, url) {},
 *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
 *     onFinally(hasChanged, hasNativeSupport, benchmark)
 *   });
 */function _a(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t="cssVars(): ",e=jr({},Il,n);function r(d,c,f,h){!e.silent&&window.console&&console.error("".concat(t).concat(d,`
`),c),e.onError(d,c,f,h)}function i(d){!e.silent&&window.console&&console.warn("".concat(t).concat(d)),e.onWarning(d)}function a(d){e.onFinally(!!d,xE,Zc()-e.__benchmark)}if(Zd){if(e.watch){e.watch=Il.watch,DR(e),_a(e);return}else e.watch===!1&&si&&(si.disconnect(),si=null);if(!e.__benchmark){if(Ql===e.rootElement){LR(n);return}var s=[].slice.call(e.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(e.__benchmark=Zc(),e.exclude=[si?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",e.exclude].filter(function(d){return d}).join(","),e.variables=xR(e.variables),s.forEach(function(d){var c=d.nodeName.toLowerCase()==="style"&&d.__cssVars.text,f=c&&d.textContent!==d.__cssVars.text;c&&f&&(d.sheet&&(d.sheet.disabled=!1),d.setAttribute("data-cssvars",""))}),!si){var u=[].slice.call(e.rootElement.querySelectorAll('[data-cssvars="out"]'));u.forEach(function(d){var c=d.getAttribute("data-cssvars-group"),f=c?e.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(c,'"]')):null;f||d.parentNode.removeChild(d)}),ao&&s.length<ao&&(ao=s.length,Wt.dom={})}}if(document.readyState!=="loading")if(xE&&e.onlyLegacy){var o=!1;if(e.updateDOM){var l=e.rootElement.host||(e.rootElement===document?document.documentElement:e.rootElement);Object.keys(e.variables).forEach(function(d){var c=e.variables[d];o=o||c!==getComputedStyle(l).getPropertyValue(d),l.style.setProperty(d,c)})}a(o)}else!sp&&(e.shadowDOM||e.rootElement.shadowRoot||e.rootElement.host)?LE({rootElement:Il.rootElement,include:Il.include,exclude:e.exclude,skipDisabled:!1,onSuccess:function(c,f,h){var m=(f.sheet||{}).disabled&&!f.__cssVars;return m?!1:(c=c.replace(Gi.cssComments,"").replace(Gi.cssMediaQueries,""),c=(c.match(Gi.cssVarDeclRules)||[]).join(""),c||!1)},onComplete:function(c,f,h){kE(c,{store:Wt.dom,onWarning:i}),sp=!0,_a(e)}}):(Ql=e.rootElement,LE({rootElement:e.rootElement,include:e.include,exclude:e.exclude,skipDisabled:!1,onBeforeSend:e.onBeforeSend,onError:function(c,f,h){var m=c.responseURL||zC(h,location.href),_=c.statusText?"(".concat(c.statusText,")"):"Unspecified Error"+(c.status===0?" (possibly CORS related)":""),E="CSS XHR Error: ".concat(m," ").concat(c.status," ").concat(_);r(E,f,c,m)},onSuccess:function(c,f,h){var m=(f.sheet||{}).disabled&&!f.__cssVars;if(m)return!1;var _=f.nodeName.toLowerCase()==="link",E=f.nodeName.toLowerCase()==="style"&&c!==f.textContent,b=e.onSuccess(c,f,h);return c=b!==void 0&&!b?"":b||c,e.updateURLs&&(_||E)&&(c=kR(c,h)),c},onComplete:function(c,f){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],m=jr({},Wt.dom,Wt.user),_=!1;if(Wt.job={},h.forEach(function(T,M){var O=f[M];if(T.__cssVars=T.__cssVars||{},T.__cssVars.text=O,Gi.cssVars.test(O))try{var R=Qp(O,{preserveStatic:e.preserveStatic,removeComments:!0});kE(R,{parseHost:!!e.rootElement.host,store:Wt.dom,onWarning:i}),T.__cssVars.tree=R}catch(U){r(U.message,T)}}),jr(Wt.job,Wt.dom),e.updateDOM?(jr(Wt.user,e.variables),jr(Wt.job,Wt.user)):(jr(Wt.job,Wt.user,e.variables),jr(m,e.variables)),_=gs.job>0&&!!(Object.keys(Wt.job).length>Object.keys(m).length||Object.keys(m).length&&Object.keys(Wt.job).some(function(T){return Wt.job[T]!==m[T]})),_)up(e.rootElement),_a(e);else{var E=[],b=[],g=!1;if(e.updateDOM&&gs.job++,h.forEach(function(T,M){var O=!T.__cssVars.tree;if(T.__cssVars.tree)try{OR(T.__cssVars.tree,jr({},e,{variables:Wt.job,onWarning:i}));var R=jC(T.__cssVars.tree);if(e.updateDOM){var U=f[M],P=Gi.cssVarFunc.test(U);if(T.getAttribute("data-cssvars")||T.setAttribute("data-cssvars","src"),R.length&&P){var L=T.getAttribute("data-cssvars-group")||++gs.group,F=R.replace(/\s/g,""),B=e.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(L,'"]'))||document.createElement("style");g=g||Gi.cssKeyframes.test(R),e.preserveStatic&&T.sheet&&(T.sheet.disabled=!0),B.hasAttribute("data-cssvars")||B.setAttribute("data-cssvars","out"),F===T.textContent.replace(/\s/g,"")?(O=!0,B&&B.parentNode&&(T.removeAttribute("data-cssvars-group"),B.parentNode.removeChild(B))):F!==B.textContent.replace(/\s/g,"")&&([T,B].forEach(function(V){V.setAttribute("data-cssvars-job",gs.job),V.setAttribute("data-cssvars-group",L)}),B.textContent=R,E.push(R),b.push(B),B.parentNode||T.parentNode.insertBefore(B,T.nextSibling))}}else T.textContent.replace(/\s/g,"")!==R&&E.push(R)}catch(V){r(V.message,T)}O&&T.setAttribute("data-cssvars","skip"),T.hasAttribute("data-cssvars-job")||T.setAttribute("data-cssvars-job",gs.job)}),ao=e.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,e.shadowDOM){for(var C=[].concat(e.rootElement).concat([].slice.call(e.rootElement.querySelectorAll("*"))),S=0,A;A=C[S];++S)if(A.shadowRoot&&A.shadowRoot.querySelector("style")){var I=jr({},e,{rootElement:A.shadowRoot});_a(I)}}e.updateDOM&&g&&UR(e.rootElement),Ql=!1,e.onComplete(E.join(""),b,JSON.parse(JSON.stringify(Wt.job)),Zc()-e.__benchmark),a(b.length)}}}));else document.addEventListener("DOMContentLoaded",function d(c){_a(n),document.removeEventListener("DOMContentLoaded",d)})}}_a.reset=function(){gs.job=0,gs.group=0,Ql=!1,si&&(si.disconnect(),si=null),ao=0,ap=null,sp=!1;for(var n in Wt)Wt[n]={}};function DR(n){function t(o){var l=e(o)&&o.hasAttribute("disabled"),d=(o.sheet||{}).disabled;return l||d}function e(o){var l=o.nodeName.toLowerCase()==="link"&&(o.getAttribute("rel")||"").indexOf("stylesheet")!==-1;return l}function r(o){return o.nodeName.toLowerCase()==="style"}function i(o){var l=!1;if(o.type==="attributes"&&e(o.target)&&!t(o.target)){var d=o.attributeName==="disabled",c=o.attributeName==="href",f=o.target.getAttribute("data-cssvars")==="skip",h=o.target.getAttribute("data-cssvars")==="src";d?l=!f&&!h:c&&(f?o.target.setAttribute("data-cssvars",""):h&&up(n.rootElement,!0),l=!0)}return l}function a(o){var l=!1;if(o.type==="childList"){var d=r(o.target),c=o.target.getAttribute("data-cssvars")==="out";l=d&&!c}return l}function s(o){var l=!1;return o.type==="childList"&&(l=[].slice.call(o.addedNodes).some(function(d){var c=d.nodeType===1,f=c&&d.hasAttribute("data-cssvars"),h=r(d)&&Gi.cssVars.test(d.textContent),m=!f&&(e(d)||h);return m&&!t(d)})),l}function u(o){var l=!1;return o.type==="childList"&&(l=[].slice.call(o.removedNodes).some(function(d){var c=d.nodeType===1,f=c&&d.getAttribute("data-cssvars")==="out",h=c&&d.getAttribute("data-cssvars")==="src",m=h;if(h||f){var _=d.getAttribute("data-cssvars-group"),E=n.rootElement.querySelector('[data-cssvars-group="'.concat(_,'"]'));h&&up(n.rootElement,!0),E&&E.parentNode.removeChild(E)}return m})),l}window.MutationObserver&&(si&&(si.disconnect(),si=null),si=new MutationObserver(function(o){var l=o.some(function(d){return i(d)||a(d)||s(d)||u(d)});l&&_a(n)}),si.observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function LR(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;clearTimeout(ap),ap=setTimeout(function(){n.__benchmark=null,_a(n)},t)}function UR(n){var t=["animation-name","-moz-animation-name","-webkit-animation-name"].filter(function(f){return getComputedStyle(document.body)[f]})[0];if(t){for(var e=[].slice.call(n.querySelectorAll("*")),r=[],i="__CSSVARSPONYFILL-KEYFRAMES__",a=0,s=e.length;a<s;a++){var u=e[a],o=getComputedStyle(u)[t];o!=="none"&&(u.style[t]+=i,r.push(u))}document.body.offsetHeight;for(var l=0,d=r.length;l<d;l++){var c=r[l].style;c[t]=c[t].replace(i,"")}}}function kR(n,t){var e=n.replace(Gi.cssComments,"").match(Gi.cssUrls)||[];return e.forEach(function(r){var i=r.replace(Gi.cssUrls,"$1"),a=zC(i,t);n=n.replace(r,r.replace(i,a))}),n}function xR(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=/^-{2}/;return Object.keys(n).reduce(function(e,r){var i=t.test(r)?r:"--".concat(r.replace(/^-+/,""));return e[i]=n[r],e},{})}function zC(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:location.href,e=document.implementation.createHTMLDocument(""),r=e.createElement("base"),i=e.createElement("a");return e.head.appendChild(r),e.body.appendChild(i),r.href=t,i.href=n,i.href}function Zc(){return Zd&&(window.performance||{}).now?window.performance.now():new Date().getTime()}function up(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=[].slice.call(n.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));e.forEach(function(r){return r.setAttribute("data-cssvars","")}),t&&(Wt.dom={})}var vi=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,e=n==="x"?t:t&3|8;return e.toString(16)})},PR=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._channels=new Map,e._enteredChannelUrls=[],e}return w(t,n),Object.defineProperty(t.prototype,"enteredChannels",{get:function(){var e=this;return this._enteredChannelUrls.map(function(r){return e._channels.get(r)}).filter(function(r){return!!r})},enumerable:!1,configurable:!0}),t.prototype.isEnteredChannel=function(e){return this._enteredChannelUrls.includes(e)},t.prototype.enter=function(e){this._enteredChannelUrls.indexOf(e)<0&&this._enteredChannelUrls.push(e)},t.prototype.exit=function(e){var r=this._enteredChannelUrls.indexOf(e);r>=0&&this._enteredChannelUrls.splice(r,1)},t.prototype.exitAll=function(){this._enteredChannelUrls=[]},t.prototype.get=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2,this._channels.get(e)]})})},t.prototype.upsert=function(e){return y(this,void 0,void 0,function(){var r,i=this;return v(this,function(a){return r=[],e.forEach(function(s){if(i._channels.has(s.url)){var u=i._channels.get(s.url);Object.assign(u,s),r.push(u)}else i._channels.set(s.url,s),r.push(s)}),[2,r]})})},t.prototype.remove=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return this._channels.delete(e),this.exit(e),[2]})})},t.prototype.clear=function(){return y(this,void 0,void 0,function(){return v(this,function(e){return this._channels.clear(),this._enteredChannelUrls=[],[2]})})},t}(Vt),KC={channelUrl:void 0,name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,isEphemeral:void 0},FR=function(n){function t(e){var r=e.channelUrl,i=e.isInternalCall,a=n.call(this)||this;return a.method=J.GET,a.path="".concat(i?uT:Gs,"/").concat(encodeURIComponent(r)),a.params={show_pinned_messages:!0},a}return w(t,n),t}(ee),PE=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Cu(e,r),i}return w(t,n),t}(ie),HR=function(n){function t(e){var r=this,i=e.channelUrl,a=e.coverUrlOrImage,s=e.name,u=e.data,o=e.customType,l=e.operatorUserIds,d=e.isEphemeral;return(r=n.call(this)||this).method=J.POST,r.path=Gs,r.params=ge(Re({channel_url:i,cover_url:x("string",a)?a:null,cover_file:Zt(a)?a:null,name:s,data:u,custom_type:o,operators:l,is_ephemeral:d})),r}return w(t,n),t}(ee);(function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Cu(e,r),i}w(t,n)})(ie);var BR=function(n){function t(e){var r=e.channelUrl;return n.call(this,{code:"ENTR",payload:{channel_url:r},ackRequired:!0})||this}return w(t,n),t}(or),$C=function(n){function t(e,r,i){var a,s,u=this;return u=n.call(this,e,"SYEV",i)||this,i.data&&(u.participantCount=(a=i.data.participant_count)!==null&&a!==void 0?a:0,u.user=new Mn(e,i.data),u.ts=(s=i.data.edge_ts)!==null&&s!==void 0?s:0),u}return w(t,n),t}(Na),GR=function(n){function t(e){var r=e.channelUrl;return n.call(this,{code:"EXIT",payload:{channel_url:r},ackRequired:!0})||this}return w(t,n),t}(or),WC=function(n){function t(e,r,i){var a,s,u=this;return u=n.call(this,e,"EXIT",i)||this,i.data&&(u.participantCount=(a=i.data.participant_count)!==null&&a!==void 0?a:0,u.user=new Mn(e,i.data),u.ts=(s=i.data.edge_ts)!==null&&s!==void 0?s:0),u}return w(t,n),t}(Na),Jc={},Ti=function(n){function t(e,r){var i=n.call(this,e,D(D({},r),{channelType:wn.OPEN}))||this;return i.subscribeChannelEvent=tn,i.unsubscribeChannelEvent=tn,i.refreshChannel=function(){return y(i,void 0,void 0,function(){return v(this,function(a){return[2,tn()]})})},i._openChannelCache=new PR(e),i._openChannelHandlers=new Map,i._dispatcher.on(function(a){var s,u;if(a instanceof ft)i._handleEvent(a).catch(function(c){if(gr(c)&&i._sdkState.appState==="foreground")throw c});else if(a instanceof Kr&&a.stateType===Wn.CONNECTED){var o=i._openChannelCache.enteredChannels;try{for(var l=oe(o),d=l.next();!d.done;d=l.next())d.value.enter()}catch(c){s={error:c}}finally{try{d&&!d.done&&(u=l.return)&&u.call(l)}finally{if(s)throw s.error}}}}),Jc[e]||(Jc[e]=i),i}return w(t,n),t.of=function(e){return Jc[e]},t.prototype.buildOpenChannelFromSerializedData=function(e){var r=$a(e);return new Cu(this._iid,Cu.payloadify(r))},t.prototype.getChannelFromCache=function(e){var r;return y(this,void 0,void 0,function(){return v(this,function(i){switch(i.label){case 0:return[4,this._openChannelCache.get(e)];case 1:return[2,(r=i.sent())!==null&&r!==void 0?r:null]}})})},t.prototype.upsertChannelsToCache=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){switch(r.label){case 0:return[4,this._openChannelCache.upsert(e)];case 1:return[2,r.sent()]}})})},t.prototype.removeChannelsFromCache=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o;return v(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),r=oe(e),i=r.next(),l.label=1;case 1:return i.done?[3,4]:(a=i.value,[4,this._openChannelCache.remove(a)]);case 2:l.sent(),l.label=3;case 3:return i=r.next(),[3,1];case 4:return[3,7];case 5:return s=l.sent(),u={error:s},[3,7];case 6:try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(u)throw u.error}return[7];case 7:return[2]}})})},t.prototype.setEnteredToCache=function(e){this._openChannelCache.enter(e.url)},t.prototype.setExitedToCache=function(e){this._openChannelCache.exit(e.url)},Object.defineProperty(t.prototype,"handlers",{get:function(){return Be([],we(this._openChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),t.prototype._handleEvent=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R,U,P,L,F,B,V,K,$,q,se,Y,ce,X,Se,te,be,xe,Pe,vn,on,je,Xe,sn,un,En,rn,qe,Je,ln,dn,ve,De,Ye,en,fn,Fe,Nn,nn,_e,zn,Rn,bn,Ge,cn,On,Ln,In,et,Gn,Cn,mn=this;return v(this,function(ze){switch(ze.label){case 0:switch(ze.trys.push([0,59,,60]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"MRCT":return[3,10];case"MTHD":return[3,13];case"MCNT":return[3,16];case"PEDI":return[3,27];case"VOTE":return[3,30];case"SYEV":return[3,33]}return[3,58];case 1:return s=null,e.code==="MESG"?s=e.as(Pp):e.code==="FILE"?s=e.as(Dp):e.code!=="ADMM"&&e.code!="BRDM"||(s=e.as(eC)),s?(r=s.message,i=s.isMentioned,r.channelType!==wn.OPEN?[3,3]:[4,this.getChannel(r.channelUrl,!0)]):[3,3];case 2:a=ze.sent(),Ae(function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())Te=Q.value,this._openChannelCache.isEnteredChannel(a.url)&&(Te.onMessageReceived&&Te.onMessageReceived(a,r),i&&Te.onMentionReceived&&Te.onMentionReceived(a,r))}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),ze.label=3;case 3:return[3,58];case 4:return s=null,e.code==="MEDI"?s=e.as(_d):e.code==="FEDI"?s=e.as(gd):e.code==="AEDI"&&(s=e.as(nC)),s?(u=s.message,o=s.mentionCountChange,u.channelType!==wn.OPEN?[3,6]:[4,this.getChannel(u.channelUrl,!0)]):[3,6];case 5:l=ze.sent(),d=!1,l.lastPinnedMessage&&l.lastPinnedMessage.messageId===u.messageId&&l.lastPinnedMessage.updatedAt<u.updatedAt&&(l.lastPinnedMessage=u,d=!0),Ae(function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e,Ee,fe;return v(this,function(We){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())Te=Q.value,this._openChannelCache.isEnteredChannel(l.url)&&(d&&((Ee=Te.onPinnedMessageUpdated)===null||Ee===void 0||Ee.call(Te,l),(fe=Te.onChannelChanged)===null||fe===void 0||fe.call(Te,l)),Te.onMessageUpdated&&Te.onMessageUpdated(l,u),o>0&&Te.onMentionReceived&&Te.onMentionReceived(l,u))}catch(yn){He={error:yn}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),ze.label=6;case 6:return[3,58];case 7:return c=e.as(Iy),$=c.channelUrl,q=c.channelType,f=c.messageId,q!==wn.OPEN?[3,9]:[4,this.getChannel($,!0)];case 8:h=ze.sent(),Ae(function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())Te=Q.value,this._openChannelCache.isEnteredChannel(h.url)&&Te.onMessageDeleted&&Te.onMessageDeleted(h,f)}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),ze.label=9;case 9:return[3,58];case 10:return m=e.as(tC),$=m.channelUrl,q=m.channelType,_=m.event,q!==wn.OPEN?[3,12]:[4,this.getChannel($,!0)];case 11:E=ze.sent(),Ae(function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())Te=Q.value,this._openChannelCache.isEnteredChannel(E.url)&&Te.onReactionUpdated&&Te.onReactionUpdated(E,_)}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),ze.label=12;case 12:return[3,58];case 13:return(b=e.as(rC).event).channelType!==wn.OPEN?[3,15]:[4,this.getChannel(b.channelUrl,!0)];case 14:g=ze.sent(),Ae(function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())Te=Q.value,this._openChannelCache.isEnteredChannel(g.url)&&Te.onThreadInfoUpdated&&Te.onThreadInfoUpdated(g,b)}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),ze.label=15;case 15:return[3,58];case 16:C=e.as(iC).openChannelMemberCounts,S=[],ze.label=17;case 17:ze.trys.push([17,22,23,24]),A=oe(C),I=A.next(),ze.label=18;case 18:return I.done?[3,21]:(T=I.value,$=T.channelUrl,Pe=T.participantCount,M=T.updatedAt,[4,this.getChannelFromCache($)]);case 19:(O=ze.sent())&&O._updateParticipantCount(Pe,M)&&S.push(O),ze.label=20;case 20:return I=A.next(),[3,18];case 21:return[3,24];case 22:return R=ze.sent(),Gn={error:R},[3,24];case 23:try{I&&!I.done&&(Cn=A.return)&&Cn.call(A)}finally{if(Gn)throw Gn.error}return[7];case 24:return S.length>0?[4,this.upsertChannelsToCache(S)]:[3,26];case 25:U=ze.sent(),Ae(function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())(Te=Q.value).onChannelMemberCountChanged&&Te.onChannelMemberCountChanged(U)}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),ze.label=26;case 26:return[3,58];case 27:return P=e.as(aC),L=P.event,F=P.status,$=P.channelUrl,q=P.channelType,$&&q===wn.OPEN?[4,this.getChannel($,!0)]:[3,29];case 28:B=ze.sent(),this._dispatcher.dispatch(new Op({event:L,source:W.EVENT_POLL_UPDATED})),Ae(F===ob?function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())(Te=Q.value).onPollDeleted&&Te.onPollDeleted(B,L.pollId)}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}:function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())(Te=Q.value).onPollUpdated&&Te.onPollUpdated(B,L)}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),ze.label=29;case 29:return[3,58];case 30:return V=e.as(Fp),K=V.event,$=V.channelUrl,q=V.channelType,$&&q===wn.OPEN?[4,this.getChannel($,!0)]:[3,32];case 31:se=ze.sent(),this._dispatcher.dispatch(new $d({event:K,source:W.EVENT_POLL_VOTED})),Ae(function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())(Te=Q.value).onPollVoted&&Te.onPollVoted(se,K)}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),ze.label=32;case 32:return[3,58];case 33:if(!(Y=e.as(Na).event).isOpenChannelEvent)return[3,57];switch(Y.category){case Xn.CHANNEL_ENTER:return[3,34];case Xn.CHANNEL_EXIT:return[3,36];case Xn.CHANNEL_OPERATOR_UPDATE:return[3,38];case Xn.USER_CHANNEL_MUTE:case Xn.USER_CHANNEL_UNMUTE:return[3,40];case Xn.USER_CHANNEL_BAN:case Xn.USER_CHANNEL_UNBAN:return[3,42];case Xn.CHANNEL_FREEZE:case Xn.CHANNEL_UNFREEZE:return[3,44];case Xn.CHANNEL_DELETED:return[3,46];case Xn.CHANNEL_PROP_CHANGED:return[3,49];case Xn.CHANNEL_META_DATA_CHANGED:return[3,51];case Xn.CHANNEL_META_COUNTERS_CHANGED:return[3,53];case Xn.PINNED_MESSAGE_CHANGED:return[3,55]}return[3,57];case 34:return[4,this.getChannel(Y.channelUrl,!0)];case 35:return ce=ze.sent(),X=e.as($C),Pe=X.participantCount,Se=X.user,te=ce._updateParticipantCount(Pe,Y.ts),Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){Q.onUserEntered&&Q.onUserEntered(ce,Se),te&&Q.onChannelParticipantCountChanged&&Q.onChannelParticipantCountChanged(ce)}),[2]})})}),[3,57];case 36:return[4,this.getChannel(Y.channelUrl,!0)];case 37:return be=ze.sent(),xe=e.as(WC),Pe=xe.participantCount,vn=xe.user,on=be._updateParticipantCount(Pe,Y.ts),Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){Q.onUserExited&&Q.onUserExited(be,vn),on&&Q.onChannelParticipantCountChanged&&Q.onChannelParticipantCountChanged(be)}),[2]})})}),[3,57];case 38:return[4,this.getChannel(Y.channelUrl,!0)];case 39:return je=ze.sent(),Xe=e.as(Xb).operators,je.operators=Xe,this.upsertChannelsToCache([je]),Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){Q.onOperatorUpdated&&Q.onOperatorUpdated(je,Xe)}),[2]})})}),[3,57];case 40:return[4,this.getChannel(Y.channelUrl,!0)];case 41:return sn=ze.sent(),un=Y.category===Xn.USER_CHANNEL_MUTE,En=e.as(un?wb:Ob).user,Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){un?Q.onUserMuted&&Q.onUserMuted(sn,En):Q.onUserUnmuted&&Q.onUserUnmuted(sn,En)}),[2]})})}),[3,57];case 42:return[4,this.getChannel(Y.channelUrl,!0)];case 43:return rn=ze.sent(),qe=Y.category===Xn.USER_CHANNEL_BAN,Je=e.as(qe?Rb:Db).user,Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){qe?Q.onUserBanned&&Q.onUserBanned(rn,Je):Q.onUserUnbanned&&Q.onUserUnbanned(rn,Je)}),[2]})})}),[3,57];case 44:return[4,this.getChannel(Y.channelUrl,!0)];case 45:return ln=ze.sent(),dn=e.as(Lb).freeze,ln.isFrozen=dn,this.upsertChannelsToCache([ln]),Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){dn?Q.onChannelFrozen&&Q.onChannelFrozen(ln):Q.onChannelUnfrozen&&Q.onChannelUnfrozen(ln)}),[2]})})}),[3,57];case 46:return[4,this.getChannel(Y.channelUrl,!0)];case 47:return ve=ze.sent(),[4,this.removeChannelsFromCache([ve.url])];case 48:return ze.sent(),Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){Q.onChannelDeleted&&Q.onChannelDeleted(ve.url,ve.channelType)}),[2]})})}),[3,57];case 49:return[4,this.getChannelWithoutCache(Y.channelUrl,!0)];case 50:return De=ze.sent(),Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){Q.onChannelChanged&&Q.onChannelChanged(De)}),[2]})})}),[3,57];case 51:return[4,this.getChannel(Y.channelUrl,!0)];case 52:return Ye=ze.sent(),en=e.as(Ab),fn=en.created,Fe=en.updated,Nn=en.deleted,fn&&Ye._upsertCachedMetaData(fn,Y.ts),Fe&&Ye._upsertCachedMetaData(Fe,Y.ts),Nn&&Ye._removeFromCachedMetaData(Nn,Y.ts),Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){fn&&Q.onMetaDataCreated&&Q.onMetaDataCreated(Ye,fn),Fe&&Q.onMetaDataUpdated&&Q.onMetaDataUpdated(Ye,Fe),Nn&&Q.onMetaDataDeleted&&Q.onMetaDataDeleted(Ye,Nn)}),[2]})})}),[3,57];case 53:return[4,this.getChannel(Y.channelUrl,!0)];case 54:return nn=ze.sent(),_e=e.as(Mb),zn=_e.created,Rn=_e.updated,bn=_e.deleted,Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){zn&&Q.onMetaCounterCreated&&Q.onMetaCounterCreated(nn,zn),Rn&&Q.onMetaCounterUpdated&&Q.onMetaCounterUpdated(nn,Rn),bn&&Q.onMetaCounterDeleted&&Q.onMetaCounterDeleted(nn,bn)}),[2]})})}),[3,57];case 55:return[4,this.getChannel(Y.channelUrl,!0)];case 56:return Ge=ze.sent(),cn=e.as(Zb),On=cn.pinnedMessageIds,Ln=cn.latestPinnedMessage,(In=cn.ts)>Ge._pinnedMessagesUpdatedAt&&(Ge.pinnedMessageIds=On,Ge.lastPinnedMessage=Ln,Ge._pinnedMessagesUpdatedAt=In,this.upsertChannelsToCache([Ge]),Ae(function(){return y(mn,void 0,void 0,function(){var ue,Q,Te,He,$e;return v(this,function(Ee){try{for(ue=oe(this._openChannelHandlers.values()),Q=ue.next();!Q.done;Q=ue.next())(Te=Q.value).onChannelChanged&&Te.onChannelChanged(Ge)}catch(fe){He={error:fe}}finally{try{Q&&!Q.done&&($e=ue.return)&&$e.call(ue)}finally{if(He)throw He.error}}return[2]})})}),Ae(function(){return y(mn,void 0,void 0,function(){return v(this,function(ue){return this._openChannelHandlers.forEach(function(Q){Q.onPinnedMessageUpdated&&Q.onPinnedMessageUpdated(Ge)}),[2]})})})),[3,57];case 57:return[3,58];case 58:return[3,60];case 59:if(et=ze.sent(),gr(et))throw et;return[3,60];case 60:return[2]}})})},t.prototype.addHandler=function(e,r){this._openChannelHandlers.set(e,r)},t.prototype.removeHandler=function(e){this._openChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._openChannelHandlers.clear()},t.prototype.getChannel=function(e,r){return r===void 0&&(r=!1),y(this,void 0,void 0,function(){var i;return v(this,function(a){switch(a.label){case 0:ne(x("string",e)).throw(H.invalidParameters),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(i=a.sent())?[2,i]:[3,4];case 3:return a.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,r)];case 5:return[2,a.sent()]}})})},t.prototype.getChannelWithoutCache=function(e,r){return r===void 0&&(r=!1),y(this,void 0,void 0,function(){var i,a,s;return v(this,function(u){switch(u.label){case 0:return ne(x("string",e)).throw(H.invalidParameters),i=new FR({channelUrl:e,isInternalCall:r}),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),s=a.as(PE).channel,[4,this.upsertChannelsToCache([s])];case 2:return[2,u.sent()[0]]}})})},t.prototype.createChannel=function(e){return y(this,void 0,void 0,function(){var r,i,a,s;return v(this,function(u){switch(u.label){case 0:return r=D(D({},KC),e),ne(function(o){return gn("string",o.operatorUserIds,!0)&&(x("string",o.coverUrlOrImage,!0)||Zt(o.coverUrlOrImage,!0))&&x("string",o.name,!0)&&x("string",o.data,!0)&&x("string",o.customType,!0)&&(x("string",o.channelUrl)&&/^\w+$/.test(o.channelUrl)||o.channelUrl===null||o.channelUrl===void 0)&&x("boolean",o.isEphemeral,!0)}(r)).throw(H.invalidParameters),i=new HR(r),[4,this._requestQueue.send(i)];case 1:return a=u.sent(),s=a.as(PE).channel,this.upsertChannelsToCache([s]),[2,s]}})})},t}(Jb),FE={name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0},VR=function(n){function t(e){var r=this,i=e.channelUrl,a=e.token,s=e.limit;return(r=n.call(this)||this).method=J.GET,r.path="".concat(Gs,"/").concat(encodeURIComponent(i),"/participants"),r.params={token:a,limit:s},r}return w(t,n),t}(ee),jR=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.participants=[];var a=r.next,s=r.participants;return i.token=a,i.participants=s.map(function(u){return new DN(e,u)}),i}return w(t,n),t}(ie),qR=function(n){function t(e,r,i){return n.call(this,e,r,wn.OPEN,i)||this}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new VR(D(D({},this),{token:this._token})),[4,e.send(r)]):[3,2]:[3,5];case 1:return i=o.sent(),a=i.as(jR),s=a.participants,u=a.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw H.queryInProgress;case 4:return[3,6];case 5:throw H.invalidParameters;case 6:return[2]}})})},t}(ta),zR=function(n){function t(e){var r=this,i=e.channelUrl,a=e.coverUrlOrImage,s=e.name,u=e.data,o=e.customType,l=e.operatorUserIds;return(r=n.call(this)||this).method=J.PUT,r.path="".concat(Gs,"/").concat(encodeURIComponent(i)),r.params=ge(Re({cover_url:x("string",a)?a:null,cover_file:Zt(a)?a:null,name:s,data:u,custom_type:o,operators:l})),r}return w(t,n),t}(ee),KR=function(n){function t(e,r){var i=n.call(this,e,r)||this;return i.channel=new Cu(e,r),i}return w(t,n),t}(ie),$R=function(n){function t(e){var r=this,i=e.channelUrl;return(r=n.call(this)||this).method=J.DELETE,r.path="".concat(Gs,"/").concat(encodeURIComponent(i)),r}return w(t,n),t}(ee);(function(n){function t(e,r){return n.call(this,e,r)||this}w(t,n)})(ie);var Cu=function(n){function t(e,r){var i,a=this;return(a=n.call(this,e,r)||this)._lastParticipantCountUpdated=0,a.participantCount=0,a.operators=[],a.lastPinnedMessage=null,a._pinnedMessagesUpdatedAt=0,a.channelType=wn.OPEN,a.participantCount=(i=r.participant_count)!==null&&i!==void 0?i:0,a.operators=Array.isArray(r.operators)?r.operators.map(function(s){return new Mn(e,s)}):[],a.lastPinnedMessage=r.latest_pinned_message?dr(a._iid,D({channel_type:a.channelType},r.latest_pinned_message)):null,a}return w(t,n),t.payloadify=function(e){return ge(Re(D(D({},Ed.payloadify(e)),{participant_count:e.participantCount,operators:e.operators.map(function(r){return Mn.payloadify(r)}),latest_pinned_message:e.lastPinnedMessage?Rf(e.lastPinnedMessage):null})))},t.prototype.serialize=function(){return Au(this)},t.prototype.isOperator=function(e){return e instanceof Mn?this.isOperator(e.userId):this.operators.some(function(r){return r.userId===e})},t.prototype._updateParticipantCount=function(e,r){return r>this._lastParticipantCountUpdated&&(this.participantCount=e,this._lastParticipantCountUpdated=r,!0)},t.prototype.createParticipantListQuery=function(e){return new qR(this._iid,this.url,e)},t.prototype.refresh=function(){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return[4,Ti.of(this._iid).getChannelWithoutCache(this.url)];case 1:return[2,e.sent()]}})})},t.prototype.enter=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return e=k.of(this._iid).requestQueue,r=new BR({channelUrl:this.url}),[4,e.send(r)];case 1:return i=o.sent(),a=i.as($C),s=a.participantCount,u=a.ts,this._updateParticipantCount(s,u),Ti.of(this._iid).setEnteredToCache(this),[2]}})})},t.prototype.exit=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return e=k.of(this._iid).requestQueue,r=new GR({channelUrl:this.url}),[4,e.send(r)];case 1:return i=o.sent(),a=i.as(WC),s=a.participantCount,u=a.ts,this._updateParticipantCount(s,u),Ti.of(this._iid).setExitedToCache(this),zt.of(this._iid).fileMessageQueue.cancel(this),[2]}})})},t.prototype.updateChannel=function(e){return y(this,void 0,void 0,function(){var r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return r=D(D({},FE),e),ne(function(l){return gn("string",l.operatorUserIds,!0)&&(x("string",l.coverUrlOrImage,!0)||Zt(l.coverUrlOrImage,!0))&&x("string",l.name,!0)&&x("string",l.data,!0)&&x("string",l.customType,!0)}(r)).throw(H.invalidParameters),i=k.of(this._iid).requestQueue,a=new zR(D({channelUrl:this.url},r)),[4,i.send(a)];case 1:return s=o.sent(),u=s.as(KR).channel,this._update(u),[4,Ti.of(this._iid).upsertChannelsToCache([u])];case 2:return o.sent(),[2,this]}})})},t.prototype.updateChannelWithOperatorUserIds=function(e,r,i,a,s){return y(this,void 0,void 0,function(){var u;return v(this,function(o){return u=D(D({},FE),{name:e,coverUrlOrImage:r,data:i,operatorUserIds:a,customType:s}),[2,this.updateChannel(u)]})})},t.prototype.delete=function(){return y(this,void 0,void 0,function(){var e,r;return v(this,function(i){switch(i.label){case 0:return e=k.of(this._iid).requestQueue,r=new $R({channelUrl:this.url}),[4,e.send(r)];case 1:return i.sent(),[4,Ti.of(this._iid).removeChannelsFromCache([this.url])];case 2:return i.sent(),[2]}})})},t.prototype.updateUserMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u=this;return v(this,function(o){switch(o.label){case 0:return[4,n.prototype.updateUserMessage.call(this,e,r)];case 1:return i=o.sent(),a=!1,s=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,a=!0,s=!0),a&&Ti.of(this._iid).handlers.map(function(l){l.onChannelChanged&&l.onChannelChanged(u)}),s&&Ti.of(this._iid).handlers.map(function(l){l.onPinnedMessageUpdated&&l.onPinnedMessageUpdated(u)}),[2,i]}})})},t.prototype.updateFileMessage=function(e,r){return y(this,void 0,void 0,function(){var i,a,s,u=this;return v(this,function(o){switch(o.label){case 0:return[4,n.prototype.updateFileMessage.call(this,e,r)];case 1:return i=o.sent(),a=!1,s=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,a=!0,s=!0),a&&Ti.of(this._iid).handlers.map(function(l){l.onChannelChanged&&l.onChannelChanged(u)}),s&&Ti.of(this._iid).handlers.map(function(l){l.onPinnedMessageUpdated&&l.onPinnedMessageUpdated(u)}),[2,i]}})})},t}(Ed);(function(n){function t(e){e===void 0&&(e={});var r=n.call(this)||this;return Object.keys(e).forEach(function(i){r.hasOwnProperty(i)&&(r[i]=e[i])}),r}return w(t,n),t})(function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.onUserEntered=tn,e.onUserExited=tn,e.onChannelParticipantCountChanged=tn,e.onPollUpdated=tn,e.onPollVoted=tn,e.onPollDeleted=tn,e.onPinnedMessageUpdated=tn,e}return w(t,n),t}(dC));var WR=function(n){function t(e){var r=this,i=e.token,a=e.limit,s=e.nameKeyword,u=e.urlKeyword,o=e.customTypes,l=e.includeFrozen,d=e.includeMetaData;return(r=n.call(this)||this).method=J.GET,r.path=Gs,r.params=ge({token:i,limit:a,name_contains:s,url_contains:u,custom_types:o,show_frozen:l,show_metadata:d,show_pinned_messages:!0}),r}return w(t,n),t}(ee),YR=function(n){function t(e,r){var i=n.call(this,e,r)||this;i.channels=[];var a=r.next,s=r.channels,u=r.ts;return i.token=a,s&&s.length>0&&(i.channels=s.map(function(o){return new Cu(e,o)})),i.ts=typeof u=="number"?u:null,i}return w(t,n),t}(ie),QR=function(n){function t(e,r){var i,a,s,u,o,l=this;return(l=n.call(this,e,r)||this).includeFrozen=!0,l.includeMetaData=!0,l.nameKeyword=null,l.urlKeyword=null,l.customTypes=null,l.includeFrozen=(i=r.includeFrozen)===null||i===void 0||i,l.includeMetaData=(a=r.includeMetaData)===null||a===void 0||a,l.nameKeyword=(s=r.nameKeyword)!==null&&s!==void 0?s:null,l.urlKeyword=(u=r.urlKeyword)!==null&&u!==void 0?u:null,l.customTypes=(o=r.customTypes)!==null&&o!==void 0?o:null,l}return w(t,n),t.prototype._validate=function(){return n.prototype._validate.call(this)&&x("boolean",this.includeFrozen)&&x("boolean",this.includeMetaData)&&x("string",this.nameKeyword,!0)&&x("string",this.urlKeyword,!0)&&gn("string",this.customTypes,!0)},t.prototype.next=function(){return y(this,void 0,void 0,function(){var e,r,i,a,s,u;return v(this,function(o){switch(o.label){case 0:return this._validate()?this._isLoading?[3,4]:this._hasNext?(this._isLoading=!0,e=k.of(this._iid).requestQueue,r=new WR(Re(D(D({},this),{token:this._token}))),[4,e.send(r)]):[3,3]:[3,6];case 1:return i=o.sent(),a=i.as(YR),s=a.channels,u=a.token,this._token=u,this._hasNext=!!u,[4,Ti.of(this._iid).upsertChannelsToCache(s)];case 2:return o.sent(),this._isLoading=!1,[2,s];case 3:return[2,[]];case 4:throw H.queryInProgress;case 5:return[3,7];case 6:throw H.invalidParameters;case 7:return[2]}})})},t}(Sa),XR=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.name="openChannel",e}return w(t,n),t.prototype.init=function(e,r){var i=r.sdkState,a=r.dispatcher,s=r.sessionManager,u=r.requestQueue,o=r.logger,l=r.onlineDetector,d=r.cacheContext;n.prototype.init.call(this,e,{sdkState:i,dispatcher:a,sessionManager:s,requestQueue:u,logger:o,onlineDetector:l,cacheContext:d}),this._manager=new Ti(e,{sdkState:i,dispatcher:a,requestQueue:u,logger:o,cacheContext:d,sessionManager:s})},t.prototype.createOpenChannelListQuery=function(e){return e===void 0&&(e={}),new QR(this._iid,e)},t.prototype.addOpenChannelHandler=function(e,r){this._manager.addHandler(e,r)},t.prototype.removeOpenChannelHandler=function(e){this._manager.removeHandler(e)},t.prototype.removeAllOpenChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildOpenChannelFromSerializedData=function(e){return this._manager.buildOpenChannelFromSerializedData(e)},t.prototype.getChannel=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2,this._manager.getChannel(e)]})})},t.prototype.getChannelWithoutCache=function(e){return y(this,void 0,void 0,function(){return v(this,function(r){return[2,this._manager.getChannelWithoutCache(e)]})})},t.prototype.createChannel=function(e){return e===void 0&&(e={}),y(this,void 0,void 0,function(){return v(this,function(r){return[2,this._manager.createChannel(e)]})})},t.prototype.createChannelWithOperatorUserIds=function(e,r,i,a,s){return y(this,void 0,void 0,function(){var u;return v(this,function(o){return(u=D({},KC)).name=e,u.coverUrlOrImage=r,u.data=i,u.operatorUserIds=a,u.customType=s,[2,this._manager.createChannel(u)]})})},t}(Kd),ZR="No sendbird state value available. Make sure you are rendering `<SendbirdProvider>` at the top of your app.";function Hn(){var n=N.useContext(_C);if(!n)throw new Error(ZR);return n}var YC="INITIALIZE_AUDIO_UNIT",op="RESET_AUDIO_UNIT",QC="SET_CURRENT_PLAYER",XC="ON_VOICE_PLAYER_PLAY",ZC="ON_VOICE_PLAYER_PAUSE",JC="ON_CURRENT_TIME_UPDATE",wi={IDLE:"IDLE",PREPARING:"PREPARING",PLAYING:"PLAYING",PAUSED:"PAUSED",COMPLETED:"COMPLETED"},Es=function(){return{audioFile:null,playbackTime:0,duration:1e3,playingStatus:wi.IDLE}},JR={currentPlayer:null,currentGroupKey:"",audioStorage:{}};function eD(n,t){var e,r,i,a,s,u,o,l,d;switch(t.type){case YC:{var c=t.payload.groupKey,f=!((u=n.audioStorage)===null||u===void 0)&&u[c]?n.audioStorage[c]:Es();return f.playingStatus=wi.PREPARING,G(G({},n),{audioStorage:G(G({},n.audioStorage),(e={},e[c]=f,e))})}case op:{var c=t.payload.groupKey;return G(G({},n),{audioStorage:G(G({},n.audioStorage),(r={},r[c]=Es(),r))})}case QC:{var h=t.payload,m=h.audioPlayer,c=h.groupKey;return G(G({},n),{currentPlayer:m,currentGroupKey:c})}case XC:{var _=t.payload,c=_.groupKey,E=_.audioFile,f=!((o=n.audioStorage)===null||o===void 0)&&o[c]?n.audioStorage[c]:Es();return f.audioFile=E,f.playingStatus=wi.PLAYING,G(G({},n),{audioStorage:G(G({},n.audioStorage),(i={},i[c]=f,i))})}case ZC:{var b=t.payload,c=b.groupKey,g=b.duration,C=b.currentTime,f=!((l=n.audioStorage)===null||l===void 0)&&l[c]?n.audioStorage[c]:Es();return f.playingStatus=wi.PAUSED,g===C&&(f.playbackTime=0),G(G({},n),{audioStorage:G(G({},n.audioStorage),(a={},a[c]=f,a))})}case JC:{var c=t.payload.groupKey,S=n.currentPlayer,C=S.currentTime,g=S.duration,f=!((d=n.audioStorage)===null||d===void 0)&&d[c]?n.audioStorage[c]:Es();return f.playbackTime===f.duration&&f.playingStatus===wi.PAUSED?f.playbackTime=0:C>0&&g>0&&(f.playbackTime=C,f.duration=g),G(G({},n),{audioStorage:G(G({},n.audioStorage),(s={},s[c]=f,s))})}default:return n}}var nD=function(n,t){return n===void 0&&(n=""),t===void 0&&(t=""),"".concat(n,"-").concat(t)},HE=function(n){return Vp(navigator.userAgent)&&n.includes("m4a")?{name:Kw,mimeType:$w}:{name:Id,mimeType:Rs}},tD="ALL",ef=function(){},rD={currentGroupKey:"",currentPlayer:null,audioStorage:{}},e0=N.createContext({play:ef,pause:ef,stop:ef,voicePlayerStore:rD}),iD=function(n){var t=n.children,e=N.useReducer(eD,JR),r=e[0],i=e[1],a=r.currentGroupKey,s=r.currentPlayer,u=r.audioStorage,o=Hn().config,l=o.logger,d=function(h){h===void 0&&(h=""),a.includes(h)&&(l.info("VoicePlayer: Pause playing(by text)."),c(a))},c=function(h){s?h===a?(l.info("VoicePlayer: Pause playing(by group key)."),s.pause()):h===tD&&(l.info("VoicePlayer: Pause playing(all)."),s.pause()):l.warning("VoicePlayer: No currentPlayer to pause.")},f=function(h){var m=h.groupKey,_=h.audioFile,E=h.audioFileUrl,b=E===void 0?"":E,g=h.audioFileMimeType,C=g===void 0?Rs:g;m!==a&&c(a);var S=document.getElementById($l),A=document.getElementById(Yf);S&&A&&S.removeChild(A),l.info("VoicePlayer: Start getting audio file."),new Promise(function(I,T){var M;if(i({type:YC,payload:{groupKey:m}}),_){l.info("VoicePlayer: Use the audioFile instance."),I(_);return}var O=(M=u==null?void 0:u[m])===null||M===void 0?void 0:M.audioFile;if(O){l.info("VoicePlayer: Get from the audioStorage."),I(O);return}fetch(b).then(function(R){return R.blob()}).then(function(R){var U=new File([R],HE(C).name,{lastModified:new Date().getTime(),type:HE(C).mimeType});I(U),l.info("VoicePlayer: Get the audioFile from URL.")}).catch(T)}).then(function(I){var T,M=document.getElementById($l);l.info("VoicePlayer: Succeeded getting audio file.",{audioFile:I});var O=u[m]||Es(),R=new Audio((T=URL==null?void 0:URL.createObjectURL)===null||T===void 0?void 0:T.call(URL,I));R.id=Yf,R.currentTime=O.playbackTime,R.volume=1,R.loop=!1,R.onplaying=function(){l.info("VoicePlayer: OnPlaying event is called from audioPlayer",{groupKey:m,audioPlayer:R}),i({type:XC,payload:{groupKey:m,audioFile:I}})},R.onpause=function(){l.info("VoicePlayer: OnPause event is called from audioPlayer",{groupKey:m,audioPlayer:R}),i({type:ZC,payload:{groupKey:m,duration:R.duration,currentTime:R.currentTime}})},R.ontimeupdate=function(){i({type:JC,payload:{groupKey:m}})},R.onerror=function(U){l.error("VoicePlayer: Failed to load the audioFile on the audio player.",U),i({type:op,payload:{groupKey:m}})},R.dataset.sbGroupId=m;try{M==null||M.childNodes.forEach(function(U){var P,L,F=U,B=(P=F.dataset)===null||P===void 0?void 0:P.sbGroupKey;B!==m&&((L=F==null?void 0:F.pause)===null||L===void 0||L.call(F),M.removeChild(F),l.info("VoicePlayer: Removed other player.",{element:F}))})}finally{R==null||R.play(),M==null||M.appendChild(R),i({type:QC,payload:{groupKey:m,audioPlayer:R}}),l.info("VoicePlayer: Succeeded playing audio player.",{groupKey:m,audioPlayer:R})}}).catch(function(I){l.warning("VoicePlayer: Failed loading audio file with URL.",I),i({type:op,payload:{groupKey:m}})})};return p.createElement(e0.Provider,{value:{play:f,pause:c,stop:d,voicePlayerStore:r}},p.createElement("div",{id:$l,style:{display:"none"}}),t)},aD=function(){return N.useContext(e0)},BE="sendbird-sort-by-row";function sD(n){var t=n.className,e=t===void 0?"":t,r=n.maxItemCount,i=n.itemWidth,a=n.itemHeight,s=n.children;if(Array.isArray(s)&&s.length>r){for(var u=[],o=0;o<s.length;o+=r)u.push(p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),[BE],!1).join(" "),key:vi(),style:{width:i*r,height:a}},s.slice(o,o+r)));return p.createElement(p.Fragment,null,u)}return p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),[BE],!1).join(" "),style:{width:i*(Array.isArray(s)?s.length:1),height:a}},s)}var n0="sendbird-app__layout",uD=60,oD=function(n){fC(t,n);function t(e){var r=n.call(this,e)||this;return r.menuRef=p.createRef(),r.setupEvents=function(){var i=r.props.closeDropdown,a=r.menuRef,s=function(u){var o,l;a!=null&&a.current&&!(!((l=(o=a==null?void 0:a.current)===null||o===void 0?void 0:o.contains)===null||l===void 0)&&l.call(o,u.target))&&(i==null||i())};r.setState({handleClickOutside:s}),document.addEventListener("mousedown",s)},r.cleanUpEvents=function(){var i=r.state.handleClickOutside;document.removeEventListener("mousedown",i)},r.getMenuPosition=function(){var i,a,s,u=r.props,o=u.parentRef,l=u.openLeft,d=document.getElementById(n0),c=((i=d==null?void 0:d.getBoundingClientRect)===null||i===void 0?void 0:i.call(d))||{top:0,left:0,width:window.innerWidth,height:window.innerHeight},f=(s=(a=o==null?void 0:o.current)===null||a===void 0?void 0:a.getBoundingClientRect)===null||s===void 0?void 0:s.call(a),h=((f==null?void 0:f.x)||(f==null?void 0:f.left)||0)-c.left,m=((f==null?void 0:f.y)||(f==null?void 0:f.top)||0)-c.top,_={top:m,left:h};if(!r.menuRef.current)return _;var E=r.menuRef.current.getBoundingClientRect();if(m+E.height+uD>c.height&&(_.top-=E.height),h+E.width>c.width&&!l&&(_.left-=E.width),_.top<0&&(_.top=E.height<c.height?(c.height-E.height)/2:0),_.top+=32,l){var b=Number.isNaN(E.width-30)?108:E.width-30;_.left-=b}return _.left<0&&(_.left=E.width<c.width?(c.width-E.width)/2:0),r.setState({menuStyle:_}),_},r.state={menuStyle:{top:0,left:0},handleClickOutside:function(){}},r}return t.prototype.componentDidMount=function(){this.setupEvents(),this.getMenuPosition()},t.prototype.componentWillUnmount=function(){this.cleanUpEvents()},t.prototype.render=function(){var e=document.getElementById(wd);if(!e)return p.createElement(p.Fragment,null);var r=this.state.menuStyle,i=this.props,a=i.children,s=i.style,u=i.className,o=u===void 0?"":u,l=i.testID,d=i.id;return Nu.createPortal(p.createElement("div",{className:Fn(Zp,o),"data-testid":l,id:d},p.createElement("div",{className:"sendbird-dropdown__menu-backdrop"}),p.createElement("ul",{className:"".concat(o," sendbird-dropdown__menu"),ref:this.menuRef,style:G({display:"inline-block",position:"fixed",left:"".concat(Math.round(r.left),"px"),top:"".concat(Math.round(r.top),"px")},s),"data-testid":"sendbird-dropdown-menu"},a)),e)},t}(p.Component),lD={x:0,y:0,left:0,top:0,height:0},dD=function(n){var t=n.id,e=n.children,r=n.parentRef,i=n.parentContainRef,a=n.spaceFromTrigger,s=a===void 0?{x:0,y:0}:a,u=n.closeDropdown,o=N.useState({left:0,top:0}),l=o[0],d=o[1],c=N.useRef(null);N.useEffect(function(){return i&&(i!=null&&i.current)&&i.current.classList.add("sendbird-reactions--pressed"),function(){i&&(i!=null&&i.current)&&i.current.classList.remove("sendbird-reactions--pressed")}},[]),N.useEffect(function(){var h=function(m){var _,E;c!=null&&c.current&&!(!((E=(_=c==null?void 0:c.current)===null||_===void 0?void 0:_.contains)===null||E===void 0)&&E.call(_,m.target))&&u()};return document.addEventListener("mousedown",h),function(){document.removeEventListener("mousedown",h)}},[]),N.useEffect(function(){var h,m,_,E,b=(s==null?void 0:s.x)||0,g=(s==null?void 0:s.y)||0,C=document.getElementById(n0),S=((h=C==null?void 0:C.getBoundingClientRect)===null||h===void 0?void 0:h.call(C))||{top:0,left:0,width:window.innerWidth,height:window.innerHeight},A=(_=(m=r==null?void 0:r.current)===null||m===void 0?void 0:m.getBoundingClientRect())!==null&&_!==void 0?_:lD,I=((A==null?void 0:A.x)||(A==null?void 0:A.left)||0)-S.left,T=((A==null?void 0:A.y)||(A==null?void 0:A.top)||0)-S.top,M={top:T,left:I};if(!(c!=null&&c.current))d(M);else{var O=(E=c==null?void 0:c.current)===null||E===void 0?void 0:E.getBoundingClientRect();M.top<O.height?(M.top+=A.height,M.top+=g):(M.top-=O.height,M.top-=g),M.left-=O.width/2,M.left+=A.height/2-2,M.left+=b;var R=S.width-O.width;R<M.left&&(M.left=R),M.left<0&&(M.left=0),d(M)}},[]);var f=document.getElementById(em);return f?Nu.createPortal(p.createElement("div",{className:Zp,id:t},p.createElement("div",{className:"sendbird-dropdown__menu-backdrop"}),p.createElement("ul",{className:"sendbird-dropdown__reaction-bar","data-testid":"sendbird-dropdown__reaction-bar",ref:c,style:{display:"inline-block",position:"fixed",left:"".concat(Math.round(l.left),"px"),top:"".concat(Math.round(l.top),"px")}},p.createElement(sD,{className:"sendbird-dropdown__reaction-bar__row",maxItemCount:8,itemWidth:44,itemHeight:40},e))),f):null},t0=N.createContext(void 0),Xp=function(n){var t=n.children,e=n.value;return p.createElement(t0.Provider,{value:e},t)},Jt=function(){var n=N.useContext(t0);if(!n)throw new Error("useMessageMenuContext must be used within a MessageMenuProvider.");return n},Gr=function(n){var t=n.className,e=n.disabled,r=n.tabIndex,i=r===void 0?0:r,a=n.testID,s=n.onClick,u=n.children,o=function(l){!e&&s&&s(l)};return p.createElement("li",{className:Fn("sendbird-menu-item",t),role:"menuitem","aria-disabled":e,"data-testid":a,tabIndex:i,onClick:o,onKeyDown:function(l){l.code==="Enter"&&o(l)}},p.createElement(me,{className:"sendbird-menu-item__text",type:he.SUBTITLE_2,color:e?re.ONBACKGROUND_4:re.ONBACKGROUND_1},u))},Ws=function(n){var t=n.className,e=n.disabled,r=e===void 0?!1:e,i=n.tabIndex,a=i===void 0?0:i,s=n.testID,u=n.onClick,o=n.children;return p.createElement("div",{className:Fn("sendbird-message__bottomsheet--action",t),role:"menuitem",tabIndex:a,"aria-disabled":r,onClick:u,"data-testid":s},o)},Zp="sendbird-observing-message-menu",Jp=function(n){return"m_".concat(n)},Mu=oD,r0=dD,cD=function(n){var t=n.className,e=t===void 0?"":t,r=n.children,i=n.onClick,a=n.disable,s=a===void 0?!1:a,u=n.dataSbId,o=u===void 0?"":u,l=n.testID;return p.createElement(Gr,{className:Fn.apply(void 0,Ce(Ce([],Array.isArray(e)?e:[e],!1),["sendbird-dropdown__menu-item",s?"disable":""],!1)),disabled:s,testID:l??o,onClick:i},r)},wd="sendbird-dropdown-portal",fD=function(){return p.createElement("div",{id:wd,className:wd})},em="sendbird-emoji-list-portal",hD=function(){return p.createElement("div",{id:em})};function wu(n){var t=n.menuTrigger,e=n.menuItems,r=n.isOpen,i=n.onClick,a=N.useState(!1),s=a[0],u=a[1];return p.createElement("div",{className:"sendbird-context-menu",onClick:i},t==null?void 0:t(function(){return u(!s)}),(s||r)&&e(function(){return u(!1)}))}var i0={100:"extra-light",200:"light",300:"main",400:"dark",500:"extra-dark","overlay-01":"overlay-dark","overlay-02":"overlay-light","onlight-01":"onlight-text-high-emphasis","onlight-02":"onlight-text-mid-emphasis","onlight-03":"onlight-text-low-emphasis","onlight-04":"onlight-text-disabled","ondark-01":"ondark-text-high-emphasis","ondark-02":"ondark-text-mid-emphasis","ondark-03":"ondark-text-low-emphasis","ondark-04":"ondark-text-disabled"},pD=Object.values(i0).sort(function(n,t){return t.length-n.length}),mD=new Map(Object.entries(i0).map(function(n){var t=n[0],e=n[1];return[e,t]})),_D=function(n){var t={};return Object.entries(n).forEach(function(e){for(var r=e[0],i=e[1],a=r,s=0,u=pD;s<u.length;s++){var o=u[s],l=new RegExp("-".concat(o,"$"));if(l.test(r)){var d=mD.get(o);if(d){a=r.replace(l,"-".concat(d));break}}}t[a]=i}),t},Hs="sendbird-modal-root",gD=function(){return p.createElement("div",{id:Hs,className:Hs})},ED=function(n){var t=n.titleText,e=n.onCloseClick;return p.createElement("div",{className:"sendbird-modal__header"},p.createElement(me,{type:he.H_1,color:re.ONBACKGROUND_1},t),p.createElement("div",{className:"sendbird-modal__close"},p.createElement(va,{width:"32px",height:"32px",onClick:e},p.createElement(Ue,{type:ye.CLOSE,fillColor:Me.DEFAULT,width:"24px",height:"24px"}))))},vD=function(n){var t=n.children;return p.createElement("div",{className:"sendbird-modal__body"},p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_2},t))},Od=function(n){var t=n.submitText,e=n.disabled,r=e===void 0?!1:e,i=n.hideCancelButton,a=i===void 0?!1:i,s=n.type,u=s===void 0?kt.DANGER:s,o=n.onSubmit,l=n.onCancel,d=N.useContext(wt).stringSet;return p.createElement("div",{className:"sendbird-modal__footer"},!a&&p.createElement(Ri,{type:kt.SECONDARY,onClick:l},p.createElement(me,{type:he.BUTTON_1,color:re.ONBACKGROUND_1},d.BUTTON__CANCEL)),p.createElement(Ri,{type:u,disabled:r,onClick:o},t))};function fi(n){var t,e=n.children,r=e===void 0?null:e,i=n.className,a=i===void 0?"":i,s=n.contentClassName,u=s===void 0?"":s,o=n.isCloseOnClickOutside,l=o===void 0?!1:o,d=n.isFullScreenOnMobile,c=d===void 0?!1:d,f=n.titleText,h=n.submitText,m=n.disabled,_=m===void 0?!1:m,E=n.hideFooter,b=E===void 0?!1:E,g=n.type,C=g===void 0?kt.DANGER:g,S=n.renderHeader,A=n.onSubmit,I=A===void 0?ot:A,T=n.onClose,M=n.onCancel,O=n.customFooter,R=(t=T??M)!==null&&t!==void 0?t:ot,U=Hn().eventHandlers,P=N.useState(function(){return"sbu-modal-".concat(vi())})[0];N.useEffect(function(){var F,B;return(B=(F=U==null?void 0:U.modal)===null||F===void 0?void 0:F.onMounted)===null||B===void 0?void 0:B.call(F,{close:R,id:P})},[]);var L=Nr().isMobile;return Nu.createPortal(p.createElement("div",{className:Fn("sendbird-modal",a,c&&L&&"sendbird-modal--full-mobile")},p.createElement("div",{className:Fn.apply(void 0,Ce(["sendbird-modal__content"],Array.isArray(u)?u:[u],!1))},(S==null?void 0:S())||p.createElement(ED,{titleText:f??"",onCloseClick:R}),p.createElement(vD,null,r),!b&&(O??p.createElement(Od,{disabled:_,onCancel:R,onSubmit:I,submitText:h??"",type:C}))),p.createElement("div",{className:Fn("sendbird-modal__backdrop",l&&"sendbird-modal__backdrop--clickoutside"),onClick:function(F){F==null||F.stopPropagation(),l&&R()}})),document.getElementById(Hs))}var a0=N.createContext({start:ot,stop:ot,isRecordable:!1}),yD=function(n){var t,e=n.children,r=Hn().config,i=r.logger,a=r.groupChannel,s=N.useState(null),u=s[0],o=s[1],l=N.useState(!1),d=l[0],c=l[1],f=N.useState(!1),h=f[0],m=f[1],_=$n().stringSet,E=a.enableVoiceMessage,b=N.useState(null),g=b[0],C=b[1],S=(t=lg.find(function(T){return MediaRecorder.isTypeSupported(T)}))!==null&&t!==void 0?t:"";E&&!S&&i.error("VoiceRecorder: Browser does not support mimeType",{mimmeTypes:lg}),N.useEffect(function(){E&&!g&&so(()=>import("./bundle-BGxqCTv7-C32Zrtsx.js"),__vite__mapDeps([5,1,2,3])).then(function(T){return C(T)})},[E,g]);var A=N.useCallback(function(T){var M,O;if(E&&!g){i.error("VoiceRecorder: Recording audio processor is being loaded.");return}var R=function(){try{navigator.permissions.query({name:"microphone"}).then(function(U){U.state==="denied"&&(i.warning("VoiceRecorder: Permission denied."),m(!0))})}catch(U){i.warning("VoiceRecorder: Failed to check permission.",U)}};i.info("VoiceRecorder: Start recording."),u&&(I(),i.info("VoiceRecorder: Previous mediaRecorder is stopped.")),R(),(O=(M=navigator==null?void 0:navigator.mediaDevices)===null||M===void 0?void 0:M.getUserMedia)===null||O===void 0||O.call(M,{audio:!0}).then(function(U){var P;i.info("VoiceRecorder: Succeeded getting media stream.",U),c(!0);var L=new MediaRecorder(U,{mimeType:S,audioBitsPerSecond:zw});L.ondataavailable=function(F){i.info("VoiceRecorder: Succeeded getting an available data.",F.data);var B=new File([F.data],Id,{lastModified:new Date().getTime(),type:Rs});g==null||g.downsampleToWav(B,function(K){var $,q=g==null?void 0:g.encodeMp3(K),se=new Blob(q,{type:Rs}),Y=new File([se],Id,{lastModified:new Date().getTime(),type:Rs});($=T==null?void 0:T.onRecordingEnded)===null||$===void 0||$.call(T,Y),i.info("VoiceRecorder: Succeeded converting audio file.",Y)});var V=U.getAudioTracks();V.forEach(function(K){return K.stop()}),c(!1)},L.onstart=(P=T==null?void 0:T.onRecordingStarted)!==null&&P!==void 0?P:ot,L==null||L.start(),o(L)}).catch(function(U){i.error("VoiceRecorder: Failed getting media stream.",U),o(null)})},[u,g]),I=N.useCallback(function(){u==null||u.stop(),o(null),c(!1),i.info("VoiceRecorder: Stop recording.")},[u]);return p.createElement(a0.Provider,{value:{start:A,stop:I,isRecordable:d}},e,h&&p.createElement(fi,{hideFooter:!0,onClose:function(){return m(!1)}},p.createElement(p.Fragment,null,_.VOICE_RECORDING_PERMISSION_DENIED)))},s0=function(){return N.useContext(a0)},u0=N.createContext({openModal:ot}),bD=function(n){var t=n.children,e=N.useState([]),r=e[0],i=e[1],a=N.useCallback(function(o){i(function(l){return Ce(Ce([],l,!0),[o],!1)})},[]),s=N.useCallback(function(){i(function(o){return o.slice(1)})},[]),u=N.useMemo(function(){return function(){return cr(r).when(function(o){return o.length===0},function(){return p.createElement(p.Fragment,null)}).otherwise(function(){var o=r[0],l=o.modalProps,d=o.childElement;return p.createElement(fi,G({},l,{className:Fn("sendbird-global-modal",l==null?void 0:l.className),onClose:function(){var c;(c=l==null?void 0:l.onClose)===null||c===void 0||c.call(l),s()}}),d({closeModal:s}))})}},[r]);return p.createElement(u0.Provider,{value:{openModal:a}},p.createElement(u,null),t)},o0=function(){return N.useContext(u0)},CD=function(){function n(t){var e=this,r,i=t.sdk,a=t.logger;(r=i==null?void 0:i.getAllEmoji)===null||r===void 0||r.call(i).then(function(s){e._emojiContainer=s,a==null||a.info("EmojiManager | Succeeded getting all emojis. ",s)}).catch(function(){a==null||a.warning("EmojiManager | Failed getting all emojis.")})}return Object.defineProperty(n.prototype,"AllEmojisAsArray",{get:function(){return this._emojiContainer.emojiCategories.flatMap(function(t){return t.emojis})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"AllEmojisAsMap",{get:function(){return this._emojiContainer.emojiCategories.flatMap(function(t){return t.emojis}).reduce(function(t,e){return t.set(e.key,e.url),t},new Map)},enumerable:!1,configurable:!0}),n.prototype.getAllEmojis=function(t){var e=this;return cr(t).when(function(r){return["array","arr"].includes(r)},function(){return e.AllEmojisAsArray}).when(function(r){return["map"].includes(r)},function(){return e.AllEmojisAsMap}).otherwise(function(){return e.AllEmojisAsArray})},n.prototype.getEmojiUrl=function(t){var e,r;return(r=(e=this.AllEmojisAsArray.find(function(i){return i.key===t}))===null||e===void 0?void 0:e.url)!==null&&r!==void 0?r:""},Object.defineProperty(n.prototype,"emojiContainer",{get:function(){return this._emojiContainer},enumerable:!1,configurable:!0}),n}(),l0=p.createContext({disableUserProfile:!0,isOpenChannel:!1}),nm=function(){return N.useContext(l0)},d0=function(n){var t,e=n.isOpenChannel,r=e===void 0?!1:e,i=n.disableUserProfile,a=i===void 0?!1:i,s=n.renderUserProfile,u=n.onUserProfileMessage,o=n.onStartDirectMessage,l=n.children,d=Hn().config,c=(t=o??u)!==null&&t!==void 0?t:d.onStartDirectMessage;return p.createElement(l0.Provider,{value:{isOpenChannel:r,disableUserProfile:a??!d.common.enableUsingDefaultUserProfile,renderUserProfile:s??d.renderUserProfile,onStartDirectMessage:c,onUserProfileMessage:c}},l)},c0=10,f0=15,Mo="@",SD=1,Ii;(function(n){n.PARENT="PARENT",n.THREAD="THREAD"})(Ii||(Ii={}));var h0=function(n,t,e){var r;try{var i=n.current,a=(r=i==null?void 0:i.querySelectorAll('[data-sb-created-at="'.concat(t,'"]')))===null||r===void 0?void 0:r[0];i&&a instanceof HTMLElement&&(i.scrollTop=a.offsetTop)}catch{}finally{e==null||e(!0)}},ea=function(n,t,e){n===void 0&&(n=0);var r=10,i=n;if(i>r){e==null||e(!0);return}try{var a=(t==null?void 0:t.current)||document.querySelector(".sendbird-conversation__messages-padding");a&&(a.scrollTop=a.scrollHeight),e==null||e(!0)}catch{setTimeout(function(){ea(i+1,t,e)},500*i)}},TD=function(n){var t=n==null?void 0:n.myRole;return t==="operator"},ND=function(n){var t=n==null?void 0:n.isFrozen;return t&&!TD(n)},ID=function(n){var t=n==null?void 0:n.myMutedState;return t==="muted"},AD=function(n){for(var t=n.emojiCategories,e=t===void 0?[]:t,r=new Map,i=0;i<e.length;i+=1)for(var a=e[i].emojis,s=0;s<a.length;s+=1){var u=a[s],o=u.key,l=u.url;r.set(o,l)}return r},MD=function(n){n===void 0&&(n=[]);for(var t=new Map,e=0;e<n.length;e+=1){var r=n[e],i=r.userId,a=r.nickname;t.set(i,a)}return t},wD=function(n,t){var e=n.map(function(r){return[r[t],r]});return Array.from(new Map(e).values())},OD=function(n){return wD(n,"messageId")},RD=function(n){return n.sort(function(t,e){return t.createdAt-e.createdAt})},DD=function(n,t){var e=n[n.length-1],r=t[0];if((e==null?void 0:e.createdAt)<(r==null?void 0:r.createdAt))return Ce(Ce([],n,!0),t,!0);var i=Ce(Ce([],n,!0),t,!0),a=OD(i);return RD(a)},GE=function(n,t){if("sendingStatus"in t&&(t.sendingStatus===Qn.SUCCEEDED||t.sendingStatus===Qn.PENDING)){var e=n.map(function(i){return"sendingStatus"in i&&i.sendingStatus?i.sendingStatus:i.isAdminMessage()?Qn.SUCCEEDED:null}).lastIndexOf(Qn.SUCCEEDED);if(e+1<n.length){var r=Ce([],n,!0);return r.splice(e+1,0,t),r}}return Ce(Ce([],n,!0),[t],!1)},Ds=function(n,t,e){return Math.abs(n-t)<=e};function p0(n){var t=n.channel,e=n.config,r=n.moduleLevel;return!t||t.isBroadcast||t.isEphemeral?!1:t.isSuper?r??e.groupChannel.enableReactionsSupergroup:r??e.groupChannel.enableReactions}function LD(n){return xt(1,arguments),n instanceof Date||Nd(n)==="object"&&Object.prototype.toString.call(n)==="[object Date]"}function UD(n){if(xt(1,arguments),!LD(n)&&typeof n!="number")return!1;var t=xr(n);return!isNaN(Number(t))}function Ca(n){if(n===null||n===!0||n===!1)return NaN;var t=Number(n);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function kD(n,t){xt(2,arguments);var e=xr(n).getTime(),r=Ca(t);return new Date(e+r)}function xD(n,t){xt(2,arguments);var e=Ca(t);return kD(n,-e)}var PD=864e5;function FD(n){xt(1,arguments);var t=xr(n),e=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=t.getTime(),i=e-r;return Math.floor(i/PD)+1}function Rd(n){xt(1,arguments);var t=1,e=xr(n),r=e.getUTCDay(),i=(r<t?7:0)+r-t;return e.setUTCDate(e.getUTCDate()-i),e.setUTCHours(0,0,0,0),e}function m0(n){xt(1,arguments);var t=xr(n),e=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(e+1,0,4),r.setUTCHours(0,0,0,0);var i=Rd(r),a=new Date(0);a.setUTCFullYear(e,0,4),a.setUTCHours(0,0,0,0);var s=Rd(a);return t.getTime()>=i.getTime()?e+1:t.getTime()>=s.getTime()?e:e-1}function HD(n){xt(1,arguments);var t=m0(n),e=new Date(0);e.setUTCFullYear(t,0,4),e.setUTCHours(0,0,0,0);var r=Rd(e);return r}var BD=6048e5;function GD(n){xt(1,arguments);var t=xr(n),e=Rd(t).getTime()-HD(t).getTime();return Math.round(e/BD)+1}var VD={};function Jd(){return VD}function Dd(n,t){var e,r,i,a,s,u,o,l;xt(1,arguments);var d=Jd(),c=Ca((e=(r=(i=(a=t==null?void 0:t.weekStartsOn)!==null&&a!==void 0?a:t==null||(s=t.locale)===null||s===void 0||(u=s.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:d.weekStartsOn)!==null&&r!==void 0?r:(o=d.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&e!==void 0?e:0);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=xr(n),h=f.getUTCDay(),m=(h<c?7:0)+h-c;return f.setUTCDate(f.getUTCDate()-m),f.setUTCHours(0,0,0,0),f}function _0(n,t){var e,r,i,a,s,u,o,l;xt(1,arguments);var d=xr(n),c=d.getUTCFullYear(),f=Jd(),h=Ca((e=(r=(i=(a=t==null?void 0:t.firstWeekContainsDate)!==null&&a!==void 0?a:t==null||(s=t.locale)===null||s===void 0||(u=s.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&i!==void 0?i:f.firstWeekContainsDate)!==null&&r!==void 0?r:(o=f.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&e!==void 0?e:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var m=new Date(0);m.setUTCFullYear(c+1,0,h),m.setUTCHours(0,0,0,0);var _=Dd(m,t),E=new Date(0);E.setUTCFullYear(c,0,h),E.setUTCHours(0,0,0,0);var b=Dd(E,t);return d.getTime()>=_.getTime()?c+1:d.getTime()>=b.getTime()?c:c-1}function jD(n,t){var e,r,i,a,s,u,o,l;xt(1,arguments);var d=Jd(),c=Ca((e=(r=(i=(a=t==null?void 0:t.firstWeekContainsDate)!==null&&a!==void 0?a:t==null||(s=t.locale)===null||s===void 0||(u=s.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&i!==void 0?i:d.firstWeekContainsDate)!==null&&r!==void 0?r:(o=d.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&e!==void 0?e:1),f=_0(n,t),h=new Date(0);h.setUTCFullYear(f,0,c),h.setUTCHours(0,0,0,0);var m=Dd(h,t);return m}var qD=6048e5;function zD(n,t){xt(1,arguments);var e=xr(n),r=Dd(e,t).getTime()-jD(e,t).getTime();return Math.round(r/qD)+1}function St(n,t){for(var e=n<0?"-":"",r=Math.abs(n).toString();r.length<t;)r="0"+r;return e+r}var Ra={y:function(t,e){var r=t.getUTCFullYear(),i=r>0?r:1-r;return St(e==="yy"?i%100:i,e.length)},M:function(t,e){var r=t.getUTCMonth();return e==="M"?String(r+1):St(r+1,2)},d:function(t,e){return St(t.getUTCDate(),e.length)},a:function(t,e){var r=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(t,e){return St(t.getUTCHours()%12||12,e.length)},H:function(t,e){return St(t.getUTCHours(),e.length)},m:function(t,e){return St(t.getUTCMinutes(),e.length)},s:function(t,e){return St(t.getUTCSeconds(),e.length)},S:function(t,e){var r=e.length,i=t.getUTCMilliseconds(),a=Math.floor(i*Math.pow(10,r-3));return St(a,e.length)}},tu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},KD={G:function(t,e,r){var i=t.getUTCFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){var i=t.getUTCFullYear(),a=i>0?i:1-i;return r.ordinalNumber(a,{unit:"year"})}return Ra.y(t,e)},Y:function(t,e,r,i){var a=_0(t,i),s=a>0?a:1-a;if(e==="YY"){var u=s%100;return St(u,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):St(s,e.length)},R:function(t,e){var r=m0(t);return St(r,e.length)},u:function(t,e){var r=t.getUTCFullYear();return St(r,e.length)},Q:function(t,e,r){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return St(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,r){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return St(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,r){var i=t.getUTCMonth();switch(e){case"M":case"MM":return Ra.M(t,e);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,r){var i=t.getUTCMonth();switch(e){case"L":return String(i+1);case"LL":return St(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,r,i){var a=zD(t,i);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):St(a,e.length)},I:function(t,e,r){var i=GD(t);return e==="Io"?r.ordinalNumber(i,{unit:"week"}):St(i,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getUTCDate(),{unit:"date"}):Ra.d(t,e)},D:function(t,e,r){var i=FD(t);return e==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):St(i,e.length)},E:function(t,e,r){var i=t.getUTCDay();switch(e){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,r,i){var a=t.getUTCDay(),s=(a-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return St(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,i){var a=t.getUTCDay(),s=(a-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return St(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){var i=t.getUTCDay(),a=i===0?7:i;switch(e){case"i":return String(a);case"ii":return St(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,r){var i=t.getUTCHours(),a=i/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){var i=t.getUTCHours(),a;switch(i===12?a=tu.noon:i===0?a=tu.midnight:a=i/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){var i=t.getUTCHours(),a;switch(i>=17?a=tu.evening:i>=12?a=tu.afternoon:i>=4?a=tu.morning:a=tu.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){var i=t.getUTCHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return Ra.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Ra.H(t,e)},K:function(t,e,r){var i=t.getUTCHours()%12;return e==="Ko"?r.ordinalNumber(i,{unit:"hour"}):St(i,e.length)},k:function(t,e,r){var i=t.getUTCHours();return i===0&&(i=24),e==="ko"?r.ordinalNumber(i,{unit:"hour"}):St(i,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Ra.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Ra.s(t,e)},S:function(t,e){return Ra.S(t,e)},X:function(t,e,r,i){var a=i._originalDate||t,s=a.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return jE(s);case"XXXX":case"XX":return ls(s);case"XXXXX":case"XXX":default:return ls(s,":")}},x:function(t,e,r,i){var a=i._originalDate||t,s=a.getTimezoneOffset();switch(e){case"x":return jE(s);case"xxxx":case"xx":return ls(s);case"xxxxx":case"xxx":default:return ls(s,":")}},O:function(t,e,r,i){var a=i._originalDate||t,s=a.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+VE(s,":");case"OOOO":default:return"GMT"+ls(s,":")}},z:function(t,e,r,i){var a=i._originalDate||t,s=a.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+VE(s,":");case"zzzz":default:return"GMT"+ls(s,":")}},t:function(t,e,r,i){var a=i._originalDate||t,s=Math.floor(a.getTime()/1e3);return St(s,e.length)},T:function(t,e,r,i){var a=i._originalDate||t,s=a.getTime();return St(s,e.length)}};function VE(n,t){var e=n>0?"-":"+",r=Math.abs(n),i=Math.floor(r/60),a=r%60;if(a===0)return e+String(i);var s=t;return e+String(i)+s+St(a,2)}function jE(n,t){if(n%60===0){var e=n>0?"-":"+";return e+St(Math.abs(n)/60,2)}return ls(n,t)}function ls(n,t){var e=t||"",r=n>0?"-":"+",i=Math.abs(n),a=St(Math.floor(i/60),2),s=St(i%60,2);return r+a+e+s}var qE=function(t,e){switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},g0=function(t,e){switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},$D=function(t,e){var r=t.match(/(P+)(p+)?/)||[],i=r[1],a=r[2];if(!a)return qE(t,e);var s;switch(i){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",qE(i,e)).replace("{{time}}",g0(a,e))},WD={p:g0,P:$D};function YD(n){var t=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return t.setUTCFullYear(n.getFullYear()),n.getTime()-t.getTime()}var QD=["D","DD"],XD=["YY","YYYY"];function ZD(n){return QD.indexOf(n)!==-1}function JD(n){return XD.indexOf(n)!==-1}function zE(n,t,e){if(n==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(e,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(e,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(e,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(n==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(e,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var eL=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,nL=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tL=/^'([^]*?)'?$/,rL=/''/g,iL=/[a-zA-Z]/;function Xi(n,t,e){var r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S;xt(2,arguments);var A=String(t),I=Jd(),T=(r=(i=e==null?void 0:e.locale)!==null&&i!==void 0?i:I.locale)!==null&&r!==void 0?r:kC,M=Ca((a=(s=(u=(o=e==null?void 0:e.firstWeekContainsDate)!==null&&o!==void 0?o:e==null||(l=e.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&u!==void 0?u:I.firstWeekContainsDate)!==null&&s!==void 0?s:(c=I.locale)===null||c===void 0||(f=c.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&a!==void 0?a:1);if(!(M>=1&&M<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var O=Ca((h=(m=(_=(E=e==null?void 0:e.weekStartsOn)!==null&&E!==void 0?E:e==null||(b=e.locale)===null||b===void 0||(g=b.options)===null||g===void 0?void 0:g.weekStartsOn)!==null&&_!==void 0?_:I.weekStartsOn)!==null&&m!==void 0?m:(C=I.locale)===null||C===void 0||(S=C.options)===null||S===void 0?void 0:S.weekStartsOn)!==null&&h!==void 0?h:0);if(!(O>=0&&O<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!T.localize)throw new RangeError("locale must contain localize property");if(!T.formatLong)throw new RangeError("locale must contain formatLong property");var R=xr(n);if(!UD(R))throw new RangeError("Invalid time value");var U=YD(R),P=xD(R,U),L={firstWeekContainsDate:M,weekStartsOn:O,locale:T,_originalDate:R},F=A.match(nL).map(function(B){var V=B[0];if(V==="p"||V==="P"){var K=WD[V];return K(B,T.formatLong)}return B}).join("").match(eL).map(function(B){if(B==="''")return"'";var V=B[0];if(V==="'")return aL(B);var K=KD[V];if(K)return!(e!=null&&e.useAdditionalWeekYearTokens)&&JD(B)&&zE(B,t,String(n)),!(e!=null&&e.useAdditionalDayOfYearTokens)&&ZD(B)&&zE(B,t,String(n)),K(P,B,T.localize,L);if(V.match(iL))throw new RangeError("Format string contains an unescaped latin alphabet character `"+V+"`");return B}).join("");return F}function aL(n){var t=n.match(tL);return t?t[1].replace(rL,"'"):n}var tm="RESET_MESSAGES",ec="FETCH_INITIAL_MESSAGES_START",nc="FETCH_INITIAL_MESSAGES_SUCCESS",Ho="FETCH_INITIAL_MESSAGES_FAILURE",rm="FETCH_PREV_MESSAGES_SUCCESS",im="FETCH_PREV_MESSAGES_FAILURE",am="FETCH_NEXT_MESSAGES_SUCCESS",sm="FETCH_NEXT_MESSAGES_FAILURE",um="SEND_MESSAGE_START",Zi="SEND_MESSAGE_SUCCESS",ya="SEND_MESSAGE_FAILURE",wo="RESEND_MESSAGE_START",om="ON_MESSAGE_RECEIVED",Jo="ON_MESSAGE_UPDATED",lm="ON_MESSAGE_THREAD_INFO_UPDATED",el="ON_MESSAGE_DELETED",dm="ON_MESSAGE_DELETED_BY_REQ_ID",Jr="SET_CURRENT_CHANNEL",cm="SET_CHANNEL_INVALID",E0="MARK_AS_READ",fm="ON_REACTION_UPDATED",hm="SET_EMOJI_CONTAINER",pm="MESSAGE_LIST_PARAMS_CHANGED",mm="ON_FILE_INFO_UPLOADED",_m="ON_TYPING_STATUS_UPDATED",sL=Object.freeze({__proto__:null,FETCH_INITIAL_MESSAGES_FAILURE:Ho,FETCH_INITIAL_MESSAGES_START:ec,FETCH_INITIAL_MESSAGES_SUCCESS:nc,FETCH_NEXT_MESSAGES_FAILURE:sm,FETCH_NEXT_MESSAGES_SUCCESS:am,FETCH_PREV_MESSAGES_FAILURE:im,FETCH_PREV_MESSAGES_SUCCESS:rm,MARK_AS_READ:E0,MESSAGE_LIST_PARAMS_CHANGED:pm,ON_FILE_INFO_UPLOADED:mm,ON_MESSAGE_DELETED:el,ON_MESSAGE_DELETED_BY_REQ_ID:dm,ON_MESSAGE_RECEIVED:om,ON_MESSAGE_THREAD_INFO_UPDATED:lm,ON_MESSAGE_UPDATED:Jo,ON_REACTION_UPDATED:fm,ON_TYPING_STATUS_UPDATED:_m,RESEND_MESSAGE_START:wo,RESET_MESSAGES:tm,SEND_MESSAGE_FAILURE:ya,SEND_MESSAGE_START:um,SEND_MESSAGE_SUCCESS:Zi,SET_CHANNEL_INVALID:cm,SET_CURRENT_CHANNEL:Jr,SET_EMOJI_CONTAINER:hm}),KE=function(n){return n==null};function ht(n,t){if(KE(n)||KE(t))return!1;var e=n.toString(),r=t.toString();return e===r}var tc=30,rc=15;function uL(n,t){var e=n.currentGroupChannel,r=n.initialTimeStamp,i=n.userFilledMessageListQuery,a=n.replyType,s=n.setIsScrolled,u=t.logger,o=t.scrollRef,l=t.messagesDispatcher,d=e==null?void 0:e.url,c=N.useCallback(function(){if(u.info("Channel useInitialMessagesFetch: Setup started",e),s(!1),l({type:tm,payload:null}),e&&(e!=null&&e.getMessagesByTimestamp)){var f={prevResultSize:tc,isInclusive:!0,includeReactions:!0,includeMetaArray:!0};r&&(f.nextResultSize=rc),(a==="QUOTE_REPLY"||a==="THREAD")&&(f.includeThreadInfo=!0,f.includeParentMessageInfo=!0,f.replyType=Kt.ONLY_REPLY_TO_CHANNEL),i&&Object.keys(i).forEach(function(h){f[h]=i[h]}),(a&&(a==="QUOTE_REPLY"||a==="THREAD")||i)&&(u.info("Channel useInitialMessagesFetch: Setup messageListParams",f),l({type:pm,payload:f})),u.info("Channel: Fetching messages",{currentGroupChannel:e,userFilledMessageListQuery:i}),l({type:ec,payload:null}),e.getMessagesByTimestamp(r||new Date().getTime(),f).then(function(h){l({type:nc,payload:{currentGroupChannel:e,messages:h}})}).catch(function(h){u.error("Channel: Fetching messages failed",h),l({type:Ho,payload:{currentGroupChannel:e}})}).finally(function(){r?setTimeout(function(){h0(o,r,s)},500):setTimeout(function(){return ea(0,o,s)},EC)})}},[d,i,r]);return N.useEffect(function(){c()},[c]),c}function v0(n,t,e){e===void 0&&(e=!0);var r=N.useState(!1),i=r[0],a=r[1],s=!n;N.useEffect(function(){var o=function(){e&&a(document.hidden)};return document.addEventListener("visibilitychange",o),function(){document.removeEventListener("visibilitychange",o)}},[e,document.hidden]);var u=s&&!!t&&!i;return{shouldReconnect:u}}var na;(function(n){n.CHANNEL="CHANNEL",n.THREAD="THREAD"})(na||(na={}));var y0=function(n,t){return!t||t.length===0?!0:t.includes(n)};function Xl(n){return y0(na.CHANNEL,n)}function oL(n){return y0(na.THREAD,n)}var pr;(function(n){n.USER_UPDATED="USER_UPDATED",n.SEND_MESSAGE_START="SEND_MESSAGE_START",n.SEND_MESSAGE_FAILED="SEND_MESSAGE_FAILED",n.SEND_USER_MESSAGE="SEND_USER_MESSAGE",n.SEND_FILE_MESSAGE="SEND_FILE_MESSAGE",n.ON_FILE_INFO_UPLOADED="ON_FILE_INFO_UPLOADED",n.UPDATE_USER_MESSAGE="UPDATE_USER_MESSAGE",n.DELETE_MESSAGE="DELETE_MESSAGE",n.LEAVE_CHANNEL="LEAVE_CHANNEL",n.CREATE_CHANNEL="CREATE_CHANNEL",n.UPDATE_OPEN_CHANNEL="UPDATE_OPEN_CHANNEL"})(pr||(pr={}));var Sr=pr,zu="useToggleReactionCallback:";function lL(n,t){return N.useCallback(function(e,r,i){if(!n){t==null||t.warning("".concat(zu," currentChannel doesn't exist"),n);return}i?n.deleteReaction(e,r).then(function(a){t==null||t.info("".concat(zu," Delete reaction success"),a)}).catch(function(a){t==null||t.warning("".concat(zu," Delete reaction failed"),a)}):n.addReaction(e,r).then(function(a){t==null||t.info("".concat(zu," Add reaction success"),a)}).catch(function(a){t==null||t.warning("".concat(zu," Add reaction failed"),a)})},[n])}function gm(n){return{lowerCase:n.toLowerCase(),upperCase:n.toUpperCase()}}function dL(n){return{lowerCase:n.toLowerCase(),upperCase:n.toUpperCase()}}var b0=function(n){n===void 0&&(n=0);var t=10,e=n;if(!(e>t))try{var r=document.querySelector(".sendbird-thread-ui--scroll");r&&(r.scrollTop=r.scrollHeight)}catch{setTimeout(function(){b0(e+1)},500*e)}},cL=function(n,t){var e=n.currentChannel,r=n.onBeforeSendMultipleFilesMessage,i=n.publishingModules,a=t.logger,s=t.pubSub,u=t.scrollRef,o=N.useCallback(function(l,d){return new Promise(function(c,f){e||(a.warning("Channel: Sending MFm failed, because currentChannel is null.",{currentChannel:e}),f()),l.length<=1&&(a.warning("Channel: Sending MFM failed, because there are no multiple files.",{files:l}),f());var h={fileInfoList:l.map(function(m){return{file:m,fileName:m.name,fileSize:m.size,mimeType:m.type}})};d&&(h.isReplyToChannel=!0,h.parentMessageId=d.messageId),typeof r=="function"&&(h=r(l,d)),a.info("Channel: Start sending MFM",{messageParams:h});try{e==null||e.sendMultipleFilesMessage(h).onFileUploaded(function(m,_,E,b){a.info("Channel: onFileUploaded during sending MFM",{requestId:m,index:_,error:b,uploadableFileInfo:E}),s.publish(Sr.ON_FILE_INFO_UPLOADED,{response:{channelUrl:e.url,requestId:m,index:_,uploadableFileInfo:E,error:b},publishingModules:i})}).onPending(function(m){a.info("Channel: in progress of sending MFM",{pendingMessage:m,fileInfoList:h.fileInfoList}),s.publish(Sr.SEND_MESSAGE_START,{message:m,channel:e,publishingModules:i}),setTimeout(function(){u&&Xl(i)&&ea(0,u),oL(i)&&b0(0)},bu)}).onFailed(function(m,_){a.error("Channel: Sending MFM failed.",{error:m,failedMessage:_}),s.publish(Sr.SEND_MESSAGE_FAILED,{channel:e,message:_,publishingModules:i}),f(m)}).onSucceeded(function(m){a.info("Channel: Sending voice message success!",{succeededMessage:m}),s.publish(Sr.SEND_FILE_MESSAGE,{channel:e,message:m,publishingModules:i}),c(m)})}catch(m){a.error("Channel: Sending MFM failed.",{error:m}),f(m)}})},[e,r,i]);return[o]},fL={initialized:!1,loading:!0,allMessages:[],localMessages:[],currentGroupChannel:null,hasMorePrev:!1,oldestMessageTimeStamp:0,hasMoreNext:!1,latestMessageTimeStamp:0,emojiContainer:{emojiCategories:[],emojiHash:""},unreadSince:null,unreadSinceDate:null,isInvalid:!1,readStatus:null,messageListParams:null,typingMembers:[]},$E=function(n){n===void 0&&(n=[]);var t=n[0];return t&&t.createdAt||null},WE=function(n){n===void 0&&(n=[]);var t=n[n.length-1];return t&&t.createdAt||null};function ru(n){return"reqId"in n}function hL(n,t){var e=$n().stringSet;return cr(t).with({type:tm},function(){return G(G({},n),{hasMorePrev:!1,hasMoreNext:!1,allMessages:[],localMessages:[]})}).with({type:ec},function(){return G(G({},n),{loading:!0,allMessages:n.allMessages.filter(function(r){return Xo(r)?r.sendingStatus!==Qn.SUCCEEDED:!0}),localMessages:[]})}).with({type:nc},function(r){var i,a=r.payload,s=a.currentGroupChannel,u=a.messages;if((s==null?void 0:s.url)!==((i=n.currentGroupChannel)===null||i===void 0?void 0:i.url))return n;var o=$E(u),l=WE(u);return G(G({},n),{loading:!1,initialized:!0,hasMorePrev:!0,hasMoreNext:!0,oldestMessageTimeStamp:o,latestMessageTimeStamp:l,allMessages:Ce([],u,!0)})}).with({type:rm},function(r){var i,a,s,u,o=r.payload,l=o.currentGroupChannel,d=o.messages;if((l==null?void 0:l.url)!==((i=n.currentGroupChannel)===null||i===void 0?void 0:i.url))return n;var c=((a=d==null?void 0:d.length)!==null&&a!==void 0?a:0)>=((u=(s=n==null?void 0:n.messageListParams)===null||s===void 0?void 0:s.prevResultSize)!==null&&u!==void 0?u:tc)+1,f=$E(d),h=[],m=n.allMessages.map(function(E){var b=d.find(function(g){var C=g.messageId;return ht(C,E.messageId)});return b?(h.push(b.messageId),b.updatedAt>E.updatedAt?b:E):E}),_=h.length>0?d.filter(function(E){return!h.find(function(b){return ht(b,E.messageId)})}):d;return G(G({},n),{hasMorePrev:c,oldestMessageTimeStamp:f,allMessages:Ce(Ce([],_,!0),m,!0)})}).with({type:am},function(r){var i,a,s,u,o=r.payload,l=o.currentGroupChannel,d=o.messages;if((l==null?void 0:l.url)!==((i=n.currentGroupChannel)===null||i===void 0?void 0:i.url))return n;var c=((a=d==null?void 0:d.length)!==null&&a!==void 0?a:0)===((u=(s=n==null?void 0:n.messageListParams)===null||s===void 0?void 0:s.nextResultSize)!==null&&u!==void 0?u:rc)+1,f=WE(d),h=DD(n.allMessages,d);return G(G({},n),{hasMoreNext:c,latestMessageTimeStamp:f,allMessages:h})}).with({type:Xf.union(Ho,im,sm)},function(r){var i,a=r.payload.currentGroupChannel;if((a==null?void 0:a.url)!==((i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url))return n;var s=[Ho].includes(r.type);return G(G({},n),{loading:!1,isInvalid:s,initialized:!1,allMessages:[],hasMorePrev:!1,hasMoreNext:!1,oldestMessageTimeStamp:null,latestMessageTimeStamp:null})}).with({type:um},function(r){return G(G({},n),{localMessages:Ce(Ce([],n.localMessages,!0),[r.payload],!1)})}).with({type:Zi},function(r){var i=r.payload,a=n.allMessages.filter(function(s){return!ru(s)||(s==null?void 0:s.reqId)!==(i==null?void 0:i.reqId)});return G(G({},n),{allMessages:Ce(Ce([],a,!0),[i],!1),localMessages:n.localMessages.filter(function(s){return ru(s)&&(s==null?void 0:s.reqId)!==(i==null?void 0:i.reqId)})})}).with({type:ya},function(r){return r.payload.failed=!0,G(G({},n),{localMessages:n.localMessages.map(function(i){return ht(ru(i)&&i.reqId,r.payload.reqId)?r.payload:i})})}).with({type:Jr},function(r){return G(G({},n),{currentGroupChannel:r.payload,isInvalid:!1})}).with({type:cm},function(){return G(G({},n),{currentGroupChannel:null,allMessages:[],localMessages:[],isInvalid:!0})}).with({type:om},function(r){var i,a,s=r.payload,u=s.channel,o=s.message,l=u.members,d=o.sender,c=n.currentGroupChannel,f=c==null?void 0:c.url;if(!ht(u==null?void 0:u.url,f)||n.allMessages.some(function(m){return m.messageId===o.messageId})||n.messageListParams&&!yg(n.messageListParams,o))return n;if(o.isAdminMessage&&o.isAdminMessage())return G(G({},n),{allMessages:GE(n.allMessages,o)});var h=l==null?void 0:l.find(function(m){return(m==null?void 0:m.userId)===(d==null?void 0:d.userId)});return((h==null?void 0:h.profileUrl)!==(d==null?void 0:d.profileUrl)||(h==null?void 0:h.friendName)!==(d==null?void 0:d.friendName)||(h==null?void 0:h.nickname)!==(d==null?void 0:d.nickname))&&(u.members=l.map(function(m){return m.userId===d.userId?d:m})),G(G({},n),{currentGroupChannel:u,unreadSince:(i=n.unreadSince)!==null&&i!==void 0?i:Xi(new Date,e.DATE_FORMAT__UNREAD_SINCE),unreadSinceDate:(a=n.unreadSinceDate)!==null&&a!==void 0?a:new Date,allMessages:GE(n.allMessages,o)})}).with({type:Jo},function(r){var i,a=r.payload,s=a.channel,u=a.message,o=((i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url)||"";return ht(s==null?void 0:s.url,o)?n.messageListParams&&!yg(n.messageListParams,u)?G(G({},n),{allMessages:n.allMessages.filter(function(l){return!ht(l.messageId,u==null?void 0:u.messageId)})}):G(G({},n),{allMessages:n.allMessages.map(function(l){return ht(l.messageId,u.messageId)?u:(ht(l.parentMessageId,u.messageId)&&(l.parentMessage=u),l)})}):n}).with({type:lm},function(r){var i,a=r.payload,s=a.channel,u=a.event,o=u.channelUrl,l=u.threadInfo,d=u.targetMessageId,c=((i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url)||"";return!ht(s==null?void 0:s.url,c)||!ht(s==null?void 0:s.url,o)?n:G(G({},n),{allMessages:n.allMessages.map(function(f){return ht(f.messageId,d)&&(f.threadInfo=l),f})})}).with({type:wo},function(r){return G(G({},n),{localMessages:n.localMessages.map(function(i){return ht(ru(i)&&i.reqId,r.payload.reqId)?r.payload:i})})}).with({type:E0},function(r){var i,a,s;return((i=n.currentGroupChannel)===null||i===void 0?void 0:i.url)!==((s=(a=r.payload)===null||a===void 0?void 0:a.channel)===null||s===void 0?void 0:s.url)?n:G(G({},n),{unreadSince:null,unreadSinceDate:null})}).with({type:el},function(r){return G(G({},n),{allMessages:n.allMessages.filter(function(i){return!ht(i.messageId,r.payload)})})}).with({type:dm},function(r){return G(G({},n),{localMessages:n.localMessages.filter(function(i){return!ht(ru(i)&&i.reqId,r.payload)})})}).with({type:hm},function(r){return G(G({},n),{emojiContainer:r.payload})}).with({type:fm},function(r){return G(G({},n),{allMessages:n.allMessages.map(function(i){return ht(i.messageId,r.payload.messageId)&&i.applyReactionEvent&&typeof i.applyReactionEvent=="function"&&i.applyReactionEvent(r.payload),i})})}).with({type:pm},function(r){return G(G({},n),{messageListParams:r.payload})}).with({type:mm},function(r){var i,a,s=r.payload,u=s.channelUrl,o=s.requestId,l=s.index,d=s.uploadableFileInfo,c=s.error;if(!ht(u,(i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url)||c)return n;var f=n.localMessages,h=f.find(function(_){return ht(ru(_)&&_.reqId,o)}),m=(a=h.messageParams)===null||a===void 0?void 0:a.fileInfoList;return Array.isArray(m)&&(m[l]=d),G(G({},n),{localMessages:f})}).with({type:_m},function(r){var i,a=r.payload,s=a.channel,u=a.typingMembers;return ht(s.url,(i=n==null?void 0:n.currentGroupChannel)===null||i===void 0?void 0:i.url)?G(G({},n),{typingMembers:u}):n}).otherwise(function(){return n})}var pL="delivery_receipt";function mL(n,t){var e,r,i,a=n.sdkInit,s=n.currentGroupChannel,u=n.disableMarkAsRead,o=t.sdk,l=t.logger,d=t.scrollRef,c=t.setQuoteMessage,f=t.messagesDispatcher,h=Hn(),m=h.config,_=m.markAsReadScheduler,E=m.markAsDeliveredScheduler,b=m.disableMarkAsDelivered,g=(i=(r=(e=h.stores.sdkStore.sdk)===null||e===void 0?void 0:e.appInfo)===null||r===void 0?void 0:r.premiumFeatureList)===null||i===void 0?void 0:i.find(function(C){return C===pL});N.useEffect(function(){var C,S=s==null?void 0:s.url,A=vi();if(S&&a){var I={onMessageReceived:function(T,M){var O,R;if(T.isGroupChannel()&&ht(T==null?void 0:T.url,S)){var U=!1;try{var P=d.current;P&&(U=P.offsetHeight+P.scrollTop>=P.scrollHeight-10)}catch{}if(l.info("Channel | useHandleChannelEvents: onMessageReceived",M),f({type:om,payload:{channel:T,message:M}}),U&&((O=document.getElementById("sendbird-dropdown-portal"))===null||O===void 0?void 0:O.childElementCount)===0&&((R=document.getElementById("sendbird-emoji-list-portal"))===null||R===void 0?void 0:R.childElementCount)===0)try{setTimeout(function(){return ea(0,d)}),u||_.push(s),g&&!b&&E.push(s)}catch{l.warning("Channel | onMessageReceived | scroll to end failed")}}},onUnreadMemberStatusUpdated:function(T){l.info("Channel | useHandleChannelEvents: onUnreadMemberStatusUpdated",T),ht(T==null?void 0:T.url,S)&&f({type:Jr,payload:T})},onUndeliveredMemberStatusUpdated:function(T){ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onDeliveryReceiptUpdated",T),f({type:Jr,payload:T}))},onMessageUpdated:function(T,M){T.isGroupChannel()&&ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onMessageUpdated",M),f({type:Jo,payload:{channel:T,message:M}}))},onThreadInfoUpdated:function(T,M){T.isGroupChannel()&&ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onThreadInfoUpdated",{channel:T,threadInfoUpdateEvent:M}),f({type:lm,payload:{channel:T,event:M}}))},onMessageDeleted:function(T,M){l.info("Channel | useHandleChannelEvents: onMessageDeleted",{channel:T,messageId:M}),c(null),f({type:el,payload:M})},onReactionUpdated:function(T,M){l.info("Channel | useHandleChannelEvents: onReactionUpdated",{channel:T,reactionEvent:M}),f({type:fm,payload:M})},onChannelChanged:function(T){T.isGroupChannel()&&ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onChannelChanged",T),f({type:Jr,payload:T}))},onChannelFrozen:function(T){T.isGroupChannel()&&ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onChannelFrozen",T),f({type:Jr,payload:T}))},onChannelUnfrozen:function(T){T.isGroupChannel()&&ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onChannelUnFrozen",T),f({type:Jr,payload:T}))},onUserMuted:function(T,M){T.isGroupChannel()&&ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onUserMuted",{channel:T,user:M}),f({type:Jr,payload:T}))},onUserUnmuted:function(T,M){T.isGroupChannel()&&ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onUserUnmuted",{channel:T,user:M}),f({type:Jr,payload:T}))},onUserBanned:function(T,M){var O;if(ht(T==null?void 0:T.url,S)&&T.isGroupChannel()){l.info("Channel | useHandleChannelEvents: onUserBanned",{channel:T,user:M});var R=(M==null?void 0:M.userId)===((O=o==null?void 0:o.currentUser)===null||O===void 0?void 0:O.userId);f({type:Jr,payload:R?null:T})}},onOperatorUpdated:function(T,M){T.isGroupChannel()&&ht(T==null?void 0:T.url,S)&&(l.info("Channel | useHandleChannelEvents: onOperatorUpdated",{channel:T,users:M}),f({type:Jr,payload:T}))},onUserLeft:function(T,M){var O;if(ht(T==null?void 0:T.url,S)){l.info("Channel | useHandleChannelEvents: onUserLeft",{channel:T,user:M});var R=(M==null?void 0:M.userId)===((O=o==null?void 0:o.currentUser)===null||O===void 0?void 0:O.userId);f({type:Jr,payload:R?null:T})}},onTypingStatusUpdated:function(T){if(ht(T==null?void 0:T.url,S)){l.info("Channel | onTypingStatusUpdated",{channel:T});var M=T.getTypingUsers();f({type:_m,payload:{channel:T,typingMembers:M}})}}};l.info("Channel | useHandleChannelEvents: Setup event handler",{channelHandlerId:A,channelHandler:I}),(C=o.groupChannel)===null||C===void 0||C.addGroupChannelHandler(A,new Wo(I))}return function(){var T;!((T=o==null?void 0:o.groupChannel)===null||T===void 0)&&T.removeGroupChannelHandler?(l.info("Channel | useHandleChannelEvents: Removing message reciver handler",A),o.groupChannel.removeGroupChannelHandler(A)):o!=null&&o.groupChannel&&l.error("Channel | useHandleChannelEvents: Not found the removeGroupChannelHandler")}},[s==null?void 0:s.url,a])}function _L(n,t){var e=n.channelUrl,r=n.sdkInit,i=n.disableMarkAsRead,a=t.messagesDispatcher,s=t.sdk,u=t.logger,o=t.markAsReadScheduler;N.useEffect(function(){e&&r&&s&&s.groupChannel&&(u.info("Channel | useSetChannel fetching channel",e),s.groupChannel.getChannel(e).then(function(l){u.info("Channel | useSetChannel fetched channel",l),a({type:Jr,payload:l}),u.info("Channel: Mark as read",l),i||o.push(l)}).catch(function(l){u.warning("Channel | useSetChannel fetch channel failed",{channelUrl:e,e:l}),a({type:cm})}),s.getAllEmoji().then(function(l){u.info("Channel: Getting emojis success",l),a({type:hm,payload:l})}).catch(function(l){u.error("Channel: Getting emojis failed",l)}))},[e,r])}function gL(n,t){var e=n.isOnline,r=n.replyType,i=n.disableMarkAsRead,a=n.reconnectOnIdle,s=t.logger,u=t.sdk,o=t.scrollRef,l=t.currentGroupChannel,d=t.messagesDispatcher,c=t.markAsReadScheduler,f=t.userFilledMessageListQuery,h=v0(e,l,a).shouldReconnect;N.useEffect(function(){return function(){var m,_,E;if(h){s.info("Refreshing conversation state");var b=((m=u==null?void 0:u.appInfo)===null||m===void 0?void 0:m.useReaction)||!1,g={prevResultSize:tc,isInclusive:!0,includeReactions:b,includeMetaArray:!0,nextResultSize:rc};r&&r==="QUOTE_REPLY"&&(g.includeThreadInfo=!0,g.includeParentMessageInfo=!0,g.replyType=Kt.ONLY_REPLY_TO_CHANNEL),f&&Object.keys(f).forEach(function(C){g[C]=f[C]}),s.info("Channel: Fetching messages",{currentGroupChannel:l,userFilledMessageListQuery:f}),d({type:ec,payload:null}),(_=u==null?void 0:u.groupChannel)===null||_===void 0||_.getChannel((E=l==null?void 0:l.url)!==null&&E!==void 0?E:"").then(function(C){var S=new Date().getTime();C.getMessagesByTimestamp(S,g).then(function(A){d({type:nc,payload:{currentGroupChannel:C,messages:A}}),setTimeout(function(){return ea(0,o)},EC)}).catch(function(A){s.error("Channel: Fetching messages failed",A),d({type:Ho,payload:{currentGroupChannel:C}})}),i||c.push(C)})}}},[h,r])}function EL(n,t){var e=n.currentGroupChannel,r=n.oldestMessageTimeStamp,i=n.userFilledMessageListQuery,a=n.replyType,s=t.hasMorePrev,u=t.logger,o=t.messagesDispatcher,l=t.sdk;return N.useCallback(function(d){var c,f;if(s){var h={prevResultSize:tc,isInclusive:!0,includeMetaArray:!0,includeReactions:(f=(c=l==null?void 0:l.appInfo)===null||c===void 0?void 0:c.useReaction)!==null&&f!==void 0?f:!1};(a==="QUOTE_REPLY"||a==="THREAD")&&(h.includeThreadInfo=!0,h.includeParentMessageInfo=!0,h.replyType=Kt.ONLY_REPLY_TO_CHANNEL),i&&Object.keys(i).forEach(function(m){h[m]=i[m]}),u.info("Channel: Fetching messages",{currentGroupChannel:e,userFilledMessageListQuery:i}),e==null||e.getMessagesByTimestamp(r||new Date().getTime(),h).then(function(m){o({type:rm,payload:{currentGroupChannel:e,messages:m}}),d&&setTimeout(function(){return d()})}).catch(function(){o({type:im,payload:{currentGroupChannel:e}})})}},[e,r,a])}function vL(n,t){var e=n.currentGroupChannel,r=n.latestMessageTimeStamp,i=n.userFilledMessageListQuery,a=n.hasMoreNext,s=n.replyType,u=t.logger,o=t.messagesDispatcher,l=t.sdk;return N.useCallback(function(d){var c,f;if(a){var h=(f=(c=l==null?void 0:l.appInfo)===null||c===void 0?void 0:c.useReaction)!==null&&f!==void 0?f:!1,m={nextResultSize:rc,isInclusive:!0,includeReactions:h,includeMetaArray:!0};s&&(s==="QUOTE_REPLY"||s==="THREAD")&&(m.includeThreadInfo=!0,m.includeParentMessageInfo=!0,m.replyType=Kt.ONLY_REPLY_TO_CHANNEL),i&&Object.keys(i).forEach(function(_){m[_]=i[_]}),u.info("Channel: Fetching later messages",{currentGroupChannel:e,userFilledMessageListQuery:i}),e==null||e.getMessagesByTimestamp(r||new Date().getTime(),m).then(function(_){o({type:am,payload:{currentGroupChannel:e,messages:_}}),setTimeout(function(){return d([_,null])})}).catch(function(_){u.error("Channel: Fetching later messages failed",_),o({type:sm,payload:{currentGroupChannel:e}}),setTimeout(function(){return d([null,_])})})}},[e,r,a,s])}function yL(n,t){var e=n.currentGroupChannel,r=n.messagesDispatcher,i=t.logger;return N.useCallback(function(a){i.info("Channel | useDeleteMessageCallback: Deleting message",a);var s=Xo(a)?a.sendingStatus:void 0;return new Promise(function(u,o){i.info("Channel | useDeleteMessageCallback: Deleting message requestState:",s),(s===Qn.FAILED||s===Qn.PENDING)&&"reqId"in a?(i.info("Channel | useDeleteMessageCallback: Deleted message from local:",a),r({type:dm,payload:a.reqId}),u()):(i.info("Channel | useDeleteMessageCallback: Deleting message from remote:",s),e==null||e.deleteMessage(a).then(function(){i.info("Channel | useDeleteMessageCallback: Deleting message success!",a),r({type:el,payload:a.messageId}),u()}).catch(function(l){i.warning("Channel | useDeleteMessageCallback: Deleting message failed!",l),o(l)}))})},[e,r])}function bL(n,t){var e=n.currentGroupChannel,r=n.messagesDispatcher,i=n.onBeforeUpdateUserMessage,a=n.isMentionEnabled,s=t.logger,u=t.pubSub;return N.useCallback(function(o,l){var d=o.messageId,c=o.message,f=o.mentionedUsers,h=o.mentionTemplate,m=function(b){var g={message:b};return a&&f&&f.length>0&&(g.mentionedUsers=f),a&&h?g.mentionedMessageTemplate=h:g.mentionedMessageTemplate=b,g},_=i&&typeof i=="function";_&&s.info("Channel: creating params using onBeforeUpdateUserMessage",i);var E=_?i(c):m(c);s.info("Channel: Updating message!",E),e==null||e.updateUserMessage(d,E).then(function(b){l&&l(null,b),s.info("Channel: Updating message success!",b),r({type:Jo,payload:{channel:e,message:b}}),u.publish(Sr.UPDATE_USER_MESSAGE,{message:b,channel:e,publishingModules:[na.CHANNEL]})}).catch(function(b){l&&l(b,null)})},[e==null?void 0:e.url,r,i])}function CL(n,t){var e=n.currentGroupChannel,r=n.messagesDispatcher,i=t.logger,a=t.pubSub;return N.useCallback(function(s){i.info("Channel: Resending message has started",s),s!=null&&s.isResendable?s.isUserMessage()?e==null||e.resendMessage(s).onPending(function(u){i.info("Channel: Resending message start!",u),r({type:wo,payload:u})}).onSucceeded(function(u){i.info("Channel: Resending message success!",u),r({type:Zi,payload:u})}).onFailed(function(u,o){i.warning("Channel: Resending message failed!",u),r({type:ya,payload:o})}):s.isFileMessage()?e==null||e.resendMessage(s).onPending(function(u){i.info("Channel: Resending file message start!",u),r({type:wo,payload:u})}).onSucceeded(function(u){i.info("Channel: Resending file message success!",u),r({type:Zi,payload:u})}).onFailed(function(u,o){i.warning("Channel: Resending file message failed!",u),r({type:ya,payload:o})}):s.isMultipleFilesMessage()&&(e==null||e.resendMessage(s).onPending(function(u){i.info("Channel: Resending multiple files message start!",u),r({type:wo,payload:u})}).onFileUploaded(function(u,o,l,d){var c;i.info("Channel: Resending multiple files message file uploaded!",{requestId:u,index:o,error:d,uploadableFileInfo:l}),a.publish(Sr.ON_FILE_INFO_UPLOADED,{response:{channelUrl:(c=e==null?void 0:e.url)!==null&&c!==void 0?c:"",requestId:u,index:o,uploadableFileInfo:l,error:d},publishingModules:[na.CHANNEL]})}).onSucceeded(function(u){i.info("Channel: Resending multiple files message success!",u),r({type:Zi,payload:u})}).onFailed(function(u,o){i.warning("Channel: Resending multiple files message failed!",u),r({type:ya,payload:o})})):i.error("Message is not resendable",s)},[e,r])}function SL(n,t){var e=n.isMentionEnabled,r=n.currentGroupChannel,i=n.onBeforeSendUserMessage,a=t.logger,s=t.pubSub,u=t.scrollRef,o=t.messagesDispatcher,l=N.useRef(null),d=N.useCallback(function(c){var f=c.quoteMessage,h=c.message,m=c.mentionTemplate,_=c.mentionedUsers,E=function(){var C={message:h};return e&&_&&_.length>0&&(C.mentionedUsers=_),e&&m&&_&&_.length>0&&(C.mentionedMessageTemplate=m),f&&(C.isReplyToChannel=!0,C.parentMessageId=f.messageId),C},b=i&&typeof i=="function";b&&a.info("Channel: creating params using onBeforeSendUserMessage",i);var g=b?i(h,f):E();a.info("Channel: Sending message has started",g),r==null||r.sendUserMessage(g).onPending(function(C){s.publish(Sr.SEND_MESSAGE_START,{message:C,channel:r,publishingModules:[na.CHANNEL]}),setTimeout(function(){return ea(0,u)},bu)}).onFailed(function(C,S){a.warning("Channel: Sending message failed!",{message:S,error:C}),o({type:ya,payload:S})}).onSucceeded(function(C){a.info("Channel: Sending message success!",C),o({type:Zi,payload:C})})},[r,i]);return[l,d]}function TL(n,t){var e=n.currentGroupChannel,r=n.onBeforeSendFileMessage,i=n.imageCompression,a=t.logger,s=t.pubSub,u=t.scrollRef,o=t.messagesDispatcher,l=N.useCallback(function(d,c){return new Promise(function(f,h){var m=r==null?void 0:r(d,c);m||(m={file:d},c&&(m.isReplyToChannel=!0,m.parentMessageId=c.messageId)),a.info("Channel: Uploading file message start!",m),e==null||e.sendFileMessage(m).onPending(function(_){s.publish(Sr.SEND_MESSAGE_START,{message:G(G({},_),{url:URL.createObjectURL(d),requestState:"pending",isUserMessage:_.isUserMessage,isFileMessage:_.isFileMessage,isAdminMessage:_.isAdminMessage,isMultipleFilesMessage:_.isMultipleFilesMessage}),channel:e,publishingModules:[na.CHANNEL]}),setTimeout(function(){return ea(0,u)},bu)}).onFailed(function(_,E){a.error("Channel: Sending file message failed!",{failedMessage:E,err:_}),E.localUrl=URL.createObjectURL(d),E.file=d,o({type:ya,payload:E}),h(_)}).onSucceeded(function(_){a.info("Channel: Sending file message success!",_),o({type:Zi,payload:_}),f(_)})})},[e,r,i]);return[l]}function NL(n){var t=n.current,e=t==null?void 0:t.parentNode;t&&e&&(t.style.pointerEvents="none",e.style.cursor="wait")}function IL(n){var t=n.current,e=t==null?void 0:t.parentNode;t&&e&&(t.style.pointerEvents="auto",e.style.cursor="auto")}function AL(n,t){var e=n.setInitialTimeStamp,r=n.setAnimatedMessageId,i=n.allMessages,a=n.scrollRef,s=t.logger;return N.useCallback(function(u,o){var l=i.find(function(d){return d.messageId===o});r(null),setTimeout(function(){try{s.info("Channel: scroll to message - disabling mouse events"),NL(a),l?(s.info("Channel: scroll to message - message is present"),r(o),h0(a,u)):(s.info("Channel: scroll to message - fetching older messages"),e(null),e(u),r(o))}finally{s.info("Channel: scroll to message - enabled mouse events"),IL(a)}})},[e,r,i])}var ML=function(n,t){var e=n.currentGroupChannel,r=n.onBeforeSendVoiceMessage,i=t.logger,a=t.pubSub,s=t.scrollRef,u=t.messagesDispatcher,o=N.useCallback(function(l,d,c){return new Promise(function(f,h){if(e){var m=r&&typeof r=="function"?r(l,c):{file:l,fileName:Id,mimeType:Rs,metaArrays:[new Er({key:Ww,value:["".concat(d)]}),new Er({key:Yw,value:[Qw]})]};c&&(m.isReplyToChannel=!0,m.parentMessageId=c.messageId),i.info("Channel: Start sending voice message",m),e.sendFileMessage(m).onPending(function(_){a.publish(Sr.SEND_MESSAGE_START,{message:_,channel:e,publishingModules:[na.CHANNEL]}),setTimeout(function(){return ea(0,s)},bu)}).onFailed(function(_,E){i.error("Channel: Sending voice message failed!",{failedMessage:E,err:_}),u({type:ya,payload:E}),h(_)}).onSucceeded(function(_){i.info("Channel: Sending voice message success!",_),u({type:Zi,payload:_}),f(_)})}})},[e,r]);return[o]},wL=function(n){var t=n.channelUrl,e=n.sdkInit,r=n.pubSub,i=n.dispatcher,a=n.scrollRef;N.useEffect(function(){var s=new Map;return r!=null&&r.subscribe&&(s.set(pr.SEND_USER_MESSAGE,r.subscribe(pr.SEND_USER_MESSAGE,function(u){var o=u.channel,l=u.message;t===(o==null?void 0:o.url)&&(i({type:Zi,payload:l}),setTimeout(function(){return ea(0,a)},bu))})),s.set(pr.SEND_MESSAGE_START,r.subscribe(pr.SEND_MESSAGE_START,function(u){var o=u.channel,l=u.message,d=u.publishingModules;t===(o==null?void 0:o.url)&&Xl(d)&&i({type:um,payload:l})})),s.set(pr.ON_FILE_INFO_UPLOADED,r.subscribe(pr.ON_FILE_INFO_UPLOADED,function(u){var o=u.response,l=u.publishingModules;t===o.channelUrl&&Xl(l)&&i({type:mm,payload:o})})),s.set(pr.SEND_MESSAGE_FAILED,r.subscribe(pr.SEND_MESSAGE_FAILED,function(u){var o=u.channel,l=u.message,d=u.publishingModules;t===(o==null?void 0:o.url)&&Xl(d)&&i({type:ya,payload:l})})),s.set(pr.SEND_FILE_MESSAGE,r.subscribe(pr.SEND_FILE_MESSAGE,function(u){var o=u.channel,l=u.message;t===(o==null?void 0:o.url)&&(i({type:Zi,payload:l}),setTimeout(function(){return ea(0,a)},bu))})),s.set(pr.UPDATE_USER_MESSAGE,r.subscribe(pr.UPDATE_USER_MESSAGE,function(u){var o=u.channel,l=u.message,d=u.fromSelector;d&&t===(o==null?void 0:o.url)&&o.isGroupChannel()&&i({type:Jo,payload:{channel:o,message:l}})})),s.set(pr.DELETE_MESSAGE,r.subscribe(pr.DELETE_MESSAGE,function(u){var o=u.channel,l=u.messageId;t===(o==null?void 0:o.url)&&i({type:el,payload:l})}))),function(){s.forEach(function(u){try{u.remove()}catch{}})}},[t,e])},C0=p.createContext(null),OL=function(n){var t,e,r,i,a,s,u=n.channelUrl,o=n.children,l=n.isReactionEnabled,d=n.isMessageGroupingEnabled,c=d===void 0?!0:d,f=n.isMultipleFilesMessageEnabled,h=n.showSearchIcon,m=n.animatedMessage,_=n.highlightedMessage,E=n.startingPoint,b=n.onBeforeSendUserMessage,g=n.onBeforeSendFileMessage,C=n.onBeforeUpdateUserMessage,S=n.onBeforeSendVoiceMessage,A=n.onBeforeSendMultipleFilesMessage,I=n.onChatHeaderActionClick,T=n.onSearchClick,M=n.onBackClick,O=n.threadReplySelectType,R=n.queries,U=n.filterMessageList,P=n.disableMarkAsRead,L=P===void 0?!1:P,F=n.onReplyInThread,B=n.onQuoteMessageClick,V=n.onMessageAnimated,K=n.onMessageHighlighted,$=n.scrollBehavior,q=$===void 0?"auto":$,se=n.reconnectOnIdle,Y=se===void 0?!0:se,ce=Hn(),X=ce.config,Se=(t=n.replyType)!==null&&t!==void 0?t:gm(X.groupChannel.replyType).upperCase,te=X.pubSub,be=X.logger,xe=X.userId,Pe=X.isOnline,vn=X.imageCompression,on=X.markAsReadScheduler,je=X.groupChannel,Xe=(r=(e=ce==null?void 0:ce.stores)===null||e===void 0?void 0:e.sdkStore)===null||r===void 0?void 0:r.sdk,sn=(a=(i=ce==null?void 0:ce.stores)===null||i===void 0?void 0:i.sdkStore)===null||a===void 0?void 0:a.initialized,un=ce==null?void 0:ce.config,En=N.useState(E),rn=En[0],qe=En[1];N.useEffect(function(){qe(E)},[E,u]);var Je=N.useState(null),ln=Je[0],dn=Je[1],ve=N.useState(_),De=ve[0],Ye=ve[1];N.useEffect(function(){Ye(_)},[_]);var en=R==null?void 0:R.messageListParams,fn=N.useState(null),Fe=fn[0],Nn=fn[1],nn=N.useState(!1),_e=nn[0],zn=nn[1],Rn=N.useReducer(hL,fL),bn=Rn[0],Ge=Rn[1],cn=N.useRef(null),On=je.enableMention,Ln=bn.allMessages,In=bn.localMessages,et=bn.loading,Gn=bn.initialized,Cn=bn.unreadSince,mn=bn.unreadSinceDate,ze=bn.isInvalid,ue=bn.currentGroupChannel,Q=bn.hasMorePrev,Te=bn.oldestMessageTimeStamp,He=bn.hasMoreNext,$e=bn.latestMessageTimeStamp,Ee=bn.emojiContainer,fe=bn.readStatus,We=bn.typingMembers,yn=p0({channel:ue,config:X,moduleLevel:l}),Yn=N.useMemo(function(){return yn?AD(Ee):new Map},[Ee]),Sn=N.useMemo(function(){return yn&&ue?MD(ue==null?void 0:ue.members):new Map},[ue==null?void 0:ue.members]);N.useEffect(function(){m&&dn(m)},[m]);var rt=EL({currentGroupChannel:ue,oldestMessageTimeStamp:Te,userFilledMessageListQuery:en,replyType:Se},{hasMorePrev:Q,logger:be,messagesDispatcher:Ge,sdk:Xe}),Ct=AL({setInitialTimeStamp:qe,setAnimatedMessageId:dn,allMessages:Ln,scrollRef:cn},{logger:be}),pe=vL({currentGroupChannel:ue,latestMessageTimeStamp:$e,userFilledMessageListQuery:en,hasMoreNext:He,replyType:Se},{logger:be,messagesDispatcher:Ge,sdk:Xe}),Le=lL(ue,be);_L({channelUrl:u,sdkInit:sn,disableMarkAsRead:L},{messagesDispatcher:Ge,sdk:Xe,logger:be,markAsReadScheduler:on}),N.useEffect(function(){Nn(null)},[u]),mL({currentGroupChannel:ue,sdkInit:sn,currentUserId:xe,disableMarkAsRead:L},{messagesDispatcher:Ge,sdk:Xe,logger:be,scrollRef:cn,setQuoteMessage:Nn}),uL({currentGroupChannel:ue,userFilledMessageListQuery:en,initialTimeStamp:rn,replyType:Se,setIsScrolled:zn},{logger:be,scrollRef:cn,messagesDispatcher:Ge}),wL({channelUrl:u,sdkInit:sn,pubSub:te,dispatcher:Ge,scrollRef:cn}),gL({isOnline:Pe,replyType:Se,disableMarkAsRead:L,reconnectOnIdle:Y},{logger:be,sdk:Xe,scrollRef:cn,currentGroupChannel:ue,messagesDispatcher:Ge,userFilledMessageListQuery:en,markAsReadScheduler:on});var ae=yL({currentGroupChannel:ue,messagesDispatcher:Ge},{logger:be}),Qe=bL({currentGroupChannel:ue,messagesDispatcher:Ge,onBeforeUpdateUserMessage:C,isMentionEnabled:On},{logger:be,pubSub:te}),an=CL({currentGroupChannel:ue,messagesDispatcher:Ge},{logger:be,pubSub:te}),Tn=SL({currentGroupChannel:ue,isMentionEnabled:On,onBeforeSendUserMessage:b},{logger:be,pubSub:te,scrollRef:cn,messagesDispatcher:Ge}),xn=Tn[0],it=Tn[1],lt=TL({currentGroupChannel:ue,imageCompression:vn,onBeforeSendFileMessage:g},{logger:be,pubSub:te,scrollRef:cn,messagesDispatcher:Ge})[0],Ie=ML({currentGroupChannel:ue,onBeforeSendVoiceMessage:S},{logger:be,pubSub:te,scrollRef:cn,messagesDispatcher:Ge})[0],j=cL({currentChannel:ue,onBeforeSendMultipleFilesMessage:A,publishingModules:[na.CHANNEL]},{logger:be,pubSub:te,scrollRef:cn})[0];return p.createElement(C0.Provider,{value:{channelUrl:u,isReactionEnabled:yn,isMessageGroupingEnabled:c,isMultipleFilesMessageEnabled:f,showSearchIcon:h??un.groupChannelSettings.enableMessageSearch,highlightedMessage:_,startingPoint:E,onBeforeSendUserMessage:b,onBeforeSendFileMessage:g,onBeforeUpdateUserMessage:C,onChatHeaderActionClick:I,onSearchClick:T,onBackClick:M,replyType:Se,threadReplySelectType:(s=O??dL(je.threadReplySelectType).upperCase)!==null&&s!==void 0?s:Ii.THREAD,queries:R,filterMessageList:U,disableMarkAsRead:L,onReplyInThread:F,onQuoteMessageClick:B,onMessageAnimated:V,onMessageHighlighted:K,allMessages:Ln,localMessages:In,loading:et,initialized:Gn,unreadSince:Cn,unreadSinceDate:mn,isInvalid:ze,currentGroupChannel:ue,hasMorePrev:Q,hasMoreNext:He,oldestMessageTimeStamp:Te,latestMessageTimeStamp:$e,emojiContainer:Ee,readStatus:fe,typingMembers:We,scrollToMessage:Ct,quoteMessage:Fe,setQuoteMessage:Nn,deleteMessage:ae,updateMessage:Qe,resendMessage:an,messageInputRef:xn,sendMessage:it,sendFileMessage:lt,sendVoiceMessage:Ie,sendMultipleFilesMessage:j,initialTimeStamp:rn,messageActionTypes:sL,messagesDispatcher:Ge,setInitialTimeStamp:qe,setAnimatedMessageId:dn,setHighLightedMessageId:Ye,animatedMessageId:ln,highLightedMessageId:De,nicknamesMap:Sn,emojiAllMap:Yn,onScrollCallback:rt,onScrollDownCallback:pe,scrollRef:cn,scrollBehavior:q,toggleReaction:Le,isScrolled:_e,setIsScrolled:zn}},p.createElement(d0,G({},n),o))},rs=function(){var n=p.useContext(C0);if(!n)throw new Error("ChannelContext not found. Use within the Channel module.");return n},S0=function(n){var t=n.members;function e(){var r=N.useContext(wt).stringSet;return!t||t.length===0?"":t&&t.length===1?"".concat(t[0].nickname," ").concat(r.TYPING_INDICATOR__IS_TYPING):t&&t.length===2?"".concat(t[0].nickname," ").concat(r.TYPING_INDICATOR__AND," ").concat(t[1].nickname," ").concat(r.TYPING_INDICATOR__ARE_TYPING):r.TYPING_INDICATOR__MULTIPLE_TYPING}return p.createElement(p.Fragment,null,e())},RL=function(n){var t,e,r,i=n.channelUrl,a=Hn(),s=(e=(t=a==null?void 0:a.stores)===null||t===void 0?void 0:t.sdkStore)===null||e===void 0?void 0:e.sdk,u=(r=a==null?void 0:a.config)===null||r===void 0?void 0:r.logger,o=N.useState(vi()),l=o[0],d=o[1],c=N.useState([]),f=c[0],h=c[1];return N.useEffect(function(){var m;if(!((m=s==null?void 0:s.groupChannel)===null||m===void 0)&&m.addGroupChannelHandler){s.groupChannel.removeGroupChannelHandler(l);var _=vi(),E=new Wo({onTypingStatusUpdated:function(b){if(u.info("Channel > Typing Indicator: onTypingStatusUpdated",b),b.url===i){var g=b.getTypingUsers();h(g)}}});s.groupChannel.addGroupChannelHandler(_,E),d(_)}return function(){var b;h([]),!((b=s==null?void 0:s.groupChannel)===null||b===void 0)&&b.removeGroupChannelHandler&&s.groupChannel.removeGroupChannelHandler(l)}},[i]),p.createElement(me,{className:"sendbird-conversation__footer__typing-indicator__text",type:he.CAPTION_2,color:re.ONBACKGROUND_2},p.createElement(S0,{members:f}))},Ld;(function(n){n.Text="text",n.Bubble="bubble"})(Ld||(Ld={}));function DL(){var n=N.useContext(wt).stringSet;return p.createElement("div",{className:"sendbird-connection-status"},p.createElement(me,{type:he.BODY_2,color:re.ONBACKGROUND_2},n.TRYING_TO_CONNECT),p.createElement(Ue,{type:ye.DISCONNECTED,fillColor:Me.SENT,width:"14px",height:"14px"}))}function ic(n){var t=n.className,e=t===void 0?"":t,r=n.width,i=r===void 0?"26px":r,a=n.height,s=a===void 0?"26px":a,u=n.children,o=n.testID;return p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-loader"],!1).join(" "),"data-testid":o,style:{width:typeof i=="string"?i:"".concat(i,"px"),height:typeof s=="string"?s:"".concat(s,"px")}},u||p.createElement(Ue,{type:ye.SPINNER,width:"26px",height:"26px"}))}var Ut={LOADING:"LOADING",NO_CHANNELS:"NO_CHANNELS",NO_MESSAGES:"NO_MESSAGES",WRONG:"WRONG",SEARCH_IN:"SEARCH_IN",SEARCHING:"SEARCHING",NO_RESULTS:"NO_RESULTS"};function Ki(n){var t=n.className,e=t===void 0?"":t,r=n.type,i=n.iconSize,a=n.searchInString,s=a===void 0?"":a,u=n.retryToConnect,o=N.useContext(wt).stringSet;return p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-place-holder"],!1).join(" ")},r===Ut.LOADING&&p.createElement(ic,{width:i||"48px",height:i||"48px"},p.createElement(Ue,{type:ye.SPINNER,fillColor:Me.PRIMARY,width:i||"48px",height:i||"48px"})),(r===Ut.NO_CHANNELS||r===Ut.NO_MESSAGES||r===Ut.WRONG)&&p.createElement("div",{className:"sendbird-place-holder__body"},r===Ut.NO_CHANNELS&&p.createElement(Ue,{className:"sendbird-place-holder__body__icon",type:ye.CHAT,fillColor:Me.ON_BACKGROUND_3,width:i||"64px",height:i||"64px"}),r===Ut.WRONG&&p.createElement(Ue,{className:"sendbird-place-holder__body__icon",type:ye.ERROR,fillColor:Me.ON_BACKGROUND_3,width:i||"64px",height:i||"64px"}),r===Ut.NO_MESSAGES&&p.createElement(Ue,{className:"sendbird-place-holder__body__icon",type:ye.MESSAGE,fillColor:Me.ON_BACKGROUND_3,width:i||"64px",height:i||"64px"}),p.createElement(me,{className:"sendbird-place-holder__body__text",type:he.BODY_1,color:re.ONBACKGROUND_2},r===Ut.NO_CHANNELS&&o.PLACE_HOLDER__NO_CHANNEL,r===Ut.WRONG&&o.PLACE_HOLDER__WRONG,r===Ut.NO_MESSAGES&&o.PLACE_HOLDER__NO_MESSAGES),u&&p.createElement("div",{className:"sendbird-place-holder__body__reconnect",role:"button",onClick:u,onKeyPress:u,tabIndex:0},p.createElement(Ue,{className:"sendbird-place-holder__body__reconnect__icon",type:ye.REFRESH,fillColor:Me.PRIMARY,width:"20px",height:"20px"}),p.createElement(me,{className:"sendbird-place-holder__body__reconnect__text",type:he.BUTTON_1,color:re.PRIMARY},o.PLACE_HOLDER__RETRY_TO_CONNECT))),(r===Ut.NO_RESULTS||r===Ut.SEARCH_IN||r===Ut.SEARCHING)&&p.createElement("div",{className:"sendbird-place-holder__body--align-top"},r===Ut.SEARCH_IN&&p.createElement("div",{className:"sendbird-place-holder__body--align-top__text"},p.createElement(me,{className:"sendbird-place-holder__body--align-top__text__search-in",type:he.BUTTON_2,color:re.ONBACKGROUND_2},o.SEARCH_IN),p.createElement(me,{className:"sendbird-place-holder__body--align-top__text__channel-name",type:he.BUTTON_2,color:re.PRIMARY},"'".concat(s)),p.createElement(me,{className:"sendbird-place-holder__body--align-top__text__quote",type:he.BUTTON_2,color:re.PRIMARY},"'")),r===Ut.SEARCHING&&p.createElement(me,{className:"sendbird-place-hlder__body--align-top__searching",type:he.BODY_1,color:re.ONBACKGROUND_2},o.SEARCHING),r===Ut.NO_RESULTS&&p.createElement(me,{className:"sendbird-place-hlder__body--align-top__no-result",type:he.BODY_1,color:re.ONBACKGROUND_2},o.NO_SEARCHED_MESSAGE)))}var LL=function(n){var t,e,r,i,a=n.isLoading,s=n.isInvalid,u=n.channelUrl,o=Zo(n),l=o.renderChannelHeader,d=o.renderMessageList,c=o.renderMessageInput,f=o.renderTypingIndicator,h=o.renderPlaceholderLoader,m=o.renderPlaceholderInvalid,_=Hn(),E=_.stores,b=_.config,g=(t=E==null?void 0:E.sdkStore)===null||t===void 0?void 0:t.error,C=b.logger,S=b.isOnline;return a?p.createElement("div",{className:"sendbird-conversation"},(h==null?void 0:h())||p.createElement(Ki,{type:Ut.LOADING})):u?s?p.createElement("div",{className:"sendbird-conversation"},(m==null?void 0:m())||p.createElement(Ki,{type:Ut.WRONG})):g?p.createElement("div",{className:"sendbird-conversation"},(m==null?void 0:m())||p.createElement(Ki,{type:Ut.WRONG,retryToConnect:function(){C.info("Channel: reconnecting")}})):p.createElement("div",{className:"sendbird-conversation"},l==null?void 0:l({className:"sendbird-conversation__channel-header"}),d==null?void 0:d(n),p.createElement("div",{className:"sendbird-conversation__footer"},c==null?void 0:c(),p.createElement("div",{className:"sendbird-conversation__footer__typing-indicator"},(f==null?void 0:f())||((e=b==null?void 0:b.groupChannel)===null||e===void 0?void 0:e.enableTypingIndicator)&&((i=(r=b==null?void 0:b.groupChannel)===null||r===void 0?void 0:r.typingIndicatorTypes)===null||i===void 0?void 0:i.has(Ld.Text))&&p.createElement(RL,{channelUrl:u}),!S&&p.createElement(DL,null)))):p.createElement("div",{className:"sendbird-conversation"},(m==null?void 0:m())||p.createElement(Ki,{type:Ut.NO_CHANNELS}))},T0=function(n){if(n!==null)return typeof n=="number"?"".concat(n,"px"):n};function YE(n,t,e){var r;return"min(".concat(t??e,", ").concat((r=T0(n))!==null&&r!==void 0?r:e,")")}function UL(n){var t=n.width,e=n.height,r=n.maxSideLength,i=n.defaultMinLength,a=N.useMemo(function(){return YE(t,r,i)},[t]),s=N.useMemo(function(){return YE(e,r,i)},[e]);return[a,s]}var kL=function(){var n=N.useState(!1),t=n[0],e=n[1],r=N.useState(null),i=r[0],a=r[1],s=N.useCallback(function(u){u!==null&&a(u)},[]);return N.useEffect(function(){if(i){var u=new IntersectionObserver(function(o){var l=o[0];e(l.isIntersecting)});return u.observe(i),function(){u.disconnect()}}},[i]),[s,t]},xL=function(){var n=N.useRef(!1),t=kL(),e=t[0],r=t[1];return r&&(n.current=!0),[e,n.current]};function QE(n,t){return n===void 0&&(n=!1),t===void 0&&(t=null),n?"50%":T0(t)}function PL(n,t,e){var r=typeof n=="string"?parseInt(n,10):n,i=e-1,a=t===0?r*2:r,s=t===1?r*2:r,u=t===i?r*2:r,o=t===i-1?r*2:r;return"".concat(a,"px ").concat(s,"px ").concat(u,"px ").concat(o,"px")}var Xt=function(n){var t=n.className,e=t===void 0?"":t,r=n.url,i=n.alt,a=i===void 0?"":i,s=n.width,u=s===void 0?null:s,o=n.maxSideLength,l=o===void 0?null:o,d=n.height,c=d===void 0?null:d,f=n.circle,h=f===void 0?!1:f,m=n.fixedSize,_=m===void 0?!1:m,E=n.placeHolder,b=E===void 0?null:E,g=n.defaultComponent,C=g===void 0?null:g,S=n.borderRadius,A=S===void 0?null:S,I=n.onLoad,T=I===void 0?ot:I,M=n.onError,O=M===void 0?ot:M,R=n.shadeOnHover,U=n.isUploaded,P=U===void 0?!0:U,L=xL(),F=L[0],B=L[1],V=B?r:null,K=N.useState(!1),$=K[0],q=K[1],se=N.useState(!0),Y=se[0],ce=se[1],X=UL({width:u,height:c,maxSideLength:l,defaultMinLength:"400px"}),Se=X[0],te=X[1],be=function(){return typeof b=="function"?b({style:{width:"100%",minWidth:Se,maxWidth:_?Se:"400px",height:te,position:"absolute",display:"flex",justifyContent:"center",alignItems:"center"}}):b},xe=function(){return typeof C=="function"?C():C},Pe=function(){var vn=V?{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover",backgroundImage:"url(".concat(V,")")}:{};return p.createElement("div",{className:"sendbird-image-renderer__image",style:G({width:"100%",minWidth:Se,maxWidth:_?Se:"400px",height:te,position:"absolute",borderRadius:QE(h,A)},vn)})};return Se&&te&&p.createElement("div",{ref:F,className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-image-renderer"],!1).join(" "),style:{width:"100%",minWidth:Se,maxWidth:_?Se:"400px",height:te}},Y&&be(),!V||$?xe():Pe(),R&&p.createElement("div",{className:"sendbird-multiple-files-image-renderer__image-cover",style:G({borderRadius:QE(h,A)},P?{}:{display:"inline-flex"})}),V&&p.createElement(FL,{src:V,alt:a,onLoadStart:function(){ce(!0),q(!1)},onLoad:function(){ce(!1),q(!1),T()},onError:function(){ce(!1),q(!0),O()}}))},FL=function(n){var t=n.src,e=n.alt,r=n.onLoadStart,i=r===void 0?ot:r,a=n.onLoad,s=a===void 0?ot:a,u=n.onError,o=u===void 0?ot:u,l=N.useRef({currSrc:t,prevSrc:t,loadFailure:!1});return l.current.currSrc!==t&&(l.current.prevSrc=l.current.currSrc,l.current.currSrc=t),N.useLayoutEffect(function(){if(t){var d=l.current.prevSrc!==l.current.currSrc,c=l.current.loadFailure;(d||c)&&i()}},[t,navigator.onLine]),p.createElement("img",{className:"sendbird-image-renderer__hidden-image-loader",src:t,alt:e,onLoad:function(){l.current.loadFailure=!1,s()},onError:function(){l.current.loadFailure=!0,o()}})},Su=function(n){if(typeof n=="number")return n;if(typeof n=="string"){var t=Number.parseFloat(n);if(!Number.isNaN(t))return t}return NaN},N0=function(n){var t=n.width,e=n.height,r=n.text,i=Su(t),a=Su(e);return typeof i=="number"&&!Number.isNaN(i)&&(i*=.575),typeof a=="number"&&!Number.isNaN(a)&&(a*=.575),p.createElement("div",{className:Fn("sendbird-avatar-img--default",r&&"text"),style:{width:t,height:e}},r?p.createElement("div",{className:"sendbird-avatar-text"},r):p.createElement(Ue,{type:ye.USER,fillColor:Me.CONTENT,width:i,height:a}))},aa="sendbird-avatar-img",HL=function(n){var t=n.src,e=t===void 0?"":t,r=n.alt,i=r===void 0?"":r,a=n.height,s=n.width,u=n.customDefaultComponent,o=function(){return u?u({width:s,height:a}):p.createElement(N0,{width:s,height:a})};return typeof e=="string"?p.createElement(Xt,{className:aa,url:e,height:a,width:s,alt:i,defaultComponent:o}):e&&e.length?e.length===1?p.createElement(Xt,{className:aa,url:e[0],height:a,width:s,alt:i,defaultComponent:o}):e.length===2?p.createElement("div",{className:"sendbird-avatar--inner__two-child"},p.createElement(Xt,{className:aa,url:e[0],height:a,width:s,alt:i,defaultComponent:o}),p.createElement(Xt,{className:aa,url:e[1],height:a,width:s,alt:i,defaultComponent:o})):e.length===3?p.createElement(p.Fragment,null,p.createElement("div",{className:"sendbird-avatar--inner__three-child--upper"},p.createElement(Xt,{className:aa,url:e[0],height:a,width:s,alt:i,defaultComponent:o})),p.createElement("div",{className:"sendbird-avatar--inner__three-child--lower"},p.createElement(Xt,{className:aa,url:e[1],height:a,width:s,alt:i,defaultComponent:o}),p.createElement(Xt,{className:aa,url:e[2],height:a,width:s,alt:i,defaultComponent:o}))):p.createElement("div",{className:"sendbird-avatar--inner__four-child"},e.slice(0,4).map(function(l,d){return p.createElement(Xt,{className:aa,url:l,height:a,width:s,alt:i,key:"".concat(l,"-").concat(d),defaultComponent:o})})):p.createElement(Xt,{className:aa,url:"",height:a,width:s,alt:i,defaultComponent:o})};function BL(n,t){var e=n.className,r=e===void 0?"":e,i=n.src,a=i===void 0?"":i,s=n.alt,u=s===void 0?"":s,o=n.width,l=o===void 0?"56px":o,d=n.height,c=d===void 0?"56px":d,f=n.zIndex,h=f===void 0?0:f,m=n.left,_=m===void 0?"":m,E=n.bottom,b=E===void 0?"":E,g=n.onClick,C=n.customDefaultComponent;return p.createElement("div",{className:Ce(Ce([],Array.isArray(r)?r:[r],!0),["sendbird-avatar"],!1).join(" "),role:"button",ref:t,style:{height:c,width:l,zIndex:h,left:_,bottom:b},onClick:g,onKeyDown:g,tabIndex:0},p.createElement(HL,{src:a,width:l,height:c,alt:u,customDefaultComponent:C}))}var zr=p.forwardRef(BL),I0="https://static.sendbird.com/sample/cover/cover_",nf=function(n,t){return n!=null&&n.coverUrl&&!new RegExp("^".concat(I0)).test(n.coverUrl)?n.coverUrl:((n==null?void 0:n.members)||[]).filter(function(e){return e.userId!==t}).map(function(e){var r=e.profileUrl;return r})},GL=function(n){return n!=null&&n.coverUrl?!!new RegExp("^".concat(I0)).test(n.coverUrl):!0};function A0(n){var t=n.channel,e=n.userId,r=n.theme,i=n.width,a=i===void 0?56:i,s=n.height,u=s===void 0?56:s,o=t==null?void 0:t.isBroadcast,l=N.useMemo(function(){return o?GL(t)?p.createElement("div",{className:"sendbird-chat-header--default-avatar",style:{width:a,height:u,display:"flex",justifyContent:"center",alignItems:"center"}},p.createElement(Ue,{type:ye.BROADCAST,fillColor:Me.CONTENT,width:a*.575,height:u*.575})):p.createElement(zr,{className:"sendbird-chat-header--avatar--broadcast-channel",src:nf(t,e),width:a,height:u,alt:t==null?void 0:t.name}):p.createElement(zr,{className:"sendbird-chat-header--avatar--group-channel",src:nf(t,e),width:"".concat(a,"px"),height:"".concat(u,"px"),alt:t==null?void 0:t.name})},[nf(t,e),r]);return p.createElement(p.Fragment,null,l)}var VL=function(n,t,e){var r,i=e||$s;return!(n!=null&&n.name)&&!(n!=null&&n.members)?i.NO_TITLE:UC(n)?((r=n==null?void 0:n.members)===null||r===void 0?void 0:r.length)===1?i.NO_MEMBERS:n==null?void 0:n.members.filter(function(a){var s=a.userId;return s!==t}).map(function(a){var s=a.nickname;return s||i.NO_NAME}).join(", "):n.name},ti;(function(n){n.ONBACKGROUND_1="ONBACKGROUND_1",n.ONBACKGROUND_2="ONBACKGROUND_2",n.ONBACKGROUND_3="ONBACKGROUND_3",n.ONBACKGROUND_4="ONBACKGROUND_4",n.ONCONTENT_1="ONCONTENT_1",n.ONCONTENT_2="ONCONTENT_2",n.PRIMARY="PRIMARY",n.ERROR="ERROR"})(ti||(ti={}));var lp=function(n){switch(n){case ti.ONBACKGROUND_1:return"sendbird-color--onbackground-1";case ti.ONBACKGROUND_2:return"sendbird-color--onbackground-2";case ti.ONBACKGROUND_3:return"sendbird-color--onbackground-3";case ti.ONBACKGROUND_4:return"sendbird-color--onbackground-4";case ti.ONCONTENT_1:return"sendbird-color--oncontent-1";case ti.PRIMARY:return"sendbird-color--primary";case ti.ERROR:return"sendbird-color--error";default:return""}},nl=function(n){var t=n.className,e=t===void 0?"":t,r=n.color,i=r===void 0?ti.ONBACKGROUND_1:r,a=n.disabled,s=a===void 0?!1:a,u=n.disableUnderline,o=u===void 0?!1:u,l=n.onClick,d=l===void 0?function(){}:l,c=n.children;return p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),[lp(i),o?"sendbird-textbutton--not-underline":"sendbird-textbutton",s?"sendbird-textbutton--disabled":""],!1).join(" "),role:"button",tabIndex:0,onClick:function(f){return d(f)},onKeyPress:function(f){return d(f)}},c)},jL=function(n){var t,e=n.className,r=n.renderLeft,i=n.renderRight,a=n.renderMiddle,s=!1;try{s=(t=Nr==null?void 0:Nr())===null||t===void 0?void 0:t.isMobile}catch{}return p.createElement("div",{className:Fn("sendbird-ui-header",e),"data-testid":"sendbird-ui-header"},r?p.createElement("div",{className:Fn("sendbird-ui-header__left",s?"sendbird-ui-header--is-mobile":"sendbird-ui-header--is-desktop")},r==null?void 0:r()):null,p.createElement("div",{className:"sendbird-ui-header__middle"},a==null?void 0:a()),i?p.createElement("div",{className:Fn("sendbird-ui-header__right",s?"sendbird-ui-header--is-mobile":"sendbird-ui-header--is-desktop")},i==null?void 0:i()):null)},qL=function(n){var t=n.title,e=n.subtitle,r=n.onClickSubtitle;return p.createElement("div",{className:"sendbird-ui-header__middle"},t&&p.createElement(me,{className:"sendbird-ui-header__middle__title",type:he.H_2,color:re.ONBACKGROUND_1},t),e&&(r?p.createElement(nl,{className:"sendbird-ui-header__middle__subtitle__container",onClick:r,disableUnderline:!0},p.createElement(me,{className:"sendbird-ui-header__middle__subtitle",type:he.CAPTION_3,color:re.ONBACKGROUND_2},e)):p.createElement(me,{className:"sendbird-ui-header__middle__subtitle",type:he.BODY_1,color:re.ONBACKGROUND_2},e)))},zL=function(n){var t=n.className,e=n.onClick,r=n.type,i=n.color,a=n.width,s=a===void 0?"32px":a,u=n.height,o=u===void 0?"32px":u,l=n.renderIcon,d=l===void 0?function(c){return p.createElement(M0,G({},c))}:l;return p.createElement(va,{className:t,width:s,height:o,onClick:e},d({type:r,color:i}))},M0=function(n){var t=n.className,e=n.type,r=n.color,i=n.width,a=i===void 0?"22px":i,s=n.height,u=s===void 0?"22px":s,o=n.onClick,l=o===void 0?ot:o;return p.createElement(Ue,{className:t,type:e,fillColor:r,width:a,height:u,onClick:function(d){return l==null?void 0:l(d)}})},ua=Object.assign(jL,{Title:qL,IconButton:zL,Icon:M0}),KL=function(n){var t=n.className,e=n.currentChannel,r=n.showSearchIcon,i=n.onBackClick,a=n.onSearchClick,s=n.onChatHeaderActionClick,u=n.renderLeft,o=n.renderMiddle,l=n.renderRight,d=Hn().config,c=d.userId,f=d.theme,h=Nr().isMobile,m=$n().stringSet,_=(e==null?void 0:e.myMutedState)==="muted",E=VL(e,c,m);return p.createElement(ua,{className:Fn("sendbird-chat-header",t),renderLeft:u??function(){return p.createElement(p.Fragment,null,h&&p.createElement(ua.Icon,{className:"sendbird-chat-header__icon_back",onClick:i,type:ye.ARROW_LEFT,color:Me.PRIMARY,width:"24px",height:"24px"}),p.createElement(A0,{theme:f,channel:e,userId:c,height:32,width:32}))},renderMiddle:o??function(){return p.createElement(ua.Title,{title:E})},renderRight:l??function(){return p.createElement(p.Fragment,null,_&&p.createElement(ua.Icon,{className:"sendbird-chat-header__right__mute",type:ye.NOTIFICATIONS_OFF_FILLED,color:Me.ON_BACKGROUND_2,width:"24px",height:"24px"}),r&&!(e!=null&&e.isEphemeral)&&p.createElement(ua.IconButton,{className:"sendbird-chat-header__right__search",onClick:a,type:ye.SEARCH,color:Me.PRIMARY,renderIcon:function(b){return p.createElement(ua.Icon,G({},b,{width:"24px",height:"24px"}))}}),p.createElement(ua.IconButton,{className:"sendbird-chat-header__right__info",onClick:s,type:ye.INFO,color:Me.PRIMARY,renderIcon:function(b){return p.createElement(ua.Icon,G({},b,{width:"24px",height:"24px"}))}}))}})},$L=function(n){var t=n.className,e=rs();return p.createElement(KL,G({},e,{className:t,currentChannel:e.currentGroupChannel}))},Ud=function(n){return n?n.isFrozen&&n.myRole!=="operator":!1},Bo=function(n){return n?n.myMutedState==="muted":!1},XE=function(n,t){var e,r,i,a;return t&&Array.isArray((r=(e=n==null?void 0:n.lastMessage)===null||e===void 0?void 0:e.extendedMessagePayload)===null||r===void 0?void 0:r.suggested_replies)&&!!(!((a=(i=n==null?void 0:n.lastMessage)===null||i===void 0?void 0:i.extendedMessagePayload)===null||a===void 0)&&a.disable_chat_input)},w0=function(n){return n<=SD},ZE=function(n,t){return t&&n.some(function(e){var r;return!!e.messageForm&&!e.messageForm.isSubmitted&&!!(!((r=e.extendedMessagePayload)===null||r===void 0)&&r.disable_chat_input)&&w0(e.messageForm.version)})};function JE(n){if(n){var t=n.querySelectorAll("[data-sb-mention='true']"),e=Array.from(t);return e}return[]}function O0(n,t){var e=n.ref,r=t.logger,i=e.current,a=N.useState([]),s=a[0],u=a[1];return N.useLayoutEffect(function(){if(i){var o=JE(i);u(o)}},[i]),N.useEffect(function(){var o={childList:!0,subtree:!0},l=function(c){var f=c.length>0;f&&u(JE(i))},d=new MutationObserver(l);return i&&d.observe(i,o),function(){try{d.disconnect()}catch{r.error("useDirtyGetMentions: observer disconnect failed",{observer:d})}}},[i]),s}var WL=function(n){var t=n.children,e=t===void 0?void 0:t,r=n.className,i=r===void 0?"":r,a=n.separatorColor,s=a===void 0?ti.ONBACKGROUND_4:a;return p.createElement("div",{className:Ce(Ce([],Array.isArray(i)?i:[i],!0),["sendbird-separator"],!1).join(" ")},p.createElement("div",{className:["sendbird-separator__left","".concat(lp(s),"--background-color")].join(" ")}),p.createElement("div",{className:"sendbird-separator__text"},e||p.createElement(me,{type:he.CAPTION_2,color:re.ONBACKGROUND_2},"Date Separator")),p.createElement("div",{className:["sendbird-separator__right","".concat(lp(s),"--background-color")].join(" ")}))},Di={Enter:"Enter",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",Backspace:"Backspace"},dp={ElementNode:1,TextNode:3},tf={Span:"SPAN",Br:"BR",Div:"DIV"};/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:R0,setPrototypeOf:ev,isFrozen:YL,getPrototypeOf:QL,getOwnPropertyDescriptor:XL}=Object;let{freeze:Fr,seal:yi,create:D0}=Object,{apply:cp,construct:fp}=typeof Reflect<"u"&&Reflect;Fr||(Fr=function(t){return t});yi||(yi=function(t){return t});cp||(cp=function(t,e,r){return t.apply(e,r)});fp||(fp=function(t,e){return new t(...e)});const Al=Hr(Array.prototype.forEach),ZL=Hr(Array.prototype.lastIndexOf),nv=Hr(Array.prototype.pop),Ku=Hr(Array.prototype.push),JL=Hr(Array.prototype.splice),Zl=Hr(String.prototype.toLowerCase),rf=Hr(String.prototype.toString),tv=Hr(String.prototype.match),$u=Hr(String.prototype.replace),eU=Hr(String.prototype.indexOf),nU=Hr(String.prototype.trim),Ni=Hr(Object.prototype.hasOwnProperty),Mr=Hr(RegExp.prototype.test),Wu=tU(TypeError);function Hr(n){return function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return cp(n,t,r)}}function tU(n){return function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return fp(n,e)}}function st(n,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zl;ev&&ev(n,null);let r=t.length;for(;r--;){let i=t[r];if(typeof i=="string"){const a=e(i);a!==i&&(YL(t)||(t[r]=a),i=a)}n[i]=!0}return n}function rU(n){for(let t=0;t<n.length;t++)Ni(n,t)||(n[t]=null);return n}function ds(n){const t=D0(null);for(const[e,r]of R0(n))Ni(n,e)&&(Array.isArray(r)?t[e]=rU(r):r&&typeof r=="object"&&r.constructor===Object?t[e]=ds(r):t[e]=r);return t}function Yu(n,t){for(;n!==null;){const r=XL(n,t);if(r){if(r.get)return Hr(r.get);if(typeof r.value=="function")return Hr(r.value)}n=QL(n)}function e(){return null}return e}const rv=Fr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),af=Fr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),sf=Fr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),iU=Fr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uf=Fr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),aU=Fr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),iv=Fr(["#text"]),av=Fr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),of=Fr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sv=Fr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ml=Fr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),sU=yi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),uU=yi(/<%[\w\W]*|[\w\W]*%>/gm),oU=yi(/\$\{[\w\W]*/gm),lU=yi(/^data-[\-\w.\u00B7-\uFFFF]+$/),dU=yi(/^aria-[\-\w]+$/),L0=yi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),cU=yi(/^(?:\w+script|data):/i),fU=yi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),U0=yi(/^html$/i),hU=yi(/^[a-z][.\w]*(-[.\w]+)+$/i);var uv=Object.freeze({__proto__:null,ARIA_ATTR:dU,ATTR_WHITESPACE:fU,CUSTOM_ELEMENT:hU,DATA_ATTR:lU,DOCTYPE_NAME:U0,ERB_EXPR:uU,IS_ALLOWED_URI:L0,IS_SCRIPT_OR_DATA:cU,MUSTACHE_EXPR:sU,TMPLIT_EXPR:oU});const Qu={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},pU=function(){return typeof window>"u"?null:window},mU=function(t,e){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";e&&e.hasAttribute(i)&&(r=e.getAttribute(i));const a="dompurify"+(r?"#"+r:"");try{return t.createPolicy(a,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},ov=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function k0(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pU();const t=Ie=>k0(Ie);if(t.version="3.2.4",t.removed=[],!n||!n.document||n.document.nodeType!==Qu.document||!n.Element)return t.isSupported=!1,t;let{document:e}=n;const r=e,i=r.currentScript,{DocumentFragment:a,HTMLTemplateElement:s,Node:u,Element:o,NodeFilter:l,NamedNodeMap:d=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:c,DOMParser:f,trustedTypes:h}=n,m=o.prototype,_=Yu(m,"cloneNode"),E=Yu(m,"remove"),b=Yu(m,"nextSibling"),g=Yu(m,"childNodes"),C=Yu(m,"parentNode");if(typeof s=="function"){const Ie=e.createElement("template");Ie.content&&Ie.content.ownerDocument&&(e=Ie.content.ownerDocument)}let S,A="";const{implementation:I,createNodeIterator:T,createDocumentFragment:M,getElementsByTagName:O}=e,{importNode:R}=r;let U=ov();t.isSupported=typeof R0=="function"&&typeof C=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:P,ERB_EXPR:L,TMPLIT_EXPR:F,DATA_ATTR:B,ARIA_ATTR:V,IS_SCRIPT_OR_DATA:K,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:q}=uv;let{IS_ALLOWED_URI:se}=uv,Y=null;const ce=st({},[...rv,...af,...sf,...uf,...iv]);let X=null;const Se=st({},[...av,...of,...sv,...Ml]);let te=Object.seal(D0(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),be=null,xe=null,Pe=!0,vn=!0,on=!1,je=!0,Xe=!1,sn=!0,un=!1,En=!1,rn=!1,qe=!1,Je=!1,ln=!1,dn=!0,ve=!1;const De="user-content-";let Ye=!0,en=!1,fn={},Fe=null;const Nn=st({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let nn=null;const _e=st({},["audio","video","img","source","image","track"]);let zn=null;const Rn=st({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),bn="http://www.w3.org/1998/Math/MathML",Ge="http://www.w3.org/2000/svg",cn="http://www.w3.org/1999/xhtml";let On=cn,Ln=!1,In=null;const et=st({},[bn,Ge,cn],rf);let Gn=st({},["mi","mo","mn","ms","mtext"]),Cn=st({},["annotation-xml"]);const mn=st({},["title","style","font","a","script"]);let ze=null;const ue=["application/xhtml+xml","text/html"],Q="text/html";let Te=null,He=null;const $e=e.createElement("form"),Ee=function(j){return j instanceof RegExp||j instanceof Function},fe=function(){let j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(He&&He===j)){if((!j||typeof j!="object")&&(j={}),j=ds(j),ze=ue.indexOf(j.PARSER_MEDIA_TYPE)===-1?Q:j.PARSER_MEDIA_TYPE,Te=ze==="application/xhtml+xml"?rf:Zl,Y=Ni(j,"ALLOWED_TAGS")?st({},j.ALLOWED_TAGS,Te):ce,X=Ni(j,"ALLOWED_ATTR")?st({},j.ALLOWED_ATTR,Te):Se,In=Ni(j,"ALLOWED_NAMESPACES")?st({},j.ALLOWED_NAMESPACES,rf):et,zn=Ni(j,"ADD_URI_SAFE_ATTR")?st(ds(Rn),j.ADD_URI_SAFE_ATTR,Te):Rn,nn=Ni(j,"ADD_DATA_URI_TAGS")?st(ds(_e),j.ADD_DATA_URI_TAGS,Te):_e,Fe=Ni(j,"FORBID_CONTENTS")?st({},j.FORBID_CONTENTS,Te):Nn,be=Ni(j,"FORBID_TAGS")?st({},j.FORBID_TAGS,Te):{},xe=Ni(j,"FORBID_ATTR")?st({},j.FORBID_ATTR,Te):{},fn=Ni(j,"USE_PROFILES")?j.USE_PROFILES:!1,Pe=j.ALLOW_ARIA_ATTR!==!1,vn=j.ALLOW_DATA_ATTR!==!1,on=j.ALLOW_UNKNOWN_PROTOCOLS||!1,je=j.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Xe=j.SAFE_FOR_TEMPLATES||!1,sn=j.SAFE_FOR_XML!==!1,un=j.WHOLE_DOCUMENT||!1,qe=j.RETURN_DOM||!1,Je=j.RETURN_DOM_FRAGMENT||!1,ln=j.RETURN_TRUSTED_TYPE||!1,rn=j.FORCE_BODY||!1,dn=j.SANITIZE_DOM!==!1,ve=j.SANITIZE_NAMED_PROPS||!1,Ye=j.KEEP_CONTENT!==!1,en=j.IN_PLACE||!1,se=j.ALLOWED_URI_REGEXP||L0,On=j.NAMESPACE||cn,Gn=j.MATHML_TEXT_INTEGRATION_POINTS||Gn,Cn=j.HTML_INTEGRATION_POINTS||Cn,te=j.CUSTOM_ELEMENT_HANDLING||{},j.CUSTOM_ELEMENT_HANDLING&&Ee(j.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(te.tagNameCheck=j.CUSTOM_ELEMENT_HANDLING.tagNameCheck),j.CUSTOM_ELEMENT_HANDLING&&Ee(j.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(te.attributeNameCheck=j.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),j.CUSTOM_ELEMENT_HANDLING&&typeof j.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(te.allowCustomizedBuiltInElements=j.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Xe&&(vn=!1),Je&&(qe=!0),fn&&(Y=st({},iv),X=[],fn.html===!0&&(st(Y,rv),st(X,av)),fn.svg===!0&&(st(Y,af),st(X,of),st(X,Ml)),fn.svgFilters===!0&&(st(Y,sf),st(X,of),st(X,Ml)),fn.mathMl===!0&&(st(Y,uf),st(X,sv),st(X,Ml))),j.ADD_TAGS&&(Y===ce&&(Y=ds(Y)),st(Y,j.ADD_TAGS,Te)),j.ADD_ATTR&&(X===Se&&(X=ds(X)),st(X,j.ADD_ATTR,Te)),j.ADD_URI_SAFE_ATTR&&st(zn,j.ADD_URI_SAFE_ATTR,Te),j.FORBID_CONTENTS&&(Fe===Nn&&(Fe=ds(Fe)),st(Fe,j.FORBID_CONTENTS,Te)),Ye&&(Y["#text"]=!0),un&&st(Y,["html","head","body"]),Y.table&&(st(Y,["tbody"]),delete be.tbody),j.TRUSTED_TYPES_POLICY){if(typeof j.TRUSTED_TYPES_POLICY.createHTML!="function")throw Wu('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof j.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Wu('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=j.TRUSTED_TYPES_POLICY,A=S.createHTML("")}else S===void 0&&(S=mU(h,i)),S!==null&&typeof A=="string"&&(A=S.createHTML(""));Fr&&Fr(j),He=j}},We=st({},[...af,...sf,...iU]),yn=st({},[...uf,...aU]),Yn=function(j){let le=C(j);(!le||!le.tagName)&&(le={namespaceURI:On,tagName:"template"});const ke=Zl(j.tagName),Un=Zl(le.tagName);return In[j.namespaceURI]?j.namespaceURI===Ge?le.namespaceURI===cn?ke==="svg":le.namespaceURI===bn?ke==="svg"&&(Un==="annotation-xml"||Gn[Un]):!!We[ke]:j.namespaceURI===bn?le.namespaceURI===cn?ke==="math":le.namespaceURI===Ge?ke==="math"&&Cn[Un]:!!yn[ke]:j.namespaceURI===cn?le.namespaceURI===Ge&&!Cn[Un]||le.namespaceURI===bn&&!Gn[Un]?!1:!yn[ke]&&(mn[ke]||!We[ke]):!!(ze==="application/xhtml+xml"&&In[j.namespaceURI]):!1},Sn=function(j){Ku(t.removed,{element:j});try{C(j).removeChild(j)}catch{E(j)}},rt=function(j,le){try{Ku(t.removed,{attribute:le.getAttributeNode(j),from:le})}catch{Ku(t.removed,{attribute:null,from:le})}if(le.removeAttribute(j),j==="is")if(qe||Je)try{Sn(le)}catch{}else try{le.setAttribute(j,"")}catch{}},Ct=function(j){let le=null,ke=null;if(rn)j="<remove></remove>"+j;else{const ut=tv(j,/^[\r\n\t ]+/);ke=ut&&ut[0]}ze==="application/xhtml+xml"&&On===cn&&(j='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+j+"</body></html>");const Un=S?S.createHTML(j):j;if(On===cn)try{le=new f().parseFromString(Un,ze)}catch{}if(!le||!le.documentElement){le=I.createDocument(On,"template",null);try{le.documentElement.innerHTML=Ln?A:Un}catch{}}const Kn=le.body||le.documentElement;return j&&ke&&Kn.insertBefore(e.createTextNode(ke),Kn.childNodes[0]||null),On===cn?O.call(le,un?"html":"body")[0]:un?le.documentElement:Kn},pe=function(j){return T.call(j.ownerDocument||j,j,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},Le=function(j){return j instanceof c&&(typeof j.nodeName!="string"||typeof j.textContent!="string"||typeof j.removeChild!="function"||!(j.attributes instanceof d)||typeof j.removeAttribute!="function"||typeof j.setAttribute!="function"||typeof j.namespaceURI!="string"||typeof j.insertBefore!="function"||typeof j.hasChildNodes!="function")},ae=function(j){return typeof u=="function"&&j instanceof u};function Qe(Ie,j,le){Al(Ie,ke=>{ke.call(t,j,le,He)})}const an=function(j){let le=null;if(Qe(U.beforeSanitizeElements,j,null),Le(j))return Sn(j),!0;const ke=Te(j.nodeName);if(Qe(U.uponSanitizeElement,j,{tagName:ke,allowedTags:Y}),j.hasChildNodes()&&!ae(j.firstElementChild)&&Mr(/<[/\w]/g,j.innerHTML)&&Mr(/<[/\w]/g,j.textContent)||j.nodeType===Qu.progressingInstruction||sn&&j.nodeType===Qu.comment&&Mr(/<[/\w]/g,j.data))return Sn(j),!0;if(!Y[ke]||be[ke]){if(!be[ke]&&xn(ke)&&(te.tagNameCheck instanceof RegExp&&Mr(te.tagNameCheck,ke)||te.tagNameCheck instanceof Function&&te.tagNameCheck(ke)))return!1;if(Ye&&!Fe[ke]){const Un=C(j)||j.parentNode,Kn=g(j)||j.childNodes;if(Kn&&Un){const ut=Kn.length;for(let dt=ut-1;dt>=0;--dt){const jt=_(Kn[dt],!0);jt.__removalCount=(j.__removalCount||0)+1,Un.insertBefore(jt,b(j))}}}return Sn(j),!0}return j instanceof o&&!Yn(j)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&Mr(/<\/no(script|embed|frames)/i,j.innerHTML)?(Sn(j),!0):(Xe&&j.nodeType===Qu.text&&(le=j.textContent,Al([P,L,F],Un=>{le=$u(le,Un," ")}),j.textContent!==le&&(Ku(t.removed,{element:j.cloneNode()}),j.textContent=le)),Qe(U.afterSanitizeElements,j,null),!1)},Tn=function(j,le,ke){if(dn&&(le==="id"||le==="name")&&(ke in e||ke in $e))return!1;if(!(vn&&!xe[le]&&Mr(B,le))){if(!(Pe&&Mr(V,le))){if(!X[le]||xe[le]){if(!(xn(j)&&(te.tagNameCheck instanceof RegExp&&Mr(te.tagNameCheck,j)||te.tagNameCheck instanceof Function&&te.tagNameCheck(j))&&(te.attributeNameCheck instanceof RegExp&&Mr(te.attributeNameCheck,le)||te.attributeNameCheck instanceof Function&&te.attributeNameCheck(le))||le==="is"&&te.allowCustomizedBuiltInElements&&(te.tagNameCheck instanceof RegExp&&Mr(te.tagNameCheck,ke)||te.tagNameCheck instanceof Function&&te.tagNameCheck(ke))))return!1}else if(!zn[le]){if(!Mr(se,$u(ke,$,""))){if(!((le==="src"||le==="xlink:href"||le==="href")&&j!=="script"&&eU(ke,"data:")===0&&nn[j])){if(!(on&&!Mr(K,$u(ke,$,"")))){if(ke)return!1}}}}}}return!0},xn=function(j){return j!=="annotation-xml"&&tv(j,q)},it=function(j){Qe(U.beforeSanitizeAttributes,j,null);const{attributes:le}=j;if(!le||Le(j))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:X,forceKeepAttr:void 0};let Un=le.length;for(;Un--;){const Kn=le[Un],{name:ut,namespaceURI:dt,value:jt}=Kn,Ht=Te(ut);let Ve=ut==="value"?jt:nU(jt);if(ke.attrName=Ht,ke.attrValue=Ve,ke.keepAttr=!0,ke.forceKeepAttr=void 0,Qe(U.uponSanitizeAttribute,j,ke),Ve=ke.attrValue,ve&&(Ht==="id"||Ht==="name")&&(rt(ut,j),Ve=De+Ve),sn&&Mr(/((--!?|])>)|<\/(style|title)/i,Ve)){rt(ut,j);continue}if(ke.forceKeepAttr||(rt(ut,j),!ke.keepAttr))continue;if(!je&&Mr(/\/>/i,Ve)){rt(ut,j);continue}Xe&&Al([P,L,F],Pn=>{Ve=$u(Ve,Pn," ")});const kn=Te(j.nodeName);if(Tn(kn,Ht,Ve)){if(S&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!dt)switch(h.getAttributeType(kn,Ht)){case"TrustedHTML":{Ve=S.createHTML(Ve);break}case"TrustedScriptURL":{Ve=S.createScriptURL(Ve);break}}try{dt?j.setAttributeNS(dt,ut,Ve):j.setAttribute(ut,Ve),Le(j)?Sn(j):nv(t.removed)}catch{}}}Qe(U.afterSanitizeAttributes,j,null)},lt=function Ie(j){let le=null;const ke=pe(j);for(Qe(U.beforeSanitizeShadowDOM,j,null);le=ke.nextNode();)Qe(U.uponSanitizeShadowNode,le,null),an(le),it(le),le.content instanceof a&&Ie(le.content);Qe(U.afterSanitizeShadowDOM,j,null)};return t.sanitize=function(Ie){let j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},le=null,ke=null,Un=null,Kn=null;if(Ln=!Ie,Ln&&(Ie="<!-->"),typeof Ie!="string"&&!ae(Ie))if(typeof Ie.toString=="function"){if(Ie=Ie.toString(),typeof Ie!="string")throw Wu("dirty is not a string, aborting")}else throw Wu("toString is not a function");if(!t.isSupported)return Ie;if(En||fe(j),t.removed=[],typeof Ie=="string"&&(en=!1),en){if(Ie.nodeName){const jt=Te(Ie.nodeName);if(!Y[jt]||be[jt])throw Wu("root node is forbidden and cannot be sanitized in-place")}}else if(Ie instanceof u)le=Ct("<!---->"),ke=le.ownerDocument.importNode(Ie,!0),ke.nodeType===Qu.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?le=ke:le.appendChild(ke);else{if(!qe&&!Xe&&!un&&Ie.indexOf("<")===-1)return S&&ln?S.createHTML(Ie):Ie;if(le=Ct(Ie),!le)return qe?null:ln?A:""}le&&rn&&Sn(le.firstChild);const ut=pe(en?Ie:le);for(;Un=ut.nextNode();)an(Un),it(Un),Un.content instanceof a&&lt(Un.content);if(en)return Ie;if(qe){if(Je)for(Kn=M.call(le.ownerDocument);le.firstChild;)Kn.appendChild(le.firstChild);else Kn=le;return(X.shadowroot||X.shadowrootmode)&&(Kn=R.call(r,Kn,!0)),Kn}let dt=un?le.outerHTML:le.innerHTML;return un&&Y["!doctype"]&&le.ownerDocument&&le.ownerDocument.doctype&&le.ownerDocument.doctype.name&&Mr(U0,le.ownerDocument.doctype.name)&&(dt="<!DOCTYPE "+le.ownerDocument.doctype.name+`>
`+dt),Xe&&Al([P,L,F],jt=>{dt=$u(dt,jt," ")}),S&&ln?S.createHTML(dt):dt},t.setConfig=function(){let Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};fe(Ie),En=!0},t.clearConfig=function(){He=null,En=!1},t.isValidAttribute=function(Ie,j,le){He||fe({});const ke=Te(Ie),Un=Te(j);return Tn(ke,Un,le)},t.addHook=function(Ie,j){typeof j=="function"&&Ku(U[Ie],j)},t.removeHook=function(Ie,j){if(j!==void 0){const le=ZL(U[Ie],j);return le===-1?void 0:JL(U[Ie],le,1)[0]}return nv(U[Ie])},t.removeHooks=function(Ie){U[Ie]=[]},t.removeAllHooks=function(){U=ov()},t}var x0=k0(),P0="sendbird-mention-user-label",Em="sendbird-text-message-item-body",F0="sendbird-og-message-item-body__text-bubble";function hp(n){var t=n.userId,e=n.nickname,r='<span data-userid="'.concat(t,'" data-sb-mention="true" class="').concat(P0,'">').concat(e,"</span>"),i=x0(window),a=i.sanitize(r),s=a.split(" "),u=s[0],o=s.slice(1),l=Ce([u,'contenteditable="false"'],o,!0).join(" ");return l}var Go=function(n){return n===void 0&&(n=""),n?n.replace(/[<>]/g,function(t){return t==="<"?"&#60;":"&#62;"}):""},Jl=function(n){return n?Array.from(n):[]};function _U(n){var t;return n&&((t=n.isGroupChannel)===null||t===void 0?void 0:t.call(n))&&!n.isBroadcast&&!n.isSuper}function lf(n){return n.nodeType===dp.ElementNode}function lv(n){var t="",e="";return n.forEach(function(r){if(lf(r)&&r.nodeName===tf.Span){var i=r.innerText,a=r.dataset,s=a===void 0?{}:a,u=s.userid,o=u===void 0?"":u;t+=i,e+="".concat(Mo,"{").concat(o,"}")}else if(lf(r)&&r.nodeName===tf.Br)t+=`
`,e+=`
`;else if(lf(r)&&r.nodeName===tf.Div){var l=r.textContent,d=l===void 0?"":l;t+=`
`.concat(d),e+=`
`.concat(d)}else{var c=r.textContent,d=c===void 0?"":c;t+=d,e+=d}}),{messageText:t,mentionTemplate:e}}function gU(n){var t=n.map(function(e){var r=e.text,i=e.userId;return i?hp({userId:i,nickname:r}):Go(r)}).join(" ").concat(" ");document.execCommand("insertHTML",!1,t)}var EU="sendbird-word",H0="sendbird-word__mention",B0="sendbird-mention-user-label",G0=".".concat(H0,", .").concat(B0);function dv(n,t){var e=Ce([n],Array.from(n.querySelectorAll(t)),!0).find(function(r){return r.matches(t)});return e}function vU(n){var t=dv(n,".".concat(F0));if(t)return Jl(t.childNodes);var e=dv(n,".".concat(Em));return Jl(e?e.childNodes:n.childNodes)}function yU(n){return!!(n!=null&&n.querySelector(G0))}var V0=function(n){var t="";return n.forEach(function(e){var r=e.querySelectorAll(".".concat(EU));r.length>0&&(t+=V0(Array.from(r))+" "),t+=e.innerText+" "}),t};function bU(n){var t=n==null?void 0:n.reduce(function(e,r){var i,a,s,u=r==null?void 0:r.innerText;if(r instanceof Text&&(s=!1,u=(i=r.textContent)!==null&&i!==void 0?i:""),r instanceof HTMLElement&&(s=r.classList.contains(H0)||r.classList.contains(B0)?r:r.querySelector(G0)),s){var o=r==null?void 0:r.innerText,l=(a=s.dataset)===null||a===void 0?void 0:a.userid;return Ce(Ce([],e,!0),[{text:o,userId:l}],!1)}return Ce(Ce([],e,!0),[{text:u}],!1)},[]);return t}function CU(n,t){var e={},r=t.members;return n.forEach(function(i){if(i.userId){var a=r.find(function(s){return s.userId===i.userId});a&&(e[i.userId]=a)}}),Object.values(e)}function cv(n){var t=window.getSelection();if(t&&t.rangeCount>0){var e=t.getRangeAt(t.rangeCount-1);e.deleteContents();var r=document.createTextNode(n+"​");e.insertNode(r),e.setStart(r,r.length),e.collapse(!0),t.removeAllRanges(),t.addRange(e)}}function SU(n){var t=document.createElement("div");return t.innerHTML=n,t}function TU(n){var t=n.ref,e=n.setIsInput,r=n.channel,i=n.setMentionedUsers;return N.useCallback(function(a){a.preventDefault();var s=a.clipboardData.getData("text/html"),u=a.clipboardData.getData("text")||NU(a);if(!s){cv(Go(u)),e(!0);return}var o=x0(window),l=o.sanitize(s),d=SU(l);if(!yU(d)){var c=V0(Array.from(d.children));cv(Go(c)),d.remove(),e(!0);return}var f=vU(d),h=bU(f),m=r.isGroupChannel()?CU(h,r):[];i(m),gU(h),d.remove(),e(!0)},[t,e,r,i])}function NU(n){var t=n.clipboardData.getData("text/uri-list");return t.length===0?"":t.split(`
`).reduce(function(e,r){var i=r.trim();return i!==""&&!i.startsWith("#")&&(e+=i+`
`),e},"")}var tl="@",Gt={string:"string",mention:"mention",url:"url",undetermined:"undetermined",markdown:"markdown"},IU=/\[(.*?)\]\((.*?)\)|\*\*(.*?)\*\*/g;function AU(n,t){var e=t||tl;return RegExp("(".concat(n.map(function(r){var i=r.userId.replace(/([.*+?^${}()|[\]\\])/g,"\\$1");return"".concat(e,"\\{").concat(i,"\\}")}).join("|"),")"),"g")}function MU(n){var t=n.tokens,e=n.mentionedUsers,r=e===void 0?[]:e,i=n.templatePrefix,a=i===void 0?tl:i;if(!(r!=null&&r.length))return t;var s=AU(r,a),u=t.map(function(o){if(o.type!==Gt.undetermined)return o;var l=o.value,d=l.split(s),c=d.map(function(f){if(f.match(s)){var h=r.find(function(_){return"@{".concat(_==null?void 0:_.userId,"}")===f}),m=(h==null?void 0:h.nickname)||"(No name)";return{value:m,type:Gt.mention,userId:h==null?void 0:h.userId}}else return{value:f,type:Gt.undetermined}});return c}).flat();return u}function wU(n){var t=/(?:https?:\/\/|www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.(xn--)?[a-z]{2,20}\b([-a-zA-Z0-9@:%_+[\],.~#?&/=]*[-a-zA-Z0-9@:%_+~#?&/=])*/g,e=n.map(function(r){if(r.type!==Gt.undetermined)return r;var i=r.value,a=i===void 0?"":i,s=Array.from(a.matchAll(t)),u=s.map(function(d){var c,f=d[0],h=(c=d.index)!==null&&c!==void 0?c:0,m=h+f.length;return{text:f,start:h,end:m}}),o=[{value:a,type:Gt.string}],l=0;return u.forEach(function(d){var c=d.text,f=d.start,h=d.end,m=o.pop().value,_=m.slice(0,f-l),E=c,b=m.slice(h-l);_.length>0&&o.push({value:_,type:Gt.string}),o.push({value:E,type:Gt.url}),b.length>0&&o.push({value:b,type:Gt.string}),l=h}),o}).flat();return e}function vm(n){var t=n,e=[];return t.forEach(function(r){if(r.type===Gt.mention||r.type===Gt.markdown){e.push(r);return}var i=r.value,a=Array.from(i.matchAll(IU)),s=a.map(function(d){var c,f=d[0],h=(c=d.index)!==null&&c!==void 0?c:0,m=h+f.length;return{text:f,start:h,end:m,groups:d.filter(function(_){return typeof _=="string"})}}),u=i,o=0;if(s.forEach(function(d){var c=d.text,f=d.start,h=d.end,m=d.groups,_={type:Gt.undetermined,value:u.slice(0,f-o)};e.push(_);var E;c.startsWith("[")?E="url":c.startsWith("**")&&(E="bold");var b={type:Gt.markdown,markdownType:E,value:c,groups:m};e.push(b),u=i.slice(h),o=h}),u){var l={type:Gt.undetermined,value:u};e.push(l)}}),e}function j0(n){var t=n.reduce(function(e,r){var i=e[e.length-1];return(i==null?void 0:i.type)===Gt.string&&r.type===Gt.string?(i.value="".concat(i.value).concat(r.value),e):Ce(Ce([],e,!0),[r],!1)},[]);return t}function Vo(n){var t=n.messageText,e=n.mentionedUsers,r=e===void 0?[]:e,i=n.templatePrefix,a=i===void 0?tl:i,s=n.includeMarkdown,u=s===void 0?!1:s,o=[{type:Gt.undetermined,value:t}],l=MU({tokens:o,mentionedUsers:r,templatePrefix:a}),d=wU(u?vm(l):l),c=j0(d);return c}function OU(n){var t=[{type:Gt.undetermined,value:n}],e=vm(t);return q0(e)}function q0(n){var t=n.map(function(e){return e.type===Gt.markdown?q0(pp({messageText:e.groups[1]})):e.value});return t.join("")}function pp(n){var t=n.messageText,e=[{type:Gt.undetermined,value:t}],r=j0(vm(e));return r}function RU(n){var t=" ",e=n.split(`
`),r=e.map(function(a){var s,u,o=((s=a.match(/^\s*/))===null||s===void 0?void 0:s[0])||"",l=((u=a.match(/\s*$/))===null||u===void 0?void 0:u[0])||"",d=o.replace(/ /g,t),c=l.replace(/ /g,t);return d+a.trim()+c}),i=r.join(`
`);return i}var kd;(function(n){n.BASE="base",n.GROUP="group",n.OPEN="open"})(kd||(kd={}));var DU=function(n){var t=n.channel,e=n.config,r=cr(t==null?void 0:t.channelType).with(kd.GROUP,function(){var i;return(i=e==null?void 0:e.groupChannel)===null||i===void 0?void 0:i.enableDocument}).with(kd.OPEN,function(){var i;return(i=e==null?void 0:e.openChannel)===null||i===void 0?void 0:i.enableDocument}).otherwise(function(){return!0});return r},LU="sendbird-message-input-text-field",wr=function(){return null},df=function(n){n&&n.current&&(n.current.innerHTML="")},fv={targetString:"",startNodeIndex:null,startOffsetIndex:null,endNodeIndex:null,endOffsetIndex:null},z0=p.forwardRef(function(n,t){var e,r,i,a,s,u=n.channel,o=n.className,l=o===void 0?"":o,d=n.messageFieldId,c=d===void 0?"":d,f=n.isEdit,h=f===void 0?!1:f,m=n.isMobile,_=m===void 0?!1:m,E=n.isMentionEnabled,b=E===void 0?!1:E,g=n.isVoiceMessageEnabled,C=g===void 0?!0:g,S=n.isSelectingMultipleFilesEnabled,A=S===void 0?!1:S,I=n.disabled,T=I===void 0?!1:I,M=n.message,O=M===void 0?null:M,R=n.placeholder,U=R===void 0?"":R,P=n.maxLength,L=P===void 0?5e3:P,F=n.onFileUpload,B=F===void 0?wr:F,V=n.onSendMessage,K=V===void 0?wr:V,$=n.onUpdateMessage,q=$===void 0?wr:$,se=n.onCancelEdit,Y=se===void 0?wr:se,ce=n.onStartTyping,X=ce===void 0?wr:ce,Se=n.channelUrl,te=Se===void 0?"":Se,be=n.mentionSelectedUser,xe=be===void 0?null:be,Pe=n.onUserMentioned,vn=Pe===void 0?wr:Pe,on=n.onMentionStringChange,je=on===void 0?wr:on,Xe=n.onMentionedUserIdsUpdated,sn=Xe===void 0?wr:Xe,un=n.onVoiceMessageIconClick,En=un===void 0?wr:un,rn=n.onKeyUp,qe=rn===void 0?wr:rn,Je=n.onKeyDown,ln=Je===void 0?wr:Je,dn=n.renderFileUploadIcon,ve=dn===void 0?wr:dn,De=n.renderVoiceMessageIcon,Ye=De===void 0?wr:De,en=n.renderSendMessageIcon,fn=en===void 0?wr:en,Fe=n.setMentionedUsers,Nn=Fe===void 0?wr:Fe,nn=n.acceptableMimeTypes,_e=t&&"current"in t?t:N.useRef(null),zn=N.useRef(null),Rn=c||LU,bn=$n().stringSet,Ge=Hn(),cn=Ge.config,On=Ge.eventHandlers,Ln=DU({channel:u,config:cn}),In=N.useRef(),et=N.useState(!1),Gn=et[0],Cn=et[1],mn=N.useState([]),ze=mn[0],ue=mn[1],Q=N.useState(G({},fv)),Te=Q[0],He=Q[1],$e=n==null?void 0:n.value;N.useEffect(function(){var pe=_e==null?void 0:_e.current;ue([]),Cn(pe!=null&&pe.textContent?pe.textContent.trim().length>0:!1)},[$e]),N.useEffect(function(){h||(Cn(!1),df(_e))},[te]),N.useEffect(function(){var pe,Le;if(h&&(O!=null&&O.messageId)){var ae=_e==null?void 0:_e.current;if(b&&(O!=null&&O.mentionedUsers)&&O.mentionedUsers.length>0&&(O!=null&&O.mentionedMessageTemplate)&&O.mentionedMessageTemplate.length>0){var Qe=O.mentionedUsers,an=Qe===void 0?[]:Qe,Tn=Vo({messageText:O==null?void 0:O.mentionedMessageTemplate,mentionedUsers:an,includeMarkdown:u.isGroupChannel()&&cn.groupChannel.enableMarkdownForUserMessage});ae&&(ae.innerHTML=Tn.map(function(xn){if(xn.type===Gt.mention){var it=an.find(function(Ie){return Ie.userId===xn.userId}),lt="".concat(tl).concat((it==null?void 0:it.nickname)||xn.value||bn.MENTION_NAME__NO_NAME);return hp({userId:xn.userId,nickname:lt})}return Go(xn.value)}).join(""))}else{try{ae&&(ae.innerHTML=(pe=Go(O==null?void 0:O.message))!==null&&pe!==void 0?pe:"")}catch{}ue([])}Cn(ae!=null&&ae.textContent?((Le=ae==null?void 0:ae.textContent)===null||Le===void 0?void 0:Le.trim().length)>0:!1)}},[h,O]);var Ee=N.useCallback(function(){var pe,Le=_e==null?void 0:_e.current;if(b&&Le){var ae=Array.from(Le.getElementsByClassName("sendbird-mention-user-label")).map(function(Qe){var an;return(an=Qe==null?void 0:Qe.dataset)===null||an===void 0?void 0:an.userid});(!MO(ze,ae)||ae.length===0)&&(sn(ae),ue(ae))}Cn(Le!=null&&Le.textContent?((pe=Le.textContent)===null||pe===void 0?void 0:pe.trim().length)>0:!1)},[Te,b]);N.useEffect(function(){var pe,Le,ae,Qe;if(b&&xe){var an=Te.targetString,Tn=Te.startNodeIndex,xn=Te.startOffsetIndex,it=Te.endNodeIndex,lt=Te.endOffsetIndex,Ie=_e==null?void 0:_e.current;if(an&&Tn!==null&&xn!==null&&lt!==null&&it!==null&&Ie){var j=Jl(Ie==null?void 0:Ie.childNodes),le=(Le=(pe=j[Tn])===null||pe===void 0?void 0:pe.textContent)!==null&&Le!==void 0?Le:"",ke=document.createTextNode(le.slice(0,xn)),Un=(Qe=(ae=j[it])===null||ae===void 0?void 0:ae.textContent)!==null&&Qe!==void 0?Qe:"",Kn=lt&&document.createTextNode(" ".concat(Un.slice(lt))),ut=hp({userId:xe==null?void 0:xe.userId,nickname:"".concat(Mo).concat((xe==null?void 0:xe.nickname)||bn.MENTION_NAME__NO_NAME)}),dt=document.createElement("div");dt.innerHTML=ut;var jt=Ce(Ce(Ce([],j.slice(0,Tn),!0),[ke,dt.childNodes[0],Kn],!1),j.slice(it+1),!0);if(Ie&&(Ie.innerHTML="",jt.forEach(function(kn){kn&&Ie.appendChild(kn)})),vn(xe),window.getSelection||document.getSelection){var Ht=window.getSelection()||document.getSelection();Ht==null||Ht.removeAllRanges();var Ve=new Range;Ve.selectNodeContents(Ie),Ve.setStart(Ie.childNodes[Tn+2],1),Ve.setEnd(Ie.childNodes[Tn+2],1),Ve.collapse(!1),Ht==null||Ht.addRange(Ve),Ie.focus()}He(G({},fv)),Ee()}}},[xe,b]);var fe=N.useCallback(function(){var pe,Le,ae=((pe=window==null?void 0:window.getSelection)===null||pe===void 0?void 0:pe.call(window))||((Le=document==null?void 0:document.getSelection)===null||Le===void 0?void 0:Le.call(document)),Qe=_e==null?void 0:_e.current;if((ae==null?void 0:ae.anchorNode)===Qe&&je(""),b&&Qe&&ae&&ae.anchorNode===ae.focusNode&&ae.anchorOffset===ae.focusOffset)for(var an="",Tn=null,xn=null,it=function(j){var le=Qe.childNodes[j];if(le.nodeType===dp.TextNode){var ke=function(){var dt;return le===ae.anchorNode?le!=null&&le.textContent?le==null?void 0:le.textContent.slice(0,ae.anchorOffset):"":(dt=le==null?void 0:le.textContent)!==null&&dt!==void 0?dt:""}();if(an.length>0)an+=ke;else{for(var Un=ke.lastIndexOf(Mo),Kn=Un-1;Kn>-1&&ke[Kn]===Mo;Kn-=1)Un=Kn;Un>-1&&(an=ke,Tn=j,xn=Un)}}else an="",Tn=null,xn=null;if(le===ae.anchorNode){var ut=an&&xn!==null?an.slice(xn):"";return He({targetString:ut,startNodeIndex:Tn,startOffsetIndex:xn,endNodeIndex:j,endOffsetIndex:ae.anchorOffset}),je(ut),{value:void 0}}},lt=0;lt<Qe.childNodes.length;lt+=1){var Ie=it(lt);if(typeof Ie=="object")return Ie.value}},[b]),We=function(){var pe,Le;try{var ae=_e==null?void 0:_e.current;if(!h&&(ae!=null&&ae.textContent)){var Qe=lv(ae.childNodes),an=Qe.messageText,Tn=Qe.mentionTemplate,xn={message:an,mentionTemplate:Tn};K(xn),df(_e),og(navigator.userAgent)?(zn.current&&zn.current.focus(),requestAnimationFrame(function(){return ae.focus()})):ae.focus(),Cn(!1)}}catch(it){(Le=(pe=On==null?void 0:On.message)===null||pe===void 0?void 0:pe.onSendMessageFailed)===null||Le===void 0||Le.call(pe,O,it)}},yn=!(!((r=(e=_e==null?void 0:_e.current)===null||e===void 0?void 0:e.textContent)===null||r===void 0)&&r.trim()),Yn=function(){var pe,Le;try{var ae=_e==null?void 0:_e.current,Qe=O==null?void 0:O.messageId;if(h&&Qe&&ae){var an=lv(ae.childNodes),Tn=an.messageText,xn=an.mentionTemplate,it={messageId:Qe,message:Tn,mentionTemplate:xn};q(it),df(_e)}}catch(lt){(Le=(pe=On==null?void 0:On.message)===null||pe===void 0?void 0:pe.onUpdateMessageFailed)===null||Le===void 0||Le.call(pe,O,lt)}},Sn=TU({ref:_e,setMentionedUsers:Nn,channel:u,setIsInput:Cn}),rt=function(pe){var Le,ae,Qe=pe.currentTarget.files;try{Qe&&B(Array.from(Qe))}catch(an){(ae=(Le=On==null?void 0:On.message)===null||Le===void 0?void 0:Le.onFileUploadFailed)===null||ae===void 0||ae.call(Le,an)}finally{pe.target.value=""}},Ct=function(){var pe,Le=_e,ae=window.getSelection();if(!(!ae||ae.rangeCount===0)){var Qe=ae.getRangeAt(ae.rangeCount-1),an=Qe.getBoundingClientRect(),Tn=(pe=Le.current)===null||pe===void 0?void 0:pe.getBoundingClientRect();if(!(!Tn||!Le.current)){if(an.bottom>Tn.bottom){var xn=Math.min(an.bottom-Tn.bottom,Le.current.scrollHeight-Le.current.clientHeight);Le.current.scrollTop+=xn}else if(an.top<Tn.top){var xn=Math.min(Tn.top-an.top,Le.current.scrollTop);Le.current.scrollTop-=xn}}}};return p.createElement("form",{className:Fn.apply(void 0,Ce(Ce([],Array.isArray(l)?l:[l],!1),[h&&"sendbird-message-input__edit",T&&"sendbird-message-input-form__disabled"],!1))},p.createElement("div",{className:Fn("sendbird-message-input",T&&"sendbird-message-input__disabled"),"data-testid":"sendbird-message-input"},og(navigator.userAgent)&&p.createElement("input",{id:"ghost-input-reset-ime-cjk",ref:zn,style:{opacity:0,padding:0,margin:0,height:0,border:"none",position:"absolute",top:-9999},defaultValue:"_"}),p.createElement("div",{id:"".concat(Rn).concat(h?O==null?void 0:O.messageId:""),className:"sendbird-message-input--textarea ".concat(Rn),contentEditable:!T,role:"textbox","aria-label":"Text Input",ref:_e,disabled:T,maxLength:L,onKeyDown:function(pe){var Le,ae,Qe,an,Tn=ln(pe);Tn?pe.preventDefault():(!pe.shiftKey&&pe.key===Di.Enter&&!_&&(!((Le=_e==null?void 0:_e.current)===null||Le===void 0)&&Le.textContent)&&_e.current.textContent.trim().length>0&&((ae=pe==null?void 0:pe.nativeEvent)===null||ae===void 0?void 0:ae.isComposing)!==!0&&(pe.preventDefault(),We()),pe.key===Di.Backspace&&((an=(Qe=_e==null?void 0:_e.current)===null||Qe===void 0?void 0:Qe.childNodes)===null||an===void 0?void 0:an.length)===2&&!_e.current.childNodes[0].textContent&&_e.current.childNodes[1].nodeType===dp.ElementNode&&_e.current.removeChild(_e.current.childNodes[1]))},onKeyUp:function(pe){var Le=qe(pe);Le?pe.preventDefault():fe()},onClick:function(){fe()},onInput:function(){var pe;X(),Cn(!((pe=_e==null?void 0:_e.current)===null||pe===void 0)&&pe.textContent?_e.current.textContent.trim().length>0:!1),Ee()},onPaste:function(pe){Sn(pe),setTimeout(Ct)}}),((s=(a=(i=_e==null?void 0:_e.current)===null||i===void 0?void 0:i.textContent)===null||a===void 0?void 0:a.length)!==null&&s!==void 0?s:0)===0&&p.createElement(me,{className:"sendbird-message-input--placeholder",type:he.BODY_1,color:T?re.ONBACKGROUND_4:re.ONBACKGROUND_3},U||bn.MESSAGE_INPUT__PLACE_HOLDER),!h&&Gn&&p.createElement(va,{className:"sendbird-message-input--send",height:"32px",width:"32px",onClick:function(){return We()},testID:"sendbird-message-input-send-button"},(fn==null?void 0:fn())||p.createElement(Ue,{type:ye.SEND,fillColor:T?Me.ON_BACKGROUND_4:Me.PRIMARY,width:"20px",height:"20px"})),!h&&!Gn&&((ve==null?void 0:ve())||Ln&&p.createElement(va,{className:Fn("sendbird-message-input--attach",C&&"is-voice-message-enabled"),height:"32px",width:"32px",onClick:function(){var pe,Le;(Le=(pe=In==null?void 0:In.current)===null||pe===void 0?void 0:pe.click)===null||Le===void 0||Le.call(pe)}},p.createElement(Ue,{type:ye.ATTACH,fillColor:T?Me.ON_BACKGROUND_4:Me.CONTENT_INVERSE,width:"20px",height:"20px"}),p.createElement("input",{className:"sendbird-message-input--attach-input",type:"file",ref:In,onChange:function(pe){return rt(pe)},accept:oO(nn),multiple:A&&_U(u)}))),C&&!h&&!Gn&&p.createElement(va,{className:"sendbird-message-input--voice-message",width:"32px",height:"32px",onClick:En},(Ye==null?void 0:Ye())||p.createElement(Ue,{type:ye.AUDIO_ON_LINED,fillColor:T?Me.ON_BACKGROUND_4:Me.CONTENT_INVERSE,width:"20px",height:"20px"}))),h&&p.createElement("div",{className:"sendbird-message-input--edit-action","data-testid":"sendbird-message-input--edit-action"},p.createElement(Ri,{className:"sendbird-message-input--edit-action__cancel",type:kt.SECONDARY,size:ns.SMALL,onClick:Y},bn.BUTTON__CANCEL),p.createElement(Ri,{className:"sendbird-message-input--edit-action__save",type:kt.PRIMARY,size:ns.SMALL,disabled:yn,onClick:function(){return Yn()}},bn.BUTTON__SAVE)))});function hv(n){xt(1,arguments);var t=xr(n);return t.setHours(0,0,0,0),t}function ym(n,t){xt(2,arguments);var e=hv(n),r=hv(t);return e.getTime()===r.getTime()}function UU(n){return xt(1,arguments),ym(n,Date.now())}function kU(n,t){xt(2,arguments);var e=xr(n),r=xr(t);return e.getFullYear()===r.getFullYear()}function xU(n){return xt(1,arguments),kU(n,Date.now())}function PU(n,t){xt(2,arguments);var e=xr(n),r=Ca(t);return isNaN(r)?new Date(NaN):(r&&e.setDate(e.getDate()+r),e)}function FU(n,t){xt(2,arguments);var e=Ca(t);return PU(n,-e)}function HU(n){return xt(1,arguments),ym(n,FU(Date.now(),1))}var BU=function(n,t,e){var r;return e===void 0&&(e=$s),!(n!=null&&n.name)&&!(n!=null&&n.members)?e.NO_TITLE:UC(n)?((r=n==null?void 0:n.members)===null||r===void 0?void 0:r.length)===1?e.NO_MEMBERS:((n==null?void 0:n.members)||[]).filter(function(i){var a=i.userId;return a!==t}).map(function(i){var a=i.nickname;return a||e.NO_NAME}).join(", "):n.name},K0=function(n){var t,e=n.channel,r=n.locale,i=n.stringSet,a=i===void 0?$s:i,s=(t=e==null?void 0:e.lastMessage)===null||t===void 0?void 0:t.createdAt,u=r?{locale:r}:null;return s?UU(s)?Xi(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__TODAY,u):HU(s)?a.MESSAGE_STATUS__YESTERDAY||"Yesterday":xU(s)?Xi(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__THIS_YEAR,u):Xi(s,a.DATE_FORMAT__LAST_MESSAGE_CREATED_AT__PREVIOUS_YEAR,u):""},GU=function(n){return n!=null&&n.memberCount?n.memberCount:0},pv=function(n,t){var e,r,i,a,s,u;return t===void 0&&(t=$s),Ks(n)?(e=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GIF)!==null&&e!==void 0?e:"":Ia(n)?(r=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO)!==null&&r!==void 0?r:"":es(n)?(i=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VIDEO)!==null&&i!==void 0?i:"":jp(n)?(a=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_AUDIO)!==null&&a!==void 0?a:"":wC(n)?(s=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_VOICE_MESSAGE)!==null&&s!==void 0?s:"":(u=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_GENERAL)!==null&&u!==void 0?u:""},VU=function(n,t){var e,r,i,a;if(n===void 0&&(n=null),t===void 0&&(t=$s),!n)return"";if(Md(n))return t.CHANNEL_PREVIEW_LAST_MESSAGE_TEMPLATE_MESSAGE;if(n.isFileMessage())return pv(n.type,t);if(n.isMultipleFilesMessage()){var s=(r=(e=n.fileInfoList)===null||e===void 0?void 0:e[0])===null||r===void 0?void 0:r.mimeType;return Ia(s)||Ks(s)?(i=t==null?void 0:t.CHANNEL_PREVIEW_LAST_MESSAGE_FILE_TYPE_PHOTO)!==null&&i!==void 0?i:"":pv(s,t)}return(a=n.message)!==null&&a!==void 0?a:""},jU=function(n,t){return t===void 0&&(t=$s),n!=null&&n.lastMessage?VU(n==null?void 0:n.lastMessage,t):""},mv=function(n){return n!=null&&n.unreadMessageCount?n.unreadMessageCount:0},Da,La,qU=(Da={},Da[Tt.SENT]=ye.DONE,Da[Tt.DELIVERED]=ye.DONE_ALL,Da[Tt.READ]=ye.DONE_ALL,Da[Tt.FAILED]=ye.ERROR,Da[Tt.PENDING]=void 0,Da[Tt.NONE]=void 0,Da),zU=(La={},La[Tt.SENT]=Me.SENT,La[Tt.DELIVERED]=Me.SENT,La[Tt.READ]=Me.READ,La[Tt.FAILED]=Me.ERROR,La[Tt.PENDING]=void 0,La[Tt.NONE]=void 0,La);function $0(n){var t,e=n.className,r=n.message,i=n.channel,a=n.isDateSeparatorConsidered,s=a===void 0?!0:a,u=$n(),o=u.stringSet,l=u.dateLocale,d=gC(i,r),c=((t=i==null?void 0:i.isGroupChannel)===null||t===void 0?void 0:t.call(i))&&(i.isSuper||i.isPublic||i.isBroadcast)&&!(d===Tt.PENDING||d===Tt.FAILED);return p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-message-status"],!1).join(" ")},d===Tt.PENDING?p.createElement(ic,{className:"sendbird-message-status__icon",testID:"sendbird-message-status-icon",width:"16px",height:"16px"},p.createElement(Ue,{type:ye.SPINNER,fillColor:Me.PRIMARY,width:"16px",height:"16px"})):p.createElement(Ue,{className:Fn("sendbird-message-status__icon",c&&"hide-icon",d!==Tt.FAILED&&"sendbird-message-status--sent"),testID:"sendbird-message-status-icon",type:qU[d]||ye.ERROR,fillColor:zU[d],width:"16px",height:"16px"}),fO(d)&&p.createElement(me,{className:"sendbird-message-status__text",testID:"sendbird-message-status-text",type:he.CAPTION_3,color:re.ONBACKGROUND_2},s?Xi((r==null?void 0:r.createdAt)||0,o.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:l}):K0({channel:i,locale:l,stringSet:o})))}var KU=function(n){var t=n.ref,e=n.onClick,r=e===void 0?ot:e,i=n.onBlur,a=i===void 0?ot:i,s=n.renderIcon,u=s===void 0?function(o){return p.createElement(Ue,G({},o))}:s;return p.createElement(va,{ref:t,width:"32px",height:"32px",onClick:r,onBlur:a},u({type:ye.MORE,fillColor:Me.CONTENT_INVERSE,width:"24px",height:"24px"}))},_v=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu;return p.createElement(Gr,G({},n,{onClick:function(s){var u;Pr(i)&&Kp(i.message),a(),(u=n.onClick)===null||u===void 0||u.call(n,s)}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__COPY)},gv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu,s=r.setQuoteMessage;return p.createElement(Gr,G({},n,{disabled:i.parentMessageId>0,onClick:function(u){var o;s(i),a(),(o=n.onClick)===null||o===void 0||o.call(n,u)}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__REPLY)},Ev=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu,s=r.onReplyInThread;return p.createElement(Gr,G({},n,{onClick:function(u){var o;s({message:i}),a(),(o=n.onClick)===null||o===void 0||o.call(n,u)}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__THREAD)},vv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.hideMenu,a=r.onMoveToParentMessage;return p.createElement(Gr,G({},n,{onClick:function(s){var u;a(),i(),(u=n.onClick)===null||u===void 0||u.call(n,s)}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__OPEN_IN_CHANNEL)},yv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.hideMenu,a=r.showEdit,s=r.isOnline;return p.createElement(Gr,G({},n,{onClick:function(u){var o;s&&(a(!0),i(),(o=n.onClick)===null||o===void 0||o.call(n,u))}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__EDIT)},bv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu,s=r.resendMessage,u=r.isOnline;return p.createElement(Gr,G({},n,{onClick:function(o){var l;u&&(s(i),a(),(l=n.onClick)===null||l===void 0||l.call(n,o))}}),(t=n.children)!==null&&t!==void 0?t:e.MESSAGE_MENU__RESEND)},Cv=function(n){var t,e,r,i=$n().stringSet,a=Jt(),s=a.message,u=a.hideMenu,o=a.deleteMessage,l=a.showRemove,d=a.isOnline,c=a.disableDeleteMessage;return p.createElement(Gr,G({},n,{disabled:typeof c=="boolean"?c:((e=(t=s.threadInfo)===null||t===void 0?void 0:t.replyCount)!==null&&e!==void 0?e:0)>0,onClick:function(f){var h;li(s)?o(s):d&&(l(!0),u(),(h=n.onClick)===null||h===void 0||h.call(n,f))}}),(r=n.children)!==null&&r!==void 0?r:i.MESSAGE_MENU__DELETE)},W0=function(n){var t,e=n.channel,r=n.message;if(li(r)||Oi(r)||!(!((t=e==null?void 0:e.isGroupChannel)===null||t===void 0)&&t.call(e))||e!=null&&e.isEphemeral)return!1;var i=e==null?void 0:e.isBroadcast,a=(e==null?void 0:e.myRole)===ui.OPERATOR;return i?a:!0},$U=function(n){var t=n.message;return Pr(t)},WU=function(n){var t=n.message,e=n.channel,r=n.isByMe;return!(e!=null&&e.isEphemeral)&&Pr(t)&&Fo(t)&&r},YU=function(n){var t=n.message,e=n.isByMe;return li(t)&&(t==null?void 0:t.isResendable)&&e},QU=function(n){var t=n.message,e=n.channel,r=n.isByMe;return!(e!=null&&e.isEphemeral)&&!Oi(t)&&r},XU=function(n){var t=n.onMoveToParentMessage,e=t===void 0?void 0:t;return!!e},ZU=function(n){var t=n.channel,e=n.message,r=n.replyType;return W0({channel:t,message:e})&&r==="QUOTE_REPLY"},JU=function(n){var t=n.channel,e=n.message,r=n.replyType,i=n.onReplyInThread;return W0({channel:t,message:e})&&r==="THREAD"&&!(e!=null&&e.parentMessageId)&&typeof i=="function"},ek=function(n){var t,e=n.className,r=n.message,i=n.channel,a=n.isByMe,s=n.replyType,u=n.renderTrigger,o=u===void 0?KU:u,l=n.renderMenuItems,d=n.disableDeleteMessage,c=d===void 0?null:d,f=n.showEdit,h=f===void 0?ot:f,m=n.showRemove,_=m===void 0?ot:m,E=n.deleteMessage,b=n.resendMessage,g=n.setQuoteMessage,C=n.onReplyInThread,S=n.onMoveToParentMessage,A=Hn().config,I=A.isOnline,T=N.useRef(null),M=N.useRef(null),O=N.useState(!1),R=O[0],U=O[1],P=function(){return U(!1)},L=function(){return U(!0)},F=function(){return U(function(V){return!V})},B={message:r,channel:i,isByMe:a,replyType:s,onReplyInThread:C,onMoveToParentMessage:S};return p.createElement("div",{className:Fn("sendbird-message-menu",e),ref:M},p.createElement(Xp,{value:{message:r,hideMenu:P,showMenu:L,toggleMenu:F,setQuoteMessage:g,onReplyInThread:C,onMoveToParentMessage:S,showEdit:h,showRemove:_,deleteMessage:E,resendMessage:b,isOnline:I,disableDeleteMessage:c,triggerRef:T,containerRef:M}},o({ref:T,onClick:F}),R&&p.createElement(Mu,{id:Jp(r.messageId),parentRef:T,parentContainRef:M,closeDropdown:P,openLeft:a},(t=l==null?void 0:l({items:{CopyMenuItem:_v,ReplyMenuItem:gv,ThreadMenuItem:Ev,OpenInChannelMenuItem:vv,EditMenuItem:yv,ResendMenuItem:bv,DeleteMenuItem:Cv}}))!==null&&t!==void 0?t:p.createElement(p.Fragment,null,$U(B)&&p.createElement(_v,null),ZU(B)&&p.createElement(gv,null),JU(B)&&p.createElement(Ev,null),XU(B)&&p.createElement(vv,null),WU(B)&&p.createElement(yv,null),YU(B)&&p.createElement(bv,null),QU(B)&&p.createElement(Cv,null)))))},nk=300;function Sv(n){tk(n)&&n.touches.length<2&&n.preventDefault&&n.preventDefault()}function tk(n){return n&&"touches"in n}function Ou(n,t){var e=n.onLongPress,r=n.onClick,i=t===void 0?{}:t,a=i.delay,s=a===void 0?nk:a,u=i.shouldPreventDefault,o=u===void 0?!0:u,l=i.shouldStopPropagation,d=l===void 0?!1:l,c=Nr().isMobile,f=N.useState(!1),h=f[0],m=f[1],_=N.useState(!1),E=_[0],b=_[1],g=N.useRef(),C=N.useRef(),S=N.useCallback(function(I){I.persist();var T=G({},I);b(!1),d&&I.stopPropagation(),o&&I.target&&(I.target.addEventListener("touchend",Sv,{passive:!1}),C.current=I.target),g.current=setTimeout(function(){e(T),m(!0)},s)},[e,s,o,d,c]),A=N.useCallback(function(I,T,M){T===void 0&&(T=!0),M===void 0&&(M=!1),b(!!M),g!=null&&g.current&&clearTimeout(g.current),T&&!h&&!E&&(r==null||r(I)),m(!1),o&&C.current&&C.current.removeEventListener("touchend",Sv)},[o,r,h,E]);return{onMouseDown:function(I){return S(I)},onMouseUp:function(I){return A(I)},onMouseLeave:function(I){return A(I,!1)},onTouchStart:function(I){return S(I)},onTouchMove:function(I){return A(I,!1,!0)},onTouchEnd:function(I){return A(I)}}}var jo=p.forwardRef(function(n,t){var e=n.className,r=n.width,i=n.height,a=n.selected,s=n.dataSbId,u=s===void 0?"":s,o=n.testID,l=n.onClick,d=n.children,c=Ou({onLongPress:ot,onClick:l},{shouldPreventDefault:!0,shouldStopPropagation:!0});return p.createElement("div",G({className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-reaction-button".concat(a?"--selected":"")],!1).join(" "),ref:t,role:"button",style:{width:r,height:i}},c,{tabIndex:0,"data-sb-id":o??u,"data-testid":o??u}),p.createElement("div",{className:"sendbird-reaction-button__inner"},d))});function rk(n){var t=n.className,e=n.message,r=n.userId,i=n.spaceFromTrigger,a=i===void 0?{x:0,y:0}:i,s=n.emojiContainer,u=n.filterEmojiCategoryIds,o=n.toggleReaction,l=N.useRef(null),d=N.useRef(null),c=N.useMemo(function(){return Yl(s,u==null?void 0:u(e))},[s,u]);return Oi(e)||li(e)?null:p.createElement("div",{className:Br([t??"","sendbird-message-item-reaction-menu"]),ref:d},p.createElement(wu,{menuTrigger:function(f){return p.createElement(va,{className:"sendbird-message-item-reaction-menu__trigger",ref:l,width:"32px",height:"32px",onClick:function(){f()}},p.createElement(Ue,{className:"sendbird-message-item-reaction-menu__trigger__icon",testID:"sendbird-message-item-reaction-menu__trigger__icon",type:ye.EMOJI_MORE,fillColor:Me.CONTENT_INVERSE,width:"24px",height:"24px"}))},menuItems:function(f){return c.length===0?null:p.createElement(r0,{id:Jp(e.messageId),parentRef:l,parentContainRef:d,closeDropdown:f,spaceFromTrigger:a},c.map(function(h){var m,_,E,b=((E=(_=(m=e==null?void 0:e.reactions)===null||m===void 0?void 0:m.find(function(g){return g.key===h.key}))===null||_===void 0?void 0:_.userIds)===null||E===void 0?void 0:E.some(function(g){return g===r}))||!1;return p.createElement(jo,{key:h.key,width:"36px",height:"36px",selected:b,onClick:function(){f(),o==null||o(e,h.key,b)},testID:"ui_emoji_reactions_menu_".concat(h.key)},p.createElement(Xt,{url:h.url,width:"28px",height:"28px",placeHolder:function(g){var C=g.style;return p.createElement("div",{style:C},p.createElement(Ue,{type:ye.QUESTION,fillColor:Me.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))}))}}))}var bm=p.forwardRef(function(n,t){var e=n.className,r=e===void 0?"":e,i=n.testID,a=n.children,s=n.count,u=s===void 0?"":s,o=n.isAdd,l=o===void 0?!1:o,d=n.selected,c=d===void 0?!1:d,f=n.onClick,h=f===void 0?function(){}:f,m=function(){return c&&!l?"--selected":l?"--is-add":""};return p.createElement("div",{className:Ce(Ce([],Array.isArray(r)?r:[r],!0),["sendbird-reaction-badge".concat(m())],!1).join(" "),"data-testid":i,role:"button",ref:t,onClick:h,onKeyDown:h,onTouchEnd:h,tabIndex:0},p.createElement("div",{className:"sendbird-reaction-badge__inner"},p.createElement("div",{className:"sendbird-reaction-badge__inner__icon"},a),p.createElement(me,{className:a&&u?"sendbird-reaction-badge__inner__count":"",type:he.CAPTION_3,color:re.ONBACKGROUND_1},u)))}),ac=function(n){var t,e,r,i=n.className,a=i===void 0?"":i,s=n.children,u=n.onBackdropClick,o=(e=(t=Hn())===null||t===void 0?void 0:t.config)===null||e===void 0?void 0:e.logger,l=N.useRef();return l.current=document.getElementById(Hs),l.current||(l.current=document.createElement("div"),l.current.setAttribute("id",Hs),document.body.appendChild(l.current),(r=o==null?void 0:o.warning)===null||r===void 0||r.call(o,"@sendbird/uikit-react/ui/BottomSheet | Should put a ModalRoot to use the BottomSheet.")),Nu.createPortal(p.createElement("div",{className:"".concat(a," sendbird-bottomsheet")},p.createElement("div",{className:"sendbird-bottomsheet__content",role:"dialog","aria-modal":"true","aria-expanded":"true"},s),p.createElement("div",{className:"sendbird-bottomsheet__backdrop",onClick:function(d){d==null||d.stopPropagation(),u==null||u()}})),l.current)};function ik(n){var t=n.height,e=t===void 0?24:t,r=n.width,i=r===void 0?24:r;return p.createElement("div",{className:"sendbird-muted-avatar",style:{height:"".concat(e,"px"),width:"".concat(i,"px")}},p.createElement("div",{className:"sendbird-muted-avatar__icon"},p.createElement("div",{className:"sendbird-muted-avatar__bg",style:{height:"".concat(e,"px"),width:"".concat(i,"px")}}),p.createElement(Ue,{type:ye.MUTE,fillColor:Me.WHITE,width:"".concat(e-8,"px"),height:"".concat(i-8,"px")})))}function ak(n){var t=n.id,e=n.checked,r=e===void 0?!1:e,i=n.disabled,a=n.onChange,s=N.useState(r),u=s[0],o=s[1];return p.createElement("label",{className:["sendbird-checkbox",i?"disabled":""].join(" "),htmlFor:t},p.createElement("input",{disabled:i,id:t,type:"checkbox",checked:u,onClick:function(){i||o(!u)},onChange:a}),p.createElement("span",{className:["sendbird-checkbox--checkmark",i?"disabled":""].join(" ")}))}var Y0=function(n){var t=n.stores,e=t===void 0?{}:t,r=e.sdkStore,i=r===void 0?{}:r,a=i.sdk;return a},sk=function(n){var t=n.config,e=t===void 0?{}:t,r=e.pubSub;return r},Q0=function(n){return function(t){return new Promise(function(e,r){var i=Y0(n),a=sk(n);i||r(new Error("Sdk not found")),i.groupChannel||r(new Error("Not found GroupChannelModule")),i.groupChannel.createChannel&&typeof i.groupChannel.createChannel=="function"||r(new Error('Not found the function "createChannel"')),i.groupChannel.createChannel(t).then(function(s){e(s),a.publish(Sr.CREATE_CHANNEL,{channel:s})}).catch(r)})}};function Cm(n){var t,e,r=n.user,i=n.currentUserId,a=n.disableMessaging,s=a===void 0?!1:a,u=n.onSuccess,o=Hn(),l=Q0(o),d=(t=o==null?void 0:o.config)===null||t===void 0?void 0:t.logger,c=N.useContext(wt).stringSet,f=i||((e=o==null?void 0:o.config)===null||e===void 0?void 0:e.userId),h=nm().onStartDirectMessage;return p.createElement("div",{className:"sendbird__user-profile"},p.createElement("section",{className:"sendbird__user-profile-avatar"},p.createElement(zr,{height:"80px",width:"80px",src:r==null?void 0:r.profileUrl})),p.createElement("section",{className:"sendbird__user-profile-name"},p.createElement(me,{type:he.H_2,color:re.ONBACKGROUND_1},(r==null?void 0:r.nickname)||c.NO_NAME)),(r==null?void 0:r.userId)!==f&&!s&&p.createElement("section",{className:"sendbird__user-profile-message"},p.createElement(Ri,{type:kt.SECONDARY,onClick:function(){var m={isDistinct:!1,invitedUserIds:r!=null&&r.userId?[r==null?void 0:r.userId]:[],operatorUserIds:[f]};u==null||u(),l(m).then(function(_){d.info("UserProfile, channel create",_),h==null||h(_)})}},c.USER_PROFILE__MESSAGE)),p.createElement("div",{className:"sendbird__user-profile-separator"}),p.createElement("section",{className:"sendbird__user-profile-userId"},p.createElement(me,{className:"sendbird__user-profile-userId--label",type:he.CAPTION_2,color:re.ONBACKGROUND_2},c.USER_PROFILE__USER_ID),p.createElement(me,{className:"sendbird__user-profile-userId--value",type:he.BODY_1,color:re.ONBACKGROUND_1},r==null?void 0:r.userId)))}function X0(n){var t=n.user,e=n.channel,r=n.className,i=r===void 0?void 0:r,a=n.checked,s=n.checkBox,u=n.isOperator,o=n.disabled,l=n.disableMessaging,d=n.action,c=n.onChange,f=n.avatarSize,h=f===void 0?"40px":f,m=n.onClick,_=n.onUserAvatarClick,E=n.renderListItemMenu,b=n.size,g=b===void 0?"normal":b,C=u??(t==null?void 0:t.role)==="operator",S=t.userId,A=N.useRef(null),I=N.useRef(null),T=N.useRef(null),M=nm(),O=M.disableUserProfile,R=M.renderUserProfile,U=$n().stringSet,P=Hn().config,L=P.userId,F=g==="small"?"sendbird-user-list-item--small":"sendbird-user-list-item",B=g==="small"?"sendbird-user-list-item--small__avatar":"sendbird-user-list-item__avatar",V=g==="small"?"sendbird-user-list-item--small__title":"sendbird-user-list-item__title",K=g==="small"?"sendbird-user-list-item--small__subtitle":"sendbird-user-list-item__subtitle",$=g==="small"?"sendbird-user-list-item--small__checkbox":"sendbird-user-list-item__checkbox",q=g==="small"?"sendbird-user-list-item--small__action":"sendbird-user-list-item__action",se=g==="small"?"sendbird-user-list-item--small__operator":"sendbird-user-list-item__operator";return p.createElement("div",{className:Fn.apply(void 0,Ce([F],Array.isArray(i)?i:[i],!1)),ref:I},p.createElement(wu,{menuTrigger:function(Y){return p.createElement(p.Fragment,null,p.createElement(zr,{className:B,ref:T,src:(t==null?void 0:t.profileUrl)||(t==null?void 0:t.plainProfileUrl)||"",width:h,height:h,onClick:function(){var ce;O||(Y(),(ce=_??m)===null||ce===void 0||ce())}}),(t==null?void 0:t.isMuted)&&p.createElement(ik,{height:Su(h),width:Su(h)}))},menuItems:function(Y){return R?R({user:t,currentUserId:L??"",close:Y,avatarRef:T}):p.createElement(Mu,{openLeft:!0,parentRef:T,parentContainRef:T,closeDropdown:Y,style:{paddingTop:"0px",paddingBottom:"0px"}},p.createElement(Cm,{disableMessaging:l,user:t,currentUserId:L,onSuccess:Y}))}}),p.createElement(me,{className:V,type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},t.nickname||U.NO_NAME,L===t.userId&&U.CHANNEL_SETTING__MEMBERS__YOU),!t.nickname&&p.createElement(me,{className:K,type:he.CAPTION_3,color:re.ONBACKGROUND_2},t.userId),s&&p.createElement("label",{className:$,htmlFor:S},p.createElement(ak,{id:S,checked:a,disabled:o,onChange:function(Y){return c==null?void 0:c(Y)}})),C&&p.createElement(me,{className:Fn(se,s&&"checkbox"),type:he.SUBTITLE_2,color:re.ONBACKGROUND_2},U.LABEL__OPERATOR),!s&&!E&&d&&p.createElement("div",{className:q,ref:A},d({actionRef:A,parentRef:I})),!s&&E&&p.createElement("div",{className:q,ref:A},E({channel:e,user:t})))}function uk(n){var t=n.className,e=t===void 0?"":t,r=n.children,i=r===void 0?"":r;return p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-tooltip"],!1).join(" ")},p.createElement(me,{className:"sendbird-tooltip__text",type:he.CAPTION_2,color:re.ONCONTENT_1},i))}var ok=8;function lk(n){var t=n.className,e=t===void 0?"":t,r=n.children,i=n.hoverTooltip,a=N.useState(!1),s=a[0],u=a[1],o=N.useRef();return p.createElement("div",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-tooltip-wrapper"],!1).join(" "),onMouseOver:function(){u(!0)},onFocus:function(){u(!0)},onMouseOut:function(){u(!1)},onBlur:function(){u(!1)}},p.createElement("div",{className:"sendbird-tooltip-wrapper__children",ref:o},r),s&&p.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip",style:{bottom:"calc(100% + ".concat(ok,"px)")}},p.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip__inner"},p.createElement("div",{className:"sendbird-tooltip-wrapper__hover-tooltip__inner__tooltip-container",style:{left:o.current?"calc(".concat(o.current.offsetWidth/2,"px - 50%)"):void 0}},i))))}var dk={message:{},isByMe:!1},Z0=p.createContext(dk),Tv=function(n){var t=n.children,e=n.message,r=n.isByMe,i=r===void 0?!1:r;return p.createElement(Z0.Provider,{value:{message:e,isByMe:i}},t)},J0=function(){var n=p.useContext(Z0);if(n===void 0)throw new Error("useMessageContext must be used within a MessageProvider");return n},ck=function(n){var t,e,r,i=n.message,a=n.channel,s=n.emojiKey,u=s===void 0?"":s,o=n.hideMenu,l=n.emojiContainer,d=n.onPressUserProfileHandler,c=a.members,f=c===void 0?[]:c,h=N.useState(u),m=h[0],_=h[1];function E(){if(d&&i){var b=i==null?void 0:i.sender;d(b)}}return p.createElement(ac,{onBackdropClick:o},p.createElement("div",{className:"sendbird-message__bottomsheet"},p.createElement("div",{className:"sendbird-message__bottomsheet__reacted-members"},(t=i.reactions)===null||t===void 0?void 0:t.map(function(b){var g=SO(l,b.key);return p.createElement("div",{key:b.key,className:Fn("sendbird-message__bottomsheet__reacted-members__item",m===b.key&&"sendbird-message__bottomsheet__reacted-members__item__selected"),onClick:function(){_(b.key)}},p.createElement(Xt,{url:g,width:"28px",height:"28px",placeHolder:function(C){var S=C.style;return p.createElement("div",{style:S},p.createElement(Ue,{type:ye.QUESTION,fillColor:Me.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}),p.createElement(me,{type:he.BUTTON_2,color:m===b.key?re.PRIMARY:re.ONBACKGROUND_3},b.userIds.length))})),p.createElement("div",{className:"sendbird-message__bottomsheet__reactor-list"},((r=(e=i.reactions)===null||e===void 0?void 0:e.find(function(b){return b.key===m}))===null||r===void 0?void 0:r.userIds.map(function(b){return f.find(function(g){return g.userId===b})}).filter(function(b){return b!==void 0})).map(function(b){return p.createElement(X0,{key:b.userId,className:"sendbird-message__bottomsheet__reactor-list__item",user:b,avatarSize:"36px",onUserAvatarClick:E})}))))};function fk(n){var t,e=n.reaction,r=n.memberNicknamesMap,i=n.setEmojiKey,a=n.toggleReaction,s=n.emojisMap,u=n.channel,o=n.message,l=n.isFiltered,d=o0().openModal,c=Hn(),f=Nr().isMobile,h=J0(),m=N.useContext(wt).stringSet,_=c.config.userId,E=RC(_,e),b=e.userIds.length>0&&(u==null?void 0:u.isGroupChannel())&&!u.isSuper,g=function(){if(l&&!E){d({modalProps:{titleText:"Add reaction failed",hideFooter:!0,isCloseOnClickOutside:!0},childElement:function(S){var A=S.closeModal;return p.createElement(Od,{type:kt.PRIMARY,submitText:m.BUTTON__OK,hideCancelButton:!0,onCancel:A,onSubmit:A})}});return}i(""),a==null||a(o??(h==null?void 0:h.message),e.key,E)},C=Ou({onLongPress:function(){i(e.key)},onClick:g},{shouldPreventDefault:!0,shouldStopPropagation:!0});return p.createElement(lk,{className:"sendbird-emoji-reactions__reaction-badge",hoverTooltip:b?p.createElement(uk,null,yO(e,_,r,m)):p.createElement(p.Fragment,null)},p.createElement("div",G({},f?C:{onClick:g}),p.createElement(bm,{count:e.userIds.length,selected:E},p.createElement(Xt,{circle:!0,url:((t=s.get(e==null?void 0:e.key))===null||t===void 0?void 0:t.url)||"",width:"20px",height:"20px",defaultComponent:p.createElement(Ue,{width:"20px",height:"20px",type:ye.QUESTION})}))))}var hk=function(n){var t=n.onClick,e=Ou({onLongPress:function(){},onClick:t},{shouldPreventDefault:!0,shouldStopPropagation:!0});return p.createElement("div",G({className:"sendbird-emoji-reactions__add-reaction-badge","data-testid":"sendbird-emoji-reactions__add-reaction-badge"},e),p.createElement(bm,{isAdd:!0},p.createElement(Ue,{type:ye.EMOJI_MORE,fillColor:Me.ON_BACKGROUND_3,width:"20px",height:"20px"})))},pk=function(n){var t=n.userId,e=n.message,r=n.emojiContainer,i=n.hideMenu,a=n.toggleReaction,s=N.useMemo(function(){return $p(r)},[r]);return p.createElement(ac,{onBackdropClick:i},p.createElement("div",{className:"sendbird-message__bottomsheet sendbird-message__emojis-bottomsheet"},s.map(function(u){var o,l,d,c,f=(c=(d=(l=(o=e==null?void 0:e.reactions)===null||o===void 0?void 0:o.find(function(h){return h.key===u.key}))===null||l===void 0?void 0:l.userIds)===null||d===void 0?void 0:d.some(function(h){return h===t}))!==null&&c!==void 0?c:!1;return p.createElement(jo,{key:u.key,width:"44px",height:"44px",selected:f,onClick:function(h){h==null||h.stopPropagation(),a==null||a(e,u.key,f),i()},testID:"ui_mobile_emoji_reactions_menu_".concat(u.key)},p.createElement(Xt,{url:u.url,width:"38px",height:"38px",placeHolder:function(h){var m=h.style;return p.createElement("div",{style:m},p.createElement(Ue,{type:ye.QUESTION,fillColor:Me.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))})))},mk=function(n){var t,e,r,i,a,s=n.className,u=s===void 0?"":s,o=n.userId,l=n.message,d=n.channel,c=n.emojiContainer,f=n.memberNicknamesMap,h=n.spaceFromTrigger,m=h===void 0?{x:0,y:0}:h,_=n.isByMe,E=_===void 0?!1:_,b=n.toggleReaction,g=n.onPressUserProfile,C=n.filterEmojiCategoryIds,S=!1;try{var A=Hn().config;S=d?p0({channel:d,config:A}):!1}catch{}var I=Nr().isMobile,T=N.useRef(null),M=N.useState(!1),O=M[0],R=M[1],U=N.useState(""),P=U[0],L=U[1],F=bO(c),B=N.useMemo(function(){return Yl(c,C==null?void 0:C(l))},[c,C]),V=((e=(t=l.reactions)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0)<F.size;return p.createElement("div",{className:Br([u,"sendbird-emoji-reactions",E?"outgoing":"incoming"])},((i=(r=l.reactions)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0&&((a=l.reactions)===null||a===void 0?void 0:a.map(function(K){return p.createElement(fk,{key:K==null?void 0:K.key,reaction:K,memberNicknamesMap:f,setEmojiKey:L,toggleReaction:b,emojisMap:F,channel:d,message:l,isFiltered:Yl(c,C==null?void 0:C(l)).every(function($){return $.key!==(K==null?void 0:K.key)})})})),!I&&V&&p.createElement(wu,{menuTrigger:function(K){return p.createElement(bm,{className:"sendbird-emoji-reactions__add-reaction-badge",testID:"sendbird-emoji-reactions__add-reaction-badge",ref:T,isAdd:!0,onClick:function($){var q;K(),(q=$==null?void 0:$.stopPropagation)===null||q===void 0||q.call($)}},p.createElement(Ue,{type:ye.EMOJI_MORE,fillColor:Me.ON_BACKGROUND_3,width:"20px",height:"20px"}))},menuItems:function(K){return B.length===0?null:p.createElement(r0,{parentRef:T,parentContainRef:T,closeDropdown:K,spaceFromTrigger:m},Yl(c,C==null?void 0:C(l)).map(function($){var q,se,Y,ce=((Y=(se=(q=l==null?void 0:l.reactions)===null||q===void 0?void 0:q.find(function(X){return X.key===$.key}))===null||se===void 0?void 0:se.userIds)===null||Y===void 0?void 0:Y.some(function(X){return X===o}))||!1;return p.createElement(jo,{key:$.key,width:"36px",height:"36px",selected:ce,onClick:function(X){K(),b==null||b(l,$.key,ce),X==null||X.stopPropagation()},testID:"ui_emoji_reactions_menu_".concat($.key)},p.createElement(Xt,{url:($==null?void 0:$.url)||"",width:"28px",height:"28px",placeHolder:function(X){var Se=X.style;return p.createElement("div",{style:Se},p.createElement(Ue,{type:ye.QUESTION,fillColor:Me.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))}))}}),I&&V&&p.createElement(hk,{onClick:function(){R(!0)}}),I&&O&&p.createElement(pk,{userId:o,message:l,emojiContainer:c,hideMenu:function(){R(!1)},toggleReaction:b}),I&&P&&d!==null&&S&&p.createElement(ck,{message:l,channel:d,emojiKey:P,hideMenu:function(){L("")},emojiContainer:c,onPressUserProfileHandler:g}))};function _k(n){var t,e=n.className,r=e===void 0?"":e,i=n.message;return!(i!=null&&i.isAdminMessage||i!=null&&i.messageType)||!(!((t=i==null?void 0:i.isAdminMessage)===null||t===void 0)&&t.call(i))||(i==null?void 0:i.messageType)!=="admin"?null:p.createElement("div",{className:Ce(Ce([],Array.isArray(r)?r:[r],!0),["sendbird-admin-message"],!1).join(" ")},p.createElement(me,{className:"sendbird-admin-message__text",type:he.CAPTION_2,color:re.ONBACKGROUND_2},i==null?void 0:i.message))}function xd(n){return cr(n).when(Ir,function(){var t;return(t=n==null?void 0:n.type)!==null&&t!==void 0?t:""}).when(kr,function(){var t,e;return(e=(t=sc(n))===null||t===void 0?void 0:t.mimeType)!==null&&e!==void 0?e:""}).otherwise(function(){return""})}function sc(n){var t=n.fileInfoList;return t.length>0?t[0]:null}function eS(n){return cr(n).when(Ir,function(){var t;return(t=n==null?void 0:n.name)!==null&&t!==void 0?t:""}).when(kr,function(){var t,e;return(e=(t=sc(n))===null||t===void 0?void 0:t.fileName)!==null&&e!==void 0?e:""}).otherwise(function(){return""})}function Pd(n){return cr(n).when(Ir,function(){var t;return(t=n==null?void 0:n.url)!==null&&t!==void 0?t:""}).when(kr,function(){var t,e;return(e=(t=sc(n))===null||t===void 0?void 0:t.url)!==null&&e!==void 0?e:""}).otherwise(function(){return""})}function gk(n){return cr(n).when(Ir,function(){return n.thumbnails}).when(kr,function(){var t,e;return(e=(t=sc(n))===null||t===void 0?void 0:t.thumbnails)!==null&&e!==void 0?e:[]}).otherwise(function(){return[]})}function nS(n){var t=gk(n);return t&&t.length>0?t[0].url:""}function Ek(n){var t,e,r,i,a,s,u,o=n.message,l=n.userId,d=l===void 0?"":l,c=n.isByMe,f=c===void 0?!1:c,h=n.className,m=h===void 0?"":h,_=n.isUnavailable,E=_===void 0?!1:_,b=n.onClick,g=N.useContext(wt).stringSet,C=o.parentMessage,S=C==null?void 0:C.sender,A=d===(S==null?void 0:S.userId)?g.QUOTED_MESSAGE__CURRENT_USER:S==null?void 0:S.nickname,I=Pd(C),T=xd(C),M=d===((e=o==null?void 0:o.sender)===null||e===void 0?void 0:e.userId)?g.QUOTED_MESSAGE__CURRENT_USER:(r=o==null?void 0:o.sender)===null||r===void 0?void 0:r.nickname,O=N.useState(!1),R=O[0],U=O[1],P=cO(),L=(a=(i=eS(C))===null||i===void 0?void 0:i.split("/"))!==null&&a!==void 0?a:I.split("/");return p.createElement("div",{className:Br([m,"sendbird-quote-message",f?"outgoing":"incoming",E?"unavailable":""]),key:C==null?void 0:C.messageId,onClick:function(){!E&&b&&b()},onTouchEnd:function(){!E&&b&&b()}},p.createElement("div",{className:"sendbird-quote-message__replied-to"},p.createElement(Ue,{className:"sendbird-quote-message__replied-to__icon",type:ye.REPLY,fillColor:Me.ON_BACKGROUND_3,width:"12px",height:"12px"}),p.createElement(me,{className:"sendbird-quote-message__replied-to__text",testID:"sendbird-quote-message__replied-to__text",type:he.CAPTION_2,color:re.ONBACKGROUND_3},p.createElement("span",{className:"sendbird-quote-message__replied-to__text__nickname"},M),p.createElement("span",{className:"sendbird-quote-message__replied-to__text__text"},g.QUOTED_MESSAGE__REPLIED_TO),p.createElement("span",{className:"sendbird-quote-message__replied-to__text__nickname"},A))),p.createElement("div",{className:"sendbird-quote-message__replied-message"},E&&p.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},p.createElement(me,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:he.BODY_2,color:re.ONBACKGROUND_1},g.QUOTED_MESSAGE__UNAVAILABLE)),Pr(C)&&((s=C==null?void 0:C.message)===null||s===void 0?void 0:s.length)>0&&!E&&p.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},p.createElement(me,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:he.BODY_2,color:re.ONBACKGROUND_1},C==null?void 0:C.message)),Ji(C)&&I&&!E&&p.createElement("div",{className:"sendbird-quote-message__replied-message__text-message"},p.createElement(me,{className:"sendbird-quote-message__replied-message__text-message__word",testID:"sendbird-quote-message__replied-message__text-message__word",type:he.BODY_2,color:re.ONBACKGROUND_1},g.VOICE_MESSAGE)),(ts(C)||kr(C))&&I&&!E&&p.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message"},p.createElement(Xt,{className:"sendbird-quote-message__replied-message__thumbnail-message__image",url:I,alt:T,width:"144px",height:"108px",onLoad:function(){return U(!0)},defaultComponent:p.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__placeholder"},p.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__placeholder__icon"},p.createElement(Ue,{type:es(T)?ye.PLAY:ye.PHOTO,fillColor:Me.ON_BACKGROUND_2,width:"22px",height:"22px"})))}),es(T)&&!(((u=C==null?void 0:C.thumbnails)===null||u===void 0?void 0:u.length)>0)&&p.createElement(p.Fragment,null,p.createElement("video",{className:"sendbird-quote-message__replied-message__thumbnail-message__video"},p.createElement("source",{src:I,type:T})),p.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover"},p.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover__icon"},p.createElement(Ue,{type:ye.PLAY,fillColor:Me.ON_BACKGROUND_2,width:"14px",height:"14px"})))),R&&Ks(T)&&p.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover"},p.createElement("div",{className:"sendbird-quote-message__replied-message__thumbnail-message__cover__icon"},p.createElement(Ue,{type:ye.GIF,fillColor:Me.THUMBNAIL_ICON,width:"14px",height:"14px"})))),zp(C)===Fi.FILE&&I&&!E&&p.createElement("div",{className:"sendbird-quote-message__replied-message__file-message"},p.createElement(Ue,{className:"sendbird-quote-message__replied-message__file-message__type-icon",type:(t={},t[P.IMAGE]=ye.PHOTO,t[P.VIDEO]=ye.PLAY,t[P.AUDIO]=ye.FILE_AUDIO,t[P.GIF]=ye.GIF,t[P.OTHERS]=ye.FILE_DOCUMENT,t)[CC(T)],fillColor:Me.ON_BACKGROUND_3,width:"16px",height:"16px"}),p.createElement(me,{className:"sendbird-quote-message__replied-message__file-message__file-name",type:he.BODY_2,color:re.ONBACKGROUND_3},LC(L[L.length-1])))))}var Nv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu;return p.createElement(Gr,G({},n,{onClick:function(s){var u;Pr(i)&&Kp(i.message),a(),(u=n.onClick)===null||u===void 0||u.call(n,s)}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__COPY),p.createElement(Ue,{type:ye.COPY,fillColor:Me.PRIMARY,width:"24px",height:"24px"})))},Iv=function(n){var t,e,r,i=$n().stringSet,a=Jt(),s=a.message,u=a.hideMenu,o=a.setQuoteMessage;return p.createElement(Gr,G({},n,{disabled:s.parentMessageId>0,onClick:function(l){var d;o(s),u(),(d=n.onClick)===null||d===void 0||d.call(n,l)}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(me,{type:he.SUBTITLE_1,color:((e=s.parentMessageId)!==null&&e!==void 0?e:0)>0?re.ONBACKGROUND_4:re.ONBACKGROUND_1},i.MESSAGE_MENU__REPLY),p.createElement(Ue,{type:ye.REPLY,fillColor:((r=s.parentMessageId)!==null&&r!==void 0?r:0)>0?Me.ON_BACKGROUND_4:Me.PRIMARY,width:"24px",height:"24px"})))},Av=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu,s=r.onReplyInThread;return p.createElement(Gr,G({},n,{onClick:function(u){var o;s({message:i}),a(),(o=n.onClick)===null||o===void 0||o.call(n,u)}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__THREAD),p.createElement(Ue,{type:ye.THREAD,fillColor:Me.PRIMARY,width:"24px",height:"24px"})))},Mv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.hideMenu,a=r.showEdit,s=r.isOnline;return p.createElement(Gr,G({},n,{onClick:function(u){var o;s&&(a(!0),i(),(o=n.onClick)===null||o===void 0||o.call(n,u))}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__EDIT),p.createElement(Ue,{type:ye.EDIT,fillColor:Me.PRIMARY,width:"24px",height:"24px"})))},wv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu,s=r.resendMessage,u=r.isOnline;return p.createElement(Gr,G({},n,{onClick:function(o){var l;u&&(s(i),a(),(l=n.onClick)===null||l===void 0||l.call(n,o))}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__RESEND),p.createElement(Ue,{type:ye.REFRESH,fillColor:Me.PRIMARY,width:"24px",height:"24px"})))},Ov=function(n){var t,e,r,i=$n().stringSet,a=Jt(),s=a.message,u=a.hideMenu,o=a.deleteMessage,l=a.showRemove,d=a.isOnline,c=a.disableDeleteMessage;return p.createElement(Gr,G({},n,{disabled:typeof c=="boolean"?c:((e=(t=s.threadInfo)===null||t===void 0?void 0:t.replyCount)!==null&&e!==void 0?e:0)>0,onClick:function(f){var h;li(s)?o(s):d&&(l(!0),u(),(h=n.onClick)===null||h===void 0||h.call(n,f))}}),(r=n.children)!==null&&r!==void 0?r:p.createElement(p.Fragment,null,p.createElement(me,{type:he.SUBTITLE_1,color:c?re.ONBACKGROUND_4:re.ONBACKGROUND_1},i.MESSAGE_MENU__DELETE),p.createElement(Ue,{type:ye.DELETE,fillColor:Me.PRIMARY,width:"24px",height:"24px"})))},vk=function(n){var t,e=$n().stringSet,r=Jt(),i=r.hideMenu,a=r.message,s=r.onDownloadClick,u=a.url;return p.createElement(Gr,G({},n,{onClick:function(){i()}}),(t=n.children)!==null&&t!==void 0?t:p.createElement("a",{className:"sendbird-message__contextmenu--hyperlink",rel:"noopener noreferrer",href:u,target:"_blank",onClick:s},p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__SAVE),p.createElement(Ue,{type:ye.DOWNLOAD,fillColor:Me.PRIMARY,width:"24px",height:"24px"})))},yk=function(n){var t,e,r,i,a=n.channel,s=n.message,u=n.replyType,o=n.userId,l=n.resendMessage,d=n.showEdit,c=n.showRemove,f=n.deleteMenuState,h=n.deleteMessage,m=n.setQuoteMessage,_=n.parentRef,E=n.onReplyInThread,b=n.isOpenedFromThread,g=b===void 0?!1:b,C=n.onDownloadClick,S=C===void 0?null:C,A=n.renderMenuItems,I=n.hideMenu,T=((t=s==null?void 0:s.sender)===null||t===void 0?void 0:t.userId)===o,M=Hn().config,O=M.isOnline,R=Pr(s),U=Pr(s)&&Fo(s)&&T,P=li(s)&&(s==null?void 0:s.isResendable)&&T,L=!Oi(s)&&T,F=T&&(f===void 0||f!=="HIDE"),B=F&&L,V=!Oi(s)&&Ir(s)&&!(Ji(s)&&(a!=null&&a.isSuper)||a!=null&&a.isBroadcast),K=u==="QUOTE_REPLY"&&!li(s)&&!Oi(s)&&(a==null?void 0:a.isGroupChannel()),$=u==="THREAD"&&!g&&!li(s)&&!Oi(s)&&!TC(s)&&(a==null?void 0:a.isGroupChannel()),q=f!==void 0&&f==="DISABLE"||((r=(e=s==null?void 0:s.threadInfo)===null||e===void 0?void 0:e.replyCount)!==null&&r!==void 0?r:0)>0,se={message:s,hideMenu:I,setQuoteMessage:m,onReplyInThread:E,onMoveToParentMessage:ot,showEdit:d,showRemove:c,deleteMessage:h,resendMessage:l,isOnline:O,disableDeleteMessage:q,triggerRef:_,containerRef:_,onDownloadClick:S};return p.createElement(Xp,{value:se},p.createElement(Mu,{className:"sendbird-message__mobile-context-menu",parentRef:_,parentContainRef:_,closeDropdown:I},(i=A==null?void 0:A({items:{CopyMenuItem:Nv,ReplyMenuItem:Iv,ThreadMenuItem:Av,EditMenuItem:Mv,ResendMenuItem:wv,DeleteMenuItem:Ov}}))!==null&&i!==void 0?i:p.createElement(p.Fragment,null,R&&p.createElement(Nv,null),K&&p.createElement(Iv,null),$&&p.createElement(Av,null),U&&p.createElement(Mv,null),P&&p.createElement(wv,null),B&&p.createElement(Ov,null),V&&p.createElement(vk,null))))},Rv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu;return p.createElement(Ws,G({},n,{onClick:function(s){var u;Pr(i)&&Kp(i.message),a(),(u=n.onClick)===null||u===void 0||u.call(n,s)}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(Ue,{type:ye.COPY,fillColor:Me.PRIMARY,width:"24px",height:"24px"}),p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__COPY)))},Dv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.hideMenu,a=r.showEdit,s=r.isOnline;return p.createElement(Ws,G({},n,{onClick:function(u){var o;s&&(a(!0),i(),(o=n.onClick)===null||o===void 0||o.call(n,u))}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(Ue,{type:ye.EDIT,fillColor:Me.PRIMARY,width:"24px",height:"24px"}),p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__EDIT)))},Lv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu,s=r.resendMessage,u=r.isOnline;return p.createElement(Ws,G({},n,{onClick:function(o){var l;u&&(s(i),a(),(l=n.onClick)===null||l===void 0||l.call(n,o))}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(Ue,{type:ye.REFRESH,fillColor:Me.PRIMARY,width:"24px",height:"24px"}),p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__RESEND)))},Uv=function(n){var t,e,r,i=$n().stringSet,a=Jt(),s=a.message,u=a.hideMenu,o=a.setQuoteMessage;return p.createElement(Ws,G({},n,{disabled:s.parentMessageId>0,onClick:function(l){var d;o(s),u(),(d=n.onClick)===null||d===void 0||d.call(n,l)}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(Ue,{type:ye.REPLY,fillColor:((e=s.parentMessageId)!==null&&e!==void 0?e:0)>0?Me.ON_BACKGROUND_3:Me.PRIMARY,width:"24px",height:"24px"}),p.createElement(me,{type:he.SUBTITLE_1,color:((r=s.parentMessageId)!==null&&r!==void 0?r:0)>0?re.ONBACKGROUND_4:re.ONBACKGROUND_1},i.MESSAGE_MENU__REPLY)))},kv=function(n){var t,e=$n().stringSet,r=Jt(),i=r.message,a=r.hideMenu,s=r.onReplyInThread;return p.createElement(Ws,G({},n,{onClick:function(u){var o;s({message:i}),a(),(o=n.onClick)===null||o===void 0||o.call(n,u)}}),(t=n.children)!==null&&t!==void 0?t:p.createElement(p.Fragment,null,p.createElement(Ue,{type:ye.THREAD,fillColor:Me.PRIMARY,width:"24px",height:"24px"}),p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__THREAD)))},xv=function(n){var t,e,r,i=$n().stringSet,a=Jt(),s=a.message,u=a.hideMenu,o=a.deleteMessage,l=a.showRemove,d=a.isOnline,c=a.disableDeleteMessage;return p.createElement(Ws,G({},n,{disabled:typeof c=="boolean"?c:((e=(t=s.threadInfo)===null||t===void 0?void 0:t.replyCount)!==null&&e!==void 0?e:0)>0,onClick:function(f){var h;li(s)?o(s):d&&(l(!0),u(),(h=n.onClick)===null||h===void 0||h.call(n,f))}}),(r=n.children)!==null&&r!==void 0?r:p.createElement(p.Fragment,null,p.createElement(Ue,{type:ye.DELETE,fillColor:Me.PRIMARY,width:"24px",height:"24px"}),p.createElement(me,{type:he.SUBTITLE_1,color:c?re.ONBACKGROUND_4:re.ONBACKGROUND_1},i.MESSAGE_MENU__DELETE)))},bk=function(n){var t,e=$n().stringSet,r=Jt(),i=r.hideMenu,a=r.message,s=r.onDownloadClick,u=a.url;return p.createElement(Ws,{onClick:function(){return i()}},(t=n.children)!==null&&t!==void 0?t:p.createElement("a",{className:"sendbird-message__bottomsheet--hyperlink",rel:"noopener noreferrer",href:u,target:"_blank",onClick:s},p.createElement(Ue,{type:ye.DOWNLOAD,fillColor:Me.PRIMARY,width:"24px",height:"24px"}),p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},e.MESSAGE_MENU__SAVE)))},cf=38,Ck=function(n){var t,e,r,i,a=n.hideMenu,s=n.channel,u=n.emojiContainer,o=n.message,l=n.replyType,d=n.userId,c=n.resendMessage,f=n.deleteMessage,h=n.toggleReaction,m=n.isReactionEnabled,_=m===void 0?!1:m,E=n.showEdit,b=n.showRemove,g=n.deleteMenuState,C=n.setQuoteMessage,S=n.onReplyInThread,A=n.isOpenedFromThread,I=A===void 0?!1:A,T=n.onDownloadClick,M=n.renderMenuItems,O=((t=o==null?void 0:o.sender)===null||t===void 0?void 0:t.userId)===d,R=Hn().config,U=R.isOnline,P=Pr(o),L=Pr(o)&&Fo(o)&&O,F=U&&li(o)&&(o==null?void 0:o.isResendable)&&O,B=!Oi(o)&&O,V=O&&(g===void 0||g!=="HIDE"),K=V&&B,$=g!==void 0&&g==="DISABLE"||((r=(e=o==null?void 0:o.threadInfo)===null||e===void 0?void 0:e.replyCount)!==null&&r!==void 0?r:0)>0,q=Fo(o)&&Ir(o)&&!Ji(o),se=!li(o)&&!Oi(o)&&_,Y=l==="QUOTE_REPLY"&&!li(o)&&!Oi(o)&&(s==null?void 0:s.isGroupChannel())&&!(s!=null&&s.isBroadcast),ce=l==="THREAD"&&!I&&!li(o)&&!Oi(o)&&!TC(o)&&(s==null?void 0:s.isGroupChannel())&&!(s!=null&&s.isBroadcast),X=Math.floor(window.innerWidth/cf)-1,Se=N.useState(!1),te=Se[0],be=Se[1],xe=u&&$p(u),Pe=te?xe:xe==null?void 0:xe.slice(0,X),vn=xe&&xe.length>X,on={message:o,hideMenu:a,setQuoteMessage:C,onReplyInThread:S,onMoveToParentMessage:function(){},showEdit:E,showRemove:b,deleteMessage:f,resendMessage:c,isOnline:U,disableDeleteMessage:$,triggerRef:null,containerRef:null,onDownloadClick:T};return p.createElement(Xp,{value:on},p.createElement(ac,{onBackdropClick:a},p.createElement("div",{className:"sendbird-message__bottomsheet"},se&&p.createElement("div",{className:"sendbird-message__bottomsheet-reactions"},p.createElement("ul",{className:"sendbird-message__bottomsheet-reaction-bar"},p.createElement("div",{className:Fn("sendbird-message__bottomsheet-reaction-bar__row",te&&"sendbird-message__bottomsheet-reaction-bar__all")},Pe.map(function(je){var Xe,sn,un,En=(un=(sn=(Xe=o==null?void 0:o.reactions)===null||Xe===void 0?void 0:Xe.filter(function(rn){return rn.key===je.key})[0])===null||sn===void 0?void 0:sn.userIds)===null||un===void 0?void 0:un.some(function(rn){return rn===d});return p.createElement(jo,{key:je.key,width:"".concat(cf,"px"),height:"".concat(cf,"px"),selected:En,onClick:function(){a(),h==null||h(o,je.key,En)},testID:"ui_mobile_emoji_reactions_menu_".concat(je.key)},p.createElement(Xt,{url:(je==null?void 0:je.url)||"",width:"28px",height:"28px",placeHolder:function(rn){var qe=rn.style;return p.createElement("div",{style:qe},p.createElement(Ue,{type:ye.QUESTION,fillColor:Me.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))}),vn&&!te&&p.createElement(jo,{key:"emoji_more",width:"38px",height:"38px",onClick:function(){return be(!0)},testID:"ui_mobile_emoji_reactions_menu_emojiadd"},p.createElement(Xt,{url:"",width:"28px",height:"28px",placeHolder:function(je){var Xe=je.style;return p.createElement("div",{style:Xe},p.createElement(Ue,{type:ye.EMOJI_MORE,fillColor:Me.ON_BACKGROUND_3,width:"28px",height:"28px"}))}}))))),!te&&p.createElement("div",{className:"sendbird-message__bottomsheet--actions"},(i=M==null?void 0:M({items:{CopyMenuItem:Rv,EditMenuItem:Dv,ResendMenuItem:Lv,ReplyMenuItem:Uv,ThreadMenuItem:kv,DeleteMenuItem:xv}}))!==null&&i!==void 0?i:p.createElement(p.Fragment,null,P&&p.createElement(Rv,null),L&&p.createElement(Dv,null),F&&p.createElement(Lv,null),Y&&p.createElement(Uv,null),ce&&p.createElement(kv,null),K&&p.createElement(xv,null),q&&p.createElement(bk,null))))))},Sk=function(n){return p.createElement(p.Fragment,null,n!=null&&n.isReactionEnabled?p.createElement(Ck,G({},n)):p.createElement(yk,G({},n)))};function Tk(n,t){var e,r=n.className,i=n.threadInfo,a=n.onClick,s=i.mostRepliedUsers,u=s===void 0?[]:s,o=i.replyCount,l=$n().stringSet;return p.createElement("div",{className:"sendbird-ui-thread-replies ".concat(r),role:"button",onClick:function(d){a==null||a(d),d==null||d.stopPropagation()},onKeyDown:function(d){a==null||a(d),d==null||d.stopPropagation()},ref:t},p.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles"},u.slice(0,4).map(function(d){return p.createElement(zr,{key:d.userId,className:"sendbird-ui-thread-replies__user-profiles__avatar",src:d==null?void 0:d.profileUrl,alt:"user profile",width:"20px",height:"20px"})}),(u==null?void 0:u.length)>=5&&p.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar"},p.createElement(zr,{className:"sendbird-ui-thread-replies__user-profiles__avatar__image",src:(e=u==null?void 0:u[4])===null||e===void 0?void 0:e.profileUrl,alt:"user profile",width:"20px",height:"20px"}),p.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar__cover"}),p.createElement("div",{className:"sendbird-ui-thread-replies__user-profiles__avatar__plus"},p.createElement(Ue,{type:ye.PLUS,fillColor:Me.WHITE,width:"16px",height:"16px"})))),p.createElement(me,{className:"sendbird-ui-thread-replies__reply-counts",type:he.CAPTION_2,color:re.PRIMARY},o===1?"".concat(o," ").concat(l.CHANNEL__THREAD_REPLY):"".concat(o>99?l.CHANNEL__THREAD_OVER_MAX:o," ").concat(l.CHANNEL__THREAD_REPLIES)),p.createElement(Ue,{className:"sendbird-ui-thread-replies__icon",type:ye.CHEVRON_RIGHT,fillColor:Me.PRIMARY,width:"16px",height:"16px"}))}var Nk=p.forwardRef(Tk);function Ik(n){var t,e,r,i=n.mentionTemplate,a=n.mentionedUserId,s=n.mentionedUserNickname,u=n.isByMe,o=N.useRef(),l=Hn(),d=(t=l==null?void 0:l.config)===null||t===void 0?void 0:t.userId,c=(r=(e=l==null?void 0:l.stores)===null||e===void 0?void 0:e.sdkStore)===null||r===void 0?void 0:r.sdk,f=d===a,h=N.useState(),m=h[0],_=h[1],E=N.useCallback(function(b){if(m||!(c!=null&&c.createApplicationUserListQuery)){b();return}var g=c==null?void 0:c.createApplicationUserListQuery({userIdsFilter:[a]});g.next().then(function(C){(C==null?void 0:C.length)>0&&_(C[0]),b()})},[c,a]);return p.createElement(wu,{menuTrigger:function(b){return p.createElement("a",{className:Fn("sendbird-word__mention",f&&"sendbird-word__mention--me"),onClick:function(){return E(b)},ref:o,"data-userid":a,"data-nickname":s,"data-sb-mention":!0},p.createElement(me,{type:he.CAPTION_1,color:u?re.ONCONTENT_1:re.ONBACKGROUND_1},"".concat(i).concat(s)))},menuItems:function(b){return p.createElement(Mu,{parentRef:o,parentContainRef:o,closeDropdown:b,style:{paddingTop:"0px",paddingBottom:"0px"}},p.createElement(Cm,{user:m,onSuccess:b,currentUserId:d}))}})}var Ak=/https?:\/\//;function Mk(n){var t=n.className,e=t===void 0?"":t,r=n.src,i=n.type,a=n.color,s=n.children,u=Ak.test(r)?r:"http://".concat(r);return p.createElement("a",{className:Ce(Ce([],Array.isArray(e)?e:[e],!0),["sendbird-link-label",HC(a)],!1).join(" "),href:u,target:"_blank",rel:"noopener noreferrer",onTouchEnd:function(o){o.preventDefault(),o.nativeEvent.stopImmediatePropagation(),Wp(u)}},p.createElement(me,{className:"sendbird-link-label__label",testID:"sendbird-link-label__label",type:i,color:a},s))}function wk(n,t,e){return"sb-msg_".concat(n,"_").concat(t,"_").concat(e)}function Ok(n){var t=decodeURIComponent(n);try{var e=new URL(t).protocol;return["https:","http:"].some(function(r){return r===e.toLowerCase()})?t:"#"}catch{!t.startsWith("http://")&&!t.startsWith("https://")&&(t="https://"+t)}return t}function Fd(n){var t=n.tokens,e=J0(),r=e==null?void 0:e.message,i=e==null?void 0:e.isByMe,a=r.updatedAt,s=r.createdAt;return p.createElement(p.Fragment,null,t==null?void 0:t.map(function(u,o){var l=wk(s,a,o);return cr(u.type).with(Gt.markdown,function(){var d=u,c=d.groups;return p.createElement("span",{className:"sendbird-word",key:l,"data-testid":"sendbird-ui-word"},cr(d.markdownType).with("bold",function(){return p.createElement("span",{style:{fontWeight:"bold"}},p.createElement(Fd,{tokens:pp({messageText:c[1]})}))}).with("url",function(){return p.createElement("a",{className:i?"sendbird-label--color-oncontent-1":"sendbird-label--color-onbackground-1",href:Ok(c[2])},p.createElement(Fd,{tokens:pp({messageText:c[1]})}))}).otherwise(function(){return p.createElement(p.Fragment,null)}))}).with(Gt.mention,function(){return p.createElement("span",{className:"sendbird-word",key:l,"data-testid":"sendbird-ui-word"},p.createElement(Ik,{mentionTemplate:tl,mentionedUserId:u.userId,mentionedUserNickname:u.value,isByMe:i}))}).with(Gt.url,function(){return p.createElement("span",{className:"sendbird-word",key:l,"data-testid":"sendbird-ui-word"},p.createElement(Mk,{src:u.value,type:he.BODY_1,color:i?re.ONCONTENT_1:re.ONBACKGROUND_1},u.value))}).otherwise(function(){return p.createElement(p.Fragment,{key:l},RU(u.value))})}))}function Rk(n){var t,e,r,i,a=n.className,s=n.message,u=n.isByMe,o=u===void 0?!1:u,l=n.mouseHover,d=l===void 0?!1:l,c=n.isMentionEnabled,f=c===void 0?!1:c,h=n.isReactionEnabled,m=h===void 0?!1:h,_=n.isMarkdownEnabled,E=_===void 0?!1:_,b=n.onMessageHeightChange,g=b===void 0?function(){}:b,C=N.useContext(wt).stringSet,S=f&&((t=s==null?void 0:s.mentionedMessageTemplate)===null||t===void 0?void 0:t.length)>0&&(s==null?void 0:s.mentionedUsers)&&((e=s==null?void 0:s.mentionedUsers)===null||e===void 0?void 0:e.length)>0,A=N.useMemo(function(){var T;return Vo(S?{mentionedUsers:(T=s==null?void 0:s.mentionedUsers)!==null&&T!==void 0?T:void 0,messageText:s==null?void 0:s.mentionedMessageTemplate,includeMarkdown:E}:{messageText:s==null?void 0:s.message,includeMarkdown:E})},[s==null?void 0:s.updatedAt,s==null?void 0:s.message]),I=function(){var T;return Wp((T=s==null?void 0:s.ogMetaData)===null||T===void 0?void 0:T.url)};return p.createElement("div",{className:Br([a??"","sendbird-og-message-item-body",o?"outgoing":"incoming",d?"mouse-hover":"",m&&((r=s==null?void 0:s.reactions)===null||r===void 0?void 0:r.length)>0?"reactions":""])},p.createElement(me,{type:he.BODY_1,color:o?re.ONCONTENT_1:re.ONBACKGROUND_1},p.createElement("div",{className:F0},p.createElement(Fd,{tokens:A}),OC(s)&&p.createElement(me,{className:"sendbird-og-message-item-body__text-bubble__message",type:he.BODY_1,color:o?re.ONCONTENT_2:re.ONBACKGROUND_2}," ".concat(C.MESSAGE_EDITED," ")))),((i=s.ogMetaData)===null||i===void 0?void 0:i.defaultImage)&&p.createElement(Dk,{onClick:I,ogImage:s.ogMetaData.defaultImage,onMessageHeightChange:g}),s.ogMetaData&&p.createElement(Lk,{onClick:I,ogMetaData:s.ogMetaData,onMessageHeightChange:g}),p.createElement("div",{className:"sendbird-og-message-item-body__cover"}))}var Dk=function(n){var t=n.onClick,e=n.ogImage,r=n.onMessageHeightChange,i=N.useRef(null),a=Nr().isMobile;return p.createElement("div",{ref:i,className:Fn("sendbird-og-message-item-body__og-thumbnail",!e.url&&"sendbird-og-message-item-body__og-thumbnail__empty"),onClick:function(){return t()}},p.createElement(Xt,{className:"sendbird-og-message-item-body__og-thumbnail__image",url:e.url||"",alt:e.alt||"",width:"100%",height:a?"136px":"240px",onLoad:r,onError:function(){var s,u;try{(u=(s=i==null?void 0:i.current)===null||s===void 0?void 0:s.classList)===null||u===void 0||u.add("sendbird-og-message-item-body__og-thumbnail__empty")}catch{}},defaultComponent:p.createElement("div",{className:"sendbird-og-message-item-body__og-thumbnail__place-holder"},p.createElement(Ue,{className:"sendbird-og-message-item-body__og-thumbnail__place-holder__icon",type:ye.THUMBNAIL_NONE,width:"56px",height:"56px"}))}))},Lk=function(n){var t=n.onClick,e=n.ogMetaData,r=n.onMessageHeightChange;return N.useEffect(function(){r()},[e.title,e.description,e.url]),p.createElement("div",{className:"sendbird-og-message-item-body__description",onClick:function(){return t()}},e.title&&p.createElement(me,{className:"sendbird-og-message-item-body__description__title",type:he.SUBTITLE_2,color:re.ONBACKGROUND_1},e.title),e.description&&p.createElement(me,{className:"sendbird-og-message-item-body__description__description",type:he.BODY_2,color:re.ONBACKGROUND_1},e.description),e.url&&p.createElement(me,{className:"sendbird-og-message-item-body__description__url",type:he.CAPTION_3,color:re.ONBACKGROUND_2},e.url))};function Uk(n){var t,e=n.className,r=e===void 0?"":e,i=n.message,a=n.isByMe,s=a===void 0?!1:a,u=n.mouseHover,o=u===void 0?!1:u,l=n.isMentionEnabled,d=l===void 0?!1:l,c=n.isReactionEnabled,f=c===void 0?!1:c,h=n.isMarkdownEnabled,m=h===void 0?!1:h,_=N.useContext(wt).stringSet,E=d&&(i==null?void 0:i.mentionedMessageTemplate)&&i.mentionedMessageTemplate.length>0&&(i==null?void 0:i.mentionedUsers)&&i.mentionedUsers.length>0,b=N.useMemo(function(){var g;return Vo(E?{mentionedUsers:(g=i==null?void 0:i.mentionedUsers)!==null&&g!==void 0?g:void 0,messageText:i==null?void 0:i.mentionedMessageTemplate,includeMarkdown:m}:{messageText:i==null?void 0:i.message,includeMarkdown:m})},[i==null?void 0:i.updatedAt,i==null?void 0:i.message]);return p.createElement(me,{type:he.BODY_1,color:s?re.ONCONTENT_1:re.ONBACKGROUND_1},p.createElement("div",{className:Br([r,Em,s?"outgoing":"incoming",o?"mouse-hover":"",f&&((t=i==null?void 0:i.reactions)===null||t===void 0?void 0:t.length)>0?"reactions":""])},p.createElement(Fd,{tokens:b}),OC(i)&&p.createElement(me,{className:"sendbird-text-message-item-body__message edited",type:he.BODY_1,color:s?re.ONCONTENT_2:re.ONBACKGROUND_2}," ".concat(_.MESSAGE_EDITED," "))))}function kk(n){var t=this,e,r,i,a=n.className,s=a===void 0?"":a,u=n.message,o=n.isByMe,l=o===void 0?!1:o,d=n.mouseHover,c=d===void 0?!1:d,f=n.isReactionEnabled,h=f===void 0?!1:f,m=n.truncateLimit,_=n.onBeforeDownloadFileMessage,E=null;try{E=(r=(e=Hn())===null||e===void 0?void 0:e.config)===null||r===void 0?void 0:r.logger}catch{}var b=Nr().isMobile,g=m??(b?20:void 0),C=function(){return Wp(u==null?void 0:u.url)},S=_?function(){return Nt(t,void 0,void 0,function(){var A,I,T,M;return It(this,function(O){switch(O.label){case 0:return O.trys.push([0,2,,3]),[4,_({message:u})];case 1:return A=O.sent(),A?C():(T=E==null?void 0:E.info)===null||T===void 0||T.call(E,"FileMessageItemBody: Not allowed to download."),[3,3];case 2:return I=O.sent(),(M=E==null?void 0:E.error)===null||M===void 0||M.call(E,"FileMessageItemBody: Error occurred while determining download continuation:",I),[3,3];case 3:return[2]}})})}:C;return p.createElement("div",{className:Br([s,"sendbird-file-message-item-body",l?"outgoing":"incoming",c?"mouse-hover":"",h&&((i=u==null?void 0:u.reactions)===null||i===void 0?void 0:i.length)>0?"reactions":""])},p.createElement("div",{className:"sendbird-file-message-item-body__file-icon"},p.createElement(Ue,{className:"sendbird-file-message-item-body__file-icon__icon",type:{IMAGE:ye.PHOTO,VIDEO:ye.PLAY,AUDIO:ye.FILE_AUDIO,GIF:ye.GIF,OTHERS:ye.FILE_DOCUMENT}[CC(u==null?void 0:u.type)],fillColor:Me.PRIMARY,width:"24px",height:"24px"})),p.createElement(nl,{className:"sendbird-file-message-item-body__file-name",onClick:S,color:l?ti.ONCONTENT_1:ti.ONBACKGROUND_1},p.createElement(me,{className:"sendbird-file-message-item-body__file-name__text",testID:"sendbird-file-message-item-body__file-name__text",type:he.BODY_1,color:l?re.ONCONTENT_1:re.ONBACKGROUND_1},LC((u==null?void 0:u.name)||(u==null?void 0:u.url),g))))}function Sm(n,t){N.useLayoutEffect(function(){var r;(r=n.current)===null||r===void 0||r.focus()},[n.current]);var e=Yo(function(r){var i=t[r.key];i==null||i(r),r.stopPropagation()});return e}var rl={SINGLE:"SINGLE",MULTI:"MULTI"};function xk(n){var t=n.props;if(t.viewerType===rl.MULTI){var e=t,r=e.fileInfoList,i=e.currentIndex;return r[i]}var a=t;return{name:a.name,type:a.type,url:a.url}}function Pk(n){if(n.viewerType!==rl.MULTI){var t=n.onDelete,e=n.isByMe,r=n.disableDelete,i=n.className;return e?p.createElement("div",{className:"sendbird-fileviewer__header__right__actions__delete ".concat(i)},p.createElement(Ue,{className:r?"disabled":"",type:ye.DELETE,fillColor:r?Me.GRAY:Me.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(a){r||t==null||t(a)}})):p.createElement(p.Fragment,null)}return p.createElement(p.Fragment,null)}function Fk(n){if(n.viewerType===rl.MULTI){var t=n.onClickLeft,e=n.onClickRight;return p.createElement("div",{className:"sendbird-file-viewer-slider"},p.createElement("div",{className:"sendbird-file-viewer-arrow--left"},p.createElement(Ue,{type:ye.SLIDE_LEFT,fillColor:Me.ON_BACKGROUND_1,height:Nl,width:Nl,onClick:function(r){t==null||t(),r.stopPropagation()}})),p.createElement("div",{className:"sendbird-file-viewer-arrow--right"},p.createElement(Ue,{type:ye.SLIDE_LEFT,fillColor:Me.ON_BACKGROUND_1,height:Nl,width:Nl,onClick:function(r){r.stopPropagation(),e==null||e()}})))}return p.createElement(p.Fragment,null)}var Pv=function(n){var t=n.profileUrl,e=n.nickname,r=n.onClose,i=n.onDownloadClick,a=n,s=a.onClickLeft,u=a.onClickRight,o=N.useRef(null),l=Sm(o,{Escape:function(_){return r==null?void 0:r(_)},ArrowLeft:function(){return s==null?void 0:s()},ArrowRight:function(){return u==null?void 0:u()}}),d=xk({props:n}),c=d.name,f=d.type,h=d.url,m=N.useContext(wt).stringSet;return p.createElement(fi,{onClose:r},p.createElement("div",{className:"sendbird-fileviewer","data-testid":"sendbird-fileviewer",onKeyDown:l,tabIndex:1,ref:o},p.createElement("div",{className:"sendbird-fileviewer__header"},p.createElement("div",{className:"sendbird-fileviewer__header__left"},p.createElement("div",{className:"sendbird-fileviewer__header__left__avatar"},p.createElement(zr,{height:"32px",width:"32px",src:t})),p.createElement("div",{className:"sendbird-fileviewer__header__left__text-container"},p.createElement(me,{className:"sendbird-fileviewer__header__left__filename",type:he.H_2,color:re.ONBACKGROUND_1},c),p.createElement(me,{className:"sendbird-fileviewer__header__left__sender-name",type:he.BODY_1,color:re.ONBACKGROUND_2},e))),p.createElement("div",{className:"sendbird-fileviewer__header__right"},Po(f)&&p.createElement("div",{className:"sendbird-fileviewer__header__right__actions"},p.createElement("a",{className:"sendbird-fileviewer__header__right__actions__download",rel:"noopener noreferrer",href:h,target:"_blank",onClick:i},p.createElement(Ue,{type:ye.DOWNLOAD,fillColor:Me.ON_BACKGROUND_1,height:"24px",width:"24px"})),p.createElement(Pk,G({className:"sendbird-fileviewer__header__right__actions__delete"},n))),p.createElement("div",{className:"sendbird-fileviewer__header__right__actions__close"},p.createElement(Ue,{type:ye.CLOSE,fillColor:Me.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(_){return r==null?void 0:r(_)}})))),p.createElement("div",{className:"sendbird-fileviewer__content"},es(f)&&p.createElement("video",{controls:!0,className:"sendbird-fileviewer__content__video"},p.createElement("source",{src:h,type:f})),Ia(f)&&p.createElement("img",{src:h,alt:c,className:n.viewerType===rl.MULTI?"sendbird-fileviewer__content__img__multi":"sendbird-fileviewer__content__img"}),!Po(f)&&p.createElement("div",{className:"sendbird-fileviewer__content__unsupported"},p.createElement(me,{type:he.H_1,color:re.ONBACKGROUND_1},(m==null?void 0:m.UI__FILE_VIEWER__UNSUPPORT)||"Unsupported message")),p.createElement(Fk,G({},n)))))};function Hk(n){var t,e,r,i=n.message,a=n.statefulFileInfoList,s=a===void 0?[]:a,u=n.onClose,o=n.isByMe,l=o===void 0?!1:o,d=n.onDelete,c=n.currentIndex,f=n.onClickLeft,h=n.onClickRight,m=n.onDownloadClick;if(kr(i)){var _=i;return p.createElement(Pv,{profileUrl:_.sender.profileUrl,nickname:_.sender.nickname,viewerType:rl.MULTI,fileInfoList:s.filter(function(E){return E.url}).map(function(E){return{name:E.fileName||"",type:E.mimeType||"",url:E.url||""}}),currentIndex:c||0,onClickLeft:f||ot,onClickRight:h||ot,onClose:u,onDownloadClick:m})}else if(Ir(i)){var _=i;return Nu.createPortal(p.createElement(Pv,{profileUrl:(t=_.sender)===null||t===void 0?void 0:t.profileUrl,nickname:(e=_.sender)===null||e===void 0?void 0:e.nickname,name:_.name,type:_.type,url:_==null?void 0:_.url,isByMe:l,disableDelete:(((r=_.threadInfo)===null||r===void 0?void 0:r.replyCount)||0)>0,onClose:u,onDelete:d||ot,onDownloadClick:m}),document.getElementById(Hs))}return p.createElement(p.Fragment,null)}function Bk(n){var t,e=n.children,r=n.className,i=n.message,a=n.isReactionEnabled;return p.createElement("div",{className:"sendbird-image-grid-wrap"},p.createElement("div",{className:Br([r??"","sendbird-image-grid",a&&((t=i==null?void 0:i.reactions)===null||t===void 0?void 0:t.length)>0?"reactions":""])},e))}var Gk=400,ff=8,iu=4,Vk=54,wl=40,jk=48,qk=320,Fv=28,Hv=12,zk=200,Kk=8,$k=32,Wk=60,hf={CHAT_WEB:"calc(".concat(Gk/2,"px - ").concat((ff+iu)/2,"px)"),CHAT_MOBILE:"calc(50vw - ".concat((jk+wl+Vk+ff+iu)/2,"px)"),THREAD_PARENT_WEB:"calc(".concat((qk-(Fv+wl+Hv+iu))/2,"px)"),THREAD_PARENT_MOBILE:"calc(50vw - ".concat((Fv+wl+Hv+iu)/2,"px)"),THREAD_CHILD_WEB:"calc(".concat((zk-Kk-iu)/2,"px)"),THREAD_CHILD_MOBILE:"calc(50vw - ".concat(($k+wl+Wk+ff+iu)/2,"px)")},Yk={CHAT_WEB:"6px",CHAT_MOBILE:"6px",THREAD_PARENT_WEB:"6px",THREAD_PARENT_MOBILE:"6px",THREAD_CHILD_WEB:"6px",THREAD_CHILD_MOBILE:"6px"},au="34px",Bv={PARENT:"parent",CHILD:"child"};function Qk(n){var t=this,e,r,i=n.className,a=n.message,s=n.isReactionEnabled,u=s===void 0?!1:s,o=n.threadMessageKindKey,l=n.statefulFileInfoList,d=l===void 0?[]:l,c=n.onBeforeDownloadFileMessage,f=c===void 0?null:c,h=(r=(e=Hn==null?void 0:Hn())===null||e===void 0?void 0:e.config)===null||r===void 0?void 0:r.logger,m=N.useState(-1),_=m[0],E=m[1];function b(){E(-1)}function g(){E(_===0?d.length-1:_-1)}function C(){E(_===d.length-1?0:_+1)}return o?p.createElement(p.Fragment,null,_>-1&&p.createElement(Hk,{message:a,statefulFileInfoList:d,currentIndex:_,onClickLeft:g,onClickRight:C,onClose:b,onDownloadClick:function(S){return Nt(t,void 0,void 0,function(){var A,I,T,M;return It(this,function(O){switch(O.label){case 0:if(!f)return[2];O.label=1;case 1:return O.trys.push([1,3,,4]),[4,f({message:a,index:_})];case 2:return A=O.sent(),A||(S.preventDefault(),(T=h==null?void 0:h.info)===null||T===void 0||T.call(h,"MultipleFilesMessageItemBody: Not allowed to download.")),[3,4];case 3:return I=O.sent(),(M=h==null?void 0:h.error)===null||M===void 0||M.call(h,"MultipleFilesMessageItemBody: Error occurred while determining download continuation:",I),[3,4];case 4:return[2]}})})}}),p.createElement(Bk,{className:i,message:a,isReactionEnabled:u},d.map(function(S,A){var I,T,M,O;return p.createElement("div",{className:"sendbird-multiple-files-image-renderer-wrapper",onClick:a.sendingStatus===Qn.SUCCEEDED?function(){return E(A)}:void 0,key:"sendbird-multiple-files-image-renderer-".concat(A,"-").concat(S.url)},p.createElement(Xt,{url:(O=(M=(T=(I=S.thumbnails)===null||I===void 0?void 0:I[0])===null||T===void 0?void 0:T.url)!==null&&M!==void 0?M:S.url)!==null&&O!==void 0?O:"",fixedSize:!1,width:hf[o],maxSideLength:hf.CHAT_WEB,height:hf[o],borderRadius:PL(Yk[o],A,d.length),shadeOnHover:!0,isUploaded:!!S.isUploaded,placeHolder:function(R){var U=R.style;return S.mimeType&&Ks(S.mimeType)?p.createElement(pf.GIF,{style:U}):p.createElement(pf.Default,{style:U})},defaultComponent:p.createElement(pf.LoadError,null)}))}))):p.createElement(p.Fragment,null)}var pf={Default:function(n){var t=n.style;return p.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder",style:t},p.createElement(Ue,{type:ye.PHOTO,fillColor:Me.ON_BACKGROUND_2,width:au,height:au}))},GIF:function(n){var t=n.style;return p.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder",style:t},p.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder__icon"},p.createElement(Ue,{type:ye.GIF,fillColor:Me.THUMBNAIL_ICON,width:au,height:au})))},LoadError:function(){return p.createElement("div",{className:"sendbird-multiple-files-image-renderer__thumbnail__placeholder"},p.createElement(Ue,{type:ye.THUMBNAIL_NONE,fillColor:Me.ON_BACKGROUND_2,width:au,height:au}))}};function Xk(n){var t=n.threadMessageKind,e=n.isMobile,r=N.useMemo(function(){return cr(t).with(Bv.PARENT,function(){return e?"THREAD_PARENT_MOBILE":"THREAD_PARENT_WEB"}).with(Bv.CHILD,function(){return e?"THREAD_CHILD_MOBILE":"THREAD_CHILD_WEB"}).otherwise(function(){return e?"CHAT_MOBILE":"CHAT_WEB"})},[e,t]);return r}var Zk=function(n){var t,e,r=N.useRef(new Map),i=function(s,u){return!r.current.has(s)&&u&&r.current.set(s,URL.createObjectURL(u)),r.current.get(s)},a=function(){r.current.size>0&&(r.current.forEach(function(s){return URL.revokeObjectURL(s)}),r.current.clear())};return N.useEffect(function(){return function(){return a()}},[]),!n||!n.isMultipleFilesMessage||!n.isMultipleFilesMessage()?[]:n.sendingStatus===Qn.SUCCEEDED?(a(),n.fileInfoList.map(function(s){var u,o;return G(G({},s),{url:s.url,isUploaded:!0,mimeType:(u=s.mimeType)!==null&&u!==void 0?u:void 0,fileName:(o=s.fileName)!==null&&o!==void 0?o:void 0})})):(e=(t=n==null?void 0:n.messageParams)===null||t===void 0?void 0:t.fileInfoList.map(function(s,u){var o,l;return G(G({},s),{url:(l=(o=i(u))!==null&&o!==void 0?o:s.fileUrl)!==null&&l!==void 0?l:s.file instanceof Blob?i(u,s.file):void 0,isUploaded:!s.file&&typeof s.fileUrl=="string"&&s.fileUrl.length>0})}))!==null&&e!==void 0?e:[]},mp={PRIMARY:"progress-bar-color--primary",GRAY:"progress-bar-color--gray"},tS=function(n){var t=n.className,e=t===void 0?"":t,r=n.disabled,i=r===void 0?!1:r,a=n.maxSize,s=n.currentSize,u=s===void 0?0:s,o=n.colorType,l=o===void 0?mp.PRIMARY:o,d=N.useMemo(function(){return"".concat(u/a*100,"%")},[u,a]);return p.createElement("div",{className:Fn("sendbird-progress-bar",e,l,i&&"progress-bar--disabled")},p.createElement("div",{className:"sendbird-progress-bar__fill",style:{width:d}}))},rS=function(n){var t,e=n.key,r=e===void 0?"":e,i=n.channelUrl,a=i===void 0?"":i,s=n.audioFile,u=n.audioFileUrl,o=u===void 0?"":u,l=n.audioFileMimeType,d=l===void 0?Rs:l,c=nD(a,r),f=aD(),h=f.play,m=f.pause,_=f.stop,E=f.voicePlayerStore,b=s0().isRecordable,g=((t=E==null?void 0:E.audioStorage)===null||t===void 0?void 0:t[c])||Es(),C=function(){b||h==null||h({groupKey:c,audioFile:s,audioFileUrl:o,audioFileMimeType:d})},S=function(){m==null||m(c)},A=function(I){I===void 0&&(I=""),_==null||_(I)};return N.useEffect(function(){return function(){var I;if(s||o){var T=document.getElementById(Yf);(I=T==null?void 0:T.pause)===null||I===void 0||I.call(T)}}},[]),{play:C,pause:S,stop:A,playbackTime:((g==null?void 0:g.playbackTime)||0)*1e3,duration:((g==null?void 0:g.duration)||0)*1e3,playingStatus:g.playingStatus}},iS=function(n){var t=n.className,e=n.time,r=e===void 0?0:e,i=n.labelType,a=i===void 0?he.CAPTION_2:i,s=n.labelColor,u=s===void 0?re.ONCONTENT_1:s,o=r<0?0:r,l=Math.floor(o/36e5),d=Math.floor(o%36e5/6e4),c=Math.floor(o%36e5%6e4/1e3);return p.createElement("div",{className:"sendbird-ui-play-time ".concat(t)},p.createElement(me,{type:a,color:u},"".concat(l?l+":":"").concat(d<10?"0":"").concat(d||"0",":").concat(c<10?"0":"").concat(c)))},Jk=function(n){var t,e=n.className,r=n.message,i=n.channelUrl,a=n.isByMe,s=a===void 0?!1:a,u=n.isReactionEnabled,o=u===void 0?!1:u,l=N.useState(!1),d=l[0],c=l[1],f=rS({channelUrl:i,key:"".concat(r==null?void 0:r.messageId),audioFileUrl:r==null?void 0:r.url,audioFileMimeType:r==null?void 0:r.type}),h=f.play,m=f.pause,_=f.playbackTime,E=_===void 0?0:_,b=f.duration,g=f.playingStatus,C=g===void 0?wi.IDLE:g;N.useEffect(function(){var A;o&&((A=r==null?void 0:r.reactions)===null||A===void 0?void 0:A.length)>0?c(!0):c(!1)},[o,(t=r==null?void 0:r.reactions)===null||t===void 0?void 0:t.length]);var S=N.useMemo(function(){var A,I=1;if(r!=null&&r.metaArrays){var T=(A=r==null?void 0:r.metaArrays.find(function(M){return M.key==="KEY_VOICE_MESSAGE_DURATION"}))===null||A===void 0?void 0:A.value[0];return T?parseInt(T):I}return I},[r==null?void 0:r.metaArrays]);return p.createElement("div",{className:Fn("sendbird-voice-message-item-body",e,d&&"is-reactions-contained")},p.createElement(tS,{className:"sendbird-voice-message-item-body__progress-bar",maxSize:b||S,currentSize:E,colorType:s?mp.PRIMARY:mp.GRAY}),p.createElement("div",{className:"sendbird-voice-message-item-body__status-button"},(C===wi.IDLE||C===wi.PAUSED)&&p.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button",onClick:h},p.createElement(Ue,{width:"18px",height:"18px",type:ye.PLAY,fillColor:Me.PRIMARY})),C===wi.PREPARING&&p.createElement(ic,{width:"22.2px",height:"22.2px"},p.createElement(Ue,{width:"22.2px",height:"22.2px",type:ye.SPINNER,fillColor:Me.PRIMARY_2})),C===wi.PLAYING&&p.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button",onClick:function(){m()}},p.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause"},p.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause__inner"}),p.createElement("div",{className:"sendbird-voice-message-item-body__status-button__button__pause__inner"})))),p.createElement(iS,{className:"sendbird-voice-message-item-body__playback-time",time:S-E,labelType:he.BODY_1,labelColor:s?re.ONCONTENT_1:re.ONBACKGROUND_1}))};function e6(n){var t,e,r=n.className,i=r===void 0?"":r,a=n.message,s=n.isByMe,u=s===void 0?!1:s,o=n.mouseHover,l=o===void 0?!1:o,d=n.isReactionEnabled,c=d===void 0?!1:d,f=n.showFileViewer,h=f===void 0?ot:f,m=n.style,_=m===void 0?{}:m,E=nS(a),b=N.useState(!1),g=b[0],C=b[1],S=Ou({onLongPress:ot,onClick:function(){Fo(a)&&(h==null||h(!0))}});return p.createElement("div",G({className:Br([i,"sendbird-thumbnail-message-item-body",u?"outgoing":"incoming",l?"mouse-hover":"",c&&((e=(t=a.reactions)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0)>0?"reactions":""])},S),p.createElement(Xt,{className:"sendbird-thumbnail-message-item-body__thumbnail",url:E||Pd(a),alt:xd(a),width:(_==null?void 0:_.width)||"360px",height:(_==null?void 0:_.height)||"270px",onLoad:function(){C(!0)},placeHolder:function(A){var I=A.style;return p.createElement("div",{className:"sendbird-thumbnail-message-item-body__placeholder",style:I})}}),pu(a)&&!E&&!g&&p.createElement("video",{className:"sendbird-thumbnail-message-item-body__video"},p.createElement("source",{src:Pd(a),type:xd(a)})),p.createElement("div",{className:"sendbird-thumbnail-message-item-body__image-cover"}),(pu(a)||Zf(a))&&p.createElement("div",{className:"sendbird-thumbnail-message-item-body__icon-wrapper"},p.createElement("div",{className:"sendbird-thumbnail-message-item-body__icon-wrapper__icon"},p.createElement(Ue,{type:pu(a)?ye.PLAY:ye.GIF,fillColor:Me.THUMBNAIL_ICON,width:"34px",height:"34px"}))))}function n6(n){var t,e=n.className,r=n.message,i=n.isByMe,a=i===void 0?!1:i,s=n.mouseHover,u=s===void 0?!1:s,o=n.isReactionEnabled,l=o===void 0?!1:o,d=N.useContext(wt).stringSet;return p.createElement("div",{className:Br([e??"","sendbird-unknown-message-item-body",a?"outgoing":"incoming",u?"mouse-hover":"",l&&((t=r==null?void 0:r.reactions)===null||t===void 0?void 0:t.length)>0?"reactions":""])},p.createElement(me,{className:"sendbird-unknown-message-item-body__header",type:he.BODY_1,color:a?re.ONCONTENT_1:re.ONBACKGROUND_1},d.UNKNOWN__UNKNOWN_MESSAGE_TYPE),p.createElement(me,{className:"sendbird-unknown-message-item-body__description",type:he.BODY_1,color:a?re.ONCONTENT_2:re.ONBACKGROUND_2},d.UNKNOWN__CANNOT_READ_MESSAGE))}var Oe;(function(n){n.Box="box",n.Text="text",n.Image="image",n.TextButton="textButton",n.ImageButton="imageButton",n.Carousel="carouselView"})(Oe||(Oe={}));const Hd=(n,t)=>typeof t[n]!="string"?{}:{[n]:t6(t[n])};function t6(n){return n.startsWith("#")?n.length===9?`#${n.slice(3)}${n[1]}${n[2]}`:n.length===5?`#${n.slice(2)}${n[1]}`:n:n}const mf=n=>n?{viewStyle:Object.assign(Object.assign(Object.assign({},n),Hd("backgroundColor",n)),Hd("borderColor",n))}:{},r6=n=>n?{textStyle:Object.assign(Object.assign({},n),Hd("color",n))}:{},i6=n=>n?{imageStyle:Object.assign(Object.assign({},n),Hd("tintColor",n))}:{},a6={run(n){return n.type===Oe.Text||n.type===Oe.TextButton?Object.assign(Object.assign(Object.assign({},n),mf(n.viewStyle)),r6(n.textStyle)):n.type===Oe.ImageButton||n.type===Oe.Image?Object.assign(Object.assign(Object.assign({},n),mf(n.viewStyle)),i6(n.imageStyle)):Object.assign(Object.assign({},n),mf(n.viewStyle))}},Ga=n=>typeof n=="string"?!Number.isNaN(Number(n)):typeof n=="number"&&!Number.isNaN(n),Tu=(n,t)=>t[n]===void 0||t[n]===null?{}:Ga(t[n])?{[n]:Number(t[n])}:{},Gv=(n,t)=>t?{[n]:{left:Ga(t.left)?Number(t.left):t.left,right:Ga(t.right)?Number(t.right):t.right,top:Ga(t.top)?Number(t.top):t.top,bottom:Ga(t.bottom)?Number(t.bottom):t.bottom}}:{},Vv=(n,t)=>t?{[n]:{type:t.type,value:Ga(t.value)?Number(t.value):t.value}}:{},s6=n=>n?{metaData:{pixelWidth:Ga(n.pixelWidth)?Number(n.pixelWidth):n.pixelWidth,pixelHeight:Ga(n.pixelHeight)?Number(n.pixelHeight):n.pixelHeight}}:{},u6=n=>n?{viewStyle:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),Tu("borderWidth",n)),Tu("radius",n)),Gv("margin",n.margin)),Gv("padding",n.padding))}:{},o6=n=>n?{textStyle:Object.assign(Object.assign(Object.assign({},n),Tu("size",n)),Tu("weight",n))}:{},l6=n=>n?{carouselStyle:Object.assign(Object.assign({},n),Tu("spacing",n))}:{},uc=n=>Object.assign(Object.assign(Object.assign({},Vv("width",n.width)),Vv("height",n.height)),u6(n.viewStyle)),d6=n=>Object.assign(Object.assign(Object.assign({},uc(n)),o6(n.textStyle)),Tu("maxTextLines",n)),c6=n=>Object.assign(Object.assign({},uc(n)),s6(n.metaData)),f6=n=>Object.assign(Object.assign(Object.assign({},uc(n)),l6(n.carouselStyle)),{items:n.items.map(t=>Object.assign(Object.assign({},t),{body:Object.assign(Object.assign({},t.body),{items:t.body.items.map(e=>aS.run(e))})}))}),aS={run(n){return n.type===Oe.Text||n.type===Oe.TextButton?Object.assign(Object.assign({},n),d6(n)):n.type===Oe.ImageButton||n.type===Oe.Image?Object.assign(Object.assign({},n),c6(n)):n.type===Oe.Carousel?Object.assign(Object.assign({},n),f6(n)):Object.assign(Object.assign({},n),uc(n))}},h6=()=>{},sS=n=>{var t;const e=(n==null?void 0:n.defaultMapper)||h6,r={defaultMapper:e,mapBoxProps:(n==null?void 0:n.mapBoxProps)||e,mapTextProps:(n==null?void 0:n.mapTextProps)||e,mapImageProps:(n==null?void 0:n.mapImageProps)||e,mapTextButtonProps:(n==null?void 0:n.mapTextButtonProps)||e,mapImageButtonProps:(n==null?void 0:n.mapImageButtonProps)||e,mapCarouselProps:(n==null?void 0:n.mapCarouselProps)||e},i=[a6,aS,...(t=n==null?void 0:n.transforms)!==null&&t!==void 0?t:[]],a=new Set;return{setTransforms(s){i.length=0,i.push(...s),a.clear()},addTransforms(s){i.push(...s)},parse(s,u){const o=i.reduce((l,d)=>d.run(l),s);switch(o.type){case Oe.Box:return{transformed:o,properties:r.mapBoxProps(o,u)};case Oe.Text:return{transformed:o,properties:r.mapTextProps(o,u)};case Oe.Image:return{transformed:o,properties:r.mapImageProps(o,u)};case Oe.TextButton:return{transformed:o,properties:r.mapTextButtonProps(o,u)};case Oe.ImageButton:return{transformed:o,properties:r.mapImageButtonProps(o,u)};case Oe.Carousel:return{transformed:o,properties:r.mapCarouselProps(o,u)};default:return{transformed:o,properties:void 0}}}}},su=({children:n})=>p.createElement(p.Fragment,null,n);function uS(n){var t,e,r,i,a,s;return{box:((t=n==null?void 0:n.views)===null||t===void 0?void 0:t.box)||su,text:((e=n==null?void 0:n.views)===null||e===void 0?void 0:e.text)||su,image:((r=n==null?void 0:n.views)===null||r===void 0?void 0:r.image)||su,imageButton:((i=n==null?void 0:n.views)===null||i===void 0?void 0:i.imageButton)||su,textButton:((a=n==null?void 0:n.views)===null||a===void 0?void 0:a.textButton)||su,carouselView:((s=n==null?void 0:n.views)===null||s===void 0?void 0:s.carouselView)||su}}var p6=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const oS=N.createContext({sizes:{},updateSize:()=>{}}),m6=({children:n})=>{const[t,e]=N.useState({}),r=N.useCallback(i=>{var{id:a}=i,s=p6(i,["id"]);a&&e(u=>Object.assign(Object.assign({},u),{[a]:s}))},[]);return p.createElement(oS.Provider,{value:{sizes:t,updateSize:r}},n)},_6=()=>N.useContext(oS);var tt;(function(n){n.Row="row",n.Column="column"})(tt||(tt={}));var ct;(function(n){n.Center="center",n.Left="left",n.Right="right",n.Top="top",n.Bottom="bottom"})(ct||(ct={}));var Jn;(function(n){n[n.FillParent=0]="FillParent",n[n.WrapContent=1]="WrapContent"})(Jn||(Jn={}));var tr;(function(n){n.Normal="normal",n.Bold="bold"})(tr||(tr={}));var vr;(function(n){n.AspectFit="aspectFit",n.AspectFill="aspectFill",n.ScalesToFill="scalesToFill"})(vr||(vr={}));const lS=[1,2],Ol=n=>{switch(n){case ct.Right:case ct.Bottom:return"flex-end";case ct.Center:return"center";case ct.Left:case ct.Top:default:return"flex-start"}},g6=n=>n?lS.includes(Number(n)):!0,E6=n=>{const t=new Map,e=function(r){return(t.has(r)||t.set(r,n.call(this,r)))&&t.get(r)};return e.cache=t,e},v6=E6(n=>{const t=(e,r)=>{"items"in e&&(e==null?void 0:e.items)!=null&&e.items.forEach((i,a)=>{const s=`${r}-${a}`;i.id=s,t(i,s)})};return n.forEach((e,r)=>{const i=`${r}`;e.id=i,t(e,i)}),n}),_i={rootLayout:tt.Column,view:{size:{width:{type:"flex",value:Jn.FillParent},height:{type:"flex",value:Jn.WrapContent}}},box:{layout:tt.Row,align:{vertical:ct.Top,horizontal:ct.Left}},textButton:{maxTextLines:1},carousel:{style:{spacing:10,maxChildWidth:240}}},dS=n=>{const t=n.Container||p.Fragment,e=n.UnknownMessage||(()=>null),r=n.parser||sS(),i=n.renderer||uS(),a=({templateItems:s,templateVersion:u,parentLayout:o=_i.box.layout,depth:l=0})=>{if(!g6(u))throw new Error(`Cannot parse template item due to unsupported template version: ${u}, ${lS}`);return p.createElement(p.Fragment,null,s.map((d,c,f)=>{const h=r.parse(d,{parentLayout:o,depth:l,elemIdx:c,siblings:f}),m=h.transformed,_={key:c,siblings:f,parentLayout:o,parsedProperties:h.properties};switch(m.type){case Oe.Carousel:{if(!Array.isArray(m.items)||m.items.length===0)throw new Error("Cannot parse template item as Carousel if carousel has no items.");return p.createElement(i.carouselView,Object.assign({},m,_),m.items.map((E,b)=>p.createElement(a,{key:b,templateItems:E.body.items||[],depth:l+1,templateVersion:E.version})))}case Oe.Box:return p.createElement(i.box,Object.assign({},m,_),p.createElement(a,{templateItems:m.items||[],parentLayout:m.layout,depth:l+1,templateVersion:u}));case Oe.Text:return p.createElement(i.text,Object.assign({},m,_));case Oe.Image:return p.createElement(i.image,Object.assign({},m,_));case Oe.TextButton:return p.createElement(i.textButton,Object.assign({},m,_));case Oe.ImageButton:return p.createElement(i.imageButton,Object.assign({},m,_));default:return p.createElement(e,{item:m})}}))};return{MessageTemplate:({templateVersion:s,templateItems:u,parentLayout:o=_i.rootLayout})=>{const l=v6(u);return p.createElement(m6,null,p.createElement(t,null,p.createElement(a,{isRoot:!0,parentLayout:o,templateItems:l,templateVersion:s})))},MessageTemplateBase:a}};var di;(function(n){n.Web="web",n.Custom="custom",n.UIKit="uikit"})(di||(di={}));Oe.Image,di.Web,vr.AspectFill,Oe.Box,tt.Column,Jn.FillParent,Oe.Box,Jn.FillParent,Jn.FillParent,Oe.Box,tt.Column,Jn.FillParent,Jn.WrapContent,Oe.Text,ct.Center,ct.Center,Jn.FillParent,Oe.Image,di.Web,Jn.FillParent,vr.AspectFill,Oe.Box,Jn.FillParent,Oe.Box,Jn.FillParent,Jn.FillParent,Oe.Box,tt.Column,Oe.Box,ct.Left,ct.Center,tt.Row,Jn.FillParent,Oe.Text,Jn.FillParent,ct.Center,ct.Left,tr.Bold,Oe.ImageButton,di.UIKit,vr.AspectFit,Oe.Text,Oe.TextButton,di.Web,tr.Bold;Oe.Image,di.Web,vr.AspectFill,Oe.Box,tt.Column,Jn.FillParent,Oe.Box,Jn.FillParent,tt.Row,Oe.TextButton,di.Web,tr.Bold,Oe.TextButton,di.Web,Jn.FillParent,tr.Bold,Oe.Box,Jn.FillParent,tt.Row,Oe.Text,Jn.FillParent,tr.Bold,Oe.ImageButton,di.UIKit,vr.AspectFit,Oe.Text;Oe.Box,tt.Column,Oe.Image,vr.AspectFill,Oe.Box,tt.Column,Oe.Text,tr.Bold,Oe.Text,Oe.Box,ct.Left,ct.Center,tt.Row,Oe.Image,vr.AspectFill,Oe.Box,ct.Left,ct.Center,tt.Column,Oe.Text,tr.Bold,Oe.Text,tr.Bold,Oe.Box,ct.Left,ct.Center,tt.Row,Oe.Image,vr.AspectFill,Oe.Box,ct.Left,ct.Center,tt.Column,Oe.Text,tr.Bold,Oe.Text,tr.Bold,Oe.Box,ct.Left,ct.Center,tt.Row,Oe.Image,vr.AspectFill,Oe.Box,ct.Left,ct.Center,tt.Column,Oe.Text,tr.Bold,Oe.Text,tr.Bold,Oe.Box,ct.Left,ct.Center,tt.Row,Oe.TextButton,di.Web,tr.Bold,Oe.TextButton,di.Web,tr.Bold;Oe.Box,tt.Column,Oe.Image,Oe.Box,tt.Column,Oe.Box,tt.Row,Oe.Box,tt.Column,Oe.Text,tr.Bold,Oe.Text,Oe.ImageButton,di.UIKit,Oe.Box,tt.Column,Oe.Box,ct.Left,ct.Center,tt.Row,Oe.Image,vr.AspectFill,Oe.Box,tt.Column,Oe.Text,tr.Bold,Oe.Text,Oe.Box,ct.Left,ct.Center,tt.Row,Oe.Image,vr.AspectFill,Oe.Box,tt.Column,Oe.Text,tr.Bold,Oe.Text;Jn.FillParent,Jn.FillParent,Jn.FillParent,Jn.FillParent,Jn.FillParent,Jn.FillParent;Jn.FillParent,Jn.WrapContent,Jn.FillParent,Jn.FillParent;const y6=24;function b6({spacing:n,childrenLength:t,paddingInlineStart:e,paddingInlineEnd:r}){const i=e,a=r,s=N.useRef(null),u=N.useRef(Array.from({length:t},()=>p.createRef())),o=N.useRef(!1),l=N.useRef(!1),d=N.useRef(null),c=N.useRef({sx:null,sy:null,offset:0,translateX:0,currentIndex:0}),[f,h]=N.useState(()=>u.current.map(()=>0)),m=N.useMemo(()=>{let B=i;return f.map((V,K)=>{const $=B-(K>0?n:0),q=$-V;return B=q,{start:$,end:q}})},[f,n,i]),_=N.useMemo(()=>{const B=f.reduce((K,$)=>K+$,0),V=n*(t-1);return B+V},[f,n,t]);N.useLayoutEffect(()=>{h(u.current.map(B=>{var V,K;return(K=(V=B.current)===null||V===void 0?void 0:V.clientWidth)!==null&&K!==void 0?K:0}))},[t]),N.useLayoutEffect(()=>{m.length>0&&(c.current.translateX=m[0].start,A())},[m]);const E=()=>{s.current&&(o.current=!0,s.current.style.cursor="grabbing",s.current.style.transition="none",d.current=requestAnimationFrame(A))},b=()=>{s.current&&(o.current=!1,s.current.style.cursor="grab",s.current.style.transition="transform 0.5s ease",d.current&&(cancelAnimationFrame(d.current),d.current=null))},g=()=>{const{offset:B,currentIndex:V}=c.current,K=Math.abs(B)>=y6,$=B<0&&V<t-1,q=B>0&&V>0;let se=V;K&&$?se=V+1:K&&q&&(se=V-1);function Y(ce){var X,Se;const te=(Se=(X=s.current)===null||X===void 0?void 0:X.clientWidth)!==null&&Se!==void 0?Se:0,be=i,xe=Math.min(0,te-_)-a;return Math.min(be,Math.max(xe,ce))}c.current.currentIndex=se,c.current.translateX=Y(m[se].start),c.current.offset=0},C=()=>{l.current=!0},S=()=>{l.current=!1},A=()=>{s.current&&(s.current.style.transform=`translateX(${c.current.translateX+c.current.offset}px)`),d.current&&(d.current=requestAnimationFrame(A))},I=()=>{s.current&&(s.current.style.touchAction="pan-x")},T=()=>{s.current&&(s.current.style.touchAction="pan-y")};return{carouselRef:s,childrenRefs:u,handlers:{onMouseDown:B=>{E(),S(),c.current.sx=B.clientX,c.current.sy=B.clientY,c.current.offset=0,d.current=requestAnimationFrame(A)},onMouseMove:B=>{!o.current||c.current.sx===null||(c.current.offset=B.clientX-c.current.sx)},onMouseUp:()=>{o.current&&(S(),g(),b())},onMouseLeave:()=>{o.current&&(S(),g(),b())},onTouchStart:B=>{S(),b();const V=B.touches[0];c.current.sx=V.clientX,c.current.sy=V.clientY,c.current.offset=0,d.current=requestAnimationFrame(A)},onTouchMove:B=>{if(c.current.sx===null||c.current.sy===null||l.current)return;const{clientX:V,clientY:K}=B.touches[0],{sx:$,sy:q}=c.current;if(o.current){c.current.offset=V-$;return}Math.abs(K-q)>Math.abs(V-$)?C():(c.current.offset=V-$,I(),E())},onTouchEnd:()=>{T(),S(),g(),b()}}}}var C6=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const S6=({children:n,style:t,spacing:e=_i.carousel.style.spacing,maxChildWidth:r=_i.carousel.style.maxChildWidth})=>{const i=t??{},{paddingInlineStart:a=0,paddingInlineEnd:s=0}=i,u=C6(i,["paddingInlineStart","paddingInlineEnd"]),{carouselRef:o,childrenRefs:l,handlers:d}=b6({spacing:e,childrenLength:n.length,paddingInlineStart:Number(a),paddingInlineEnd:Number(s)});return p.createElement("div",Object.assign({},d,{ref:o,className:"sb-message-template__carousel",style:Object.assign(Object.assign({},u),{gap:e,width:"100%",overflow:"visible"})}),n.map((c,f)=>p.createElement(T6,{ref:l.current[f],key:f,maxChildWidth:r},c)))},T6=p.forwardRef(function({maxChildWidth:t,children:e},r){const i=N6(e.props,t)?t:"fit-content";return p.createElement("div",{ref:r,style:{maxWidth:i,width:"100%",flexShrink:0,overflow:"hidden",userSelect:"none"}},e)});function N6(n,t){return!!n.templateItems.find(e=>{var r,i,a,s;const u=((r=e.width)===null||r===void 0?void 0:r.type)==="flex"&&((i=e.width)===null||i===void 0?void 0:i.value)===Jn.FillParent,o=((a=e.width)===null||a===void 0?void 0:a.type)==="fixed"&&((s=e.width)===null||s===void 0?void 0:s.value)>=t;return u||o})}function I6(n){var t;return n.type===Oe.Text&&((t=n.width)===null||t===void 0?void 0:t.value)==Jn.WrapContent}const jv=({size:n,option:t})=>t==="wrap"?n.type==="flex"&&n.value==Jn.WrapContent:t==="fill"?n.type==="flex"&&n.value==Jn.FillParent:n.type==="fixed",A6=n=>{var t;return typeof n!="string"?!1:((t=n.split(".").pop())===null||t===void 0?void 0:t.toLowerCase())==="gif"};var M6=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const w6=n=>{const{imageSize:t,canvasRef:e,canvasProps:r}=O6(n);return p.createElement("canvas",Object.assign({},r,{ref:e,width:t==null?void 0:t.width,height:t==null?void 0:t.height,onError:n.onError}))},O6=n=>{var{metaData:t,tintColor:e}=n,r=M6(n,["metaData","tintColor"]);const i=N.useRef(null),[a,s]=N.useState(),u=N.useMemo(()=>t!=null&&t.pixelHeight&&(t!=null&&t.pixelWidth)?{width:t.pixelWidth,height:t.pixelHeight}:a,[a,t==null?void 0:t.pixelHeight,t==null?void 0:t.pixelWidth]);return N.useEffect(()=>{if(u==null&&(console.log("Canvas_ReactMessageTemplateImage: no metaData, render fit to container"),i.current)){i.current.style.width="100%",i.current.style.height="100%";const o=i.current.getBoundingClientRect();s(o)}},[u]),N.useEffect(()=>{if(r.src){const o=new Image,l=()=>{if(i.current&&e&&u){const c=i.current.getContext("2d");if(c){const{width:f,height:h}=u;c.clearRect(0,0,f,h),c.beginPath(),c.globalCompositeOperation="source-over",c.fillStyle="#000",c.drawImage(o,0,0,f,h),c.globalCompositeOperation="source-atop",c.fillStyle=e,c.fillRect(0,0,f,h)}}},d=c=>{var f;(f=r.onError)===null||f===void 0||f.call(r,c)};return o.addEventListener("load",l),o.addEventListener("error",d),o.src=r.src,()=>{o.removeEventListener("load",l),o.removeEventListener("error",d)}}},[r.src,u,e]),{canvasRef:i,canvasProps:r,imageSize:u}},R6=n=>p.createElement("img",Object.assign({},n,{onError:n.onError,referrerPolicy:"no-referrer"})),D6=n=>p.createElement("div",{style:Object.assign(Object.assign({},n.style),{backgroundColor:"transparent"})});var L6=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const qv=n=>{var{tintColor:t,metaData:e}=n,r=L6(n,["tintColor","metaData"]);const{hasError:i,onError:a}=U6(r.src);return r.onError&&console.warn("`onError` is intercepted and not executed in the ReactMessageTemplateImage."),i?p.createElement(D6,Object.assign({},r)):t&&!A6(r.src)?p.createElement(w6,Object.assign({},r,{onError:a,tintColor:t,metaData:e})):p.createElement(R6,Object.assign({},r,{onError:a}))},U6=n=>{const[t,e]=N.useState(!1);return N.useEffect(()=>e(!1),[n]),{hasError:t,onError:N.useCallback(()=>e(!0),[])}};function uu(n){return Object.assign({display:"flex",overflow:"hidden",boxSizing:"border-box"},n)}function ou(n,t,e){F6(n,t,e),x6(n,t)}function k6(n,t,e,r){t&&(n["--border-width"]=`${t}px`,n["--border-color"]=e||"transparent"),r&&(n.borderRadius=r,n["--border-radius"]=`${r}px`)}function x6(n,t){var e,r,i,a,s,u,o,l;const{viewStyle:d}=t;n.marginBlockStart=(e=d==null?void 0:d.margin)===null||e===void 0?void 0:e.top,n.marginBlockEnd=(r=d==null?void 0:d.margin)===null||r===void 0?void 0:r.bottom,n.marginInlineStart=(i=d==null?void 0:d.margin)===null||i===void 0?void 0:i.left,n.marginInlineEnd=(a=d==null?void 0:d.margin)===null||a===void 0?void 0:a.right;const c=((u=(s=d==null?void 0:d.margin)===null||s===void 0?void 0:s.left)!==null&&u!==void 0?u:0)+((l=(o=d==null?void 0:d.margin)===null||o===void 0?void 0:o.right)!==null&&l!==void 0?l:0);c>0&&n.width==="100%"&&(n.width=`calc(100% - ${c}px)`),d!=null&&d.backgroundColor&&(n.backgroundColor=d.backgroundColor),d!=null&&d.backgroundImageUrl&&(n.backgroundImage=`url(${JSON.stringify(d.backgroundImageUrl)})`,n.backgroundSize="100% 100%",n.backgroundPosition="center"),k6(n,d==null?void 0:d.borderWidth,d==null?void 0:d.borderColor,d==null?void 0:d.radius)}function P6(n,t,e){const r={};return n.type==="flex"&&n.value==Jn.FillParent?(r.width="100%",e===tt.Row&&(r.flex=1)):n.type==="fixed"&&n.value>=0&&(r.width=n.value),t.type==="flex"&&t.value==Jn.FillParent?(r.height="100%",e===tt.Column&&(r.flex=1)):t.type==="fixed"&&t.value>=0&&(r.height=t.value),r}function F6(n,t,e){var r,i;const{width:a,height:s}=_i.view.size,{parentLayout:u}=e,o=P6((r=t.width)!==null&&r!==void 0?r:a,(i=t.height)!==null&&i!==void 0?i:s,u);Object.assign(n,o)}function zv(n,t=_i.box.layout,e=_i.box.align){t===tt.Row&&(n.flexDirection="row",n.alignItems=Ol(e.vertical),n.justifyContent=Ol(e.horizontal)),t===tt.Column&&(n.flexDirection="column",n.alignItems=Ol(e.horizontal),n.justifyContent=Ol(e.vertical))}function H6(n,t=_i.box.align.horizontal){n.textAlign=t}function Kv(n,t){const{contentMode:e=vr.AspectFit}=t||{};if(e)switch(e){case vr.AspectFill:n.objectFit="cover";break;case vr.AspectFit:n.objectFit="contain";break;case vr.ScalesToFill:n.objectFit="fill";break}}function $v(n,t){var e,r,i,a;const s=t==null?void 0:t.metaData;!(s!=null&&s.pixelHeight)||!(s!=null&&s.pixelWidth)||((e=t==null?void 0:t.width)===null||e===void 0?void 0:e.type)==="fixed"||((r=t==null?void 0:t.height)===null||r===void 0?void 0:r.type)==="fixed"||(n.aspectRatio=`${(i=t==null?void 0:t.metaData)===null||i===void 0?void 0:i.pixelWidth} / ${(a=t==null?void 0:t.metaData)===null||a===void 0?void 0:a.pixelHeight}`)}function Wv(n){return{WebkitLineClamp:n,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden",overflowWrap:"anywhere",flex:1}}function Yv(n,t,e){const{textStyle:r,width:i}=t,{size:a,color:s,weight:u}=r||{};if(a&&(n.fontSize=a),s&&(n.color=s),u&&(n.fontWeight=u),(i==null?void 0:i.type)==="flex"&&(i==null?void 0:i.value)==Jn.WrapContent&&(n.width="fit-content",n.maxWidth="100%"),t.type===Oe.Text){const{siblings:o,elemIdx:l}=e;o!=null&&o.length>=2&&o.every(I6)&&(n.flexShrink=o.length-1===l?1:0)}}const cS=p.createContext(null),B6=n=>{const{message:t,handleWebAction:e,handleCustomAction:r,handlePredefinedAction:i,children:a}=n,s=p.useMemo(()=>({message:t,handleWebAction:e,handleCustomAction:r,handlePredefinedAction:i}),[t==null?void 0:t.updatedAt]);return p.createElement(cS.Provider,{value:s},a)},G6=()=>{const n=p.useContext(cS);if(!n)throw new Error("useMessageContext must be used within a MessageProvider");return n};function fS(n){const t=N.useRef(n);return N.useEffect(()=>{t.current=n},[n]),N.useCallback((...e)=>t.current(...e),[t])}function V6(n,t){const e=fS(n),r=N.useRef(Qv);return N.useCallback(a=>{if(r.current(),r.current=Qv,a!=null){const s=n(a);typeof s=="function"&&(r.current=s)}},[e,...t])}function Qv(){}function j6(n){const t=fS(n);return V6(r=>{const i=new ResizeObserver(a=>{a[0]!=null&&t(a[0])});return i.observe(r),()=>{i.unobserve(r)}},[t])}function q6(){const[n,t]=N.useState(-1),[e,r]=N.useState(-1),[i,a]=N.useState(-1),[s,u]=N.useState(-1),[o,l]=N.useState(-1),[d,c]=N.useState(-1);return{ref:j6(h=>{const{width:m,height:_}=h.contentRect,E=h.target,{width:b,height:g}=E.getBoundingClientRect();t(b),r(g),a(m),u(_),l(b-m),c(g-_)}),width:n,height:e,contentWidth:i,contentHeight:s,paddingWidth:o,paddingHeight:d}}var z6=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function Rl({width:n=_i.view.size.width,height:t=_i.view.size.height,parentLayout:e=_i.box.layout,option:r}){return e===tt.Row?jv({size:n,option:r}):jv({size:t,option:r})}function K6(n){const{style:t,props:e}=n,r=q6(),{ref:i}=r,a=z6(r,["ref"]),{updateSize:s,sizes:u}=_6(),{id:o,siblings:l,parentLayout:d}=e,{width:c,height:f,paddingWidth:h,paddingHeight:m,contentWidth:_,contentHeight:E}=a;return N.useEffect(()=>{s({id:e.id,width:c,height:f,paddingWidth:h,paddingHeight:m,contentWidth:_,contentHeight:E})},[e.id,c,f,h,m,_,E,s]),{recalculatedStyle:N.useMemo(()=>{const g=(S=0,A)=>{var I,T,M,O;return d===tt.Row?S+((T=(I=u[A.id])===null||I===void 0?void 0:I.contentWidth)!==null&&T!==void 0?T:0):S+((O=(M=u[A.id])===null||M===void 0?void 0:M.contentHeight)!==null&&O!==void 0?O:0)};if(Rl({width:e.width,height:e.height,parentLayout:d,option:"fill"})){const S=l.filter(({width:T,height:M})=>!Rl({width:T,height:M,parentLayout:d,option:"fill"})).reduce(g,0),A=l.filter(({width:T,height:M})=>Rl({width:T,height:M,parentLayout:d,option:"fill"})).length,I=d===tt.Row?{maxWidth:`calc((100% - ${S}px) / ${A})`}:{maxHeight:`calc((100% - ${S}px) / ${A})`};return Object.assign(Object.assign(Object.assign({},t),I),c==0&&{height:0})}else{const S=l.findIndex(I=>I.id===o),A=l.slice(0,S).filter(({width:I,height:T})=>Rl({width:I,height:T,parentLayout:d,option:"wrap"})).reduce(g,0);return Object.assign(Object.assign(Object.assign({},t),c===0&&{height:0}),d===tt.Row?{maxWidth:`calc(100% - ${A}px)`}:{maxHeight:`calc(100% - ${A}px)`})}},[e.width,e.height,d,u,l,t,c,o]),elemRef:i}}var $6=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const W6=(n="")=>["http://","https://","ftp://"].some(t=>n.startsWith(t)),Xv=(n="")=>W6(n)?n:`https://${n}`,Xu=({children:n,props:t,className:e,style:r})=>{var i,a,s,u,o,l,d,c,f;const{recalculatedStyle:h,elemRef:m}=K6({style:r,props:t}),{message:_,handleWebAction:E,handleCustomAction:b,handlePredefinedAction:g}=G6(),C=!((i=t.viewStyle)===null||i===void 0)&&i.borderWidth?"sb-message-template__border":"",S={paddingBlockStart:(s=(a=t.viewStyle)===null||a===void 0?void 0:a.padding)===null||s===void 0?void 0:s.top,paddingBlockEnd:(o=(u=t.viewStyle)===null||u===void 0?void 0:u.padding)===null||o===void 0?void 0:o.bottom,paddingInlineStart:(d=(l=t.viewStyle)===null||l===void 0?void 0:l.padding)===null||d===void 0?void 0:d.left,paddingInlineEnd:(f=(c=t.viewStyle)===null||c===void 0?void 0:c.padding)===null||f===void 0?void 0:f.right},A=P=>{var L,F,B,V,K,$,q;((L=t.action)===null||L===void 0?void 0:L.type)==="web"?E?E(P,t.action,_):(B=window==null?void 0:window.open(Xv((F=t==null?void 0:t.action)===null||F===void 0?void 0:F.data),"_blank","noopener noreferrer"))===null||B===void 0||B.focus():((V=t.action)===null||V===void 0?void 0:V.type)==="custom"?b?b(P,t.action,_):($=window==null?void 0:window.open(Xv((K=t==null?void 0:t.action)===null||K===void 0?void 0:K.data),"_blank","noopener noreferrer"))===null||$===void 0||$.focus():((q=t.action)===null||q===void 0?void 0:q.type)==="uikit"&&(g==null||g(P,t.action,_))};if(t.type===Oe.TextButton)return p.createElement("button",{className:Zv(e,C),"data-sb-template-id":t.elementId,style:Object.assign(Object.assign({},r),S),onClick:A},n);const{display:I,flexDirection:T,justifyContent:M,alignItems:O,objectFit:R}=h,U=$6(h,["display","flexDirection","justifyContent","alignItems","objectFit"]);return p.createElement("div",{ref:m,className:Zv(e,C,t.action&&"sb-message-template__action"),"data-sb-template-id":t.elementId,style:U,onClick:A},p.createElement("div",{style:Object.assign({display:I,flexDirection:T,justifyContent:M,alignItems:O,objectFit:R,width:"100%",height:"100%"},S)},n))};function Zv(...n){return n.filter(t=>!!t).join(" ")}function Y6(n){var t,e,r,i;const a=(t=n==null?void 0:n.height)===null||t===void 0?void 0:t.type,s=(e=n==null?void 0:n.width)===null||e===void 0?void 0:e.type,u=a==="fixed"||s==="fixed",o=a==="flex"&&((r=n==null?void 0:n.height)===null||r===void 0?void 0:r.value)===Jn.FillParent||s==="flex"&&((i=n==null?void 0:n.width)===null||i===void 0?void 0:i.value)===Jn.FillParent;return u||o}function Q6(n){return n.split(`
`).map((t,e)=>p.createElement(p.Fragment,{key:e},t,p.createElement("br",null)))}function Jv(n){const{text:t,maxTextLines:e}=n,r=Y6(n),i=typeof e=="number"&&e>0,a=Q6(t);if(i||r){const s=Object.assign(Object.assign({},(i||r)&&{maxWidth:"100%"}),r&&{maxHeight:"100%",overflow:"hidden"});return p.createElement("div",{style:s},i?p.createElement("div",{style:Wv(e)},a):a)}return i?p.createElement("div",{style:Wv(e)},a):a}const hS=uS({views:{box(n){return p.createElement(Xu,{className:"sb-message-template__box",elementId:n.elementId,style:n.parsedProperties,props:n},n.children)},text(n){return p.createElement(Xu,{className:"sb-message-template__text",elementId:n.elementId,style:n.parsedProperties,props:n},Jv(n))},image(n){var t;return p.createElement(Xu,{className:"sb-message-template__image-container",elementId:n.elementId,style:n.parsedProperties,props:n},p.createElement(qv,{className:"sb-message-template__image",alt:"image",src:n.imageUrl,style:{width:"100%",height:"100%",aspectRatio:"inherit",objectFit:"inherit"},tintColor:(t=n.imageStyle)===null||t===void 0?void 0:t.tintColor,metaData:n.metaData}))},textButton(n){return p.createElement(Xu,{className:"sb-message-template__text-button",elementId:n.elementId,style:n.parsedProperties,props:n},Jv(Object.assign({maxTextLines:_i.textButton.maxTextLines},n)))},imageButton(n){var t;return p.createElement(Xu,{className:"sb-message-template__image-container sb-message-template__image-button",elementId:n.elementId,style:n.parsedProperties,props:n},p.createElement(qv,{className:"sb-message-template__image",alt:"image-button",src:n.imageUrl,style:{width:"100%",height:"100%",aspectRatio:"inherit",objectFit:"inherit"},tintColor:(t=n.imageStyle)===null||t===void 0?void 0:t.tintColor,metaData:n.metaData}))},carouselView(n){var t,e;return p.createElement(S6,{maxChildWidth:(t=n.carouselStyle)===null||t===void 0?void 0:t.maxChildWidth,spacing:(e=n.carouselStyle)===null||e===void 0?void 0:e.spacing,style:n.parsedProperties},n.children)}}}),pS=sS({mapBoxProps(n,t){const e=uu();return ou(e,n,t),zv(e,n.layout,n.align),e},mapTextProps(n,t){var e;const r=uu({whiteSpace:"pre-line",wordBreak:"break-word"});return ou(r,n,t),Yv(r,n,t),zv(r,tt.Row,n.align),H6(r,(e=n.align)===null||e===void 0?void 0:e.horizontal),r},mapImageProps(n,t){const e=uu();return ou(e,n,t),Kv(e,n.imageStyle),$v(e,n),e},mapTextButtonProps(n,t){const e=uu({whiteSpace:"pre-line",alignItems:"center",justifyContent:"center"});return ou(e,n,t),Yv(e,n,t),e},mapImageButtonProps(n,t){const e=uu();return ou(e,n,t),Kv(e,n.imageStyle),$v(e,n),e},mapCarouselProps(n,t){var e,r,i,a,s,u,o,l;const d=uu();return ou(d,n,t),d.paddingBlockStart=(r=(e=n.viewStyle)===null||e===void 0?void 0:e.padding)===null||r===void 0?void 0:r.top,d.paddingBlockEnd=(a=(i=n.viewStyle)===null||i===void 0?void 0:i.padding)===null||a===void 0?void 0:a.bottom,d.paddingInlineStart=(u=(s=n.viewStyle)===null||s===void 0?void 0:s.padding)===null||u===void 0?void 0:u.left,d.paddingInlineEnd=(l=(o=n.viewStyle)===null||o===void 0?void 0:o.padding)===null||l===void 0?void 0:l.right,d}});dS({renderer:hS,parser:pS,Container:({children:n,className:t})=>p.createElement("div",{className:`sb-message-template__parent ${t}`,style:{display:"flex",flexDirection:"column",maxWidth:400,marginBlockEnd:24}},n)});var X6=dS({parser:pS,renderer:hS,Container:function(n){var t=n.children,e=n.className;return p.createElement("div",{className:["sb-message-template__parent ".concat(e),"sendbird-message-template__root"].join(" ")},t)}}).MessageTemplate;function Z6(n){var t=n.templateItems,e=n.templateVersion;return p.createElement(X6,{templateItems:t,templateVersion:e})}function ey(n){var t=n.className,e=n.message,r=n.isByMe,i=N.useContext(wt).stringSet,a=e.message;return p.createElement("div",{className:Br([t??"",r?"outgoing":"incoming","sendbird-template-message-item-body__fallback_message"])},a?p.createElement(p.Fragment,null,p.createElement(me,{type:he.BODY_1,color:re.ONCONTENT_INVERSE_1},a)):p.createElement(p.Fragment,null,p.createElement(me,{className:"sendbird-template-message-item-body__fallback_message__header",type:he.BODY_1,color:re.ONCONTENT_INVERSE_1},i.UNKNOWN__TEMPLATE_ERROR),p.createElement(me,{className:"sendbird-template-message-item-body__fallback_message__description",type:he.BODY_1,color:re.ONCONTENT_INVERSE_3},i.UNKNOWN__CANNOT_READ_TEMPLATE)))}var Dl="40px";function J6(n){var t=n.className,e=n.isByMe;return p.createElement("div",{className:Fn(t,e?"outgoing":"incoming","sendbird-template-loading-message-item-body")},p.createElement(ic,{className:"sendbird-message-status__icon",testID:"sendbird-message-status-icon",width:Dl,height:Dl},p.createElement(Ue,{type:ye.SPINNER,fillColor:Me.CONTENT_INVERSE_3,width:Dl,height:Dl})))}var ex=function(n){var t=n.message,e=n.templateVersion,r=n.templateItems;return p.createElement(B6,{message:t},p.createElement(Z6,{templateVersion:e,templateItems:r}))},mS=function(n){var t={},e={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var i=n[r];if(typeof i=="object"&&i!==null){var a=mS(i),s=a[0],u=a[1];t[r]=s,e[r]=u}else if(typeof i=="string"){var o=i.split(","),l=o[0],d=o[1];t[r]=l,e[r]=d||l}else t[r]=i,e[r]=i}return[t,e]};function nx(n){var t=n.colorVariables,e=n.theme,r=mS(t),i=r[0],a=r[1];return e==="light"?i:a}var tx=function(n){fC(t,n);function t(e){var r=n.call(this,e)||this;return r.state={hasError:!1},r}return t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,r){var i;(i=this.props.logger)===null||i===void 0||i.error("Error caught by ErrorBoundary: ",e,r)},t.prototype.render=function(){return this.state.hasError?this.props.fallbackMessage:this.props.children},t}(N.Component),_S=function(n,t,e){e===void 0&&(e="");for(var r=0,i=Object.entries(n);r<i.length;r++){var a=i[r],s=a[0],u=a[1],o=e?"".concat(e,".").concat(s):s;u&&typeof u=="object"?_S(u,t,o):t[o]=u}};function rx(n){var t={};return _S(n,t),t}var ix=500,ny=function(n){var t=n.template,e=n.templateData,r=e===void 0?{}:e,i=n.colorVariables,a=n.theme,s={};i&&a&&(s=nx({colorVariables:i,theme:a}));var u=G(G({},r),s),o=rx(u),l=t;return Object.entries(o).forEach(function(d){var c=d[0],f=d[1],h="\\{".concat(c,"\\}"),m=new RegExp(h,"g");l=l.replace(m,f)}),l};function ax(n){var t,e=n.className,r=e===void 0?"":e,i=n.message,a=n.isByMe,s=a===void 0?!1:a,u=n.theme,o=u===void 0?"light":u,l=(t=i.extendedMessagePayload)===null||t===void 0?void 0:t[Qo],d=function(){return p.createElement(ey,{className:r,message:i,isByMe:s})};if(!(l!=null&&l.key))return d();var c=l.key,f=Hn();if(!f)return d();var h=f.config.logger,m=f.utils,_=m.getCachedTemplate,E=m.updateMessageTemplatesInfo,b=f.stores.appInfoStore.waitingTemplateKeysMap,g=Object.entries(b).map(function(P){var L=P[0],F=P[1];return[L,F.requestedAt,F.erroredMessageIds.join(",")].join("-")}).join("_"),C=N.useState(R()),S=C[0],A=C[1];function I(P,L){for(var F=[],B=0;(B=P.indexOf(L,B))!==-1;)F.push({start:B,end:B+L.length}),B+=L.length;return F}function T(P,L,F){var B="",V=0;return L.forEach(function(K){var $=K.start,q=K.end;B+=P.slice(V,$)+F,V=q}),B+=P.slice(V),B}function M(P,L,F){var B=I(P,L);return T(P,B,F)}function O(P){var L=ny({template:P.uiTemplate,templateData:l.variables,colorVariables:P.colorVariables,theme:o});if(l.view_variables){var F={};Object.entries(l.view_variables).forEach(function(B){var V=B[0],K=B[1],$=[];K.forEach(function(q){var se=q==null?void 0:q.key;if(se){var Y=_(se);Y||h.error("TemplateMessageItemBody | simple template is expected to be cached: ",se);var ce=ny({template:Y.uiTemplate,templateData:q.variables,colorVariables:Y.colorVariables,theme:o});$.push({version:Y.version,body:{items:JSON.parse(ce)}}),F[V]=JSON.stringify($)}})}),Object.entries(F).forEach(function(B){var V=B[0],K=B[1];L=M(L,'"@{'.concat(V,'}"'),K)})}return JSON.parse(L)}function R(){var P={filledMessageTemplateItemsList:[],isErrored:!1},L=[],F=_(c);if(F||L.push(c),l!=null&&l.view_variables)try{Object.entries(l.view_variables).forEach(function(V){var K=V[0],$=V[1];$.forEach(function(q){var se=q==null?void 0:q.key;se&&!_(se)&&!L.includes(se)&&L.push(se)})})}catch{return h.error("TemplateMessageItemBody | received view_variables is malformed: ",l),P.isErrored=!0,P}try{if(L.length>0)U(L);else if(F){var B=O(F);P.filledMessageTemplateItemsList.push({version:F.version,items:B})}}catch(V){h.error("TemplateMessageItemBody | fetching non-cached templates by given template keys failed: ",V),P.isErrored=!0}return P}N.useEffect(function(){if(!S.isErrored&&S.filledMessageTemplateItemsList.length===0){var P=R();A(P)}},[l.key,g]);function U(P){if(P.length>0){var L=[];P.forEach(function(V){var K=b[V];L.push([V,K])});var F=Date.now(),B=[];L.forEach(function(V){var K=V[0],$=V[1];if(!$||$.erroredMessageIds.indexOf(i.messageId)===-1&&F>$.requestedAt+ix)B.push(K);else if($.erroredMessageIds.indexOf(i.messageId)>-1)throw new Error("TemplateMessageItemBody | fetching template key ".concat(K," for messageId: ").concat(i.messageId," has failed."))}),B.length>0&&E(B,i.messageId,F)}}return S.isErrored?d():S.filledMessageTemplateItemsList.length===0?p.createElement(J6,{className:r,isByMe:s}):p.createElement("div",{className:Br([r,s?"outgoing":"incoming","sendbird-template-message-item-body"])},p.createElement(tx,{fallbackMessage:p.createElement(ey,{className:r,message:i,isByMe:s}),logger:h},S.filledMessageTemplateItemsList.map(function(P,L){var F;return p.createElement(ex,{key:L,message:i,templateVersion:(F=P.version)!==null&&F!==void 0?F:0,templateItems:P.items})})))}function gS(n){var t=n.text,e=n.onCancel,r=N.useContext(wt).stringSet,i=N.useRef(null),a=Sm(i,{Enter:function(){return e==null?void 0:e()},Escape:function(){return e==null?void 0:e()}});return p.createElement("div",{onKeyDown:a},p.createElement(fi,{contentClassName:"sendbird-message-feedback-modal-content__mobile",type:kt.PRIMARY,onSubmit:e,onClose:e,submitText:r.BUTTON__OK,renderHeader:function(){return p.createElement("div",{className:"sendbird-modal__header"},p.createElement(me,{type:he.H_1,color:re.ONBACKGROUND_1,className:"sendbird-message-feedback-modal-header"},t))},customFooter:p.createElement("div",{className:"sendbird-message-feedback-modal-footer__root_failed"},p.createElement(Ri,{onClick:e},p.createElement(me,{type:he.BUTTON_3,color:re.ONCONTENT_1},r.BUTTON__OK)))}))}function sx(n){var t=n.className,e=t===void 0?"":t,r=n.isByMe,i=n.displayThreadReplies,a=n.bottom,s=n.message,u=n.channel,o=n.userId,l=n.chainBottom,d=l===void 0?!1:l,c=N.useRef(null),f=nm(),h=f.disableUserProfile,m=f.renderUserProfile;return r||d||!Xo(s)?null:p.createElement(wu,{menuTrigger:function(_){var E,b;return p.createElement(zr,{className:Fn(e,i&&"use-thread-replies"),src:((b=(E=u==null?void 0:u.members)===null||E===void 0?void 0:E.find(function(g){return(g==null?void 0:g.userId)===s.sender.userId}))===null||b===void 0?void 0:b.profileUrl)||s.sender.profileUrl||"",ref:c,width:"28px",height:"28px",bottom:a,onClick:function(){h||_()}})},menuItems:function(_){return m?m({user:s.sender,close:_,currentUserId:o,avatarRef:c}):p.createElement(Mu,{parentRef:c,parentContainRef:c,closeDropdown:_,style:{paddingTop:"0px",paddingBottom:"0px"}},p.createElement(Cm,{user:s.sender,onSuccess:_}))}})}var ux=function(n){var t=n.children;return p.createElement(me,{className:"sendbird-form-message__input__label",type:he.CAPTION_2,color:re.ONBACKGROUND_2},t)},ox=function(n){var t=n.name,e=n.required,r=n.errorMessage,i=n.isValid,a=n.values,s=n.isInvalidated,u=n.isSubmitTried,o=n.style,l=n.onFocused,d=n.onChange,c=n.placeHolder,f=n.isSubmitted,h=o.layout,m=o.options,_=m===void 0?[]:m,E=o.resultCount,b=E??{},g=b.min,C=g===void 0?1:g,S=b.max,A=S===void 0?1:S,I=R(),T=N.useContext(wt).stringSet,M=function(){l==null||l(!0)},O=function(){l==null||l(!1)};function R(){return f?_.map(function(P){return{state:a.includes(P)?"submittedSelected":"submittedDefault",option:P}}):_.map(function(P){return{state:a.includes(P)?"selected":"default",option:P}})}var U=function(P){if(!f){var L;C===1&&A===1?L=I[P].state==="selected"?[]:[I[P].option]:L=I.reduce(function(F,B,V){return V===P?B.state==="default"&&a.length<A&&F.push(B.option):B.state==="selected"&&F.push(B.option),F},[]),d(L)}};return p.createElement("div",{className:"sendbird-form-message__input__root"},p.createElement(ux,null,p.createElement("div",{className:"sendbird-form-message__input__title-container"},t," ",!e&&p.createElement("span",{className:"sendbird-form-message__input__title-optional"},"(optional)"))),p.createElement("div",{className:"sendbird-input_for_form"},function(){switch(h){case"chip":return p.createElement("div",{className:"sendbird-form-message__input__chip-container"},I.map(function(L,F){return p.createElement("div",{className:"sendbird-form-message__input__chip ".concat(L.state),key:F,onClick:function(){return U(F)}},p.createElement("div",{className:"sendbird-form-message__input__chip-text"},L.option),f&&L.state==="submittedSelected"&&p.createElement(Ue,{className:"sendbird-form-message__submitted-check-icon-chip",type:ye.DONE,fillColor:Me.SECONDARY_2,width:"20px",height:"20px"}))}));case"textarea":{var P=a.length>0?a[0]:"";return p.createElement("div",{className:"sendbird-form-message__input__container"},f?p.createElement("div",{className:"sendbird-form-message__submitted-input-box textarea"},p.createElement("div",{className:"sendbird-form-message__submitted-input-box-text"},P),i&&p.createElement("div",{className:"sendbird-form-message__submitted-check-icon-container"},p.createElement(Ue,{type:ye.DONE,fillColor:Me.SECONDARY_2,width:"20px",height:"20px"})),!P&&p.createElement(me,{className:"sendbird-input__placeholder",type:he.BODY_1,color:re.ONBACKGROUND_3},T.FORM_ITEM_OPTIONAL_EMPTY)):p.createElement(p.Fragment,null,p.createElement("textarea",{className:Fn("sendbird-input__input",!!r&&"error","sendbird-form-message__input__textarea"),required:e,disabled:f,value:P,onFocus:M,onBlur:O,onChange:function(L){var F=L.target.value;d(F?[F]:[])}}),c&&!P&&p.createElement(me,{className:"sendbird-input__placeholder textarea",type:he.BODY_1,color:re.ONBACKGROUND_3},c)))}case"text":case"number":case"phone":case"email":{var P=a.length>0?a[0]:"";return p.createElement("div",{className:"sendbird-form-message__input__container"},f?p.createElement("div",{className:"sendbird-form-message__submitted-input-box"},p.createElement("div",{className:"sendbird-form-message__submitted-input-box-text"},P),i&&p.createElement("div",{className:"sendbird-form-message__submitted-check-icon-container"},p.createElement(Ue,{type:ye.DONE,fillColor:Me.SECONDARY_2,width:"20px",height:"20px"})),!P&&p.createElement(me,{className:"sendbird-input__placeholder",type:he.BODY_1,color:re.ONBACKGROUND_3},T.FORM_ITEM_OPTIONAL_EMPTY)):p.createElement(p.Fragment,null,p.createElement("input",{type:h==="number"?"text":h,inputMode:h==="number"?"numeric":"text",className:"sendbird-input__input ".concat(r?"error":""),name:t,required:e,disabled:f,value:P,onFocus:M,onBlur:O,onChange:function(F){var B=F.target.value;d(B?[B]:[])}}),c&&!P&&p.createElement(me,{className:"sendbird-input__placeholder",type:he.BODY_1,color:re.ONBACKGROUND_3},c)))}default:return p.createElement(p.Fragment,null)}}(),r&&(u||s)&&p.createElement(me,{className:"sendbird-form-message__error-label",type:he.CAPTION_3},r)))},lx=function(n){var t=n.isByMe,e=n.text;return p.createElement("div",{className:Br(["sendbird-unknown-message-item-body",t?"outgoing":"incoming"])},p.createElement(me,{className:"sendbird-unknown-message-item-body__description",type:he.BODY_1,color:t?re.ONCONTENT_3:re.ONBACKGROUND_3},e))};function dx(n){var t=this,e=n.message,r=n.form,i=n.isByMe,a=n.logger,s=r.items,u=r.id,o=N.useContext(wt).stringSet,l=N.useState(!1),d=l[0],c=l[1],f=N.useState(!1),h=f[0],m=f[1],_=N.useState(function(){var T=[];return s.forEach(function(M){var O=M.required,R=M.style,U=R===void 0?{}:R,P=U.layout,L=U.defaultOptions,F=L===void 0?[]:L;T.push({draftValues:P==="chip"?F:[],required:O,errorMessage:null,isInvalidated:!1})}),T}),E=_[0],b=_[1],g=r.isSubmitted,C=E.some(function(T){var M=T.errorMessage;return!!M}),S=E.some(function(T){var M=T.isInvalidated;return M}),A=C&&(h||S)||g,I=N.useCallback(function(){return Nt(t,void 0,void 0,function(){var T,M,O;return It(this,function(R){switch(R.label){case 0:m(!0),R.label=1;case 1:return R.trys.push([1,3,,4]),T=E.some(function(U){var P=U.errorMessage;return P}),T?[2]:(M=E.some(function(U){return U.required&&(!U.draftValues||U.draftValues.length===0)}),M?(b(function(U){return U.map(function(P){return P.required&&P.draftValues.length===0?G(G({},P),{errorMessage:o.FORM_ITEM_REQUIRED}):P})}),[2]):(E.forEach(function(U,P){s[P].draftValues=U.draftValues}),[4,e.submitMessageForm()]));case 2:return R.sent(),[3,4];case 3:return O=R.sent(),c(!0),a==null||a.error(O),[3,4];case 4:return[2]}})})},[E,e.messageId,e.submitMessageForm,u]);return w0(r.version)?p.createElement("div",{className:Br(["".concat(Em," disable-hover"),"sendbird-form-message__root","incoming"])},s.map(function(T,M){var O,R=T.name,U=T.placeholder,P=T.id,L=T.required,F=T.style,B=E[M],V=B.draftValues,K=V===void 0?[]:V,$=B.errorMessage;return p.createElement(ox,{key:P,style:F,placeHolder:U,values:(O=T.submittedValues)!==null&&O!==void 0?O:K,isInvalidated:E[M].isInvalidated,isSubmitTried:h,errorMessage:$,isValid:g,isSubmitted:g,name:R,required:L,onFocused:function(q){$&&!q&&!E[M].isInvalidated?b(function(se){var Y=se.slice(0);return Y[M]=G(G({},Y[M]),{isInvalidated:!0}),Y}):$||b(function(se){var Y=se.slice(0);return Y[M]=G(G({},Y[M]),{isInvalidated:!1}),Y})},onChange:function(q){b(function(se){var Y=se.slice(0);return Y[M]=G(G({},Y[M]),{draftValues:q,errorMessage:function(){return T.isValid(q)?L&&q.length===0?o.FORM_ITEM_REQUIRED:null:o.FORM_ITEM_INVALID}()}),Y})}})}),p.createElement(Ri,{className:"sendbird-form-message__submit-button",onClick:I,disabled:A,labelType:he.BUTTON_2,labelColor:re.ONCONTENT_1},g?"Submitted successfully":"Submit"),d&&p.createElement(gS,{text:"Submit failed.",onCancel:function(){c(!1)}})):p.createElement(lx,{isByMe:i,text:o.FORM_VERSION_ERROR})}var cx="sendbird-message-content__middle__message-item-body",fx=function(n){var t,e=n.className,r=e===void 0?cx:e,i=n.message,a=n.channel,s=n.showFileViewer,u=n.onMessageHeightChange,o=n.onBeforeDownloadFileMessage,l=n.mouseHover,d=n.isMobile,c=n.config,f=n.isReactionEnabledInChannel,h=n.isByMe,m=(t=n.customSubcomponentsProps)!==null&&t!==void 0?t:{},_=Xk({isMobile:d}),E=Zk(i),b=EO(),g=(a==null?void 0:a.isGroupChannel())&&c.groupChannel.enableOgtag,C=(a==null?void 0:a.isGroupChannel())&&c.groupChannel.enableFormTypeMessage,S=function(){return p.createElement(n6,{className:r,message:i,isByMe:h,mouseHover:l,isReactionEnabled:f})};return cr(i).when(function(A){return C&&NC(A)},function(){return p.createElement(dx,{isByMe:h,message:i,form:i.messageForm,logger:c.logger})}).when(Md,function(){var A,I,T=i.extendedMessagePayload[Qo];return IC(T)?p.createElement(ax,{className:r,message:i,isByMe:h,theme:c==null?void 0:c.theme}):((I=(A=c.logger)===null||A===void 0?void 0:A.error)===null||I===void 0||I.call(A,"TemplateMessageItemBody: invalid type value in message.extendedMessagePayload.message_template.",T),S())}).when(function(A){return g&&Xo(A)&&qp(A)},function(){var A;return p.createElement(Rk,{className:r,message:i,isByMe:h,mouseHover:l,isMentionEnabled:(A=c.groupChannel.enableMention)!==null&&A!==void 0?A:!1,isReactionEnabled:f,onMessageHeightChange:u,isMarkdownEnabled:c.groupChannel.enableMarkdownForUserMessage})}).when(pO,function(){var A;return p.createElement(Uk,{className:r,message:i,isByMe:h,mouseHover:l,isMentionEnabled:(A=c.groupChannel.enableMention)!==null&&A!==void 0?A:!1,isReactionEnabled:f,isMarkdownEnabled:c.groupChannel.enableMarkdownForUserMessage})}).when(function(A){return zp(A)===b.FILE},function(){return p.createElement(kk,{className:r,message:i,isByMe:h,mouseHover:l,isReactionEnabled:f,onBeforeDownloadFileMessage:o})}).when(kr,function(){var A;return p.createElement(Qk,G({className:r,message:i,isByMe:h,mouseHover:l,isReactionEnabled:f,threadMessageKindKey:_,statefulFileInfoList:E,onBeforeDownloadFileMessage:o},(A=m.MultipleFilesMessageItemBody)!==null&&A!==void 0?A:{}))}).when(Ji,function(){var A;return p.createElement(Jk,{className:r,message:i,channelUrl:(A=a==null?void 0:a.url)!==null&&A!==void 0?A:"",isByMe:h,isReactionEnabled:f})}).when(ts,function(){var A;return p.createElement(e6,G({className:r,message:i,isByMe:h,mouseHover:l,isReactionEnabled:f,showFileViewer:s,style:d?{width:"100%"}:{}},(A=m.ThumbnailMessageItemBody)!==null&&A!==void 0?A:{}))}).otherwise(function(){return S()})},hx=function(n){var t,e,r=n.channel,i=n.message;return p.createElement(me,{className:"sendbird-message-content__middle__sender-name",type:he.CAPTION_2,color:re.ONBACKGROUND_2},((e=(t=r==null?void 0:r.members)===null||t===void 0?void 0:t.find(function(a){var s;return(a==null?void 0:a.userId)===((s=i==null?void 0:i.sender)===null||s===void 0?void 0:s.userId)}))===null||e===void 0?void 0:e.nickname)||NO(i))},ty=p.forwardRef(function(n,t){var e=n.children,r=n.isSelected,i=n.onClick,a=i===void 0?function(){}:i,s=n.disabled,u=s===void 0?!1:s;return p.createElement("button",{className:["sendbird-iconbutton__feedback",r?"sendbird-iconbutton__feedback__pressed":"",u?"sendbird-iconbutton__feedback__disabled":""].join(" "),ref:t,type:"button",onClick:function(o){a==null||a(o)},disabled:u},p.createElement("span",{className:["sendbird-iconbutton__feedback__inner",r?"sendbird-iconbutton__feedback__inner__pressed":"",u?"sendbird-iconbutton__feedback__inner__disabled":""].join(" ")},e))});function px(n){var t=n.hideMenu,e=n.onEditFeedback,r=n.onRemoveFeedback,i=$n().stringSet;return p.createElement(ac,{onBackdropClick:t},p.createElement("div",{className:"sendbird-message__bottomsheet--feedback-options-menu"},p.createElement("div",{className:"sendbird-message__bottomsheet--feedback-option",onClick:function(){t(),e()}},p.createElement(me,{type:he.BODY_1,color:re.ONBACKGROUND_1},i.EDIT_COMMENT)),p.createElement("div",{className:"sendbird-message__bottomsheet--feedback-option",onClick:function(){t(),r()}},p.createElement(me,{type:he.BODY_1,color:re.ERROR},i.REMOVE_FEEDBACK))))}var Ll=function(n){var t=n.children;return p.createElement(me,{className:"sendbird-input-label",type:he.CAPTION_3,color:re.ONBACKGROUND_1},t)},_p=p.forwardRef(function(n,t){var e=n.name,r=n.required,i=n.disabled,a=n.value,s=n.placeHolder,u=n.autoFocus,o=u===void 0?!1:u,l=N.useState(a),d=l[0],c=l[1];return p.createElement("div",{className:"sendbird-input"},p.createElement("input",{className:"sendbird-input__input",ref:t,name:e,required:r,disabled:i,value:d,onChange:function(f){c(f.target.value)},autoFocus:o}),s&&!d&&p.createElement(me,{className:"sendbird-input__placeholder",type:he.BODY_1,color:re.ONBACKGROUND_3},s))});function mx(n){var t,e,r=n.selectedFeedback,i=n.message,a=n.onClose,s=n.onSubmit,u=n.onUpdate,o=n.onRemove,l=N.useContext(wt).stringSet,d=Nr().isMobile,c=(i==null?void 0:i.myFeedback)&&r===i.myFeedback.rating,f=(t=i==null?void 0:i.myFeedback)===null||t===void 0?void 0:t.comment,h=function(){var b,g,C;if(r){var S=(g=(b=_.current)===null||b===void 0?void 0:b.value)!==null&&g!==void 0?g:"";c?S!==((C=i.myFeedback)===null||C===void 0?void 0:C.comment)?u==null||u(r,S):a==null||a():i.myFeedback||s==null||s(r,S)}},m=N.useRef(),_=N.useRef(),E=Sm(m,{Enter:function(){return h()},Escape:function(){return a==null?void 0:a()}});return p.createElement("div",{onKeyDown:E},p.createElement(fi,{contentClassName:"sendbird-message-feedback-modal-content__mobile",type:kt.PRIMARY,onCancel:a,onSubmit:function(){h()},submitText:l.BUTTON__SUBMIT,renderHeader:function(){return p.createElement("div",{className:"sendbird-modal__header"},p.createElement(me,{type:he.H_1,color:re.ONBACKGROUND_1,className:"sendbird-message-feedback-modal-header"},l.FEEDBACK_MODAL_TITLE))},customFooter:p.createElement("div",{className:"sendbird-message-feedback-modal-footer__root"},!d&&(i!=null&&i.myFeedback)&&r===i.myFeedback.rating?p.createElement(Ri,{type:kt.WARNING,onClick:o,labelType:he.BUTTON_3},l.BUTTON__REMOVE_FEEDBACK):p.createElement("div",null),p.createElement("div",{className:"sendbird-message-feedback-modal-footer__right-content"},p.createElement(Ri,{type:kt.SECONDARY,onClick:a},p.createElement(me,{type:he.BUTTON_3,color:re.ONBACKGROUND_1},l.BUTTON__CANCEL)),p.createElement(Ri,{onClick:function(){return h()}},p.createElement(me,{type:he.BUTTON_3,color:re.ONCONTENT_1},f?l.BUTTON__SAVE:l.BUTTON__SUBMIT))))},p.createElement("div",{className:"sendbird-message-feedback-modal-body__root"},p.createElement(_p,{name:"sendbird-message-feedback-modal-body__root",ref:_,value:c?(e=i.myFeedback)===null||e===void 0?void 0:e.comment:void 0,placeHolder:l.FEEDBACK_CONTENT_PLACEHOLDER,autoFocus:!0}))))}function _x(n,t){var e=N.useState(!1),r=e[0],i=e[1];return N.useEffect(function(){var a=Array.isArray(t)?t:[t],s=function(){var d,c=a==null?void 0:a.map(function(f){return f==null?void 0:f.querySelector(n)});i((d=c==null?void 0:c.some(function(f){return!!f}))!==null&&d!==void 0?d:!1)};s();var u=function(d){d.forEach(function(c){(c.addedNodes.length||c.removedNodes.length)&&(Array.from(c.addedNodes).forEach(function(f){f.nodeType===Node.ELEMENT_NODE&&f.matches(n)&&i(!0)}),Array.from(c.removedNodes).forEach(function(f){f.nodeType===Node.ELEMENT_NODE&&f.matches(n)&&i(!1)}))})},o=new MutationObserver(u),l={childList:!0,subtree:!0};return a==null||a.forEach(function(d){d&&o.observe(d,l)}),function(){o.disconnect()}},[n,t]),r}var gp;(function(n){n.NOT_APPLICABLE="NOT_APPLICABLE",n.NO_FEEDBACK="NO_FEEDBACK",n.SUBMITTED="SUBMITTED"})(gp||(gp={}));function gx(n){var t,e,r,i=n.channel,a=n.message,s=n.showFileViewer,u=n.onMessageHeightChange,o=n.onBeforeDownloadFileMessage,l=n.renderSenderProfile,d=n.renderMessageHeader,c=n.renderMessageBody,f=n.isByMe,h=n.displayThreadReplies,m=n.mouseHover,_=n.isMobile,E=n.isReactionEnabledInChannel,b=n.hoveredMenuClassName,g=n.templateType,C=n.useReplying,S=Hn().config,A=$n().dateLocale,I=(t=hO[g])!==null&&t!==void 0?t:"",T=l(G(G({},n),{chainBottom:!1,className:"",isByMe:f,displayThreadReplies:h})),M=d(n),O=c({message:a,channel:i,showFileViewer:s,onMessageHeightChange:u,mouseHover:m,isMobile:_,config:S,isReactionEnabledInChannel:E,isByMe:f,onBeforeDownloadFileMessage:o}),R=p.createElement(me,{className:Fn("sendbird-message-content__middle__body-container__created-at","right",b,I),type:he.CAPTION_3,color:re.ONBACKGROUND_2},Xi((a==null?void 0:a.createdAt)||0,"p",{locale:A})),U=(e=a.extendedMessagePayload)===null||e===void 0?void 0:e[Qo],P=(r=U==null?void 0:U.container_options)!==null&&r!==void 0?r:{},L=P.profile,F=L===void 0?!0:L,B=P.time,V=B===void 0?!0:B,K=P.nickname,$=K===void 0?!0:K,q=F||$;return p.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__root"},!f&&q&&!C&&p.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__header-container"},p.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__header-container__left__profile"},F&&T),$&&M),O,!f&&V&&p.createElement("div",{className:"sendbird-message-content__sendbird-ui-container-type__default__bottom"},R))}function Ex(n){var t=this,e,r,i,a,s,u,o,l,d,c,f,h,m,_=n.className,E=n.userId,b=n.channel,g=n.message,C=n.disabled,S=C===void 0?!1:C,A=n.chainTop,I=A===void 0?!1:A,T=n.chainBottom,M=T===void 0?!1:T,O=n.isReactionEnabled,R=O===void 0?!1:O,U=n.disableQuoteMessage,P=U===void 0?!1:U,L=n.replyType,F=n.threadReplySelectType,B=n.nicknamesMap,V=n.emojiContainer,K=n.scrollToMessage,$=n.showEdit,q=n.showRemove,se=n.showFileViewer,Y=n.resendMessage,ce=n.deleteMessage,X=n.toggleReaction,Se=n.setQuoteMessage,te=n.onReplyInThread,be=n.onQuoteMessageClick,xe=n.onMessageHeightChange,Pe=n.onBeforeDownloadFileMessage,vn=n.filterEmojiCategoryIds,on=Zo(n),je=on.renderSenderProfile,Xe=je===void 0?function(Ve){return p.createElement(sx,G({},Ve))}:je,sn=on.renderMessageBody,un=sn===void 0?function(Ve){return p.createElement(fx,G({},Ve))}:sn,En=on.renderMessageHeader,rn=En===void 0?function(Ve){return p.createElement(hx,G({},Ve))}:En,qe=on.renderMessageMenu,Je=qe===void 0?function(Ve){return p.createElement(ek,G({},Ve))}:qe,ln=on.renderEmojiMenu,dn=ln===void 0?function(Ve){return p.createElement(rk,G({},Ve))}:ln,ve=on.renderEmojiReactions,De=ve===void 0?function(Ve){return p.createElement(mk,G({},Ve))}:ve,Ye=on.renderMobileMenuOnLongPress,en=Ye===void 0?function(Ve){return p.createElement(Sk,G({},Ve))}:Ye,fn=$n(),Fe=fn.dateLocale,Nn=fn.stringSet,nn=Hn(),_e=nn.config,zn=nn.eventHandlers,Rn=_e.logger,bn=(e=zn==null?void 0:zn.reaction)===null||e===void 0?void 0:e.onPressUserProfile,Ge=N.useRef(),cn=N.useRef(),On=N.useRef(),Ln=Nr().isMobile,In=N.useState(!1),et=In[0],Gn=In[1],Cn=N.useState(!1),mn=Cn[0],ze=Cn[1],ue=_x("#".concat(Jp(g.messageId),".").concat(Zp),[document.getElementById(wd),document.getElementById(em)]),Q=N.useState(!1),Te=Q[0],He=Q[1],$e=N.useState(!1),Ee=$e[0],fe=$e[1],We=N.useState(""),yn=We[0],Yn=We[1],Sn=E===((r=g==null?void 0:g.sender)===null||r===void 0?void 0:r.userId)||(g==null?void 0:g.sendingStatus)==="pending"||(g==null?void 0:g.sendingStatus)==="failed",rt=Sn?"outgoing":"incoming",Ct=I?"chain-top":"",pe=R&&!(b!=null&&b.isEphemeral),Le=pe?"use-reactions":"",ae=ue?"sendbird-mouse-hover":"",Qe=!!((L==="QUOTE_REPLY"||L==="THREAD")&&(g!=null&&g.parentMessageId)&&(g!=null&&g.parentMessage)&&!P),an=Qe?"use-quote":"",Tn=((i=g==null?void 0:g.threadInfo)===null||i===void 0?void 0:i.replyCount)&&g.threadInfo.replyCount>0&&L==="THREAD",xn=!Sn&&!!(g!=null&&g.myFeedbackStatus)&&g.myFeedbackStatus!==gp.NOT_APPLICABLE,it=!!(!((a=_e==null?void 0:_e.groupChannel)===null||a===void 0)&&a.enableFeedback)&&xn,lt=(s=g==null?void 0:g.myFeedback)===null||s===void 0?void 0:s.rating,Ie=!Md(g)&&!NC(g),j=Ie&&Ln,le=Ie&&Sn&&!Ln,ke=Ie&&Tn,Un=Ie&&!Sn&&!Ln,Kn=function(){var Ve=2;return cn.current&&(Ve+=4+cn.current.clientHeight),On.current&&(Ve+=4+On.current.clientHeight),Ve>0?Ve+"px":""},ut=function(){fe(!1)},dt=function(Ve){Ve===void 0&&(Ve=!1),Ln&&Ve?He(!0):fe(!0)},jt=Ou({onLongPress:function(){j&&Gn(!0)},onClick:ot},{delay:300,shouldPreventDefault:!1});if(SC(g))return p.createElement(_k,{message:g});if(Md(g)){var Ht=g.extendedMessagePayload[Qo];if(IC(Ht))return p.createElement(gx,G({},n,{renderSenderProfile:Xe,renderMessageHeader:rn,renderMessageBody:un,isByMe:Sn,displayThreadReplies:Tn,mouseHover:mn,isMobile:Ln,isReactionEnabledInChannel:pe,hoveredMenuClassName:ae,templateType:Ht.type,useReplying:Qe}))}return p.createElement("div",{className:Br([_??"","sendbird-message-content",rt]),onMouseOver:function(){return ze(!0)},onMouseLeave:function(){return ze(!1)}},p.createElement("div",{className:Fn("sendbird-message-content__left",Le,rt,an),"data-testid":"sendbird-message-content__left"},Xe(G(G({},n),{className:"sendbird-message-content__left__avatar",isByMe:Sn,displayThreadReplies:Tn,bottom:Kn()})),le&&p.createElement("div",{className:Fn("sendbird-message-content-menu",Le,ae,rt)},Je({channel:b,message:g,isByMe:Sn,replyType:L,showEdit:$,showRemove:q,resendMessage:Y,setQuoteMessage:Se,onReplyInThread:function(Ve){var kn,Pn,Dn=Ve.message;F===Ii.THREAD?te==null||te({message:Dn}):F===Ii.PARENT&&(K==null||K((Pn=(kn=Dn.parentMessage)===null||kn===void 0?void 0:kn.createdAt)!==null&&Pn!==void 0?Pn:0,Dn.parentMessageId))},deleteMessage:ce}),pe&&dn({message:g,userId:E,emojiContainer:V,toggleReaction:X,filterEmojiCategoryIds:vn}))),p.createElement("div",G({className:Fn("sendbird-message-content__middle"),"data-testid":"sendbird-message-content__middle"},Ln?G({},jt):{},{ref:Ge}),!Sn&&!I&&!Qe&&rn(n),Qe?p.createElement("div",{className:Fn("sendbird-message-content__middle__quote-message",Sn?"outgoing":"incoming",an),"data-testid":"sendbird-message-content__middle__quote-message"},p.createElement(Ek,{className:"sendbird-message-content__middle__quote-message__quote",message:g,userId:E,isByMe:Sn,isUnavailable:((u=b==null?void 0:b.messageOffsetTimestamp)!==null&&u!==void 0?u:0)>((l=(o=g.parentMessage)===null||o===void 0?void 0:o.createdAt)!==null&&l!==void 0?l:0),onClick:function(){var Ve;L==="THREAD"&&F===Ii.THREAD&&(be==null||be({message:g})),(L==="QUOTE_REPLY"||L==="THREAD"&&F===Ii.PARENT)&&(!((Ve=g==null?void 0:g.parentMessage)===null||Ve===void 0)&&Ve.createdAt)&&(g!=null&&g.parentMessageId)&&(K==null||K(g.parentMessage.createdAt,g.parentMessageId))}})):null,p.createElement("div",{className:Fn("sendbird-message-content__middle__body-container")},Sn&&!M&&p.createElement("div",{className:Fn("sendbird-message-content__middle__body-container__created-at","left",ae)},p.createElement("div",{className:"sendbird-message-content__middle__body-container__created-at__component-container"},p.createElement($0,{message:g,channel:b}))),un({message:g,channel:b,showFileViewer:se,onMessageHeightChange:xe,mouseHover:mn,isMobile:Ln,config:_e,isReactionEnabledInChannel:pe,isByMe:Sn,onBeforeDownloadFileMessage:Pe}),pe&&((d=g==null?void 0:g.reactions)===null||d===void 0?void 0:d.length)>0&&p.createElement("div",{className:Fn("sendbird-message-content-reactions",kr(g)?"image-grid":Sn&&!ts(g)&&!qp(g)&&"primary",mn&&"mouse-hover")},De({userId:E,message:g,channel:b,isByMe:Sn,emojiContainer:V??new Yb({}),memberNicknamesMap:B??new Map,toggleReaction:X,onPressUserProfile:bn,filterEmojiCategoryIds:vn})),!Sn&&!M&&p.createElement(me,{className:Fn("sendbird-message-content__middle__body-container__created-at","right",ae),type:he.CAPTION_3,color:re.ONBACKGROUND_2},Xi((g==null?void 0:g.createdAt)||0,Nn.DATE_FORMAT__MESSAGE_CREATED_AT,{locale:Fe}))),ke&&(g==null?void 0:g.threadInfo)&&p.createElement(Nk,{className:"sendbird-message-content__middle__thread-replies",threadInfo:g==null?void 0:g.threadInfo,onClick:function(){return te==null?void 0:te({message:g})},ref:cn}),it&&p.createElement("div",{className:"sendbird-message-content__middle__body-container__feedback-buttons-container",ref:On},p.createElement(ty,{isSelected:((c=g==null?void 0:g.myFeedback)===null||c===void 0?void 0:c.rating)===ka.GOOD,onClick:function(){return Nt(t,void 0,void 0,function(){var Ve,kn,Pn;return It(this,function(Dn){switch(Dn.label){case 0:if(lt)return[3,5];Dn.label=1;case 1:return Dn.trys.push([1,3,,4]),[4,g.submitFeedback({rating:ka.GOOD})];case 2:return Dn.sent(),dt(),[3,4];case 3:return Ve=Dn.sent(),(Pn=(kn=_e==null?void 0:_e.logger)===null||kn===void 0?void 0:kn.error)===null||Pn===void 0||Pn.call(kn,"Channel: Submit feedback failed.",Ve),Yn(Nn.FEEDBACK_FAILED_SUBMIT),[3,4];case 4:return[3,6];case 5:dt(!0),Dn.label=6;case 6:return[2]}})})},disabled:!!(g!=null&&g.myFeedback)&&g.myFeedback.rating!==ka.GOOD},p.createElement(Ue,{type:ye.FEEDBACK_LIKE,width:"24px",height:"24px"})),p.createElement(ty,{isSelected:((f=g==null?void 0:g.myFeedback)===null||f===void 0?void 0:f.rating)===ka.BAD,onClick:function(){return Nt(t,void 0,void 0,function(){var Ve,kn,Pn;return It(this,function(Dn){switch(Dn.label){case 0:if(lt)return[3,5];Dn.label=1;case 1:return Dn.trys.push([1,3,,4]),[4,g.submitFeedback({rating:ka.BAD})];case 2:return Dn.sent(),dt(),[3,4];case 3:return Ve=Dn.sent(),(Pn=(kn=_e==null?void 0:_e.logger)===null||kn===void 0?void 0:kn.error)===null||Pn===void 0||Pn.call(kn,"Channel: Submit feedback failed.",Ve),Yn(Nn.FEEDBACK_FAILED_SUBMIT),[3,4];case 4:return[3,6];case 5:dt(!0),Dn.label=6;case 6:return[2]}})})},disabled:!!(g!=null&&g.myFeedback)&&g.myFeedback.rating!==ka.BAD},p.createElement(Ue,{type:ye.FEEDBACK_DISLIKE,width:"24px",height:"24px"})))),Un&&p.createElement("div",{className:Fn("sendbird-message-content__right",Ct,Le,an),"data-testid":"sendbird-message-content__right"},p.createElement("div",{className:Fn("sendbird-message-content-menu",Ct,ae,rt)},pe&&dn({className:"sendbird-message-content-menu__reaction-menu",message:g,userId:E,emojiContainer:V,toggleReaction:X,filterEmojiCategoryIds:vn}),Je({className:"sendbird-message-content-menu__normal-menu",channel:b,message:g,isByMe:Sn,replyType:L,showRemove:q,resendMessage:Y,setQuoteMessage:Se,onReplyInThread:function(Ve){var kn,Pn,Dn=Ve.message;F===Ii.THREAD?te==null||te({message:Dn}):F===Ii.PARENT&&(K==null||K((Pn=(kn=Dn.parentMessage)===null||kn===void 0?void 0:kn.createdAt)!==null&&Pn!==void 0?Pn:0,Dn.parentMessageId))},deleteMessage:ce}))),et&&Xo(g)&&b&&en({parentRef:Ge,channel:b,hideMenu:function(){Gn(!1)},message:g,isReactionEnabled:pe,isByMe:Sn,userId:E,replyType:L,disabled:S,showRemove:q,emojiContainer:V,resendMessage:Y,deleteMessage:ce,setQuoteMessage:Se,toggleReaction:X,showEdit:$,onReplyInThread:function(Ve){var kn,Pn=Ve.message;F===Ii.THREAD?te==null||te({message:Pn}):F===Ii.PARENT&&(K==null||K(((kn=Pn==null?void 0:Pn.parentMessage)===null||kn===void 0?void 0:kn.createdAt)||0,(Pn==null?void 0:Pn.parentMessageId)||0))},onDownloadClick:function(Ve){return Nt(t,void 0,void 0,function(){var kn,Pn,Dn,$r;return It(this,function(br){switch(br.label){case 0:if(!Pe)return[2];br.label=1;case 1:return br.trys.push([1,3,,4]),[4,Pe({message:g})];case 2:return kn=br.sent(),kn||(Ve.preventDefault(),(Dn=Rn==null?void 0:Rn.info)===null||Dn===void 0||Dn.call(Rn,"MessageContent: Not allowed to download.")),[3,4];case 3:return Pn=br.sent(),($r=Rn==null?void 0:Rn.error)===null||$r===void 0||$r.call(Rn,"MessageContent: Error occurred while determining download continuation:",Pn),[3,4];case 4:return[2]}})})}}),((h=g==null?void 0:g.myFeedback)===null||h===void 0?void 0:h.rating)&&Te&&p.createElement(px,{hideMenu:function(){He(!1)},onEditFeedback:function(){He(!1),fe(!0)},onRemoveFeedback:function(){return Nt(t,void 0,void 0,function(){var Ve,kn,Pn;return It(this,function(Dn){switch(Dn.label){case 0:return Dn.trys.push([0,3,,4]),g.myFeedback===null?[3,2]:[4,g.deleteFeedback(g.myFeedback.id)];case 1:Dn.sent(),Dn.label=2;case 2:return[3,4];case 3:return Ve=Dn.sent(),(Pn=(kn=_e==null?void 0:_e.logger)===null||kn===void 0?void 0:kn.error)===null||Pn===void 0||Pn.call(kn,"Channel: Delete feedback failed.",Ve),Yn(Nn.FEEDBACK_FAILED_DELETE),[3,4];case 4:return He(!1),[2]}})})}}),((m=g==null?void 0:g.myFeedback)===null||m===void 0?void 0:m.rating)&&Ee&&p.createElement(mx,{selectedFeedback:g.myFeedback.rating,message:g,onUpdate:function(Ve,kn){return Nt(t,void 0,void 0,function(){var Pn,Dn,$r,br;return It(this,function(hi){switch(hi.label){case 0:if(g.myFeedback===null)return[3,4];Pn=new ma({id:g.myFeedback.id,rating:Ve,comment:kn}),hi.label=1;case 1:return hi.trys.push([1,3,,4]),[4,g.updateFeedback(Pn)];case 2:return hi.sent(),[3,4];case 3:return Dn=hi.sent(),(br=($r=_e==null?void 0:_e.logger)===null||$r===void 0?void 0:$r.error)===null||br===void 0||br.call($r,"Channel: Update feedback failed.",Dn),Yn(Nn.FEEDBACK_FAILED_SAVE),[3,4];case 4:return ut(),[2]}})})},onClose:ut,onRemove:function(){return Nt(t,void 0,void 0,function(){var Ve,kn,Pn;return It(this,function(Dn){switch(Dn.label){case 0:return Dn.trys.push([0,3,,4]),g.myFeedback===null?[3,2]:[4,g.deleteFeedback(g.myFeedback.id)];case 1:Dn.sent(),Dn.label=2;case 2:return[3,4];case 3:return Ve=Dn.sent(),(Pn=(kn=_e==null?void 0:_e.logger)===null||kn===void 0?void 0:kn.error)===null||Pn===void 0||Pn.call(kn,"Channel: Delete feedback failed.",Ve),Yn(Nn.FEEDBACK_FAILED_DELETE),[3,4];case 4:return ut(),[2]}})})}}),yn&&p.createElement(gS,{text:yn,onCancel:function(){Yn("")}}))}var vx=function(n){var t=n.value,e=n.onClickReply,r=n.type,i=r===void 0?"vertical":r;return p.createElement("div",{className:"sendbird-suggested-replies__option ".concat(i),id:t,onClick:function(a){return e(a,t)}},t)},yx=function(n){var t=n.replyOptions,e=n.onSendMessage,r=n.type,i=r===void 0?"vertical":r,a=N.useState(!1),s=a[0],u=a[1],o=function(d,c){d.preventDefault(),e({message:c}),u(!0)};if(s)return null;var l=t.map(function(d,c){return p.createElement(vx,{key:c,value:d,onClickReply:o,type:i})});return p.createElement("div",{className:"sendbird-suggested-replies ".concat(i)},l)};function bx(n){var t=n.member,e=n.isFocused,r=e===void 0?!1:e,i=n.parentScrollRef,a=n.onClick,s=n.onMouseOver,u=n.onMouseMove,o=n.renderUserMentionItem,l=N.useRef(null),d=N.useContext(wt).stringSet;N.useEffect(function(){r&&(i==null?void 0:i.current)!=null&&(l==null?void 0:l.current)!=null&&(i.current.scrollTop>=l.current.offsetTop||i.current.scrollTop+i.current.clientHeight<=l.current.offsetTop)&&l.current.scrollIntoView({block:"nearest",inline:"nearest"})},[r]);var c=N.useMemo(function(){if(o)return p.createElement("div",{className:"sendbird-mention-suggest-list__user-item",onClick:function(f){return a==null?void 0:a({event:f,member:t,itemRef:l})},onMouseOver:function(f){return s==null?void 0:s({event:f,member:t,itemRef:l})},onMouseMove:function(f){return u==null?void 0:u({event:f,member:t,itemRef:l})},key:(t==null?void 0:t.userId)||vi(),ref:l},o({user:t}))},[o]);return c||p.createElement("div",{className:Fn("sendbird-mention-suggest-list__user-item",r&&"focused"),onClick:function(f){return a==null?void 0:a({event:f,member:t,itemRef:l})},onMouseOver:function(f){return s==null?void 0:s({event:f,member:t,itemRef:l})},onMouseMove:function(f){return u==null?void 0:u({event:f,member:t,itemRef:l})},key:(t==null?void 0:t.userId)||vi(),ref:l},p.createElement(zr,{className:"sendbird-mention-suggest-list__user-item__avatar",src:t==null?void 0:t.profileUrl,alt:"user-profile",width:"24px",height:"24px"}),p.createElement(me,{className:"sendbird-mention-suggest-list__user-item__nickname",testID:"sendbird-mention-suggest-list__user-item__nickname",type:he.SUBTITLE_2,color:t!=null&&t.nickname?re.ONBACKGROUND_1:re.ONBACKGROUND_3},(t==null?void 0:t.nickname)||(d==null?void 0:d.MENTION_NAME__NO_NAME)),p.createElement(me,{className:"sendbird-mention-suggest-list__user-item__user-id",testID:"sendbird-mention-suggest-list__user-item__user-id",type:he.SUBTITLE_2,color:re.ONBACKGROUND_2},t==null?void 0:t.userId))}function Cx(n,t,e,r){return Nt(this,void 0,void 0,function(){return It(this,function(i){return[2,t.members.sort(function(a,s){var u;return(u=a.nickname)===null||u===void 0?void 0:u.localeCompare(s.nickname)}).filter(function(a){var s;return((s=a.nickname)===null||s===void 0?void 0:s.toLowerCase().startsWith(r.toLowerCase()))&&a.userId!==n&&a.isActive}).slice(0,e)]})})}function Sx(n,t,e,r){return Nt(this,void 0,void 0,function(){var i;return It(this,function(a){return i=t.createMemberListQuery({limit:e+1,nicknameStartsWithFilter:r}),[2,i.next().then(function(s){return s.filter(function(u){return n!==(u==null?void 0:u.userId)}).slice(0,e)})]})})}var Tx=300,ES=function(n){var t,e,r,i=n.className,a=n.currentChannel,s=n.targetNickname,u=s===void 0?"":s,o=n.onUserItemClick,l=n.onFocusItemChange,d=n.onFetchUsers,c=n.renderUserMentionItem,f=n.inputEvent,h=n.ableAddMention,m=h===void 0?!0:h,_=n.maxMentionCount,E=_===void 0?c0:_,b=n.maxSuggestionCount,g=b===void 0?f0:b,C=Hn(),S=C.config,A=C.stores,I=S.logger,T=((r=(e=(t=A==null?void 0:A.sdkStore)===null||t===void 0?void 0:t.sdk)===null||e===void 0?void 0:e.currentUser)===null||r===void 0?void 0:r.userId)||"",M=N.useRef(null),O=$n().stringSet,R=N.useState(null),U=R[0],P=R[1],L=N.useState(""),F=L[0],B=L[1],V=N.useState(""),K=V[0],$=V[1],q=N.useState(null),se=q[0],Y=q[1],ce=N.useState([]),X=ce[0],Se=ce[1];return N.useEffect(function(){clearTimeout(U??void 0),P(setTimeout(function(){B(u)},Tx))},[u]),N.useEffect(function(){if((f==null?void 0:f.key)===Di.Enter&&se&&X.length>0&&(o==null||o(se)),(f==null?void 0:f.key)===Di.ArrowUp){var te=X.findIndex(function(be){return(be==null?void 0:be.userId)===(se==null?void 0:se.userId)});0<te&&(Y(X[te-1]),l==null||l(X[te-1]))}if((f==null?void 0:f.key)===Di.ArrowDown){var te=X.findIndex(function(xe){return(xe==null?void 0:xe.userId)===(se==null?void 0:se.userId)});te<X.length-1&&(Y(X[te+1]),l==null||l(X[te+1]))}},[f]),N.useEffect(function(){if(!(K&&F.indexOf(K)===0&&X.length===0)){if(a!=null&&a.isSuper&&!(a!=null&&a.createMemberListQuery)){I.warning("SuggestedMentionList: Creating member list query failed");return}var te=a!=null&&a.isSuper?Sx:Cx;te(T,a,g,F.slice(Mo.length)).then(function(be){be.length<1?I.info("SuggestedMentionList: Fetched member list is empty"):(I.info("SuggestedMentionList: Fetching member list succeeded",{memberList:be}),Y(be[0])),$(F),d==null||d(be),Se(be)}).catch(function(be){be&&I.error("SuggestedMentionList: Fetching member list failed",be)})}},[a==null?void 0:a.url,a==null?void 0:a.members.map(function(te){return te.nickname}).join(),a==null?void 0:a.members.map(function(te){return te.isActive}).join(),F,g,T,X.length,K]),!m&&X.length===0?null:p.createElement("div",{className:Fn("sendbird-mention-suggest-list",i),"data-testid":"sendbird-mention-suggest-list",key:"sendbird-mention-suggest-list",ref:M},m&&(X==null?void 0:X.map(function(te){return p.createElement(bx,{key:(te==null?void 0:te.userId)||vi(),member:te,isFocused:(te==null?void 0:te.userId)===(se==null?void 0:se.userId),parentScrollRef:M,onClick:function(be){var xe=be.member;o==null||o(xe)},onMouseOver:function(be){var xe=be.member;Y(xe)},renderUserMentionItem:c})})),!m&&p.createElement("div",{className:"sendbird-mention-suggest-list__notice-item"},p.createElement(Ue,{className:"sendbird-mention-suggest-list__notice-item__icon",type:ye.INFO,fillColor:Me.ON_BACKGROUND_2,width:"20px",height:"20px"}),p.createElement(me,{className:"sendbird-mention-suggest-list__notice-item__text",type:he.SUBTITLE_2,color:re.ONBACKGROUND_2},O.MENTION_COUNT__OVER_LIMIT.replace("%d",String(E)))))},ry=function(n,t){var e=N.useState(!1),r=e[0],i=e[1];N.useEffect(function(){r?n():i(!0)},t)},Nx=function(n){var t,e,r=n.message,i=n.children,a=n.hasSeparator,s=n.chainTop,u=n.chainBottom,o=n.handleScroll,l=n.channel,d=n.emojiContainer,c=n.editInputDisabled,f=n.shouldRenderSuggestedReplies,h=n.isReactionEnabled,m=n.replyType,_=n.threadReplySelectType,E=n.nicknamesMap,b=n.scrollToMessage,g=n.toggleReaction,C=n.setQuoteMessage,S=n.onQuoteMessageClick,A=n.onReplyInThreadClick,I=n.onBeforeDownloadFileMessage,T=n.sendUserMessage,M=n.updateUserMessage,O=n.resendMessage,R=n.deleteMessage,U=n.setAnimatedMessageId,P=n.animatedMessageId,L=n.onMessageAnimated,F=n.usedInLegacy,B=F===void 0?!0:F,V=Zo(n),K=V.renderUserMentionItem,$=V.renderMessage,q=V.renderMessageContent,se=q===void 0?function(ae){return p.createElement(Ex,G({},ae))}:q,Y=V.renderSuggestedReplies,ce=Y===void 0?function(ae){return p.createElement(yx,G({},ae))}:Y,X=V.renderCustomSeparator,Se=V.renderEditInput,te=V.renderFileViewer,be=V.renderRemoveMessageModal,xe=V.filterEmojiCategoryIds,Pe=$n(),vn=Pe.dateLocale,on=Pe.stringSet,je=Hn(),Xe=je.config,sn=Xe.userId,un=Xe.isOnline,En=Xe.userMention,rn=Xe.logger,qe=Xe.groupChannel,Je=(En==null?void 0:En.maxMentionCount)||c0,ln=(En==null?void 0:En.maxSuggestionCount)||f0,dn=N.useState(!1),ve=dn[0],De=dn[1],Ye=N.useState(!1),en=Ye[0],fn=Ye[1],Fe=N.useState(!1),Nn=Fe[0],nn=Fe[1],_e=N.useState(!1),zn=_e[0],Rn=_e[1],bn=N.useState(""),Ge=bn[0],cn=bn[1],On=N.useState([]),Ln=On[0],In=On[1],et=N.useState([]),Gn=et[0],Cn=et[1],mn=N.useState(null),ze=mn[0],ue=mn[1],Q=N.useState(null),Te=Q[0],He=Q[1],$e=N.useState([]),Ee=$e[0],fe=$e[1],We=N.useRef(null),yn=N.useRef(null),Yn=un&&qe.enableMention&&Ge.length>0&&!Ud(l)&&!Bo(l),Sn=O0({ref:We},{logger:rn}),rt=(Sn==null?void 0:Sn.length)<Je;N.useEffect(function(){In(Ln.filter(function(ae){var Qe=ae.userId,an=Gn.indexOf(Qe);return an<0?!1:(Gn.splice(an,1),!0)}))},[Gn]),ry(function(){o==null||o()},[ve,(t=r==null?void 0:r.reactions)===null||t===void 0?void 0:t.length]),ry(function(){o==null||o(!0)},[r==null?void 0:r.updatedAt,r==null?void 0:r.message]);var Ct=N.useRef(f);N.useEffect(function(){Ct.current!==f?o==null||o():Ct.current=f},[f]),N.useLayoutEffect(function(){B&&(o==null||o(!0))},[]),N.useLayoutEffect(function(){var ae=[];return P===r.messageId&&(yn!=null&&yn.current)?(ae.push(setTimeout(function(){Rn(!0)},500)),ae.push(setTimeout(function(){U(null),L==null||L()},1600))):Rn(!1),function(){ae.forEach(function(Qe){return clearTimeout(Qe)})}},[P,yn.current,r.messageId]);var pe=N.useMemo(function(){var ae;return(ae=X==null?void 0:X({message:r}))!==null&&ae!==void 0?ae:null},[r,X]),Le=function(){if(i)return i;if($){var ae=G(G({},n),{renderMessage:void 0});return $(ae)}return p.createElement(p.Fragment,null,se({className:"sendbird-message-hoc__message-content",userId:sn,scrollToMessage:b,channel:l,message:r,disabled:!un,chainTop:s,chainBottom:u,isReactionEnabled:h,replyType:m,threadReplySelectType:_,nicknamesMap:E,emojiContainer:d,showEdit:De,showRemove:fn,showFileViewer:nn,resendMessage:O,deleteMessage:R,toggleReaction:g,setQuoteMessage:C,onReplyInThread:A,onQuoteMessageClick:S,onMessageHeightChange:o,onBeforeDownloadFileMessage:I,filterEmojiCategoryIds:xe}),f&&ce({replyOptions:DC(r),onSendMessage:T,type:qe==null?void 0:qe.suggestedRepliesDirection}),en&&(be==null?void 0:be({message:r,onCancel:function(){return fn(!1)}})),Nn&&te({message:r,onCancel:function(){return nn(!1)}}))};return ve&&(!((e=r==null?void 0:r.isUserMessage)===null||e===void 0)&&e.call(r))?(Se==null?void 0:Se())||p.createElement(p.Fragment,null,Yn&&p.createElement(ES,{currentChannel:l,targetNickname:Ge,inputEvent:ze??void 0,renderUserMentionItem:K,onUserItemClick:function(ae){ae&&In(Ce(Ce([],Ln,!0),[ae],!1)),cn(""),He(ae),ue(null)},onFocusItemChange:function(){ue(null)},onFetchUsers:function(ae){fe(ae)},ableAddMention:rt,maxMentionCount:Je,maxSuggestionCount:ln}),p.createElement(z0,{isEdit:!0,channel:l,disabled:c,ref:We,mentionSelectedUser:Te,isMentionEnabled:qe.enableMention,message:r,onStartTyping:function(){var ae;(ae=l==null?void 0:l.startTyping)===null||ae===void 0||ae.call(l)},onUpdateMessage:function(ae){var Qe,an=ae.messageId,Tn=ae.message,xn=ae.mentionTemplate;M(an,{message:Tn,mentionedUsers:Ln,mentionedMessageTemplate:xn}),De(!1),(Qe=l==null?void 0:l.endTyping)===null||Qe===void 0||Qe.call(l)},onCancelEdit:function(){var ae;cn(""),In([]),Cn([]),fe([]),De(!1),(ae=l==null?void 0:l.endTyping)===null||ae===void 0||ae.call(l)},onUserMentioned:function(ae){(Te==null?void 0:Te.userId)===(ae==null?void 0:ae.userId)&&(He(null),cn(""))},onMentionStringChange:function(ae){cn(ae)},onMentionedUserIdsUpdated:function(ae){Cn(ae)},onKeyDown:function(ae){return Yn&&(Ee==null?void 0:Ee.length)>0&&(ae.key===Di.Enter&&rt||ae.key===Di.ArrowUp||ae.key===Di.ArrowDown)?(ue(ae),!0):!1}})):p.createElement("div",{className:Fn("sendbird-msg-hoc sendbird-msg--scroll-ref",zn&&"sendbird-msg-hoc__animated"),"data-testid":"sendbird-message-view",style:i||$?void 0:{marginBottom:"2px"},"data-sb-message-id":r.messageId,"data-sb-created-at":r.createdAt,ref:yn},a&&(pe||p.createElement(WL,null,p.createElement(me,{type:he.CAPTION_2,color:re.ONBACKGROUND_2},Xi(r.createdAt,on.DATE_FORMAT__MESSAGE_LIST__DATE_SEPARATOR,{locale:vn})))),Le())},Ix=function(n){var t=n.message,e=n.onCancel,r=n.deleteMessage,i=n.onDownloadClick,a=t.sender,s=t.type,u=t.url,o=t.name,l=o===void 0?"":o,d=t.threadInfo,c=a.profileUrl,f=a.nickname,h=a.userId,m=Hn().config;return Nu.createPortal(p.createElement(Ax,{profileUrl:c,nickname:f,type:s,url:u,name:l,onCancel:e,onDelete:function(){return r(t).then(function(){return e()})},isByMe:m.userId===h,disableDelete:d!=null&&d.replyCount?d.replyCount>0:!1,onDownloadClick:i}),document.getElementById(Hs))},Ax=function(n){var t=n.profileUrl,e=n.nickname,r=n.name,i=n.type,a=n.url,s=n.isByMe,u=n.onCancel,o=n.onDelete,l=n.disableDelete,d=n.onDownloadClick;return p.createElement(fi,{onClose:u},p.createElement("div",{className:"sendbird-fileviewer","data-testid":"sendbird-fileviewer"},p.createElement("div",{className:"sendbird-fileviewer__header"},p.createElement("div",{className:"sendbird-fileviewer__header__left"},p.createElement("div",{className:"sendbird-fileviewer__header__left__avatar"},p.createElement(zr,{height:"32px",width:"32px",src:t})),p.createElement("div",{className:"sendbird-fileviewer__header__left__text-container"},p.createElement(me,{className:"sendbird-fileviewer__header__left__filename",type:he.H_2,color:re.ONBACKGROUND_1},r),p.createElement(me,{className:"sendbird-fileviewer__header__left__sender-name",type:he.BODY_1,color:re.ONBACKGROUND_2},e))),p.createElement("div",{className:"sendbird-fileviewer__header__right"},Po(i)&&p.createElement("div",{className:"sendbird-fileviewer__header__right__actions"},p.createElement("a",{className:"sendbird-fileviewer__header__right__actions__download",rel:"noopener noreferrer",href:a,target:"_blank",onClick:d},p.createElement(Ue,{type:ye.DOWNLOAD,fillColor:Me.ON_BACKGROUND_1,height:"24px",width:"24px"})),o&&s&&p.createElement("div",{className:"sendbird-fileviewer__header__right__actions__delete"},p.createElement(Ue,{className:l?"disabled":"",type:ye.DELETE,fillColor:l?Me.GRAY:Me.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:function(){l||o()}}))),p.createElement("div",{className:"sendbird-fileviewer__header__right__actions__close"},p.createElement(Ue,{type:ye.CLOSE,fillColor:Me.ON_BACKGROUND_1,height:"24px",width:"24px",onClick:u})))),p.createElement("div",{className:"sendbird-fileviewer__content"},es(i)&&p.createElement("video",{controls:!0,className:"sendbird-fileviewer__content__video"},p.createElement("source",{src:a,type:i})),Ia(i)&&p.createElement("img",{src:a,alt:r,className:"sendbird-fileviewer__content__img"}),!Po(i)&&p.createElement("div",{className:"sendbird-fileviewer__content__unsupported"},p.createElement(me,{type:he.H_1,color:re.ONBACKGROUND_1},$s.UI__FILE_VIEWER__UNSUPPORT)))))},Mx=function(n){var t=rs().deleteMessage;return p.createElement(Ix,G({},n,{deleteMessage:t}))};function wx(n,t){return cr(t).when(kr,function(){var e=t.fileInfoList.length;return"Do you want to delete all ".concat(e," photos?")}).otherwise(function(){return n.MODAL__DELETE_MESSAGE__TITLE})}var Ox=function(n){var t,e=n.onSubmit,r=e===void 0?function(){}:e,i=n.onCancel,a=n.message,s=n.deleteMessage,u=N.useContext(wt).stringSet;return p.createElement(fi,{type:kt.DANGER,disabled:!((t=a==null?void 0:a.threadInfo)===null||t===void 0)&&t.replyCount?a.threadInfo.replyCount>0:void 0,onCancel:i,onSubmit:function(){(a.isUserMessage()||a.isFileMessage()||a.isMultipleFilesMessage())&&s(a).then(function(){r(),i()})},submitText:u.MESSAGE_MENU__DELETE,titleText:wx(u,a)})},Rx=function(n){var t=rs().deleteMessage;return p.createElement(Ox,G({},n,{deleteMessage:t}))},iy=function(n){var t,e,r=Hn().config,i=rs(),a=i.initialized,s=i.currentGroupChannel,u=i.animatedMessageId,o=i.setAnimatedMessageId,l=i.updateMessage,d=i.scrollToMessage,c=i.replyType,f=i.threadReplySelectType,h=i.isReactionEnabled,m=i.toggleReaction,_=i.emojiContainer,E=i.nicknamesMap,b=i.setQuoteMessage,g=i.resendMessage,C=i.deleteMessage,S=i.renderUserMentionItem,A=i.onReplyInThread,I=i.onQuoteMessageClick,T=i.onMessageAnimated,M=i.sendMessage,O=i.localMessages,R=i.allMessages,U=n.message;return s?p.createElement(Nx,G({},n,{channel:s,emojiContainer:_,editInputDisabled:!a||ND(s)||ID(s)||!r.isOnline,shouldRenderSuggestedReplies:((t=r==null?void 0:r.groupChannel)===null||t===void 0?void 0:t.enableSuggestedReplies)&&(((e=r==null?void 0:r.groupChannel)===null||e===void 0?void 0:e.showSuggestedRepliesFor)==="all_messages"?!0:U.messageId===R[R.length-1].messageId)&&(O==null?void 0:O.length)===0&&DC(U).length>0,isReactionEnabled:h,replyType:c,threadReplySelectType:f,nicknamesMap:E,renderUserMentionItem:S,scrollToMessage:d,toggleReaction:m,setQuoteMessage:b,onQuoteMessageClick:I,onReplyInThreadClick:A,sendUserMessage:function(P){M({message:P.message,mentionedUsers:P.mentionedUsers,mentionTemplate:P.mentionedMessageTemplate})},updateUserMessage:function(P,L){var F;l({messageId:P,message:(F=L.message)!==null&&F!==void 0?F:"",mentionedUsers:L.mentionedUsers,mentionTemplate:L.mentionedMessageTemplate})},resendMessage:g,deleteMessage:C,animatedMessageId:u,setAnimatedMessageId:o,onMessageAnimated:T,renderFileViewer:function(P){return p.createElement(Mx,G({},P))},renderRemoveMessageModal:function(P){return p.createElement(Rx,G({},P))}})):null},Dx=function(n){var t=n.className,e=t===void 0?"":t,r=n.count,i=r===void 0?0:r,a=n.time,s=a===void 0?"":a,u=n.onClick,o=n.lastReadAt,l=N.useContext(wt),d=l.stringSet,c=l.dateLocale,f=N.useMemo(function(){var h,m;if(d.CHANNEL__MESSAGE_LIST__NOTIFICATION__ON!=="on"){var _=((m=(h=s==null?void 0:s.toString)===null||h===void 0?void 0:h.call(s))===null||m===void 0?void 0:m.split(" "))||[];return _==null||_.splice(-2,0,d.CHANNEL__MESSAGE_LIST__NOTIFICATION__ON),_.join(" ")}else if(o)return Xi(o,d.DATE_FORMAT__MESSAGE_LIST__NOTIFICATION__UNREAD_SINCE,{locale:c})},[s,o]);return p.createElement("div",{className:Fn(i<1?"sendbird-notification--hide":"sendbird-notification",e),"data-testid":"sendbird-notification",onClick:u},p.createElement(me,{className:"sendbird-notification__text",testID:"sendbird-notification__text",color:re.ONCONTENT_1,type:he.CAPTION_2},"".concat(i," "),d.CHANNEL__MESSAGE_LIST__NOTIFICATION__NEW_MESSAGE," ".concat(f)),p.createElement(Ue,{width:"24px",height:"24px",type:ye.CHEVRON_DOWN,fillColor:Me.CONTENT}))},Lx=function(n){var t=n.className,e=t===void 0?"":t,r=N.useContext(wt).stringSet;return p.createElement("div",{className:Fn("sendbird-notification","sendbird-notification--frozen",e),"data-testid":"sendbird-notification"},p.createElement(me,{className:"sendbird-notification__text",testID:"sendbird-notification__text",type:he.CAPTION_2},r.CHANNEL_FROZEN))};function Tm(n,t,e){e===void 0&&(e={leading:!0,trailing:!1});var r=N.useRef(null),i=N.useRef(null);return N.useEffect(function(){return function(){r.current&&clearTimeout(r.current)}},[]),Yo(function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(r.current){i.current=a;return}e.leading?n.apply(void 0,a):i.current=a;var u=function(){e.trailing&&i.current?(n.apply(void 0,i.current),i.current=null,r.current=setTimeout(u,t)):r.current=null};r.current=setTimeout(u,t)})}var Ux=100;function kx(n,t){return n-t}function xx(n){var t=n.hasMore,e=n.hasNext,r=n.onScroll,i=n.scrollRef,a=n.setShowScrollDownButton,s=Yo(function(){var u=i==null?void 0:i.current;if(u!=null){var o=u.scrollTop,l=u.scrollHeight,d=u.clientHeight,c=kx(l,o);typeof a=="function"&&a(l>o+d+1),t&&Ds(o,0,Ba)&&r(function(){var f=u.scrollHeight>l;f&&(u.scrollTop=u.scrollHeight-c)}),e&&Ds(d+o,l,Ba)&&r(function(){var f=u.scrollHeight>l;f&&(u.scrollTop=o)})}});return Tm(s,Ux,{trailing:!0})}var Px=function(){return p.createElement("div",{className:"typing-dots-container"},p.createElement("span",null),p.createElement("span",null),p.createElement("span",null))},vS=2,qo=28,ay=qo+vS*2,Ep=24,Ul=3,Fx=vS,Hx=function(n){var t=n.sources,e=n.max;return p.createElement(p.Fragment,null," ",t.slice(0,e).map(function(r,i){return p.createElement(zr,{className:"sendbird-message-content__left__avatar multiple",src:r||"",key:"avatar_stack_item_".concat(r),width:"".concat(qo,"px"),height:"".concat(qo,"px"),zIndex:i,left:"".concat(i*Ep-Fx,"px")})})," ")},Bx=function(n){var t=n.typingMembers,e=t.length,r=Math.min(e,4),i=e-Ul,a=(r-1)*(ay-Ep),s=12;return p.createElement("div",{className:"sendbird-message-content__left incoming",style:{minWidth:r*ay-a+s}},p.createElement(Hx,{sources:t.map(function(u){return u.profileUrl}),max:Ul}),i>0?p.createElement(zr,{className:"sendbird-message-content__left__avatar multiple",width:"".concat(qo,"px"),height:"".concat(qo,"px"),zIndex:Ul,left:"".concat(Ul*Ep,"px"),customDefaultComponent:function(u){var o=u.width,l=u.height;return p.createElement(N0,{width:o,height:l,text:"+".concat(i)})}}):null)},Gx=function(n){var t=n.typingMembers,e=n.handleScroll;return N.useLayoutEffect(function(){e==null||e(!0)},[]),t.length===0?null:p.createElement("div",{className:"sendbird-message-content incoming",style:{marginBottom:"2px"}},p.createElement(Bx,{typingMembers:t}),p.createElement("div",{className:"sendbird-message-content__middle"},p.createElement(Px,null)))},Vx=100;function yS(n){var t=n.onReachedTop,e=n.onReachedBottom,r=n.onInBetween,i=Yo(function(a){if(a!=null&&a.target){var s=a.target,u=s.scrollTop,o=s.scrollHeight,l=s.clientHeight,d={distanceFromBottom:o-u-l};t&&Ds(u,0,Ba)?t(d):e&&Ds(o,l+u,Ba)?e(d):r&&r(d)}});return Tm(i,Vx,{trailing:!0})}var jx=function(n,t,e,r,i){if(!r||r.channelType!=="group")return[kl(n,t),kl(t,e)];if(i==="THREAD"&&(t!=null&&t.threadInfo))return[!1,!1];var a=(t==null?void 0:t.sendingStatus)||"",s=a!=="pending"&&a!=="failed";return[kl(n,t,r)&&s,kl(t,e,r)&&s]},sy=function(n){var t=$n().stringSet;return Xi(n.createdAt,t.DATE_FORMAT__MESSAGE_CREATED_AT)},kl=function(n,t,e){var r,i;return n&&t&&n.messageType&&n.messageType!=="admin"&&t.messageType&&(t==null?void 0:t.messageType)!=="admin"&&"sender"in n&&"sender"in t&&n.createdAt&&t.createdAt&&n.sender.userId&&t.sender.userId?(n==null?void 0:n.sendingStatus)===(t==null?void 0:t.sendingStatus)&&((r=n==null?void 0:n.sender)===null||r===void 0?void 0:r.userId)===((i=t==null?void 0:t.sender)===null||i===void 0?void 0:i.userId)&&sy(n)===sy(t)&&(e?Eg(e,n)===Eg(e,t):!0):!1},uy=function(n){var t=n.allMessages,e=t===void 0?[]:t,r=n.isMessageGroupingEnabled,i=r===void 0?!0:r,a=n.currentIndex,s=a===void 0?0:a,u=n.currentMessage,o=n.currentChannel,l=o===void 0?null:o,d=n.replyType,c=d===void 0?"":d,f=e[s-1],h=e[s+1],m=i?jx(f,u,h,l,c):[!1,!1],_=m[0],E=m[1],b=f==null?void 0:f.createdAt,g=u.createdAt,C="sendingStatus"in u&&u.sendingStatus!=="succeeded",S=C?!1:!(b&&ym(g,b));return{chainTop:_,chainBottom:E,hasSeparator:S}},qx=100;function zx(n){var t=n.loading,e=N.useState(0),r=e[0],i=e[1];N.useEffect(function(){t&&i(0)},[t]);var a=function(s){var u=s.target;try{i(u.scrollHeight-u.scrollTop-u.offsetHeight)}catch{}};return{scrollBottom:r,scrollToBottomHandler:Tm(a,qx,{trailing:!0})}}function Kx(){var n=rs(),t=n.scrollRef,e=n.scrollBehavior,r=e===void 0?"auto":e;return N.useEffect(function(){t.current&&(t.current.style.scrollBehavior=r)},[t.current]),null}var $x=50,Wx=function(n){var t,e,r,i,a,s,u,o=n.className,l=o===void 0?"":o,d=Zo(n),c=d.renderMessage,f=d.renderMessageContent,h=d.renderSuggestedReplies,m=d.renderCustomSeparator,_=d.renderPlaceholderLoader,E=_===void 0?function(){return p.createElement(Ki,{type:Ut.LOADING})}:_,b=d.renderPlaceholderEmpty,g=b===void 0?function(){return p.createElement(Ki,{className:"sendbird-conversation__no-messages",type:Ut.NO_MESSAGES})}:b,C=d.renderFrozenNotification,S=C===void 0?function(){return p.createElement(Lx,{className:"sendbird-conversation__messages__notification"})}:C,A=rs(),I=A.allMessages,T=A.localMessages,M=A.hasMorePrev,O=A.hasMoreNext,R=A.setInitialTimeStamp,U=A.setAnimatedMessageId,P=A.setHighLightedMessageId,L=A.isMessageGroupingEnabled,F=A.scrollRef,B=A.onScrollCallback,V=A.onScrollDownCallback,K=A.messagesDispatcher,$=A.messageActionTypes,q=A.currentGroupChannel,se=A.disableMarkAsRead,Y=A.filterMessageList,ce=A.replyType,X=A.loading,Se=A.isScrolled,te=A.unreadSince,be=A.unreadSinceDate,xe=A.typingMembers,Pe=Hn(),vn=typeof Y=="function"?I.filter(Y):I,on=Pe.config.markAsReadScheduler,je=N.useState(!1),Xe=je[0],sn=je[1];Kx();var un=function(De){var Ye=F==null?void 0:F.current;if(Ye!=null){var en=Ye.scrollTop,fn=Ye.clientHeight,Fe=Ye.scrollHeight;M&&Ds(en,0,Ba)&&B(De),O&&Ds(fn+en,Fe,Ba)&&V(De),!se&&Ds(fn+en,Fe,Ba)&&q&&(K({type:$.MARK_AS_READ,payload:{channel:q}}),on.push(q))}},En=function(){var De,Ye;R==null||R(null),U==null||U(null),P==null||P(null),F.current&&F.current.scrollTop>-1&&(F.current.scrollTop=((De=F.current.scrollHeight)!==null&&De!==void 0?De:0)-((Ye=F.current.offsetHeight)!==null&&Ye!==void 0?Ye:0))},rn=function(De){De===void 0&&(De=!1);var Ye=F==null?void 0:F.current;if(Ye){var en=Ye.scrollHeight-Ye.scrollTop-Ye.offsetHeight;ve<en&&(!De||ve<Ba)&&(Ye.scrollTop+=en-ve)}},qe=xx({hasMore:M,hasNext:O,onScroll:un,scrollRef:F}),Je=yS({onReachedBottom:function(){!O&&!se&&q&&(K({type:$.MARK_AS_READ,payload:{channel:q}}),on.push(q)),sn(!0)},onReachedTop:function(){sn(!1)},onInBetween:function(){sn(!1)}}),ln=zx({loading:X}),dn=ln.scrollToBottomHandler,ve=ln.scrollBottom;return X?E():vn.length<1?g():p.createElement(p.Fragment,null,!Se&&p.createElement(Ki,{type:Ut.LOADING}),p.createElement("div",{className:"sendbird-conversation__messages ".concat(l),dir:OO((t=Pe==null?void 0:Pe.config)===null||t===void 0?void 0:t.htmlTextDirection,(e=Pe==null?void 0:Pe.config)===null||e===void 0?void 0:e.forceLeftToRightMessageLayout)},p.createElement("div",{className:"sendbird-conversation__scroll-container"},p.createElement("div",{className:"sendbird-conversation__padding"}),p.createElement("div",{className:"sendbird-conversation__messages-padding","data-testid":"sendbird-message-list-container",ref:F,onScroll:function(De){qe(),dn(De),Je(De)}},vn.map(function(De,Ye){var en,fn,Fe=uy({allMessages:vn,replyType:ce,isMessageGroupingEnabled:L,currentIndex:Ye,currentMessage:De,currentChannel:q}),Nn=Fe.chainTop,nn=Fe.chainBottom,_e=Fe.hasSeparator,zn=((en=De==null?void 0:De.sender)===null||en===void 0?void 0:en.userId)===((fn=Pe==null?void 0:Pe.config)===null||fn===void 0?void 0:fn.userId);return p.createElement(Tv,{message:De,key:De==null?void 0:De.messageId,isByMe:zn},p.createElement(iy,{handleScroll:rn,message:De,hasSeparator:_e,chainTop:Nn,chainBottom:nn,renderMessageContent:f,renderSuggestedReplies:h,renderCustomSeparator:m,renderMessage:c}))}),T.map(function(De,Ye){var en,fn,Fe=uy({allMessages:vn,replyType:ce,isMessageGroupingEnabled:L,currentIndex:Ye,currentMessage:De,currentChannel:q}),Nn=Fe.chainTop,nn=Fe.chainBottom,_e=((en=De==null?void 0:De.sender)===null||en===void 0?void 0:en.userId)===((fn=Pe==null?void 0:Pe.config)===null||fn===void 0?void 0:fn.userId);return p.createElement(Tv,{message:De,key:De==null?void 0:De.messageId,isByMe:_e},p.createElement(iy,{handleScroll:rn,message:De,chainTop:Nn,chainBottom:nn,renderMessageContent:f,renderSuggestedReplies:h,renderCustomSeparator:m,renderMessage:c}))}),!O&&((i=(r=Pe==null?void 0:Pe.config)===null||r===void 0?void 0:r.groupChannel)===null||i===void 0?void 0:i.enableTypingIndicator)&&((u=(s=(a=Pe==null?void 0:Pe.config)===null||a===void 0?void 0:a.groupChannel)===null||s===void 0?void 0:s.typingIndicatorTypes)===null||u===void 0?void 0:u.has(Ld.Bubble))&&p.createElement(Gx,{typingMembers:xe,handleScroll:rn}))),(q==null?void 0:q.isFrozen)&&S(),(!Xe||O)&&(te||be)&&p.createElement(Dx,{className:"sendbird-conversation__messages__notification",count:q==null?void 0:q.unreadMessageCount,time:te,lastReadAt:be,onClick:function(){F!=null&&F.current&&(F.current.scrollTop=F.current.scrollHeight),!se&&q&&(on.push(q),K({type:$.MARK_AS_READ,payload:{channel:q}})),R(null),U(null),P(null)}}),ve>$x&&p.createElement("div",{className:"sendbird-conversation__scroll-bottom-button",onClick:En,onKeyDown:En,tabIndex:0,role:"button"},p.createElement(Ue,{width:"24px",height:"24px",type:ye.CHEVRON_DOWN,fillColor:Me.PRIMARY}))))},Yx=function(n){return p.createElement(ES,G({},n))},xl="sendbird-quote_message_input__avatar";function Qx(n){var t,e=n.message;if(!Ir(e)&&!kr(e)||Ji(e))return p.createElement(p.Fragment,null);var r=nS(e);return r||(MC(e)||pu(e)?r=Pd(e):kr(e)&&_O((t=e.fileInfoList)===null||t===void 0?void 0:t[0])&&(r=e.fileInfoList[0].url)),pu(e)&&r?p.createElement("div",{className:xl},p.createElement("video",{style:{width:"44px",height:"44px"},src:r})):(ts(e)||kr(e))&&r?p.createElement(Xt,{className:xl,url:r,alt:xd(e),width:"44px",height:"44px",fixedSize:!0}):mO(e)?p.createElement("div",{className:xl},p.createElement(Ue,{type:ye.FILE_AUDIO,fillColor:Me.ON_BACKGROUND_2,width:"24px",height:"24px"})):p.createElement("div",{className:xl},p.createElement(Ue,{type:ye.FILE_DOCUMENT,fillColor:Me.ON_BACKGROUND_2,width:"24px",height:"24px"}))}function Xx(n){var t=n.className,e=n.replyingMessage,r=n.onClose,i=N.useContext(wt).stringSet,a=e,s=e==null?void 0:e.sender,u=(Ir(e)||kr(e))&&!Ji(e);return p.createElement("div",{className:Br(["sendbird-quote_message_input",t??""])},u&&p.createElement(Qx,{message:a}),p.createElement("div",{className:"sendbird-quote_message_input__body",style:{width:"calc(100% - ".concat(u?"164px":"120px",")"),left:u?"92px":"40px"}},p.createElement(me,{className:"sendbird-quote_message_input__body__sender-name",type:he.CAPTION_1,color:re.ONBACKGROUND_1},"".concat(i.QUOTE_MESSAGE_INPUT__REPLY_TO," ").concat(s&&s.nickname?s.nickname:i.NO_NAME)),p.createElement(me,{className:"sendbird-quote_message_input__body__message-content",type:he.BODY_2,color:re.ONBACKGROUND_3},MC(a)&&!Zf(a)&&i.QUOTE_MESSAGE_INPUT__FILE_TYPE_IMAGE,pu(a)&&i.QUOTE_MESSAGE_INPUT__FILE_TYPE__VIDEO,Zf(a)&&i.QUOTE_MESSAGE_INPUT__FILE_TYPE_GIF,Pr(e)&&e.message,zp(e)===Fi.FILE&&eS(a),kr(e)&&"".concat(a.fileInfoList.length," Photos"),Ji(e)&&i.VOICE_MESSAGE)),p.createElement(Ue,{className:"sendbird-quote_message_input__close-button",type:ye.CLOSE,fillColor:Me.ON_BACKGROUND_2,width:"24px",height:"24px",onClick:function(){return r==null?void 0:r(e)}}))}var vs={PREPARING:"PREPARING",READY_TO_RECORD:"READY_TO_RECORD",RECORDING:"RECORDING",COMPLETED:"COMPLETED"},Zx=function(n){var t=n.onRecordingStarted,e=t===void 0?ot:t,r=n.onRecordingEnded,i=r===void 0?ot:r,a=Hn().config,s=a.voiceRecord,u=s.maxRecordingTime,o=s0(),l=o.isRecordable,d=N.useState(null),c=d[0],f=d[1],h=N.useState(vs.PREPARING),m=h[0],_=h[1];N.useEffect(function(){l&&m===vs.PREPARING&&_(vs.READY_TO_RECORD)},[l]);var E=N.useCallback(function(){o==null||o.start({onRecordingStarted:function(){_(vs.RECORDING),e(),T()},onRecordingEnded:function(O){_(vs.COMPLETED),i(O),f(O),M()}})},[e,i]),b=N.useCallback(function(){o==null||o.stop(),M()},[o]),g=N.useCallback(function(){b(),f(null)},[o]),C=N.useState(0),S=C[0],A=C[1],I=N.useRef(null);function T(){M(),A(0),I.current=setInterval(function(){A(function(O){var R=O+100;return R>u&&M(),R})},100)}function M(){I.current&&(clearInterval(I.current),I.current=null)}return N.useEffect(function(){S>u&&b()},[S,u,b]),{start:E,stop:b,cancel:g,recordingStatus:m,recordingTime:S,recordedFile:c,recordingLimit:u}},qt={READY_TO_RECORD:"READY_TO_RECORD",RECORDING:"RECORDING",READY_TO_PLAY:"READY_TO_PLAY",PLAYING:"PLAYING"},Jx=function(n){var t=n.inputState;switch(t){case qt.READY_TO_RECORD:return p.createElement("div",{className:"sendbird-controler-icon record-icon"});case qt.RECORDING:return p.createElement("div",{className:"sendbird-controler-icon stop-icon"});case qt.READY_TO_PLAY:return p.createElement(Ue,{className:"sendbird-controler-icon play-icon",width:"20px",height:"20px",type:ye.PLAY,fillColor:Me.ON_BACKGROUND_1});case qt.PLAYING:return p.createElement("div",{className:"sendbird-controler-icon pause-icon"},p.createElement("div",{className:"sendbird-controler-icon pause-icon-inner"}),p.createElement("div",{className:"sendbird-controler-icon pause-icon-inner"}));default:return p.createElement(p.Fragment,null)}},e4=function(n){var t=n.minRecordTime,e=t===void 0?vC:t,r=n.maximumValue,i=n.currentValue,a=i===void 0?0:i,s=n.currentType,u=n.onCancelClick,o=n.onControlClick,l=n.onSubmitClick,d=n.renderCancelButton,c=n.renderControlButton,f=n.renderSubmitButton,h=N.useState(0),m=h[0],_=h[1],E=N.useMemo(function(){return s===qt.READY_TO_RECORD},[s]),b=N.useMemo(function(){return s===qt.RECORDING},[s]),g=N.useMemo(function(){return s===qt.READY_TO_RECORD||s===qt.RECORDING?e>a:!1},[s,e,a]),C=N.useMemo(function(){return s===qt.READY_TO_PLAY||s===qt.PLAYING},[s]),S=$n().stringSet,A=function(){var M=Date.now();M-m>$c&&(u==null||u(),_(M))},I=N.useCallback(function(){var M=Date.now();M-m>$c&&(o==null||o(s),_(M))},[s]),T=function(){var M=Date.now();M-m>$c&&(g||l==null||l(),_(M))};return p.createElement("div",{className:"sendbird-voice-message-input"},p.createElement("div",{className:"sendbird-voice-message-input__indicator"},p.createElement("div",{className:"sendbird-voice-message-input__indicator__progress-bar"},p.createElement(tS,{className:"sendbird-voice-message-input__indicator__progress-bar__bar",disabled:E,maxSize:r,currentSize:a})),b?p.createElement("div",{className:"sendbird-voice-message-input__indicator__on-rec"}):null,p.createElement(iS,{className:"sendbird-voice-message-input__indicator__playback-time",time:C?r-a:a,labelColor:E?re.ONBACKGROUND_4:re.ONCONTENT_1})),p.createElement("div",{className:"sendbird-voice-message-input__controler"},(d==null?void 0:d())||p.createElement(nl,{className:"sendbird-voice-message-input__controler__cancel",onClick:A,disableUnderline:!0},p.createElement(me,{type:he.BUTTON_1,color:re.PRIMARY},S.BUTTON__CANCEL)),(c==null?void 0:c(s))||p.createElement("div",{className:"sendbird-voice-message-input__controler__main",onClick:I},p.createElement(Jx,{inputState:s})),(f==null?void 0:f())||p.createElement("div",{className:Fn("sendbird-voice-message-input__controler__submit",g&&"voice-message--disabled"),onClick:T},p.createElement(Ue,{width:"19px",height:"19px",type:ye.SEND,fillColor:g?Me.ON_BACKGROUND_4:Me.CONTENT}))))},n4=function(n){var t=n.imageFile,e=n.compressionRate,r=n.resizingWidth,i=n.resizingHeight,a=n.outputFormat,s=document.createElement("img");return new Promise(function(u,o){s.src=URL.createObjectURL(t),s.onerror=o,s.onload=function(){URL.revokeObjectURL(s.src);var l=document.createElement("canvas"),d=s.width,c=s.height,f=!r||r>d?d:r,h=!i||i>c?c:i,m=d/f,_=c/h;m>_?h=c/(r?m:1):_>m&&(f=d/(i?_:1)),l.width=f,l.height=h;var E=l.getContext("2d");if(!E){o(new Error("Failed to get canvas 2d context"));return}E.drawImage(s,0,0,f,h);var b=a==="preserve"?t.type:"image/".concat(a),g=b.split("/").pop(),C=t.name.lastIndexOf("."),S="".concat(C===-1?t.name:t.name.substring(0,C),".").concat(g);E.canvas.toBlob(function(A){if(A){var I=new File([A],S,{type:b});u(I)}else o(new Error("Failed to compress image"))},b,e)}})},t4=function(n){return Nt(void 0,[n],void 0,function(t){var e,r,i,a,s,u,o=t.files,l=t.logger,d=t.imageCompression;return It(this,function(c){switch(c.label){case 0:return e=d.compressionRate,r=d.outputFormat,i=r===void 0?"preserve":r,a=d.resizingWidth?Su(d.resizingWidth):void 0,s=d.resizingHeight?Su(d.resizingHeight):void 0,u={failedIndexes:[],compressedFiles:[]},Array.isArray(o)&&o.length>0?!e||e<0||1<e?(l==null||l.warning("utils - compressImages: The compressionRate is not acceptable.",e),[2,u]):[4,Promise.all(o.map(function(f,h){return Nt(void 0,void 0,void 0,function(){var m,_;return It(this,function(E){switch(E.label){case 0:if(!(f.type==="image/jpg"||f.type==="image/png"||f.type==="image/jpeg"))return l==null||l.warning("utils - compressImages: The fileType is not compressible.",{file:f,index:h}),u.failedIndexes.push(h),u.compressedFiles.push(f),[2];E.label=1;case 1:return E.trys.push([1,3,,4]),[4,n4({imageFile:f,compressionRate:e,resizingWidth:a,resizingHeight:s,outputFormat:i})];case 2:return m=E.sent(),u.compressedFiles.push(m),[3,4];case 3:return _=E.sent(),u.compressedFiles.push(f),u.failedIndexes.push(h),l==null||l.warning("utils - compressImages: Failed to compress image file",{file:f,err:_}),[3,4];case 4:return[2]}})})}))]:(l==null||l.warning("utils - compressImages: There are no files.",o),[2,u]);case 1:return c.sent(),l==null||l.info("utils - compressImages: Finished compressing images",u),[2,u]}})})},r4=function(n){var t=n.channel,e=n.onCancelClick,r=n.onSubmitClick,i=N.useRef(vi()).current,a=N.useState(null),s=a[0],u=a[1],o=N.useState(qt.READY_TO_RECORD),l=o[0],d=o[1],c=N.useState(!1),f=c[0],h=c[1],m=N.useState(!1),_=m[0],E=m[1],b=N.useState(!1),g=b[0],C=b[1],S=$n().stringSet,A=Hn().config,I=Zx({onRecordingStarted:function(){d(qt.RECORDING)},onRecordingEnded:function(q){u(q)}}),T=I.start,M=I.stop,O=I.cancel,R=I.recordingTime,U=I.recordingStatus,P=I.recordingLimit,L=rS({channelUrl:t==null?void 0:t.url,key:i,audioFile:s??void 0}),F=L.play,B=L.pause,V=L.playbackTime,K=L.playingStatus,$=L.stop;return N.useEffect(function(){Ud(t)||Bo(t)?E(!0):E(!1)},[t==null?void 0:t.myRole,t==null?void 0:t.isFrozen,t==null?void 0:t.myMutedState]),N.useEffect(function(){f&&s&&(r==null||r(s,R),h(!1),u(null))},[f,s,R]),N.useEffect(function(){s&&(R<A.voiceRecord.minRecordingTime?(d(qt.READY_TO_RECORD),u(null)):K===wi.PLAYING?d(qt.PLAYING):d(qt.READY_TO_PLAY))},[s,R,K]),p.createElement("div",{className:"sendbird-voice-message-input-wrapper"},p.createElement(e4,{currentValue:U===vs.COMPLETED?V:R,maximumValue:U===vs.COMPLETED?R:P,currentType:l,onCancelClick:function(){e==null||e(),O(),$()},onSubmitClick:function(){_?(C(!0),d(qt.READY_TO_RECORD)):(M(),B(),h(!0))},onControlClick:function(q){switch(q){case qt.READY_TO_RECORD:{$(),T();break}case qt.RECORDING:{R>=A.voiceRecord.minRecordingTime&&!_?M():_?(O(),C(!0),d(qt.READY_TO_RECORD)):(O(),d(qt.READY_TO_RECORD));break}case qt.READY_TO_PLAY:{F();break}case qt.PLAYING:{B();break}}}}),g&&p.createElement(fi,{className:"sendbird-voice-message-input-wrapper-alert",titleText:Bo(t)?S.MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_MUTED:S.MODAL__VOICE_MESSAGE_INPUT_DISABLED__TITLE_FROZEN,hideFooter:!0,isCloseOnClickOutside:!0,onClose:function(){C(!1),e==null||e()}},p.createElement("div",{className:"sendbird-voice-message-input-wrapper-alert__body"},p.createElement(Ri,{className:"sendbird-voice-message-input-wrapper-alert__body__ok-button",type:kt.PRIMARY,size:ns.BIG,onClick:function(){C(!1),e==null||e()}},S.BUTTON__OK))))},i4=function(n,t){var e=n.sendFileMessage,r=n.sendMultipleFilesMessage,i=n.quoteMessage,a=t.logger,s=$n().stringSet,u=Hn().config,o=u.imageCompression,l=u==null?void 0:u.uikitUploadSizeLimit,d=u==null?void 0:u.uikitMultipleFilesMessageLimit,c=o0().openModal;return N.useCallback(function(f){return Nt(void 0,void 0,void 0,function(){var h,m,_,E,b,g;return It(this,function(C){switch(C.label){case 0:return f.length===0?(a.warning("Channel|useHandleUploadFiles: given file list is empty.",{files:f}),[2]):f.length>d?(a.info("Channel|useHandleUploadFiles: Cannot upload files more than ".concat(d)),c({modalProps:{titleText:s.FILE_UPLOAD_NOTIFICATION__COUNT_LIMIT.replace("%d","".concat(l)),hideFooter:!0},childElement:function(S){var A=S.closeModal;return p.createElement(Od,{type:kt.PRIMARY,submitText:s.BUTTON__OK,hideCancelButton:!0,onCancel:A,onSubmit:A})}}),[2]):f.some(function(S){return S.size>l})?(a.info("Channel|useHandleUploadFiles: Cannot upload file size exceeding ".concat(l)),h=1024*1024,c({modalProps:{titleText:s.FILE_UPLOAD_NOTIFICATION__SIZE_LIMIT.replace("%d","".concat(Math.floor(l/h))),hideFooter:!0},childElement:function(S){var A=S.closeModal;return p.createElement(Od,{type:kt.PRIMARY,submitText:s.BUTTON__OK,hideCancelButton:!0,onCancel:A,onSubmit:A})}}),[2]):[4,t4({files:f,imageCompression:o,logger:a})];case 1:return m=C.sent().compressedFiles,_=m,_.length===1?(a.info("Channel|useHandleUploadFiles: sending one file."),E=_[0],[2,e({file:E,parentMessageId:i==null?void 0:i.messageId})]):_.length>1?(a.info("Channel|useHandleUploadFiles: sending multiple files."),b=[],g=[],_.forEach(function(S){Ia(S.type)?b.push(S):g.push(S)}),[2,g.reduce(function(S,A){return S.then(function(){return e({file:A,parentMessageId:i==null?void 0:i.messageId})})},function(){return b.length===0?Promise.resolve():b.length===1?e({file:b[0]}):r({fileInfoList:b.map(function(S){return{file:S,fileName:S.name,fileSize:S.size,mimeType:S.type}}),parentMessageId:i==null?void 0:i.messageId})}())]):[2]}})})},[e,r,i])},a4=p.forwardRef(function(n,t){var e,r=n.currentChannel,i=n.messages,a=n.loading,s=n.quoteMessage,u=n.setQuoteMessage,o=n.messageInputRef,l=n.sendUserMessage,d=n.sendFileMessage,c=n.sendVoiceMessage,f=n.sendMultipleFilesMessage,h=n.renderUserMentionItem,m=n.renderFileUploadIcon,_=n.renderVoiceMessageIcon,E=n.renderSendMessageIcon,b=n.acceptableMimeTypes,g=n.disabled,C=$n().stringSet,S=Nr().isMobile,A=Hn(),I=A.stores,T=A.config,M=T.isOnline,O=T.userMention,R=T.logger,U=T.groupChannel,P=I.sdkStore.sdk,L=O.maxMentionCount,F=O.maxSuggestionCount,B=r==null?void 0:r.isBroadcast,V=(r==null?void 0:r.myRole)==="operator",K=(e=n.isMultipleFilesMessageEnabled)!==null&&e!==void 0?e:T.isMultipleFilesMessageEnabled,$=U.enableMention,q=U.enableVoiceMessage,se=N.useState(""),Y=se[0],ce=se[1],X=N.useState([]),Se=X[0],te=X[1],be=N.useState([]),xe=be[0],Pe=be[1],vn=N.useState(null),on=vn[0],je=vn[1],Xe=N.useState([]),sn=Xe[0],un=Xe[1],En=N.useState(null),rn=En[0],qe=En[1],Je=N.useState(!1),ln=Je[0],dn=Je[1],ve=a||!r||!P||!P.isCacheEnabled&&!M||Ud(r)||Bo(r)||XE(r,T.groupChannel.enableSuggestedReplies)||ZE(i,T.groupChannel.enableFormTypeMessage)||g,De=!ve&&$&&Y.length>0&&!B,Ye=O0({ref:t||o},{logger:R}),en=(Ye==null?void 0:Ye.length)<L;N.useEffect(function(){ce(""),te([]),Pe([]),je(null),un([]),qe(null),dn(!1)},[r==null?void 0:r.url]),N.useEffect(function(){te(Se.filter(function(Fe){var Nn=Fe.userId,nn=xe.indexOf(Nn);return nn<0?!1:(xe.splice(nn,1),!0)}))},[xe]);var fn=i4({sendFileMessage:d,sendMultipleFilesMessage:f,quoteMessage:s??void 0},{logger:R});return B&&!V?null:p.createElement("div",{className:ln?"sendbird-message-input-wrapper--voice-message":"sendbird-message-input-wrapper"},De&&p.createElement(Yx,{currentChannel:r,targetNickname:Y,inputEvent:rn??void 0,renderUserMentionItem:h,onUserItemClick:function(Fe){Fe&&te(Ce(Ce([],Se,!0),[Fe],!1)),ce(""),je(Fe),qe(null)},onFocusItemChange:function(){qe(null)},onFetchUsers:function(Fe){un(Fe)},ableAddMention:en,maxMentionCount:L,maxSuggestionCount:F}),s&&p.createElement("div",{className:"sendbird-message-input-wrapper__quote-message-input"},p.createElement(Xx,{replyingMessage:s,onClose:function(){return u(null)}})),ln?p.createElement(r4,{channel:r??void 0,onSubmitClick:function(Fe,Nn){c({file:Fe,parentMessageId:s==null?void 0:s.messageId},Nn),u(null),dn(!1)},onCancelClick:function(){dn(!1)}}):p.createElement(z0,{className:"sendbird-message-input-wrapper__message-input",channel:r,channelUrl:r==null?void 0:r.url,isMobile:S,acceptableMimeTypes:b,mentionSelectedUser:on,isMentionEnabled:$,isVoiceMessageEnabled:q,isSelectingMultipleFilesEnabled:K,onVoiceMessageIconClick:function(){dn(!0)},setMentionedUsers:te,placeholder:s&&C.MESSAGE_INPUT__QUOTE_REPLY__PLACE_HOLDER||Ud(r)&&C.MESSAGE_INPUT__PLACE_HOLDER__FROZEN||Bo(r)&&(S?C.MESSAGE_INPUT__PLACE_HOLDER__MUTED_SHORT:C.MESSAGE_INPUT__PLACE_HOLDER__MUTED)||XE(r,T.groupChannel.enableSuggestedReplies)&&C.MESSAGE_INPUT__PLACE_HOLDER__SUGGESTED_REPLIES||ZE(i,T.groupChannel.enableFormTypeMessage)&&C.MESSAGE_INPUT__PLACE_HOLDER__MESSAGE_FORM||g&&C.MESSAGE_INPUT__PLACE_HOLDER__DISABLED||void 0,ref:t||o,disabled:ve,renderFileUploadIcon:m,renderSendMessageIcon:E,renderVoiceMessageIcon:_,onStartTyping:function(){r==null||r.startTyping()},onSendMessage:function(Fe){var Nn,nn=Fe.message,_e=Fe.mentionTemplate;l({message:nn,mentionedUsers:Se,mentionedMessageTemplate:_e,parentMessageId:s==null?void 0:s.messageId}),ce(""),te([]),u(null),(Nn=r==null?void 0:r.endTyping)===null||Nn===void 0||Nn.call(r)},onFileUpload:function(Fe){fn(Fe),u(null)},onUserMentioned:function(Fe){(on==null?void 0:on.userId)===(Fe==null?void 0:Fe.userId)&&(je(null),ce(""))},onMentionStringChange:function(Fe){ce(Fe)},onMentionedUserIdsUpdated:function(Fe){Pe(Fe)},onKeyDown:function(Fe){return De&&(sn==null?void 0:sn.length)>0&&(Fe.key===Di.Enter&&en||Fe.key===Di.ArrowUp||Fe.key===Di.ArrowDown)?(qe(Fe),!0):!1}}))}),s4=function(n){var t=rs(),e=t.quoteMessage,r=t.currentGroupChannel,i=t.sendMessage,a=t.sendFileMessage,s=t.sendVoiceMessage,u=t.sendMultipleFilesMessage;return p.createElement(a4,G({},n,t,{currentChannel:r,messages:t.allMessages,sendUserMessage:function(o){return i({message:o.message,mentionTemplate:o.mentionedMessageTemplate,mentionedUsers:o.mentionedUsers,quoteMessage:e??void 0})},sendFileMessage:function(o){return a(o.file,e??void 0)},sendVoiceMessage:function(o,l){var d=o.file;return s(d,l,e??void 0)},sendMultipleFilesMessage:function(o){var l=o.fileInfoList;return u(l.map(function(d){return d.file}),e??void 0)}}))},u4=function(n){var t=rs(),e=t.channelUrl,r=t.isInvalid,i=Zo(n),a=i.renderChannelHeader,s=a===void 0?function(c){return p.createElement($L,G({},c))}:a,u=i.renderMessageList,o=u===void 0?function(c){return p.createElement(Wx,G({},c,{className:"sendbird-conversation__message-list"}))}:u,l=i.renderMessageInput,d=l===void 0?function(){return p.createElement(s4,G({},n))}:l;return p.createElement(LL,G({},n,t,{isLoading:n==null?void 0:n.isLoading,isInvalid:r,channelUrl:e,renderChannelHeader:s,renderMessageList:o,renderMessageInput:d}))},o4=function(n){return p.createElement(OL,G({},n),p.createElement(u4,G({},n)))},bS="RESET_CHANNEL_LIST",CS="CREATE_CHANNEL",Nm="LEAVE_CHANNEL_SUCCESS",Bd="SET_CURRENT_CHANNEL",l4="FETCH_CHANNELS_START",Im="FETCH_CHANNELS_SUCCESS",d4="FETCH_CHANNELS_FAILURE",Am="INIT_CHANNELS_START",SS="INIT_CHANNELS_SUCCESS",TS="REFRESH_CHANNELS_SUCCESS",NS="INIT_CHANNELS_FAILURE",IS="ON_USER_JOINED",AS="ON_CHANNEL_DELETED",ha="ON_LAST_MESSAGE_UPDATED",vp="ON_USER_LEFT",MS="ON_CHANNEL_CHANGED",wS="ON_CHANNEL_ARCHIVED",OS="ON_CHANNEL_FROZEN",RS="ON_CHANNEL_UNFROZEN",DS="ON_READ_RECEIPT_UPDATED",LS="ON_DELIVERY_RECEIPT_UPDATED",Mm="CHANNEL_LIST_PARAMS_UPDATED",c4="delivery_receipt",f4=function(n){var t=n.sdk,e=n.sdkChannelHandlerId,r=n.channelListDispatcher,i=n.logger,a=new Wo({onChannelChanged:function(s){s.isGroupChannel()&&(i.info("ChannelList: onChannelChanged",s),r({type:MS,payload:s}))},onChannelDeleted:function(s){i.info("ChannelList: onChannelDeleted",s),r({type:AS,payload:s})},onUserJoined:function(s){i.info("ChannelList: onUserJoined",s),r({type:IS,payload:s})},onUserBanned:function(s,u){var o;if(s.isGroupChannel()){i.info("Channel: onUserBanned",s);var l=u.userId===((o=t==null?void 0:t.currentUser)===null||o===void 0?void 0:o.userId);r({type:vp,payload:{channel:s,isMe:l}})}},onUserLeft:function(s,u){var o;i.info("ChannelList: onUserLeft",s);var l=u.userId===((o=t==null?void 0:t.currentUser)===null||o===void 0?void 0:o.userId);r({type:vp,payload:{channel:s,isMe:l}})},onUnreadMemberStatusUpdated:function(s){i.info("ChannelList: onUnreadMemberStatusUpdated",s),r({type:DS,payload:s})},onUndeliveredMemberStatusUpdated:function(s){i.info("ChannelList: onUndeliveredMemberStatusUpdated",s),s.lastMessage&&r({type:LS,payload:s})},onMessageUpdated:function(s,u){var o;s.isGroupChannel()&&(!((o=s.lastMessage)===null||o===void 0)&&o.isEqual(u))&&(i.info("ChannelList: onMessageUpdated",s),r({type:ha,payload:s}))},onChannelHidden:function(s){i.info("ChannelList: onChannelHidden",s),r({type:wS,payload:s})},onChannelFrozen:function(s){s.isGroupChannel()&&(i.info("ChannelList: onChannelFrozen",s),r({type:OS,payload:s}))},onChannelUnfrozen:function(s){s.isGroupChannel()&&(i.info("ChannelList: onChannelUnfrozen",s),r({type:RS,payload:s}))}});i.info("ChannelList: Added channelHandler"),t.groupChannel.addGroupChannelHandler(e,a)},US=function(n){var t=n.sdk,e=n.userFilledChannelListQuery,r=e===void 0?{}:e,i={includeEmpty:!1,limit:20,order:Et.LATEST_LAST_MESSAGE};return r&&Object.keys(r).forEach(function(a){i[a]=r[a]}),t.groupChannel.createMyGroupChannelListQuery(i)};function h4(n){var t,e,r,i,a=n.sdk,s=n.sdkChannelHandlerId,u=n.channelListDispatcher,o=n.setChannelSource,l=n.onChannelSelect,d=n.userFilledChannelListQuery,c=n.logger,f=n.sortChannelList,h=n.disableAutoSelect,m=n.markAsDeliveredScheduler,_=n.disableMarkAsDelivered;a!=null&&a.groupChannel?f4({sdk:a,channelListDispatcher:u,sdkChannelHandlerId:s,logger:c}):c.warning("ChannelList - createEventHandler: sdk or sdk.ChannelHandler does not exist",a),c.info("ChannelList - creating query",{userFilledChannelListQuery:d});var E=US({sdk:a,userFilledChannelListQuery:d});c.info("ChannelList - created query",E),o(E),u({type:Am,payload:{currentUserId:(e=(t=a==null?void 0:a.currentUser)===null||t===void 0?void 0:t.userId)!==null&&e!==void 0?e:""}}),d&&(c.info("ChannelList - setting up channelListQuery",E),u({type:Mm,payload:{channelListQuery:E,currentUserId:(i=(r=a==null?void 0:a.currentUser)===null||r===void 0?void 0:r.userId)!==null&&i!==void 0?i:""}})),c.info("ChannelList - fetching channels"),E.hasNext?E.next().then(function(b){var g,C;c.info("ChannelList - fetched channels",b),c.info("ChannelList - highlight channel",b[0]);var S=b;f&&typeof f=="function"&&(S=f(b),c.info("ChannelList - channel list sorted",S)),h||l==null||l(S[0]),u({type:SS,payload:{channelList:S,disableAutoSelect:h}});var A=(C=(g=a==null?void 0:a.appInfo)===null||g===void 0?void 0:g.premiumFeatureList)===null||C===void 0?void 0:C.find(function(I){return I===c4});A&&!_&&S.forEach(function(I){m.push(I)})}).catch(function(b){b&&(c.error("ChannelList - couldnt fetch channels",b),u({type:NS}))}):c.info("ChannelList - there are no more channels")}var p4=function(n){n.forEach(function(t){try{t.remove()}catch{}})},m4=function(n,t){var e=new Map;return n&&(e.set(Sr.CREATE_CHANNEL,n.subscribe(Sr.CREATE_CHANNEL,function(r){var i=r.channel;t({type:CS,payload:i})})),e.set(Sr.UPDATE_USER_MESSAGE,n.subscribe(Sr.UPDATE_USER_MESSAGE,function(r){var i,a=r.channel,s=r.message;a.isGroupChannel()&&((i=a==null?void 0:a.lastMessage)===null||i===void 0?void 0:i.messageId)===s.messageId&&(a.lastMessage=s,t({type:ha,payload:a}))})),e.set(Sr.LEAVE_CHANNEL,n.subscribe(Sr.LEAVE_CHANNEL,function(r){var i=r.channel;t({type:Nm,payload:i==null?void 0:i.url})}))),e},Zu=function(n){var t=n.channel,e=n.currentChannel,r=n.allChannels,i=n.disableAutoSelect,a=null;if((e==null?void 0:e.url)===t.url){if(!i&&r.length>0){var s=r[0],u=r[1],o=u===void 0?null:u;a=s.url===t.url?o:s}}else a=e;return a},kS={initialized:!1,loading:!0,allChannels:[],currentChannel:null,channelListQuery:null,currentUserId:"",disableAutoSelect:!1};function _4(n,t){return cr(t).with({type:Am},function(e){var r=e.payload;return G(G({},n),{loading:!0,currentUserId:r.currentUserId})}).with({type:bS},function(){return kS}).with({type:SS},function(e){var r=e.payload,i=r.channelList,a=r.disableAutoSelect;return G(G({},n),{initialized:!0,loading:!1,allChannels:i,disableAutoSelect:a,currentChannel:!a&&i&&i.length&&i.length>0?i[0]:n.currentChannel})}).with({type:TS},function(e){var r=e.payload,i=r.channelList,a=r.currentChannel;return G(G({},n),{loading:!1,allChannels:i,currentChannel:a})}).with({type:Im},function(e){var r=n.allChannels.map(function(a){return a.url}),i=e.payload.filter(function(a){var s=a.url;return!r.find(function(u){return u===s})});return G(G({},n),{allChannels:Ce(Ce([],n.allChannels,!0),i,!0)})}).with({type:CS},function(e){var r,i=e.payload,a=n.allChannels,s=n.currentUserId,u=n.channelListQuery;return u?eu(u,i,s)?G(G({},n),{currentChannel:i,allChannels:nu(a,i,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)}):G(G({},n),{currentChannel:i}):G(G({},n),{currentChannel:i,allChannels:Ce([i],a.filter(function(o){return o.url!==(i==null?void 0:i.url)}),!0)})}).with({type:wS},function(e){var r,i=e.payload,a=n.allChannels,s=n.currentUserId,u=n.currentChannel,o=n.channelListQuery,l=n.disableAutoSelect;if(o&&eu(o,i,s))return G(G({},n),{allChannels:nu(a,i,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)});var d=Zu({channel:i,currentChannel:u,allChannels:a,disableAutoSelect:l});return G(G({},n),{currentChannel:d,allChannels:a.filter(function(c){var f=c.url;return f!==(i==null?void 0:i.url)})})}).with({type:Xf.union(Nm,AS)},function(e){var r,i=e.payload,a=n.allChannels.filter(function(s){var u=s.url;return u!==i});return G(G({},n),{currentChannel:i===((r=n.currentChannel)===null||r===void 0?void 0:r.url)?a[0]:n.currentChannel,allChannels:a})}).with({type:vp},function(e){var r,i=e.payload,a=i.channel,s=i.isMe,u=n.allChannels,o=n.currentUserId,l=n.currentChannel,d=n.channelListQuery,c=n.disableAutoSelect,f=Ce([],u,!0),h=a;if(s||d&&!eu(d,a,o)){var m=u.findIndex(function(_){return _.url===a.url});m>-1&&(f.splice(m,1),h=Zu({channel:a,currentChannel:l,allChannels:u,disableAutoSelect:c}))}else f=nu(u,a,(r=n.channelListQuery)===null||r===void 0?void 0:r.order),(l==null?void 0:l.url)===a.url&&(h=a);return G(G({},n),{currentChannel:h,allChannels:f})}).with({type:Xf.union(IS,MS,DS,LS)},function(e){var r,i,a,s=e.payload,u=n.allChannels,o=u===void 0?[]:u,l=n.currentUserId,d=n.currentChannel,c=n.channelListQuery,f=n.disableAutoSelect,h=s.unreadMessageCount;if(c){if(eu(c,s,l))return G(G({},n),{allChannels:nu(o,s,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)});if(wO(s))return n;var m=Zu({channel:s,currentChannel:d,allChannels:o,disableAutoSelect:f});return G(G({},n),{currentChannel:m,allChannels:o.filter(function(_){var E=_.url;return E!==(s==null?void 0:s.url)})})}return h===0&&((a=(i=s==null?void 0:s.lastMessage)===null||i===void 0?void 0:i.sender)===null||a===void 0?void 0:a.userId)!==l?G(G({},n),{allChannels:o.map(function(_){return _.url===(s==null?void 0:s.url)?s:_})}):G(G({},n),{allChannels:Ce([s],o.filter(function(_){var E=_.url;return E!==s.url}),!0)})}).with({type:Bd},function(e){return G(G({},n),{currentChannel:e.payload})}).with({type:ha},function(e){return G(G({},n),{allChannels:n.allChannels.map(function(r){return(r==null?void 0:r.url)===e.payload.url?e.payload:r})})}).with({type:OS},function(e){var r,i=e.payload,a=n.allChannels,s=n.currentUserId,u=n.currentChannel,o=n.channelListQuery,l=n.disableAutoSelect;if(o){if(eu(o,i,s))return G(G({},n),{allChannels:nu(a,i,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)});var d=Zu({channel:i,currentChannel:u,allChannels:a,disableAutoSelect:l});return G(G({},n),{currentChannel:d,allChannels:a.filter(function(c){var f=c.url;return f!==(i==null?void 0:i.url)})})}return G(G({},n),{allChannels:a.map(function(c){return c.url===(i==null?void 0:i.url)&&(c.isFrozen=!0),c})})}).with({type:RS},function(e){var r,i=e.payload,a=n.allChannels,s=n.currentUserId,u=n.currentChannel,o=n.channelListQuery,l=n.disableAutoSelect;if(o){if(eu(o,i,s))return G(G({},n),{allChannels:nu(a,i,(r=n.channelListQuery)===null||r===void 0?void 0:r.order)});var d=Zu({channel:i,currentChannel:u,allChannels:a,disableAutoSelect:l});return G(G({},n),{currentChannel:d,allChannels:a.filter(function(c){var f=c.url;return f!==(i==null?void 0:i.url)})})}return G(G({},n),{allChannels:a.map(function(c){return c.url===(i==null?void 0:i.url)&&(c.isFrozen=!1),c})})}).with({type:Mm},function(e){return G(G({},n),{channelListQuery:e.payload.channelListQuery,currentUserId:e.payload.currentUserId})}).otherwise(function(){return n})}function g4(n,t){var e=n.activeChannelUrl,r=n.channels,i=n.sdk,a=t.logger,s=t.channelListDispatcher;return N.useEffect(function(){var u;if(e){a.info("ChannelListProvider: looking for active channel",{activeChannelUrl:e});var o=r==null?void 0:r.find(function(l){return l.url===e});o?s({type:Bd,payload:o}):(a.info("ChannelListProvider: searching backend for active channel",{activeChannelUrl:e}),(u=i==null?void 0:i.groupChannel)===null||u===void 0||u.getChannel(e).then(function(l){s({type:Im,payload:[l]}),s({type:Bd,payload:l})}).catch(function(){a.warning("ChannelListProvider: Active channel not found")}))}},[e])}var E4=function(n,t){var e=n.channelSource,r=n.disableMarkAsDelivered,i=t.channelListDispatcher,a=t.logger,s=t.markAsDeliveredScheduler;return N.useCallback(function(){return Nt(void 0,void 0,void 0,function(){var u,o;return It(this,function(l){switch(l.label){case 0:if(!(e!=null&&e.hasNext))return a.info("ChannelList: not able to fetch"),[2];a.info("ChannelList: starting fetch"),i({type:l4,payload:null}),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,e.next()];case 2:return u=l.sent(),a.info("ChannelList: succeeded fetch",{channelList:u}),i({type:Im,payload:u}),r||(a.info("ChannelList: mark as delivered to fetched channels"),u==null||u.forEach(function(d){(d==null?void 0:d.unreadMessageCount)>0&&s.push(d)})),[3,4];case 3:return o=l.sent(),a.error("ChannelList: failed fetch",{error:o}),i({type:d4,payload:o}),[3,4];case 4:return[2]}})})},[e,r])};function v4(n){var t=n.isOnline,e=n.reconnectOnIdle,r=n.logger,i=n.sdk,a=n.currentGroupChannel,s=n.channelListDispatcher,u=n.setChannelSource,o=n.userFilledChannelListQuery,l=n.sortChannelList,d=n.disableAutoSelect,c=n.markAsDeliveredScheduler,f=n.disableMarkAsDelivered,h=v0(t,a,e).shouldReconnect;N.useEffect(function(){return function(){var m,_,E,b;if(h){r.info("ChannelList refresh - creating query",{userFilledChannelListQuery:o});var g=US({sdk:i,userFilledChannelListQuery:o});r.info("ChannelList refresh - created query",g),u(g),s({type:Am,payload:{currentUserId:(_=(m=i==null?void 0:i.currentUser)===null||m===void 0?void 0:m.userId)!==null&&_!==void 0?_:""}}),o&&(r.info("ChannelList refresh - setting up channelListQuery",g),s({type:Mm,payload:{channelListQuery:g,currentUserId:(b=(E=i==null?void 0:i.currentUser)===null||E===void 0?void 0:E.userId)!==null&&b!==void 0?b:""}})),r.info("ChannelList refresh - fetching channels"),g.hasNext?g.next().then(function(C){var S,A;r.info("ChannelList refresh - fetched channels",C);var I=C;l&&typeof l=="function"&&(I=l(C),r.info("ChannelList refresh - channel list sorted",I));var T=d?null:I[0];if(a!=null&&a.url){var M=I.find(function(R){return R.url===a.url});M&&(T=M)}r.info("ChannelList refresh - highlight channel",T),s({type:TS,payload:{channelList:I,currentChannel:T}});var O=(A=(S=i==null?void 0:i.appInfo)===null||S===void 0?void 0:S.premiumFeatureList)===null||A===void 0?void 0:A.find(function(R){return R===yC});O&&!f&&I.forEach(function(R){c.push(R)})}).catch(function(C){C&&(r.error("ChannelList refresh - could not fetch channels",C),s({type:NS}))}):r.info("ChannelList refresh - there are no more channels")}}},[h])}var xS=p.createContext(null),y4=function(n){var t,e,r=n.children,i=n.className,a=n.disableUserProfile,s=n.allowProfileEdit,u=n.queries,o=n.onProfileEditSuccess,l=n.onThemeChange,d=n.onBeforeCreateChannel,c=n.sortChannelList,f=n.overrideInviteUser,h=n.activeChannelUrl,m=n.isTypingIndicatorEnabled,_=m===void 0?null:m,E=n.isMessageReceiptStatusEnabled,b=E===void 0?null:E,g=n.reconnectOnIdle,C=(n==null?void 0:n.disableAutoSelect)||!!h,S=(n==null?void 0:n.onChannelSelect)||ot,A=Hn(),I=A.config,T=A.stores,M=T.sdkStore,O=I.pubSub,R=I.logger,U=I.markAsDeliveredScheduler,P=I.disableMarkAsDelivered,L=P===void 0?!1:P,F=I.isOnline,B=M==null?void 0:M.sdk,V=((t=B==null?void 0:B.appInfo)!==null&&t!==void 0?t:{}).premiumFeatureList,K=V===void 0?[]:V,$=s||I.allowProfileEdit,q=u==null?void 0:u.channelListQuery,se=u==null?void 0:u.applicationUserListQuery,Y=M==null?void 0:M.initialized,ce=N.useReducer(_4,kS),X=ce[0],Se=ce[1],te=X.currentChannel,be=N.useState(null),xe=be[0],Pe=be[1],vn=N.useState([]),on=vn[0],je=vn[1];N.useEffect(function(){var qe=m4(O,Se);return function(){p4(qe)}},[Y]),N.useEffect(function(){var qe,Je=vi();return Y?(R.info("ChannelList: Setup channelHandlers"),h4({sdk:B,sdkChannelHandlerId:Je,channelListDispatcher:Se,setChannelSource:Pe,onChannelSelect:S,userFilledChannelListQuery:G({},q),logger:R,sortChannelList:c,disableAutoSelect:C,markAsDeliveredScheduler:U,disableMarkAsDelivered:L})):(R.info("ChannelList: Removing channelHandlers"),!((qe=B==null?void 0:B.groupChannel)===null||qe===void 0)&&qe.removeGroupChannelHandler&&B.groupChannel.removeGroupChannelHandler(Je),Pe(null),Se({type:bS,payload:null})),function(){var ln,dn;R.info("ChannelList: Removing channelHandlers"),!((ln=B==null?void 0:B.groupChannel)===null||ln===void 0)&&ln.removeGroupChannelHandler&&((dn=B==null?void 0:B.groupChannel)===null||dn===void 0||dn.removeGroupChannelHandler(Je))}},[Y,c,Object.entries(q??{}).map(function(qe){var Je=qe[0],ln=qe[1];return Je+ln}).join()]),N.useEffect(function(){var qe,Je,ln="";if(!((qe=B==null?void 0:B.groupChannel)===null||qe===void 0)&&qe.addGroupChannelHandler){ln=vi();var dn=new Wo({onTypingStatusUpdated:function(ve){var De,Ye=(De=ve==null?void 0:ve.getTypingUsers())===null||De===void 0?void 0:De.length,en=on.filter(function(fn){return fn.url!==ve.url});Ye>0?je(Ce(Ce([],en,!0),[ve],!1)):je(en)},onUnreadMemberStatusUpdated:function(ve){Se({type:ha,payload:ve})},onUndeliveredMemberStatusUpdated:function(ve){Se({type:ha,payload:ve})},onMessageUpdated:function(ve){ve.isGroupChannel()&&(Se({type:ha,payload:ve}),B.groupChannel.getChannelWithoutCache(ve.url).then(function(De){Se({type:ha,payload:De})}))},onMentionReceived:function(ve){ve.isGroupChannel()&&(Se({type:ha,payload:ve}),B.groupChannel.getChannelWithoutCache(ve.url).then(function(De){Se({type:ha,payload:De})}))}});(Je=B==null?void 0:B.groupChannel)===null||Je===void 0||Je.addGroupChannelHandler(ln,dn)}return function(){var ve;!((ve=B==null?void 0:B.groupChannel)===null||ve===void 0)&&ve.removeGroupChannelHandler&&ln!==""&&B.groupChannel.removeGroupChannelHandler(ln)}},[(e=B==null?void 0:B.currentUser)===null||e===void 0?void 0:e.userId]);var Xe=N.useMemo(function(){return{applicationUserListQuery:se,channelListQuery:q}},[se,q]),sn=X.allChannels,un=c&&typeof c=="function"?c(sn):sn;if(un.length!==sn.length){var En=`ChannelList: You have removed/added extra channels on sortChannelList
      this could cause unexpected problems`;console.warn(En,{before:sn,after:un}),R.warning(En,{before:sn,after:un})}N.useEffect(function(){if(!(!B||!B.groupChannel)){if(!(te!=null&&te.url)){S(null);return}B.groupChannel.getChannel(te.url).then(function(qe){S(qe||null)})}},[te==null?void 0:te.url]),g4({activeChannelUrl:h,channels:un,sdk:B},{logger:R,channelListDispatcher:Se}),v4({isOnline:F,reconnectOnIdle:g,logger:R,sdk:B,currentGroupChannel:te,channelListDispatcher:Se,setChannelSource:Pe,userFilledChannelListQuery:q,sortChannelList:c,disableAutoSelect:C,markAsDeliveredScheduler:U,disableMarkAsDelivered:L});var rn=E4({channelSource:xe,disableMarkAsDelivered:L||!K.some(function(qe){return qe===yC})},{channelListDispatcher:Se,logger:R,markAsDeliveredScheduler:U});return p.createElement(xS.Provider,{value:G(G({className:i,disableUserProfile:a,queries:Xe,onProfileEditSuccess:o,onThemeChange:l,onBeforeCreateChannel:d,overrideInviteUser:f,onChannelSelect:S,sortChannelList:c,allowProfileEdit:$,channelListDispatcher:Se,channelSource:xe},X),{allChannels:un,typingChannels:on,isTypingIndicatorEnabled:_??I.groupChannelList.enableTypingIndicator,isMessageReceiptStatusEnabled:b??I.groupChannelList.enableMessageReceiptStatus,fetchChannelList:rn})},p.createElement(d0,G({},n),p.createElement("div",{className:"sendbird-channel-list ".concat(i)},r)))};function wm(){var n=N.useContext(xS);if(!n)throw new Error("ChannelListContext not found. Use within the ChannelList module.");return n}function b4(n){var t=n.count,e=n.maxLevel,r=e===void 0?2:e,i=n.className,a=i===void 0?"":i,s=N.useContext(wt).stringSet,u=parseInt("9".repeat(r>6?6:r),10);return p.createElement("div",{className:Ce(Ce([],Array.isArray(a)?a:[a],!0),["sendbird-badge"],!1).join(" ")},p.createElement("div",{className:"sendbird-badge__text"},p.createElement(me,{type:he.CAPTION_2,color:re.ONCONTENT_1},typeof t=="string"?t:t>u?"".concat(u).concat(s.BADGE__OVER):t)))}function C4(n){var t=n.className,e=t===void 0?"":t,r=n.children,i=n.isReverse,a=i===void 0?!1:i,s=n.color,u=n.userId;return p.createElement("span",{className:Fn(P0,e,a&&"reverse",s),contentEditable:!1,"data-userid":u,"data-sb-mention":!0},r)}var S4=function(n){var t=n.channel,e=n.tabIndex,r=n.isTyping,i=n.isSelected,a=n.channelName,s=n.isMessageStatusEnabled,u=s===void 0?!0:s,o=n.onClick,l=o===void 0?ot:o,d=n.onLeaveChannel,c=d===void 0?function(){return Promise.resolve()}:d,f=n.renderChannelAction,h=Hn().config,m=h.theme,_=h.userId,E=$n(),b=E.dateLocale,g=E.stringSet,C=Nr().isMobile,S=h.groupChannel.enableMention,A=jU(t,g),I=h.groupChannel.enableMarkdownForUserMessage?OU(A):A,T=N.useState(!1),M=T[0],O=T[1],R=Ou({onLongPress:function(){C&&O(!0)},onClick:l},{delay:1e3});return p.createElement(p.Fragment,null,p.createElement("div",G({className:["sendbird-channel-preview",i?"sendbird-channel-preview--active":""].join(" "),role:"link",tabIndex:e},C?G({},R):{onClick:l}),p.createElement("div",{className:"sendbird-channel-preview__avatar"},p.createElement(A0,{channel:t,userId:_,theme:m})),p.createElement("div",{className:"sendbird-channel-preview__content"},p.createElement("div",{className:"sendbird-channel-preview__content__upper"},p.createElement("div",{className:"sendbird-channel-preview__content__upper__header"},(t.isBroadcast||!1)&&p.createElement("div",{className:"sendbird-channel-preview__content__upper__header__broadcast-icon"},p.createElement(Ue,{type:ye.BROADCAST,fillColor:Me.SECONDARY,height:"16px",width:"16px"})),p.createElement(me,{className:"sendbird-channel-preview__content__upper__header__channel-name",testID:"sendbird-channel-preview__content__upper__header__channel-name",type:he.SUBTITLE_2,color:re.ONBACKGROUND_1},a),p.createElement(me,{className:"sendbird-channel-preview__content__upper__header__total-members",type:he.CAPTION_2,color:re.ONBACKGROUND_2},GU(t)),t.isFrozen&&p.createElement("div",{title:"Frozen",className:"sendbird-channel-preview__content__upper__header__frozen-icon"},p.createElement(Ue,{type:ye.FREEZE,fillColor:Me.PRIMARY,height:12,width:12}))),!t.isEphemeral&&u&&p.createElement($0,{className:"sendbird-channel-preview__content__upper__last-message-at",channel:t,message:t.lastMessage,isDateSeparatorConsidered:!1}),!t.isEphemeral&&!u&&p.createElement(me,{className:"sendbird-channel-preview__content__upper__last-message-at",type:he.CAPTION_3,color:re.ONBACKGROUND_2},K0({channel:t,locale:b,stringSet:g}))),p.createElement("div",{className:"sendbird-channel-preview__content__lower"},p.createElement(me,{className:"sendbird-channel-preview__content__lower__last-message",type:he.BODY_2,color:re.ONBACKGROUND_3},r&&p.createElement(S0,{members:t.getTypingUsers()}),!r&&!Ji(t.lastMessage)&&I,!r&&Ji(t.lastMessage)&&g.VOICE_MESSAGE),!i&&!t.isEphemeral&&p.createElement("div",{className:"sendbird-channel-preview__content__lower__unread-message-count"},S&&t.unreadMentionCount>0?p.createElement(C4,{className:"sendbird-channel-preview__content__lower__unread-message-count__mention",color:"purple"},"@"):null,mv(t)?p.createElement(b4,{count:mv(t)}):null))),!C&&p.createElement("div",{className:"sendbird-channel-preview__action"},f({channel:t}))),M&&C&&p.createElement(fi,{className:"sendbird-channel-preview__leave--mobile",titleText:a,hideFooter:!0,isCloseOnClickOutside:!0,onCancel:function(){return O(!1)}},p.createElement(nl,{onClick:function(){c(),O(!1)},className:"sendbird-channel-preview__leave-label--mobile"},p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},g.CHANNEL_PREVIEW_MOBILE_LEAVE))))},T4=function(n){var t,e,r,i,a=n.channel,s=n.isActive,u=s===void 0?!1:s,o=n.isSelected,l=o===void 0?!1:o,d=n.isTyping,c=d===void 0?!1:d,f=n.renderChannelAction,h=n.onLeaveChannel,m=n.onClick,_=n.tabIndex,E=Hn().config,b=$n().stringSet,g=wm(),C=g.isTypingIndicatorEnabled,S=C===void 0?!1:C,A=g.isMessageReceiptStatusEnabled,I=A===void 0?!1:A,T=E.userId,M=I&&(((t=a==null?void 0:a.lastMessage)===null||t===void 0?void 0:t.messageType)==="user"||((e=a==null?void 0:a.lastMessage)===null||e===void 0?void 0:e.messageType)==="file")&&((i=(r=a==null?void 0:a.lastMessage)===null||r===void 0?void 0:r.sender)===null||i===void 0?void 0:i.userId)===T;return p.createElement(S4,{channel:a,tabIndex:_,isTyping:S&&c,isSelected:l??u,channelName:BU(a,T,b),isMessageStatusEnabled:M,onClick:m,onLeaveChannel:h,renderChannelAction:f})},N4=function(n){var t=n.channel,e=n.onSubmit,r=n.onCancel,i=Hn().config,a=i.logger,s=i.isOnline,u=$n().stringSet;if(t)return p.createElement(fi,{disabled:!s,onCancel:r,onSubmit:function(){a.info("LeaveGroupChannel: Leaving channel",t),t.leave().then(function(){a.info("LeaveGroupChannel: Leaving channel successful!",t),e==null||e()})},submitText:u.MODAL__LEAVE_CHANNEL__FOOTER,titleText:u.MODAL__LEAVE_CHANNEL__TITLE})};function I4(n){var t=n.channel,e=n.disabled,r=e===void 0?!1:e,i=n.onLeaveChannel,a=N.useRef(null),s=N.useRef(null),u=N.useState(!1),o=u[0],l=u[1],d=N.useContext(wt).stringSet;return p.createElement("div",{ref:s,tabIndex:0,role:"button",style:{display:"inline-block"},onKeyDown:function(c){return c.stopPropagation()},onClick:function(c){return c.stopPropagation()}},p.createElement(wu,{menuTrigger:function(c){return p.createElement(va,{ref:a,onClick:c,height:"32px",width:"32px"},p.createElement(Ue,{type:ye.MORE,fillColor:Me.PRIMARY,width:"24px",height:"24px"}))},menuItems:function(c){return p.createElement(Mu,{parentRef:a,parentContainRef:s,closeDropdown:c},p.createElement(cD,{onClick:function(){r||(l(!0),c())},testID:"channel_list_item_context_menu_leave_channel"},d.CHANNEL_SETTING__LEAVE_CHANNEL__TITLE))}}),o&&p.createElement(N4,{channel:t,onSubmit:function(){l(!1),i==null||i()},onCancel:function(){return l(!1)}}))}var A4=function(n){var t=n.renderTitle,e=n.renderIconButton,r=n.onEdit,i=n.allowProfileEdit,a=n.renderLeft,s=n.renderMiddle,u=n.renderRight,o=Hn().stores,l=o.userStore.user,d=$n().stringSet,c=s??t;return p.createElement(ua,{className:Fn("sendbird-channel-header",i&&"sendbird-channel-header--allow-edit"),renderLeft:a,renderMiddle:function(){var f;return(f=c==null?void 0:c())!==null&&f!==void 0?f:p.createElement("div",{className:"sendbird-channel-header__title",role:"button",onClick:function(){r==null||r()},onKeyDown:function(){r==null||r()},tabIndex:0},p.createElement("div",{className:"sendbird-channel-header__title__left"},p.createElement(zr,{width:"32px",height:"32px",src:l.profileUrl,alt:l.nickname})),p.createElement("div",{className:"sendbird-channel-header__title__right"},p.createElement(me,{className:"sendbird-channel-header__title__right__name",type:he.SUBTITLE_2,color:re.ONBACKGROUND_1},l.nickname||d.NO_NAME),p.createElement(me,{className:"sendbird-channel-header__title__right__user-id",type:he.BODY_2,color:re.ONBACKGROUND_2},l.userId)))},renderRight:u??e})},PS=p.createContext(null),M4=function(n){var t=n.children,e=bw(n,["children"]);return p.createElement(PS.Provider,{value:e},t)},w4=function(){var n=p.useContext(PS);if(!n)throw new Error("EditUserProfileContext not found. Use within the EditUserProfile module.");return n},Qa={INIT_USER:"INIT_USER",RESET_USER:"RESET_USER",UPDATE_USER_INFO:"UPDATE_USER_INFO"},O4=function(n){var t,e=n.formRef,r=n.inputRef,i=n.onThemeChange,a=n.setProfileImage,s=Hn(),u=s.stores,o=s.config,l=o.theme,d=o.setCurrentTheme,c=(t=u.userStore)===null||t===void 0?void 0:t.user,f=$n().stringSet,h=N.useState(null),m=h[0],_=h[1],E=N.useRef(null);return p.createElement("form",{className:"sendbird-edit-user-profile",ref:e,onSubmit:function(b){b.preventDefault()}},p.createElement("section",{className:"sendbird-edit-user-profile__img"},p.createElement(Ll,null,f.EDIT_PROFILE__IMAGE_LABEL),p.createElement("div",{className:"sendbird-edit-user-profile__img__avatar"},p.createElement(zr,{width:"80px",height:"80px",src:m||(c==null?void 0:c.profileUrl)})),p.createElement("input",{ref:E,type:"file",accept:"image/gif, image/jpeg, image/png",style:{display:"none"},onChange:function(b){b.target.files&&(_(URL.createObjectURL(b.target.files[0])),a(b.target.files[0])),E.current&&(E.current.value="")}}),p.createElement(nl,{className:"sendbird-edit-user-profile__img__avatar-button",disableUnderline:!0,onClick:function(){var b;return(b=E.current)===null||b===void 0?void 0:b.click()}},p.createElement(me,{type:he.BUTTON_1,color:re.PRIMARY},f.EDIT_PROFILE__IMAGE_UPLOAD))),p.createElement("section",{className:"sendbird-edit-user-profile__name"},p.createElement(Ll,null,f.EDIT_PROFILE__NICKNAME_LABEL),p.createElement(_p,{required:(c==null?void 0:c.nickname)!=="",name:"sendbird-edit-user-profile__name__input",ref:r,value:c==null?void 0:c.nickname,placeHolder:f.EDIT_PROFILE__NICKNAME_PLACEHOLDER})),p.createElement("section",{className:"sendbird-edit-user-profile__userid"},p.createElement(Ll,null,f.EDIT_PROFILE__USERID_LABEL),p.createElement(_p,{disabled:!0,name:"sendbird-edit-user-profile__userid__input",value:c==null?void 0:c.userId})),p.createElement("section",{className:"sendbird-edit-user-profile__theme"},p.createElement(Ll,null,f.EDIT_PROFILE__THEME_LABEL),p.createElement("div",{className:"sendbird-edit-user-profile__theme__theme-icon"},l==="dark"?p.createElement(Ue,{onClick:function(){d("light"),i==null||i("light")},type:ye.TOGGLE_ON,width:44,height:24}):p.createElement(Ue,{onClick:function(){d("dark"),i==null||i("dark")},type:ye.TOGGLE_OFF,width:44,height:24}))))},R4=function(n){var t,e,r,i=n.globalContext,a=n.formRef,s=n.inputRef,u=n.profileImage,o=n.onEditProfile,l=i.stores,d=i.dispatchers,c=l.sdkStore.sdk,f=l.userStore.user,h=d.userDispatcher;if((f==null?void 0:f.nickname)!==""&&!s.current.value){(e=(t=a.current).reportValidity)===null||e===void 0||e.call(t);return}c==null||c.updateCurrentUserInfo({nickname:(r=s==null?void 0:s.current)===null||r===void 0?void 0:r.value,profileImage:u??void 0}).then(function(m){h({type:Qa.UPDATE_USER_INFO,payload:m}),o==null||o(m)})},D4=function(n){var t=n.onEditProfile,e=Hn(),r=N.useRef(null),i=N.useRef(null),a=N.useState(null),s=a[0],u=a[1],o=function(){R4({globalContext:e,formRef:i,inputRef:r,profileImage:s,onEditProfile:t})};return{formRef:i,inputRef:r,updateUserInfo:o,profileImage:s,setProfileImage:u}},L4=function(){var n=w4(),t=n.onEditProfile,e=n.onCancel,r=n.onThemeChange,i=N.useContext(wt).stringSet,a=D4({onEditProfile:t}),s=a.formRef,u=a.inputRef,o=a.updateUserInfo,l=a.setProfileImage;return p.createElement(fi,{titleText:i.EDIT_PROFILE__TITLE,submitText:i.BUTTON__SAVE,type:kt.PRIMARY,onCancel:e,isFullScreenOnMobile:!0,onSubmit:o},p.createElement(O4,{formRef:s,inputRef:u,setProfileImage:l,onThemeChange:r}))},U4=function(n){var t=n.onEditProfile,e=n.onCancel,r=n.onThemeChange;return p.createElement(M4,{onEditProfile:t,onCancel:e,onThemeChange:r},p.createElement(L4,null))},k4=function(n){var t=n.renderHeader,e=n.renderPlaceHolderError,r=n.renderPlaceHolderLoading,i=n.renderPlaceHolderEmptyList,a=n.onChangeTheme,s=n.onUserProfileUpdated,u=n.allowProfileEdit,o=n.channels,l=n.onLoadMore,d=n.initialized,c=n.renderChannel,f=n.renderAddChannel,h=n.scrollRef,m=N.useState(!1),_=m[0],E=m[1],b=Hn().stores,g={addChannel:f,channel:c,placeholder:{loading:function(){return d?null:r?r():p.createElement(Ki,{type:Ut.LOADING})},empty:function(){return d?i?i():p.createElement(Ki,{type:Ut.NO_CHANNELS}):null},error:function(){return!d||!b.sdkStore.error?null:e?e():p.createElement(Ki,{type:Ut.WRONG})}}};return p.createElement(p.Fragment,null,p.createElement("div",{className:"sendbird-channel-list__header"},(t==null?void 0:t())||p.createElement(A4,{onEdit:function(){return u&&E(!0)},allowProfileEdit:u,renderIconButton:function(){return g.addChannel()}})),_&&p.createElement(U4,{onThemeChange:a,onCancel:function(){return E(!1)},onEditProfile:function(C){E(!1),s(C)}}),p.createElement(x4,{data:o,renderItem:g.channel,onLoadMore:l,placeholderLoading:g.placeholder.loading(),placeholderEmpty:g.placeholder.empty(),placeholderError:g.placeholder.error(),scrollRef:h}))},x4=function(n){var t=n.data,e=n.renderItem,r=n.onLoadMore,i=n.placeholderLoading,a=n.placeholderError,s=n.placeholderEmpty,u=n.scrollRef,o=yS({onReachedBottom:function(){return r==null?void 0:r()}});return p.createElement("div",{className:"sendbird-channel-list__body",onScroll:o,ref:u},a,p.createElement("div",null,t.map(function(l,d){return e({item:l,index:d})})),i,t.length===0&&s)},pa;(function(n){n.GROUP="group",n.SUPERGROUP="supergroup",n.BROADCAST="broadcast"})(pa||(pa={}));var FS=p.createContext(null),P4=function(n){var t,e=n.children,r=n.onCreateChannelClick,i=n.onBeforeCreateChannel,a=n.onChannelCreated,s=n.userListQuery,u=n.onCreateChannel,o=n.overrideInviteUser,l=Hn(),d=s??((t=l==null?void 0:l.config)===null||t===void 0?void 0:t.userListQuery),c=N.useState(0),f=c[0],h=c[1],m=N.useState(pa.GROUP),_=m[0],E=m[1];return p.createElement(FS.Provider,{value:{sdk:l.stores.sdkStore.sdk,createChannel:Q0(l),onCreateChannelClick:r,onBeforeCreateChannel:i,onChannelCreated:a,userListQuery:d,step:f,setStep:h,type:_,setType:E,onCreateChannel:u,overrideInviteUser:o}},e)},Om=function(){var n=p.useContext(FS);if(!n)throw new Error("CreateChannelContext not found. Use within the CreateChannel module.");return n},F4=function(n){return function(t){return n==null?void 0:n.includes(t)}},oy=function(n,t){return t==="broadcast"&&(n.isBroadcast=!0),t==="supergroup"&&(n.isSuper=!0),n},H4=function(n){var t=n.sdk,e=n.userFilledApplicationUserListQuery,r=t.createApplicationUserListQuery();return e&&Object.keys(e).forEach(function(i){r[i]=e[i]}),r},B4=50,G4=function(n){var t,e,r,i=n.onCancel,a=n.userListQuery,s=Om(),u=s.onCreateChannelClick,o=s.onBeforeCreateChannel,l=s.onChannelCreated,d=s.createChannel,c=s.onCreateChannel,f=s.overrideInviteUser,h=s.type,m=Hn(),_=(t=m==null?void 0:m.config)===null||t===void 0?void 0:t.userId,E=(r=(e=m==null?void 0:m.stores)===null||e===void 0?void 0:e.sdkStore)===null||r===void 0?void 0:r.sdk,b=[_],g=N.useState([]),C=g[0],S=g[1],A=N.useState({}),I=A[0],T=A[1],M=N.useContext(wt).stringSet,O=N.useState(null),R=O[0],U=O[1],P=Object.keys(I).length,L=M.MODAL__CREATE_CHANNEL__TITLE,F=M.BUTTON__CREATE,B=Nr().isMobile,V=N.useState(window.innerHeight),K=V[0],$=V[1];return N.useEffect(function(){var q=a?a():H4({sdk:E});U(q),q!=null&&q.isLoading||q.next().then(function(se){S(se)})},[]),N.useEffect(function(){var q=function(){$(window.innerHeight)};return window.addEventListener("resize",q),function(){window.removeEventListener("resize",q)}},[]),p.createElement(fi,{isFullScreenOnMobile:!0,titleText:L,submitText:F,type:kt.PRIMARY,disabled:C.length>1&&Object.keys(I).length===0,onCancel:i,onSubmit:function(){var q=Object.keys(I).length>0?Object.keys(I):[_],se=l??c,Y=u??f;if(typeof Y=="function"){Y({users:q,onClose:i??ot,channelType:h});return}if(o){var ce=o(q);oy(ce,h),d(ce).then(function(X){return se==null?void 0:se(X)})}else{var ce={};ce.invitedUserIds=q,ce.isDistinct=!1,_&&(ce.operatorUserIds=[_]),oy(ce,h),d(ce).then(function(Se){return se==null?void 0:se(Se)})}i==null||i()}},p.createElement("div",null,p.createElement(me,{color:P>0?re.PRIMARY:re.ONBACKGROUND_3,type:he.CAPTION_1},"".concat(P," ").concat(M.MODAL__INVITE_MEMBER__SELECTED)),p.createElement("div",{className:"sendbird-create-channel--scroll",style:B?{height:"calc(".concat(K,"px - 200px)")}:{},onScroll:function(q){if(R){var se=q.target,Y=R.hasNext,ce=R.isLoading,X=se.clientHeight+se.scrollTop+B4>se.scrollHeight;Y&&X&&!ce&&R.next().then(function(Se){S(Ce(Ce([],C,!0),Se,!0))})}}},C.map(function(q){return!F4(b)(q.userId)&&p.createElement(X0,{key:q.userId,user:q,checkBox:!0,checked:I[q.userId],onChange:function(se){var Y,ce=G(G({},I),(Y={},Y[se.target.id]=se.target.checked,Y));se.target.checked||delete ce[se.target.id],T(ce)}})}))))},V4=function(n){var t,e="allow_broadcast_channel",r=(t=n==null?void 0:n.appInfo)===null||t===void 0?void 0:t.applicationAttributes;return Array.isArray(r)?r.includes(e):!1},j4=function(n){var t,e="allow_super_group_channel",r=(t=n==null?void 0:n.appInfo)===null||t===void 0?void 0:t.applicationAttributes;return Array.isArray(r)?r.includes(e):!1},q4=function(n){var t=n.onCancel,e=Hn(),r=Y0(e),i=Om(),a=i.setStep,s=i.setType,u=N.useContext(wt).stringSet,o=V4(r),l=j4(r);return p.createElement(fi,{titleText:u==null?void 0:u.MODAL__CREATE_CHANNEL__TITLE,hideFooter:!0,onCancel:function(){t==null||t()},className:"sendbird-add-channel__modal"},p.createElement("div",{className:"sendbird-add-channel__rectangle-wrap"},p.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){s(pa.GROUP),a(1)},role:"button",tabIndex:0,onKeyDown:function(){s(pa.GROUP),a(1)}},p.createElement(Ue,{className:"sendbird-add-channel__rectangle__chat-icon",type:ye.CHAT,fillColor:Me.PRIMARY,width:"28px",height:"28px"}),p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__GROUP)),l&&p.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){s(pa.SUPERGROUP),a(1)},role:"button",tabIndex:0,onKeyDown:function(){s(pa.SUPERGROUP),a(1)}},p.createElement(Ue,{className:"sendbird-add-channel__rectangle__supergroup-icon",type:ye.SUPERGROUP,fillColor:Me.PRIMARY,width:"28px",height:"28px"}),p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__SUPER)),o&&p.createElement("div",{className:"sendbird-add-channel__rectangle",onClick:function(){s(pa.BROADCAST),a(1)},role:"button",tabIndex:0,onKeyDown:function(){s(pa.BROADCAST),a(1)}},p.createElement(Ue,{className:"sendbird-add-channel__rectangle__broadcast-icon",type:ye.BROADCAST,fillColor:Me.PRIMARY,width:"28px",height:"28px"}),p.createElement(me,{type:he.SUBTITLE_1,color:re.ONBACKGROUND_1},u.MODAL__CREATE_CHANNEL__BROADCAST))))},z4=function(n){var t=n.onCancel,e=n.renderStepOne,r=Om(),i=r.step,a=r.setStep,s=r.userListQuery;return p.createElement(p.Fragment,null,i===0&&((e==null?void 0:e())||p.createElement(q4,{onCancel:t})),i===1&&p.createElement(G4,{userListQuery:s,onCancel:function(){a(0),t==null||t()}}))},K4=function(n){return p.createElement(P4,G({},n),p.createElement(z4,G({},n)))},$4=function(n){var t=n.createChannelVisible,e=n.onChangeCreateChannelVisible,r=n.onBeforeCreateChannel,i=n.onCreateChannelClick,a=n.onChannelCreated,s=Hn().config;return p.createElement(p.Fragment,null,p.createElement(va,{height:"32px",width:"32px",disabled:!s.isOnline,onClick:function(){return e(!0)}},p.createElement(Ue,{type:ye.CREATE,fillColor:Me.PRIMARY,width:"24px",height:"24px"})),t&&p.createElement(K4,{onCancel:function(){return e(!1)},onChannelCreated:function(u){a==null||a(u),e(!1)},onBeforeCreateChannel:r,onCreateChannelClick:i}))},W4=function(){var n=N.useState(!1),t=n[0],e=n[1],r=wm(),i=r.overrideInviteUser,a=r.onBeforeCreateChannel,s=r.onChannelSelect;return p.createElement($4,{createChannelVisible:t,onChangeCreateChannelVisible:e,onCreateChannelClick:i,onBeforeCreateChannel:a,onChannelCreated:function(u){return s==null?void 0:s(u)}})},Y4=function(n){var t=n.renderHeader,e=n.renderChannelPreview,r=n.renderPlaceHolderError,i=n.renderPlaceHolderLoading,a=n.renderPlaceHolderEmptyList,s=wm(),u=s.onThemeChange,o=s.allowProfileEdit,l=s.allChannels,d=s.currentChannel,c=s.channelListDispatcher,f=s.typingChannels,h=s.initialized,m=s.fetchChannelList,_=s.onProfileEditSuccess,E=Hn(),b=E.stores,g=E.config,C=g.logger,S=g.isOnline,A=S===void 0?!1:S,I=b.sdkStore.sdk,T=function(M){var O=M.item,R=M.index,U={channel:O,tabIndex:R,isSelected:(O==null?void 0:O.url)===(d==null?void 0:d.url),isTyping:f==null?void 0:f.some(function(P){var L=P.url;return L===(O==null?void 0:O.url)}),renderChannelAction:function(P){return p.createElement(I4,G({},P))},onClick:function(){if(!A&&!(I!=null&&I.isCacheEnabled)){C.warning("ChannelList: Inactivated clicking channel item during offline.");return}C.info("ChannelList: Clicked on channel:",O),c({type:Bd,payload:O})},onLeaveChannel:function(P,L){return Nt(this,void 0,void 0,function(){var F,B;return It(this,function(V){switch(V.label){case 0:if(C.info("ChannelList: Leaving channel",P),!P)return[3,4];V.label=1;case 1:return V.trys.push([1,3,,4]),[4,P.leave()];case 2:return F=V.sent(),C.info("ChannelList: Leaving channel success",F),L&&typeof L=="function"&&L(P,null),c({type:Nm,payload:P.url}),[3,4];case 3:return B=V.sent(),C.error("ChannelList: Leaving channel failed",B),L&&typeof L=="function"&&L(P,B),[3,4];case 4:return[2]}})})}};return e?p.createElement("div",{key:O==null?void 0:O.url,onClick:U.onClick},e(U)):p.createElement(T4,G({key:O==null?void 0:O.url},U))};return p.createElement(k4,{renderHeader:t,renderChannel:T,renderPlaceHolderError:r,renderPlaceHolderLoading:i,renderPlaceHolderEmptyList:a,onChangeTheme:u??ot,allowProfileEdit:o,onUserProfileUpdated:_??ot,channels:l,onLoadMore:m,initialized:h,renderAddChannel:function(){return p.createElement(W4,null)}})},Q4=function(n){return p.createElement(y4,G({},n),p.createElement(Y4,G({},n)))};function X4(n,t){var e,r,i=N.useState(typeof window<"u"&&(r=(e=window==null?void 0:window.navigator)===null||e===void 0?void 0:e.onLine)!==null&&r!==void 0?r:!0),a=i[0],s=i[1];return N.useEffect(function(){var u=vi();try{t.warning("sdk changed",u);var o=new Hb({onDisconnected:function(){s(!1),t.warning("onDisconnected",{isOnline:a})},onReconnectStarted:function(){s(!1),t.warning("onReconnectStarted",{isOnline:a})},onReconnectSucceeded:function(){s(!0),t.warning("onReconnectSucceeded",{isOnline:a})},onReconnectFailed:function(){n.reconnect(),t.warning("onReconnectFailed")}});n!=null&&n.addConnectionHandler&&(n.addConnectionHandler(u,o),t.info("Added ConnectionHandler",u))}catch{}return function(){try{n.removeConnectionHandler(u),t.info("Removed ConnectionHandler",u)}catch{}}},[n]),N.useEffect(function(){var u=function(){try{t.warning("Try reconnecting SDK"),n.connectionState!=="OPEN"&&n.reconnect()}catch{}};return window.addEventListener("online",u),function(){window.removeEventListener("online",u)}},[n]),N.useEffect(function(){var u=document.querySelector("body");if(!a&&!(n!=null&&n.isCacheEnabled))try{u==null||u.classList.add("sendbird__offline"),t.info("Added class sendbird__offline to body")}catch{}else try{u==null||u.classList.remove("sendbird__offline"),t.info("Removed class sendbird__offline from body")}catch{}},[a,n==null?void 0:n.isCacheEnabled]),a}var Z4=2e3;function HS(n){var t=n.logger,e=n.timeout,r=n.cb,i=[],a=null,s=function(o){var l=i.find(function(c){return c.url===o.url});if(l?t.info("Channel: Mark as read already in queue",{channel:o}):i.push(o),!a){var d=i.shift();d&&r(d),a=setInterval(function(){if(i.length===0&&a){clearInterval(a),a=null;return}var c=i.shift();c&&r(c)},e||Z4)}},u=function(){i=[],a&&(clearInterval(a),a=null)};return{push:s,clear:u,getQueue:function(){return i}}}function Rm(n,t){t===void 0&&(t=[]),N.useLayoutEffect(function(){return function(){n()}},t)}function J4(n,t){var e=this,r=n.isConnected,i=t.logger,a=N.useMemo(function(){return HS({logger:i,cb:function(s){return Nt(e,void 0,void 0,function(){var u;return It(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,s.markAsDelivered()];case 1:return o.sent(),[3,3];case 2:return u=o.sent(),i.warning("Channel: Mark as delivered failed",{channel:s,error:u}),[3,3];case 3:return[2]}})})}})},[]);return N.useEffect(function(){r||a.clear()},[r]),Rm(function(){a.clear()}),a}var eP=function(n){var t={};return{__getTopics:function(){return t},subscribe:function(e,r){var i;return(i=t[e])!==null&&i!==void 0||(t[e]=new Set),t[e].add(r),{remove:function(){t[e].delete(r)}}},publish:function(e,r){t[e]&&t[e].forEach(function(i){setTimeout(function(){return i(r!==void 0?r:{})},0)})}}},nP={"--sendbird-dark-primary-500":"#4d2aa6","--sendbird-dark-primary-400":"#6440C4","--sendbird-dark-primary-300":"#7B53EF","--sendbird-dark-primary-200":"#9E8CF5","--sendbird-dark-primary-100":"#E2DFFF","--sendbird-dark-secondary-500":"#007A7A","--sendbird-dark-secondary-400":"#189A8D","--sendbird-dark-secondary-300":"#2EBA9F","--sendbird-dark-secondary-200":"#6FD6BE","--sendbird-dark-secondary-100":"#AEF2DC","--sendbird-dark-information-100":"#b2d9ff","--sendbird-dark-error-500":"#A30E2D","--sendbird-dark-error-400":"#C11F41","--sendbird-dark-error-300":"#E53157","--sendbird-dark-error-200":"#FF6183","--sendbird-dark-error-100":"#FFABBD","--sendbird-dark-background-700":"#000000","--sendbird-dark-background-600":"#161616","--sendbird-dark-background-500":"#2C2C2C","--sendbird-dark-background-400":"#393939","--sendbird-dark-background-300":"#A8A8A8","--sendbird-dark-background-200":"#D9D9D9","--sendbird-dark-background-100":"#F0F0F0","--sendbird-dark-background-50":"#FFFFFF","--sendbird-dark-overlay":"rgba(0, 0, 0, 0.32)","--sendbird-dark-onlight-01":"rgba(0, 0, 0, 0.88)","--sendbird-dark-onlight-02":"rgba(0, 0, 0, 0.50)","--sendbird-dark-onlight-03":"rgba(0, 0, 0, 0.38)","--sendbird-dark-onlight-04":"rgba(0, 0, 0, 0.12)","--sendbird-dark-ondark-01":"rgba(255, 255, 255, 0.88)","--sendbird-dark-ondark-02":"rgba(255, 255, 255, 0.50)","--sendbird-dark-ondark-03":"rgba(255, 255, 255, 0.38)","--sendbird-dark-ondark-04":"rgba(255, 255, 255, 0.12)","--sendbird-dark-shadow-01":"0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-02":"0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-03":"0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-04":"0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12)","--sendbird-dark-shadow-message-input":"0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12)","--sendbird-light-primary-500":"#4d2aa6","--sendbird-light-primary-400":"#6440C4","--sendbird-light-primary-300":"#7B53EF","--sendbird-light-primary-200":"#9E8CF5","--sendbird-light-primary-100":"#E2DFFF","--sendbird-light-secondary-500":"#007A7A","--sendbird-light-secondary-400":"#189A8D","--sendbird-light-secondary-300":"#2EBA9F","--sendbird-light-secondary-200":"#6FD6BE","--sendbird-light-secondary-100":"#AEF2DC","--sendbird-light-information-100":"#b2d9ff","--sendbird-light-error-500":"#A30E2D","--sendbird-light-error-400":"#C11F41","--sendbird-light-error-300":"#E53157","--sendbird-light-error-200":"#FF6183","--sendbird-light-error-100":"#FFABBD","--sendbird-light-background-700":"#000000","--sendbird-light-background-600":"#161616","--sendbird-light-background-500":"#2C2C2C","--sendbird-light-background-400":"#393939","--sendbird-light-background-300":"#A8A8A8","--sendbird-light-background-200":"#D9D9D9","--sendbird-light-background-100":"#F0F0F0","--sendbird-light-background-50":" #FFFFFF","--sendbird-light-overlay":"rgba(0, 0, 0, 0.32)","--sendbird-light-onlight-01":"rgba(0, 0, 0, 0.88)","--sendbird-light-onlight-02":"rgba(0, 0, 0, 0.50)","--sendbird-light-onlight-03":"rgba(0, 0, 0, 0.38)","--sendbird-light-onlight-04":"rgba(0, 0, 0, 0.12)","--sendbird-light-ondark-01":"rgba(255, 255, 255, 0.88)","--sendbird-light-ondark-02":"rgba(255, 255, 255, 0.50)","--sendbird-light-ondark-03":"rgba(255, 255, 255, 0.38)","--sendbird-light-ondark-04":"rgba(255, 255, 255, 0.12)","--sendbird-light-shadow-01":"0 1px 5px 0 rgba(33, 34, 66, 0.04), 0 0 3px 0 rgba(0, 0, 0, 0.08), 0 2px 1px 0 rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-02":"0 3px 5px -3px rgba(33, 34, 66, 0.04), 0 3px 14px 2px rgba(0, 0, 0, 0.08), 0 8px 10px 1px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-03":"0 6px 10px -5px rgba(0, 0, 0, 0.04), 0 6px 30px 5px rgba(0, 0, 0, 0.08), 0 16px 24px 2px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-04":"0 9px 15px -7px rgba(0, 0, 0, 0.04), 0 9px 46px 8px rgba(0, 0, 0, 0.08), 0 24px 38px 3px rgba(0, 0, 0, 0.12)","--sendbird-light-shadow-message-input":"0 1px 5px 0 rgba(33, 34, 66, 0.12), 0 0 1px 0 rgba(33, 34, 66, 0.16), 0 2px 1px 0 rgba(33, 34, 66, 0.08), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},tP=function(n){if(n==null)return!0;for(var t in n)if(n.hasOwnProperty(t))return!1;return JSON.stringify(n)===JSON.stringify({})},rP=function(n){N.useLayoutEffect(function(){if(!tP(n)){var t=G(G({},nP),_D(n));_a({variables:t})}},[n])},$i={INIT_SDK:"INIT_SDK",SET_SDK_LOADING:"SET_SDK_LOADING",RESET_SDK:"RESET_SDK",SDK_ERROR:"SDK_ERROR"},BS={initialized:!1,loading:!1,sdk:{},error:!1};function iP(n,t){return cr(t).with({type:$i.SET_SDK_LOADING},function(e){var r=e.payload;return G(G({},n),{initialized:!1,loading:r})}).with({type:$i.SDK_ERROR},function(){return G(G({},n),{initialized:!1,loading:!1,error:!0})}).with({type:$i.INIT_SDK},function(e){var r=e.payload;return{sdk:r,initialized:!0,loading:!1,error:!1}}).with({type:$i.RESET_SDK},function(){return BS}).otherwise(function(){return n})}var GS={initialized:!1,loading:!1,user:{}};function aP(n,t){return cr(t).with({type:Qa.INIT_USER},function(e){var r=e.payload;return{initialized:!0,loading:!1,user:r}}).with({type:Qa.RESET_USER},function(){return GS}).with({type:Qa.UPDATE_USER_INFO},function(e){var r=e.payload;return G(G({},n),{user:r})}).otherwise(function(){return n})}var Va={INITIALIZE_MESSAGE_TEMPLATES_INFO:"INITIALIZE_MESSAGE_TEMPLATES_INFO",UPSERT_MESSAGE_TEMPLATES:"UPSERT_MESSAGE_TEMPLATES",UPSERT_WAITING_TEMPLATE_KEYS:"UPSERT_WAITING_TEMPLATE_KEYS",MARK_ERROR_WAITING_TEMPLATE_KEYS:"MARK_ERROR_WAITING_TEMPLATE_KEYS"};function sP(n,t){return cr(t).with({type:Va.INITIALIZE_MESSAGE_TEMPLATES_INFO},function(e){var r=e.payload;return{messageTemplatesInfo:r,waitingTemplateKeysMap:{}}}).with({type:Va.UPSERT_MESSAGE_TEMPLATES},function(e){var r=e.payload,i=n.messageTemplatesInfo;if(!i)return n;var a=G({},n.waitingTemplateKeysMap);return r.forEach(function(s){var u=s.key,o=s.template;i.templatesMap[u]=o,delete a[u]}),G(G({},n),{waitingTemplateKeysMap:a,messageTemplatesInfo:i})}).with({type:Va.UPSERT_WAITING_TEMPLATE_KEYS},function(e){var r=e.payload,i=r.keys,a=r.requestedAt,s=G({},n.waitingTemplateKeysMap);return i.forEach(function(u){var o,l;s[u]={erroredMessageIds:(l=(o=s[u])===null||o===void 0?void 0:o.erroredMessageIds)!==null&&l!==void 0?l:[],requestedAt:a}}),G(G({},n),{waitingTemplateKeysMap:s})}).with({type:Va.MARK_ERROR_WAITING_TEMPLATE_KEYS},function(e){var r=e.payload,i=r.keys,a=r.messageId,s=G({},n.waitingTemplateKeysMap);return i.forEach(function(u){var o=s[u];o&&o.erroredMessageIds.indexOf(a)===-1&&o.erroredMessageIds.push(a)}),G(G({},n),{waitingTemplateKeysMap:s})}).otherwise(function(){return n})}var uP={waitingTemplateKeysMap:{}};function VS(n){return Nt(this,arguments,void 0,function(t){var e=t.sdkDispatcher,r=t.userDispatcher,i=t.sdk;return It(this,function(a){return[2,new Promise(function(s){e({type:$i.SET_SDK_LOADING,payload:!0}),i!=null&&i.disconnectWebSocket?i.disconnectWebSocket().then(function(){e({type:$i.RESET_SDK}),r({type:Qa.RESET_USER})}).finally(function(){s(!0)}):s(!0)})]})})}var _f="3.15.10",oP=$i.INIT_SDK,lP=$i.SET_SDK_LOADING,dP=$i.RESET_SDK,ly=$i.SDK_ERROR,cP=Qa.INIT_USER,fP=Qa.UPDATE_USER_INFO,hP=Qa.RESET_USER;function pP(n){var t=n.userId,e=n.appId;return"SendbirdProvider | useConnect/setupConnection/Connection failed UserId: ".concat(t," or appId: ").concat(e," missing")}function mP(n){return"SendbirdProvider | useConnect/setupConnection/Connection failed. ".concat((n==null?void 0:n.code)||""," ").concat((n==null?void 0:n.message)||"")}function _P(n){return Nt(this,arguments,void 0,function(t){var e,r=this,i,a,s=t.logger,u=t.sdkDispatcher,o=t.userDispatcher,l=t.initDashboardConfigs,d=t.userId,c=t.appId,f=t.isNewApp,h=t.customApiHost,m=t.customWebSocketHost,_=t.configureSession,E=t.nickname,b=t.profileUrl,g=t.accessToken,C=t.isUserIdUsedForNickname,S=t.sdkInitParams,A=t.customExtensionParams,I=t.isMobile,T=I===void 0?!1:I,M=t.eventHandlers,O=t.initializeMessageTemplatesInfo;return It(this,function(R){return(i=s.info)===null||i===void 0||i.call(s,"SendbirdProvider | useConnect/setupConnection/init",{userId:d,appId:c}),u({type:lP,payload:!0}),!d||!c?(e=pP({userId:d,appId:c}),(a=s.error)===null||a===void 0||a.call(s,e),u({type:ly}),[2,Promise.reject(e)]):[2,new Promise(function(U,P){var L;(L=s.info)===null||L===void 0||L.call(s,"SendbirdProvider | useConnect/setupConnection/connect connecting using ".concat(g??d));var F=gP({appId:c,customApiHost:h,customWebSocketHost:m,isNewApp:f,sdkInitParams:S}),B=typeof _=="function"?_(F):void 0;EP(F,{logger:s,sessionHandler:B,customExtensionParams:A,isMobile:T}),F.connect(d,g).then(function($){return V($)}).catch(function($){return Nt(r,void 0,void 0,function(){var q,se,Y,ce;return It(this,function(X){switch(X.label){case 0:if(!(yP($)&&B))return[3,6];X.label=1;case 1:return X.trys.push([1,5,,6]),[4,new Promise(B.onSessionTokenRequired)];case 2:return q=X.sent(),q?((ce=s.info)===null||ce===void 0||ce.call(s,"SendbirdProvider | useConnect/setupConnection/connect retry connect with valid session token: ".concat(q.slice(0,10)+"...")),[4,F.connect(d,q)]):[3,4];case 3:return se=X.sent(),[2,V(se)];case 4:return[3,6];case 5:return Y=X.sent(),Y instanceof H?[2,K(Y)]:[3,6];case 6:return[2,K($)]}})})});var V=function($){return Nt(r,void 0,void 0,function(){var q,se,Y,ce,X,Se,te,be,xe,Pe,vn,on;return It(this,function(je){switch(je.label){case 0:(X=s.info)===null||X===void 0||X.call(s,"SendbirdProvider | useConnect/setupConnection/onConnected",$),u({type:oP,payload:F}),o({type:cP,payload:$}),je.label=1;case 1:return je.trys.push([1,3,,4]),[4,O(F)];case 2:return je.sent(),[3,4];case 3:return q=je.sent(),(Se=s.error)===null||Se===void 0||Se.call(s,"SendbirdProvider | useConnect/setupConnection/upsertMessageTemplateListInLocalStorage failed",{error:q}),[3,4];case 4:return je.trys.push([4,6,,7]),[4,l(F)];case 5:return je.sent(),(te=s.info)===null||te===void 0||te.call(s,"SendbirdProvider | useConnect/setupConnection/getUIKitConfiguration success"),[3,7];case 6:return se=je.sent(),(be=s.error)===null||be===void 0||be.call(s,"SendbirdProvider | useConnect/setupConnection/getUIKitConfiguration failed",{error:se}),[3,7];case 7:return je.trys.push([7,10,,11]),(E!==$.nickname||b!==$.profileUrl)&&!(gg(E)&&gg(b))?((xe=s.info)===null||xe===void 0||xe.call(s,"SendbirdProvider | useConnect/setupConnection/updateCurrentUserInfo",{nickname:E,profileUrl:b}),Y={nickname:E||$.nickname||(C?$.userId:""),profileUrl:b||$.profileUrl},[4,F.updateCurrentUserInfo(Y)]):[3,9];case 8:ce=je.sent(),(Pe=s.info)===null||Pe===void 0||Pe.call(s,"SendbirdProvider | useConnect/setupConnection/updateCurrentUserInfo success",Y),o({type:fP,payload:ce}),je.label=9;case 9:return[3,11];case 10:return je.sent(),[3,11];case 11:return U(),(on=(vn=M==null?void 0:M.connection)===null||vn===void 0?void 0:vn.onConnected)===null||on===void 0||on.call(vn,$),[2]}})})},K=function($){return Nt(r,void 0,void 0,function(){var q,se,Y,ce,X;return It(this,function(Se){switch(Se.label){case 0:return F.isCacheEnabled&&vP($)?((se=s.error)===null||se===void 0||se.call(s,"SendbirdProvider | useConnect/setupConnection/connect clear cache [".concat($.code,"/").concat($.message,"]")),[4,F.clearCachedData()]):[3,2];case 1:Se.sent(),Se.label=2;case 2:return q=mP($),(Y=s.error)===null||Y===void 0||Y.call(s,q,{e:$,appId:c,userId:d}),o({type:hP}),u({type:dP}),u({type:ly}),P(q),(X=(ce=M==null?void 0:M.connection)===null||ce===void 0?void 0:ce.onFailed)===null||X===void 0||X.call(ce,$),[2]}})})}})]})})}function gP(n){var t=n.appId,e=n.isNewApp,r=e===void 0?!1:e,i=n.customApiHost,a=n.customWebSocketHost,s=n.sdkInitParams,u=s===void 0?{}:s,o=Object.assign({},{appId:t,modules:[new cC,new XR],newInstance:r,localCacheEnabled:!0},u);return i&&(o.customApiHost=i),a&&(o.customWebSocketHost=a),Qb.init(o)}function EP(n,t){var e,r,i=t.logger,a=t.sessionHandler,s=t.isMobile,u=t.customExtensionParams;(e=i.info)===null||e===void 0||e.call(i,"SendbirdProvider | useConnect/setupConnection/setVersion",{version:_f}),n.addExtension("sb_uikit",_f),n.addSendbirdExtensions([{product:Cf.UIKIT_CHAT,version:_f,platform:As==null?void 0:As.JS}],{platform:s?Fa.MOBILE_WEB:Fa.WEB},u),a&&((r=i.info)===null||r===void 0||r.call(i,"SendbirdProvider | useConnect/setupConnection/configureSession",a),n.setSessionHandler(a))}function vP(n){return n instanceof H?[Ne.USER_AUTH_DEACTIVATED,Ne.USER_AUTH_DELETED_OR_NOT_FOUND,Ne.SESSION_TOKEN_EXPIRED,Ne.SESSION_REVOKED].includes(n.code):!1}function yP(n){return n instanceof H?[Ne.SESSION_TOKEN_EXPIRED,Ne.INVALID_TOKEN].includes(n.code):!1}function dy(n){return Nt(this,arguments,void 0,function(t){var e=t.logger,r=t.sdkDispatcher,i=t.userDispatcher,a=t.appInfoDispatcher,s=t.initDashboardConfigs,u=t.userId,o=t.appId,l=t.isNewApp,d=l===void 0?!1:l,c=t.customApiHost,f=t.customWebSocketHost,h=t.configureSession,m=t.nickname,_=t.profileUrl,E=t.accessToken,b=t.sdk,g=t.sdkInitParams,C=t.customExtensionParams,S=t.isMobile,A=t.eventHandlers,I=t.isUserIdUsedForNickname,T=t.initializeMessageTemplatesInfo;return It(this,function(M){switch(M.label){case 0:return[4,VS({logger:e,sdkDispatcher:r,userDispatcher:i,sdk:b})];case 1:return M.sent(),[4,_P({logger:e,sdkDispatcher:r,userDispatcher:i,appInfoDispatcher:a,initDashboardConfigs:s,userId:u,appId:o,isNewApp:d,customApiHost:c,customWebSocketHost:f,configureSession:h,nickname:m,profileUrl:_,accessToken:E,sdkInitParams:g,customExtensionParams:C,isMobile:S,eventHandlers:A,isUserIdUsedForNickname:I,initializeMessageTemplatesInfo:T})];case 2:return M.sent(),[2]}})})}function bP(n,t){var e=this,r=n.userId,i=n.appId,a=n.accessToken,s=n.isMobile,u=n.isUserIdUsedForNickname,o=t.logger,l=t.nickname,d=t.profileUrl,c=t.configureSession,f=t.customApiHost,h=t.customWebSocketHost,m=t.sdk,_=t.sdkDispatcher,E=t.userDispatcher,b=t.appInfoDispatcher,g=t.initDashboardConfigs,C=t.sdkInitParams,S=t.customExtensionParams,A=t.eventHandlers,I=t.initializeMessageTemplatesInfo,T=N.useRef({appId:"",userId:""});N.useEffect(function(){var O;(O=o==null?void 0:o.info)===null||O===void 0||O.call(o,"SendbirdProvider | useConnect/useEffect",{userId:r,appId:i,accessToken:a});var R=T.current.appId!==i;T.current.appId===i&&T.current.userId===r||(T.current={appId:i,userId:r},dy({userId:r,appId:i,isNewApp:R,accessToken:a,logger:o,nickname:l,profileUrl:d,configureSession:c,customApiHost:f,customWebSocketHost:h,sdk:m,sdkDispatcher:_,userDispatcher:E,appInfoDispatcher:b,initDashboardConfigs:g,isUserIdUsedForNickname:u,sdkInitParams:C,customExtensionParams:S,isMobile:s,eventHandlers:A,initializeMessageTemplatesInfo:I}).catch(function(U){var P;(P=o==null?void 0:o.error)===null||P===void 0||P.call(o,"SendbirdProvider | useConnect/useEffect",U)}))},[r,i]);var M=N.useCallback(function(){return Nt(e,void 0,void 0,function(){var O,R,U;return It(this,function(P){switch(P.label){case 0:(R=o==null?void 0:o.info)===null||R===void 0||R.call(o,"SendbirdProvider | useConnect/reconnect/useCallback",{sdk:m}),P.label=1;case 1:return P.trys.push([1,3,,4]),[4,dy({userId:r,appId:i,accessToken:a,logger:o,nickname:l,profileUrl:d,configureSession:c,customApiHost:f,customWebSocketHost:h,sdk:m,sdkDispatcher:_,userDispatcher:E,appInfoDispatcher:b,initDashboardConfigs:g,isUserIdUsedForNickname:u,sdkInitParams:C,customExtensionParams:S,isMobile:s,eventHandlers:A,initializeMessageTemplatesInfo:I})];case 2:return P.sent(),[3,4];case 3:return O=P.sent(),(U=o==null?void 0:o.error)===null||U===void 0||U.call(o,"SendbirdProvider | useConnect/reconnect/useCallback",O),[3,4];case 4:return[2]}})})},[m]);return M}var Xr={DEBUG:"debug",WARNING:"warning",ERROR:"error",INFO:"info",ALL:"all"},CP=function(n){switch(n){case Xr.WARNING:return"color: Orange";case Xr.ERROR:return"color: Red";default:return"color: Gray"}},SP=function(n){var t=n.level,e=n.title,r=n.description,i=r===void 0?"":r,a=n.payload,s=a===void 0?[]:a;console.log.apply(console,Ce(["%c SendbirdUIKit | ".concat(t," | ").concat(new Date().toISOString()," | ").concat(e," ").concat(i&&"|"),CP(t),i],s,!1))},TP=function(){return{info:ot,error:ot,warning:ot}},cy=function(n,t){var e=SP,r=Array.isArray(n)?n:[n],i=function(a){return function(s,u){for(var o=[],l=2;l<arguments.length;l++)o[l-2]=arguments[l];return e({level:a,title:s,description:u,payload:o})}};return r.reduce(function(a,s){return s===Xr.DEBUG||s===Xr.ALL?G(G({},a),{info:i(Xr.INFO),error:i(Xr.ERROR),warning:i(Xr.WARNING)}):s===Xr.INFO?G(G({},a),{info:i(Xr.INFO)}):s===Xr.ERROR?G(G({},a),{error:i(Xr.ERROR)}):s===Xr.WARNING?G(G({},a),{warning:i(Xr.WARNING)}):G({},a)},TP())},NP=function(n){var t=n.children;return p.createElement(iD,null,p.createElement(yD,null,t))};function IP(n){var t,e,r,i,a,s,u,o,l,d,c,f,h,m,_,E,b,g,C,S,A,I,T,M,O,R,U,P,L,F,B,V,K=n.legacyConfig,$=n.uikitOptions,q=$===void 0?{}:$,se=K.replyType,Y=K.isMentionEnabled,ce=K.isReactionEnabled,X=K.disableUserProfile,Se=K.isVoiceMessageEnabled,te=K.isTypingIndicatorEnabledOnChannelList,be=K.isMessageReceiptStatusEnabledOnChannelList,xe=K.showSearchIcon;return{common:{enableUsingDefaultUserProfile:(e=(t=q.common)===null||t===void 0?void 0:t.enableUsingDefaultUserProfile)!==null&&e!==void 0?e:typeof X=="boolean"?!X:void 0},groupChannel:{enableOgtag:(r=q.groupChannel)===null||r===void 0?void 0:r.enableOgtag,enableMention:(a=(i=q.groupChannel)===null||i===void 0?void 0:i.enableMention)!==null&&a!==void 0?a:Y,enableReactions:(u=(s=q.groupChannel)===null||s===void 0?void 0:s.enableReactions)!==null&&u!==void 0?u:ce,enableReactionsSupergroup:(o=q.groupChannel)===null||o===void 0?void 0:o.enableReactionsSupergroup,enableTypingIndicator:(l=q.groupChannel)===null||l===void 0?void 0:l.enableTypingIndicator,enableVoiceMessage:(c=(d=q.groupChannel)===null||d===void 0?void 0:d.enableVoiceMessage)!==null&&c!==void 0?c:Se,replyType:(h=(f=q.groupChannel)===null||f===void 0?void 0:f.replyType)!==null&&h!==void 0?h:se!=null?gm(se).lowerCase:void 0,threadReplySelectType:(m=q.groupChannel)===null||m===void 0?void 0:m.threadReplySelectType,input:{enableDocument:(E=(_=q.groupChannel)===null||_===void 0?void 0:_.input)===null||E===void 0?void 0:E.enableDocument},typingIndicatorTypes:(b=q.groupChannel)===null||b===void 0?void 0:b.typingIndicatorTypes,enableFeedback:(g=q.groupChannel)===null||g===void 0?void 0:g.enableFeedback,enableSuggestedReplies:(C=q.groupChannel)===null||C===void 0?void 0:C.enableSuggestedReplies,showSuggestedRepliesFor:(S=q.groupChannel)===null||S===void 0?void 0:S.showSuggestedRepliesFor,suggestedRepliesDirection:(A=q.groupChannel)===null||A===void 0?void 0:A.suggestedRepliesDirection,enableMarkdownForUserMessage:(I=q.groupChannel)===null||I===void 0?void 0:I.enableMarkdownForUserMessage,enableFormTypeMessage:(T=q.groupChannel)===null||T===void 0?void 0:T.enableFormTypeMessage},groupChannelList:{enableTypingIndicator:(O=(M=q.groupChannelList)===null||M===void 0?void 0:M.enableTypingIndicator)!==null&&O!==void 0?O:te,enableMessageReceiptStatus:(U=(R=q.groupChannelList)===null||R===void 0?void 0:R.enableMessageReceiptStatus)!==null&&U!==void 0?U:be},groupChannelSettings:{enableMessageSearch:(L=(P=q.groupChannelSettings)===null||P===void 0?void 0:P.enableMessageSearch)!==null&&L!==void 0?L:xe},openChannel:{enableOgtag:(F=q.openChannel)===null||F===void 0?void 0:F.enableOgtag,input:{enableDocument:(V=(B=q.openChannel)===null||B===void 0?void 0:B.input)===null||V===void 0?void 0:V.enableDocument}}}}function AP(n,t){var e=n.isConnected,r=t.logger,i=N.useMemo(function(){return HS({logger:r,cb:function(a){try{a.markAsRead()}catch(s){r.warning("Channel: Mark as delivered failed",{channel:a,error:s})}}})},[]);return N.useEffect(function(){e||i.clear()},[e]),Rm(function(){i.clear()}),i}var MP={getItem:function(n){return Nt(this,void 0,void 0,function(){var t;return It(this,function(e){return[2,(t=localStorage.getItem(n))!==null&&t!==void 0?t:null]})})},setItem:function(n,t){return Nt(this,void 0,void 0,function(){return It(this,function(e){return[2,localStorage.setItem(n,t)]})})}},jS=function(n){return{version:Number(n.ui_template.version),uiTemplate:JSON.stringify(n.ui_template.body.items),colorVariables:n.color_variables}},fy=function(n){var t={};return n.forEach(function(e){t[e.key]=jS(e)}),t},wP=20,hy=Va.INITIALIZE_MESSAGE_TEMPLATES_INFO,OP=Va.UPSERT_MESSAGE_TEMPLATES,RP=Va.UPSERT_WAITING_TEMPLATE_KEYS,DP=Va.MARK_ERROR_WAITING_TEMPLATE_KEYS;function LP(n){var t=this,e=n.sdk,r=n.logger,i=n.appInfoStore,a=n.appInfoDispatcher,s=i==null?void 0:i.messageTemplatesInfo,u=function(c){var f,h;if(!s)return null;var m=null,_=(f=s==null?void 0:s.templatesMap)!==null&&f!==void 0?f:null;return _&&(m=(h=_[c])!==null&&h!==void 0?h:null),m},o=function(c){return Nt(t,void 0,void 0,function(){var f,h,m,_;return It(this,function(E){switch(E.label){case 0:f=!0,h=null,m=[],E.label=1;case 1:return f?[4,c.message.getMessageTemplatesByToken(h,{limit:wP})]:[3,3];case 2:return _=E.sent(),f=_.hasMore,h=_.token,_.templates.forEach(function(b){m.push(JSON.parse(b.template))}),[3,1];case 3:return[2,m]}})})},l=function(c){return Nt(t,void 0,void 0,function(){var f,h,m,_,E,_,E,b;return It(this,function(g){switch(g.label){case 0:return f=(b=c.appInfo)===null||b===void 0?void 0:b.messageTemplateInfo.token,f?(h=localStorage.getItem(Wc),m=localStorage.getItem(Js),!h||h!==f?[4,o(c)]:[3,2]):(localStorage.removeItem(Wc),localStorage.removeItem(Js),[2]);case 1:return _=g.sent(),E={token:f,templatesMap:fy(_)},a({type:hy,payload:E}),localStorage.setItem(Wc,f),localStorage.setItem(Js,JSON.stringify(_)),[3,3];case 2:h&&h===f&&m&&(_=JSON.parse(m),E={token:f,templatesMap:fy(_)},a({type:hy,payload:E})),g.label=3;case 3:return[2]}})})},d=function(c,f,h){return Nt(t,void 0,void 0,function(){var m,_,E,b,g,C,S,A,I;return It(this,function(T){switch(T.label){case 0:if(!a)return[3,7];a({type:RP,payload:{keys:c,requestedAt:h}}),m=[],T.label=1;case 1:T.trys.push([1,5,,6]),_=!0,E=null,T.label=2;case 2:return _?[4,e.message.getMessageTemplatesByToken(E,{keys:c})]:[3,4];case 3:return b=T.sent(),b.templates.forEach(function(M){m.push(JSON.parse(M.template))}),_=b.hasMore,E=b.token,[3,2];case 4:return[3,6];case 5:return g=T.sent(),(I=r==null?void 0:r.error)===null||I===void 0||I.call(r,"Sendbird | fetchProcessedMessageTemplates failed",g,c),[3,6];case 6:m.length>0?(C=localStorage.getItem(Js),C?(S=JSON.parse(C),A=S.map(function(M){return M.key}),m.forEach(function(M){A.includes(M.key)||S.push(M)}),localStorage.setItem(Js,JSON.stringify(S))):localStorage.setItem(Js,JSON.stringify([m])),a({type:OP,payload:m.map(function(M){return{key:M.key,template:jS(M)}})})):a({type:DP,payload:{keys:c,messageId:f}}),T.label=7;case 7:return[2]}})})};return{getCachedTemplate:u,updateMessageTemplatesInfo:d,initializeMessageTemplatesInfo:l}}var UP=function(n){N.useEffect(function(){var t=document.getElementById($l);t.parentElement.dir=n},[n])};function kP(n){var t=IP({legacyConfig:{replyType:n.replyType,isMentionEnabled:n.isMentionEnabled,isReactionEnabled:n.isReactionEnabled,disableUserProfile:n.disableUserProfile,isVoiceMessageEnabled:n.isVoiceMessageEnabled,isTypingIndicatorEnabledOnChannelList:n.isTypingIndicatorEnabledOnChannelList,isMessageReceiptStatusEnabledOnChannelList:n.isMessageReceiptStatusEnabledOnChannelList,showSearchIcon:n.showSearchIcon},uikitOptions:n.uikitOptions});return p.createElement(Hw,{storage:MP,localConfigs:{common:t==null?void 0:t.common,groupChannel:{channel:t==null?void 0:t.groupChannel,channelList:t==null?void 0:t.groupChannelList,setting:t==null?void 0:t.groupChannelSettings},openChannel:{channel:t==null?void 0:t.openChannel}}},p.createElement(xP,G({},n)))}var xP=function(n){var t,e,r,i=n.appId,a=n.userId,s=n.children,u=n.accessToken,o=n.customApiHost,l=n.customWebSocketHost,d=n.configureSession,c=n.theme,f=c===void 0?"light":c,h=n.config,m=h===void 0?{}:h,_=n.nickname,E=_===void 0?"":_,b=n.colorSet,g=n.stringSet,C=n.dateLocale,S=n.profileUrl,A=S===void 0?"":S,I=n.voiceRecord,T=n.userListQuery,M=n.imageCompression,O=M===void 0?{}:M,R=n.allowProfileEdit,U=R===void 0?!1:R,P=n.disableMarkAsDelivered,L=P===void 0?!1:P,F=n.renderUserProfile,B=n.onUserProfileMessage,V=n.onStartDirectMessage,K=n.breakpoint,$=K===void 0?!1:K,q=n.isUserIdUsedForNickname,se=q===void 0?!0:q,Y=n.sdkInitParams,ce=n.customExtensionParams,X=n.isMultipleFilesMessageEnabled,Se=X===void 0?!1:X,te=n.eventHandlers,be=n.htmlTextDirection,xe=be===void 0?"ltr":be,Pe=n.forceLeftToRightMessageLayout,vn=Pe===void 0?!1:Pe,on=V??B,je=m.logLevel,Xe=je===void 0?"":je,sn=m.userMention,un=sn===void 0?{}:sn,En=m.isREMUnitEnabled,rn=En===void 0?!1:En,qe=m.pubSub,Je=Nr().isMobile,ln=N.useState(cy(Xe)),dn=ln[0],ve=ln[1],De=N.useState(function(){return qe??eP()})[0],Ye=N.useReducer(iP,BS),en=Ye[0],fn=Ye[1],Fe=N.useReducer(aP,GS),Nn=Fe[0],nn=Fe[1],_e=N.useReducer(sP,uP),zn=_e[0],Rn=_e[1],bn=Bw(),Ge=bn.configs,cn=bn.configsWithAppAttr,On=bn.initDashboardConfigs,Ln=en.initialized,In=en==null?void 0:en.sdk,et=(t=In==null?void 0:In.appInfo)!==null&&t!==void 0?t:{},Gn=et.uploadSizeLimit,Cn=et.multipleFilesMessageFileCountLimit;rP(b);var mn=LP({sdk:In,logger:dn,appInfoStore:zn,appInfoDispatcher:Rn}),ze=mn.getCachedTemplate,ue=mn.updateMessageTemplatesInfo,Q=mn.initializeMessageTemplatesInfo,Te={updateMessageTemplatesInfo:ue,getCachedTemplate:ze},He=bP({appId:i,userId:a,accessToken:u,isUserIdUsedForNickname:se,isMobile:Je},{logger:dn,nickname:E,profileUrl:A,configureSession:d,customApiHost:o,customWebSocketHost:l,sdkInitParams:Y,customExtensionParams:ce,sdk:In,sdkDispatcher:fn,userDispatcher:nn,appInfoDispatcher:Rn,initDashboardConfigs:On,eventHandlers:te,initializeMessageTemplatesInfo:Q});Rm(function(){typeof In.disconnect=="function"&&VS({logger:dn,sdkDispatcher:fn,userDispatcher:nn,sdk:In})},[In.disconnectWebSocket]),N.useEffect(function(){ve(cy(Xe))},[Xe]);var $e=N.useState(f),Ee=$e[0],fe=$e[1];N.useEffect(function(){fe(f)},[f]),N.useEffect(function(){var pe=document.querySelector("body");pe==null||pe.classList.remove("sendbird-experimental__rem__units"),rn&&(pe==null||pe.classList.add("sendbird-experimental__rem__units"))},[rn]),N.useEffect(function(){dn.info("Setup theme","Theme: ".concat(Ee));try{var pe=document.querySelector("body");pe==null||pe.classList.remove("sendbird-theme--light"),pe==null||pe.classList.remove("sendbird-theme--dark"),pe==null||pe.classList.add("sendbird-theme--".concat(Ee||"light")),dn.info("Finish setup theme")}catch(Le){dn.warning("Setup theme failed","".concat(Le))}return function(){try{var Le=document.querySelector("body");Le==null||Le.classList.remove("sendbird-theme--light"),Le==null||Le.classList.remove("sendbird-theme--dark")}catch{}}},[Ee]),UP(xe);var We=X4(en.sdk,dn),yn=AP({isConnected:We},{logger:dn}),Yn=J4({isConnected:We},{logger:dn}),Sn=p.useMemo(function(){return G(G({},Yp("en")),g)},[g]),rt=N.useMemo(function(){return Math.min(Xw,Cn??Number.MAX_SAFE_INTEGER)},[Cn]),Ct=N.useMemo(function(){return new CD({sdk:In,logger:dn})},[en.initialized]);return p.createElement(_C.Provider,{value:{stores:{sdkStore:en,userStore:Nn,appInfoStore:zn},dispatchers:{sdkDispatcher:fn,userDispatcher:nn,appInfoDispatcher:Rn,reconnect:He},config:{disableMarkAsDelivered:L,renderUserProfile:F,onStartDirectMessage:on,onUserProfileMessage:on,allowProfileEdit:U,isOnline:We,userId:a,appId:i,accessToken:u,theme:Ee,setCurrentTheme:fe,setCurrenttheme:fe,isMultipleFilesMessageEnabled:Se,uikitUploadSizeLimit:Gn??Zw,uikitMultipleFilesMessageLimit:rt,userListQuery:T,logger:dn,pubSub:De,imageCompression:G({compressionRate:.7,outputFormat:"preserve"},O),voiceRecord:{maxRecordingTime:(e=I==null?void 0:I.maxRecordingTime)!==null&&e!==void 0?e:qw,minRecordingTime:(r=I==null?void 0:I.minRecordingTime)!==null&&r!==void 0?r:vC},userMention:{maxMentionCount:(un==null?void 0:un.maxMentionCount)||10,maxSuggestionCount:(un==null?void 0:un.maxSuggestionCount)||15},markAsReadScheduler:yn,markAsDeliveredScheduler:Yn,common:Ge.common,groupChannel:{enableOgtag:Ln&&cn(In).groupChannel.channel.enableOgtag,enableTypingIndicator:Ge.groupChannel.channel.enableTypingIndicator,enableReactions:Ln&&cn(In).groupChannel.channel.enableReactions,enableMention:Ge.groupChannel.channel.enableMention,replyType:Ge.groupChannel.channel.replyType,threadReplySelectType:Ge.groupChannel.channel.threadReplySelectType,enableVoiceMessage:Ge.groupChannel.channel.enableVoiceMessage,enableDocument:Ge.groupChannel.channel.input.enableDocument,typingIndicatorTypes:Ge.groupChannel.channel.typingIndicatorTypes,enableFeedback:Ge.groupChannel.channel.enableFeedback,enableSuggestedReplies:Ge.groupChannel.channel.enableSuggestedReplies,showSuggestedRepliesFor:Ge.groupChannel.channel.showSuggestedRepliesFor,suggestedRepliesDirection:Ge.groupChannel.channel.suggestedRepliesDirection,enableMarkdownForUserMessage:Ge.groupChannel.channel.enableMarkdownForUserMessage,enableFormTypeMessage:Ge.groupChannel.channel.enableFormTypeMessage,enableReactionsSupergroup:Ln&&cn(In).groupChannel.channel.enableReactionsSupergroup},groupChannelList:{enableTypingIndicator:Ge.groupChannel.channelList.enableTypingIndicator,enableMessageReceiptStatus:Ge.groupChannel.channelList.enableMessageReceiptStatus},groupChannelSettings:{enableMessageSearch:Ln&&cn(In).groupChannel.setting.enableMessageSearch},openChannel:{enableOgtag:Ln&&cn(In).openChannel.channel.enableOgtag,enableDocument:Ge.openChannel.channel.input.enableDocument},disableUserProfile:!Ge.common.enableUsingDefaultUserProfile,isReactionEnabled:Ln&&cn(In).groupChannel.channel.enableReactions,isMentionEnabled:Ge.groupChannel.channel.enableMention,isVoiceMessageEnabled:Ge.groupChannel.channel.enableVoiceMessage,replyType:gm(Ge.groupChannel.channel.replyType).upperCase,isTypingIndicatorEnabledOnChannelList:Ge.groupChannel.channelList.enableTypingIndicator,isMessageReceiptStatusEnabledOnChannelList:Ge.groupChannel.channelList.enableMessageReceiptStatus,showSearchIcon:Ln&&cn(In).groupChannel.setting.enableMessageSearch,htmlTextDirection:xe,forceLeftToRightMessageLayout:vn},eventHandlers:te,emojiManager:Ct,utils:Te}},p.createElement(p3,{logger:dn,breakpoint:$},p.createElement(f3,{stringSet:Sn,dateLocale:C},p.createElement(NP,null,p.createElement(bD,null,s)))),p.createElement(hD,null),p.createElement(gD,null),p.createElement(fD,null))};function PP(){var $e;const{channelUrl:n}=KS(),t=$S(),[e,r]=N.useState([]),[i,a]=N.useState(""),[s,u]=N.useState(n||null),[o,l]=N.useState(null),[d,c]=N.useState(null),[f,h]=N.useState(null),[m,_]=N.useState(!1),[E,b]=N.useState(!0),[g,C]=N.useState(!0),[S,A]=N.useState(!1);N.useState("");const[I,T]=N.useState(!1),[M,O]=N.useState(!0),[R,U]=N.useState({}),P=N.useRef(null),L=N.useRef(null),F=N.useRef(null),B=window.localStorage.getItem("token")||"",V="AED40948-FDBF-4552-9062-8B2F35D974A3",K=localStorage.getItem("sendbird_user_id")||"testUser",$=localStorage.getItem("sendbird_access_token")||"",q=localStorage.getItem("nickname")||"Tester",se=localStorage.getItem("gender_type")||"",Y=localStorage.getItem("token")||"",[ce,X]=N.useState(null),[Se,te]=N.useState(!1),[be,xe]=N.useState(!1),[Pe,vn]=N.useState(""),[on,je]=N.useState(0),[Xe,sn]=N.useState(null),un={MESSAGE_INPUT_PLACEHOLDER:"請輸入訊息"};N.useEffect(()=>{En()},[V,K,$]);const En=async()=>{const Ee=Qb.init({appId:V,modules:[new cC]});Ee.connect(K,$).then(fe=>{console.log("已連接到 Sendbird Chat:",fe),X(Ee)}).catch(fe=>{console.error("連接 Sendbird Chat 失敗:",fe)}),ra.init(V),console.log(V,K,$),ra.authenticate({userId:K,accessToken:$}).then(()=>ra.connectWebSocket()).then(()=>{console.log("WebSocket 連接成功"),rn()}).catch(fe=>{console.error("Sendbird Calls 初始化失敗:",fe),ra.deauthenticate(),En()})};N.useEffect(()=>{(async()=>{if(!ce){console.warn("SendBirdChat 尚未初始化，等待 sbInstance...");return}if(!s){console.warn("沒有選擇的頻道，無法讀取訊息");return}try{console.log("正在獲取頻道：",s);const fe=await ce.groupChannel.getChannel(s);console.log("成功獲取頻道：",fe);const yn=await fe.createPreviousMessageListQuery().load(20);yn.length===0?console.log("此頻道沒有訊息！"):console.log("獲取的訊息：",yn)}catch(fe){console.error("讀取訊息失敗:",fe)}})()},[ce,s]),N.useEffect(()=>{(async()=>{if(!(!ce||!n))try{const We=(await ce.groupChannel.getChannel(n)).members.find(yn=>yn.userId!==K);We&&We.metaData&&We.metaData.user_id?(Rn(B,We.metaData.user_id),vn(We.metaData.user_id),l(We)):alert("該頻道不是 1 對 1 對話！")}catch(fe){console.error("取得頻道資訊失敗:",fe)}})()},[ce,n,K]),N.useEffect(()=>{console.log("useParams 取得的 channelUrl:",n),n?u(n):(console.warn("未取得有效的 channelUrl"),u(null))},[n]);const rn=()=>{ra.addListener("INCOMING_CALL_LISTENER",{onRinging:Ee=>{console.log("收到來電:",Ee),c(Ee)}})},qe=async Ee=>{if(!await zn(Ee)){alert("金額不足");return}if(!o){alert("找不到聊天對象，請確認這是 1 對 1 對話。");return}try{const We=await Uu.post("https://api.dageiwo.com/api/pay/purchase",{host_id:Pe,type:Ee==="voice"?"CALL":"VIDEO"},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),yn=We.data.data.purchase_id;if(console.log("購買ID:",yn),je(yn),We.status===200&&We.data.success){const Yn=await navigator.mediaDevices.getUserMedia({audio:!0,video:Ee==="video"?{facingMode:{ideal:M?"environment":"user"}}:!1});P.current&&(P.current.srcObject=Yn);const Sn={userId:o.userId,isVideoCall:Ee==="video",callOption:{localMediaView:P.current,remoteMediaView:L.current,audioEnabled:!0,videoEnabled:Ee==="video"}},rt=ra.dial(Sn);Je(rt,yn),h(rt),_(!0)}}catch(We){console.error("撥打通話時出現錯誤:",We)}},Je=(Ee,fe)=>{Ee.onConnected=()=>{console.log("通話已接通"),ve(fe),_(!1),Te()},Ee.onEstablished=()=>{console.log("媒體流已建立")};const We=()=>{De(),P.current&&P.current.srcObject&&(P.current.srcObject.getTracks().forEach(yn=>yn.stop()),P.current.srcObject=null),He(),h(null),_(!1),window.location.reload()};Ee.onEnded=We,Ee.onRemoteHangup=We,Ee.onError=yn=>{console.error("通話出現錯誤:",yn),_(!1)}},ln=()=>{d&&(d.accept({callOption:{localMediaView:P.current,remoteMediaView:L.current,audioEnabled:!0,videoEnabled:d.isVideoCall}}),Je(d),h(d),c(null))},dn=()=>{d&&(d.end(),c(null))},ve=Ee=>{_e(Ee);const fe=setInterval(()=>{_e(Ee)},3e3);sn(fe)},De=()=>{clearInterval(Xe),sn(null)},Ye=()=>{f&&(f.end(),P.current&&P.current.srcObject&&(P.current.srcObject.getTracks().forEach(Ee=>Ee.stop()),P.current.srcObject=null),h(null),_(!1))},en=()=>{f&&(E?f.muteMicrophone():f.unmuteMicrophone(),b(!E))},fn=()=>{f&&(g?f.stopVideo():f.startVideo(),C(!g))},Fe=()=>{F.current&&(I?document.exitFullscreen():F.current.requestFullscreen(),T(!I))},Nn=async()=>{const Ee=ra.getAvailableVideoInputDevices();console.log(Ee),r(Ee),A(!0);const fe=ra.getCurrentVideoInputDevice();a((fe==null?void 0:fe.deviceId)||"")},nn=Ee=>{const fe=Ee.target.value,We=e.find(yn=>yn.deviceId===fe);We&&(ra.selectVideoInputDevice(We),a(We.deviceId))},_e=async Ee=>{try{const fe=await Uu.post("https://api.dageiwo.com/api/pay/deposit_coins",{purchase_id:Ee},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(console.log("扣點 API 呼叫結果:",fe.data),fe.data.data==="coin_not_enough"){console.warn("點數不足，掛斷通話"),window.location.reload(),alert("您的點數不足，通話將自動結束，請前往儲值！"),Ye();return}else In(fe.data.data)}catch(fe){console.error("扣點 API 呼叫失敗:",fe)}},zn=async Ee=>{try{const fe=await Uu.get("https://api.dageiwo.com/api/pay/check_coin",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});return console.log("檢查金額 API 回傳:",fe.data),fe.data.success&&fe.data.data?(In(fe.data.data),Ee==="voice"?fe.data.data>R.call_coin:fe.data.data>R.video_coin):!1}catch(fe){return console.error("檢查金額 API 呼叫失敗:",fe),alert("查詢金額失敗，請稍後再試！"),!1}},Rn=async(Ee,fe)=>{try{const We=await Uu.get(`https://api.dageiwo.com/index/detail/${fe}`,{headers:{Authorization:`Bearer ${Ee}`}});if(We.status===200&&We.data.success){const yn=We.data.data;U(yn)}}catch(We){console.error("RetrieveInfo error:",We)}};N.useEffect(()=>{const Ee=document.querySelector(".sendbird-message-input--placeholder");Ee&&(Ee.innerHTML="每則訊息消耗 2金幣")},[]);const bn=Ee=>{const fe=Ee.trim();return fe?(Uu.post(`https://api.dageiwo.com/api/pay/message_subtract_coins?host_id=${R.id}`,{},{headers:{Authorization:`Bearer ${Y}`}}).catch(We=>{console.error("扣點失敗:",We)}),{message:fe}):null},Ge=async()=>{qe("voice"),te(!1)},cn=async()=>{qe("video"),xe(!1)},On=f&&f.isVideoCall;f&&f.isVideoCall;const[Ln,In]=N.useState(999),et=Ee=>{const fe=Math.floor(Ee/60),We=Ee%60,yn=fe<10?`0${fe}`:fe,Yn=We<10?`0${We}`:We;return`${yn}:${Yn}`},[Gn,Cn]=N.useState(0),[mn,ze]=N.useState(null),[ue,Q]=N.useState(null),Te=()=>{Q(new Date),Cn(0);const Ee=setInterval(()=>{Cn(fe=>fe+1)},1e3);ze(Ee)},He=()=>{mn&&clearInterval(mn),ze(null),Q(null),Cn(0)};return Ze.jsxs("div",{style:{height:"100vh",position:"relative"},children:[Ze.jsx(kP,{appId:V,userId:K,accessToken:$,nickname:q,stringSet:un,children:s?Ze.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:[Ze.jsxs("div",{style:{marginTop:"10px"},children:[Ze.jsx("button",{onClick:()=>{u(null),t("/man-chat-list")},style:Bt.callButton,children:"⬅ 返回列表"}),se==="MALE"&&Ze.jsxs(Ze.Fragment,{children:[Ze.jsx("button",{onClick:()=>te(!0),style:Bt.callButton,children:"📞 語音通話"}),Ze.jsx("button",{onClick:()=>xe(!0),style:Bt.callButton,children:"📹 視訊通話"})]})]}),Ze.jsx(o4,{channelUrl:s,inputPlaceholder:"請輸入訊息",onBeforeSendUserMessage:bn})]}):Ze.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:Ze.jsx(Q4,{onChannelSelect:Ee=>{if(Ee&&Ee.url){u(Ee.url),t(`/man-chat-list/${Ee.url}`);const fe=Ee.members.find(We=>We.userId!==K);l(fe)}},disableAutoSelect:!0})})}),Se&&Ze.jsx("div",{className:"modal-overlay",children:Ze.jsxs("div",{className:"modal-content",children:[Ze.jsx("button",{className:"modal-close",onClick:()=>te(!1),children:Ze.jsx("i",{className:"mdi mdi-close"})}),Ze.jsxs("div",{style:{textAlign:"center"},children:[Ze.jsx("img",{src:"../public/assets/通話費率.png",alt:"通話費率",style:{maxWidth:"120px"}}),Ze.jsxs("p",{children:["將以每",Ze.jsxs("span",{style:{fontWeight:"bolder"},children:[R.call_coin,"點/分鐘"]}),"扣點進行語音通話"]}),Ze.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",padding:"8px 16px",borderRadius:"4px",border:"none",margin:"0.5rem 0",width:"100%"},onClick:Ge,children:"確定"}),Ze.jsx("button",{style:{backgroundColor:"#fff",color:"#dd8ea4",padding:"8px 16px",borderRadius:"4px",border:"2px solid #dd8ea4",width:"100%"},onClick:()=>t("/purchase/deposit"),children:"前往加值"})]})]})}),be&&Ze.jsx("div",{className:"modal-overlay",children:Ze.jsxs("div",{className:"modal-content",children:[Ze.jsx("button",{className:"modal-close",onClick:()=>xe(!1),children:Ze.jsx("i",{className:"mdi mdi-close"})}),Ze.jsxs("div",{style:{textAlign:"center"},children:[Ze.jsx("img",{src:"../public/assets/視訊費率.png",alt:"視訊費率",style:{maxWidth:"120px"}}),Ze.jsxs("p",{children:["將以每",Ze.jsxs("span",{style:{fontWeight:"bolder"},children:[R.video_coin,"點/分鐘"]}),"扣點進行視訊通話"]}),Ze.jsx("button",{style:{backgroundColor:"#dd8ea4",color:"#fff",padding:"8px 16px",borderRadius:"4px",border:"none",margin:"0.5rem 0",width:"100%"},onClick:cn,children:"確定"}),Ze.jsx("button",{style:{backgroundColor:"#fff",color:"#dd8ea4",padding:"8px 16px",borderRadius:"4px",border:"2px solid #dd8ea4",width:"100%"},onClick:()=>t("/purchase/deposit"),children:"前往加值"})]})]})}),m&&Ze.jsxs("div",{style:Bt.waitingCallContainer,children:[Ze.jsx("h3",{children:"等待對方接聽中..."}),Ze.jsx("button",{onClick:Ye,style:Bt.declineButton,children:"❌ 取消通話"})]}),d&&Ze.jsxs("div",{style:Bt.incomingCallContainer,children:[Ze.jsx("img",{src:(($e=d.caller)==null?void 0:$e.profileUrl)||"https://via.placeholder.com/80",alt:"avatar",style:{borderRadius:"50%",height:"100%"}}),Ze.jsxs("h3",{children:["來電來自: ",d.caller.nickname||d.caller.userId]}),Ze.jsx("button",{onClick:ln,style:Bt.acceptButton,children:"✅ 接聽"}),Ze.jsx("button",{onClick:dn,style:Bt.declineButton,children:"❌ 拒絕"})]}),Ze.jsxs("div",{ref:F,style:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"#000",display:f?"block":"none",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:1e4},children:[Ze.jsxs("div",{style:{display:On?"block":"none"},children:[Ze.jsx("video",{ref:L,autoPlay:!0,playsInline:!0,style:Bt.remoteVideo}),Ze.jsx("video",{ref:P,autoPlay:!0,muted:!0,playsInline:!0,style:Bt.localVideo})]}),Ze.jsx("div",{style:{display:On?"none":"flex",width:"100vw",height:"70vh",justifyContent:"center",alignItems:"center"},children:Ze.jsxs("div",{children:[Ze.jsx("img",{src:(o==null?void 0:o.profileUrl)||"https://via.placeholder.com/150",alt:"avatar",style:Bt.voiceAvatar}),Ze.jsx("div",{style:{width:"100%",textAlign:"center"},children:Ze.jsx("h2",{style:{color:"#fff",margin:"10px 0 5px"},children:(o==null?void 0:o.nickname)||(o==null?void 0:o.userId)})})]})}),Ze.jsxs("div",{style:Bt.bottomControlBar,children:[Ze.jsx("button",{onClick:en,style:Bt.controlIconButton,children:E?"🔇":"🎤"}),On&&Ze.jsxs(Ze.Fragment,{children:[Ze.jsx("button",{onClick:fn,style:Bt.controlIconButton,children:g?"📷":"📴"}),Ze.jsx("button",{onClick:Nn,style:Bt.controlIconButton,children:"🔄"}),Ze.jsx("button",{onClick:Fe,style:Bt.controlIconButton,children:I?"↙︎":"⛶"})]}),Ze.jsx("button",{onClick:Ye,style:Bt.endCallButton,children:"❌"}),S===!0&&Ze.jsx("div",{className:"settings-modal",style:Bt.overlay,children:Ze.jsxs("div",{style:Bt.content,children:[Ze.jsxs("div",{style:Bt.header,children:[Ze.jsx("h3",{children:"設定"}),Ze.jsx("button",{onClick:()=>A(!1),style:Bt.closeBtn,children:"X"})]}),Ze.jsx("div",{style:Bt.body,children:Ze.jsxs("div",{style:Bt.field,children:[Ze.jsx("label",{children:"鏡頭"}),Ze.jsx("select",{id:"video-device-select",value:i,onChange:nn,children:e.map(Ee=>Ze.jsx("option",{value:Ee.deviceId,children:Ee.label||"未命名攝影機"},Ee.deviceId))})]})})]})})]}),Ze.jsxs("div",{style:{position:"absolute",bottom:"0px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"end"},children:[Ze.jsxs("div",{style:{color:"#FFF",fontSize:"20px"},children:["剩餘點數：",Ln]}),Ze.jsx("div",{style:{color:"#FFF",fontSize:"20px"},children:et(Gn)})]})]})]})}const Bt={callButton:{margin:"5px",padding:"10px 20px",backgroundColor:"#dd8ea4",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},modalConfirmButton:{backgroundColor:"#dd8ea4",color:"#fff",padding:"8px 16px",borderRadius:"4px",border:"none",margin:"0.5rem 0",width:"100%",cursor:"pointer"},modalGoChargeButton:{backgroundColor:"#fff",color:"#dd8ea4",padding:"8px 16px",borderRadius:"4px",border:"2px solid #dd8ea4",width:"100%",cursor:"pointer"},callingOverlay:{position:"fixed",zIndex:9999,top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"center",alignItems:"center"},callingContainer:{display:"flex",flexDirection:"column",alignItems:"center"},declineCallButton:{backgroundColor:"#F44336",color:"#fff",padding:"10px 20px",margin:"5px",border:"none",borderRadius:"5px",cursor:"pointer"},incomingCallContainer:{position:"fixed",zIndex:9999,top:"40%",left:"5vw",right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",justifyContent:"center",alignItems:"center",height:"120px",width:"90vw",color:"#FFF"},incomingInner:{backgroundColor:"#fff",borderRadius:"10px",padding:"20px 30px",textAlign:"center"},acceptButton:{backgroundColor:"#4CAF50",color:"#fff",padding:"10px 20px",margin:"5px",border:"none",borderRadius:"5px",cursor:"pointer"},declineButton:{backgroundColor:"#F44336",color:"#fff",padding:"10px 20px",margin:"5px",border:"none",borderRadius:"5px",cursor:"pointer"},voiceCallOverlay:{position:"fixed",zIndex:1e4,top:0,left:0,right:0,bottom:0,backgroundColor:"#000",display:"flex",justifyContent:"center",alignItems:"center"},voiceCallContainer:{display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},coinInfo:{position:"absolute",top:"30px",right:"30px",color:"#fff",fontSize:"16px"},voiceAvatar:{borderRadius:"50%",width:"150px",height:"150px",objectFit:"cover",marginBottom:"20px"},voiceCallButtons:{display:"flex",marginTop:"20px"},voiceIconBtn:{backgroundColor:"#333",color:"#fff",border:"none",fontSize:"24px",marginRight:"20px",padding:"15px",borderRadius:"50%",cursor:"pointer"},voiceEndCallBtn:{backgroundColor:"#dd4b39",color:"#fff",border:"none",fontSize:"24px",padding:"15px",borderRadius:"50%",cursor:"pointer"},videoContainer:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#000",flexDirection:"column",justifyContent:"flex-end",alignItems:"center",zIndex:1e4},remoteVideo:{position:"absolute",top:0,height:"100%",objectFit:"cover",backgroundColor:"#000",left:"50%",transform:"translateX(-50%)"},localVideo:{position:"absolute",width:"120px",height:"160px",bottom:"120px",right:"20px",backgroundColor:"#333",borderRadius:"8px",objectFit:"cover",border:"2px solid #fff"},topRightInfo:{position:"absolute",top:"20px",right:"20px",textAlign:"right",color:"#fff"},bottomControlBar:{position:"absolute",bottom:"40px",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},controlIconButton:{backgroundColor:"rgba(0,0,0,0.6)",color:"#fff",border:"none",fontSize:"24px",margin:"0 10px",padding:"10px",borderRadius:"50%",cursor:"pointer",width:"50px",height:"50px"},endCallButton:{backgroundColor:"#dd4b39",color:"#fff",border:"none",fontSize:"18px",cursor:"pointer",borderRadius:"50%",marginLeft:"10px",width:"60px",height:"60px"},overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:2e4},content:{background:"#fff",padding:"20px",borderRadius:"8px",width:"300px"},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},closeBtn:{background:"none",border:"none",fontSize:"18px",cursor:"pointer"},body:{marginTop:"10px"},field:{marginBottom:"15px",display:"flex",flexDirection:"column"}},GP=Object.freeze(Object.defineProperty({__proto__:null,default:PP},Symbol.toStringTag,{value:"Module"}));export{GP as C,ie as F,bp as G,gu as H,BP as V,Ty as W,H as b,Tr as i,k as o,id as r};
