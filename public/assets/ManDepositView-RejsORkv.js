import{u as N,r,j as e}from"./index-C3mMhQvi.js";import{a as l}from"./axios-upsvKRUO.js";import{A as b}from"./AppBar-C1sVSG8a.js";function C(){const c=N(),[d,m]=r.useState(null),[o,p]=r.useState("clary.option8j@icloud.c"),[h,u]=r.useState([]);r.useEffect(()=>{window.localStorage.getItem("nickname");const a=window.localStorage.getItem("gender_type"),s=window.localStorage.getItem("token");if(m(s),a==="FEMALE"){c("/home-woman");return}if(!a){c("/home");return}!window.WebSocketObject&&typeof window.WebSocketConnect=="function"&&window.WebSocketConnect(window.localStorage.getItem("u_id")),x()},[c]);const x=async()=>{try{const a=await l.get("https://api.dageiwo.com/index/recharge");a.data.success?u(a.data.data):console.error("获取充值选项失败:",a.data.message)}catch(a){console.error("请求充值选项失败:",a)}},g=async a=>{try{const s=await l.post("https://api.dageiwo.com/api/pay",{mail:o},{params:{recharge_type:a},headers:{Authorization:`Bearer ${d}`}});if(console.log(a),s.data.success){const{url:n,merchant_id:j,version:f,trade_info:w,trade_sha:v}=s.data.data,t=document.createElement("form");t.method="POST",t.action=n,t.appendChild(i("MerchantID",j)),t.appendChild(i("Version",f)),t.appendChild(i("TradeInfo",w)),t.appendChild(i("TradeSha",v)),document.body.appendChild(t),t.submit()}else alert(`儲值失敗: ${s.data.message||"請稍後再試"}`)}catch(s){console.error("充值請求失敗:",s),s.response?alert(`儲值失敗: ${s.response.data.message||"後端服務無響應"}`):s.request?alert("請求無響應，請檢查您的網路連線。"):alert("請求發生錯誤，請稍後再試。")}},i=(a,s)=>{const n=document.createElement("input");return n.type="hidden",n.name=a,n.value=s,n};return e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsxs("div",{className:"app-bar-content",children:[e.jsx("button",{className:"back-button",style:{color:"#fff"},onClick:()=>c(-1),children:e.jsx("i",{className:"mdi mdi-chevron-left",style:{fontSize:"24px"}})}),e.jsx("h2",{className:"app-bar-title",children:"金幣方案"}),e.jsx("div",{style:{width:"24px"}})]})}),e.jsxs("div",{className:"main-container",children:[e.jsxs("div",{className:"title-section",children:[e.jsx("p",{className:"main-title",children:"快用你的點數拓展"}),e.jsx("p",{className:"main-title",children:"你的交友圈吧！"})]}),e.jsx("div",{className:"recharge-options",children:h.map((a,s)=>e.jsxs("div",{className:"recharge-card",children:[e.jsx("div",{className:"card-title",children:"小資方案"}),e.jsxs("div",{className:"price-section",children:[e.jsxs("p",{className:"price",children:["$",a.price]}),e.jsxs("p",{className:"coins",children:["/ ",a.coins," 金幣"]})]}),e.jsx("button",{className:"buy-btn",onClick:()=>g(a.title),children:"立即購買"})]},s))}),e.jsxs("div",{className:"invoice-card",children:[e.jsx("h3",{children:"消費發票"}),e.jsxs("div",{className:"invoice-form",children:[e.jsx("label",{htmlFor:"email",children:"電子郵件"}),e.jsx("input",{type:"email",id:"email",placeholder:"請輸入你的電子郵件",value:o,onChange:a=>p(a.target.value)})]})]})]})]})}export{C as default};
